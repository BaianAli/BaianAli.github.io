!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="551b8f01-b424-45b5-af36-e8cfdf7d55d6",e._sentryDebugIdIdentifier="sentry-dbid-551b8f01-b424-45b5-af36-e8cfdf7d55d6")}catch(e){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"6af6db66"};"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8917,3845],{85379:function(e,t,n){n.d(t,{_:function(){return y}});var r=n(41733),i=n(74985),o=n(3499),a=n(73164),l=n(53326),c=n(57468),s=n(38080),u=n(74833),d=n(56596),f=n(93918),h=n(29287),p=n(1642),m=n(9100),v=(0,f.X)({styles0:[h.l0.pl(4),h.l0.fontSize(12),h.l0.color.foregroundDimmer]}),g=(0,f.X)({root:[h.l0.borderRadius(4),h.l0.border({color:h.TV.outlineDimmest})],header:[h.l0.rowWithGap(8),h.l0.border({color:h.TV.outlineDimmest,direction:"bottom"}),{fontFamily:h.TV.fontFamilyDefault}],headerLeft:[h.l0.rowWithGap(0),h.l0.pl(4),h.l0.flex.growAndShrink(1),h.l0.align.center],headerRight:[h.l0.rowWithGap(0),{"& button":{borderRadius:0},"& > div:last-of-type button":{borderTopRightRadius:4}}],blockStyles:{backgroundColor:"transparent"}}),y=function(e){if(e.inline)return(0,i.tZ)(l.Z,(0,r._)({},e));var t=(0,l.F)(e.className),n=t&&(0,m.Vt)(t),o=n?a.$R.from(n):void 0,f=null==o?void 0:o.name,h=String(e.children);return(0,i.BX)(s.Tg,{css:g.root,children:[(0,i.BX)(d.G,{css:g.header,children:[(0,i.BX)(d.G,{css:g.headerLeft,children:[n?(0,i.tZ)(c.Z,{size:12,path:n}):null,f?(0,i.tZ)(u.xv,{multiline:!1,css:v.styles0,children:f}):null]}),(0,i.BX)(d.G,{css:g.headerRight,children:[(0,i.tZ)(p.fO,{code:h,language:t}),(0,i.tZ)(b,{code:h})]})]}),(0,i.tZ)(l.Z,(0,r._)({blockStyles:g.blockStyles,disableCopy:!0},e))]})},b=function(e){var t=e.code,n=(0,o.he)();if(!n)return null;var r=n.insert,a=n.revert;return a?(a&&p.pe,null):(0,i.tZ)(p.eo,{disabled:!1,code:t,insertCode:function(){null==r||r(t)}})}},13498:function(e,t,n){n.d(t,{k:function(){return x}});var r=n(66626),i=n(74985),o=n(90234),a=n(50959),l=n(61610),c=n(3499),s=n(48739),u=n(27387),d=n(12285),f=n(96583),h=n(86583),p=n(28352),m=n(63452),v=n(42176),g=n(35515),y=n(85234),b=n.n(y),Z=function(){"use strict";function e(t){(0,d._)(this,e),this.n=1,this.cleanup=t}var t=e.prototype;return t.ref=function(){this.n+=1},t.unref=function(){this.n-=1,0===this.n&&this.cleanup()},e}(),w=void 0;function x(e){var t,n,s,d,y,x,_,S,E,k,T,R,D,I,G,B,A,P,N,U,O,L=e.replId,M=e.currentUserId,X=e.endpoint,F=e.hasAccessToAdvancedModel,W=e.children,H=(n=(t={replId:L,currentUserId:M,endpoint:X,hasAccessToAdvancedModel:F,testStore:e.testStore}).replId,s=t.currentUserId,d=t.endpoint,y=t.hasAccessToAdvancedModel,x=t.codeInsert,_=t.testStore,N=(E=(S={replId:n,currentUserId:s,endpoint:d,hasAccessToAdvancedModel:y}).replId,k=S.endpoint,T=S.currentUserId,R=S.hasAccessToAdvancedModel,D="".concat(E,"-").concat(R?"advanced":"basic"),G=(I=(0,a.useMemo)(function(){return function(e){var t=e.currentUserId,n=e.replId,r=e.endpoint,i=e.clientId;function o(){return(o=(0,u._)(function(){var e,t;return(0,f.Jh)(this,function(i){switch(i.label){case 0:return[4,(0,g.I)(n)];case 1:return e=i.sent(),(t=new URL(r)).searchParams.set("auth_token",e),[2,new h.Z(t.toString())]}})})).apply(this,arguments)}if(w&&w.clientId===i)w.refcount.ref();else{var a="".concat(t,"-").concat(b()()),l=new v.k(function(){return o.apply(this,arguments)},a,"SERVER",{codec:m.f}),c=new Z(function(){l.close()}),s=null==w?void 0:w.ctx;w={ctx:{client:(0,p.eI)(l),transport:l,cleanup:function(){return null==w?void 0:w.refcount.unref()}},clientId:i,refcount:c},null==s||s.transport.close()}return w.ctx}({currentUserId:T,replId:E,endpoint:k,clientId:D})},[T,E,k,D])).client,B=I.transport,A=I.cleanup,(0,a.useEffect)(function(){var e=function(){B.state="open",B.createNewConnection("SERVER")},t=function(){A()};return window.addEventListener("online",e),window.addEventListener("offline",t),function(){window.removeEventListener("online",e),window.removeEventListener("offline",t),A()}},[A,B]),P={client:G,transport:B}).client,U=P.transport,O=(0,r._)((0,a.useState)(function(){if(_)throw Error("testStore in only meant for tests");var e=null!=_?_:(0,o.MT)();return e.set(c.aN,{client:N}),e.set(c.Uk,{replId:n,currentUserId:s,hasAccessToAdvancedModel:y}),e.set(c.Hh,null!=x?x:null),e}),1)[0],(0,a.useEffect)(function(){O.set(c.aN,{client:N})},[O,N]),(0,a.useEffect)(function(){O.set(c.Uk,{replId:n,currentUserId:s,hasAccessToAdvancedModel:y})},[O,n,s,y]),(0,a.useEffect)(function(){O.set(c.Hh,null!=x?x:null)},[O,x]),{transport:U,store:O}),V=H.store,z=H.transport;return(0,i.BX)(l.g3,{store:V,children:[W,(0,i.tZ)(C,{replId:L,transport:z})]})}function C(e){var t=e.replId,n=e.transport,i=(0,r._)((0,a.useState)(!1),2),o=i[0],l=i[1],u=(0,c.m8)(),d=(0,c.Bh)();(0,a.useEffect)(function(){var e=function(e){l("connect"===e.status)};return n.connections.size&&l(!0),n.addEventListener("connectionStatus",e),function(){n.removeEventListener("connectionStatus",e)}},[n]);var f=(0,c.ww)();return(0,a.useEffect)(function(){o&&f()},[u,o,f]),(0,a.useEffect)(function(){if(o)return(0,s.NO)(u,t,d)},[u,t,d,o]),null}},61610:function(e,t,n){n.d(t,{$X:function(){return h},Hg:function(){return d},XD:function(){return p},g3:function(){return s},oR:function(){return u},yL:function(){return f}});var r=n(74985),i=n(66368),o=n(71999),a=n(28999),l=n(50959),c=(0,l.createContext)(null);function s(e){return(0,r.tZ)(c.Provider,{value:e.store,children:e.children})}function u(){var e=(0,l.useContext)(c);if(!e)throw Error("Expected store in context");return e}function d(e){return(0,o.Dv)(e,{store:u()})}function f(e){return(0,i.b)(e,u())}var h=function(e){return(0,o.b9)(e,{store:u()})};function p(e){return(0,a.lV)((0,l.useCallback)(function(t){return t(e)},[e]),{store:u()})}},48739:function(e,t,n){n.d(t,{Iv:function(){return b},JI:function(){return Z},ed:function(){return p},uI:function(){return v},NO:function(){return h}});var r=n(31417),i=n(27387),o=n(66626),a=n(96583),l=n(99149),c=n(10676),s=n(64461),u=n(85234),d=n.n(u),f=n(6636);function h(e,t,n){var l=function(){},c=!1;function s(){return(s=(0,i._)(function(){var i,s,u,d,h,p,m,v,g;return(0,a.Jh)(this,function(a){switch(a.label){case 0:return[4,e.chatService.subscribeToReplEvents.subscribe({replId:t})];case 1:if(s=(i=o._.apply(void 0,[a.sent(),2]))[0],l=i[1],c)return[2];u=!1,d=!1,a.label=2;case 2:a.trys.push([2,7,8,13]),p=(0,r._)(s),a.label=3;case 3:return[4,p.next()];case 4:if(!(u=!(m=a.sent()).done)||(v=m.value,c))return[3,6];if(!v.ok)return(0,f.o)(v.payload.message,{code:v.payload.code}),[3,5];n(v.payload.message),a.label=5;case 5:return u=!1,[3,3];case 6:return[3,13];case 7:return g=a.sent(),d=!0,h=g,[3,13];case 8:if(a.trys.push([8,,11,12]),!(u&&null!=p.return))return[3,10];return[4,p.return()];case 9:a.sent(),a.label=10;case 10:return[3,12];case 11:if(d)throw h;return[7];case 12:return[7];case 13:return[2]}})})).apply(this,arguments)}return!function(){s.apply(this,arguments)}(),function(){c=!0,l()}}function p(e,t){return m.apply(this,arguments)}function m(){return(m=(0,i._)(function(e,t){var n,r,i,o,l,s,u,d,h,p;return(0,a.Jh)(this,function(a){switch(a.label){case 0:return n=t.replId,i=void 0===(r=t.sessionType)?c.FF.CHAT:r,l=void 0===(o=t.title)?"":o,[4,e.chatService.createSession.rpc({replId:n,sessionType:i,title:l})];case 1:if(!(s=a.sent()).ok)return(0,f.o)(s.payload.message,{code:s.payload.code}),[2,{error:s.payload.message,session:null}];return d=(u=s.payload).sessionId,h=u.sessionCreationEventId,p=new Date,[2,{session:{id:d,replId:n,title:l,sessionType:i,sessionCreationEventId:h,created:p,updated:p,lastEventTime:p},error:null}]}})})).apply(this,arguments)}function v(e){for(var t=e.parentId,n=e.parentToActiveChild,r=e.events,i=[],o=t;o&&"break"!==function(){var e=r.byParentId.get(o);if(!e)return"break";var t=n.get(o);if(t)return i.push(t),o=t,"continue";var a=[],l=!0,c=!1,s=void 0;try{for(var u,d=e[Symbol.iterator]();!(l=(u=d.next()).done);l=!0){var f=u.value,h=r.byId.get(f);h&&a.push(h)}}catch(e){c=!0,s=e}finally{try{l||null==d.return||d.return()}finally{if(c)throw s}}var p=a.sort(function(e,t){return e.created.getTime()-t.created.getTime()}).map(function(e){return e.id});if(!(t=p[p.length-1]))throw Error("Expected id");i.push(t),o=t}(););return i}var g=l.B4.Create(c.i6);function y(e){return(0,s.Uy)(l.B4.Create(c.Ui),function(t){t.state=e.state,t.sessionId=e.sessionId,t.parentEventId=e.parentEventId,t.eventId=e.id,t.context=e.context,t.contents=e.contents})}function b(e){var t,n,r,i,a,l,s,u,f,h=(t=e.sessionId,n=e.parentEventId,r=e.data,i=e.membership,a=e.currentUserId,l=d()(),s=new Date,u={id:a.toString(),type:c.FW.USER,isTeam:!1,roles:[],membership:i},{id:l,created:s,updated:s,error:{type:c.lZ.EVENT_ERROR_TYPE_UNKNOWN,message:""},updateEventOperations:[],parentEventId:n,sessionId:t,state:c.he.COMPLETE,sender:u,contents:(f=(0,o._)(function(e){var t,n,r,i,o,a,l;switch(e.kind){case"message":return[{contents:{$kind:"messageEventContents",messageEventContents:{content:e.message,intent:e.intent,media:null!==(t=e.media)&&void 0!==t?t:[],codeReference:null!==(n=e.codeReference)&&void 0!==n?n:g,debugFullPrompt:"",debugErrorSource:c.FM.DEBUG_ERROR_SOURCE_UNKNOWN,stopReason:c.wc.MESSAGE_STOP_REASON_UNKNOWN}}},{metadata:{$kind:"messageEventContext",messageEventContext:{mostRecentFile:null!==(r=e.mostRecentFile)&&void 0!==r?r:"",fileContext:null!==(i=e.fileContext)&&void 0!==i?i:[],modelSelector:{type:e.model,overrideModelName:""}}}}];case"inline":return[{contents:{$kind:"inlineActionEventContents",inlineActionEventContents:{content:e.message,codeReference:null!==(o=e.codeReference)&&void 0!==o?o:g,messageType:e.messageType,debugErrorSource:c.FM.DEBUG_ERROR_SOURCE_UNKNOWN}}},{metadata:{$kind:"inlineActionEventContext",inlineActionEventContext:{mostRecentFile:null!==(a=e.mostRecentFile)&&void 0!==a?a:"",fileContext:null!==(l=e.fileContext)&&void 0!==l?l:[],modelSelector:{type:e.model,overrideModelName:""}}}}]}}(r),2))[0],context:f[1]});return{event:h,request:y(h)}}function Z(e,t){var n,r,i,o=(n=t.model,r=t.intent,i=d()(),(0,s.Uy)(e,function(e){e.id=i;var t=e.contents.contents;if(e.context.metadata){var o=e.context.metadata;switch(null==o?void 0:o.$kind){case"inlineActionEventContext":break;case"messageEventContext":o.messageEventContext.modelSelector={type:n,overrideModelName:""}}switch(t.$kind){case"inlineActionEventContents":break;case"messageEventContents":t.messageEventContents.intent=r}}else if("messageEventContents"===t.$kind){var a=l.B4.Create(c.sh);a.modelSelector={type:n,overrideModelName:""},e.context={metadata:{$kind:"messageEventContext",messageEventContext:a}}}else if("inlineActionEventContents"===t.$kind){var s=l.B4.Create(c.nn);s.modelSelector={type:n,overrideModelName:""},e.context={metadata:{$kind:"inlineActionEventContext",inlineActionEventContext:s}}}}));return{event:o,request:y(o)}}},6636:function(e,t,n){n.d(t,{o:function(){return i}});var r=n(43182);function i(e,t){var n=Error(e);return r.$e(function(e){e.setTag("ai-chat",!0),t&&e.setExtras(t),r.Tb(n)}),n}},56511:function(e,t,n){n.d(t,{l:function(){return i}});var r=n(25425);function i(){return(0,r.P5)({controlName:"flag-notable-exotic-flash-memory"})}},62507:function(e,t,n){n.d(t,{XW:function(){return h},bD:function(){return f},gS:function(){return p}});var r=n(27387),i=n(66626),o=n(96583),a=n(7444),l=n(90719),c=n(10676),s=n(64461),u=n(50959),d=n(3499);function f(){var e,t,n,l,f,h=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},p=(0,i._)((0,u.useState)(null!==(f=h.initialSessionId)&&void 0!==f?f:null),2),m=p[0],v=p[1],g=(0,i._)((0,u.useState)(!1),2),y=g[0],b=g[1],Z=(0,i._)((t=(e=(0,i._)((0,u.useState)(new Map),2))[0],n=e[1],[t,(0,u.useCallback)(function(e){n(function(t){return(0,s.Uy)(t,function(t){null===e.eventId?t.delete(e.parentEventId):t.set(e.parentEventId,e.eventId)})})},[])]),2),w=Z[0],x=Z[1],C=(0,d.ZR)().replId,_=(0,d.EU)(),S=(0,d.K6)(),E=(0,d.$3)(),k=(0,d.Jf)(m,w),T=(0,a.Z)(y),R=(0,d.Xn)(m,w);(0,u.useEffect)(function(){return R.subscribe(function(e){if(e&&e.sender.type===c.FW.AI){var t=e.state===c.he.COMPLETE;!0===T.current&&t&&b(!1)}})},[R,T]);var D=(0,a.Z)(h.onError),I=(0,a.Z)(h.getFileContext);return{sendMessage:(0,u.useCallback)((l=(0,r._)(function(e){var t,n,r,i,a;return(0,o.Jh)(this,function(o){switch(o.label){case 0:if(b(!0),m)return[3,3];return[4,S({replId:C,sessionType:"inline"===e.kind?c.FF.INLINE_CHAT:c.FF.CHAT})];case 1:if(!(t=o.sent()))return null===(n=D.current)||void 0===n||n.call(D,"Error creating session"),[2];return v(t.id),[4,E({parentEventId:t.sessionCreationEventId,sessionId:t.id,data:e})];case 2:return o.sent().ok||null===(r=D.current)||void 0===r||r.call(D,"Error sending message"),[2];case 3:if(!(i=_(m,w)))throw Error("Expected parent id");return[4,E({parentEventId:i,sessionId:m,data:e,getFileContext:I.current})];case 4:return o.sent().ok||null===(a=D.current)||void 0===a||a.call(D,"Error sending message"),[2]}})}),function(e){return l.apply(this,arguments)}),[m,S,E,_,w,C,D,I]),stopMessage:k,loading:y,setSessionId:v,sessionId:m,parentToActiveChild:w,setActiveChild:x}}function h(e){var t=e.onCode,n=f(),r=n.sendMessage,o=n.stopMessage,s=n.loading,h=n.sessionId,p=n.parentToActiveChild,m=(0,i._)((0,u.useState)(!1),2),v=m[0],g=m[1],y=(0,i._)((0,l.Ni)(),1)[0],b=(0,d.B6)(h,p),Z=(0,a.Z)(v);(0,u.useEffect)(function(){var e,n;if(h)return(null===(e=b.current)||void 0===e?void 0:e.code)&&t(null===(n=b.current)||void 0===n?void 0:n.code),b.subscribe(function(e){(null==e?void 0:e.code)&&t(e.code),!!(null==e?void 0:e.completed)!==Z.current&&g((null==e?void 0:e.completed)||!1)})},[h,t,b,Z]);var w=(0,u.useCallback)(function(){return b.current},[b]);return{sendMessage:(0,u.useCallback)(function(e){r({kind:"inline",message:e.message,messageType:e.type,model:"advanced"===y?c.BY.ADVANCED:c.BY.BASIC,codeReference:e.codeReference,fileContext:e.fileContext})},[y,r]),stopMessage:o,completed:v,loading:s,getCode:w}}function p(){var e=f(),t=e.sendMessage,n=e.stopMessage,r=e.loading,o=e.sessionId,a=e.parentToActiveChild,s=(0,i._)((0,l.Ni)(),1)[0],h=(0,d.gn)(o,a),p=(0,d.oV)(),m=h&&h.sender.type===c.FW.AI?h:null,v=(null==m?void 0:m.state)===c.he.COMPLETE,g=(null==m?void 0:m.contents.contents.$kind)==="inlineActionEventContents"?m.contents.contents.inlineActionEventContents.content:null,y=(0,u.useCallback)(function(){(null==h?void 0:h.sender.type)===c.FW.AI&&p(h.id)},[p,h]);return{sendMessage:(0,u.useCallback)(function(e){t({kind:"inline",message:"",messageType:c.G_.EXPLAIN_CODE,model:"advanced"===s?c.BY.ADVANCED:c.BY.BASIC,codeReference:e.codeReference,fileContext:e.fileContext})},[s,t]),stopMessage:n,completed:v,loading:r,model:s,message:g,retry:y,sessionId:o}}},3499:function(e,t,n){n.d(t,{$3:function(){return ec},$q:function(){return eC},B6:function(){return eo},Bh:function(){return K},Bk:function(){return O},EU:function(){return ea},Hh:function(){return G},Jf:function(){return ei},K6:function(){return ed},Mi:function(){return eg},SH:function(){return eZ},Ti:function(){return eb},Tt:function(){return eI},Ud:function(){return eh},Uk:function(){return R},Xn:function(){return er},ZR:function(){return I},_i:function(){return eD},aN:function(){return X},gn:function(){return en},hI:function(){return ee},he:function(){return B},kP:function(){return em},ll:function(){return U},m8:function(){return F},mL:function(){return j},oV:function(){return ex},p:function(){return eG},ww:function(){return eE},xe:function(){return P}});var r,i,o,a,l,c,s,u,d,f,h=n(27387),p=n(98924),m=n(66626),v=n(63257),g=n(96583),y=n(10676),b=n(99149),Z=n(92032),w=n(64461),x=n(90234),C=n(28999),_=n(15859),S=n(50959),E=n(61610),k=n(48739),T=n(6636),R=(0,x.cn)({replId:"",currentUserId:0,hasAccessToAdvancedModel:!1}),D=(0,x.cn)(function(e){return e(R).hasAccessToAdvancedModel?y.$c.CORE:y.$c.FREE});function I(){return(0,E.Hg)(R)}var G=(0,x.cn)({insert:function(){},revert:null});function B(){return(0,E.Hg)(G)}var A=(0,x.cn)(null);function P(){return(0,E.Hg)(A)}var N=(0,x.cn)(function(e){var t,n=null===(t=e(A))||void 0===t?void 0:t.advancedModelLimits;return!!n&&n.usage<n.limit});function U(){return(0,E.Hg)(N)}function O(){return(0,E.XD)(N)}var L=(0,x.cn)(new Map),M=(0,x.cn)({byId:new Map,byParentId:new Map}),X=(0,x.cn)({client:{}});function F(){return(0,E.Hg)(X).client}function W(e,t){var n=!0,r=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value;e.byId.set(l.id,l);var c=e.byParentId.get(l.parentEventId);c?c.add(l.id):e.byParentId.set(l.parentEventId,new Set([l.id]))}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}}var H=(0,x.cn)(null,function(e,t,n){var r=[],i=!0,o=!1,a=void 0;try{for(var l,c=n.sessions[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var s=l.value;r.push.apply(r,(0,v._)(s.events))}}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}t(L,function(e){return(0,w.Uy)(e,function(e){var t=!0,r=!1,i=void 0;try{for(var o,a=n.sessions[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var l=o.value;l.events;var c=(0,p._)(l,["events"]);e.set(c.id,c)}}catch(e){r=!0,i=e}finally{try{t||null==a.return||a.return()}finally{if(r)throw i}}})}),t(M,function(e){return(0,w.Uy)(e,function(e){W(e,r)})})});function V(e,t){return t.updated.getTime()-e.updated.getTime()}var z=(0,x.cn)(function(e){return(0,v._)(e(L).values()).sort(V)});function j(){var e=(0,m._)((0,S.useState)(!1),2),t=e[0],n=e[1],r=(0,E.Hg)(z),i=(0,E.$X)(ek),o=(0,S.useMemo)(function(){return r.filter(function(e){return e.sessionType===y.FF.CHAT})},[r]);return(0,S.useEffect)(function(){var e=!1;function t(){return(t=(0,h._)(function(){return(0,g.Jh)(this,function(t){switch(t.label){case 0:return n(!0),[4,i()];case 1:if(t.sent(),e)return[2];return n(!1),[2]}})})).apply(this,arguments)}return function(){t.apply(this,arguments)}(),function(){e=!0}},[i]),{sessions:o,loading:t}}var q=(0,x.cn)(null,function(e,t,n){var r=b.B4.Create(y.ju);r.id=n.eventId,r.parentEventId=n.parentEventId,r.sessionId=n.sessionId,r.state=n.state,r.sender=n.sender,r.contents=n.contents,r.created=new Date,t(M,function(e){return(0,w.Uy)(e,function(e){W(e,[r])})})}),Y=(0,x.cn)(null,(r=(0,h._)(function(e,t,n){var r;return(0,g.Jh)(this,function(e){switch(e.label){case 0:if(r=!1,t(M,function(e){return(0,w.Uy)(e,function(e){var t=e.byId.get(n.eventId);if(!t)throw Error("Expected event");var i=null;switch(t.contents.contents.$kind){case"messageEventContents":i=t.contents.contents.messageEventContents;break;case"inlineActionEventContents":i=t.contents.contents.inlineActionEventContents}if(i){t.state!==y.he.COMPLETE&&n.state===y.he.COMPLETE&&(r=!0),t.state=n.state,t.error=n.error;var o=!0,a=!1,l=void 0;try{for(var c,s=n.operations[Symbol.iterator]();!(o=(c=s.next()).done);o=!0){var u=c.value;u.operationType===y.ai.ADD&&"content"===u.key&&(i.content+=u.value)}}catch(e){a=!0,l=e}finally{try{o||null==s.return||s.return()}finally{if(a)throw l}}}})}),!r)return[3,2];return[4,t(eS)];case 1:e.sent(),e.label=2;case 2:return[2]}})}),function(e,t,n){return r.apply(this,arguments)})),$=(0,x.cn)(null,(i=(0,h._)(function(e,t,n){return(0,g.Jh)(this,function(e){return t(L,function(e){return(0,w.Uy)(e,function(e){var t=e.get(n.sessionId);t&&(t.title=n.title,t.sessionType=n.sessionType)})}),[2]})}),function(e,t,n){return i.apply(this,arguments)})),J=(0,x.cn)(null,function(e,t,n){switch(n.$kind){case"createEventMessage":t(q,n.createEventMessage);break;case"updateEventMessage":t(Y,n.updateEventMessage);break;case"updateSessionMessage":t($,n.updateSessionMessage)}});function K(){return(0,E.$X)(J)}function Q(e){return(0,S.useMemo)(function(){return(0,x.cn)(function(t){return t(M).byId.get(e)})},[e])}function ee(e,t){var n=(0,m._)((0,S.useState)(!1),2),r=n[0],i=n[1],o=(0,E.$X)(e_);(0,S.useEffect)(function(){if(e){var t=!1;return!function(){n.apply(this,arguments)}(),function(){t=!0}}function n(){return(n=(0,h._)(function(){return(0,g.Jh)(this,function(n){switch(n.label){case 0:if(i(!0),!e)throw Error("Expected sessionId");return[4,o({sessionId:e})];case 1:if(n.sent(),t)return[2];return i(!1),[2]}})})).apply(this,arguments)}},[o,e]);var a=(0,S.useMemo)(function(){return(0,x.cn)(function(n){if(!e)return[];var r=n(L).get(e);if(!r)throw Error("Expected session");return(0,k.uI)({parentId:r.sessionCreationEventId,parentToActiveChild:t,events:n(M)})})},[e,t]),l=(0,C.lV)((0,S.useCallback)(function(e){var t=[],n=e(M),r=e(a),i=!0,o=!1,l=void 0;try{for(var c,s=r[Symbol.iterator]();!(i=(c=s.next()).done);i=!0){var u=c.value,d=n.byId.get(u);d&&t.push(d)}}catch(e){o=!0,l=e}finally{try{i||null==s.return||s.return()}finally{if(o)throw l}}return t},[a]),{store:(0,E.oR)()});return{events:(0,E.Hg)(a),loading:r,getEvents:l}}function et(e,t){var n=ep(e);return(0,S.useMemo)(function(){return(0,x.cn)(function(e){var r,i=e(n);if(!i)return null;var o=e(M),a=(0,k.uI)({parentId:i.sessionCreationEventId,parentToActiveChild:t,events:o});return a.length&&null!==(r=o.byId.get(a[a.length-1]))&&void 0!==r?r:null})},[n,t])}function en(e,t){return(0,E.Hg)(et(e,t))}function er(e,t){return(0,E.yL)(et(e,t))}function ei(e,t){var n=et(e,t);return(0,C.lV)((0,S.useCallback)(function(e,t){var r=e(n);r&&r.state===y.he.IN_PROGRESS&&t(es,r.id)},[n]),{store:(0,E.oR)()})}function eo(e,t){var n=et(e,t),r=(0,S.useMemo)(function(){return(0,x.cn)(function(e){var t,r=e(n);if(!r||r.sender.type===y.FW.USER)return null;var i="inlineActionEventContents"===r.contents.contents.$kind?(0,Z.k)(r.contents.contents.inlineActionEventContents.content,r.state===y.he.COMPLETE):null,o=null==i?void 0:null===(t=i[0])||void 0===t?void 0:t.code;return o?{code:o,completed:r.state===y.he.COMPLETE}:null})},[n]);return(0,E.yL)(r)}function ea(){return(0,C.lV)((0,S.useCallback)(function(e,t,n,r){var i=e(L).get(n);if(!i)throw Error("Expected session");var o=(0,k.uI)({parentId:i.sessionCreationEventId,parentToActiveChild:r,events:e(M)});return o.length?o[o.length-1]:i.sessionCreationEventId},[]),{store:(0,E.oR)()})}var el=(0,x.cn)(null,(o=(0,h._)(function(e,t,n){var r,i,o,a,l,c,s,u,d,f,h,p,m;return(0,g.Jh)(this,function(v){switch(v.label){case 0:if(r=n.sessionId,i=n.parentEventId,o=n.data,a=n.getFileContext,l=e(X).client,!e(L).get(r))throw Error("Expected session");if(c=e(R).currentUserId,u=(s=(0,k.Iv)({sessionId:r,parentEventId:i,data:o,membership:e(D),currentUserId:c})).event,d=s.request,t(M,function(e){return(0,w.Uy)(e,function(e){if(!u)throw Error("Expected event");W(e,[u])})}),!a)return[2,l.chatService.createEvent.rpc(d)];return[4,a()];case 1:return h=(f=v.sent()).fileContext,m=void 0===(p=f.mostRecentFile)?"":p,[2,l.chatService.createEvent.rpc((0,w.Uy)(d,function(e){switch(e.context.metadata.$kind){case"messageEventContext":e.context.metadata.messageEventContext.mostRecentFile=m,e.context.metadata.messageEventContext.fileContext=h;break;case"inlineActionEventContext":e.context.metadata.inlineActionEventContext.mostRecentFile=m,e.context.metadata.inlineActionEventContext.fileContext=h}}))]}})}),function(e,t,n){return o.apply(this,arguments)}));function ec(){return(0,E.$X)(el)}var es=(0,x.cn)(null,(a=(0,h._)(function(e,t,n){return(0,g.Jh)(this,function(t){return[2,e(X).client.chatService.abortEvent.rpc({eventId:n})]})}),function(e,t,n){return a.apply(this,arguments)})),eu=(0,x.cn)(null,(l=(0,h._)(function(e,t,n){var r,i,o,a,l,c,s;return(0,g.Jh)(this,function(u){switch(u.label){case 0:return r=n.replId,i=n.sessionType,a=void 0===(o=n.title)?"":o,l=e(X).client,[4,(0,k.ed)(l,{replId:r,sessionType:i,title:a})];case 1:if(null!==(c=u.sent()).error)return[2,null];return s=c.session,t(L,function(e){return(0,w.Uy)(e,function(e){if(null===s)throw Error("Expected session");e.set(s.id,s)})}),[2,s]}})}),function(e,t,n){return l.apply(this,arguments)}));function ed(){return(0,E.$X)(eu)}var ef=(0,x.cn)(null,(c=(0,h._)(function(e,t,n,r){var i,o,a,l;return(0,g.Jh)(this,function(c){if(i=r.title,o=r.sessionType,a=e(X).client,t(L,function(e){return(0,w.Uy)(e,function(e){var t=e.get(n);if(!t)throw Error("Expected session");void 0!==i&&(t.title=i),void 0!==o&&(t.sessionType=o)})}),!(l=e(L).get(n)))throw Error("Expected session");return[2,a.chatService.updateSession.rpc({id:n,sessionType:null!=o?o:l.sessionType,title:null!=i?i:l.title})]})}),function(e,t,n,r){return c.apply(this,arguments)}));function eh(){return(0,E.$X)(ef)}function ep(e){return(0,S.useMemo)(function(){return(0,x.cn)(function(t){var n;return e&&null!==(n=t(L).get(e))&&void 0!==n?n:null})},[e])}function em(e){return(0,E.Hg)(ep(e))}function ev(e){switch(null==e?void 0:e.contents.contents.$kind){case"messageEventContents":return e.contents.contents.messageEventContents.content;case"inlineActionEventContents":return e.contents.contents.inlineActionEventContents.content;default:return null}}function eg(e,t){var n=Q(e);return(0,E.Hg)((0,S.useMemo)(function(){return(0,_.kv)(n,t)},[n,t]))}function ey(e){var t=Q(e);return(0,S.useMemo)(function(){return(0,_.kv)(t,ev)},[t])}function eb(e){return(0,E.Hg)(ey(e))}function eZ(e){return(0,E.yL)(ey(e))}var ew=(0,x.cn)(null,(s=(0,h._)(function(e,t,n,r){var i,o,a,l,c,s,u;return(0,g.Jh)(this,function(d){switch(d.label){case 0:if(i=e(X).client,!(a=(o=e(M)).byId.get(n)))throw Error("Expected event for id:"+n);if(r)return[3,2];return[4,i.chatService.reprocessEvent.rpc({eventId:a.parentEventId,context:a.context})];case 1:return[2,d.sent()];case 2:if(!(l=o.byId.get(a.parentEventId)))throw Error("Expected parentEvent for id:"+a.parentEventId);return s=(c=(0,k.JI)(l,r)).event,u=c.request,t(M,function(e){return(0,w.Uy)(e,function(e){W(e,[s])})}),[2,i.chatService.createEvent.rpc(u)]}})}),function(e,t,n,r){return s.apply(this,arguments)}));function ex(){return(0,E.$X)(ew)}function eC(e){var t=Q(e),n=(0,S.useMemo)(function(){return(0,x.cn)(function(e){var n=e(t);return n?function(e,t){var n=[],r=t.byParentId.get(e.parentEventId);if(!r)return null;var i=!0,o=!1,a=void 0;try{for(var l,c=r[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var s=l.value,u=t.byId.get(s);u&&n.push(u)}}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}var d=n.sort(function(e,t){return e.created.getTime()-t.created.getTime()}).map(function(e){return e.id});return{eventIds:d,index:d.indexOf(e.id)}}(n,e(M)):null})},[t]);return(0,E.Hg)(n)}var e_=(0,x.cn)(null,(u=(0,h._)(function(e,t,n){var r,i,o;return(0,g.Jh)(this,function(a){switch(a.label){case 0:if(r=n.sessionId,i=e(X).client,!e(L).get(r))return[2];return[4,i.chatService.getSessionEvents.rpc({sessionId:r,limit:1e3})];case 1:if(!(o=a.sent()).ok)return(0,T.o)(o.payload.message,{code:o.payload.code}),[2];return t(M,function(e){return(0,w.Uy)(e,function(e){W(e,o.payload.events)})}),[2]}})}),function(e,t,n){return u.apply(this,arguments)})),eS=(0,x.cn)(null,(d=(0,h._)(function(e,t){var n,r,i;return(0,g.Jh)(this,function(o){switch(o.label){case 0:return n=e(X).client,r=e(R).currentUserId,[4,n.chatService.getUsageLimits.rpc({user:{id:r.toString(),type:y.FW.USER,isTeam:!1,roles:[],membership:e(D)}})];case 1:if(!(i=o.sent()).ok)return(0,T.o)(i.payload.message,{code:i.payload.code}),[2];return t(A,i.payload.limits),[2]}})}),function(e,t){return d.apply(this,arguments)}));function eE(){return(0,E.$X)(eS)}var ek=(0,x.cn)(null,(f=(0,h._)(function(e,t){var n,r;return(0,g.Jh)(this,function(i){switch(i.label){case 0:return n=e(R).replId,[4,e(X).client.chatService.getReplSessions.rpc({replId:n,includeFirstSessionEvents:!0,firstSessionEventsLimit:1e3,limit:1e3,beforeTimestamp:new Date("2099-01-01"),sessionTypes:[y.FF.CHAT]})];case 1:if(!(r=i.sent()).ok)return(0,T.o)(r.payload.message,{code:r.payload.code}),[2];return t(H,r.payload),[2]}})}),function(e,t){return f.apply(this,arguments)})),eT=(0,x.cn)(new Map),eR=(0,x.cn)(null,function(e,t,n,r){return t(eT,function(e){return(0,w.Uy)(e,function(e){null===r?e.delete(n):e.set(n,r)})})});function eD(){return(0,E.$X)(eR)}function eI(){return(0,E.Hg)(eT)}function eG(){return(0,E.XD)(eT)}},11134:function(e,t,n){n.d(t,{Z:function(){return c}});var r=n(74985),i=n(76999),o=n.n(i),a=n(97754),l=n.n(a);function c(e){var t=e.unreadDot,n=e.size,i=void 0===n?12:n,a=e.count,c=void 0===a?null:a,s=c&&c>99,u=s?"99+":null==c?void 0:c.toString();return(0,r.BX)("span",{className:"jsx-1c7f3b9066c4c334",children:[(0,r.tZ)("svg",{width:i,height:i,viewBox:"0 0 24 24",fill:"none",style:{color:"currentColor"},xmlns:"http://www.w3.org/2000/svg",className:"jsx-1c7f3b9066c4c334",children:(0,r.tZ)("path",{d:"M21 15C21 15.5304 20.7893 16.0391 20.4142 16.4142C20.0391 16.7893 19.5304 17 19 17H7L3 21V5C3 4.46957 3.21071 3.96086 3.58579 3.58579C3.96086 3.21071 4.46957 3 5 3H19C19.5304 3 20.0391 3.21071 20.4142 3.58579C20.7893 3.96086 21 4.46957 21 5V15Z",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",className:"jsx-1c7f3b9066c4c334"})}),t?(0,r.tZ)("div",{className:"jsx-1c7f3b9066c4c334 unread-indicator"}):null,!!c&&(0,r.tZ)("div",{className:"jsx-1c7f3b9066c4c334 "+(l()("count",{overflow:s})||""),children:u}),(0,r.tZ)(o(),{id:"1c7f3b9066c4c334",children:"span.jsx-1c7f3b9066c4c334{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex}.unread-indicator.jsx-1c7f3b9066c4c334{width:5px;height:5px;-webkit-border-radius:10px;-moz-border-radius:10px;border-radius:10px;background-color:var(--accent-red-default);-webkit-transform:translate(8px,-1px);-moz-transform:translate(8px,-1px);-ms-transform:translate(8px,-1px);-o-transform:translate(8px,-1px);transform:translate(8px,-1px);position:absolute}.count.jsx-1c7f3b9066c4c334{-webkit-border-radius:10px;-moz-border-radius:10px;border-radius:10px;background-color:var(--accent-negative-default);-webkit-transform:translate(50%,-50%);-moz-transform:translate(50%,-50%);-ms-transform:translate(50%,-50%);-o-transform:translate(50%,-50%);transform:translate(50%,-50%);position:absolute;min-width:16px;padding:2px 3px;height:16px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;color:white;font-size:var(--font-size-small)}.overflow.jsx-1c7f3b9066c4c334{-webkit-transform:translate(25%,-50%);-moz-transform:translate(25%,-50%);-ms-transform:translate(25%,-50%);-o-transform:translate(25%,-50%);transform:translate(25%,-50%)}"})]})}},55846:function(e,t,n){n.d(t,{AS:function(){return T},Hj:function(){return A},Rp:function(){return D},Tt:function(){return N},gE:function(){return G},j7:function(){return _},xT:function(){return E},yi:function(){return S}});var r=n(41733),i=n(21262),o=n(71440),a=n(58995),l=n(99165),c=n(293);function s(){var e=(0,i._)(["\n  fragment AnnotationsUser on User {\n    id\n    username\n    fullName\n    image\n  }\n"]);return s=function(){return e},e}function u(){var e=(0,i._)(["\n  fragment AnnotationMessageContent on MessageContentType {\n    __typename\n    ... on TextMessageContentType {\n      text\n    }\n    ... on PreviewMessageContentType {\n      preview\n    }\n    ... on StatusMessageContentType {\n      status\n    }\n  }\n"]);return u=function(){return e},e}function d(){var e=(0,i._)(["\n  fragment AnnotationsUIMessage on AnnotationMessage {\n    id\n    user {\n      id\n      ...AnnotationsUser\n    }\n    anchor {\n      id\n    }\n    timeCreated\n    content {\n      __typename\n      ...AnnotationMessageContent\n    }\n    currentUserIsAuthor\n    seen\n  }\n  ","\n  ","\n"]);return d=function(){return e},e}function f(){var e=(0,i._)(["\n  fragment AnnotationsUIAnchor on AnnotationAnchor {\n    id\n    user {\n      id\n      ...AnnotationsUser\n    }\n    path\n    otVersion\n    indexStart\n    indexEnd\n    isResolved\n    isGeneral\n    messages {\n      id\n      ...AnnotationsUIMessage\n    }\n  }\n  ","\n  ","\n"]);return f=function(){return e},e}function h(){var e=(0,i._)(["\n  query AnnotationAnchorsByRepl($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        annotationAnchors {\n          id\n          ...AnnotationsUIAnchor\n        }\n      }\n    }\n    currentUser {\n      id\n      username\n      fullName\n      image\n    }\n  }\n  ","\n"]);return h=function(){return e},e}function p(){var e=(0,i._)(["\n  mutation CreateAnnotationAnchor(\n    $annotationAnchor: AnnotationAnchorInput!\n    $annotationMessage: AnnotationMessageInput\n    $highlight: AnnotationHighlightInput\n  ) {\n    createAnnotationAnchor(\n      annotationAnchor: $annotationAnchor\n      annotationMessage: $annotationMessage\n      highlight: $highlight\n    ) {\n      ... on UserError {\n        message\n      }\n      ... on AnnotationAnchor {\n        id\n        ...AnnotationsUIAnchor\n      }\n    }\n  }\n  ","\n"]);return p=function(){return e},e}function m(){var e=(0,i._)(["\n  mutation UpdateAnnotationAnchor(\n    $id: String!\n    $changes: AnnotationAnchorChangesInput!\n  ) {\n    updateAnnotationAnchor(id: $id, changes: $changes) {\n      ... on UserError {\n        message\n      }\n      ... on AnnotationAnchor {\n        id\n        ...AnnotationsUIAnchor\n      }\n    }\n  }\n  ","\n"]);return m=function(){return e},e}function v(){var e=(0,i._)(["\n  mutation CreateAnnotationMessage(\n    $replId: String!\n    $anchorId: String!\n    $annotationMessage: AnnotationMessageInput!\n    $highlight: AnnotationHighlightInput\n  ) {\n    createAnnotationMessage(\n      replId: $replId\n      anchorId: $anchorId\n      annotationMessage: $annotationMessage\n      highlight: $highlight\n    ) {\n      ... on UserError {\n        message\n      }\n      ... on AnnotationAnchor {\n        id\n        ...AnnotationsUIAnchor\n      }\n    }\n  }\n  ","\n"]);return v=function(){return e},e}function g(){var e=(0,i._)(["\n  mutation updateThreadPreview(\n    $threadId: String!\n    $messageId: String!\n    $message: String\n  ) {\n    updateThreadPreview(\n      threadId: $threadId\n      messageId: $messageId\n      message: $message\n    )\n  }\n"]);return g=function(){return e},e}function y(){var e=(0,i._)(["\n  subscription AnnotationUpdates($replId: String!) {\n    updatedAnnotation: annotationUpdatesByRepl(replId: $replId) {\n      id\n      ...AnnotationsUIAnchor\n    }\n  }\n  ","\n"]);return y=function(){return e},e}function b(){var e=(0,i._)(["\n  subscription MessagePreview($threadId: String!) {\n    threadPreview(threadId: $threadId) {\n      userId\n      messageId\n      message\n    }\n  }\n"]);return b=function(){return e},e}var Z={},w=(0,o.Ps)(s()),x=(0,o.Ps)(u()),C=(0,o.Ps)(d(),w,x),_=(0,o.Ps)(f(),w,C),S=(0,o.Ps)(h(),_);function E(e){var t=(0,r._)({},Z,e);return a.a(S,t)}var k=(0,o.Ps)(p(),_);function T(e){var t=(0,r._)({},Z,e);return l.D(k,t)}var R=(0,o.Ps)(m(),_);function D(e){var t=(0,r._)({},Z,e);return l.D(R,t)}var I=(0,o.Ps)(v(),_);function G(e){var t=(0,r._)({},Z,e);return l.D(I,t)}var B=(0,o.Ps)(g());function A(e){var t=(0,r._)({},Z,e);return l.D(B,t)}var P=(0,o.Ps)(y(),_);function N(e){var t=(0,r._)({},Z,e);return c.m(P,t)}b()},8482:function(e,t,n){n.d(t,{Ft:function(){return d},Vy:function(){return m},kL:function(){return p}});var r=n(27387),i=n(66626),o=n(96583),a=n(51051),l=n(43182);function c(){return(c=(0,r._)(function(e,t,n){var r;return(0,o.Jh)(this,function(i){switch(i.label){case 0:if(!e.path||"number"!=typeof e.indexStart||"number"!=typeof e.indexEnd||!e.otVersion)return[2];if(n===e.otVersion)return[2,{path:e.path,indexStart:e.indexStart,indexEnd:e.indexEnd,otVersion:e.otVersion}];return[4,t({indexStart:e.indexStart,indexEnd:e.indexEnd,versionFrom:e.otVersion,versionTo:n})];case 1:return r=i.sent(),[2,{path:e.path,indexStart:r.indexStart,indexEnd:r.indexEnd,otVersion:n}]}})})).apply(this,arguments)}var s=n(54916),u=n(50959);function d(e){return f.apply(this,arguments)}function f(){return(f=(0,r._)(function(e){var t,n,r,i,s,u,d;return(0,o.Jh)(this,function(o){switch(o.label){case 0:if(t=e.anchor,n=e.version,r=e.transformSelection,i=e.content,!t.path)return[2,null];return[4,function(e,t,n){return c.apply(this,arguments)}(t,r,n)];case 1:if(!(s=o.sent()))return[2,null];return d=function(){if(s){var e=s.indexStart,t=s.indexEnd;try{var n=a.xv.of(i.split("\n")),r=n.lineAt(e),o=n.lineAt(t),c=n.sliceString(n.line(Math.max(r.number-2,1)).from,e),u=n.sliceString(t,n.line(Math.min(o.number+2,n.lines)).to);return{precode:c,code:n.sliceString(e,t),postcode:u}}catch(e){l.Tb(e)}}},[2,{anchor:t,newSelection:s,newPosition:u,getHighlight:d,snippet:h(i,s)}]}})})).apply(this,arguments)}var h=function(e,t){var n=a.xv.of(e.split("\n")),r=n.lineAt(t.indexStart).number,i=n.lineAt(t.indexEnd).number,o=[];r===i&&(r=Math.max(1,r-1),i=Math.min(n.lines,i+1));for(var l=r;l<=i;l++)o.push(n.line(l).text);return{startLineNumber:r,lines:o}};function p(e){var t=(0,s.Z)().fs,n=(0,u.useRef)(null),r=(0,u.useRef)(null),o=(0,i._)((0,u.useState)(!1),2),a=o[0],l=o[1];return(0,u.useEffect)(function(){if(e){var i=function(){r.current=null,l(!1)},o=t.watchTextFile(e,{onReady:function(e){var t=e.transformSelection,i=e.initialContent;n.current=i.toString(),r.current=t,l(!0)},onMoveOrDelete:function(){i()},onError:function(){i()},onChange:function(e){var t=e.latestContent;n.current=t}});return function(){i(),o()}}},[e,t]),{contentRef:n,transformSelectionRef:r,loadedFile:a}}function m(e){var t=(0,s.Z)().fs,n=(0,i._)((0,u.useState)(null),2),r=n[0],o=n[1],a=p(null==e?void 0:e.path),c=a.contentRef,f=a.loadedFile,h=a.transformSelectionRef;return(0,u.useEffect)(function(){(null==e?void 0:e.path)&&f&&h.current&&null!==c.current&&d({anchor:e,version:t.getOTVersion(e.path),transformSelection:h.current,content:c.current}).then(function(e){o(e)}).catch(function(e){o(null),l.Tb(e)})},[t,e,f,h,c]),r}},19229:function(e,t,n){n.d(t,{n:function(){return u}});var r=n(41733),i=n(21262),o=n(71440),a=n(99165);function l(){var e=(0,i._)(["\n  mutation MarkMessagesAsSeen(\n    $replId: String!\n    $threadId: String\n    $messageIds: [String!]\n  ) {\n    markMessagesAsSeen(\n      replId: $replId\n      threadId: $threadId\n      messageIds: $messageIds\n    ) {\n      ... on AnnotationMessageList {\n        messages {\n          id\n          seen\n        }\n      }\n    }\n  }\n"]);return l=function(){return e},e}var c={},s=(0,o.Ps)(l());function u(e){var t=(0,r._)({},c,e);return a.D(s,t)}},59725:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(66626),i=n(50959),o=n(50782),a=n(19229);function l(e){var t=(0,o.Z)(),n=(0,r._)((0,a.n)(),1)[0];(0,i.useEffect)(function(){if(e){var r=e.messages.filter(function(e){return!e.seen}).map(function(e){return e.id});0!==r.length&&n({variables:{replId:t,threadId:e.id,messageIds:r},optimisticResponse:{__typename:"RootMutationType",markMessagesAsSeen:{messages:r.map(function(e){return{id:e,seen:!0,__typename:"AnnotationMessage"}}),__typename:"AnnotationMessageList"}}})}},[t,e,n])}},30456:function(e,t,n){n.d(t,{Z:function(){return d}});var r=n(50782),i=n(41733),o=n(21262),a=n(71440),l=n(58995);function c(){var e=(0,o._)(["\n  query ThreadReplCollaborators($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        owner {\n          ... on User {\n            id\n            username\n            image\n            fullName\n          }\n          ... on Team {\n            id\n            username\n            image\n          }\n        }\n        permissions {\n          id\n          user {\n            id\n            username\n            image\n            fullName\n          }\n        }\n      }\n    }\n  }\n"]);return c=function(){return e},e}var s={},u=(0,a.Ps)(c());function d(){var e=(c={variables:{replId:(0,r.Z)()}},d=(0,i._)({},s,c),l.a(u,d)).data;if((null==e?void 0:e.repl.__typename)!=="Repl")return[];var t=[];(null===(f=e.repl.owner)||void 0===f?void 0:f.username)&&"User"===e.repl.owner.__typename&&t.push(e.repl.owner);var n=!0,o=!1,a=void 0;try{for(var c,d,f,h,p=e.repl.permissions[Symbol.iterator]();!(n=(h=p.next()).done);n=!0){var m,v=h.value;(null===(m=v.user)||void 0===m?void 0:m.username)&&t.push(v.user)}}catch(e){o=!0,a=e}finally{try{n||null==p.return||p.return()}finally{if(o)throw a}}return t}},58626:function(e,t,n){n.d(t,{q:function(){return G},J:function(){return I}});var r,i,o,a=n(41733),l=n(30509),c=n(98924),s=n(66626),u=n(74985),d=n(12285),f=n(4955),h=n(9670),p=n(51051),m=n(80979),v=n(54340),g=m.tk.baseTheme({".cm-diff-inserted":{backgroundColor:"#0053A644",borderLeft:"#0053A6 solid 3px"},".cm-diff-deleted":{backgroundColor:"#c93c3733",borderLeft:"#c93c37 solid 3px"}}),y=m.p.line({attributes:{class:"cm-diff-inserted"}}),b=m.p.line({attributes:{class:"cm-diff-deleted"}}),Z=p.Py.define({map:function(e,t){return e.map(t)}}),w=function(e){"use strict";(0,f._)(n,e);var t=(0,h._)(n);function n(){return(0,d._)(this,n),t.apply(this,arguments)}var r=n.prototype;return r.toDOM=function(){var e=document.createElement("div");return e.className="cm-diff-alignment cm-line",e.innerHTML="&nbsp;",e},r.ignoreEvent=function(){return!1},n}(m.l9);function x(e){var t=new p.f_,n=new w;e.sort(function(e,t){return e.character-t.character});var r=!0,i=!1,o=void 0;try{for(var a,l=e[Symbol.iterator]();!(r=(a=l.next()).done);r=!0)for(var c=a.value,s=c.character,u=c.padding,d=0;d<u;d++)t.add(s,s,m.p.widget({widget:n,side:-1,block:!0}))}catch(e){i=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return t.finish()}function C(e){var t=e.coloredLines,n=e.colorDecoration;return[g,m.lg.fromClass(function e(r){"use strict";(0,d._)(this,e);var i=new p.f_,o=!0,a=!1,l=void 0;try{for(var c,s=t[Symbol.iterator]();!(o=(c=s.next()).done);o=!0){var u=c.value,f=r.state.doc.line(u);i.add(f.from,f.from,n)}}catch(e){a=!0,l=e}finally{try{o||null==s.return||s.return()}finally{if(a)throw l}}this.decorations=i.finish()},{decorations:function(e){return e.decorations}}),p.QQ.define({create:function(){return m.p.none},update:function(e,t){var n=!0,r=!1,i=void 0;try{for(var o,a=t.effects[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value;if(l.is(Z))return l.value}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return t.docChanged?e.map(t.changes):e},provide:function(e){return m.tk.decorations.from(e)}})]}var _=n(20142),S=n(81013),E=n(50959),k=n(4498),T=(r=function(e,t){return m.tk.domEventHandlers({scroll:function(n,r){if(r===e&&n.target){var i=n.target;if(i.scrollTop){var o=i.scrollTop;t.scrollDOM.scrollTo({top:o})}}}})},i=new p.F6,o=new p.F6,{extensions:function(){return{right:i.of([]),left:o.of([])}},setup:function(e,t){e.dispatch({effects:o.reconfigure(r(e,t))}),t.dispatch({effects:i.reconfigure(r(t,e))})}}),R=T.extensions,D=T.setup;function I(e){var t=e.left,n=e.right,r=e.showDiffDecorations,i=void 0===r||r,o=t.code,u=(0,c._)(t,["code"]),d=n.code,f=(0,c._)(n,["code"]),h=(0,S.Z)(),m=h.ref,g=h.view,w=(0,S.Z)(),_=w.ref,k=w.view,T=(0,E.useMemo)(function(){var e=R().left;return u.extensions?[u.extensions,e]:e},[u.extensions]),I=(0,E.useMemo)(function(){var e=R().right;return f.extensions?[f.extensions,e]:e},[f.extensions]);u=(0,l._)((0,a._)({},u),{extensions:T}),f=(0,l._)((0,a._)({},f),{extensions:I});var G=(0,s._)((0,E.useState)(!1),2),B=G[0],A=G[1],P=(0,s._)((0,E.useState)(!1),2),N=P[0],U=P[1];return(0,E.useEffect)(function(){if(g&&k&&B&&N&&i){var e=setTimeout(function(){var e;D(g,k),e=(0,v.Bz)(g.state.doc.sliceString(0),k.state.doc.sliceString(0)),g.dispatch({effects:[p.Py.appendConfig.of(C({coloredLines:e.leftColored.sort(function(e,t){return e-t}),colorDecoration:b})),Z.of(x(e.leftPadded))]}),k.dispatch({effects:[p.Py.appendConfig.of(C({coloredLines:e.rightColored.sort(function(e,t){return e-t}),colorDecoration:y})),Z.of(x(e.rightPadded))]})});return function(){return clearTimeout(e)}}},[g,k,B,N,i]),(0,E.useEffect)(function(){g&&(g.dispatch({changes:{from:0,to:g.state.doc.length,insert:o}}),A(!0))},[o,g]),(0,E.useEffect)(function(){k&&(k.dispatch({changes:{from:0,to:k.state.doc.length,insert:d}}),U(!0))},[d,k]),{left:{view:g,ref:m,code:o,options:u,ready:B},right:{view:k,ref:_,code:d,options:f,ready:N}}}function G(e){var t=e.diffViewer,n=(0,c._)(e,["diffViewer"]),r=(0,a._)({},t.options,n);return(0,u.BX)(u.HY,{children:[(0,u.tZ)(_.ZP,(0,a._)({ref:t.ref,css:{height:t.ready?0:"auto"},initialDoc:t.code,lineWrapping:!1,readOnly:!0},r)),!t.ready&&(0,u.tZ)(k.Z,{code:t.code,language:r.language,filePath:r.filePath,lineNumbers:!r.hideGutter,fontSize:r.fontSize})]})}},54340:function(e,t,n){n.d(t,{Bz:function(){return p},PO:function(){return m}});var r=n(12285),i=n(66626),o=n(96583),a=n(85386),l=n.n(a),c=l().DIFF_DELETE,s=l().DIFF_INSERT,u=l().DIFF_EQUAL;function d(e,t){var n=new(l()),r=n.diff_linesToChars_(e,t),i=r.chars1,o=r.chars2,a=r.lineArray,c=n.diff_main(i,o,!1);return n.diff_charsToLines_(c,a),c}function f(e){return e.split("\n").length-1}function h(e,t,n){if(e>0){var r=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(0===n)return 0;var i=t.indexOf("\n",r);return -1===i?null:1===n?i+1:e(t,n-1,i+1)}(n,t);if(null!==r)return{lineNumber:t,character:r,padding:e}}return null}function p(e,t){var n=!1,r=!1;n="\n"===e[e.length-1],r="\n"===t[t.length-1];for(var o=d(e+(n?"":"\n"),t+(r?"":"\n")),a=0,l=0,p=[],m=[],v=[],g=[],y=0,b=0,Z=0;Z<o.length;Z++){var w=(0,i._)(o[Z],2),x=w[0],C=f(w[1]);switch(x){case c:var _,S=(0,i._)(null!==(_=o[Z+1])&&void 0!==_?_:[],2),E=S[0],k=S[1];a+=C;for(var T=0;T<C;T++)p.push(a-T);var R=C;E===s&&(R-=f(k));var D=h(R,l,t);D&&g.push(D);break;case s:var I,G=(0,i._)(null!==(I=o[Z-1])&&void 0!==I?I:[],2),B=G[0],A=G[1];l+=C;for(var P=0;P<C;P++)m.push(l-P);var N=C;B===c&&(N-=f(A));var U=h(N,a,e);U&&v.push(U);break;case u:l>b&&(b=l),a>y&&(y=a),a+=C,l+=C}}return{leftPadded:v.filter(function(e){return e.lineNumber<b}),rightPadded:g.filter(function(e){return e.lineNumber<y}),leftColored:p,rightColored:m,changedTrailingNewline:n!==r,leftTrailingNewline:n,rightTrailingNewline:r}}var m=function(){"use strict";function e(t,n){(0,r._)(this,e),this.deleted=new Set,this.inserted=new Map,this.linePositions=new Map,this.lineLengths=new Map,this.currentTrailingNewline="\n"===t[t.length-1],this.otherTrailingNewline="\n"===n[n.length-1],this.changedTrailingNewline=this.currentTrailingNewline!==this.otherTrailingNewline;var o=d(t,n),a=[],l=!0,f=!1,h=void 0;try{for(var p,m=o[Symbol.iterator]();!(l=(p=m.next()).done);l=!0){var v=(0,i._)(p.value,2),g=v[0],y=v[1].split("\n");""===y[y.length-1]&&y.pop();var b=!0,Z=!1,w=void 0;try{for(var x,C=y[Symbol.iterator]();!(b=(x=C.next()).done);b=!0){var _=x.value;a.push([g,_])}}catch(e){Z=!0,w=e}finally{try{b||null==C.return||C.return()}finally{if(Z)throw w}}}}catch(e){f=!0,h=e}finally{try{l||null==m.return||m.return()}finally{if(f)throw h}}this.currentTrailingNewline&&!this.otherTrailingNewline?a.push([c,""]):!this.currentTrailingNewline&&this.otherTrailingNewline?a.push([s,""]):this.currentTrailingNewline&&this.otherTrailingNewline&&a.push([u,""]);var S=1,E=0,k=1,T=!0,R=!1,D=void 0;try{for(var I,G=a[Symbol.iterator]();!(T=(I=G.next()).done);T=!0){var B=(0,i._)(I.value,2),A=B[0],P=B[1];switch(A){case c:this.linePositions.set(S,E),this.lineLengths.set(S,P.length),this.deleted.add(S),E+=P.length+1,S++;break;case s:var N=S-1,U=this.inserted.get(N);U||(U=[],this.inserted.set(N,U)),U.push({number:k,content:P}),k++;break;case u:this.linePositions.set(S,E),this.lineLengths.set(S,P.length),E+=P.length+1,S++,k++}}}catch(e){R=!0,D=e}finally{try{T||null==G.return||G.return()}finally{if(R)throw D}}}var t=e.prototype;return t.startInsertions=function(){var e=this.inserted.get(0);return e&&0!==e.length?e:null},t.lineIsDeleted=function(e){return this.deleted.has(e)},t.lineInsertions=function(e){var t=this.inserted.get(e);return t&&0!==t.length?t:null},t.lineInsertedContent=function(e){var t=this.lineInsertions(e);return t?t.map(function(e){return e.content}).join("\n"):null},t.offsetFor=function(e){var t,n,r;r=0+(null!==(n=null===(t=this.inserted.get(0))||void 0===t?void 0:t.length)&&void 0!==n?n:0);for(var i=1;i<e;i++){this.lineIsDeleted(i)&&r--;var o=this.lineInsertions(i);o&&(r+=o.length)}return r},t.linePosition=function(e){var t;return null!==(t=this.linePositions.get(e))&&void 0!==t?t:null},t.lineLength=function(e){var t;return null!==(t=this.lineLengths.get(e))&&void 0!==t?t:null},t.line=function(e){var t=this.linePosition(e),n=this.lineLength(e);if(null===t||null===n)return null;var r=this.offsetFor(e),i=this.lineIsDeleted(e),o=this.lineInsertions(e);return{number:e,from:t,to:t+n,length:n,offset:r,isDeleted:i,insertions:o}},t.lines=function(){var e,t,n,r,a,l,c,s;return(0,o.Jh)(this,function(o){switch(o.label){case 0:e=!0,t=!1,n=void 0,o.label=1;case 1:o.trys.push([1,6,7,8]),r=this.linePositions[Symbol.iterator](),o.label=2;case 2:if(e=(a=r.next()).done)return[3,5];if(l=(0,i._)(a.value,1)[0],!(c=this.line(l)))throw Error("line should not be null");return[4,c];case 3:o.sent(),o.label=4;case 4:return e=!0,[3,2];case 5:return[3,8];case 6:return s=o.sent(),t=!0,n=s,[3,8];case 7:try{e||null==r.return||r.return()}finally{if(t)throw n}return[7];case 8:return[2]}})},e}()},51384:function(e,t,n){n.d(t,{z:function(){return a}});var r=n(12285),i=n(96583),o=n(31157),a=function(){"use strict";function e(t,n,i,o){(0,r._)(this,e),this.a=t,this.b=n,this.chunks=i,this.map=o}var t=e.prototype;return t.line=function(e,t){return t===o.MF.A?this.a.line(e):this.b.line(e)},t.bounds=function(e){if(0===this.chunks.length)return null;var t=(0,o.Cf)(this.chunks[0],e),n=(0,o.Cf)(this.chunks[this.chunks.length-1],e),r=e===o.MF.A?this.a.length:this.b.length,i=Math.min(n.to,r);return{from:t.from,to:i}},t.hasChanges=function(){return this.chunks.length>0},t.updateA=function(t,n){var r=this.b,i=(0,o.U_)(t,r,{chunks:this.chunks,changesA:n}),a=(0,o.XW)(t,r,i);return new e(t,r,i,a)},t.updateB=function(t,n){var r=this.a,i=(0,o.U_)(r,t,{chunks:this.chunks,changesB:n}),a=(0,o.XW)(r,t,i);return new e(r,t,i,a)},t.getContainingChunk=function(e,t){for(var n=0,r=this.chunks.length-1;n<=r;){var i=n+r>>>1,a=this.chunks[i],l=(0,o.Cf)(a,t);if(e>=l.from&&e<=l.to)return a;e<l.from?r=i-1:e>l.to&&(n=i+1)}return null},t.getCorrespondingLine=function(e,t){var n=this.map.get(t===o.MF.A?-e:e);return n?this.line(n,(0,o.rN)(t)):null},t.getLineChangeType=function(e,t){if(this.map.get(t===o.MF.A?-e:e))return o.dQ.UNCHANGED;var n=this.line(e,t),r=this.getContainingChunk(n.from,t);return r?(0,o.dx)(n,t,r.changes,r):o.dQ.UNCHANGED},t.iterLines=function(e){var t,n,r,a;return(0,i.Jh)(this,function(i){switch(i.label){case 0:t=e===o.MF.A?this.a:this.b,n=1,i.label=1;case 1:if(!(n<=t.lines))return[3,4];return r=t.line(n),a=this.getCorrespondingLine(r.number,e),[4,{line:r,correspondingLine:a}];case 2:i.sent(),i.label=3;case 3:return n++,[3,1];case 4:return[2]}})},t.iterRanges=function(){var e,t,n,r,o;return(0,i.Jh)(this,function(i){switch(i.label){case 0:e=0,i.label=1;case 1:if(!(e<this.chunks.length))return[3,6];t=this.chunks[e].fromA,n=this.chunks[e].fromB,r=0,i.label=2;case 2:if(!(r<this.chunks[e].changes.length))return[3,5];return o=this.chunks[e].changes[r],[4,{fromA:t+o.fromA,toA:t+o.toA,fromB:n+o.fromB,toB:n+o.toB}];case 3:i.sent(),i.label=4;case 4:return r++,[3,2];case 5:return e++,[3,1];case 6:return[2]}})},e.create=function(t,n){var r=(0,o.U_)(t,n),i=(0,o.XW)(t,n,r);return new e(t,n,r,i)},e}()},10814:function(e,t,n){n.d(t,{p:function(){return q}});var r,i=n(51051),o=n(12285),a=n(4384),l=n(4955),c=n(9670),s=n(80979),u=n(90367),d=n(29684),f=n(51384),h=n(67075),p=i.r$.define({combine:function(e){var t;return null!==(t=e.filter(Boolean)[0])&&void 0!==t?t:null}}),m=i.QQ.define({create:function(){return{diff:null,tree:d.mp.empty}},update:function(e,t){var n,r,i=t.state.facet(p),o=null===(n=t.state.facet(u.dK))||void 0===n?void 0:n.parser;if(!i)return null===e.diff&&e.tree===d.mp.empty?e:{diff:null,tree:d.mp.empty};var a=e.diff,l=e.tree;return(a&&a.a.eq(i)?t.docChanged&&(a=a.updateB(t.newDoc,t.changes)):(a=f.z.create(i,t.newDoc),l=d.mp.empty),(null===(r=t.startState.facet(u.dK))||void 0===r?void 0:r.parser)!==o&&(l=d.mp.empty),o&&l.length!==a.a.length)?(l=(0,h.p)({parser:o,text:a.a,maxTime:16,base:l}),{diff:a,tree:l}):e.diff===a&&e.tree===l?e:{diff:a,tree:l}}}),v=n(42516),g=n(29287),y="cm-inline-diff-line-deletion-base",b="cm-inline-diff-line-deletion",Z="cm-inline-diff-text-deletion",w="cm-inline-diff-line-insertion-base",x="cm-inline-diff-line-insertion",C="cm-inline-diff-text-insertion",_="rgba(180, 0, 0, 0.075)",S="rgba(180, 0, 0, 0.125)",E="rgba(0, 180, 0, 0.075)",k="rgba(0, 180, 0, 0.125)",T="cm-inline-diff-marker",R="cm-inline-diff-marker-left",D="cm-inline-diff-marker-right";function I(e,t){var n="linear-gradient(to right, ".concat(e,", ").concat(e,")");return t&&(n+=", linear-gradient(to right, ".concat(t,", ").concat(t,")")),n}var G=s.tk.theme((r={},(0,v._)(r,".".concat(y,", .").concat(b),{cursor:"text","&.cm-line ::selection":{backgroundColor:"".concat(g.TV.accentPrimaryDimmest," !important")}}),(0,v._)(r,".".concat(y),{background:I(_)}),(0,v._)(r,".".concat(b),{background:I(_,S)}),(0,v._)(r,".".concat(w),{background:I(E)}),(0,v._)(r,".".concat(x),{background:I(E,k)}),(0,v._)(r,".".concat(C),{display:"inline-block",background:k,"&:first-of-type":{backgroundClip:"padding-box",borderLeft:"3px solid ".concat(k),paddingLeft:"3px",marginLeft:"-6px"}}),(0,v._)(r,".".concat(Z),{display:"inline-block",background:S,"&:first-of-type":{backgroundClip:"padding-box",borderLeft:"3px solid ".concat(S),paddingLeft:"3px",marginLeft:"-6px"}}),(0,v._)(r,".".concat(T),{display:"flex",width:"100%",justifyContent:"space-between"}),(0,v._)(r,".".concat(R),{width:"calc(50% - 1ch)",textAlign:"right"}),(0,v._)(r,".".concat(D),{width:"50%",textAlign:"right"}),r)),B=n(31157),A=n(15658),P=n(3341),N=n.n(P),U=function(e){"use strict";(0,l._)(n,e);var t=(0,c._)(n);function n(e,r,i){var a;return(0,o._)(this,n),(a=t.call(this)).line=e,a.index=r,a.changed=i,a}var r=n.prototype;return r.toDOM=function(){var e=this,t=document.createElement("div");if(t.className=this.changed?"cm-line ".concat(y):"cm-line ".concat(b),!this.changed||!this.changed.length){var n=!0,r=!1,i=void 0;try{for(var o,a=this.line[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value,c=l.text,s=l.tags,u=document.createElement("span");u.textContent=c||"\xa0",u.className=null!=s?s:"",t.appendChild(u)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return t}for(var d=0,f=0,h=null,p=null,m=function(t,n){if(!h)throw Error("range is null");var r=e.line[f],i=r.text,o=r.tags,a=i.slice(d-h.from,n-h.from),l=document.createElement("span");l.textContent=a||"\xa0",l.className=null!=o?o:"",t.appendChild(l),d+=a.length};f<this.line.length;){if(!h){var v=this.line[f].text;h={from:d,to:d+v.length}}if(!p){var g=!0,w=!1,x=void 0;try{for(var C,_=this.changed[Symbol.iterator]();!(g=(C=_.next()).done);g=!0){var S=C.value;if(!(S.from>=h.to)&&!(S.to<=d)){var E=document.createElement("span");E.className=Z,p={from:S.from,to:S.to,dom:E},d<p.from&&m(t,p.from),t.appendChild(E);break}}}catch(e){w=!0,x=e}finally{try{g||null==_.return||_.return()}finally{if(w)throw x}}}p?(d<p.to&&m(p.dom,p.to),d>=p.to&&(p=null)):m(t,h.to),d>=h.to&&(h=null,f++)}return t},r.eq=function(e){var t,r;return e instanceof n&&this.index===e.index&&this.line.length===e.line.length&&(null===(t=this.changed)||void 0===t?void 0:t.length)===(null===(r=e.changed)||void 0===r?void 0:r.length)&&N()(this.line,e.line)&&N()(this.changed,e.changed)},r.ignoreEvent=function(e){return e.stopImmediatePropagation(),!0},(0,a._)(n,[{key:"estimatedHeight",get:function(){return 21}}]),n}(s.l9),O=s.p.line({class:w}),L=s.p.line({class:x}),M=s.p.mark({class:C}),X=s.tk.decorations.compute([m],function(e){var t=function(e,t){if(r.getLineChangeType(e.number,B.MF.B)===B.dQ.COVERED)o.push(L.range(e.from));else{o.push(O.range(e.from));var n=!0,i=!1,a=void 0;try{for(var l,c=(0,B.Po)(e,t,B.MF.B,!1)[Symbol.iterator]();!(n=(l=c.next()).done);n=!0){var s=l.value;o.push(M.range(s.from,s.to))}}catch(e){i=!0,a=e}finally{try{n||null==c.return||c.return()}finally{if(i)throw a}}}},n=e.field(m,!1);if(!n||!n.diff)return s.p.none;var r=n.diff,i=n.tree,o=[],a=!0,l=!1,c=void 0;try{for(var u,d=r.chunks[Symbol.iterator]();!(a=(u=d.next()).done);a=!0){var f=u.value;if(f.fromB!==f.endB)for(var h=r.b.lineAt(f.fromB),p=r.b.lineAt(f.endB),v=h.number;v<=p.number;v++)t(r.b.line(v),f);else f.fromA===f.endA&&t(r.b.lineAt(f.fromB),f);if(f.fromA!==f.toA)for(var g=r.a.lineAt(f.fromA),y=(0,A.CT)(i,r.a,e,f.fromA,f.endA),b=0;b<y.length;b++){var Z=y[b],w=r.a.line(g.number+b),x=r.getLineChangeType(w.number,B.MF.A)===B.dQ.COVERED?null:(0,B.Po)(w,f,B.MF.A,!0),C=s.p.widget({widget:new U(Z,w.number,x),block:!0,side:-(y.length-b)});o.push(C.range(f.fromB))}}}catch(e){l=!0,c=e}finally{try{a||null==d.return||d.return()}finally{if(l)throw c}}return s.p.set(o,!0)}),F=n(92708),W=(0,s.v5)({class:F.Tr,renderEmptyElements:!0,lineMarker:function(e,t){var n=e.state.field(m,!1);if(!n||!n.diff||!n.diff.hasChanges())return null;if(0===n.diff.a.length)return F.vP;var r=e.state.doc.lineAt(t.from);switch(n.diff.getLineChangeType(r.number,B.MF.B)){case B.dQ.COVERED:case B.dQ.MODIFIED:return F.vP;default:return null}},widgetMarker:function(e,t){if(!(t instanceof U))return null;var n=e.state.field(m,!1);if(!n||!n.diff||!n.diff.hasChanges())return null;switch(n.diff.getLineChangeType(t.index,B.MF.A)){case B.dQ.COVERED:case B.dQ.MODIFIED:return F.We;default:return null}},initialSpacer:function(e){var t=e.state.field(m,!1);return(null==t?void 0:t.diff)?F.vP:F.Do},updateSpacer:function(e,t){var n=t.state.field(m,!1),r=(null==n?void 0:n.diff)?F.vP:F.Do;return e===r?e:r}}),H=n(3917),V=function(e){"use strict";(0,l._)(n,e);var t=(0,c._)(n);function n(e,r){var i;return(0,o._)(this,n),(i=t.call(this)).left=e,i.right=r,i}var r=n.prototype;return r.toDOM=function(e){var t=e.state.doc.lines.toString().length,n=document.createElement("div"),r=document.createElement("span"),i=document.createElement("span");return n.className=T,r.className=R,i.className=D,n.style.width="".concat(2*t+1,"ch"),null!==this.left&&(r.textContent=this.left.toString()),null!==this.right&&(i.textContent=this.right.toString()),n.appendChild(r),n.appendChild(i),n},r.eq=function(e){return e instanceof n&&this.left===e.left&&this.right===e.right},n}(s.SJ),z=H.X4.of(function(e,t){if(t instanceof U)return new V(t.index,null)}),j=[H.gy.of(function(e,t){var n,r=e.state.field(m,!1);if(r&&r.diff&&r.diff.hasChanges()){var i=e.state.doc.lineAt(t.from),o=r.diff.getCorrespondingLine(i.number,B.MF.B);return new V(null!==(n=null==o?void 0:o.number)&&void 0!==n?n:null,i.number)}}),z],q=i.r$.define({enables:function(e){return[p.computeN([e],function(t){return t.facet(e)}),F.Lw,m,G,X,j,W]}})},92708:function(e,t,n){n.d(t,{Do:function(){return D},Lw:function(){return S},Tr:function(){return d},Vt:function(){return R},We:function(){return k},vP:function(){return E},wp:function(){return T}});var r,i=n(12285),o=n(42516),a=n(4955),l=n(9670),c=n(80979),s=n(29287),u=s.TV.space2,d="cm-diff-gutter",f="".concat(d,"-element"),h="".concat(f,"-insertion"),p="".concat(f,"-modified"),m="".concat(f,"-deleted"),v="".concat(f,"-file-added"),g=s.TV.greenDefault,y=s.TV.greenStronger,b=s.TV.blueDefault,Z=s.TV.blueStronger,w=s.TV.redDefault,x=s.TV.redStronger,C=s.TV.greenDimmer,_=s.TV.greenDefault,S=c.tk.theme((r={},(0,o._)(r,".".concat(d,":first-of-type, .").concat(f),{width:u}),(0,o._)(r,".".concat(h),{backgroundColor:g,"&.cm-activeLineGutter":{backgroundColor:y}}),(0,o._)(r,".".concat(p),{backgroundColor:b,"&.cm-activeLineGutter":{backgroundColor:Z}}),(0,o._)(r,".".concat(m),{backgroundColor:w,"&.cm-activeLineGutter":{backgroundColor:x}}),(0,o._)(r,".".concat(v),{backgroundColor:C,"&.cm-activeLineGutter":{backgroundColor:_}}),r)),E=new(function(e){"use strict";(0,a._)(n,e);var t=(0,l._)(n);function n(){var e;return(0,i._)(this,n),e=t.apply(this,arguments),e.elementClass="".concat(f," ").concat(h),e}return n}(c.SJ)),k=new(function(e){"use strict";(0,a._)(n,e);var t=(0,l._)(n);function n(){var e;return(0,i._)(this,n),e=t.apply(this,arguments),e.elementClass="".concat(f," ").concat(m),e}return n}(c.SJ)),T=new(function(e){"use strict";(0,a._)(n,e);var t=(0,l._)(n);function n(){var e;return(0,i._)(this,n),e=t.apply(this,arguments),e.elementClass="".concat(f," ").concat(p),e}return n}(c.SJ)),R=new(function(e){"use strict";(0,a._)(n,e);var t=(0,l._)(n);function n(){var e;return(0,i._)(this,n),e=t.apply(this,arguments),e.elementClass="".concat(f," ").concat(v),e}return n}(c.SJ)),D=new(function(e){"use strict";(0,a._)(n,e);var t=(0,l._)(n);function n(){return(0,i._)(this,n),t.apply(this,arguments)}return n}(c.SJ))},14044:function(e,t,n){n.d(t,{el:function(){return c},er:function(){return u},iG:function(){return s}});var r=n(51051),i=n(43182),o=n(54450),a=r.Py.define(),l=r.Py.define(),c=function(e){var t=e.view,n=e.insert,r=e.scrollIntoView;if(e.overwrite)t.dispatch({changes:{from:0,to:t.state.doc.length,insert:n},effects:a.of(null),scrollIntoView:r,annotations:o.Z.of(!0)});else{var i=t.state.selection.main.head;t.dispatch({changes:{from:t.state.selection.main.from,insert:n},selection:{anchor:i+n.length},effects:a.of(null),scrollIntoView:r,annotations:o.Z.of(!0)})}},s=function(e){var t=e.state.field(u,!1);if(!t){i.Tb(Error("RevetGhostwriterCodeInsertState not found when trying to revert"));return}e.dispatch({changes:t,effects:l.of(null)})},u=r.QQ.define({create:function(){return null},update:function(e,t){e&&(e=e.map(t.changes));var n=!0,r=!1,i=void 0;try{for(var o,c=t.effects[Symbol.iterator]();!(n=(o=c.next()).done);n=!0){var s=o.value;s.is(a)&&(e=t.changes.invert(t.startState.doc)),s.is(l)&&(e=null)}}catch(e){r=!0,i=e}finally{try{n||null==c.return||c.return()}finally{if(r)throw i}}return e}})},77858:function(e,t,n){n.d(t,{i:function(){return d},o:function(){return u}});var r=n(56557),i=n(10693),o=n(76804),a=n(63185),l=n(54450),c=n(4753),s=n(27783),u=function(e){var t=e.state.field(a.WF,!1),n=e.state.facet(o.t);if(!t||!t.change||!t.timestamp||Date.now()-t.timestamp<150)return!1;var u=e.state.selection.main.head,d=e.state.doc.lineAt(u);if(u<=d.from+d.length-d.text.trimStart().length){var f=t.change.closestRange(u);if(f.value instanceof c.Yf){var h=f.value.unfulfilled.toString(),p=(0,s.L)(h,e.state.tabSize);if(p>0&&p>=e.state.tabSize)return!1}}var m=t.change.asChangeSpec(),v=e.state.changes(m),g=t.change.extendSelection(e.state.selection);return(0,r._B)(e),e.dispatch({changes:v,selection:g,scrollIntoView:!0,effects:a.OK.of(t.dismiss()),annotations:[l.Z.of(!0),i.Iv.of("full")]}),n.onSuggestionAccepted(e,v),!0},d=function(e){var t=e.state.field(a.WF,!1),n=e.state.facet(o.t);return!!t&&!!t.change&&!!t.presented&&(e.dispatch({effects:a.OK.of(t.dismiss())}),n.onSuggestionExplicitlyDismissed(e),!0)}},76804:function(e,t,n){n.d(t,{t:function(){return r}});var r=n(51051).r$.define({combine:function(e){var t=e.filter(Boolean);return{onDismiss:function(e){return t.forEach(function(t){var n;return null===(n=t.onDismiss)||void 0===n?void 0:n.call(t,e)})},onRequestIgnoredBackendOnly:function(e){return t.forEach(function(t){var n;return null===(n=t.onRequestIgnoredBackendOnly)||void 0===n?void 0:n.call(t,e)})},onRequestFirstEmit:function(e){return t.forEach(function(t){var n;return null===(n=t.onRequestFirstEmit)||void 0===n?void 0:n.call(t,e)})},onRequestEndedWithNoSuggestion:function(e){return t.forEach(function(t){var n;return null===(n=t.onRequestEndedWithNoSuggestion)||void 0===n?void 0:n.call(t,e)})},onRequestCompletelyPresented:function(e){return t.forEach(function(t){var n;return null===(n=t.onRequestCompletelyPresented)||void 0===n?void 0:n.call(t,e)})},onSuggestionExplicitlyDismissed:function(e){return t.forEach(function(t){var n;return null===(n=t.onSuggestionExplicitlyDismissed)||void 0===n?void 0:n.call(t,e)})},onSuggestionAccepted:function(e,n){return t.forEach(function(t){var r;return null===(r=t.onSuggestionAccepted)||void 0===r?void 0:r.call(t,e,n)})}}}})},20916:function(e,t,n){n.d(t,{Z:function(){return f}});var r=n(25632),i=n(75452),o=n(41733),a=n(21262),l=n(71440),c=n(58995);function s(){var e=(0,a._)(['\n  query CompleteCodeEngine {\n    currentUser {\n      id\n      defaultEngine: gateVariation(feature: "flag-ghostwriter-complete-engine")\n      hasOverride: gate(feature: "flag-code-suggestion-engine")\n    }\n  }\n']);return s=function(){return e},e}var u={},d=(0,l.Ps)(s());function f(){var e,t,n,a,l=(0,r.Gn)("completeCodeEngine").preferences,s=(e=(0,o._)({},u,void 0),c.a(d,e)).data,f=null==l?void 0:l.completeCodeEngine;if(f&&(null==s?void 0:null===(t=s.currentUser)||void 0===t?void 0:t.hasOverride)&&i.vw.has(f))return{engine:f,settings:i.Uw[f]};var h=null!==(a=null==s?void 0:null===(n=s.currentUser)||void 0===n?void 0:n.defaultEngine)&&void 0!==a?a:i.OO;return{engine:h,settings:i.Uw[h]}}},21012:function(e,t,n){n.d(t,{Yy:function(){return i},ZP:function(){return p},G_:function(){return h}});var r,i,o=n(85172),a=n(41733),l=n(21262),c=n(71440),s=n(58995);function u(){var e=(0,l._)(['\n  query CompleteCode {\n    currentUser {\n      id\n      hasAiPro\n      hasKillswitch: gate(feature: "flag-killswitch-ghostwriter")\n    }\n  }\n']);return u=function(){return e},e}var d={},f=(0,c.Ps)(u());function h(e){return"None"!==e&&"BackendOnly"!==e}function p(){var e,t=(e=(0,a._)({},d,void 0),s.a(f,e)).data,n=(0,o.v)().isTeamWithAiDisabled,r=null==t?void 0:t.currentUser;return!r||r.hasKillswitch||n?"None":r.hasAiPro?"Pro":"Basic"}(r=i||(i={})).None="None",r.Basic="Basic",r.Pro="Pro",r.BackendOnly="BackendOnly"},70408:function(e,t,n){n.d(t,{S:function(){return h},t:function(){return f}});var r=n(41733),i=n(30509),o=n(66626),a=n(25425),l=n(11516),c=n(90234),s=n(71999),u=n(50959),d="ai.codecomplete.lastTooltipHintTimestamp",f=(0,c.cn)({tooltipOpen:!1,consecutiveRejections:0});function h(){var e=(0,o._)((0,s.KO)(f),2),t=e[0],n=e[1],c=(0,a.P5)({controlName:"flag-killswitch-pichu",logFlagToAnalytics:!1});return(0,u.useEffect)(function(){if(c&&t.tooltipOpen){var e=setTimeout(function(){return n(function(e){return(0,i._)((0,r._)({},e),{tooltipOpen:!1})})},2500);return function(){return clearTimeout(e)}}},[c,t.tooltipOpen,n]),(0,u.useMemo)(function(){return c?{recordAccept:function(){n(function(e){return(0,i._)((0,r._)({},e),{consecutiveRejections:0})})},recordReject:function(){n(function(e){var t=e.consecutiveRejections+1;if(t>=5){var n=l.Z.get(d,"number");if(!n||Date.now()-n>=432e6)return l.Z.set(d,Date.now()),(0,i._)((0,r._)({},e),{consecutiveRejections:t,tooltipOpen:!0})}return(0,i._)((0,r._)({},e),{consecutiveRejections:t})})}}:null},[c,n])}},578:function(e,t,n){n.d(t,{Z:function(){return em}});var r=n(41733),i=n(30509),o=n(43182),a=n(51051),l=n(80979),c=n(77858),s=a.r$.define({combine:function(e){var t;return null!==(t=e.filter(Boolean)[0])&&void 0!==t?t:null}}),u=n(12285),d=n(83684),f=n(63185),h=n(86865),p=n(54450),m=a.QQ.define({create:function(){return null},update:function(e,t){if(t.annotation(p.Z)||!t.state.field(f.WF).stopped)return null;if(!t.docChanged&&!t.selection)return e;var n=t.newDoc,r=t.newSelection.main.head;return t.annotation(a.YW.remote)?null!==e&&(0,d.zV)(n,r)&&(0,d.to)(n,r)?e:null:t.selection&&t.isUserEvent("select")?(0,d.zV)(n,r)&&(0,d.to)(n,r)?Date.now():null:t.docChanged&&null!==e?(0,d.zV)(n,r)&&(0,d.to)(n,r)?e:null:e}}),v=function(){"use strict";function e(t){(0,u._)(this,e),this.view=t,this.timeout=null}var t=e.prototype;return t.update=function(e){var t=this,n=e.startState.field(m),r=e.state.field(m);n!==r&&(null!==this.timeout&&(clearTimeout(this.timeout),this.timeout=null),null!==r&&(this.timeout=setTimeout(function(){t.timeout=null,t.view.dispatch({effects:[h.mb.of(h.xz.NOW)]})},2500)))},t.destroy=function(){null!==this.timeout&&(clearTimeout(this.timeout),this.timeout=null)},e}(),g=l.lg.fromClass(v,{provide:function(){return m}}),y=n(4384),b=n(90367),Z=n(43647),w=n(76804),x=n(31417),C=n(27387),_=n(96583),S=function(){"use strict";function e(t){var n=this;(0,u._)(this,e),this.config=t,this.finished=!1,this.abortController=new AbortController,this.suggestion="",this.promise=this.start(),this.abortController.signal.addEventListener("abort",function(){if(!n.finished){var e,t;n.finished=!0,null===(e=(t=n.config).onFinished)||void 0===e||e.call(t,null)}})}var t=e.prototype;return t.start=function(){var e=this;return(0,C._)(function(){var t,n,r,i,o,a,l,c,s,u,f,h,p,m,v,g,y,b,Z,w,C,S,E,k,T,R,D,I;return(0,_.Jh)(this,function(_){switch(_.label){case 0:_.trys.push([0,13,,14]),r="",i=!0,o=!1,a=void 0;try{for(l=e.config.prefix.iter(-1)[Symbol.iterator]();!(i=(c=l.next()).done)&&(u=(s=c.value).trimEnd(),r=(s?s.slice(u.length):"\n")+r,!(u.length>0));i=!0);}catch(e){o=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw a}}f=e.config.prefix.length-r.length,h=r?e.config.prefix.slice(0,f):e.config.prefix,p=e.config.request({language:e.config.language,filePath:e.config.filePath,code:h.toString(),suffix:e.config.suffix?e.config.suffix.toString():void 0,maxTokens:e.config.maxTokens,signal:e.abortController.signal}),m=!0,v=!!r,g="",y=!1,b=!1,_.label=1;case 1:_.trys.push([1,6,7,12]),w=(0,x._)(p),_.label=2;case 2:return[4,w.next()];case 3:if(!(y=!(C=_.sent()).done))return[3,5];if(S=C.value,v){if(g+=S,(0,d.xb)(S))return[3,4];if(v=!1,E=(0,d.O8)(g),k=(0,d.O8)(r),!E.indentation.startsWith(k.indentation)||!!k.newlines!=!!E.newlines)return e.abort(),[3,5];S=E.indentation.slice(k.indentation.length)+E.content}if(e.suggestion+=S,e.config.onTextReceived&&!1===e.config.onTextReceived(e.suggestion,m))return e.abort(),[3,5];m=!1,_.label=4;case 4:return y=!1,[3,2];case 5:return[3,12];case 6:return T=_.sent(),b=!0,Z=T,[3,12];case 7:if(_.trys.push([7,,10,11]),!(y&&null!=w.return))return[3,9];return[4,w.return()];case 8:_.sent(),_.label=9;case 9:return[3,11];case 10:if(b)throw Z;return[7];case 11:return[7];case 12:return[3,14];case 13:return R=_.sent(),e.aborted||e.abort(),R instanceof DOMException&&"AbortError"===R.name||null===(D=(I=e.config).onError)||void 0===D||D.call(I,R),[3,14];case 14:if(e.aborted)return[2,null];return e.finished=!0,null===(t=(n=e.config).onFinished)||void 0===t||t.call(n,e.suggestion),[2,e.suggestion]}})})()},t.abort=function(){this.aborted||this.abortController.abort()},t.then=function(e,t){return this.promise.then(e,t)},(0,y._)(e,[{key:"aborted",get:function(){return this.abortController.signal.aborted}}]),e}(),E=n(17925),k=n(66899),T=n(89798),R=n(7612),D=n(73164),I=function(){"use strict";function e(t){(0,u._)(this,e),this.view=t,this.destroyed=!1,this.stream=null,this.debounceTimeout=null,this.queued=!1,this.lastPrefixLength=0}var t=e.prototype;return t.dispatchSuggestion=function(e){this.view.dispatch({effects:f.OK.of(e)})},t.dismiss=function(){this.queued=!1,null!==this.debounceTimeout&&(clearTimeout(this.debounceTimeout),this.debounceTimeout=null),!this.stream||this.stream.finished||this.stream.aborted||this.stream.abort(),this.destroyed||this.suggestion.stopped||this.dispatchSuggestion(this.suggestion.dismiss()),this.listeners.onDismiss(this.view)},t.requestSuggestion=function(e){var t,n,r=this;if(null!==this.config&&null!==this.fileTypeConfig){if(null!==this.debounceTimeout&&(clearTimeout(this.debounceTimeout),this.debounceTimeout=null),!this.config.debounceAlways&&e===h.xz.NOW){this.requestSuggestionImmediately();return}var i=this.view.state.selection.main.head,o=this.view.state.wordAt(i),a=o&&o.from!==i?null!==(n=this.config.debounceTimeInsideWord)&&void 0!==n?n:0:null!==(t=this.config.debounceTimeOutsideWord)&&void 0!==t?t:0;0===a?this.requestSuggestionImmediately():this.debounceTimeout=setTimeout(function(){r.debounceTimeout=null,r.requestSuggestionImmediately()},a)}},t.requestSuggestionImmediately=function(){var e,t,n,r,i=this;if(this.dismiss(),null!==this.config&&null!==this.fileTypeConfig&&!this.destroyed&&this.view.hasFocus&&(0,d.zV)(this.view.state.doc,this.view.state.selection.main.head)){var a=this.config,l=this.view.state,c=l.selection.main.head,s=l.doc,u=(0,b.qz)(l),f=null!==(t=null===(e=l.facet(b.dK))||void 0===e?void 0:e.parser)&&void 0!==t?t:null,p=this.fileTypeConfig,m=null!==(n=p.excludeLastIndent)&&void 0!==n&&n,v=null!==(r=p.skipComplexProcessing)&&void 0!==r&&r,g=l.facet(E.r),y=(0,d.$j)(s,l.facet(b.c),c),w=a.infill?(0,d.WN)(s,c,m):null,x=Z.uV.DEFAULT;(0,k.ib)(s,u,c)&&(x=a.supportsExpandedMaximumTokens?Z.uV.EMPTY_BLOCK_EXPANDED:Z.uV.EMPTY_BLOCK),this.lastPrefixLength=y.length,a.backendOnly||this.dispatchSuggestion(this.suggestion.start());var C=E.q.create("",c,s,u,f);this.stream=new S({request:a.request,language:p.id,filePath:p.path,maxTokens:x,prefix:y,suffix:w,onTextReceived:function(e,t){if(t&&i.listeners.onRequestFirstEmit(i.view),a.backendOnly){i.listeners.onRequestIgnoredBackendOnly(i.view);return}if(i.suggestion.stopped||(C=C.with({source:e}).process({excludeLastIndent:m,skipComplexProcessing:v,syntaxBasedCutting:g})).empty)return!1;var n=i.suggestion.merge(C.insertions);if(n.stopped)return!1;i.dispatchSuggestion(n)},onFinished:function(e){var t=i.queued;if(i.queued=!1,!a.backendOnly){if(e&&!i.suggestion.stopped&&!(C=C.with({source:e}).process({excludeLastIndent:m,skipComplexProcessing:v,syntaxBasedCutting:g})).empty){var n=i.suggestion.merge(C.insertions);if(!n.stopped){i.dispatchSuggestion(n.present()),i.listeners.onRequestCompletelyPresented(i.view);return}}i.dismiss(),t&&i.requestSuggestion(h.xz.ENQUEUE),""===e&&i.listeners.onRequestEndedWithNoSuggestion(i.view)}},onError:function(e){o.$e(function(t){t.setExtra("prefix",y.toString()),t.setExtra("maxTokens",x),t.setExtra("language",p.id),t.setExtra("selection-head",c),t.setExtra("previous-character",s.sliceString(c-1,c)),a.onErrorExtras&&t.setExtras(a.onErrorExtras(i)),t.setTag("ghostwriter",!0),o.Tb(e)})}})}},t.postUpdate=function(e){(0,R.a)(e,s,T.Yp)&&this.dismiss(),(0,R.a)(e,f.WF)&&this.suggestion.stopped&&this.streaming&&this.dismiss();var t=(0,h.Io)(e.transactions);switch(t){case h.xz.STOP:this.active&&this.dismiss();break;case h.xz.ENQUEUE:case h.xz.NOW:this.active?this.queued=!0:this.requestSuggestion(t)}},t.destroy=function(){this.destroyed=!0,this.dismiss()},(0,y._)(e,[{key:"config",get:function(){return this.view.state.facet(s)}},{key:"listeners",get:function(){return this.view.state.facet(w.t)}},{key:"suggestion",get:function(){return this.view.state.field(f.WF)}},{key:"fileTypeConfig",get:function(){var e,t=this.view.state.facet(T.Yp);if(!t)return null;var n=D.$R.from(t);if(!n)return null;var o=null===(e=n.getFeature("ai"))||void 0===e?void 0:e.complete;return(null==o?void 0:o.enabled)?(0,i._)((0,r._)({},o),{id:n.id,path:null!=t?t:""}):null}},{key:"streaming",get:function(){return null!==this.debounceTimeout||null!==this.stream&&!this.stream.finished}},{key:"active",get:function(){return this.streaming||!this.suggestion.stopped}}]),e}(),G=l.lg.fromClass(I,{provide:function(e){return l.tk.updateListener.of(function(t){var n;null===(n=t.view.plugin(e))||void 0===n||n.postUpdate(t)})}}),B=function(){"use strict";function e(t){(0,u._)(this,e),this.view=t,this.gesture=null,this.touchstart=this.touchstart.bind(this),this.touchmove=this.touchmove.bind(this),this.touchend=this.touchend.bind(this),this.touchcancel=this.touchcancel.bind(this),t.dom.addEventListener("touchstart",this.touchstart)}var t=e.prototype;return t.shouldAllowSwiping=function(){if(!this.view.hasFocus)return!1;var e=this.view.state.selection.main.head,t=this.view.viewport;if(t.from>e||t.to<e)return!1;var n=this.view.state.field(f.WF,!1);return!!n&&!!n.change&&!!n.presented},t.stop=function(){this.gesture&&(this.gesture=null,document.removeEventListener("touchmove",this.touchmove),document.removeEventListener("touchend",this.touchend),document.removeEventListener("touchcancel",this.touchcancel))},t.touchFor=function(e){if(!this.gesture)return null;var t=!0,n=!1,r=void 0;try{for(var i,o=e.changedTouches[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;if(a.identifier===this.gesture.id)return a}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}return null},t.touchstart=function(e){if(this.gesture&&!this.gesture.time)return this.stop();if(!this.gesture&&this.shouldAllowSwiping()&&1===e.changedTouches.length){var t=e.changedTouches[0];this.gesture={id:t.identifier,start:{x:t.clientX,y:t.clientY},end:{x:t.clientX,y:t.clientY},time:null},document.addEventListener("touchmove",this.touchmove,{passive:!1}),document.addEventListener("touchend",this.touchend,{passive:!1}),document.addEventListener("touchcancel",this.touchcancel)}},t.touchmove=function(e){var t=this.touchFor(e);if(this.gesture&&t){if(this.gesture.end.x=t.clientX,this.gesture.end.y=t.clientY,this.gesture.time&&Date.now()-this.gesture.time>500)return this.stop();var n=Math.abs(this.gesture.start.y-this.gesture.end.y),r=Math.abs(this.gesture.start.x-this.gesture.end.x);if(n>20)return this.stop();if(r>10){if(this.gesture.start.x>this.gesture.end.x)return this.stop();this.gesture.time||(this.gesture.time=Date.now()),e.preventDefault()}}},t.touchend=function(e){var t=this.touchFor(e);if(this.gesture&&t){this.gesture.end.x=t.clientX,this.gesture.end.y=t.clientY;var n=Math.abs(this.gesture.start.y-this.gesture.end.y),r=Math.abs(this.gesture.start.x-this.gesture.end.x);n<=20&&r>75&&this.gesture.start.x<this.gesture.end.x&&(!this.gesture.time||Date.now()-this.gesture.time<500)&&((0,c.o)(this.view),e.preventDefault()),this.stop()}},t.touchcancel=function(e){this.touchFor(e)&&this.stop()},t.update=function(){this.gesture&&!this.shouldAllowSwiping()&&this.stop()},t.destroy=function(){this.view.dom.removeEventListener("touchstart",this.touchstart),document.removeEventListener("touchmove",this.touchmove),document.removeEventListener("touchend",this.touchend),document.removeEventListener("touchcancel",this.touchcancel)},e}(),A=l.lg.fromClass(B),P=n(27308),N=a.r$.define({combine:function(e){var t;return null!==(t=e.filter(Boolean)[0])&&void 0!==t?t:null},enables:function(e){return[s.compute([e],function(t){return t.facet(e)}),f.WF,h._v,G,A,g,a.Wl.high(l.$f.compute([e],function(t){var n=t.facet(e),r=[];return(null==n?void 0:n.keyAcceptSuggestion)&&r.push({key:(0,P.cU)(n.keyAcceptSuggestion),run:c.o}),(null==n?void 0:n.keyDismissSuggestion)&&r.push({key:(0,P.cU)(n.keyDismissSuggestion),run:c.i}),r}))]}}),U=n(17528),O=n(2178),L=n(50959),M=n(12338);function X(){return(X=(0,O._)(function(e){var t,n,r,i;return(0,_.Jh)(this,function(o){switch(o.label){case 0:t=e.getReader(),o.label=1;case 1:return[4,(0,U._)(t.read())];case 2:if(r=(n=o.sent()).done,i=n.value,r)return[3,4];return[4,i];case 3:return o.sent(),[3,1];case 4:return t.releaseLock(),[2]}})})).apply(this,arguments)}function F(){return(F=(0,O._)(function(e){var t,n,r,i,o,a,l,c;return(0,_.Jh)(this,function(s){switch(s.label){case 0:t=new TextDecoder("utf-8"),n=!1,r=!1,s.label=1;case 1:s.trys.push([1,7,8,13]),o=(0,x._)(function(e){return X.apply(this,arguments)}(e)),s.label=2;case 2:return[4,(0,U._)(o.next())];case 3:if(!(n=!(a=s.sent()).done))return[3,6];return l=a.value,[4,t.decode(l,{stream:!0})];case 4:s.sent(),s.label=5;case 5:return n=!1,[3,2];case 6:return[3,13];case 7:return c=s.sent(),r=!0,i=c,[3,13];case 8:if(s.trys.push([8,,11,12]),!(n&&null!=o.return))return[3,10];return[4,o.return()];case 9:s.sent(),s.label=10;case 10:return[3,12];case 11:if(r)throw i;return[7];case 12:return[7];case 13:return[2]}})})).apply(this,arguments)}var W=n(21012),H=n(2689),V=n(12621),z=new Map,j={beforeCompletion:function(e){o.n_({category:"ghostwriter",message:"Called completeCode: "+e.engine,level:"debug"});var t=V.YX.add(e),n=H.kg.timeStart({language:e.language,engine:e.engine,replid:e.replId,codeLength:e.code.length});return z.set(t,n),t},afterCompletion:function(e,t,n,r){switch(e){case"aborted":V.YX.abort(r),z.delete(r);break;case"success":o.n_({category:"ghostwriter",message:"Suggestion emitted: "+n.partialSuggestion,level:"debug"});var i=z.get(r);if(!i)throw Error("No latency logger found for handle: "+JSON.stringify(r));i("code suggestion",{type:"success"}),z.delete(r);break;case"finished":V.YX.complete(r,{__typename:"CompleteCodeResult",id:Date.now().toString(),code:n.completeSuggestion});break;default:throw Error("Unknown completion kind: "+e)}},erroredCompletion:function(e,t){t&&(V.YX.abort(t),z.delete(t)),H.kg.error("CompleteCode: error in completion provider",{err:String(e)})}},q=n(59868),Y=n(93748),$=n(75023),J=n(25632),K=n(25425),Q=n(50782),ee=n(50199),et=n(96003),en=n(95683);function er(e){return JSON.stringify({text:e})+"\n"}var ei=function(){"use strict";function e(){(0,u._)(this,e),this.list=[]}var t=e.prototype;return t.add=function(e,t,n){this.list.push({prefix:e,suggestion:t,tokens:n}),this.list.length>25&&this.list.pop(),this.list.sort(function(e,t){return t.suggestion.length-e.suggestion.length})},t.retrieve=function(e,t){for(var n=0;n<this.list.length;n++){var r=this.list[n],i=r.prefix,o=r.suggestion,a=r.tokens;if(!(2*a<t)){if(e===i)return er(o);if(!(i.length>e.length||i.length+o.length<=e.length||2*Math.floor((i.length+o.length-e.length)/(o.length/a))<t)){var l=o.lastIndexOf("\n");if(-1===l||!(l<=e.length-i.length)){var c=i+o;if(c.startsWith(e)){var s=c.slice(e.length);if(s.trim().length)return er(s)}}}}}return null},e}(),eo=n(66626),ea=n(54916),el=n(58091),ec=n(19659),es={javascript:["javascript","typescript"],python:["python","python3"],python3:["python","python3"],typescript:["javascript","typescript"]},eu=["json"],ed=n(20916),ef=n(70408),eh=new $.j(function(e,t,n,r,i,o,a,l,c,s,u,d){var f,p;return e?(n===W.Yy.Pro?(f=Z.Dz,p=s?Z.Dd:Z.Dz):(f=c,p=s?Z.VF:c),[N.of({request:a,infill:o,backendOnly:n===W.Yy.BackendOnly,debounceTimeOutsideWord:f,debounceTimeInsideWord:p,debounceAlways:n!==W.Yy.Pro,supportsExpandedMaximumTokens:"replit-v1-5-3b"===t||"replit-repltuned-v1-5-3b"===t,keyAcceptSuggestion:r,keyDismissSuggestion:i,onErrorExtras:function(){return l}}),h._b.of(u),E.r.of(d)]):null}),ep=new $.j(function(e,t,n){if(!e)return null;var a,l,c=(a=null,l=function(){},{queue:function(e){if(!(Math.random()>.1)){a&&clearTimeout(a);var t=function(){(0,q.j)(q.U3.CODE_SUGGESTION_USED,(0,r._)({type:"suggestionPresented"},e))};a=setTimeout(t,500),l=t}},flush:function(){a&&clearTimeout(a),l()},cancel:function(){a&&clearTimeout(a)}});return w.t.of({onDismiss:function(){c.cancel()},onRequestIgnoredBackendOnly:function(){o.n_({category:"ghostwriter",message:"called completeCode for free user but did not show the ghost text.",level:"info"}),(0,q.j)(q.U3.CODE_SUGGESTION_USED,(0,i._)((0,r._)({type:"suggestionNotPresented"},t),{reason:"ghostTextNotEnabledForFreeUser"}))},onRequestFirstEmit:function(e){var n=e.plugin(G);n&&(o.n_({category:"ghostwriter",message:"Suggestion presented",level:"debug"}),c.queue((0,i._)((0,r._)({},t),{prefixLength:n.lastPrefixLength})))},onRequestEndedWithNoSuggestion:function(){o.n_({category:"ghostwriter",message:"Exited completeCode iteration with no suggestion.",level:"info"}),(0,q.j)(q.U3.CODE_SUGGESTION_USED,(0,i._)((0,r._)({type:"suggestionNotPresented"},t),{reason:"noSuggestion"}))},onSuggestionAccepted:function(e,a){var l=e.plugin(G);if(l){c.flush();var s=Math.abs(a.newLength-a.length);(0,q.j)(q.U3.CODE_SUGGESTION_USED,(0,i._)((0,r._)({type:"suggestionAccepted"},t),{prefixLength:l.lastPrefixLength,suggestionLength:s})),o.n_({category:"ghostwriter",message:"Suggestion accepted",level:"info"}),null==n||n.recordAccept()}},onSuggestionExplicitlyDismissed:function(e){var a=e.plugin(G);a&&(c.flush(),(0,q.j)(q.U3.CODE_SUGGESTION_USED,(0,i._)((0,r._)({type:"suggestionDismissed"},t),{prefixLength:a.lastPrefixLength})),o.n_({category:"ghostwriter",message:"Suggestion explicitly dismissed",level:"info"}),null==n||n.recordReject())}})});function em(e){var t,n,i,o,a,l,c,s,u,d,f,h=e.filePath,p=(0,Q.Z)(),m=(0,J.Gn)("codeSuggestion").preferences,v=(0,W.ZP)(),g=m.codeSuggestion&&v!==W.Yy.None;(0,L.useEffect)(function(){V.YX.toggle(g)},[g]);var y=(0,ed.Z)(),b=y.engine,w=y.settings,S=(0,et.gf)(Y.CN.acceptPrimaryCompletion.id),E=(0,et.gf)(Y.CN.cancelCompletion.id),k=null!==(f=null==w?void 0:w.infill)&&void 0!==f&&f,T=(0,en.S)(h),R=function(e,t){var n,r,i,o,a,l,c,s,u,d,f=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,h=arguments.length>3&&void 0!==arguments[3]?arguments[3]:6,p=(0,ea.Z)().fs,m=(r=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6,r=(0,K.P5)({controlName:"flag-ghostwriter-neighboring-context",logFlagToAnalytics:!0}),i=(0,el.Bx)(),o=(0,eo._)((0,L.useState)(null),2),a=o[0],l=o[1];return(0,L.useEffect)(function(){l(r?i.filter(function(n){var r,i;return(!!((r=(0,en.S)(n).toLowerCase())===(i=e.toLowerCase())||eu.includes(r))||!!es[r]&&es[r].includes(i))&&n!==t&&(0,ec.Mb)(n)}).slice(0,n):null)},[e,t,r,n,i]),a}(e,t,h),i=(0,L.useCallback)(function(e,t){var n;return{type:"file",code:(n=e.split("\n")).slice(Math.max(0,n.length-f)).join("\n"),path:t}},[f]),o=(0,L.useCallback)((n=(0,C._)(function(e){return(0,_.Jh)(this,function(t){switch(t.label){case 0:return[4,p.readFile(e)];case 1:return[2,t.sent()]}})}),function(e){return n.apply(this,arguments)}),[p]),l=(a=(0,eo._)((0,L.useState)([]),2))[0],c=a[1],u=(s=(0,eo._)((0,L.useState)(!1),2))[0],d=s[1],(0,L.useEffect)(function(){r&&(d(!0),(0,C._)(function(){var e;return(0,_.Jh)(this,function(t){switch(t.label){case 0:var n;return[4,Promise.all(r.map((n=(0,C._)(function(e){var t;return(0,_.Jh)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,o(e)];case 1:if((t=n.sent()).error)return[2,!1];return[2,i(t.content.toString(),e)];case 2:return n.sent(),[2,!1];case 3:return[2]}})}),function(e){return n.apply(this,arguments)})))];case 1:return e=t.sent().filter(Boolean),d(!1),c(e),[2]}})})())},[r,o,i]),{cachedFiles:l,loading:u}).cachedFiles;return null!=m?m:[]}(T,h),D=(0,ee.Z)(function(){return new ei},[T,h,p,b]),I=(n=(t={engine:b,replId:p,context:R,settings:{infill:k},provider:(0,ee.Z)(function(){var e;return e=(0,C._)(function(e,t){var n,r,i,o,a,l;return(0,_.Jh)(this,function(c){switch(c.label){case 0:return[4,fetch("/ai/complete",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},signal:t,body:JSON.stringify(e)})];case 1:if(r=(n=c.sent()).body,!(200!==(i=n.status)))return[3,3];return o=Error.bind,l=(a="Error (".concat(i,") response from /ai/complete: ")).concat,[4,n.text()];case 2:throw new(o.apply(Error,[void 0,l.apply(a,[c.sent()])]));case 3:if(!r)throw Error("No body in response");return[2,function(){return function(e){return F.apply(this,arguments)}(r)}]}})}),function(t,n){return e.apply(this,arguments)}},[]),cache:D,hooks:j}).engine,i=t.replId,o=t.context,a=t.settings,l=t.provider,c=t.cache,s=t.hooks,u=a.infill,(0,L.useCallback)((d=(0,O._)(function(e){var t,a,d,f,h,p,m,v,g,y,b,Z,w,C,S,E,k,T,R,D,I,G,B,A,P,N;return(0,_.Jh)(this,function(L){switch(L.label){case 0:if(t=e.language,a=e.filePath,d=e.code,f=e.suffix,h=e.signal,p=e.maxTokens,!d)return[2];if(m="markdown"===t?{maxTokens:75,stop:[]}:{},v=(0,r._)({language:t,code:d,suffix:u?f:void 0,replId:i,filePath:a,engine:n,maxTokens:p,context:o,stop:["\n\n","```"]},m),g=null==s?void 0:s.beforeCompletion(v),!(null!==(b=c.retrieve(d,p))))return[3,1];return y=(0,O._)(function(){return(0,_.Jh)(this,function(e){switch(e.label){case 0:return[4,b];case 1:return e.sent(),[2]}})}),[3,4];case 1:return L.trys.push([1,3,,4]),[4,(0,U._)(l(v,h))];case 2:return y=L.sent(),[3,4];case 3:if((null==(Z=L.sent())?void 0:Z.name)==="AbortError")return[2];return null==s||s.erroredCompletion(Z instanceof Error?Z:Error("Unknown error"),g),[2];case 4:w="",C="",S=!0,E=!1,h.addEventListener("abort",function(){g&&(null==s||s.afterCompletion("aborted",v,{},g)),E=!0}),k=!1,T=!1,L.label=5;case 5:L.trys.push([5,13,14,19]),D=(0,x._)(y()),L.label=6;case 6:return[4,(0,U._)(D.next())];case 7:if(!(k=!(I=L.sent()).done))return[3,12];G=I.value,C+=G,B=void 0,L.label=8;case 8:if(!(-1!==(B=C.indexOf("\n"))))return[3,11];if(A=JSON.parse(C.substring(0,B)).text,C=C.substring(B+1),P=(0,M.Hy)(A,t).replacementSuggestion,w+=P,E)return[3,10];return[4,P];case 9:L.sent(),L.label=10;case 10:return!E&&S&&g&&(null==s||s.afterCompletion("success",v,{fromCache:!!b,partialSuggestion:P},g)),S=!1,(0,M.cx)(w).haltAfter&&(E=!0),[3,8];case 11:return k=!1,[3,6];case 12:return[3,19];case 13:return N=L.sent(),T=!0,R=N,[3,19];case 14:if(L.trys.push([14,,17,18]),!(k&&null!=D.return))return[3,16];return[4,D.return()];case 15:L.sent(),L.label=16;case 16:return[3,18];case 17:if(T)throw R;return[7];case 18:return[7];case 19:if(null===b&&w.trim().length&&c.add(d,w,p),!(!E&&C))return[3,21];return[4,C];case 20:L.sent(),L.label=21;case 21:return g&&(null==s||s.afterCompletion("finished",v,{completeSuggestion:w,fromCache:!!b},g)),[2]}})}),function(e){return d.apply(this,arguments)}),[n,i,o,u,c,s,l])),G=(0,ef.S)(),B=(0,L.useMemo)(function(){return{filePath:h,language:T,engine:b,additionalContextCount:R.length,additionalContextLength:R.reduce(function(e,t){return e+t.code.length},0)}},[h,T,b,R]),A=(0,K.P5)({controlName:"flag-gw-magikarp-bounce-time",logFlagToAnalytics:!1,default:Z.yr,type:"number"}),P=(0,K.P5)({controlName:"flag-ghostwriter-alternate-debounce",logFlagToAnalytics:!0}),N=(0,K.P5)({controlName:"flag-completely-different-tree-trigger",logFlagToAnalytics:!0}),X=(0,K.P5)({controlName:"flag-completely-different-tree-cutting",logFlagToAnalytics:!0}),H=[eh.use(g,b,v,S,E,k,I,B,A,P,N,X),ep.use(g,B,G)];return(0,L.useMemo)(function(){return H},H)}},71749:function(e,t,n){n.d(t,{$_:function(){return G},Bc:function(){return B},II:function(){return k},If:function(){return E},U1:function(){return I},Xs:function(){return R},fL:function(){return S},k4:function(){return D}});var r=n(66626),i=n(63257),o=n(74985),a=n(43704),l=n(26508),c=n(87659),s=n(93496),u=n(74833),d=n(30983),f=n(56596),h=n(93918),p=n(12880),m=n(88936),v=n(39511),g=n(25753),y=n(29287),b=n(80431),Z=n(50959),w=[y.l0.p(4),y.l0.center,y.l0.borderRadius(4)],x=(0,h.X)({root:(0,i._)(w).concat([y.l0.cursor.pointer,(0,c.ec)("blurple")]),disabled:(0,i._)(w).concat([(0,c.ec)("grey")])});function C(e){return e.disabled?(0,o.tZ)(f.G,{css:x.disabled,tag:"button","data-cy":"ghostwriter-inline-submit",children:(0,o.tZ)(v.Z,{size:12})}):(0,o.tZ)(f.G,{"data-cy":"ghostwriter-inline-submit",css:x.root,tag:"button",onClick:e.onClick,children:e.loading?(0,o.tZ)(g.Z,{size:12}):(0,o.tZ)(v.Z,{size:12})})}var _=(0,h.X)({root:[y.l0.py(8),y.l0.pr(8),y.l0.maxWidth(800),{fontFamily:y.TV.fontFamilyDefault}],container:[y.l0.position.relative,y.l0.backgroundColor.backgroundDefault],input:[s.gU.outlined,y.l0.borderRadius(4),{paddingBottom:36,"@media (hover: hover)":{":not([disabled]):hover":{backgroundColor:"transparent"}}}],textarea:[y.l0.p(8),y.l0.pb(0),{caretColor:"initial",fontFamily:y.TV.fontFamilyDefault,border:"0 none",resize:"none",height:"1em",backgroundColor:"transparent","@media (hover: hover)":{":not([disabled]):focus":{outline:"0 none"}},"::placeholder":{color:y.TV.foregroundDimmest}}],footer:[y.l0.px(8),y.l0.pr(6),y.l0.rowWithGap(8),y.l0.align.center,y.l0.position.absolute,y.l0.bottom(0),y.l0.left(0),y.l0.width("100%"),{height:36}],footerLeft:[y.l0.rowWithGap(8),y.l0.flex.growAndShrink(1),y.l0.align.center],iconText:[y.l0.rowWithGap(4),y.l0.align.center],footerRight:[y.l0.rowWithGap(4),y.l0.align.center,{"& button":[y.l0.height(22),y.l0.py(6),y.l0.py(4),y.l0.borderRadius(4)]}],error:[y.l0.color.accentNegativeStronger]}),S=function(e){var t=e.requestMeasure,n=e.type,r=e.children,i=e.isCodeMirrorPocket,a=(0,l.Z)(t);return(0,o.tZ)(b.Z,{bsod:!0,tags:{ai:!0},extras:{type:n},origin:"ErrorBoundary: InlineAiWidget",children:(0,o.tZ)(f.G,{css:_.root,innerRef:a,className:void 0===i||i?"cm-pocket-widget":void 0,children:r})})},E=function(e){var t=e.requestMeasure,n=e.type,r=e.children,i=e.isCodeMirrorPocket;return(0,o.tZ)(S,{type:n,requestMeasure:t,isCodeMirrorPocket:void 0===i||i,children:(0,o.tZ)(f.G,{css:_.container,children:r})})};function k(e){var t=(0,a.Z)();return(0,o.tZ)(f.G,{css:_.input,children:(0,o.tZ)("textarea",{value:e.value,onChange:e.onChange,placeholder:e.placeholder,css:_.textarea,ref:t.ref,onKeyDown:e.onKeyDown,autoFocus:e.autoFocus,"data-cy":"ghostwriter-inline-input"})})}var T={generateCode:"Generate new code based on this file.",transformCode:"Modify selected code based on the context of this file."};function R(e){var t=e.type;return(0,o.tZ)(d.u,{tooltip:T[t],children:(0,o.BX)(f.G,{css:_.iconText,children:[(0,o.tZ)(p.Z,{size:12,color:y.TV.foregroundDimmest}),(0,o.tZ)(u.xv,{variant:"small",color:"dimmest",children:"transformCode"===t?"Modify":"Generate"})]})})}function D(e){var t=e.loading,n=e.disabled,r=e.onClick;return(0,o.BX)(o.HY,{children:[t?(0,o.BX)(f.G,{css:_.iconText,children:[(0,o.tZ)(m.Z,{size:12,color:y.TV.blurpleDefault}),(0,o.tZ)(u.xv,{variant:"small",color:"dimmest",children:"AI is writing"})]}):(0,o.tZ)(u.xv,{variant:"small",color:"dimmest",children:"Esc to close, Enter to submit"}),(0,o.tZ)(C,{loading:t,disabled:n,onClick:r})]})}function I(e){var t=e.onClose,n=e.loading,i=e.onSubmit,o=(0,r._)((0,Z.useState)(""),2),a=o[0],l=o[1];return{value:a,setValue:l,onKeyDown:function(e){switch(e.key){case"Escape":e.preventDefault(),t();break;case"Enter":if(e.preventDefault(),n)break;e.shiftKey?l(function(e){return e+"\n"}):e.metaKey||i()}}}}var G=function(e){var t=(0,r._)(e.children,2),n=t[0],i=t[1];return(0,o.BX)(f.G,{css:_.footer,children:[(0,o.tZ)(f.G,{css:_.footerLeft,children:n}),(0,o.tZ)(f.G,{css:_.footerRight,children:i})]})},B=function(e){var t=e.error;return(0,o.tZ)(u.xv,{css:_.error,children:t})}},97050:function(e,t,n){n.d(t,{W:function(){return tA}});var r,i,o,a=n(51051),l=n(80979),c=n(60417),s=n(12285),u=n(4384),d=n(4955),f=n(9670),h=n(90367),p=n(29684),m=n(51384),v=n(67075),g=a.r$.define({combine:function(e){var t;return null!==(t=e.filter(Boolean)[0])&&void 0!==t?t:null}}),y=a.QQ.define({create:function(){return{diff:null,tree:p.mp.empty}},update:function(e,t){var n,r,i=t.state.facet(g),o=null===(n=t.state.facet(h.dK))||void 0===n?void 0:n.parser;if(!i)return null===e.diff&&e.tree===p.mp.empty?e:{diff:null,tree:p.mp.empty};var a=e.diff,l=e.tree;return(a&&a.b.eq(i)?t.docChanged&&(a=a.updateA(t.newDoc,t.changes)):(a=m.z.create(t.newDoc,i),l=p.mp.empty),(null===(r=t.startState.facet(h.dK))||void 0===r?void 0:r.parser)!==o&&(l=p.mp.empty),o&&l.length!==a.b.length)?(l=(0,v.p)({parser:o,text:a.b,maxTime:16,base:l}),{diff:a,tree:l}):e.diff===a&&e.tree===l?e:{diff:a,tree:l}}}),b=n(42516),Z=n(29287),w="cm-transform-diff-line-deletion-base",x="cm-transform-diff-line-deletion",C="cm-transform-diff-text-deletion",_="cm-transform-diff-line-insertion-base",S="cm-transform-diff-line-insertion",E="cm-transform-diff-text-insertion",k="cm-transform-diff-number-marker",T="rgba(180, 0, 0, 0.1)",R="rgba(180, 0, 0, 0.125)",D="rgba(0, 180, 0, 0.1)",I="rgba(0, 180, 0, 0.125)";function G(e,t){var n="linear-gradient(to right, ".concat(e,", ").concat(e,")");return t&&(n+=", linear-gradient(to right, ".concat(t,", ").concat(t,")")),n}var B=l.tk.theme((i={},(0,b._)(i,".".concat(_,", .").concat(S),{cursor:"text","&.cm-line ::selection":{backgroundColor:"".concat(Z.TV.accentPrimaryDimmest," !important")}}),(0,b._)(i,".".concat(w),{background:G(T),backgroundClip:"content-box"}),(0,b._)(i,".".concat(x),{background:G(T,R),backgroundClip:"content-box"}),(0,b._)(i,".".concat(_),{background:G(D),backgroundClip:"content-box"}),(0,b._)(i,".".concat(S),{background:G(D,I),backgroundClip:"content-box"}),(0,b._)(i,".".concat(E),{display:"inline-block",background:I}),(0,b._)(i,".".concat(C),{display:"inline-block",background:R}),(0,b._)(i,".".concat(k),{opacity:.5}),i)),A=n(31157),P=n(15658),N=n(3341),U=n.n(N),O=function(e){"use strict";(0,d._)(n,e);var t=(0,f._)(n);function n(e,r,i){var o;return(0,s._)(this,n),(o=t.call(this)).line=e,o.index=r,o.changed=i,o}var r=n.prototype;return r.toDOM=function(){var e=this,t=document.createElement("div");if(t.className=this.changed?"cm-line ".concat(_):"cm-line ".concat(S),!this.changed||!this.changed.length){var n=!0,r=!1,i=void 0;try{for(var o,a=this.line[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value,c=l.text,s=l.tags,u=document.createElement("span");u.textContent=c||"\xa0",u.className=null!=s?s:"",t.appendChild(u)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return t}for(var d=0,f=0,h=null,p=null,m=function(t,n){if(!h)throw Error("range is null");var r=e.line[f],i=r.text,o=r.tags,a=i.slice(d-h.from,n-h.from),l=document.createElement("span");l.textContent=a||"\xa0",l.className=null!=o?o:"",t.appendChild(l),d+=a.length};f<this.line.length;){if(!h){var v=this.line[f].text;h={from:d,to:d+v.length}}if(!p){var g=!0,y=!1,b=void 0;try{for(var Z,w=this.changed[Symbol.iterator]();!(g=(Z=w.next()).done);g=!0){var x=Z.value;if(!(x.from>=h.to)&&!(x.to<=d)){var C=document.createElement("span");C.className=E,p={from:x.from,to:x.to,dom:C},d<p.from&&m(t,p.from),t.appendChild(C);break}}}catch(e){y=!0,b=e}finally{try{g||null==w.return||w.return()}finally{if(y)throw b}}}p?(d<p.to&&m(p.dom,p.to),d>=p.to&&(p=null)):m(t,h.to),d>=h.to&&(h=null,f++)}return t},r.eq=function(e){var t,r;return e instanceof n&&this.index===e.index&&this.line.length===e.line.length&&(null===(t=this.changed)||void 0===t?void 0:t.length)===(null===(r=e.changed)||void 0===r?void 0:r.length)&&U()(this.line,e.line)&&U()(this.changed,e.changed)},r.ignoreEvent=function(e){return e.stopImmediatePropagation(),!0},(0,u._)(n,[{key:"estimatedHeight",get:function(){return 21}}]),n}(l.l9),L=l.p.line({class:w}),M=l.p.line({class:x}),X=l.p.mark({class:C}),F=l.tk.decorations.compute([y],function(e){var t=function(e,t){if(r.getLineChangeType(e.number,A.MF.A)===A.dQ.COVERED)o.push(M.range(e.from));else{o.push(L.range(e.from));var n=!0,i=!1,a=void 0;try{for(var l,c=(0,A.Po)(e,t,A.MF.A,!1)[Symbol.iterator]();!(n=(l=c.next()).done);n=!0){var s=l.value;o.push(X.range(s.from,s.to))}}catch(e){i=!0,a=e}finally{try{n||null==c.return||c.return()}finally{if(i)throw a}}}},n=e.field(y,!1);if(!n||!n.diff)return l.p.none;var r=n.diff,i=n.tree,o=[],a=!0,c=!1,s=void 0;try{for(var u,d=r.chunks[Symbol.iterator]();!(a=(u=d.next()).done);a=!0){var f=u.value;if(f.fromA!==f.endA)for(var h=r.a.lineAt(f.fromA),p=r.a.lineAt(f.endA),m=h.number;m<=p.number;m++)t(r.a.line(m),f);else f.fromB===f.endB&&t(r.a.lineAt(f.fromA),f);if(f.fromB!==f.toB)for(var v=r.b.lineAt(f.fromB),g=(0,P.CT)(i,r.b,e,f.fromB,f.endB),b=0;b<g.length;b++){var Z=g[b],w=r.b.line(v.number+b),x=r.getLineChangeType(w.number,A.MF.B)===A.dQ.COVERED?null:(0,A.Po)(w,f,A.MF.B,!0),C=l.p.widget({widget:new O(Z,w.number,x),block:!0,side:b+1}),_=Math.min(f.endA,r.a.length);o.push(C.range(_))}}}catch(e){c=!0,s=e}finally{try{a||null==d.return||d.return()}finally{if(c)throw s}}return l.p.set(o,!0)}),W=n(3917),H=function(e){"use strict";(0,d._)(n,e);var t=(0,f._)(n);function n(e){var r;return(0,s._)(this,n),(r=t.call(this)).index=e,r}var r=n.prototype;return r.toDOM=function(){var e=document.createElement("span");return e.className=k,e.textContent=String(this.index),e},r.eq=function(e){return this.index===e.index},n}(l.SJ),V=W.X4.of(function(e,t){if(t instanceof O)return new H(t.index)}),z=a.r$.define({enables:function(e){return[g.computeN([e],function(t){return t.facet(e)}),y,B,F,V]}}),j=n(53466),q=n(51944);(r=o||(o={}))[r.Compare=0]="Compare",r[r.Original=1]="Original",r[r.Suggestion=2]="Suggestion";var Y=a.Py.define(),$=a.QQ.define({create:function(){return o.Suggestion},update:function(e,t){var n=!0,r=!1,i=void 0;try{for(var a,l=t.effects[Symbol.iterator]();!(n=(a=l.next()).done);n=!0){var c=a.value;if(c.is(Y))e=c.value;else if(c.is(q.Q))e=null;else if(c.is(q.h)){var s=t.state.field(j.$);if((null==s?void 0:s.type)==="transformCode"&&c.value){var u=t.startState.field(j.u),d=c.value;!u&&d&&(e=o.Suggestion)}}}}catch(e){r=!0,i=e}finally{try{n||null==l.return||l.return()}finally{if(r)throw i}}return e}}),J=n(89798),K=n(7612),Q=a.QQ.define({create:function(){return null},update:function(e,t){if(!(0,K.a)(t,"doc",j.$,J.Yp,$,j.u))return e;var n,r=t.state.field(j.$),i=t.state.facet(J.Yp),a=t.state.field($);if(!r||!i||r.codeReference.filePath!==i||a!==o.Suggestion)return null;var l=r.codeReference.range.indexFrom,c=r.codeReference.range.indexTo,s=t.state.doc.slice(l,c),u=null!==(n=t.state.field(j.u))&&void 0!==n?n:"",d=s.lines,f=u.split(t.state.lineBreak).length-d;return e&&e.after===l&&e.offset===f?e:{after:l,offset:f}}}),ee=W.gy.of(function(e,t){var n=e.state.doc.lineAt(t.from),r=e.state.field(Q);if(r&&!(n.from<=r.after))return new W.un(n.number+r.offset)}),et=W.X4.of(function(e,t){if(t instanceof en)return new W.un(t.index)}),en=function(e){"use strict";(0,d._)(n,e);var t=(0,f._)(n);function n(e,r,i){var o;return(0,s._)(this,n),(o=t.call(this)).line=e,o.block=r,o.index=i,o}var r=n.prototype;return r.toDOM=function(){var e=document.createElement(this.block?"div":"span");e.className=this.block?"cm-line":"";var t=!0,n=!1,r=void 0;try{for(var i,o=this.line[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value,l=a.text,c=a.tags,s=document.createElement("span");s.textContent=l||"\xa0",c&&(s.className=c),e.appendChild(s)}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}return e},r.eq=function(e){return this.index===e.index&&(0,P.gj)(this.line,e.line)},r.ignoreEvent=function(){return!1},(0,u._)(n,[{key:"estimatedHeight",get:function(){return 21}}]),n}(l.l9),er=[Q,ee,et,l.tk.decorations.compute([h.dK,j.$,j.u,$,y,J.Yp,a.yy.lineSeparator],function(e){var t=e.field(j.$),n=e.facet(J.Yp),r=e.field($);if(!t||"transformCode"!==t.type||!n||t.codeReference.filePath!==n||r!==o.Suggestion)return l.p.none;var i=t.codeReference.range.indexFrom,a=t.codeReference.range.indexTo,c=e.doc.lineAt(i),s=e.doc.lineAt(a),u=e.toText(null!==(x=e.field(j.u))&&void 0!==x?x:""),d=e.changes({from:i,to:a,insert:u}),f=d.apply(e.doc),p=i+u.length,m=null===(w=e.facet(h.dK))||void 0===w?void 0:w.parser,g=null;if(m)g=(0,v.p)({parser:m,text:f,changes:d,base:e,upTo:p}),C=(0,P.CT)(g,f,e,i,p);else{C=[];var y=!0,b=!1,Z=void 0;try{for(var w,x,C,_,S=u.iterLines()[Symbol.iterator]();!(y=(_=S.next()).done);y=!0){var E=_.value;C.push([{text:E}])}}catch(e){b=!0,Z=e}finally{try{y||null==S.return||S.return()}finally{if(b)throw Z}}}var k=[];C.length>1&&i!==a&&0!==s.length&&a===s.to&&a<e.doc.length?k.push(l.p.replace({inclusive:!1,block:!0}).range(i,a)):k.push(l.p.replace({inclusiveStart:!1,block:!0}).range(i,a));for(var T=0;T<C.length;T++){var R=C[T],D=c.number+T,I=l.p.widget({widget:new en(R,T>0,D),inlineOrder:!0,side:T+1,block:T>0});k.push(I.range(i))}return l.p.set(k,!0)})],ei=n(74985),eo=n(63185),ea=n(69543),el=n(54472),ec=n(75023),es=n(1643),eu=n(2038),ed=n(59868),ef=n(74833),eh=n(56596),ep=n(93918),em=n(50586),ev=n(74652),eg=n(25961),ey=n(59510),eb=n.n(ey),eZ=n(67795),ew=(0,ep.X)({container:[Z.l0.rowWithGap(2),Z.l0.flex.row,Z.l0.align.center,Z.l0.textAlign.center,Z.l0.cursor.pointer,Z.l0.pr(4),{opacity:.6},Z.l0.height("100%")],text:[Z.l0.rowWithGap(4),Z.l0.color.foregroundDimmest,{textTransform:"capitalize"}],shortcut:[Z.l0.ml(4),{"& > div > div":{fontSize:"0.8em",paddingLeft:(0,es.fP)(4),paddingRight:(0,es.fP)(4),paddingTop:(0,es.fP)(2),paddingBottom:(0,es.fP)(2)}}]}),ex=new el.Jf(function(e){var t=e.onGenerateCode,n=e.onEditCode,r=e.hasSelection,i=(0,eu.T3)(),o=r?"edit":"generate",a=(0,ev.gf)(em.x.id);return(0,ei.BX)(eh.G,{css:ew.container,onClick:function(){(0,ed.j)(eZ.U3.GHOSTWRITER_CHAT_INLINE_HINT_CLICKED,{action:o}),r?n():t()},children:[(0,ei.tZ)("div",{css:ew.text,children:(0,ei.tZ)(ef.xv,{variant:"small",children:o})}),(0,ei.tZ)("div",{css:ew.shortcut,children:!i&&a?(0,ei.tZ)(eg.bM,{keyCombo:a,small:!0}):null})]})}),eC=l.tk.theme({".cm-ghostwriter-hint-layer":{width:"100%"}}),e_=function(e){var t=e.selection.main.head;return e.doc.lineAt(t)},eS=new ec.j(function(e,t){return a.QQ.define({create:function(e){return e_(e)},compare:eb(),update:function(e,t){return e_(t.state)},provide:function(n){return[eC,a.Wl.high((0,l.EY)({above:!0,class:"cm-ghostwriter-hint-layer",update:function(e){return(0,K.a)(e,n,j.$,eo.WF)},markers:function(r){var i=r.state.field(n,!1);if(!i)return[];var o=!r.state.selection.main.empty;if(o)return[];var a=r.state.field(j.$,!1),l=0===r.state.doc.length,c=(0,ea.o)(r.state);if(i.length>0||a||c||l)return[];var s=r.dom.querySelector(".cm-minimap-gutter"),u=(null==s?void 0:s.clientWidth)||0,d=i.to,f=r.lineBlockAt(d),h=f.top,p=f.height;return[new eE({top:h+r.documentPadding.top,height:p,right:u,pocketOpen:null!==a,hasSelection:o,activeEditor:r.hasFocus,onGenerateCode:e,onEditCode:t})]}}))]}})}),eE=function(){"use strict";function e(t){(0,s._)(this,e),this.options=t}var t=e.prototype;return t.position=function(e){e.style.top=this.options.top+"px",e.style.height=this.options.height+"px",e.style.right=this.options.right+"px",e.style.paddingRight="8px"},t.draw=function(){var e=ex.create({onEditCode:this.options.onEditCode,onGenerateCode:this.options.onGenerateCode,hasSelection:this.options.hasSelection});return e.className="cm-ghostwriter-hint-marker",this.options.activeEditor||(e.style.visibility="hidden"),this.position(e),e},t.eq=function(e){return this.options.top===e.options.top&&this.options.hasSelection===e.options.hasSelection&&this.options.pocketOpen===e.options.pocketOpen&&this.options.activeEditor===e.options.activeEditor},e}(),ek=n(50959),eT=n(49932),eR=n(66626),eD=n(50199),eI=n(1498),eG=n(15146),eB=n(74883),eA=n(58719),eP=n(88936),eN=n(39469),eU=n(475),eO=n(19615),eL=n(90719),eM=n(43409),eX=n(22580),eF=n(9100),eW=n(83898),eH=n(74997),eV=n(49275),ez=n(71749),ej=a.r$.define({combine:function(e){var t;return null!==(t=e[0])&&void 0!==t?t:function(){}}}),eq=new ec.j(function(e){return ej.of(e)}),eY=(0,ep.X)({root:[Z.l0.colWithGap(8),Z.l0.border({color:Z.TV.outlineDimmest}),Z.l0.p(8),Z.l0.borderRadius(4)],header:[Z.l0.rowWithGap(8),Z.l0.align.center,Z.l0.justify.spaceBetween,Z.l0.minHeight(28)],headerLeft:[Z.l0.flex.growAndShrink(1),Z.l0.rowWithGap(8),Z.l0.align.center],footer:[Z.l0.rowWithGap(8),Z.l0.align.center,Z.l0.justify.end]}),e$=new el.Jf(function(e){var t=e.requestMeasure,n=e.codeReference,r=e.onReplyInChat,i=e.onClose,o=function(){c&&((0,ed.j)(ed.U3.GHOSTWRITER_CHAT_INLINE_REGENERATED,{action:"EXPLAIN"}),a({responseId:c.id,action:"EXPLAIN"}))},a=(0,eW.Gd)(),l=(0,eR._)((0,eL.Ni)(),1)[0],c=(0,eH.j)(n.filePath),s=(0,eV.tz)(),u=(0,eV.WS)(c),d=(0,ek.useCallback)(function(){u&&c&&s({messageId:c.id})},[s,c,u]),f=(null==c?void 0:c.attribution)==="Assistant",h=!!((null==c?void 0:c.loading)||(null==c?void 0:c.streaming)),p=!!((null==c?void 0:c.stopReason)||(null==c?void 0:c.aborted)),m=null==c?void 0:c.error,v=(0,eD.Z)(function(){return(0,eF.BW)(null==c?void 0:c.id)},[null==c?void 0:c.id]);return(0,ei.tZ)(ez.fL,{requestMeasure:t,type:"explainCode",children:(0,ei.BX)(eh.G,{css:eY.root,dataCy:"ghostwriter-inline-explain-content",children:[(0,ei.BX)(eh.G,{css:eY.header,children:[(0,ei.BX)(eh.G,{css:eY.headerLeft,children:[(0,ei.tZ)(eO.R,{advanced:"advanced"===l}),(0,ei.tZ)(eM.As,{intent:"EXPLAIN"})]}),p?(0,ei.tZ)(eG.hU,{alt:"Close",dataCy:"ghostwriter-inline-close",children:(0,ei.tZ)(eA.Z,{onClick:function(){return i()}})}):(0,ei.tZ)(eI.zx,{iconLeft:(0,ei.tZ)(eU.Z,{}),size:"small",text:"Stop",onClick:function(){return d()}})]}),h&&!h?(0,ei.tZ)(eP.Z,{}):null,c?(0,ei.tZ)(eX.J,{text:c.text,codeComponent:v}):null,f&&"string"==typeof m?(0,ei.tZ)(ez.Bc,{error:m}):null,(0,ei.tZ)(eh.G,{css:eY.footer,children:p?(0,ei.BX)(ei.HY,{children:[(0,ei.tZ)(ef.xv,{variant:"small",color:"dimmer",children:"Esc to close"}),(0,ei.tZ)(eI.zx,{iconLeft:(0,ei.tZ)(eN.Z,{}),variant:"outlined",size:"small",text:"Retry",onClick:function(){o()}}),(0,ei.tZ)(eI.zx,{dataCy:"ghostwriter-inline-reply-in-chat",iconLeft:(0,ei.tZ)(eB.Z,{}),size:"small",text:"Reply in Chat",colorway:"blurple",onClick:function(){(0,ed.j)(ed.U3.GHOSTWRITER_CHAT_INLINE_REPLY_IN_CHAT),r()}})]}):null})]})})}),eJ=n(24796),eK=n(10693),eQ=n(14044),e0=n(64461),e1=n(54450),e2=n(73722),e8=n(14917),e4=n(29217),e3=n(92032),e5=new el.Jf(function(e){var t=e.requestMeasure,n=e.codeReference,r=e.updateCodeBlock,i=e.acceptSuggestion,o=e.onClose,a=e.autoFocus,l=function(){d?(i(d),(null==u?void 0:u.id)&&(p(u.id),m(n.filePath)),(0,ed.j)(ed.U3.GHOSTWRITER_CHAT_INLINE_ACCEPTED,{action:"GENERATE"})):g()},c=function(){w.current=C,s({chatMessage:{type:"generateCode",text:C,codeReference:n}})},s=(0,eW.ql)(),u=(0,e8.oQ)(n.filePath),d=(0,e3.n)(u),f=(0,eV.tz)(),h=(0,eV.WS)(u),p=(0,e4.$0)(),m=(0,e4.PM)();(0,ek.useEffect)(function(){return r(d)},[d,r]);var v=(0,ek.useCallback)(function(){h&&u&&f({messageId:u.id})},[f,u,h]),g=(0,ek.useCallback)(function(){v(),o()},[v,o]),y=!!((null==u?void 0:u.loading)||(null==u?void 0:u.streaming)),b=!!((null==u?void 0:u.stopReason)||(null==u?void 0:u.aborted)),Z=(0,ek.useCallback)(function(){(0,ed.j)(ed.U3.GHOSTWRITER_CHAT_INLINE_CLOSED,{action:"GENERATE"}),g()},[g]),w=(0,ek.useRef)(null),x=(0,ez.U1)({loading:y,onSubmit:function(){E?l():c()},onClose:Z}),C=x.value,_=x.setValue,S=x.onKeyDown,E=b&&w.current===C;return(0,ei.BX)(ez.If,{requestMeasure:t,type:"generateCode",children:[(0,ei.tZ)(ez.II,{value:C,onChange:function(e){return _(e.currentTarget.value)},placeholder:"Enter a prompt to generate new code",onKeyDown:S,autoFocus:a}),(0,ei.BX)(ez.$_,{children:[(0,ei.BX)(ei.HY,{children:[(0,ei.tZ)(ez.Xs,{type:"generateCode"}),b?(0,ei.tZ)(eG.hU,{alt:"Rerun the same prompt",onClick:function(){return c()},size:12,colorway:"grey",children:(0,ei.tZ)(e2.Z,{})}):null]}),E?(0,ei.BX)(ei.HY,{children:[(0,ei.tZ)(eI.zx,{variant:"outlined",size:"small",text:"Reject",onClick:function(){(0,ed.j)(ed.U3.GHOSTWRITER_CHAT_INLINE_DISCARDED,{action:"GENERATE"}),Z()}}),(0,ei.tZ)(eI.zx,{size:"small",text:"Accept",colorway:"blurple",onClick:l,dataCy:"ghostwriter-inline-accept-suggestion"})]}):(0,ei.tZ)(ez.k4,{loading:y,disabled:!C,onClick:function(){y?v():c()}})]})]})}),e6=n(7444),e9=n(99952),e7=new el.Jf(function(e){var t=e.requestMeasure,n=e.codeReference,r=e.updateCodeBlock,i=e.acceptSuggestion,a=e.onClose,l=e.autoFocus,c=e.updateDiffSelection,s=function(){h?((0,ed.j)(ed.U3.GHOSTWRITER_CHAT_INLINE_ACCEPTED,{action:"TRANSFORM"}),i(h)):y()},u=function(){x.current=_,d({chatMessage:{type:"transformCode",text:_,codeReference:n}})},d=(0,eW.ql)(),f=(0,e9.iH)(n.filePath),h=(0,e3.n)(f),p=(0,eV.tz)(),m=(0,eV.WS)(f);(0,ek.useEffect)(function(){return r(h)},[h,r]);var v=(0,e6.Z)(c);(0,ek.useEffect)(function(){if(f){var e=f.loading||f.streaming?o.Suggestion:o.Compare;v.current(e)}},[f,v]);var g=(0,ek.useCallback)(function(){m&&f&&p({messageId:f.id})},[p,f,m]),y=(0,ek.useCallback)(function(){g(),a()},[g,a]),b=!!((null==f?void 0:f.loading)||(null==f?void 0:f.streaming)),Z=!!((null==f?void 0:f.stopReason)||(null==f?void 0:f.aborted)),w=(0,ek.useCallback)(function(){(0,ed.j)(ed.U3.GHOSTWRITER_CHAT_INLINE_CLOSED,{action:"TRANSFORM"}),y()},[y]),x=(0,ek.useRef)(null),C=(0,ez.U1)({loading:b,onSubmit:function(){k?s():u()},onClose:w}),_=C.value,S=C.setValue,E=C.onKeyDown,k=Z&&x.current===_;return(0,ei.BX)(ez.If,{requestMeasure:t,type:"generateCode",children:[(0,ei.tZ)(ez.II,{value:_,onChange:function(e){return S(e.currentTarget.value)},placeholder:"Enter a prompt to modify selection",onKeyDown:E,autoFocus:l}),(0,ei.BX)(ez.$_,{children:[(0,ei.BX)(ei.HY,{children:[(0,ei.tZ)(ez.Xs,{type:"transformCode"}),Z?(0,ei.tZ)(eG.hU,{alt:"Rerun the same prompt",onClick:function(){return u()},size:12,colorway:"grey",children:(0,ei.tZ)(e2.Z,{})}):null]}),k?(0,ei.BX)(ei.HY,{children:[(0,ei.tZ)(eI.zx,{variant:"outlined",size:"small",text:"Reject",onClick:function(){(0,ed.j)(ed.U3.GHOSTWRITER_CHAT_INLINE_DISCARDED,{action:"TRANSFORM"}),w()}}),(0,ei.tZ)(eI.zx,{size:"small",text:"Accept",colorway:"blurple",onClick:s,dataCy:"ghostwriter-inline-accept-suggestion"})]}):(0,ei.tZ)(ez.k4,{loading:b,disabled:!_,onClick:function(){b?g():u()}})]})]})});function te(e,t){e.dispatch({effects:q.Q.of(null),selection:{anchor:t.range.indexTo,head:t.range.indexTo}}),e.hasFocus||e.focus()}function tt(e,t){(0,eQ.el)({view:e,insert:t,scrollIntoView:!0}),e.dispatch({effects:q.Q.of(null)}),e.hasFocus||e.focus()}function tn(e,t){e.dispatch({effects:q.h.of(t)})}function tr(e,t,n){e.dispatch({changes:{from:n.range.indexFrom,to:n.range.indexTo,insert:t},scrollIntoView:!0,effects:q.Q.of(null),annotations:[e1.Z.of(!0),eK.Iv.of("full")]}),e.hasFocus||e.focus()}function ti(e,t){return e.range.indexFrom===t.range.indexFrom&&e.range.indexTo===t.range.indexTo&&e.filePath===t.filePath&&e.fileVersion===t.fileVersion}var to=function(e){"use strict";(0,d._)(n,e);var t=(0,f._)(n);function n(e){var r,i=e.codeReference;return(0,s._)(this,n),(r=t.call(this)).codeReference=i,r}var r=n.prototype;return r.toDOM=function(e){var t=this.codeReference;return e5.create({requestMeasure:function(){return e.requestMeasure()},codeReference:t,onClose:function(){return te(e,t)},acceptSuggestion:function(t){return tt(e,t)},updateCodeBlock:function(t){return tn(e,t)},autoFocus:!0})},r.updateDOM=function(e,t){var n=this.codeReference;return e5.update(e,function(e){return(0,e0.Uy)(e,function(e){e.requestMeasure=function(){return t.requestMeasure()},e.codeReference=n,e.onClose=function(){return te(t,n)},e.acceptSuggestion=function(e){return tt(t,e)},e.updateCodeBlock=function(e){return tn(t,e)},e.autoFocus=!1})}),!0},r.eq=function(e){return ti(this.codeReference,e.codeReference)},n}(l.l9),ta=function(e){"use strict";(0,d._)(n,e);var t=(0,f._)(n);function n(e){var r,i=e.codeReference;return(0,s._)(this,n),(r=t.call(this)).codeReference=i,r}var r=n.prototype;return r.toDOM=function(e){var t=this.codeReference;return e7.create({requestMeasure:function(){return e.requestMeasure()},codeReference:t,onClose:function(){return te(e,t)},acceptSuggestion:function(n){return tr(e,n,t)},updateCodeBlock:function(t){tn(e,t)},updateDiffSelection:function(t){e.dispatch({effects:Y.of(t)})},autoFocus:!0})},r.updateDOM=function(e,t){var n=this.codeReference;return e7.update(e,function(e){return(0,e0.Uy)(e,function(e){e.requestMeasure=function(){return t.requestMeasure()},e.codeReference=n,e.onClose=function(){return te(t,n)},e.acceptSuggestion=function(e){return tr(t,e,n)},e.updateCodeBlock=function(e){return tn(t,e)},e.updateDiffSelection=function(e){t.dispatch({effects:Y.of(e)})},e.autoFocus=!1})}),!0},r.eq=function(e){return ti(this.codeReference,e.codeReference)},n}(l.l9),tl=function(e){"use strict";(0,d._)(n,e);var t=(0,f._)(n);function n(e){var r,i=e.codeReference;return(0,s._)(this,n),(r=t.call(this)).codeReference=i,r}var r=n.prototype;return r.toDOM=function(e){var t=this.codeReference;return e$.create({requestMeasure:function(){return e.requestMeasure()},codeReference:t,onClose:function(){return te(e,t)},onReplyInChat:function(){return e.state.facet(ej)()}})},r.updateDOM=function(e,t){var n=this.codeReference;return e$.update(e,function(e){return(0,e0.Uy)(e,function(e){e.requestMeasure=function(){return t.requestMeasure()},e.codeReference=n,e.onClose=function(){return te(t,n)}})}),!0},r.eq=function(e){return ti(this.codeReference,e.codeReference)},n}(l.l9),tc=(0,ep.X)({root:[Z.l0.rowWithGap(8),Z.l0.border({color:Z.TV.outlineDimmest}),Z.l0.p(8),Z.l0.borderRadius(4)],text:[Z.l0.flex.growAndShrink(1)]}),ts=new el.Jf(function(e){var t=e.onClose,n=e.requestMeasure;return(0,ei.tZ)(ez.fL,{requestMeasure:n,type:"ghostwriterKillswitch",children:(0,ei.BX)(eh.G,{css:tc.root,children:[(0,ei.tZ)(eh.G,{css:tc.text,children:(0,ei.tZ)(eJ.r,{textVariant:"text"})}),(0,ei.tZ)(eG.hU,{alt:"Close",onClick:t,type:"button",children:(0,ei.tZ)(eA.Z,{})})]})})}),tu=function(e){"use strict";(0,d._)(n,e);var t=(0,f._)(n);function n(e){var r,i=e.codeReference;return(0,s._)(this,n),(r=t.call(this)).codeReference=i,r}return n.prototype.toDOM=function(e){var t=this;return ts.create({onClose:function(){return te(e,t.codeReference)},requestMeasure:function(){return e.requestMeasure()}})},n}(l.l9),td=a.r$.define({combine:function(e){var t;return null!==(t=e[0])&&void 0!==t&&t}}),tf=n(62507),th=n(10676),tp=new el.Jf(function(e){var t=e.requestMeasure,n=e.codeReference,r=e.updateCodeBlock,i=e.acceptSuggestion,o=e.onClose,a=e.autoFocus,l=function(){var e=f();e?(i(e.code),(0,ed.j)(ed.U3.GHOSTWRITER_CHAT_INLINE_ACCEPTED,{action:"GENERATE"})):m()},c=function(){var e,t;g.current=b,u({message:b,type:th.G_.GENERATE_CODE,codeReference:{code:n.code,range:n.range,filePath:n.filePath,fileContent:null!==(e=n.fileContent)&&void 0!==e?e:"",fileVersion:n.fileVersion,language:null!==(t=n.language)&&void 0!==t?t:"",referenceType:th.MD.INLINE}})},s=(0,tf.XW)({onCode:r}),u=s.sendMessage,d=s.stopMessage,f=s.getCode,h=s.loading,p=s.completed,m=(0,ek.useCallback)(function(){d(),o()},[d,o]),v=(0,ek.useCallback)(function(){(0,ed.j)(ed.U3.GHOSTWRITER_CHAT_INLINE_CLOSED,{action:"GENERATE"}),m()},[m]),g=(0,ek.useRef)(null),y=(0,ez.U1)({loading:h,onSubmit:function(){x?l():c()},onClose:v}),b=y.value,Z=y.setValue,w=y.onKeyDown,x=p&&g.current===b;return(0,ei.BX)(ez.If,{requestMeasure:t,type:"generateCode",children:[(0,ei.tZ)(ez.II,{value:b,onChange:function(e){return Z(e.currentTarget.value)},placeholder:"Enter a prompt to generate new code",onKeyDown:w,autoFocus:a}),(0,ei.BX)(ez.$_,{children:[(0,ei.BX)(ei.HY,{children:[(0,ei.tZ)(ez.Xs,{type:"generateCode"}),p?(0,ei.tZ)(eG.hU,{alt:"Rerun the same prompt",onClick:function(){return c()},size:12,colorway:"grey",children:(0,ei.tZ)(e2.Z,{})}):null]}),x?(0,ei.BX)(ei.HY,{children:[(0,ei.tZ)(eI.zx,{variant:"outlined",size:"small",text:"Reject",onClick:function(){(0,ed.j)(ed.U3.GHOSTWRITER_CHAT_INLINE_DISCARDED,{action:"GENERATE"}),v()}}),(0,ei.tZ)(eI.zx,{size:"small",text:"Accept",colorway:"blurple",onClick:l,dataCy:"ghostwriter-inline-accept-suggestion"})]}):(0,ei.tZ)(ez.k4,{loading:h,disabled:!b,onClick:function(){h?d():c()}})]})]})}),tm=function(e){"use strict";(0,d._)(n,e);var t=(0,f._)(n);function n(e){var r,i=e.codeReference;return(0,s._)(this,n),(r=t.call(this)).codeReference=i,r}var r=n.prototype;return r.toDOM=function(e){var t=this.codeReference;return tp.create({requestMeasure:function(){return e.requestMeasure()},codeReference:t,onClose:function(){return te(e,t)},acceptSuggestion:function(t){return tt(e,t)},updateCodeBlock:function(t){return tn(e,t)},autoFocus:!0})},r.updateDOM=function(e,t){var n=this.codeReference;return tp.update(e,function(e){return(0,e0.Uy)(e,function(e){e.requestMeasure=function(){return t.requestMeasure()},e.codeReference=n,e.onClose=function(){return te(t,n)},e.acceptSuggestion=function(e){return tt(t,e)},e.updateCodeBlock=function(e){return tn(t,e)},e.autoFocus=!1})}),!0},r.eq=function(e){return ti(this.codeReference,e.codeReference)},n}(l.l9),tv=new el.Jf(function(e){var t=e.requestMeasure,n=e.codeReference,r=e.updateCodeBlock,i=e.acceptSuggestion,a=e.onClose,l=e.autoFocus,c=e.updateDiffSelection,s=function(){var e=p();e?((0,ed.j)(ed.U3.GHOSTWRITER_CHAT_INLINE_ACCEPTED,{action:"TRANSFORM"}),i(e.code)):y()},u=function(){var e,t;Z.current=x,f({message:x,type:th.G_.TRANSFORM_CODE,codeReference:{code:n.code,range:n.range,filePath:n.filePath,fileContent:null!==(e=n.fileContent)&&void 0!==e?e:"",fileVersion:n.fileVersion,language:null!==(t=n.language)&&void 0!==t?t:"",referenceType:th.MD.INLINE}})},d=(0,tf.XW)({onCode:r}),f=d.sendMessage,h=d.stopMessage,p=d.getCode,m=d.loading,v=d.completed,g=(0,e6.Z)(c);(0,ek.useEffect)(function(){if(m){g.current(o.Suggestion);return}v&&g.current(o.Compare)},[g,v,m]);var y=(0,ek.useCallback)(function(){h(),a()},[h,a]),b=(0,ek.useCallback)(function(){(0,ed.j)(ed.U3.GHOSTWRITER_CHAT_INLINE_CLOSED,{action:"TRANSFORM"}),y()},[y]),Z=(0,ek.useRef)(null),w=(0,ez.U1)({loading:m,onSubmit:function(){S?s():u()},onClose:b}),x=w.value,C=w.setValue,_=w.onKeyDown,S=v&&Z.current===x;return(0,ei.BX)(ez.If,{requestMeasure:t,type:"generateCode",children:[(0,ei.tZ)(ez.II,{value:x,onChange:function(e){return C(e.currentTarget.value)},placeholder:"Enter a prompt to modify selection",onKeyDown:_,autoFocus:l}),(0,ei.BX)(ez.$_,{children:[(0,ei.BX)(ei.HY,{children:[(0,ei.tZ)(ez.Xs,{type:"transformCode"}),v?(0,ei.tZ)(eG.hU,{alt:"Rerun the same prompt",onClick:function(){return u()},size:12,colorway:"grey",children:(0,ei.tZ)(e2.Z,{})}):null]}),S?(0,ei.BX)(ei.HY,{children:[(0,ei.tZ)(eI.zx,{variant:"outlined",size:"small",text:"Reject",onClick:function(){(0,ed.j)(ed.U3.GHOSTWRITER_CHAT_INLINE_DISCARDED,{action:"TRANSFORM"}),b()}}),(0,ei.tZ)(eI.zx,{size:"small",text:"Accept",colorway:"blurple",onClick:s,dataCy:"ghostwriter-inline-accept-suggestion"})]}):(0,ei.tZ)(ez.k4,{loading:m,disabled:!x,onClick:function(){m?h():u()}})]})]})}),tg=function(e){"use strict";(0,d._)(n,e);var t=(0,f._)(n);function n(e){var r,i=e.codeReference;return(0,s._)(this,n),(r=t.call(this)).codeReference=i,r}var r=n.prototype;return r.toDOM=function(e){var t=this.codeReference;return tv.create({requestMeasure:function(){return e.requestMeasure()},codeReference:t,onClose:function(){return te(e,t)},acceptSuggestion:function(n){return tr(e,n,t)},updateCodeBlock:function(t){tn(e,t)},updateDiffSelection:function(t){e.dispatch({effects:Y.of(t)})},autoFocus:!0})},r.updateDOM=function(e,t){var n=this.codeReference;return tv.update(e,function(e){return(0,e0.Uy)(e,function(e){e.requestMeasure=function(){return t.requestMeasure()},e.codeReference=n,e.onClose=function(){return te(t,n)},e.acceptSuggestion=function(e){return tr(t,e,n)},e.updateCodeBlock=function(e){return tn(t,e)},e.updateDiffSelection=function(e){t.dispatch({effects:Y.of(e)})},e.autoFocus=!1})}),!0},r.eq=function(e){return ti(this.codeReference,e.codeReference)},n}(l.l9),ty=n(85379),tb=n(5018),tZ=n(3499),tw=a.r$.define({combine:function(e){var t;return null!==(t=e[0])&&void 0!==t?t:function(){}}});new ec.j(function(e){return tw.of(e)});var tx=(0,ep.X)({root:[Z.l0.colWithGap(8),Z.l0.border({color:Z.TV.outlineDimmest}),Z.l0.p(8),Z.l0.borderRadius(4)],header:[Z.l0.rowWithGap(8),Z.l0.align.center,Z.l0.justify.spaceBetween,Z.l0.minHeight(28)],headerLeft:[Z.l0.flex.growAndShrink(1),Z.l0.rowWithGap(8),Z.l0.align.center],footer:[Z.l0.rowWithGap(8),Z.l0.align.center,Z.l0.justify.end]}),tC=new el.Jf(function(e){var t=e.requestMeasure,n=e.codeReference,r=e.onClose,i=e.openAiChatPane,o=(0,tf.gS)(),a=o.sessionId,l=o.sendMessage,c=o.stopMessage,s=o.model,u=o.loading,d=o.completed,f=o.message,h=o.retry,p=(0,tZ.Ud)();return(0,ek.useEffect)(function(){var e,t;return l({codeReference:{code:n.code,range:n.range,filePath:n.filePath,fileContent:null!==(e=n.fileContent)&&void 0!==e?e:"",fileVersion:n.fileVersion,language:null!==(t=n.language)&&void 0!==t?t:"",referenceType:th.MD.INLINE}}),function(){c()}},[l,n,c]),(0,ei.tZ)(ez.fL,{requestMeasure:t,type:"explainCode",children:(0,ei.BX)(eh.G,{css:tx.root,dataCy:"ghostwriter-inline-explain-content",children:[f?(0,ei.BX)(eh.G,{css:tx.header,children:[(0,ei.BX)(eh.G,{css:tx.headerLeft,children:[(0,ei.tZ)(eO.R,{advanced:"advanced"===s}),(0,ei.tZ)(eM.As,{intent:"EXPLAIN"})]}),d?(0,ei.tZ)(eG.hU,{alt:"Close",dataCy:"ghostwriter-inline-close",children:(0,ei.tZ)(eA.Z,{onClick:function(){return r()}})}):(0,ei.tZ)(eI.zx,{iconLeft:(0,ei.tZ)(eU.Z,{}),size:"small",text:"Stop",onClick:function(){return c()}})]}):null,u&&!f?(0,ei.tZ)(eP.Z,{}):null,f?(0,ei.tZ)(eX.J,{text:f,codeComponent:ty._}):null,d?(0,ei.BX)(eh.G,{css:tx.footer,children:[(0,ei.tZ)(ef.xv,{variant:"small",color:"dimmer",children:"Esc to close"}),(0,ei.tZ)(eI.zx,{iconLeft:(0,ei.tZ)(eN.Z,{}),variant:"outlined",size:"small",text:"Retry",onClick:function(){h(),(0,ed.j)(ed.U3.GHOSTWRITER_CHAT_INLINE_REGENERATED,{action:"EXPLAIN"})}}),a?(0,ei.tZ)(eI.zx,{dataCy:"ghostwriter-inline-reply-in-chat",iconLeft:(0,ei.tZ)(eB.Z,{}),size:"small",text:"Reply in Chat",colorway:"blurple",onClick:function(){(0,ed.j)(ed.U3.GHOSTWRITER_CHAT_INLINE_REPLY_IN_CHAT),p(a,{sessionType:th.FF.CHAT}),i(a)}}):null]}):null]})})}),t_=function(e){"use strict";(0,d._)(n,e);var t=(0,f._)(n);function n(e){var r,i=e.codeReference;return(0,s._)(this,n),(r=t.call(this)).codeReference=i,r}var r=n.prototype;return r.toDOM=function(e){var t=this.codeReference;return tC.create({requestMeasure:function(){return e.requestMeasure()},codeReference:t,onClose:function(){return te(e,t)},openAiChatPane:function(t){return(0,tb.ZM)(e.state,{pane:{type:"ghostwriterChat",data:{sessionId:t}}})}})},r.updateDOM=function(e,t){var n=this.codeReference;return tC.update(e,function(e){return(0,e0.Uy)(e,function(e){e.requestMeasure=function(){return t.requestMeasure()},e.codeReference=n,e.onClose=function(){return te(t,n)}})}),!0},r.eq=function(e){return ti(this.codeReference,e.codeReference)},n}(l.l9),tS=n(56511),tE=eT.TV.blurpleDimmest,tk=eT.TV.accentPrimaryDimmest,tT=l.tk.theme({".cm-pocket-highlight":{backgroundColor:"rgba(120, 95, 255, 0.2)"},"@keyframes moveGradient":{"0%":{backgroundPositionX:"100%"},"100%":{backgroundPositionX:"0%"}},".cm-pocket-highlight-loading":{background:"linear-gradient(90deg, ".concat(eT.TV.blurpleDimmest,", ").concat(tk,", ").concat(tE,", ").concat(tk,")"),backgroundSize:"300% 100%",backgroundPositionX:"0%",animation:"moveGradient 2s linear infinite"}}),tR=l.tk.decorations.compute([j.$,$,J.Yp],function(e){var t=e.field(j.$),n=e.facet(J.Yp);if(!t||!n||t.codeReference.filePath!==n)return l.p.none;var r=e.doc.lineAt(t.codeReference.range.indexFrom).from,i=e.facet(td),o={generateCode:i?tm:to,transformCode:i?tg:ta,explainCode:i?t_:tl,ghostwriterKillswitch:tu}[t.type],a=l.p.widget({widget:new o({codeReference:t.codeReference}),block:!0,side:0}).range(r);return l.p.set(a)}),tD=(0,l.EY)({above:!1,update:function(e){return(0,K.a)(e,j.$)},markers:function(e){var t=e.state.field(j.$),n=e.state.facet(J.Yp);if(!t||!n||t.codeReference.filePath!==n)return[];var r=t.codeReference.range.indexFrom,i=t.codeReference.range.indexTo,o=e.state.doc.lineAt(i);o.from>=r&&o.to===i&&i<e.state.doc.length&&(i+=1);var c=a.jT.range(r,i),s=t.loading&&t.codeReference.range.indexFrom<t.codeReference.range.indexTo?"cm-pocket-highlight-loading":"cm-pocket-highlight";return l.dc.forRange(e,s,c)}}),tI=z.compute([j.$,j.u,J.Yp,$],function(e){var t=e.field(j.$),n=e.field(j.u),r=e.facet(J.Yp),i=e.field($);return t&&n&&r&&t.codeReference.filePath===r&&"transformCode"===t.type&&i===o.Compare?a.as.of({from:t.codeReference.range.indexFrom,to:t.codeReference.range.indexTo,insert:n},e.doc.length).apply(e.doc):null}),tG=c.V.compute([j.$,j.u,J.Yp],function(e){var t=e.field(j.$),n=e.field(j.u),r=e.facet(J.Yp);return t&&n&&r&&t.codeReference.filePath===r&&"generateCode"===t.type?a.as.of({from:t.codeReference.range.indexTo,to:t.codeReference.range.indexTo,insert:n},e.doc.length):null}),tB=new ec.j(function(e){return td.of(e)});function tA(e){var t=e.onGenerateCode,n=e.onEditCode,r=e.onReplyInChat,i=(0,tS.l)(),o=eq.use(r),a=tB.use(i),l=eS.use(t,n);return(0,ek.useMemo)(function(){return[tT,j.$,j.u,tR,tD,$,tI,er,tG,l,a,o]},[l,a,o])}},53466:function(e,t,n){n.d(t,{$:function(){return f},u:function(){return h}});var r=n(41733),i=n(30509),o=n(51051),a=n(80979),l=n(51944),c=n(82200),s=n(40497),u=n(59868);function d(e){var t=e.state.field(f);if(t){var n=t.type;return"explainCode"===n?(0,u.j)(u.U3.GHOSTWRITER_CHAT_INLINE_CLOSED,{action:"EXPLAIN"}):"generateCode"===n?(0,u.j)(u.U3.GHOSTWRITER_CHAT_INLINE_CLOSED,{action:"GENERATE"}):"transformCode"===n&&(0,u.j)(u.U3.GHOSTWRITER_CHAT_INLINE_CLOSED,{action:"TRANSFORM"}),e.dispatch({effects:l.Q.of(null)}),!0}return!1}var f=o.QQ.define({create:function(){return null},update:function(e,t){if((0,s.j)(t,l.Q,function(t){e=t.value?{codeReference:t.value.codeReference,type:t.value.type,loading:t.value.loading,data:t.value.data}:null}),!e||t.changes.empty)return e;var n=e.codeReference.range.indexFrom>t.newDoc.length?t.newDoc.length:t.changes.mapPos(e.codeReference.range.indexFrom),o=e.codeReference.range.indexTo>t.newDoc.length?t.newDoc.length:t.changes.mapPos(e.codeReference.range.indexTo);return n>=o?null:e=(0,i._)((0,r._)({},e),{codeReference:(0,i._)((0,r._)({},e.codeReference),{range:{indexFrom:n,indexTo:o,lineFrom:t.newDoc.lineAt(n).number,lineTo:t.newDoc.lineAt(o).number}})})},provide:function(e){return[o.Wl.highest(a.$f.of([{key:"Escape",run:d}])),c.gb.from(e,function(e){var t;return null!==(t=(null==e?void 0:e.loading)&&e.codeReference.range.indexFrom===e.codeReference.range.indexTo)&&void 0!==t?t:null})]}}),h=o.QQ.define({create:function(){return null},update:function(e,t){if(!t.state.field(f))return null;var n=!0,r=!1,i=void 0;try{for(var o,a=t.effects[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var c=o.value;c.is(l.Q)&&(e=null),c.is(l.h)&&(e=c.value)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return e}})},92032:function(e,t,n){n.d(t,{k:function(){return o},n:function(){return a}});var r=n(50959),i=RegExp(".*?```(\\w+)\\n(.*?)(?:$|\\n$|\\n`$|\\n``$|\\n```)","gs"),o=function(e,t){for(var n,r=[];null!==(n=i.exec(e));){var o=n[1],a=n[2];if(!1===t){var l=a.substring(0,a.lastIndexOf("\n"));r.push({language:o,code:l})}else r.push({language:o,code:a})}return r};function a(e){return(0,r.useMemo)(function(){if(!(null==e?void 0:e.text))return null;var t=o((null==e?void 0:e.text)||"");return t.length>0?t[0].code:null},[null==e?void 0:e.text])}},54450:function(e,t,n){var r=n(51051).q6.define();t.Z=r},92994:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(50959),i=n(51051);function o(e){var t=e.view,n=e.initialExtension,o=void 0===n?[]:n,a=(0,r.useRef)();return a.current||(a.current=new i.F6),(0,r.useEffect)(function(){if(t){var e=a.current;if(void 0===e.get(t.state))t.dispatch({effects:i.Py.appendConfig.of(e.of(o))});else throw Error("Did not expect useEffect hook to rerun in useCompartment");return function(){t.dispatch({effects:e.reconfigure([])})}}},[t]),a.current}},13358:function(e,t,n){n.d(t,{Z:function(){return U},f:function(){return L}});var r=n(27387),i=n(41733),o=n(30509),a=n(96583),l=n(51051),c=n(80979),s=n(89798),u=n(82200),d=n(92631),f=n(74985),h=n(22487),p=n(72310),m=n(1498),v=n(15146),g=n(74833),y=n(56596),b=n(93918),Z=n(32377),w=n(58719),x=n(29287),C=n(29358),_=n(50959),S=n(61694),E=(0,b.X)({styles0:[x.l0.p(4),x.l0.pl(8)],styles1:[x.l0.maxWidth(100),x.l0.overflow("hidden"),{whiteSpace:"nowrap",textOverflow:"ellipsis"}],styles2:[x.l0.position.absolute,x.l0.top(4),x.l0.right(4)],styles3:[x.l0.flex.rowReverse,x.l0.p(8),x.l0.pt(0)]}),k=(0,b.X)({headerContainer:[x.l0.flex.row,x.l0.align.center,x.l0.pr(4)],bodyContainer:[x.l0.justify.center,x.l0.align.center,x.l0.p(8),x.l0.pt(4)],input:[x.l0.p(4),x.l0.borderRadius(4)],wrapper:[x.l0.flex.column,x.l0.justify.center,x.l0.borderRadius(4),x.l0.shadow(2),x.l0.width(200)]});function T(e){var t=(0,h.Z)(e.onClose,[e.onClose]),n=(0,_.useRef)(null),r=(0,p.Y)(e.currentValue,function(t){return t?t===e.currentValue?{message:"Must pick a new name"}:void 0:{message:"New name can't be empty"}});return(0,f.tZ)(S.ZP,{children:(0,f.tZ)(y.G,{"data-testid":"RenameInput",innerRef:t,css:k.wrapper,onKeyDown:function(t){"Escape"===t.key&&e.onClose(),t.stopPropagation()},children:(0,f.BX)("form",{onSubmit:function(t){t.preventDefault(),r.error||e.onRename(r.value)},children:[(0,f.BX)(y.G,{css:k.headerContainer,children:[(0,f.tZ)(g.h4,{level:2,variant:"subheadDefault",css:E.styles0,children:"Rename"}),(0,f.tZ)(g.h4,{level:2,variant:"subheadDefault",color:"dimmer",css:E.styles1,children:e.currentValue}),(0,f.tZ)(v.hU,{alt:"Close rename input",tooltipHidden:!0,onClick:e.onClose,css:E.styles2,children:(0,f.tZ)(w.Z,{})})]}),(0,f.tZ)(y.G,{css:k.bodyContainer,children:(0,f.tZ)(C.ZP,{css:k.input,name:"rename",ref:n,onBlur:r.handleBlur,onChange:function(e){r.setValue(e.target.value)},value:r.value,placeholder:"New name",autoFocus:!0,autoCorrect:"off",autoCapitalize:"off",autoComplete:"off",validationResults:r.error?[{message:r.error.message,state:"error"}]:void 0})}),(0,f.tZ)(y.G,{css:E.styles3,children:(0,f.tZ)(m.zx,{type:"submit",text:"Rename",colorway:"primary",iconLeft:(0,f.tZ)(Z.Z,{}),disabled:!!r.error||!r.value})})]})})})}var R=n(23758),D=n(54472),I=n(40497),G=n(74106),B=n(72526),A=l.Py.define(),P=l.Py.define();function N(e){var t,n;return null!==(n=null===(t=e.facet(d.N))||void 0===t?void 0:t.isRenameSupported)&&void 0!==n&&n}var U=function(e){if(!N(e.state))return!1;var t=e.state.selection.main.head;return e.state.wordAt(t)?(e.dispatch({effects:A.of(t)}),!0):((0,R.J)(e,{message:"You cannot rename this element",offset:t}),!1)},O=l.QQ.define({create:function(){return null},update:function(e,t){return(null!==e&&(e=t.changes.mapPos(e,-1,l.gc.TrackDel)),(0,I.j)(t,A,function(t){e=t.value}),e&&(e>t.state.doc.length||!t.state.wordAt(e)||!N(t.state)))?null:e},provide:function(e){var t=new D.Jf(T),n=function(t){var n=t.field(e);if(null==n)throw Error("Expected non-null offset");var r=t.wordAt(n);if(!r)throw Error("Expected non-null range");return t.sliceDoc(r.from,r.to)},r=function(r){var a=r.state.field(e);if(null==a)throw Error("Expected non-null offset");if(!r.state.wordAt(a))throw Error("Expected non-null range");var l=t.create({currentValue:n(r.state),onClose:function(){r.dispatch({effects:A.of(null)}),r.focus()},onRename:function(e){r.dispatch({effects:P.of(e)})}});return l.classList.add("replit-tooltip"),l.style.padding="0",{dom:l,update:function(e){t.update(l,function(t){var r=n(e.state);return r!==t.currentValue?(0,o._)((0,i._)({},t),{currentValue:r}):t})}}};return c.hJ.from(e,function(e){return null===e?null:{pos:e,create:r}})}});function L(e,t){return[O,c.lg.define(function(n){var i=null;return{onRename:function(o){return(0,r._)(function(){var r,l,c,d;return(0,a.Jh)(this,function(a){switch(a.label){case 0:if(!N(n.state))return[2,this.cancelInflightRequest()];if(this.cancelInflightRequest(),!(r=n.state.facet(s.Yp)))throw Error("Expected non-null file path");if(!(l=n.state.field(O)))return[2];return i=t.generateId(),[4,t.request.rename(r,(0,G.sg)(n.state.doc,l),o,{id:i,tap:function(e){return(0,u.SC)(n,e)}})];case 1:if((c=a.sent()).cancelled)return[2];if("error"in c)throw Error("Something went wrong renaming ".concat(c.error.message));if(!(d=c.result))return[2];return(0,B.w)({edit:d,fs:e,client:t}),n.dispatch({effects:A.of(null)}),[2]}})}).apply(this)},cancelInflightRequest:function(){i&&(t.notify.cancelRequest(i),i=null)},update:function(e){var t=!0,n=!1,r=void 0;try{for(var i,o=e.transactions[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value,l=!0,c=!1,s=void 0;try{for(var u,d=a.effects[Symbol.iterator]();!(l=(u=d.next()).done);l=!0){var f=u.value;f.is(P)&&this.onRename(f.value)}}catch(e){c=!0,s=e}finally{try{l||null==d.return||d.return()}finally{if(c)throw s}}}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}},destroy:function(){this.cancelInflightRequest()}}})]}},61018:function(e,t,n){n.d(t,{hx:function(){return p},l:function(){return f},sy:function(){return h}});var r=n(51051),i=n(80979),o=n(89798),a=n(75023),l=n(89446),c=n(38041),s=n(19659),u=n(32508),d=n.n(u);function f(e){var t=e.view,n=e.event,i=e.clipboardText,o=e.filePath,a=t.state.selection;if(!o||!(0,s.gK)(o)||a.ranges.length>1||a.main.from===a.main.to||!i||!d()(i)){!function(){if(!n){var e=i||"";if(a.main.empty){var o=a.main.from+e.length;t.dispatch({changes:[{from:a.main.from,insert:e}],selection:r.jT.range(o,o)})}else t.dispatch(t.state.replaceSelection(e))}}();return}n&&n.preventDefault();var l=t.state.sliceDoc(a.main.from,a.main.to),c="[".concat(l,"](").concat(i,")"),u=a.main.from+c.length;t.dispatch({changes:{from:a.main.from,to:a.main.to,insert:c},selection:r.jT.range(u,u)})}var h=i.tk.domEventHandlers({paste:function(e,t){var n;f({filePath:t.state.facet(o.Yp),view:t,event:e,clipboardText:null===(n=e.clipboardData)||void 0===n?void 0:n.getData("Text")})}}),p=new a.j(function(e,t){return i.tk.domEventHandlers({paste:function(n,r){var i=r.state.facet(o.Yp),a=null==n?void 0:null===(p=n.clipboardData)||void 0===p?void 0:p.files,u=function(e){var t=r.state.selection.main.head;r.dispatch({changes:{from:t,insert:e},selection:{anchor:t,head:t+e.length}})};if(a){var d=!0,f=!1,h=void 0;try{for(var p,m,v=a[Symbol.iterator]();!(d=(m=v.next()).done);d=!0){var g=m.value;e?(0,l.L0)(g).then(function(e){return u('"'+e+'"')}):i&&(0,s.gK)(i)&&(0,c.r)(g,t,i).then(u)}}catch(e){f=!0,h=e}finally{try{d||null==v.return||v.return()}finally{if(f)throw h}}}}})})},35895:function(e,t,n){n.d(t,{ZB:function(){return Z},qs:function(){return x},Lo:function(){return b},xv:function(){return R},xg:function(){return D},uh:function(){return y},Do:function(){return T},$X:function(){return I},Yt:function(){return w},Gv:function(){return G},Pz:function(){return C}});var r=n(12285),i=n(4955),o=n(41733),a=n(30509),l=n(9670),c=n(51051),s=n(80979),u=n(86865),d=n(59868),f=n(66626),h={"AWS API Key":/AKIA[0-9A-Z]{16}/g,"AWS AppSync GraphQL Key":/da2-[a-z0-9]{26}/g,"AWS MWS ID":/mzn\.mws\.[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}/g,"AWS client ID":/(A3T[A-Z0-9]|AKIA|AGPA|AIDA|AROA|AIPA|ANPA|ANVA|ASIA)[A-Z0-9]{16}/g,"Discord Bot Token":/(?:N|M|O)[a-zA-Z0-9]{23}\\.[a-zA-Z0-9-_]{6}\\.[a-zA-Z0-9-_]{27}/g,"Discord Webhook Url":/https?:\/\/(?:ptb\.|canary\.)?discord\.com\/api(?:\/v\d{1,2})?\/webhooks\/(\d{17,19})\/([\w-]{68})/gi,"Dynatrace Token":/dt0[a-zA-Z]{1}[0-9]{2}\\.[A-Z0-9]{24}\\.[A-Z0-9]{64}/gi,"Facebook Access Token":/EAACEdEose0cBA[0-9A-Za-z]+/g,"Facebook OAuth":/[fF][aA][cC][eE][bB][oO][oO][kK].*['|"][0-9a-f]{32}['|"]/g,"Github Personal Access Token":/ghp_[0-9a-zA-Z]{36}/g,"Github OAuth Access Token":/gho_[0-9a-zA-Z]{36}/g,"Github App Installation Access Token":/(ghu|ghs)_[0-9a-zA-Z]{36}/g,"Github App Refresh Token":/ghr_[0-9a-zA-Z]{76}/g,"Generic API Key":/[aA][pP][iI]_?[kK][eE][yY].*['|"][0-9a-zA-Z]{32,45}['|"]/g,"Generic Secret":/[sS][eE][cC][rR][eE][tT].*['|"][0-9a-zA-Z]{32,45}['|"]/g,"Google API Key":/AIza[0-9A-Za-z\\-_]{35}/g,"Google Gmail API Key":/AIza[0-9A-Za-z\\-_]{35}/g,"Google OAuth Access Token":/ya29\\.[0-9A-Za-z\\-_]+/g,"Google YouTube API Key":/AIza[0-9A-Za-z\\-_]{35}/g,"Heroku API Key":/[hH][eE][rR][oO][kK][uU].*[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}/g,"MailChimp API Key":/[0-9a-f]{32}-us[0-9]{1,2}/g,"Mailgun API Key":/key-[0-9a-zA-Z]{32}/g,"Mapbox, Public Key":/([s,p]k.eyJ1Ijoi[\w.-]+)/g,"Mapbox, Secret Key":/([s,p]k.eyJ1Ijoi[\w.-]+)/g,"npm Access Token":/npm_[0-9a-zA-Z]{36}/g,"NuGet API Key":/oy2[a-z0-9]{43}/g,"OpenAI API Key":/sk-[a-zA-Z0-9]{48}/g,"PGP private key block":/-----BEGIN PGP PRIVATE KEY BLOCK-----/g,"Picatic API Key":/sk_live_[0-9a-z]{32}/g,"PyPI API Token":/pypi-AgEIcHlwaS5vcmc[A-Za-z0-9-_]{50,1000}/g,"SSH (DSA) private key":/-----BEGIN DSA PRIVATE KEY-----/g,"SSH (EC) private key":/-----BEGIN EC PRIVATE KEY-----/g,"SSH (RSA) private key":/-----BEGIN RSA PRIVATE KEY-----/g,"SendGrid API Key":/SG\\.[0-9A-Za-z\\-_]{22}\\.[0-9A-Za-z-_]{43}/g,"Shopify Access Token":/shpat_[a-fA-F0-9]{32}/g,"Shopify App Shared Secret":/shpss_[a-fA-F0-9]{32}/g,"Shopify Custom App Access Token":/shpca_[a-fA-F0-9]{32}/g,"Shopify Private App Password":/shppa_[a-fA-F0-9]{32}/g,"Slack Token":/(xox[pborsa]-[0-9]{12}-[0-9]{12}-[0-9]{12}-[a-z0-9]{32})/g,"Slack API Token":/xox[baprs]-([0-9a-zA-Z]{10,48})?/g,"Slack Live API Key":/(?:r|s)k_live_[0-9a-zA-Z]{24}/g,"Slack Test API Key":/(?:r|s)k_test_[0-9a-zA-Z]{24}/g,"Slack, OAuth v2 Bot Access Token":/xoxb-[0-9]{11}-[0-9]{11}-[0-9a-zA-Z]{24}/g,"Slack, OAuth v2 Configuration Token":/xoxe.xoxp-1-[0-9a-zA-Z]{166}/g,"Slack, OAuth v2 Refresh Token":/xoxe-1-[0-9a-zA-Z]{147}/g,"Slack, OAuth v2 User Access Token":/xoxp-[0-9]{11}-[0-9]{11}-[0-9a-zA-Z]{24}/g,"Slack Webhook":/https:\/\/hooks.slack.com\/services\/T[a-zA-Z0-9_]{10}\/B[a-zA-Z0-9_]{10}\/[a-zA-Z0-9_]{24}/g,"Square Access Token":/sq0atp-[0-9A-Za-z\\-_]{22}/g,"Square OAuth Secret":/sq0csp-[0-9A-Za-z\\-_]{43}/g,"Stripe API Key":/sk_live_[0-9a-zA-Z]{24}/g,"Stripe Restricted API Key":/rk_live_[0-9a-zA-Z]{24}/g,"Twilio API Key":/SK[0-9a-fA-F]{32}/g,"Twitter Access Token":/[tT][wW][iI][tT][tT][eE][rR].*[1-9][0-9]+-[0-9a-zA-Z]{40}/g,"Twitter OAuth":/[tT][wW][iI][tT][tT][eE][rR].*['|"][0-9a-zA-Z]{35,44}['|"]/g,"Vault Token":/([sb]\.[a-zA-Z0-9]{24})/g},p={"Instagram oauth":/[0-9a-fA-F]{7}.[0-9a-fA-F]{32}/g},m=function(e){"use strict";(0,i._)(n,e);var t=(0,l._)(n);function n(e,i){var o;return(0,r._)(this,n),(o=t.call(this)).id=e,o.result=i,o}return n.range=function(e,t,n){return new this(e,n).range(t.from,t.to)},n.generateId=function(){return this.secretId++},n}(c.uU);m.secretId=0;var v=function(e){"use strict";(0,i._)(n,e);var t=(0,l._)(n);function n(e){var i;return(0,r._)(this,n),(i=t.call(this)).key=e,i}return n.from=function(e){return new this(e)},n}(c.uU),g=c.Py.define({map:function(e,t){var n=c.Xs.of(e).map(t).iter(),r=n.from,i=n.to;return m.range(e.value.id,c.jT.cursor(r,i),e.value.result)}}),y=c.Py.define(),b=c.Py.define(),Z=c.Py.define(),w=c.Py.define(),x=c.Py.define(),C=function(e){var t=e.state.field(D);if(!t.size)return!1;for(var n=t.iter(),r=[];n.value;){var i=n.from,o=n.to,a=n.value;r.push({from:i,to:o,value:a}),n.next()}var l=e.state.doc.length,s=c.as.empty(l),u=[],f=[],h=!0,p=!1,m=void 0;try{for(var v,g=r[Symbol.iterator]();!(h=(v=g.next()).done);h=!0)!function(){var e=v.value,t=e.from,n=e.to,r=e.value,i=r.result.secret,o=c.as.of({from:t,to:n,insert:i},l).map(s,!0);u=u.map(function(e){return e.map(o)});var a=(s=s.compose(o)).mapPos(t)+i.length;u.push(c.jT.cursor(a)),f.push(y.of(r.id)),(0,d.j)(d.U3.PASTE_SCANNER_USED,{action:"original_accepted",provider:r.result.provider})}()}catch(e){p=!0,m=e}finally{try{h||null==g.return||g.return()}finally{if(p)throw m}}return e.dispatch({changes:s,effects:f,selection:c.jT.create(u)}),!0},_=function(e){return!!e.state.facet(I)&&!!e.state.field(D).size&&(e.dispatch({effects:e.state.selection.ranges.map(function(e){return b.of(e)})}),!0)},S=function(e){return!e.state.facet(I)&&E(e)},E=function(e){return!!e.state.field(D).size&&(e.dispatch({effects:e.state.selection.ranges.map(function(e){return y.of(e)})}),!0)};function k(e,t){var n,r=null===(n=e.clipboardData)||void 0===n?void 0:n.getData("text/plain");if(!r)return!1;var i=function(e){if(e.length>2e3)return!1;var t=!0,n=!1,r=void 0;try{for(var i,o=[h,p][Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value,l=!0,c=!1,s=void 0;try{for(var u,d=Object.entries(a)[Symbol.iterator]();!(l=(u=d.next()).done);l=!0){var m=(0,f._)(u.value,2),v=m[0],g=m[1],y=e.search(g);if(!(y<0)){var b=e.match(g);if(b){var Z=y+b[0].length;return{start:y,end:Z,secret:e.slice(y,Z),provider:v}}}}}catch(e){c=!0,s=e}finally{try{l||null==d.return||d.return()}finally{if(c)throw s}}}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}return!1}(r);if(!i)return!1;e.preventDefault(),e.stopPropagation();var l=r.slice(0,i.start)+r.slice(i.end),s=m.generateId();return t.dispatch((0,a._)((0,o._)({},t.state.changeByRange(function(e){var t=e.from,n=e.to,r=c.jT.cursor(t+i.start);return{range:r,changes:{from:t,to:n,insert:l},effects:g.of(m.range(s,r,i))}})),{scrollIntoView:!0})),(0,d.j)(d.U3.PASTE_SCANNER_USED,{action:"secret_detected",provider:i.provider}),!0}var T=c.QQ.define({create:function(){return c.Xs.empty},update:function(e,t){e=e.map(t.changes);var n=!0,r=!1,i=void 0;try{for(var o,a=t.effects[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value;if(l.is(w)){var s=l.value,u=s.from,d=s.to,f=s.secret;e=e.update({add:[v.from(f).range(u,d)],filter:function(){return!1}})}l.is(x)&&(e=c.Xs.empty)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return e}}),R=c.QQ.define({create:function(){return null},update:function(e,t){var n=t.state.field(D,!1),r=!0,i=!1,o=void 0;try{for(var a,l=t.effects[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var s=a.value;n&&s.is(b)&&(s.value instanceof c.xm?n.between(s.value.from,s.value.to,function(t,n,r){e=r}):e=s.value),s.is(Z)&&(e=null)}}catch(e){i=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return e}}),D=c.QQ.define({create:function(){return c.Xs.empty},update:function(e,t){e=e.map(t.changes);var n=!0,r=!1,i=void 0;try{for(var o,a=t.effects[Symbol.iterator]();!(n=(o=a.next()).done);n=!0)!function(){var t=o.value;t.is(g)&&(e=e.update({add:[t.value],sort:!0})),t.is(y)&&(e=t.value instanceof c.xm?e.update({filter:function(){return!1},filterFrom:t.value.from,filterTo:t.value.to}):e.update({filter:function(e,n,r){return r.id!==t.value}}))}()}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return e},provide:function(){return[s.tk.domEventHandlers({paste:k}),c.Wl.highest(s.$f.of([{key:"Mod-z",run:E},{key:"Enter",run:C},{key:"Tab",run:_,stopPropagation:!0},{key:"Escape",run:S}]))]}}),I=c.r$.define({combine:function(e){return e.some(Boolean)}}),G=u.RR.of(function(e){var t=e.state.field(D,!1);if(!t||!t.size)return!1;var n=!1;return t.between(e.newSelection.main.from,e.newSelection.main.to,function(){return n=!0,!1}),n})},81031:function(e,t,n){n.d(t,{F:function(){return C},V:function(){return _}});var r=n(66626),i=n(74985),o=n(80979),a=n(43312),l=n(20142),c=n(81013),s=n(75023),u=n(73157),d=n(15146),f=n(57468),h=n(74833),p=n(56596),m=n(99741),v=n(29287),g=n(50959),y=n(74106),b=(0,a.iv)({scrollbarWidth:"thin",outline:"none",overflow:"auto",".cm-content":{paddingBottom:0},"::-webkit-scrollbar":{width:4},".cm-gutters":{minWidth:"unset"}}),Z=(0,a.iv)({overflow:"hidden",".cm-scroller":{overflow:"hidden"}}),w={root:v.l0.backgroundColor.backgroundRoot,higher:v.l0.backgroundColor.backgroundHigher,highest:v.l0.backgroundColor.backgroundHighest,default:v.l0.backgroundColor.backgroundDefault},x=new s.j(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return(0,o.Eu)({formatNumber:function(t,n){for(var r=String(n.doc.lines).length,i=String(t+e-1);r>i.length;)i="\xa0"+i;return i}})});function C(e){var t=e.path,n=e.initialDoc,r=e.maxHeight,o=e.minHeight,s=e.extensions,u=e.allowScroll,d=e.fontSize,f=e.hideGutter,h=e.startLineNumber,p=e.style,m=e.elevation,v=e.onNavigateToCode,C=(0,c.Z)(),_=C.ref,S=C.view,E=(0,g.useMemo)(function(){var e;return e=w[null!=m?m:"default"],(0,a.iv)({".cm-editor":e,".cm-gutters":e})},[m]),k=x.use(h);return(0,i.tZ)("div",{style:p,children:(0,i.tZ)(l.ZP,{ref:_,initialDoc:n,css:[b,E,void 0===u||u?null:Z],extensions:[k,void 0===s?[]:s],style:{minHeight:o,maxHeight:null!=r?r:"10em"},hideGutter:f,filePath:t,fontSize:d,readOnly:!0,onClick:function(e){if(v&&S){var t=e.clientX,n=e.clientY,r=S.posAtCoords({x:t,y:n});v(null!==r?(0,y.sg)(S.state.doc,r):null)}}})})}function _(e){var t=e.path,n=e.doc,o=e.extensions,a=e.numMatches,l=e.onNavigateToCode,c=e.initiallyExpanded,s=(0,r._)((0,g.useState)(c),2),y=s[0],b=s[1];return(0,i.BX)(p.G,{children:[(0,i.BX)(p.G,{css:[v.l0.width("100%"),v.l0.p(4),v.l0.rowWithGap(8),{alignItems:"center"}],children:[(0,i.tZ)(f.Z,{path:t}),(0,i.tZ)(h.xv,{multiline:!1,title:t,css:[v.l0.flex.shrink(1),{textOverflow:"ellipsis"}],children:t}),(0,i.tZ)(h.xv,{color:"dimmest",multiline:!1,children:(0,u.Z)("match",a,!0)}),(0,i.tZ)(p.G,{css:v.l0.flex.grow(1)}),(0,i.tZ)(d.hU,{alt:y?"Collapse snippet":"Expand snippet",tooltipHidden:!0,onClick:function(){return b(function(e){return!e})},children:(0,i.tZ)(m.Z,{rotate:y?180:0,style:{transition:"200ms ease"}})})]}),(0,i.tZ)(p.G,{css:[v.l0.p(4),{display:y?"block":"none"}],children:(0,i.tZ)(C,{path:t,initialDoc:n,extensions:void 0===o?[]:o,maxHeight:"max-content",allowScroll:!0,hideGutter:!0,onNavigateToCode:l})})]})}},95032:function(e,t,n){n.d(t,{Z:function(){return p}});var r=n(12285),i=n(4955),o=n(9670),a=n(51051),l=n(80979),c=n(73157),s=n(29287),u=new(function(e){"use strict";(0,i._)(n,e);var t=(0,o._)(n);function n(){var e;return(0,r._)(this,n),(e=t.call(this)).elementClass="cm-gutterElement-hidden",e}return n.prototype.toDOM=function(){var e=document.createElement("span");e.classList.add("cm-hidden-lines-gutter");var t=document.createElement("span");return t.classList.add("cm-dot"),e.appendChild(t),e},n}(l.SJ)),d=function(e){"use strict";(0,i._)(n,e);var t=(0,o._)(n);function n(e){var i;return(0,r._)(this,n),(i=t.call(this)).numLines=e,i}var a=n.prototype;return a.eq=function(e){return e.numLines===this.numLines},a.toDOM=function(){var e=document.createElement("span");return e.textContent="".concat(this.numLines," hidden ").concat((0,c.Z)("line",this.numLines)),e.className="cm-hidden-lines",e},n}(l.l9),f=l.p.mark({class:"cm-searchResultMatch"}),h=l.tk.baseTheme({".cm-hidden-lines":{color:"var(--foreground-dimmer)",backgroundColor:"var(--background-highest)",display:"inline-block",width:"100%"},".cm-gutterElement-hidden":{backgroundColor:"var(--background-highest)"},".cm-hidden-lines-gutter":{backgroundColor:"var(--background-highest)",display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%"},".cm-dot":{height:"5px",width:"5px",backgroundColor:"var(--foreground-dimmest)",borderRadius:"50%",display:"inline-block"},".cm-tooltip .cm-scroller":{border:"2px solid var(--background-highest)",borderRadius:"var(--border-radius-4)"},".cm-tooltip .cm-scroller:hover":{border:"2px solid var(--accent-primary-dimmest)",boxShadow:"var(--shadow-1)",cursor:"pointer"},".cm-searchResultMatch":{color:s.TV.foregroundDefault,backgroundColor:s.TV.accentPrimaryDimmest,outline:s.TV.accentPrimaryDimmer+" solid 1px"},".cm-searchResultMatch span":{color:s.TV.foregroundDefault},".cm-tooltip .cm-searchResultMatch:hover":{opacity:.8},".cm-tooltip .cm-gutterElement":{display:"flex",marginTop:0,textAlign:"center",alignItems:"center",justifyContent:"center",lineHeight:"21px"},".cm-tooltip .cm-line":{padding:0},".cm-tooltip .cm-gutters":{padding:0},".cm-tooltip .cm-content":{paddingTop:0},".cm-tooltip .cm-lineWrapping":{whiteSpace:"pre"},".cm-tooltip .cm-cursor":{display:"none"},".cm-tooltip .cm-selectionBackground":{display:"none"}});function p(e,t){var n=e.sort(function(e,t){return e.from-t.from}),r=n.map(function(e){var t=e.from,n=e.to;return f.range(t,n)});return[l.lg.define(function(){return{}},{decorations:function(){return l.p.set(r)}}),function(e,t){var n=[],r=1;e.forEach(function(i,o){var a=t.lineAt(i.from),l=t.lineAt(i.to);r<a.number-2&&n.push({startLine:r,endLine:a.number-2}),r=l.number+2,o===e.length-1&&r<t.lines&&n.push({startLine:r,endLine:t.lines})});var i=n.map(function(e){var n=t.line(e.startLine),r=t.line(e.endLine);return l.p.replace({widget:new d(e.endLine-e.startLine+1)}).range(n.from,r.to)}),o=n.map(function(e){var n=t.line(e.startLine);return l.p.line({class:"cm-line-hidden"}).range(n.from)}),c=a.QQ.define({create:function(){return l.p.set(i)},update:function(e){return e},provide:function(e){return l.tk.decorations.from(e)}}),s=a.QQ.define({create:function(){return l.p.set(o)},update:function(e){return e},provide:function(e){return l.tk.decorations.from(e)}}),f=n.map(function(e){var n=t.line(e.startLine);return u.range(n.from)});return[c,s,h,l.p2.of(a.Xs.of(f))]}(n,t)]}},11570:function(e,t,n){n.d(t,{Ny:function(){return f},_S:function(){return d},oZ:function(){return u}});var r=n(41733),i=n(30509),o=n(66626),a=n(50959),l=n(51051),c=n(10693),s=n(22470);function u(e){return JSON.stringify({fileMap:Array.from(e.fileMap.entries()).map(function(e){var t,n=(0,o._)(e,2);return[n[0],(t=n[1],(0,i._)((0,r._)({},t),{editorState:t.editorState.toJSON({history:c.cE})}))]})})}function d(e){var t=JSON.parse(e).fileMap,n=new s.L(20);return t.forEach(function(e){var t=(0,o._)(e,2),a=t[0],s=t[1];n.set(a,(0,i._)((0,r._)({},s),{editorState:l.yy.fromJSON(s.editorState,void 0,{history:c.cE})}))}),{fileMap:n}}function f(){return{fileMap:new s.L(20)}}var h=(0,a.createContext)(null);t.ZP=h},91433:function(e,t,n){n.d(t,{AL:function(){return w},GD:function(){return m},VO:function(){return p},Y:function(){return b},tT:function(){return g}});var r=n(41733),i=n(21262),o=n(71440),a=n(55846),l=n(58995),c=n(99165);function s(){var e=(0,i._)(["\n  query CodemirrorThread($id: String!) {\n    thread: annotationAnchor(id: $id) {\n      ... on AnnotationAnchor {\n        id\n        ...AnnotationsUIAnchor\n      }\n    }\n    currentUser {\n      id\n      username\n      fullName\n      image\n    }\n  }\n  ","\n"]);return s=function(){return e},e}function u(){var e=(0,i._)(["\n  mutation CreateThread(\n    $thread: AnnotationAnchorInput!\n    $message: AnnotationMessageInput\n    $highlight: AnnotationHighlightInput\n  ) {\n    createThread: createAnnotationAnchor(\n      annotationAnchor: $thread\n      annotationMessage: $message\n      highlight: $highlight\n    ) {\n      ... on AnnotationAnchor {\n        id\n        ...AnnotationsUIAnchor\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return u=function(){return e},e}function d(){var e=(0,i._)(["\n  mutation UpdateThread($id: String!, $changes: AnnotationAnchorChangesInput!) {\n    updateThread: updateAnnotationAnchor(id: $id, changes: $changes) {\n      ... on UserError {\n        message\n      }\n      ... on AnnotationAnchor {\n        id\n        ...AnnotationsUIAnchor\n      }\n    }\n  }\n  ","\n"]);return d=function(){return e},e}function f(){var e=(0,i._)(["\n  mutation CreateThreadMessage(\n    $replId: String!\n    $threadId: String!\n    $threadMessage: AnnotationMessageInput!\n    $highlight: AnnotationHighlightInput\n  ) {\n    createThreadMessage: createAnnotationMessage(\n      replId: $replId\n      anchorId: $threadId\n      annotationMessage: $threadMessage\n      highlight: $highlight\n    ) {\n      ... on UserError {\n        message\n      }\n      ... on AnnotationAnchor {\n        id\n        ...AnnotationsUIAnchor\n      }\n    }\n  }\n  ","\n"]);return f=function(){return e},e}var h={},p=(0,o.Ps)(s(),a.j7);function m(e){var t=(0,r._)({},h,e);return l.a(p,t)}var v=(0,o.Ps)(u(),a.j7);function g(e){var t=(0,r._)({},h,e);return c.D(v,t)}var y=(0,o.Ps)(d(),a.j7);function b(e){var t=(0,r._)({},h,e);return c.D(y,t)}var Z=(0,o.Ps)(f(),a.j7);function w(e){var t=(0,r._)({},h,e);return c.D(Z,t)}},66610:function(e,t,n){n.d(t,{Z:function(){return x}});var r=n(41733),i=n(30509),o=n(66626),a=n(63257),l=n(55846),c=n(30456),s=n(91433),u=n(17491),d=n(55534),f=n(50782),h=n(50199),p=n(54916),m=n(66959),v=n(30826),g=n.n(v),y=n(50959),b=n(50220);function Z(e,t){if(!e)return null;var n,r=e.state.field(b.OQ),i=e.state.field(b.ZS);return(null!==(n=r[t])&&void 0!==n?n:(null==i?void 0:i.id)===t?i:null)||null}function w(e,t){if(!e)return null;var n=Z(e,t);if(!n)return null;var r=Math.min(n.indexStart,n.indexEnd),i=Math.max(n.indexStart,n.indexEnd),o=e.state.doc.lineAt(r),a=e.state.doc.lineAt(i),l=e.state.doc.sliceString(e.state.doc.line(Math.max(o.number-2,1)).from,r),c=e.state.doc.sliceString(i,e.state.doc.line(Math.min(a.number+2,e.state.doc.lines)).to);return{precode:l,code:e.state.doc.sliceString(r,i),postcode:c}}function x(e,t,n){var v=(0,d.Z)().showError,x=(0,f.Z)(),C=(0,c.Z)().map(function(e){return e.username}),_=(0,p.Z)().fs,S=(0,s.GD)({variables:{id:e}}),E=S.data,k=S.error,T=S.loading,R=S.client,D=function(){if(T||!E){var n;return!!t&&(null===(n=t.state.field(b.ZS))||void 0===n?void 0:n.id)===e}return"AnnotationAnchor"!==E.thread.__typename}(),I=(0,y.useMemo)(function(){return T||!E?null:"UserError"===E.thread.__typename?{id:e,__typename:"AnnotationAnchor",messages:[],isGeneral:!1,isResolved:!1}:"AnnotationAnchor"===E.thread.__typename?E.thread:null},[E,e,T]),G=(0,o._)((0,s.tT)({onError:function(e){return v(e.message)},update:function(e,t){var n,r;if(t.errors){t.errors.forEach(function(e){return v(e.message)});return}if((null===(r=t.data)||void 0===r?void 0:null===(n=r.createThread)||void 0===n?void 0:n.__typename)==="UserError"){v(t.data.createThread.message);return}}}),1)[0],B=(0,o._)((0,s.AL)({onError:function(e){return v(e.message)},update:function(e,t){if(t.errors){t.errors.forEach(function(e){return v(e.message)});return}var n,r=null===(n=t.data)||void 0===n?void 0:n.createThreadMessage;r&&"UserError"===r.__typename&&v(r.message)}}),1)[0],A=(0,o._)((0,s.Y)({onError:function(e){return v(e.message)},update:function(e,t){if(t.errors){t.errors.forEach(function(e){return v(e.message)});return}var n,r=null===(n=t.data)||void 0===n?void 0:n.updateThread;r&&"UserError"===r.__typename&&v(r.message)}}),1)[0],P=(0,o._)((0,l.Hj)(),1)[0],N=(0,h.Z)(function(){return g()(P,1e3,{trailing:!1})},[P]),U=function(){var e=null==E?void 0:E.currentUser;return e?{user:{__typename:"User",id:e.id,username:e.username,fullName:e.fullName,image:e.image}}:{}};return{thread:I,isPlaceholder:D,error:k,loading:T,getHighlight:w,getLatestAnchor:function(){return Z(t,e)},updateThread:function(e){var t,n=e.changes,o=(null==E?void 0:null===(t=E.thread)||void 0===t?void 0:t.__typename)==="AnnotationAnchor"?E.thread:null;if(!o)throw Error("expected thread");A({variables:{id:o.id,changes:n},optimisticResponse:{__typename:"RootMutationType",updateThread:(0,i._)((0,r._)({},o,n),{isResolved:"boolean"==typeof n.isResolved?n.isResolved:o.isResolved})}})},finalizeThreadMessage:function(o){var l=o.message,c=o.messageId,d=(0,m.kW)(l,{users:(0,a._)(C).concat(["everyone"])}),f={id:c,text:l,mentions:d.mentions};if(D&&t&&n){var h=t.state.field(b.ZS),p={id:e,replId:x,indexStart:null==h?void 0:h.indexStart,indexEnd:null==h?void 0:h.indexEnd,otVersion:_.getOTVersion(n),path:n};G({variables:{thread:p,message:f,highlight:w(t,e)},optimisticResponse:{__typename:"RootMutationType",createThread:(0,i._)((0,r._)({__typename:"AnnotationAnchor"},p,U()),{messages:[(0,i._)((0,r._)({id:c,timeCreated:new Date().toISOString(),currentUserIsAuthor:!0},U()),{content:{text:l,__typename:"TextMessageContentType"},anchor:{id:p.id,__typename:"AnnotationAnchor"},__typename:"AnnotationMessage",seen:!0})],isResolved:!1,isGeneral:!1})}}),R.writeQuery({query:s.VO,variables:{id:e},data:{__typename:"RootQueryType",thread:(0,i._)((0,r._)((0,i._)((0,r._)({},p),{isResolved:!1,isGeneral:!1}),U()),{messages:[(0,i._)((0,r._)({id:c,timeCreated:new Date().toISOString(),currentUserIsAuthor:!0},U()),{content:{text:l,__typename:"TextMessageContentType"},anchor:{id:p.id,__typename:"AnnotationAnchor"},__typename:"AnnotationMessage",seen:!0})],__typename:"AnnotationAnchor"}),currentUser:null==E?void 0:E.currentUser}});var v=R.readQuery({query:u.Jq,variables:{replId:x,path:n}});if(v){var g,y,Z=(null===(y=v.threadsByFile)||void 0===y?void 0:y.__typename)==="ThreadsByFileResult"?v.threadsByFile.threads:[],S=U().user;R.writeQuery({query:u.Jq,variables:{replId:x,path:n},data:{__typename:"RootQueryType",threadsByFile:{__typename:"ThreadsByFileResult",threads:(0,a._)(Z).concat([(0,r._)({messageCount:1,unreadCount:0,__typename:"AnnotationAnchor",isGeneral:!1,user:S,isResolved:!1,participants:[S]},p)])}}})}return}var k=(null==E?void 0:null===(g=E.thread)||void 0===g?void 0:g.__typename)==="AnnotationAnchor"?E.thread:null;if(!k)throw Error("expected thread");B({variables:{replId:x,threadId:k.id,threadMessage:f,highlight:w(t,k.id)},optimisticResponse:{__typename:"RootMutationType",createThreadMessage:(0,i._)((0,r._)({},k),{messages:(0,a._)(k.messages.filter(function(e){return!e.id.startsWith("chat-")})).concat([(0,i._)((0,r._)({},U(),f),{content:{text:f.text,__typename:"TextMessageContentType"},anchor:{id:k.id,__typename:"AnnotationAnchor"},__typename:"AnnotationMessage",timeCreated:new Date().toISOString(),currentUserIsAuthor:!0,seen:!0})])})}})},changeThreadMessage:function(t){N({variables:{threadId:e,messageId:t.messageId,message:null}})}}}},17491:function(e,t,n){n.d(t,{Jq:function(){return s},eR:function(){return u}});var r=n(41733),i=n(21262),o=n(71440),a=n(58995);function l(){var e=(0,i._)(["\n  query ThreadsByFileHook($replId: String!, $path: String!) {\n    threadsByFile(replId: $replId, path: $path) {\n      ... on ThreadsByFileResult {\n        threads {\n          id\n          path\n          otVersion\n          indexStart\n          indexEnd\n          messageCount\n          unreadCount\n          user {\n            id\n            image\n            username\n          }\n          participants {\n            id\n            image\n            username\n          }\n          isGeneral\n          isResolved\n        }\n      }\n    }\n  }\n"]);return l=function(){return e},e}var c={},s=(0,o.Ps)(l());function u(e){var t=(0,r._)({},c,e);return a.a(s,t)}},62609:function(e,t,n){n.d(t,{B:function(){return o}});var r=n(51051),i=n(40497);function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return e},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=r.Py.define(),o=r.QQ.define({create:function(){return t},update:function(t,r){return(0,i.j)(r,n,function(n){t=e(n.value,t)}),t}});return{effect:n,state:o}}},97703:function(e,t,n){n.d(t,{Z:function(){return a}});var r=n(74985),i=n(4498),o=n(50959);function a(e){var t=e.json,n=(0,o.useMemo)(function(){return JSON.stringify(t,null,2)},[t]);return(0,r.tZ)(i.Z,{language:"json",code:n})}},48528:function(e,t,n){n.d(t,{j:function(){return m},m:function(){return p}});var r=n(41733),i=n(30509),o=n(98924),a=n(66626),l=n(74985),c=n(10041),s=n(1498),u=n(15146),d=n(30983),f=n(50959),h=n(13729);function p(e){var t=e.textToCopy,n=e.tooltip,u=e.timeout,p=void 0===u?4e3:u,m=(0,o._)(e,["textToCopy","tooltip","timeout"]),v=(0,a._)((0,f.useState)(!1),2),g=v[0],y=v[1],b=(0,f.useRef)(null);return(0,f.useEffect)(function(){return function(){b.current&&clearTimeout(b.current)}},[]),(0,l.tZ)(d.u,{isOpen:g,tooltip:null!=n?n:"".concat(t," copied to clipboard"),placement:"bottom-end",children:function(e,n){return(0,l.tZ)(s.zx,(0,i._)((0,r._)({},(0,h.dG)(m,e)),{ref:n,onClick:function(e){(0,c.Z)(t),y(!0),b.current&&clearTimeout(b.current),b.current=setTimeout(function(){return y(!1)},p),m.onClick&&m.onClick(e)}}))}})}function m(e){var t=e.textToCopy,n=e.tooltip,s=e.timeout,p=void 0===s?4e3:s,m=e.children,v=(0,o._)(e,["textToCopy","tooltip","timeout","children"]),g=(0,a._)((0,f.useState)(!1),2),y=g[0],b=g[1],Z=(0,f.useRef)(null);return(0,f.useEffect)(function(){return function(){Z.current&&clearTimeout(Z.current)}},[]),(0,l.tZ)(d.u,{isOpen:y,tooltip:null!=n?n:"".concat(t," copied to clipboard"),placement:"bottom-end",children:function(e,n){return(0,l.tZ)(u.hU,(0,i._)((0,r._)({},(0,h.dG)(e,v)),{ref:n,onClick:function(e){(0,c.Z)(t),b(!0),Z.current&&clearTimeout(Z.current),Z.current=setTimeout(function(){return b(!1)},p),v.onClick&&v.onClick(e)},children:m}))}})}},42098:function(e,t,n){n.d(t,{E:function(){return m}});var r=n(66626),i=n(74985),o=n(59868),a=n(1498),l=n(49344),c=n(74833),s=n(56596),u=n(32377),d=n(29287),f=n(54916),h=n(50959),p=(0,n(93918).X)({styles0:[d.l0.colWithGap(16)],styles1:[d.l0.justify.end,d.l0.rowWithGap(16)]});function m(){var e=(0,f.Z)().replspaceApi,t=(0,r._)((0,h.useState)(null),2),n=t[0],d=t[1];return(0,h.useEffect)(function(){return e.onConfirmSendToken(function(e){e&&(0,o.j)(o.U3.MODAL_VIEWED,{modalName:"git_token_modal"}),d(function(){return e})})},[e]),(0,i.tZ)(l.u,{isOpen:"function"==typeof n,onRequestClose:function(){null==n||n(!1),(0,o.j)(o.U3.GIT_TOKEN_MODAL_ACCEPTED,{response:"close"}),d(null)},children:(0,i.BX)(s.G,{css:p.styles0,children:[(0,i.tZ)(c.h4,{variant:"headerDefault",level:3,children:"Pass GitHub Credentials"}),(0,i.tZ)(c.xv,{children:"It looks like you're trying to connect to your GitHub repository through the shell. Pass your token to the shell?"}),(0,i.tZ)(c.xv,{children:"If you did not initiate a git command, you should deny this."}),(0,i.BX)(s.G,{css:p.styles1,children:[(0,i.tZ)(a.zx,{onClick:function(){null==n||n(!1),(0,o.j)(o.U3.GIT_TOKEN_MODAL_ACCEPTED,{response:"deny"}),d(null)},text:"Deny"}),(0,i.tZ)(a.zx,{onClick:function(){null==n||n(!0),(0,o.j)(o.U3.GIT_TOKEN_MODAL_ACCEPTED,{response:"confirm"}),d(null)},iconLeft:(0,i.tZ)(u.Z,{}),text:"Confirm for this session",colorway:"primary"})]})]})})}},96298:function(e,t,n){n.d(t,{Z:function(){return x}});var r=n(74985),i=n(10041),o=n(1498),a=n(70002),l=n(15146),c=n(24463),s=n(74833),u=n(30983),d=n(56596),f=n(12874),h=n(48728),p=n(41733),m=n(30509),v=n(26),g=function(e){return(0,r.tZ)(v.Z,(0,m._)((0,p._)({viewBox:"0 0 800.5 907.77"},e),{children:(0,r.tZ)("path",{d:"M303.36,238.61c31.36-21.37,71.76-12.97,65-6.53c-12.89,12.28,4.26,8.65,6.11,31.31 c1.36,16.69-4.09,25.88-8.78,31.11c-9.79,1.28-21.69,3.67-36.02,8.33c-8.48,2.76-15.85,5.82-22.31,8.9 c-1.7-1.11-3.55-2.47-5.74-4.36C279.5,288.19,280.24,254.37,303.36,238.61 M490.68,370.72c5.69-4.41,31.55-12.72,55.49-15.55 c12.57-1.48,30.49-2.34,34.31-0.2c7.59,4.19,7.59,17.16,2.39,29.14c-7.57,17.4-18.27,36.63-30.39,38.21 c-19.77,2.61-38.46-8.09-59.8-24.03C485.06,392.56,480.38,378.68,490.68,370.72 M526.75,201.27c29.19,13.58,25.37,39.42,26.18,54.6 c0.22,4.36,0.15,7.3-0.22,9.32c-4.04-2.19-10.43-3.8-20.56-3.35c-2.96,0.12-5.84,0.47-8.63,0.91c-10.77-5.77-17.21-17.06-23.1-29.06 c-0.54-1.11-0.96-2.1-1.36-3.06c-0.17-0.44-0.35-0.91-0.52-1.31c-0.07-0.22-0.12-0.39-0.2-0.59c-3.23-10.25-1.06-12.3,0.3-15.46 c1.41-3.23,6.68-5.89-1.11-8.58c-0.67-0.25-1.5-0.39-2.44-0.57C500.25,197.72,515.7,196.17,526.75,201.27 M367.62,510.22 c-31.45-20.19-63.99-49.15-78.22-65.18c-2.39-1.8-2-9.79-2-9.79c12.84,9.98,66.11,48.04,122.44,65.42 c19.87,6.14,50.36,8.46,76.81-6.53c20.21-11.46,44.54-31.43,59.06-52.01l2.66,4.61c-0.1,3.06-6.78,17.97-10.18,23.96 c6.14,3.53,10.72,4.49,17.55,6.36l46.64-7.27c16.74-27.04,28.74-70.65,15.95-112.16c-7.3-23.81-45.36-71.22-48.09-73.83 c-9.56-9.19,1.6-44.69-17.35-83.42C532.86,159.41,480.67,116.69,458,98.1c6.68,4.88,47.82,21.47,67,44.62 c1.8-2.39,2.54-14.82,4.19-17.97c-16.47-21.57-17.75-59.95-17.75-70.21c0-18.81-9.56-40.13-9.56-40.13s16.47,13.04,20.73,35.5 c5.03,26.6,15.75,47.55,29.93,65.28c26.84,33.43,51.08,50.58,63.33,38.23C630.53,138.58,601,72.2,563.28,35.15 C519.25-8.09,507.74-2.52,481.91,6.7c-20.61,7.35-31.75,65.87-85.47,64.71c-9.1-1.06-32.54-1.63-44.13-1.53 c6.04-8.43,11.22-14.94,11.22-14.94s-18.02,7.25-33.38,16.44l-1.18-1.77c5.18-10.92,10.75-17.82,10.75-17.82s-14.4,8.65-27.54,19.01 c2.39-13.02,11.44-21.27,11.44-21.27s-18.19,3.28-41.36,28.77c-26.33,7.2-32.66,11.93-53.64,21.22 c-34.12-7.44-50.21-19.45-65.55-41.56c-11.68-16.89-32.47-19.45-53.71-10.72c-30.97,12.8-70.14,30.33-70.14,30.33 s12.77-0.52,26.08,0.05c-18.22,6.9-35.72,16.39-35.72,16.39s8.53-0.3,19.06-0.12c-7.27,6.04-11.29,8.92-18.22,13.51 c-16.66,12.1-30.17,26.08-30.17,26.08s11.31-5.15,21.47-8.04c-7.1,16.27-21.18,28.25-18.59,48.17 c2.49,18.19,24.82,55.66,53.64,78.66c2.49,2,41.86,38.43,71.56,23.47c29.68-14.94,41.39-28.25,46.27-48.66 c5.74-23.44,2.47-41.17-9.79-92.05c-4.04-16.79-14.57-51.37-19.65-67.91l1.13-0.81c9.71,20.49,34.56,74.5,44.57,110.78 c15.63,56.57,10.75,85.27,3.6,95.79c-21.57,31.73-76.84,35.92-101.98,18.34c-3.85,60.91,9.76,87.73,14.37,101.24 c-2.29,15.53,7.77,44.37,7.77,44.37s1.13-13.11,5.74-20.02c1.23,15.41,9,33.72,9,33.72s-0.47-11.31,3.06-21.08 c4.98,8.43,8.63,10.43,13.34,16.76c4.71,16.47,14.15,28.5,14.15,28.5s-1.53-8.83-0.69-18.02c23.05,22.14,27.02,54.45,29.31,79.28 c6.46,68.26-107.63,122.54-129.74,165.24c-16.76,25.29-26.8,65.3,1.58,88.89c68.6,56.97,42.25,72.65,76.59,97.69 c47.11,34.34,106.05,18.96,126.11-8.97c27.93-38.92,20.76-75.63,10.38-109.97c-8.11-26.85-30.15-71.46-57.41-88.72 c-27.86-17.65-54.95-20.95-77.9-18.59l2.12-2.44c33.01-6.56,67.52-2.96,92.49,13.14c28.35,18.22,54.28,49.47,67.84,97.37 c15.38-2.19,17.55-3.18,31.63-5.18l-31.7-246.76L367.62,510.22z M385.94,819.52l-3.65-34.22l71.29-108.74l80.93,23.64l69.59-116.23 L687.52,639l63.38-132.92l22.53,242.07L385.94,819.52z M774.27,456.51l-254.72,46.17c-6.31,8.13-21.91,22.41-29.41,26.13 c-32.17,16.2-53.91,11.51-72.7,6.63c-12.08-3.06-19.08-4.78-29.11-9.29l-62.17,8.53l37.74,314.87l436.35-78.66L774.27,456.51z"})}))},y=n(75875),b=n(29287),Z=n(70671),w=(0,n(93918).X)({styles0:[b.l0.rowWithGap(2),{alignItems:"center"}],styles1:[b.l0.align.center]});function x(e){var t=e.replId,n=e.showFlag,p=e.buttonsOnly,m=(0,Z.F)().isDarkColorScheme;return(0,r.BX)(r.HY,{children:[(0,r.tZ)(a.Z,{href:"https://app.datadoghq.com/logs?"+new URLSearchParams({query:"@replid:".concat(t)}).toString(),iconLeft:(0,r.tZ)(g,{color:m?"#FFFFFF":"#632CA6"}),iconRight:(0,r.tZ)(f.Z,{}),target:"_blank",text:"View Datadog Logs"}),void 0!==p&&p?(0,r.tZ)(u.u,{maxWidth:300,tooltip:(0,r.tZ)(s.xv,{multiline:!1,children:t}),children:(0,r.tZ)(o.zx,{iconLeft:(0,r.tZ)(h.Z,{}),text:"Copy Repl ID",onClick:function(){return(0,i.Z)(t)}})}):(0,r.BX)(d.G,{css:w.styles0,children:[void 0!==n&&n?(0,r.BX)(u.u,{tooltip:"You are seeing this functionality because you have special permissions.",children:[(0,r.tZ)(y.Z,{})," "]}):null,(0,r.BX)(s.xv,{css:w.styles1,multiline:!1,children:["Repl ID: ",(0,r.tZ)(c.Z,{children:t})]}),(0,r.tZ)(l.hU,{alt:"Copy to clipboard",onClick:function(){return(0,i.Z)(t)},children:(0,r.tZ)(h.Z,{})})]})]})}},66932:function(e,t,n){n.d(t,{$:function(){return l},i:function(){return a}});var r=n(75582),i=n(40028),o=n(40699);function a(e,t){if(void 0!==t)switch(t){case r.DZ.HostingTierE2Micro:return e.hostingTierE2Micro;case r.DZ.HostingTierE2Small:return e.hostingTierE2Small;case r.DZ.HostingTierE2Medium:return e.hostingTierE2Medium;case r.DZ.HostingTierN1Custom_1_4:return e.hostingTierN1Custom1_4;case r.DZ.HostingTierE2Standard_2:return e.hostingTierE2Standard2;case r.DZ.HostingTierE2Standard_4:return e.hostingTierE2Standard4;default:(0,i.Z)(t)}}function l(e){var t=o.r4[e],n=t.vCpu,r=t.ram,i=t.dedicated;return"".concat(i?"Dedicated ":"").concat(n," vCPU / ").concat(r," GiB RAM")}},84096:function(e,t,n){n.d(t,{e:function(){return p}});var r=n(74985),i=n(63388),o=n(7877),a=n(75582),l=n(74833),c=n(30983),s=n(56596),u=n(93918),d=n(29287),f=n(16572),h=(0,u.X)({root:[d.l0.py(4),d.l0.rowWithGap(4),d.l0.align.center]});function p(e){var t=e.deployment,n=e.small,u=t.currentBuild,d=i.VR[u.status],p=d.title,m=d.color,v=(0,f.Z)(new Date(u.timeCreated),Date.now(),{addSuffix:!0}),g="Deployed ".concat(v," by ").concat(u.user.displayName),y=u.status===a.Fe.Success?"Deployed":p;return(0,r.tZ)(c.u,{tooltip:g,children:(0,r.BX)(s.G,{css:h.root,children:[(0,r.tZ)(o.Z,{size:n?12:16,color:m}),(0,r.tZ)(l.xv,{variant:n?"small":void 0,color:"dimmest",multiline:!1,children:y})]})})}},31577:function(e,t,n){n.d(t,{$:function(){return s}});var r=n(66626),i=n(74985),o=n(50959),a=n(90234),l=n(60427),c=n(64420);function s(e){var t=(0,r._)((0,o.useState)(function(){var t,n,r,i,o,c;return n=(t={fs:e.fs,container:e.container,dotReplit:e.dotReplit,ports:e.ports}).container,r=t.fs,i=t.dotReplit,o=t.ports,(c=(0,a.MT)()).set(l.CK,n),c.set(l.bA,r),c.set(l.My,i),c.set(l.l,o),c}),1)[0];return(0,i.BX)(c.aT.Provider,{value:t,children:[e.children,(0,i.tZ)(l.jd,{replId:e.replId})]})}},92977:function(e,t,n){n.d(t,{Gs:function(){return f},Qw:function(){return d},un:function(){return h}});var r=n(41733),i=n(66626),o=n(74985),a=n(43312),l=n(56596),c=n(93918),s=n(50959),u=n(36855),d=(0,c.X)({maxWidth:{width:"100%",maxWidth:600,marginLeft:"auto",marginRight:"auto"}}),f=function(e,t){return(0,a.F4)("\n  0% {\n    opacity: 0;\n    height: ".concat((null==t?void 0:t.from)?t.from:0,"px;\n  }\n  99% {\n    opacity: 1;\n    height: ").concat(e,"px;\n  }\n  ").concat((null==t?void 0:t.noAuto)?"100% {\n        opacity: 1;\n        height: ".concat(e,"px;\n      }"):"100% {\n    height: auto;\n  }","\n"))};function h(e){var t,n,a,c=e.children,d=e.render,f=e.timeout,h=void 0===f?300:f,p=e.initialHeight,m=(0,s.useRef)(null),v=(0,s.useRef)(null),g=(n=(t=(0,i._)((0,s.useState)(0),2))[0],a=t[1],(0,s.useEffect)(function(){if(v.current){var e=new ResizeObserver(function(e){var t=!0,n=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var l=i.value.borderBoxSize[0].blockSize;a(l)}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}});return e.observe(v.current),function(){return e.disconnect()}}},[n,v]),n),y=g>0?g:p,b={transition:h+"ms ease-out",transitionProperty:"height, opacity",opacity:0,height:0,visibility:"hidden"},Z={entering:{opacity:1,height:y},entered:{transitionProperty:"opacity",opacity:1,height:y,visibility:"visible"},exiting:{opacity:0,height:0,visibility:"visible"},exited:{opacity:0,height:0,visibility:"hidden"}};return(0,o.tZ)(u.ZP,{nodeRef:m,timeout:h,in:d,children:function(e){return(0,o.tZ)(l.G,{innerRef:m,style:(0,r._)({},b,Z[e]),children:(0,o.tZ)(l.G,{innerRef:v,children:c})})}})}},14186:function(e,t,n){var r,i,o,a;n.d(t,{a:function(){return i},k:function(){return r}}),(o=r||(r={})).Intro="intro",o.Deployment="deployment",o.DeploymentInProgress="deployment_in_progress",o.Analytics="analytics",o.Logs="logs",o.Settings="settings",o.ReservedVMTierSelection="reserved_vm_tier_selection",o.AutoscaleMachineConfiguration="autoscale_machine_configuration",(a=i||(i={})).SendDeploymentLifecycleCommand="send_deployment_lifecycle_command",a.ChangeView="change_view",a.OpenDotReplit="open_dot_replit"},59121:function(e,t,n){n.d(t,{E:function(){return r},c:function(){return i}});var r="Procfile";function i(e){var t={};return e.split("\n").forEach(function(e){if(""!==e){var n=e.match(/^([A-Za-z0-9_]+):\s*(.+)$/);if(n){var r=n[2].trim().split(" ");t[n[1]]={command:r[0],options:r.slice(1)}}}}),t}},69470:function(e,t,n){n.d(t,{Z:function(){return i}});var r=n(50959);function i(){return(0,r.useMemo)(function(){return function(){if("undefined"==typeof document)return!1;var e=document.createElement("input");return"webkitdirectory"in e||"mozdirectory"in e||"msdirectory"in e||"odirectory"in e||"directory"in e}()},[])}},13225:function(e,t,n){var r=n(50959);t.Z=function(e,t,n){(0,r.useEffect)(function(){var t=setTimeout(e,n);return function(){clearTimeout(t)}},t)}},62789:function(e,t,n){n.d(t,{f6:function(){return c},oj:function(){return l},xZ:function(){return u}});var r=n(66626),i=n(54916),o=n(50959);function a(e){var t=(0,r._)((0,o.useState)(!1),2),n=t[0],a=t[1],l=(0,i.Z)().dotReplit;return(0,o.useEffect)(function(){var t=!1;return l.getConfig().then(function(n){t||n.error||n.config.language!==e||a(!0)}),function(){t=!0}},[e,l]),n}function l(){return a("kaboom")}function c(){return a("kaboomdraw")}var s=/^draw.[tj]s$/;function u(e){return c()&&!!(null==e?void 0:e.match(s))}},85172:function(e,t,n){n.d(t,{v:function(){return d}});var r=n(41733),i=n(21262),o=n(71440),a=n(58995);function l(){var e=(0,i._)(["\n  query ReplTeamOrgSettings($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        owner {\n          __typename\n          ... on Team {\n            id\n            organization {\n              id\n              isAiEnabled\n            }\n          }\n        }\n      }\n    }\n  }\n"]);return l=function(){return e},e}var c={},s=(0,o.Ps)(l()),u=n(50782);function d(){var e,t,n,i,o=(n={variables:{replId:(0,u.Z)()}},i=(0,r._)({},c,n),a.a(s,i)).data;return{isTeamWithAiDisabled:(null==o?void 0:o.repl.__typename)==="Repl"&&(null===(e=o.repl.owner)||void 0===e?void 0:e.__typename)==="Team"&&(null===(t=o.repl.owner.organization)||void 0===t?void 0:t.isAiEnabled)===!1}}},76433:function(e,t,n){n.d(t,{Z:function(){return d}});var r=n(56337),i=n(21557),o=n(54916),a=n(47611),l=n.n(a),c=n(50959),s=n(30084),u="You have unsaved changes";function d(){var e=(0,r.Z)(),t=(0,o.Z)().fs,n=(0,a.useRouter)(),d=(0,c.useRef)(!1),f=(0,c.useCallback)(function(){if(!e&&!d.current&&t.getStatus()!==s.kO.Clean&&!window.confirm(u))throw l().events.emit("routeChangeError"),Error("Abort route change. Please ignore this error.")},[t,e]);return(0,c.useEffect)(function(){function r(n){if(!e&&!d.current&&t.getStatus()!==s.kO.Clean)return n.preventDefault(),n.returnValue=u,u}return window.addEventListener("beforeunload",r),i.gn||n.events.on("routeChangeStart",f),function(){window.removeEventListener("beforeunload",r),i.gn||n.events.off("routeChangeStart",f)}},[n.events,t,f,e]),(0,c.useCallback)(function(e){d.current=e},[])}},78774:function(e,t,n){n.d(t,{Z:function(){return m}});var r=n(66626),i=n(66349),o=n(54916),a=n(50959),l=n(25202),c=n(41733),s=n(21262),u=n(71440),d=n(99165);function f(){var e=(0,s._)(["\n  mutation ReplFsUpdated($replId: String!) {\n    updateReplTimeUpdated(id: $replId) {\n      ... on Repl {\n        id\n        timeUpdated\n      }\n    }\n  }\n"]);return f=function(){return e},e}var h={},p=(0,u.Ps)(f());function m(){var e,t=(0,r._)((e=(0,c._)({},h,void 0),d.D(p,e)),1)[0],n=(0,o.Z)().fs,s=(0,i.Z)(),u=null==s?void 0:s.currentUserPermissions.containerWrite,f=null==s?void 0:s.id;(0,a.useEffect)(function(){if(u&&f){var e=(0,l.Z)(function(){return t({variables:{replId:f}})},{wait:6e4,maxWait:6e5}),r=n.onStatusChange(function(){e()});return function(){e.isScheduled()&&e.flush(),r()}}},[n,f,u,t])}},12435:function(e,t,n){n.d(t,{Z:function(){return d}});var r=n(66626),i=n(63257),o=n(6187),a=n(50959),l=n(41733),c=n(30509),s=function(e){return/\s/.test(e)};function u(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=(0,r._)((0,a.useState)(null),2),o=i[0],u=i[1],d=(0,a.useCallback)(u,[u]),f=(0,a.useRef)(t);(0,a.useEffect)(function(){f.current=t},[t]);var h=(0,r._)((0,a.useState)(null),2),p=h[0],m=h[1];return(0,a.useEffect)(function(){if(o){var e=function(){var e=o.value,t=o.selectionStart;if(!t){m(null);return}var n=1===t||s(e[t-2]||""),r=e.length?e[t-1]:null;m(function(i){if(i&&(t<i.index||0===t))return null;if(!r||!i&&!n)return i;var o=f.current.includes(r);return i||o?i?s(r)?null:(0,c._)((0,l._)({},i),{text:e.slice(i.index,t)}):{index:t,text:"",match:r}:i})},t=function(){m(null)};return o.addEventListener("focus",e),o.addEventListener("keyup",e),o.addEventListener("blur",t),function(){m(null),o.removeEventListener("focus",e),o.removeEventListener("keyup",e),o.removeEventListener("blur",t)}}},[o,m]),[p,d]}function d(e){var t=(0,a.useRef)(e);(0,a.useEffect)(function(){t.current=e},[e]);var n=(0,r._)((0,a.useState)(!1),2),l=n[0],c=n[1],s=(0,r._)((0,a.useState)(null),2),d=s[0],f=s[1],h=(0,r._)(u.apply(void 0,(0,i._)(Object.keys(e))),2),p=h[0],m=h[1],v=(0,a.useRef)(p);(0,a.useEffect)(function(){v.current=p},[p]);var g=(0,o.Z)(p,100);return(0,a.useEffect)(function(){if(!g){f(null);return}var e=g.match,n=g.text,r=t.current[e]?t.current[e]:null;if(!r){f(null);return}var i=!1;return c(!0),r(n).then(function(e){i||v.current!==g||(c(!1),f({textTrigger:g,results:e,applySuggestion:function(e){var t=e.targetValue,n=e.suggestionValue,r=t.slice(0,g.index),i=n,o=t.slice(g.index+g.text.length);o&&o.startsWith(" ")||(i+=" ");var a=r+i+o;return{cursorIndex:(r+i).length+(o&&o.startsWith(" ")?1:0),fullValue:a}}}))}),function(){i=!0}},[g,f]),[{isLoading:l,suggestions:d},m]}},23896:function(e,t,n){n.d(t,{T:function(){return o}});var r=n(54916),i=n(16643);function o(){var e=(0,r.Z)().toolchain;return(0,i.Z)(e.configs)}},64457:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(66626),i=n(2038),o=n(35614),a=n(50959);function l(){var e=(0,a.useRef)(0),t=(0,r._)((0,a.useState)(!1),2),n=t[0],l=t[1],c=(0,i.T3)(),s=(0,i.rv)(),u=(0,o.u)();return(0,a.useEffect)(function(){var t,n=window.visualViewport;if(n){if(s){l(null!==(t=null==u?void 0:u.isShown)&&void 0!==t&&t);return}if(c){var r=function(){l(n.height<.8*e.current)};return e.current=n.height,n.addEventListener("resize",r),function(){n.removeEventListener("resize",r)}}}},[c,s,null==u?void 0:u.isShown]),n}},99672:function(e,t,n){n.d(t,{Z:function(){return d}});var r=n(41733),i=n(30509),o=n(39426),a=n(66626),l=n(58130),c=n(54916),s=n(50959),u=n(2689);function d(e,t){var n,d,f,h,p=(n=(0,c.Z)().container,f=(d=(0,a._)((0,s.useState)(null),2))[0],h=d[1],(0,s.useEffect)(function(){if(n)return n.onConnectionStateChanged(function(){h(n.getConnectionMetadata())})},[n]),(0,s.useMemo)(function(){return f?(0,l.he)(f.token):null},[f]));(0,s.useEffect)(function(){if(e&&t){var n,a,l,c=(null===(n=e.origin)||void 0===n?void 0:n.__typename)==="Repl"?e.origin.id:null,s=(0,o.cR)(e.rootOriginReplUrl);return(0,u.Fy)((0,i._)((0,r._)({id:e.id,slug:e.slug,originId:c,roles:t.roles&&t.roles.map(function(e){return e.name}),rootOriginReplUrl:e.rootOriginReplUrl,rootOriginReplReleaseId:null===(l=e.source)||void 0===l?void 0:null===(a=l.release)||void 0===a?void 0:a.id},0!==s.length&&{languages:s}),{tokenCluster:null==p?void 0:p.cluster})),function(){(0,u.dv)()}}},[e,t,p])}},24227:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(27387),i=n(96583),o=n(19659),a=/\(copy\)( \d+)?$/,l=/\d+$/,c=n(39756);function s(e,t){return u.apply(this,arguments)}function u(){return(u=(0,r._)(function(e,t){var n,r,s,u,d,f;return(0,i.Jh)(this,function(i){switch(i.label){case 0:return n=(0,o.Il)(e),[4,t.readDir(0===n.length?c.Ql:n)];case 1:if((r=i.sent()).error)throw r.error;return s=new Set(r.children.map(function(e){return e.filename})),u=function(e,t){for(var n=(0,o.r6)(e),r=(0,o.eb)(e),i=a.test(r)?e:"".concat(r," (copy)").concat(n.length>0?".".concat(n):""),c=1;c<=t.size&&t.has(i);c++){var s=(0,o.eb)(i),u=s.split(" ");l.test(s)&&u.pop(),i="".concat(u.join(" ")," ").concat(c),n.length>0&&(i+=".".concat(n))}return i}((0,o.UO)(e),s),d=n?"".concat(n,"/").concat(u):u,[4,t.copyFile(e,d)];case 2:if((f=i.sent()).error)throw f.error;return[2,d]}})})).apply(this,arguments)}},56320:function(e,t,n){n.d(t,{Z:function(){return P}});var r=n(66626),i=n(74985),o=n(48528),a=n(55534),l=n(10041),c=n(59868),s=n(18836),u=n(76566),d=n(38080),f=n(4070),h=n(74833),p=n(56596),m=n(93918),v=n(39390),g=n(8017),y=n(88936),b=n(20573),Z=n(29287),w=n(41733),x=n(21262),C=n(71440),_=n(58995),S=n(99165);function E(){var e=(0,x._)(["\n  query MultiplayerInviteUrl($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        inviteUrl\n        owner {\n          ... on User {\n            id\n          }\n          ... on Team {\n            id\n            capabilities {\n              isBusinessPlan\n              hasValidSubscription\n            }\n          }\n        }\n      }\n    }\n  }\n"]);return E=function(){return e},e}function k(){var e=(0,x._)(["\n  mutation MultiplayerRefreshInviteUrl($replId: String!) {\n    refreshMultiplayerInviteLink(replId: $replId) {\n      id\n      ... on Repl {\n        id\n        inviteUrl\n      }\n    }\n  }\n"]);return k=function(){return e},e}function T(){var e=(0,x._)(["\n  mutation DeleteMultiplayerInviteUrl($replId: String!) {\n    deleteMultiplayerInviteLink(replId: $replId) {\n      ... on Repl {\n        id\n        inviteUrl\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n"]);return T=function(){return e},e}var R={},D=(0,C.Ps)(E()),I=(0,C.Ps)(k()),G=(0,C.Ps)(T()),B=(0,m.X)({container:[Z.l0.colWithGap(12),Z.l0.px(16),Z.l0.pt(12),{borderTop:"solid 1px ".concat(Z.TV.outlineDimmest)}],header:[Z.l0.flex.row,Z.l0.justify.spaceBetween],globeIconContainer:[Z.l0.width(40),Z.l0.height(40),Z.l0.backgroundColor.accentPrimaryDimmer,Z.l0.borderRadius("full"),Z.l0.align.center,Z.l0.justify.center],title:[Z.l0.fontWeight.medium],loading:[Z.l0.rowWithGap(4),Z.l0.align.center],inviteUrlContainer:[Z.l0.borderRadius(8),Z.l0.flex.row],input:[Z.l0.borderRadius(8,0,0,8),Z.l0.color.foregroundDimmer],copyToClipboard:[Z.l0.borderRadius(0,8,8,0)],titleGroup:[Z.l0.rowWithGap(12)]}),A=function(){return(0,i.BX)(p.G,{css:B.titleGroup,children:[(0,i.tZ)(p.G,{css:B.globeIconContainer,children:(0,i.tZ)(v.Z,{color:Z.TV.accentPrimaryStrongest,size:20})}),(0,i.BX)(p.G,{children:[(0,i.tZ)(h.xv,{css:B.title,id:"link-switch-label",multiline:!1,children:"Private join link"}),(0,i.tZ)(h.xv,{variant:"small",color:"dimmest",multiline:!1,children:"Anyone with this link can edit files"})]})]})};function P(e){var t,n,m,v,x,C,E,k,T,P,N,U=e.replId,O=(0,a.Z)(),L=O.showConfirm,M=O.showError,X=(t=(0,w._)({},R,{variables:{replId:U}}),_.a(D,t)),F=X.data,W=X.loading,H=X.error,V=X.refetch,z=(0,r._)((n=(0,w._)({},R,{variables:{replId:U},onError:function(e){return M(e.message)},onCompleted:function(){return L("Join link created")}}),S.D(I,n)),2),j=z[0],q=z[1],Y=(0,r._)((m=(0,w._)({},R,{variables:{replId:U},optimisticResponse:{deleteMultiplayerInviteLink:{id:U,inviteUrl:null,__typename:"Repl"},__typename:"RootMutationType"},onError:function(e){return M(e.message)},onCompleted:function(e){if("UserError"===e.deleteMultiplayerInviteLink.__typename){M(e.deleteMultiplayerInviteLink.message);return}"Repl"===e.deleteMultiplayerInviteLink.__typename&&L("Join link deleted")}}),S.D(G,m)),2),$=Y[0],J=Y[1],K=(null==F?void 0:null===(v=F.repl)||void 0===v?void 0:v.__typename)==="Repl"?F.repl:null,Q=q.loading||J.loading,ee=(null==F?void 0:null===(x=F.repl)||void 0===x?void 0:x.__typename)==="Repl"&&(null==K?void 0:null===(C=K.owner)||void 0===C?void 0:C.__typename)==="Team",et=(null==F?void 0:null===(E=F.repl)||void 0===E?void 0:E.__typename)==="Repl"&&(null==K?void 0:null===(k=K.owner)||void 0===k?void 0:k.__typename)==="Team"&&(null==K?void 0:null===(T=K.owner.capabilities)||void 0===T?void 0:T.isBusinessPlan)&&(null==K?void 0:null===(P=K.owner.capabilities)||void 0===P?void 0:P.hasValidSubscription),en=(null==F?void 0:null===(N=F.repl)||void 0===N?void 0:N.__typename)==="Repl"&&(null==K?void 0:K.inviteUrl)?window.location.origin+(null==K?void 0:K.inviteUrl):null;return W||ee&&!et?null:H?(0,i.BX)(p.G,{css:B.container,children:[(0,i.BX)(p.G,{css:B.header,children:[(0,i.tZ)(A,{}),(0,i.tZ)(f.r,{isSelected:!1,isDisabled:!0,"aria-labelledby":"link-switch-label"})]}),(0,i.tZ)(u.u,{css:[Z.l0.textAlign.left],icon:(0,i.tZ)(b.Z,{color:Z.TV.accentNegativeStrongest}),colorway:"negative",text:"Error loading join link. Click here to try again, or contact support.",onClick:function(){return V({replId:U})}})]}):(0,i.BX)(p.G,{css:B.container,children:[(0,i.BX)(p.G,{css:B.header,children:[(0,i.tZ)(A,{}),W?(0,i.BX)(p.G,{css:B.loading,children:[(0,i.tZ)(y.Z,{color:Z.TV.foregroundDimmer}),(0,i.tZ)(h.xv,{color:"dimmer",multiline:!1,children:"Loading..."})]}):(0,i.tZ)(f.r,{isSelected:!!en,isDisabled:Q,onChange:function(e){Q||(e?j():$())},"aria-labelledby":"link-switch-label"})]}),!W&&en?(0,i.BX)(i.HY,{children:[(0,i.BX)(d.Tg,{css:B.inviteUrlContainer,children:[(0,i.tZ)(s.II,{type:"url",readOnly:!0,disabled:!0,value:Q?"Loading...":en,css:B.input}),(0,i.tZ)(o.m,{textToCopy:en,onClick:function(){en?((0,l.Z)(en),(0,c.j)(c.U3.JOIN_LINK_COPIED,{replId:null==K?void 0:K.id,isTeamRepl:ee,source:"replEnvironment"}),L("Link copied")):M("Could not copy link")},tooltip:"Copied to clipboard",text:"Copy join link",iconLeft:(0,i.tZ)(g.Z,{}),css:B.copyToClipboard,colorway:"primary",disabled:Q})]}),(0,i.tZ)(p.G,{children:(0,i.BX)(h.xv,{color:"dimmer",variant:"small",multiline:!1,children:["Want to revoke access to this link?"," ",(0,i.tZ)("a",{css:Z.l0.linkStyle,role:"button",tabIndex:0,onKeyDown:function(e){"Enter"!==e.key||(e.preventDefault(),Q||j())},onClick:function(e){e.preventDefault(),Q||j()},children:"Generate a new link"})]})})]}):null]})}},70712:function(e,t,n){n.d(t,{Jh:function(){return C},RJ:function(){return k},U:function(){return w},dE:function(){return g},mH:function(){return b},z8:function(){return S}});var r=n(41733),i=n(21262),o=n(71440),a=n(58995),l=n(99165);function c(){var e=(0,i._)(["\n  fragment MultiplayerManagerUser on User {\n    id\n    image\n    username\n    url\n  }\n"]);return c=function(){return e},e}function s(){var e=(0,i._)(["\n  fragment MultiplayerManagerEmailInviteReplPermission on ReplPermission {\n    id\n    type\n    user {\n      id\n      image\n      username\n      url\n    }\n  }\n"]);return s=function(){return e},e}function u(){var e=(0,i._)(["\n  query MultiplayerManager($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        isOwner\n        multiplayers {\n          ...MultiplayerManagerUser\n        }\n        currentUserPermissions {\n          editMultiplayers\n        }\n        multiplayerInvites {\n          email\n          type\n        }\n      }\n    }\n    currentUser {\n      id\n      isSubscribed\n    }\n  }\n  ","\n"]);return u=function(){return e},e}function d(){var e=(0,i._)(["\n  mutation MultiplayerManagerAddMultiplayerUser(\n    $replId: String!\n    $username: String!\n    $type: String!\n  ) {\n    addMultiplayerUser(replId: $replId, username: $username, type: $type) {\n      id\n      type\n      user {\n        ...MultiplayerManagerUser\n      }\n      repl {\n        id\n        multiplayers {\n          ...MultiplayerManagerUser\n        }\n        multiplayerInvites {\n          email\n          type\n        }\n      }\n    }\n  }\n  ","\n"]);return d=function(){return e},e}function f(){var e=(0,i._)(["\n  mutation MultiplayerManagerRemoveMultiplayerUser(\n    $replId: String!\n    $username: String!\n  ) {\n    removeMultiplayerUser(replId: $replId, username: $username) {\n      id\n      user {\n        id\n        ...MultiplayerManagerUser\n      }\n      repl {\n        id\n        multiplayers {\n          ...MultiplayerManagerUser\n        }\n      }\n    }\n  }\n  ","\n"]);return f=function(){return e},e}function h(){var e=(0,i._)(["\n  mutation MultiplayerManagerCreateMultiplayerInvite(\n    $replId: String!\n    $email: String!\n    $type: String!\n  ) {\n    createMultiplayerInvite2(replId: $replId, email: $email, type: $type) {\n      ... on MultiplayerInvite {\n        email\n        repl {\n          id\n          multiplayers {\n            ...MultiplayerManagerUser\n          }\n          multiplayerInvites {\n            email\n            type\n          }\n        }\n      }\n      ... on UserError {\n        message\n      }\n      ... on ReplPermission {\n        id\n        ...MultiplayerManagerEmailInviteReplPermission\n      }\n    }\n  }\n  ","\n  ","\n"]);return h=function(){return e},e}function p(){var e=(0,i._)(["\n  mutation MultiplayerManagerDeleteMultiplayerInvite(\n    $replId: String!\n    $email: String!\n  ) {\n    deleteMultiplayerInvite(replId: $replId, email: $email) {\n      ... on MultiplayerInvite {\n        email\n        type\n        repl {\n          id\n          multiplayers {\n            ...MultiplayerManagerUser\n          }\n          multiplayerInvites {\n            email\n            type\n          }\n        }\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return p=function(){return e},e}var m={},v=(0,o.Ps)(c()),g=(0,o.Ps)(s()),y=(0,o.Ps)(u(),v);function b(e){var t=(0,r._)({},m,e);return a.a(y,t)}var Z=(0,o.Ps)(d(),v);function w(e){var t=(0,r._)({},m,e);return l.D(Z,t)}var x=(0,o.Ps)(f(),v);function C(e){var t=(0,r._)({},m,e);return l.D(x,t)}var _=(0,o.Ps)(h(),v,g);function S(e){var t=(0,r._)({},m,e);return l.D(_,t)}var E=(0,o.Ps)(p(),v);function k(e){var t=(0,r._)({},m,e);return l.D(E,t)}},14267:function(e,t,n){n.d(t,{_U:function(){return R},ln:function(){return D}});var r=n(66626),i=n(63257),o=n(74985),a=n(55534),l=n(2038),c=n(59868),s=n(3630),u=n(38080),d=n(74833),f=n(30983),h=n(56596),p=n(1128),m=n(97615),v=n(88936),g=n(29287),y=n(4773),b=n(58091),Z=n(47611),w=n(50959),x=n(94376),C=n(14709),_=n.n(C),S=n(70712),E=n(6836),k=n(44343);function T(e,t){return t.some(function(t){return t.id===e})}var R={root:[g.l0.color.foregroundDefault,g.l0.flex.column,g.l0.colWithGap(12),g.l0.align.stretch,g.l0.flex.growAndShrink(1)],header:[g.l0.flex.row,g.l0.justify.spaceBetween,g.l0.align.center,g.l0.px(16)],header_mobile:[g.l0.px(0)],titleContainer:[g.l0.flex.row,g.l0.rowWithGap(4),g.l0.align.center],limitsContainer:[g.l0.align.center,g.l0.rowWithGap(8)],loading:[g.l0.rowWithGap(4),g.l0.align.center,g.l0.flex.grow(1),g.l0.justify.center],measureBar:[g.l0.height(8),g.l0.width(60)],searchContainer:[g.l0.px(16),g.l0.position.relative,g.l0.maxHeight(32)],userList:[g.l0.flex.column,g.l0.colWithGap(16),g.l0.scrollbar.thin,g.l0.position.relative,g.l0.overflowY("auto"),g.l0.flex.growAndShrink(1),g.l0.pb(8),{maxHeight:300,"::-webkit-scrollbar-thumb":[g.l0.backgroundColor.backgroundHighest,g.l0.borderRadius(4)],scrollbarColor:"".concat(g.TV.backgroundDefault," ").concat(g.TV.backgroundHighest)}],userGroup:{root:[g.l0.colWithGap(8)],titleContainer:[g.l0.rowWithGap(4),g.l0.align.center,g.l0.px(16)],title:[g.l0.fontWeight.medium]},emptyContainer:[g.l0.position.relative,g.l0.flex.row,g.l0.rowWithGap(12),g.l0.py(64),g.l0.center,g.l0.px(16),{maxHeight:220,borderBottom:"solid 1px ".concat(g.TV.outlineDimmest)}]},D=function(e){var t=e.title,n=e.count,r=e.color,i=e.tooltip;return(0,o.BX)(h.G,{css:R.userGroup.titleContainer,children:[(0,o.tZ)(p.Z,{color:r,size:6}),(0,o.tZ)(d.xv,{variant:"small",css:R.userGroup.title,multiline:!1,children:t}),(0,o.tZ)(d.xv,{multiline:!1,variant:"small",color:"dimmest",css:R.userGroup.title,children:n}),i?(0,o.tZ)(f.u,{tooltip:i,children:(0,o.tZ)(m.Z,{})}):null]})};t.ZP=function(e){var t=e.replId,n=e.handleUpgradeTriggered,f=(0,Z.useRouter)(),p=(0,l.Vg)(f),m=(0,a.Z)(),C=m.showConfirm,I=m.showError,G=(0,b.aG)(),B=(0,S.mH)({variables:{replId:t},pollInterval:8e3}),A=B.data,P=B.loading,N=(0,r._)((0,S.U)({onCompleted:function(e){var n,r=null===(n=e.addMultiplayerUser.user)||void 0===n?void 0:n.username;r&&((0,c.j)(c.U3.MULTIPLAYER_INVITED,{replId:t,inviteMethod:"username"}),C("Added @".concat(r)))}}),2),U=N[0],O=N[1],L=(0,r._)((0,S.z8)({update:function(e,n){var r=null===(a=n.data)||void 0===a?void 0:a.createMultiplayerInvite2;if(r){if("UserError"===r.__typename){I(r.message);return}if("MultiplayerInvite"===r.__typename){var o=r.email;(0,c.j)(c.U3.MULTIPLAYER_INVITED,{replId:t,inviteMethod:"email"}),C("Invited ".concat(o," via email"));return}if("ReplPermission"===r.__typename){e.modify({id:e.identify({__typename:"Repl",id:t}),fields:{permissions:function(t){var n=e.writeFragment({data:r,fragment:S.dE});return(0,i._)(t).concat([n])}}});var a,l,s=null===(l=r.user)||void 0===l?void 0:l.username;if(!s)return;(0,c.j)(c.U3.MULTIPLAYER_INVITED,{replId:t,inviteMethod:"email"}),C("Invited @".concat(s))}}}}),2),M=L[0],X=L[1];(0,w.useEffect)(function(){var e=O.error||X.error;if(e){if(e.message.includes("reached the limit")){p?I("You have reached the invite limit for a free account, visit https://replit.com/pricing to upgrade."):n&&n(!0);return}I(e.message)}},[O.error,X.error,I,p,n]);var F=(null==A?void 0:A.repl.__typename)==="Repl"?A.repl:null,W=null==A?void 0:A.currentUser,H=null==F?void 0:F.multiplayers.reduce(function(e,t){return(0,i._)(e).concat([t.username])},[]),V=(null==F?void 0:F.currentUserPermissions.editMultiplayers)||!1,z=!!(F&&!F.multiplayers.length&&!F.multiplayerInvites.length),j=null==F?void 0:F.multiplayers.filter(function(e){return e.id!==(null==W?void 0:W.id)}),q=null==j?void 0:j.filter(function(e){return e&&T(e.id,G)}),Y=null==j?void 0:j.filter(function(e){return e&&!T(e.id,G)}),$=j?j.length:null;return(0,o.BX)(u.Tg,{background:"default",css:R.root,children:[(0,o.BX)(h.G,{css:[R.header,p&&R.header_mobile],children:[(0,o.tZ)(h.G,{css:R.titleContainer,children:(0,o.tZ)(d.xv,{variant:"subheadDefault",multiline:!1,children:"Multiplayers"})}),(0,o.BX)(h.G,{css:R.limitsContainer,children:[P?(0,o.BX)(h.G,{css:R.loading,children:[(0,o.tZ)(v.Z,{color:g.TV.foregroundDimmer}),(0,o.tZ)(d.xv,{color:"dimmer",multiline:!1,children:"Loading..."})]}):null,null===$||(null==W?void 0:W.isSubscribed)?null:(0,o.BX)(o.HY,{children:[(0,o.BX)(d.xv,{variant:"small",color:"dimmest","aria-hidden":!0,multiline:!1,children:[$," / ",x.z]}),(0,o.tZ)(s.J,{css:R.measureBar,total:x.z,current:$,tooltip:"".concat(x.z-$," free editors remaining")})]}),P||(null==W?void 0:W.isSubscribed)||p?null:(0,o.tZ)(y.Z,{size:"small",context:"workspace_multiplayer_header",onClickCallback:function(){n&&n(!0)},onCancel:function(){n&&n(!1)}})]})]}),V&&H&&F?(0,o.tZ)(h.G,{css:R.searchContainer,children:(0,o.tZ)(k.Z,{existingUsernames:H,onSubmit:function(e){if(!P||(null==W?void 0:W.isSubscribed)){if(_()(e)&&!X.loading){M({variables:{replId:t,email:e,type:"rw"}});return}O.loading||U({variables:{username:e,replId:t,type:"rw"}})}}})}):null,z?(0,o.tZ)(h.G,{css:R.emptyContainer,children:(0,o.tZ)(h.G,{children:(0,o.tZ)(d.xv,{variant:"subheadDefault",color:"dimmer",multiline:!1,children:"No one else is here"})})}):(0,o.BX)(u.Tg,{css:R.userList,children:[(null==q?void 0:q.length)?(0,o.BX)(h.G,{css:R.userGroup.root,children:[(0,o.tZ)(D,{title:"Online",count:q.length||0,color:g.TV.greenStrongest}),q.map(function(e){return e?(0,o.tZ)(E.Z,{isPendingInvitation:!1,replId:t,canEditMultiplayers:V,user:e},e.id):null})]}):null,(null==Y?void 0:Y.length)?(0,o.BX)(h.G,{css:R.userGroup.root,children:[(0,o.tZ)(D,{title:"Offline",count:Y.length||0,color:g.TV.outlineStrongest}),null==Y?void 0:Y.map(function(e){return e?(0,o.tZ)(E.Z,{canEditMultiplayers:V,isPendingInvitation:!1,user:e,replId:t},e.id):null})]}):null,(null==F?void 0:F.multiplayerInvites.length)?(0,o.BX)(h.G,{css:R.userGroup.root,children:[(0,o.tZ)(D,{title:"Pending Invitations",count:(null==F?void 0:F.multiplayerInvites.length)||0,color:g.TV.outlineStrongest}),F.multiplayerInvites.map(function(e){return(0,o.tZ)(E.Z,{canEditMultiplayers:V,replId:t,isPendingInvitation:!0,email:e.email},e.email)})]}):null]})]})}},6836:function(e,t,n){var r=n(66626),i=n(74985),o=n(46056),a=n(55534),l=n(15146),c=n(74833),s=n(54254),u=n(56596),d=n(93918),f=n(17216),h=n(58719),p=n(29287),m=n(50862),v=n(33988),g=n.n(v),y=n(70712),b=(0,d.X)({root:[p.l0.px(16),p.l0.py(4),p.l0.flex.row,p.l0.rowWithGap(8),p.l0.align.center,p.l0.cursor.default,p.l0.justify.spaceBetween],userContainer:p.l0.color.foregroundDefault,userContainer_pending:[p.l0.flex.grow(1),p.l0.flex.row,p.l0.rowWithGap(8),p.l0.align.center,{fontStyle:"italic"}],permissionsContainer:[p.l0.flex.row,p.l0.rowWithGap(8),p.l0.align.center]});t.Z=function(e){var t,n=e.isPendingInvitation,d=e.canEditMultiplayers,v=e.replId,Z=(0,a.Z)(),w=Z.showError,x=Z.showConfirm,C=(0,r._)((0,y.Jh)({onError:function(e){return w(e.message)},onCompleted:function(e){var t,n=null===(t=e.removeMultiplayerUser.user)||void 0===t?void 0:t.username;n&&x("".concat(n," removed"))}}),2),_=C[0],S=C[1],E=(0,r._)((0,y.RJ)({onError:function(e){return w(e.message)},onCompleted:function(e){if("UserError"===e.deleteMultiplayerInvite.__typename){w(e.deleteMultiplayerInvite.message);return}if("MultiplayerInvite"===e.deleteMultiplayerInvite.__typename){var t=e.deleteMultiplayerInvite.email;x("Invite canceled for ".concat(t))}}}),2),k=E[0],T=E[1],R=!n,D=R?(0,i.tZ)(o.Z,{size:"m",url:e.user.image,username:e.user.username,fullName:e.user.fullName}):(0,i.tZ)(f.Z,{color:p.TV.outlineDefault,size:32}),I=R?e.user.username:e.email;return(0,i.BX)(u.G,{css:b.root,children:[R?(0,i.tZ)(m.Z,{username:e.user.username,children:(0,i.tZ)(g(),{legacyBehavior:!0,href:"/@".concat(e.user.username),passHref:!0,children:(0,i.tZ)(u.G,{tag:"a",css:b.userContainer,children:(0,i.tZ)(s.n,{username:e.user.username,src:null!==(t=e.user.image)&&void 0!==t?t:null})})})}):(0,i.BX)(u.G,{css:[b.userContainer_pending],children:[D,(0,i.tZ)(c.xv,{color:R?"default":"dimmest",multiline:!1,children:I})]}),(0,i.BX)(u.G,{css:b.permissionsContainer,children:[(0,i.tZ)(c.xv,{color:"dimmest",variant:"small",multiline:!1,children:e.isPendingInvitation?"Invited":"Can edit"}),d?(0,i.tZ)(l.hU,{alt:R?"Remove member":"Cancel invitation",onClick:function(){!d||S.loading||T.loading||(R?_({variables:{replId:v,username:e.user.username}}):k({variables:{replId:v,email:e.email}}))},children:(0,i.tZ)(h.Z,{size:12})}):null]})]})}},44343:function(e,t,n){n.d(t,{Z:function(){return E}});var r=n(41733),i=n(30509),o=n(66626),a=n(74985),l=n(46056),c=n(6187),s=n(55534),u=n(1498),d=n(18836),f=n(38080),h=n(74833),p=n(56596),m=n(93918),v=n(32377),g=n(88936),y=n(29287),b=n(10981),Z=n(21371),w=n(50959),x=n(14709),C=n.n(x),_=n(57574),S=(0,m.X)({form:[y.l0.align.start,y.l0.display.flex,y.l0.rowWithGap(8),y.l0.width("100%")],searchContainer:[y.l0.position.relative,y.l0.flex.growAndShrink(1)],dropdownMenu:[y.l0.borderRadius(8),y.l0.overflow("hidden"),y.l0.mt(2),y.l0.zIndex(2),y.l0.border({color:y.TV.outlineDimmer,width:1,style:"solid"}),y.l0.maxHeight(280),y.l0.overflowY("auto"),y.l0.scrollbar.thin,{scrollbarColor:y.TV.backgroundHigher+" "+y.TV.backgroundHighest,"&::-webkit-scrollbar-thumb":{backgroundColor:y.TV.backgroundHighest}}],result:[y.l0.p(8),y.l0.rowWithGap(8),y.l0.justify.spaceBetween,y.l0.align.center,y.l0.cursor.pointer],result_active:[y.l0.backgroundColor.accentPrimaryDimmer],userContainer:[y.l0.rowWithGap(8),y.l0.align.center],loadingContainer:[y.l0.align.center,y.l0.m(8),y.l0.rowWithGap(8),y.l0.align.center],emptyText:[y.l0.m(8)]});function E(e){var t=e.onSubmit,n=e.existingUsernames,m=e.isDisabled,x=e.onChange,E=e.placeholder,k=(0,o._)((0,w.useState)(""),2),T=k[0],R=k[1],D=(0,b.U)(),I=(0,c.Z)(T.trim().replace(/^@/,""),250),G=(0,_.sk)({skip:!I||C()(T),variables:{query:I,limit:6}}),B=G.data,A=G.loading,P=G.error,N=(0,s.Z)().showError;(0,w.useEffect)(function(){P&&N(P.message)},[P,N]);var U=null==B?void 0:B.usernameSearch,O=function(e){R(e.currentTarget.value),null==x||x(e.currentTarget.value)},L=function(e){"Enter"===e.key&&T.match(/.+@.+/)&&(t(T),R(""),e.currentTarget.blur())};return(0,a.BX)("form",{onSubmit:function(e){e.preventDefault(),t(T),R("")},css:S.form,children:[(0,a.tZ)(Z.ZP,{onChange:function(e){e&&R(e.username)},itemToString:function(e){return(null==e?void 0:e.username)||""},initialHighlightedIndex:0,defaultHighlightedIndex:0,children:function(e){var t=e.getInputProps,o=e.getItemProps,c=e.getMenuProps,s=e.isOpen,u=e.highlightedIndex,m=e.getRootProps;return(0,a.BX)(p.G,(0,i._)((0,r._)({css:S.searchContainer},m({refKey:"innerRef"})),{children:[(0,a.tZ)(d.II,(0,r._)({id:D("username-search")},t({ref:null,value:T,onChange:O,placeholder:null!=E?E:"Add people by username or email",autoComplete:"off",onKeyDown:L}))),s?(0,a.BX)(p.G,{children:[U&&U.length?(0,a.tZ)(f.Tg,(0,i._)((0,r._)({elevated:!0,css:S.dropdownMenu,tag:"ul"},c({refKey:"innerRef"})),{children:U.map(function(e,t){return(0,a.BX)(p.G,(0,i._)((0,r._)({tag:"li"},o({item:e,index:t})),{css:[S.result,t===u&&S.result_active],children:[(0,a.BX)(p.G,{css:S.userContainer,children:[(0,a.tZ)(l.Z,{size:"m",url:e.image,username:e.username,fullName:e.fullName}),(0,a.tZ)(h.xv,{multiline:!1,children:e.username})]}),n.includes(e.username)?(0,a.tZ)(p.G,{children:(0,a.tZ)(v.Z,{color:y.TV.accentPositiveStronger})}):null]}),t)})})):null,A?(0,a.tZ)(f.Tg,{elevated:!0,css:S.dropdownMenu,children:(0,a.BX)(p.G,{css:S.loadingContainer,children:[(0,a.tZ)(g.Z,{}),(0,a.tZ)(h.xv,{color:"dimmer",multiline:!1,children:"Loading"})]})}):null,U&&0===U.length?(0,a.tZ)(f.Tg,{elevated:!0,css:S.dropdownMenu,children:(0,a.BX)(h.xv,{css:S.emptyText,color:"dimmer",multiline:!1,children:['No results found for "',T,'"']})}):null]}):null]}))}}),(0,a.tZ)(p.G,{children:(0,a.tZ)(u.zx,{colorway:"primary",type:"submit",disabled:m||!T,text:"Invite"})})]})}},68866:function(e,t,n){n.d(t,{s:function(){return e$}});var r=n(74985),i=n(41588),o=n(59868),a=n(89960),l=n(27387),c=n(41733),s=n(30509),u=n(66626),d=n(96583),f=n(95109),h=n(60814),p=n(84460),m=n(88211),v=n(7755),g=n(74833),y=n(56596),b=n(74094),Z=n(29287);function w(e){var t=e.amount,n=e.includeUsd,i=e.variant,o=e.color,a=void 0===o?"default":o,l=(0,v.$E)(t),c=(0,v.H2)(t);return(0,r.BX)(y.G,{css:[Z.l0.rowWithGap(2),Z.l0.align.center],children:[(0,r.tZ)(b.Z,{size:"small"===i?12:16,css:[g.E_[a]]}),(0,r.BX)(g.xv,{variant:i,color:a,multiline:!1,children:[c,n?" (".concat(l,")"):""]})]})}var x=n(44225),C=n(75582),_={boost:C.kL.Boost,hosting_tier:C.kL.HostingTier},S={boost_2cpu_2ram:C.s2.Boost_2cpu_2ram,boost_4cpu_4ram:C.s2.Boost_4cpu_4ram,boost_8cpu_8ram:C.s2.Boost_8cpu_8ram,boost_16cpu_16ram:C.s2.Boost_16cpu_16ram,hosting_tier_e2_micro:C.s2.HostingTierE2Micro,hosting_tier_e2_small:C.s2.HostingTierE2Small,hosting_tier_e2_medium:C.s2.HostingTierE2Medium,hosting_tier_n1_custom_1_4:C.s2.HostingTierN1Custom_1_4,hosting_tier_e2_standard_2:C.s2.HostingTierE2Standard_2,hosting_tier_e2_standard_4:C.s2.HostingTierE2Standard_4},E=n(28585),k=n(90777),T=n(1498),R=n(68514),D=n(15146),I=n(93918),G=n(52924),B=n(88936),A=n(99656),P=n(91685),N=n(88817),U=n(50959),O=n(40699),L=n(98965),M=n(21262),X=n(71440),F=n(33248),W=n(19762),H=n(78711);function V(){var e=(0,M._)(["\n  query RefetchPowerUps($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        ...MultiBoostReplPowerUps\n        ...ReplPowerUpMutationReturnFields\n      }\n    }\n    currentUser {\n      ...PowerUpMutationReturnFields\n    }\n  }\n  ","\n  ","\n  ","\n"]);return V=function(){return e},e}var z={},j=(0,X.Ps)(V(),F.s1,W.sh,W.E_),q=function(e){var t,n=e.productCost,r=e.cyclesBalance;if(n<=r)return{cyclesToBePurchased:0,cyclesBalanceAfterUpgrade:r,excessPurchaseExplanation:"no-purchase"};var i=n-r,o="no-excess";i>=O.gp?(t=i,o="no-excess"):(t=O.gp,o="minimum");var a=r+t-n;return{cyclesToBePurchased:t,cyclesBalanceAfterUpgrade:a,excessPurchaseExplanation:o}};function Y(e){var t=e.cycles,n=e.description;return(0,r.BX)(y.G,{css:[Z.l0.rowWithGap(8),Z.l0.align.center],children:[(0,r.tZ)(g.xv,{color:"dimmest",multiline:!1,children:n}),(0,r.tZ)(R.R,{}),(0,r.tZ)(w,{amount:t,includeUsd:!1,color:"dimmest"})]})}var $=(0,I.X)({iconBackground:[Z.l0.width(40),Z.l0.height(40),Z.l0.borderRadius(8),Z.l0.justify.center,Z.l0.align.center,Z.l0.backgroundColor.blueDimmer],loadingContainer:[Z.l0.justify.center,Z.l0.align.center,Z.l0.minHeight(80)]});function J(e){var t=e.powerUpCategory,n=e.cyclesCost,o=e.description,a=i.S0[t];return(0,r.tZ)(y.G,{css:[Z.l0.colWithGap(16)],children:(0,r.BX)(y.G,{css:[Z.l0.flex.row,Z.l0.justify.spaceBetween],children:[(0,r.BX)(y.G,{css:[Z.l0.rowWithGap(8),Z.l0.align.center],children:[(0,r.tZ)(y.G,{css:$.iconBackground,children:(0,r.tZ)(a.iconComponent,{size:24})}),(0,r.BX)(y.G,{css:[Z.l0.px(8),Z.l0.py(2),Z.l0.colWithGap(4),Z.l0.justify.spaceBetween],children:[(0,r.tZ)(g.xv,{variant:"subheadDefault",multiline:!1,children:a.name}),(0,r.tZ)(g.xv,{variant:"small",color:"dimmer",multiline:!1,children:o})]})]}),(0,r.BX)(y.G,{css:[Z.l0.px(8),Z.l0.py(2),Z.l0.colWithGap(4),Z.l0.justify.spaceBetween,Z.l0.align.end],children:[(0,r.tZ)(w,{amount:n,includeUsd:!0}),(0,r.BX)(g.xv,{variant:"small",color:"dimmer",multiline:!1,children:["per / ",a.orderDuration]})]})]})})}function K(e){var t,n,o,a=e.product,v=e.goToCheckoutSuccess,b=e.goToNewPaymentMethodForm,w=(0,f.useStripe)(),C=(0,h.Z)({forceFetch:!0}),I=C.cycles,M=C.loading,X=(0,k.Q)(),F=X.paymentMethod,W=X.loading,V=i.S0[a.powerUpCategory],K=i.$[a.powerUpSku].provisionDescription,Q=(0,u._)((0,U.useState)(null),2),ee=Q[0],et=Q[1],en=(0,u._)((0,U.useState)(!1),2),er=en[0],ei=en[1],eo=(0,u._)((0,U.useState)(!1),2),ea=eo[0],el=eo[1],ec=(0,E.M)().createCheckoutSession,es=(0,u._)((t={variables:{replId:a.replId}},n=(0,c._)({},z,t),H.t(j,n)),1)[0],eu=(0,L.B)().startPolling,ed=(0,p.kr)({defaultAutoRefillEnabledValue:!0}),ef=ed.autoRefillEnabled,eh=ed.autoRefillMonthlyBudget,ep=ed.autoRefillHasError,em=ed.autoRefillHasChanged,ev=ed.cardAutoRefillPreferencesProps,eg=q({productCost:a.cyclesCostNow,cyclesBalance:null!=I?I:0}),ey="This will purchase ".concat(eg.cyclesToBePurchased.toLocaleString()," Cycles for ").concat((0,O.qJ)(eg.cyclesToBePurchased)," and activate your ").concat(V.name,".");"minimum"===eg.excessPurchaseExplanation&&(ey="This will purchase the minimum purchase amount of ".concat(eg.cyclesToBePurchased.toLocaleString()," Cycles for ").concat((0,O.qJ)(eg.cyclesToBePurchased)," and activate your ").concat(V.name,"."));var eb=(0,u._)((0,U.useState)("Processing..."),2),eZ=eb[0],ew=eb[1],ex=(0,N.i)(),eC=ex.isPurchaseAllowed,e_=ex.reasonPurchaseNotAllowed;if(!eC&&e_)return(0,r.tZ)(P.Z,{reason:e_});var eS=function(){ei(!1)},eE=(o=(0,l._)(function(){return(0,d.Jh)(this,function(e){switch(e.label){case 0:var t;if(ei(!0),null==F)throw Error("paymentMethod is null");if(null==w)throw Error("stripe is null");return ew("Checking out..."),[4,ec({input:{cyclesQuantity:eg.cyclesToBePurchased,postPurchasePowerUp:{replPowerUp:{replId:a.replId,sku:S[a.powerUpSku],type:_[a.powerUpCategory]}},cyclesAutoRefillConfiguration:em?{enabled:ef,monthlyBudget:eh}:null},onError:function(e){et(e),eS()},onSucceed:(t=(0,l._)(function(e){var t,n;return(0,d.Jh)(this,function(r){switch(r.label){case 0:return ew("Processing payment..."),[4,w.confirmCardPayment(e.clientSecret)];case 1:if(t=r.sent().error)return et(null!==(n=t.message)&&void 0!==n?n:"An error occurred. Please try again."),eS(),[2];return ew("Provisioning Power Up..."),eu({checkoutSessionId:{checkoutSessionId:e.checkoutSessionId}.checkoutSessionId,onSucceeded:function(){el(!0),es(),v(a)},onFailed:function(){et("Payment failed. Please try again."),eS(),es()},onError:function(e){et(e),eS(),es()}}),[2]}})}),function(e){return t.apply(this,arguments)})})];case 1:return e.sent(),[2]}})}),function(){return o.apply(this,arguments)}),ek=W||M||null==I,eT=null!=F&&!ek&&!er;return(0,r.BX)(y.G,{css:[Z.l0.colWithGap(16)],children:[(0,r.tZ)(J,{powerUpCategory:a.powerUpCategory,cyclesCost:O.z4[a.powerUpSku],description:K}),(0,r.tZ)(R.R,{}),ek?(0,r.tZ)(y.G,{css:$.loadingContainer,children:(0,r.tZ)(B.Z,{})}):(0,r.tZ)(y.G,{css:[Z.l0.colWithGap(12),Z.l0.align.start],children:null==F?(0,r.BX)(r.HY,{children:[(0,r.tZ)(g.xv,{color:"dimmer",children:"You need to add a payment method to complete this purchase."}),(0,r.tZ)(T.zx,{iconLeft:(0,r.tZ)(A.Z,{}),text:"Add Payment Method",size:"big",onClick:b,colorway:"primary",stretch:!0})]}):(0,r.tZ)(r.HY,{children:(0,r.tZ)(y.G,{css:[Z.l0.colWithGap(16)],children:(0,r.BX)(y.G,{css:[Z.l0.colWithGap(4)],children:[(0,r.BX)(y.G,{css:[Z.l0.rowWithGap(8),Z.l0.align.center],children:[(0,r.tZ)(D.hU,{alt:"Update Payment Method",onClick:b,children:(0,r.tZ)(G.Z,{})}),(0,r.tZ)(m.R,{last4:F.last4})]}),(0,r.tZ)(y.G,{css:[Z.l0.pl(24),Z.l0.pr(16),Z.l0.colWithGap(8)],children:(0,r.tZ)(p.OK,(0,s._)((0,c._)({},ev),{loading:ev.loading||er,showSaveButton:!1}))})]})})})}),null!==F?(0,r.BX)(r.HY,{children:[(0,r.tZ)(R.R,{}),(0,r.tZ)(g.xv,{variant:"small",css:[Z.l0.color.foregroundDimmer],children:ey}),(0,r.tZ)(x.q,{isMakingPayment:!0,showSuccessState:ea,showProcessingState:er,disabled:!eT||ep,initialStateTextOverride:"Purchase ".concat(eg.cyclesToBePurchased.toLocaleString()," Cycles & Upgrade ").concat(V.name),processingStateTextOverride:eZ,size:"big",onClick:eE}),null!=ee?(0,r.tZ)(g.xv,{css:[Z.l0.color.accentNegativeDefault],children:ee}):null,(0,r.BX)(y.G,{css:[Z.l0.colWithGap(4)],children:[(0,r.tZ)(Y,{description:"Cycles balance after purchase",cycles:eg.cyclesToBePurchased}),(0,r.tZ)(Y,{description:"1st ".concat(V.orderDuration," of ").concat(V.name),cycles:-1*a.cyclesCostNow}),(0,r.tZ)(Y,{description:"Cycles balance after upgrade",cycles:eg.cyclesBalanceAfterUpgrade})]})]}):null]})}var Q=n(58995);function ee(){var e=(0,M._)(["\n  query CheckOutSuccess($replId: String!) {\n    currentUser {\n      id\n      cyclesAutoRefillConfiguration {\n        ... on CyclesAutoRefillConfiguration {\n          id\n          enabled\n          refillAmount\n          monthlyBudget\n        }\n        ... on UnauthorizedError {\n          message\n        }\n      }\n    }\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        owner {\n          ... on Team {\n            id\n          }\n          ... on User {\n            id\n          }\n        }\n      }\n    }\n  }\n"]);return ee=function(){return e},e}var et={},en=(0,X.Ps)(ee()),er=n(37951),ei=n(57122),eo=n(20573),ea=(0,I.X)({powerUpIconBackground:[Z.l0.width(32),Z.l0.height(32),Z.l0.borderRadius(8),Z.l0.justify.center,Z.l0.align.center,Z.l0.backgroundColor.blueDimmer],autoRefillIconBackground:[Z.l0.width(32),Z.l0.height(32),Z.l0.borderRadius(8),Z.l0.justify.center,Z.l0.align.center,Z.l0.backgroundColor.greyDimmer]});function el(e){var t,n,o,a,l,s,u,d=e.product,f=e.goToCardPreferences,p=e.goToPowerUpDetails,m=(0,h.Z)({forceFetch:!0}).cycles,v=(t={variables:{replId:d.replId}},n=(0,c._)({},et,t),Q.a(en,n)),b=v.data,x=v.loading,C=(null==b?void 0:null===(s=b.currentUser)||void 0===s?void 0:null===(l=s.cyclesAutoRefillConfiguration)||void 0===l?void 0:l.__typename)==="CyclesAutoRefillConfiguration"?b.currentUser.cyclesAutoRefillConfiguration:null,_=(null==b?void 0:b.repl.__typename)==="Repl"&&(null===(u=b.repl.owner)||void 0===u?void 0:u.__typename)==="Team",S=!!(null==C?void 0:C.enabled),E=i.S0[d.powerUpCategory],k=i.$[d.powerUpSku];return(0,r.BX)(y.G,{css:[Z.l0.colWithGap(16)],children:[(0,r.BX)(y.G,{css:[Z.l0.rowWithGap(8),Z.l0.justify.spaceBetween,Z.l0.align.center],children:[(0,r.BX)(y.G,{css:[Z.l0.rowWithGap(8),Z.l0.align.center],children:[(0,r.tZ)(y.G,{css:ea.powerUpIconBackground,children:(0,r.tZ)(E.iconComponent,{size:20})}),(0,r.BX)(y.G,{css:[Z.l0.flex.column],children:[(0,r.BX)(g.xv,{multiline:!1,children:[E.name," activated"]}),(0,r.BX)(y.G,{css:Z.l0.rowWithGap(8),children:[(0,r.tZ)(g.xv,{variant:"small",color:"dimmer",multiline:!1,children:k.provisionDescription}),_?null:(0,r.BX)(y.G,{css:[Z.l0.rowWithGap(4)],children:[(0,r.tZ)(w,{amount:O.z4[d.powerUpSku],includeUsd:!0,variant:"small",color:"dimmer"}),(0,r.BX)(g.xv,{variant:"small",color:"dimmer",multiline:!1,children:["/ ",E.orderDuration]})]})]})]})]}),(0,r.tZ)(g.xv,{multiline:!1,children:(0,r.tZ)("a",{role:"button",tabIndex:0,onKeyDown:function(){return p(d.powerUpCategory)},onClick:function(){return p(d.powerUpCategory)},css:[Z.l0.color.foregroundDimmer,{textDecoration:"underline"}],children:"Edit"})})]}),_||x?null:(0,r.BX)(y.G,{css:[Z.l0.rowWithGap(8),Z.l0.justify.spaceBetween,Z.l0.align.center],children:[(0,r.BX)(y.G,{css:[Z.l0.rowWithGap(8),Z.l0.align.center],children:[(0,r.tZ)(y.G,{css:ea.autoRefillIconBackground,children:(0,r.tZ)(ei.Z,{size:20})}),(0,r.BX)(y.G,{css:[Z.l0.flex.column],children:[(0,r.BX)(g.xv,{multiline:!1,children:["Auto-Refill is"," ",(a=(o={autoRefillEnabled:S,loadingAutoRefill:x}).autoRefillEnabled,o.loadingAutoRefill?"...":a?"on":"off")]}),(0,r.tZ)(y.G,{css:Z.l0.rowWithGap(4),children:null==m?(0,r.tZ)(B.Z,{}):(0,r.BX)(r.HY,{children:[(0,r.tZ)(w,{amount:m,includeUsd:!1,variant:"small",color:"dimmer"}),(0,r.tZ)(g.xv,{variant:"small",color:"dimmer",multiline:!1,children:"left"})]})})]})]}),(0,r.tZ)(g.xv,{multiline:!1,children:(0,r.tZ)("a",{role:"button",tabIndex:0,onKeyDown:function(){return f(d.powerUpCategory)},onClick:function(){return f(d.powerUpCategory)},css:[Z.l0.color.foregroundDimmer,{textDecoration:"underline"}],children:"Edit"})})]}),x||S||_?null:(0,r.tZ)(er.E,{colorway:"warning",icon:(0,r.tZ)(eo.Z,{}),text:"Add a payment method and enable Auto-Refill to prevent your ".concat(E.name," Power Up from being disabled when you run out of Cycles.")})]})}var ec=n(97764),es=n(40102),eu=n(32377),ed=n(40028),ef=n(15670),eh=n(66766),ep=n(43312),em=n(66932),ev=n(48272),eg=n(38080),ey={tier:(0,ep.iv)([Z.l0.borderRadius(12),Z.l0.colWithGap(12),Z.l0.p(12)]),tierHeader:(0,ep.iv)([Z.l0.rowWithGap(8),Z.l0.flex.grow(1),Z.l0.justify.spaceBetween,Z.l0.align.baseline]),tierHeaderTitle:(0,ep.iv)(Z.l0.rowWithGap(8)),tierHeaderCost:(0,ep.iv)([Z.l0.rowWithGap(4),Z.l0.align.baseline]),tierFeatures:(0,ep.iv)(Z.l0.colWithGap(8)),tierFeature:(0,ep.iv)(Z.l0.rowWithGap(4),Z.l0.align.center),tierPicker:(0,ep.iv)([Z.l0.border({color:Z.TV.outlineDefault})])},eb=function(e){var t=e.selectedOption,n=e.onChange,i=e.disabled,o=O.r4[t.sku].egress,a="INCLUDED_IN_SUBSCRIPTION"!==t.cost.explanation&&"NOT_SUPPORTED_FOR_TEAMS"!==t.cost.explanation;return(0,r.BX)(eg.Tg,{elevated:!0,css:ey.tier,children:[(0,r.BX)(y.G,{css:ey.tierHeader,children:[(0,r.tZ)(y.G,{css:ey.tierHeaderTitle,children:(0,r.tZ)(g.xv,{variant:"subheadBig",multiline:!1,children:"Reserved VM"})}),(0,r.tZ)(y.G,{css:Z.l0.rowWithGap(4),children:a?(0,r.BX)(y.G,{css:[Z.l0.rowWithGap(2),Z.l0.align.center],children:[(0,r.tZ)(b.Z,{}),(0,r.BX)(y.G,{css:[ey.tierHeaderCost],children:[(0,r.tZ)(g.xv,{variant:"subheadDefault",multiline:!1,children:t.cost.cyclesCostRecurring}),(0,r.tZ)(g.xv,{color:"dimmer",variant:"small",multiline:!1,children:"per day"})]})]}):null})]}),(0,r.tZ)(ev.P,{css:ey.tierPicker,initialSelectedItem:{title:(0,em.$)(t.sku),sku:t.sku},items:Object.keys(O.r4).map(function(e){return{title:(0,em.$)(e),sku:e}}),onChange:function(e){return n(e.sku)},disabled:i}),(0,r.tZ)(y.G,{css:ey.tierFeatures,children:["".concat(o," GiB egress"),"Deploy to any URL, cover page optional","Configurable machine","Always on"].map(function(e,t){return(0,r.BX)(y.G,{css:ey.tierFeature,children:[(0,r.tZ)(eu.Z,{}),(0,r.tZ)(g.xv,{multiline:!1,children:e})]},t)})})]})},eZ=n(50782),ew=n(30983),ex=n(97615),eC=n(73524),e_=n(43182),eS=n(55534),eE=n(12874),ek=n(58378),eT=function(e){var t,n,i=e.context,a=e.selectedOption,c=e.currentOption,s=e.onBuyMoreCycles,f=e.onPowerUpUpdated,h=e.onPowerUpRequested,m=(0,eZ.Z)(),v=(0,eS.Z)().showError,g=(0,u._)((0,U.useState)(!1),2),y=g[0],b=g[1],w=(0,p.kr)({}).autoRefillEnabled,x=(0,u._)((0,ek.IN)({onCompleted:(t=(0,l._)(function(e){var t;return(0,d.Jh)(this,function(n){switch(n.label){case 0:if("UserError"===(t=e.setHostingTier).__typename)return v(t.message),[2];return b(!0),[4,new Promise(function(e){return setTimeout(e,2e3)})];case 1:return n.sent(),f({type:"powerUp",powerUpCategory:"hosting_tier",powerUpSku:a.sku,cyclesCostNow:a.cost.cyclesCostNow,replId:m}),[2]}})}),function(e){return t.apply(this,arguments)}),onError:function(e){h(!1),e_.Tb(e),v(e.message)}}),2),_=x[0],S=x[1].loading;if(y)return(0,r.tZ)(T.zx,{text:"Tier Purchased",colorway:"positive",loading:!0,css:{color:"".concat(Z.TV.accentPositiveStronger," !important")}});var E=(null==c?void 0:c.sku)===a.sku,k=!0;switch(a.cost.explanation){case C.Ch.IncludedInExistingOrder:case C.Ch.ActivateExistingOrder:case C.Ch.SpendCycles:case C.Ch.NeedsCycles:case C.Ch.IncludedInSubscription:k=!1}return S?(k=!0,n="Processing"):E?(k=!0,n="Current tier"):n="INCLUDED_IN_SUBSCRIPTION"===a.cost.explanation?"Activate and deploy":"NOT_SUPPORTED_FOR_TEAMS"===a.cost.explanation?"Not available for teams":"Purchase and deploy",(0,r.tZ)(T.zx,{text:n,disabled:k,loading:S,colorway:S||!k?"primary":void 0,iconRight:S?void 0:(0,r.tZ)(eE.Z,{}),onClick:function(){var e;if(h(!0),!S){if(a.cost.explanation===C.Ch.NeedsCycles){s({type:"powerUp",powerUpCategory:"hosting_tier",powerUpSku:a.sku,cyclesCostNow:a.cost.cyclesCostNow,replId:m});return}_({variables:{input:{replId:m,sku:a.sku}}}),null!==(e=a.cost.cyclesCostNow)&&void 0!==e&&e&&((0,o.j)(o.U3.CHECKOUT_REQUESTED,{source:i,powerUpCategory:"boost"}),(0,o.j)(o.U3.CYCLES_USED,{powerUp:"hosting_tier",sku:a.sku,source:i}),(0,o.j)(o.U3.CHECKOUT_COMPLETED,{source:i,powerUpCategory:"boost",autoRefill:w}))}},css:S&&{color:"".concat(Z.TV.accentPrimaryStronger," !important")}})},eR=function(e){var t=e.context,n=e.onBuyMoreCycles,i=e.onPowerUpUpdated,o=(0,eZ.Z)(),a=(0,u._)((0,U.useState)("ready"),2),l=a[0],c=a[1],s=(0,u._)((0,U.useState)(null),2),d=s[0],f=s[1],h=(0,u._)((0,U.useState)(null),2),p=h[0],m=h[1],b=(0,u._)((0,U.useState)(null),2),w=b[0],x=b[1];if((0,ek.s7)({fetchPolicy:"network-only",ssr:!1,variables:{replId:o},onCompleted:function(e){if((null==e?void 0:e.repl.__typename)==="Repl"&&(null===(n=e.repl)||void 0===n?void 0:null===(t=n.powerUps)||void 0===t?void 0:t.__typename)==="ReplPowerUpTypes"&&(null===(i=e.repl)||void 0===i?void 0:null===(r=i.powerUpCosts)||void 0===r?void 0:r.__typename)==="PowerUpCostsType"){var t,n,r,i,o,a,l=null===(o=e.repl.powerUps.hostingTier)||void 0===o?void 0:o.sku,c=l||((null===(a=e.repl.owner)||void 0===a?void 0:a.__typename)==="Team"?C.DZ.HostingTierE2Micro:C.DZ.HostingTierE2Small),s=(0,em.i)(e.repl.powerUpCosts,l),u=(0,em.i)(e.repl.powerUpCosts,c);s&&l&&m({sku:l,cost:s}),u&&f({sku:c,cost:u}),x(e.repl.powerUpCosts)}}}).loading||!d||!w)return(0,r.tZ)(y.G,{css:[Z.l0.flex.row,Z.l0.justify.center],children:(0,r.tZ)(B.Z,{})});var _=null;if("INCLUDED_IN_SUBSCRIPTION"===d.cost.explanation)_="Included in your subscription plan.";else if(d.cost.cyclesCostRecurring>0){var S=(0,v.$E)(d.cost.cyclesCostRecurring),E=(0,v.$E)(d.cost.cyclesCostRecurring*eC.Dj);_="".concat(S,"/day (Approximately ").concat(E,"/month).")}var k=null;switch(d.cost.explanation){case C.Ch.IncludedInExistingOrder:break;case C.Ch.NeedsCycles:k="You'll be able to purchase Cycles while activating.";break;case C.Ch.SpendCycles:k="Today's charge will be ".concat(d.cost.cyclesCostNow," Cycles.")}return(0,r.BX)(y.G,{css:Z.l0.colWithGap(16),children:[(0,r.tZ)(eb,{selectedOption:d,onChange:function(e){var t=(0,em.i)(w,e);t&&f({sku:e,cost:t})},disabled:"requesting"===l}),(0,r.tZ)(y.G,{css:[Z.l0.colWithGap(12)],children:(0,r.BX)(y.G,{css:[Z.l0.colWithGap(8)],children:[(0,r.BX)(y.G,{css:[Z.l0.minHeight(50),Z.l0.colWithGap(16),Z.l0.justify.end,Z.l0.mb(16)],children:[null!=_?(0,r.tZ)(g.xv,{css:[Z.l0.textAlign.center],multiline:!1,children:_}):null,null!=k?(0,r.BX)(y.G,{css:[Z.l0.rowWithGap(8),Z.l0.justify.center,Z.l0.color.foregroundDimmer],children:[(0,r.tZ)(g.xv,{multiline:!1,children:k}),(0,r.tZ)(ew.u,{tooltip:"Upgrades and downgrades are immediate. Upgrading within a 24 hour period following a downgrade will incur a charge.",children:(0,r.tZ)(ex.Z,{})})]}):null]}),(0,r.tZ)(eT,{context:t,selectedOption:d,currentOption:p,onBuyMoreCycles:n,onPowerUpUpdated:i,onPowerUpRequested:function(e){return c(e?"requesting":"ready")}})]})})]})},eD=n(47957),eI=n(56337),eG=n(70002);n(49344),n(31850);var eB=n(28079),eA=n(8279),eP=n(5542),eN=n(89106),eU=n(30845),eO=n(25491),eL=n(16166),eM=n(67795),eX=(0,I.X)({self:[Z.l0.flex.column],content:[Z.l0.pt(16),Z.l0.px(12),Z.l0.pb(12),Z.l0.colWithGap(16)],contentSlim:[Z.l0.colWithGap(8)],header:[Z.l0.p(12),Z.l0.rowWithGap(8),Z.l0.justify.start,Z.l0.align.center,Z.l0.border({color:Z.TV.outlineDefault,width:1,style:"solid",direction:"bottom"})],actions:[Z.l0.colWithGap(8)],footer:[Z.l0.rowWithGap(16),Z.l0.justify.spaceBetween,Z.l0.align.center,Z.l0.pt(4)],loadingWrapper:[Z.l0.center],storageBarWrapper:[Z.l0.colWithGap(8)],summaryWrapper:[Z.l0.colWithGap(8),Z.l0.align.start],totalSummaryDot:[Z.l0.backgroundColor.backgroundHigher,Z.l0.width(8),Z.l0.height(8),{borderRadius:"50%"}],replSummaryDot:[Z.l0.backgroundColor.accentPrimaryDefault,Z.l0.width(8),Z.l0.height(8),{borderRadius:"50%"}],summaryRow:[Z.l0.rowWithGap(8),Z.l0.justify.start,Z.l0.align.center,Z.l0.fontSize(14),Z.l0.height(14)],replSummaryText:[Z.l0.color.accentPrimaryStronger],replSummaryUsage:[Z.l0.color.accentPrimaryStrongest],replUsagePlaceholder:[eA.p.backgroundPulse(Z.TV.backgroundHigher,Z.TV.backgroundRoot),{opacity:.5},Z.l0.borderRadius(4),Z.l0.height("100%"),Z.l0.width(64)],totalUsagePlaceholder:[eA.p.backgroundPulse(Z.TV.backgroundHigher,Z.TV.backgroundRoot),{opacity:.5},Z.l0.borderRadius(4),Z.l0.height("100%"),Z.l0.width(140)],availablePlaceholder:[eA.p.backgroundPulse(Z.TV.backgroundHigher,Z.TV.backgroundRoot),{opacity:.5},Z.l0.borderRadius(4),Z.l0.height("100%"),Z.l0.width(64)],availableText:[Z.l0.color.foregroundDimmest]}),eF=function(e){var t,n=e.isInDesktopApp,i=e.loading,a=e.data,l=e.setShowUpgradeModal,u=e.slim;if((0,U.useEffect)(function(){var e;if(a&&(null===(e=a.currentUser)||void 0===e?void 0:e.__typename)==="CurrentUser"&&"StorageQuota"===a.currentUser.storageInfo.storageQuota.__typename&&"AccountStorageUtilization"===a.currentUser.storageInfo.accountStorageUtilization.__typename&&!i)try{var t=parseInt(a.currentUser.storageInfo.storageQuota.quota,10),n=parseInt(a.currentUser.storageInfo.accountStorageUtilization.total,10);(0,o.j)(eM.U3.MODAL_VIEWED,{modalName:"workspace_storage_modal",storageQuota:t,storageUtilization:n,storageUtilizationPercentage:n/t})}catch(e){}},[a,i]),i&&!a)return(0,r.BX)(y.G,{css:u?eX.contentSlim:eX.content,children:[(0,r.tZ)(eU.M,{}),(0,r.tZ)(y.G,{css:eX.footer,children:n?(0,r.tZ)(T.zx,{onClick:function(){eN.X.openExternalUrl(eB.$I.as)},text:"Manage Repls"}):(0,r.tZ)(eG.Z,{href:eB.$I.href,as:eB.$I.as,text:"Manage Repls"})})]});if(a&&(null===(t=a.currentUser)||void 0===t?void 0:t.__typename)==="CurrentUser"&&"StorageQuota"===a.currentUser.storageInfo.storageQuota.__typename&&"AccountStorageUtilization"===a.currentUser.storageInfo.accountStorageUtilization.__typename){var d=a.currentUser.username,f=a.currentUser.userSubscriptionType===C.HP.HackerPro;return(0,r.BX)(y.G,{css:u?eX.contentSlim:eX.content,children:[a?(0,r.tZ)(eU.l,{data:a}):(0,r.tZ)(eU.M,{}),(0,r.BX)(y.G,{css:eX.footer,children:[(0,r.tZ)(eG.Z,(0,s._)((0,c._)({},(0,eP.Ru)(d)),{text:"Manage Repls"})),(0,r.tZ)(eL.U,{isPro:f,setShowUpgradeModal:l,source:"workspace_storage_modal_upgrade_button"})]})]})}return(0,r.BX)(y.G,{css:u?eX.contentSlim:eX.content,children:[(0,r.tZ)(g.xv,{color:"dimmest",multiline:!1,children:"We had trouble loading your storage information. Please try again later."}),(0,r.tZ)(y.G,{css:eX.footer,children:(0,r.tZ)(eG.Z,{href:eB.$I.href,as:eB.$I.as,text:"Manage Repls"})})]})},eW=(0,I.X)({self:[Z.l0.flex.column]}),eH=function(){var e=(0,eI.Z)(),t=(0,u._)((0,U.useState)(!1),2),n=t[0],i=t[1],o=(0,eD.Pf)({fetchPolicy:"network-only",ssr:!1,notifyOnNetworkStatusChange:!0}),a=o.data,l=o.loading,c=o.refetch;return(0,r.BX)(r.HY,{children:[(0,r.tZ)(y.G,{css:eW.self,children:(0,r.tZ)(eF,{loading:l,isInDesktopApp:e,data:a,setShowUpgradeModal:i,slim:!0})}),(0,r.tZ)(eO.Z,{isOpen:n,context:"workspace_info_modal",powerUp:"storage",uponPurchaseGoTo:"workspace",onRequestClose:function(){c(),i(!1)}})]})},eV=n(47648),ez=n(92611),ej="workspace_info_modal";function eq(e){var t=e.powerUpCategory,n=e.goToCheckout,i=e.goToCheckoutSuccess,o=e.onRequestPowerUp,a=(0,u._)((0,U.useState)(null),2),l=a[0],c=a[1];switch(t){case"boost":return(0,r.tZ)(eh.Z,{isCheckoutFlow:!0,powerUp:t,onPowerUpUpdated:i,onBuyMoreCycles:n,context:ej});case"hosting_tier":return(0,r.tZ)(eR,{context:"workspace_hosting_pane",onPowerUpUpdated:i,onBuyMoreCycles:n});case"storage":return(0,r.tZ)(eH,{});case"always-on":return(0,r.BX)(r.HY,{children:[(0,r.tZ)(eV.Z,{initialTab:"default",isOpen:l===ez.x.BuyCycles,onRequestClose:function(){return c(null)},uponPurchaseGoTo:"workspace",context:ej,allowCyclesPage:!1}),(0,r.tZ)(ef.Z,{onRequestBuyMore:function(){return c(ez.x.BuyCycles)},powerUp:"always-on",context:ej,onRequestPowerUp:o})]});case"gpu":return(0,r.BX)(r.HY,{children:[(0,r.tZ)(eV.Z,{initialTab:"default",isOpen:l===ez.x.BuyCycles,onRequestClose:function(){return c(null)},uponPurchaseGoTo:"workspace",context:ej,allowCyclesPage:!1}),(0,r.tZ)(ef.Z,{onRequestBuyMore:function(){return c(ez.x.BuyCycles)},powerUp:"gpu",context:ej,onRequestPowerUp:o})]});default:throw Error("Unknown power up category: ".concat(t))}}function eY(e){var t=e.title,n=e.children,i=e.goBack,o=e.canGoBack,a=e.allowBack;return(0,r.BX)(r.HY,{children:[(0,r.BX)(y.G,{css:[Z.l0.rowWithGap(8),Z.l0.p(8),Z.l0.align.center],children:[(void 0===a||a)&&o?(0,r.tZ)(D.hU,{alt:"Back",tooltipHidden:!0,onClick:function(){return i()},dataCy:"purchase-flow-back-button",children:(0,r.tZ)(es.Z,{})}):null,"string"==typeof t?(0,r.tZ)(g.xv,{variant:"subheadDefault",multiline:!1,children:t}):t]}),(0,r.tZ)(y.G,{css:[Z.l0.colWithGap(8),Z.l0.p(8)],children:n})]})}function e$(e){var t=e.currentStep,n=e.goBack,l=e.canGoBack,c=e.goTo,s=e.analyticsContext,u=e.onRequestPowerUp;switch(t.step){case"power_up_details":var d=t.powerUpCategory,f=i.S0[d];return(0,r.tZ)(eY,{goBack:n,canGoBack:l,title:f.name,children:(0,r.tZ)(eq,{powerUpCategory:d,goToCheckout:function(e){c({step:"checkout",product:e}),(0,o.j)(o.U3.CHECKOUT_REQUESTED,{source:s,powerUpCategory:d})},goToCheckoutSuccess:function(e){c({step:"checkout_success",product:e})},onRequestPowerUp:u})});case"checkout":return(0,r.tZ)(eY,{goBack:n,canGoBack:l,title:"Checkout",children:(0,r.tZ)(K,{product:t.product,goToCheckoutSuccess:function(e){c({step:"checkout_success",product:e})},goToNewPaymentMethodForm:function(){return c({step:"new_payment_method_form"})},context:s})});case"checkout_success":return(0,r.tZ)(eY,{goBack:n,canGoBack:l,allowBack:!1,title:(0,r.BX)(y.G,{css:[Z.l0.rowWithGap(8),Z.l0.align.center],children:[l?(0,r.tZ)(D.hU,{tooltipHidden:!0,alt:"Back",onClick:function(){return n()},children:(0,r.tZ)(es.Z,{})}):null,(0,r.tZ)(g.xv,{multiline:!1,css:[Z.l0.color.accentPositiveStronger],children:"Success"}),(0,r.tZ)(eu.Z,{color:Z.TV.accentPositiveStronger})]}),children:(0,r.tZ)(el,{product:t.product,goToCardPreferences:function(e){return c({step:"card_preferences",powerUpCategory:e})},goToPowerUpDetails:function(e){return c({step:"power_up_details",powerUpCategory:e})}})});case"card_preferences":var h=t.powerUpCategory;return(0,r.tZ)(eY,{goBack:n,canGoBack:l,title:"Card Preferences",children:(0,r.tZ)(a.t,{goToNewPaymentMethodForm:function(){return c({step:"new_payment_method_form",powerUpCategory:h})}})});case"new_payment_method_form":var p=t.powerUpCategory;return(0,r.tZ)(eY,{goBack:n,canGoBack:l,title:"Update Payment Method",children:(0,r.tZ)(ec.q,{onSuccess:function(){return l&&n()},powerUpCategory:p,context:s})});case"not_shown":throw Error("This step should never be rendered");default:(0,ed.Z)(t)}}},56353:function(e,t,n){n.d(t,{FW:function(){return h},NH:function(){return v}});var r=n(41733),i=n(21262),o=n(71440),a=n(80428),l=n(41538),c=n(58995);function s(){var e=(0,i._)(["\n  fragment PublishReplData on Repl {\n    id\n    url\n    title\n    description\n    iconUrl\n    lastPublishedAt\n    publishedAs\n    imageUrl\n    isRenamed\n    templateInfo {\n      iconUrl\n    }\n    replViewSettings {\n      id\n      defaultView\n      replImage\n      replFile\n    }\n    tags {\n      id\n      isOfficial\n    }\n    currentUserPermissions {\n      containerWrite\n      publish\n      changeIconUrl\n    }\n    ...CrosisContextRepl\n    ...PublishedReplShareInfoReplData\n  }\n  ","\n  ","\n"]);return s=function(){return e},e}function u(){var e=(0,i._)(["\n  fragment PublishCurrentUser on CurrentUser {\n    id\n    image\n    isTemplateDeveloper: hasRole(role: TEMPLATE_DEVELOPER)\n    ...CrosisContextCurrentUser\n  }\n  ","\n"]);return u=function(){return e},e}function d(){var e=(0,i._)(["\n  query PublishCurrentUser {\n    currentUser {\n      id\n      ...PublishCurrentUser\n    }\n  }\n  ","\n"]);return d=function(){return e},e}var f={},h=(0,o.Ps)(s(),a.C,l.B),p=(0,o.Ps)(u(),a.D),m=(0,o.Ps)(d(),p);function v(e){var t=(0,r._)({},f,e);return c.a(m,t)}},63204:function(e,t,n){n.d(t,{e9:function(){return h},wd:function(){return d}});var r=n(41733),i=n(21262),o=n(71440),a=n(41538),l=n(58995);function c(){var e=(0,i._)(["\n  fragment PublishReleaseFormRepl on Repl {\n    id\n    title\n    description\n    slug\n    user {\n      username\n    }\n    ...PublishedReplShareInfoReplData\n    deployment {\n      id\n      activeRelease {\n        id\n      }\n    }\n    releases {\n      items {\n        id\n        timeCreated\n        description\n      }\n    }\n  }\n  ","\n"]);return c=function(){return e},e}function s(){var e=(0,i._)(["\n  query PublishReleaseFormCurrentUser {\n    currentUser {\n      id\n      username\n    }\n  }\n"]);return s=function(){return e},e}var u={},d=(0,o.Ps)(c(),a.B),f=(0,o.Ps)(s());function h(e){var t=(0,r._)({},u,e);return l.a(f,t)}},41538:function(e,t,n){n.d(t,{B:function(){return o}});var r=n(21262);function i(){var e=(0,r._)(["\n  fragment PublishedReplShareInfoReplData on Repl {\n    id\n    url\n    publishedAs\n    title\n  }\n"]);return i=function(){return e},e}var o=(0,n(71440).Ps)(i())},25061:function(e,t,n){n.d(t,{Z:function(){return k}});var r=n(27387),i=n(96583),o=n(74985),a=n(75246),l=n(74833),c=n(56596),s=n(93918),u=n(29287);n(50959);var d=(0,s.X)({styles0:[u.l0.colWithGap(8)],styles1:[u.l0.colWithGap(8)],styles2:[u.l0.colWithGap(8)]}),f=(0,s.X)({content:[u.l0.p(8),u.l0.colWithGap(16)],section:[u.l0.colWithGap(8)]});function h(e){var t=e.header;return(0,o.tZ)(a.Q,{headerContent:t,children:(0,o.BX)(c.G,{css:f.content,children:[(0,o.BX)(c.G,{css:f.section,children:[(0,o.tZ)(l.xv,{multiline:!1,children:"Bold Text"}),(0,o.tZ)(l.xv,{color:"dimmer",multiline:!1,children:"**bold**"})]}),(0,o.BX)(c.G,{css:f.section,children:[(0,o.tZ)(l.xv,{multiline:!1,children:"Italic Text"}),(0,o.tZ)(l.xv,{color:"dimmer",multiline:!1,children:"__italic__"})]}),(0,o.BX)(c.G,{css:f.section,children:[(0,o.tZ)(l.xv,{multiline:!1,children:"Links"}),(0,o.tZ)(l.xv,{color:"dimmer",multiline:!1,children:"[Link Name](https://yourlink.com)"})]}),(0,o.BX)(c.G,{css:f.section,children:[(0,o.tZ)(l.xv,{multiline:!1,children:"Images"}),(0,o.tZ)(l.xv,{color:"dimmer",multiline:!1,children:"![Image alt text](https://linktoyourimage.com)"})]}),(0,o.BX)(c.G,{css:f.section,children:[(0,o.tZ)(l.xv,{multiline:!1,children:"Header Text"}),(0,o.tZ)(l.xv,{color:"dimmer",multiline:!1,children:"# Header"})]}),(0,o.BX)(c.G,{css:d.styles0,children:[(0,o.tZ)(l.xv,{multiline:!1,children:"Code Blocks"}),(0,o.BX)(l.xv,{color:"dimmer",multiline:!1,children:["```",(0,o.tZ)("br",{}),"this is for large, multiline code blocks",(0,o.tZ)("br",{}),"```"]})]}),(0,o.BX)(c.G,{css:d.styles1,children:[(0,o.tZ)(l.xv,{multiline:!1,children:"Inline Code"}),(0,o.tZ)(l.xv,{color:"dimmer",multiline:!1,children:"`this is for code in the middle of sentences`"})]}),(0,o.BX)(c.G,{css:d.styles2,children:[(0,o.tZ)(l.xv,{multiline:!1,children:"Horizontal Rules"}),(0,o.tZ)(l.xv,{color:"dimmer",multiline:!1,children:"***"})]})]})})}var p=n(72310),m=n(59868),v=n(1498),g=n(18836),y=n(37951),b=n(74883),Z=n(20573),w=n(10981),x=n(75582),C=n(69273),_=c.K.form;function S(e){return 0===e.trim().length?{message:"You cannot leave this empty."}:e.length>100?{message:"The title should not be longer than ".concat(100," characters.")}:void 0}function E(e){return 0===e.trim().length?{message:"You cannot leave this empty."}:e.length>5e3?{message:"The description should not be longer than ".concat(5e3," characters.")}:void 0}function k(e){var t,n,a,s=e.repl,d=e.source,f=e.onDone,k=(0,w.U)(),T=k("titleIdInput"),R=k("descriptionIdInput"),D=(0,p.Y)("",S),I=(0,p.Y)("",E),G=(0,C.O)();return(0,o.BX)(_,{onSubmit:(t=(0,r._)(function(e){return(0,i.Jh)(this,function(t){switch(t.label){case 0:if(e.preventDefault(),D.validate()||I.validate())return[2];return[4,G.publish({input:{replId:s.id,title:D.value,body:I.value}})];case 1:return t.sent().error||((0,m.j)(m.U3.UPDATE_SHARED,{source:d,replType:s.publishedAs===x.O2.Template?"template_repl":"regular_repl"}),f()),[2]}})}),function(e){return t.apply(this,arguments)}),css:[u.l0.colWithGap(16)],children:[(0,o.tZ)(l.h4,{level:1,variant:"headerDefault",children:"Add an update"}),(0,o.BX)(l.xv,{multiline:!1,children:["Explain what has changed about this"," ",s.publishedAs===x.O2.Template?"Template":"Repl","."]}),(0,o.BX)(c.G,{css:u.l0.colWithGap(8),children:[(0,o.BX)(c.G,{css:u.l0.colWithGap(4),children:[(0,o.tZ)("label",{css:u.l0.color.foregroundDimmer,htmlFor:T,children:"Title"}),(0,o.tZ)(g.II,{id:T,onChange:function(e){D.setValue(e.target.value)},disabled:G.loading,placeholder:"Give your post a title"})]}),D.error?(0,o.tZ)(y.E,{icon:(0,o.tZ)(Z.Z,{}),text:null===(n=D.error)||void 0===n?void 0:n.message,colorway:"negative"}):null]}),(0,o.BX)(c.G,{css:u.l0.colWithGap(8),children:[(0,o.BX)(c.G,{css:u.l0.colWithGap(4),children:[(0,o.tZ)("label",{css:u.l0.color.foregroundDimmer,htmlFor:R,children:"Description"}),(0,o.tZ)(g.B,{id:R,onChange:function(e){I.setValue(e.target.value)},css:[u.l0.width("100%"),{minHeight:u.TV.space128,maxHeight:u.TV.space256,resize:"vertical",lineHeight:u.TV.lineHeightDefault}],disabled:G.loading,placeholder:"Write something about this post"})]}),I.error?(0,o.tZ)(y.E,{icon:(0,o.tZ)(Z.Z,{}),text:null===(a=I.error)||void 0===a?void 0:a.message,colorway:"negative"}):null]}),(0,o.tZ)(h,{header:"Style your description with Markdown"}),G.error?(0,o.tZ)(y.E,{icon:(0,o.tZ)(Z.Z,{}),colorway:"negative",text:G.error}):null,(0,o.tZ)(v.zx,{text:G.loading?"Sharing update...":"Share update",type:"submit",colorway:"primary",disabled:!!(G.loading||D.error||I.error),css:{alignSelf:"end"},iconLeft:(0,o.tZ)(b.Z,{})})]})}},69273:function(e,t,n){n.d(t,{O:function(){return m}});var r=n(27387),i=n(66626),o=n(96583),a=n(41733),l=n(21262),c=n(71440),s=n(56353),u=n(99165);function d(){var e=(0,l._)(["\n  mutation PublishReplCreatePost($input: CreateReplPost2Input!) {\n    createReplPost2(input: $input) {\n      ... on Post {\n        id\n        repl {\n          id\n          ...PublishReplData\n        }\n      }\n      ... on UserError {\n        message\n      }\n      ... on NotFoundError {\n        message\n      }\n      ... on UnauthorizedError {\n        message\n      }\n    }\n  }\n  ","\n"]);return d=function(){return e},e}var f={},h=(0,c.Ps)(d(),s.FW);function p(e){var t,n,r,i,o,a,l;return e.error?e.error.message||"Something went wrong publishing your Repl":(null===(n=e.data)||void 0===n?void 0:null===(t=n.createReplPost2)||void 0===t?void 0:t.__typename)==="NotFoundError"||(null===(i=e.data)||void 0===i?void 0:null===(r=i.createReplPost2)||void 0===r?void 0:r.__typename)==="UnauthorizedError"||(null===(a=e.data)||void 0===a?void 0:null===(o=a.createReplPost2)||void 0===o?void 0:o.__typename)==="UserError"?e.data.createReplPost2.message:(null===(l=e.data)||void 0===l?void 0:l.createReplPost2)&&"Post"!==e.data.createReplPost2.__typename?"Something went wrong publishing your Repl":void 0}function m(){var e,t,n=(0,i._)((e=(0,a._)({},f,void 0),u.D(h,e)),2),l=n[0],c=n[1];return{publish:(t=(0,r._)(function(e){var t,n;return(0,o.Jh)(this,function(r){switch(r.label){case 0:if(t=e.input,c.loading)return[2,{data:null,error:null}];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,l({variables:{input:t}})];case 2:return[2,{data:(n=r.sent()).data,error:p(n)}];case 3:return r.sent(),[2,{data:null,error:"Something went wrong publishing your Repl"}];case 4:return[2]}})}),function(e){return t.apply(this,arguments)}),data:c.data,loading:c.loading,error:p(c)}}},30609:function(e,t,n){n.d(t,{Z:function(){return d},_:function(){return p}});var r=n(66626),i=n(74985),o=n(79217),a=n(29287),l=n(50831),c=n(9617),s=n(35972),u=n(50959);function d(e){var t=(0,r._)((0,u.useState)(!1),2),n=t[0],o=t[1],a=[],d=[];if(e.variables.length>0){var f=e.variables[0].parentVariableReference,h=!0,m=!1,v=void 0;try{for(var g,y=e.variables[Symbol.iterator]();!(h=(g=y.next()).done);h=!0){var b=g.value;b.parentVariableReference===f?a.push(b):d.push(b)}}catch(e){m=!0,v=e}finally{try{h||null==y.return||y.return()}finally{if(m)throw v}}}return(0,i.BX)(i.HY,{children:[(0,i.tZ)(c.Z,{truncate:!0,level:5,children:"Variables"}),(0,i.BX)(s.gC,{align:"stretch",constrainWidth:!0,children:[a.map(function(t){return(0,i.tZ)(p,{depth:0,variable:t,client:e.client},t.parentVariableReference+"/"+t.name)}),d.length>0&&(0,i.BX)(i.HY,{children:[(0,i.BX)(l.Z,{filled:!1,border:!1,onClick:function(){return o(function(e){return!e})},children:["See ",n?"Less":"More"]}),n&&d.map(function(t){return(0,i.tZ)(p,{depth:0,variable:t,client:e.client},t.parentVariableReference+"/"+t.name)})]})]})]})}function f(e){var t=e.variable,n=e.expanded;return t.variablesReference>0?(0,i.tZ)("div",{css:[a.l0.transition.snappy,{transform:"rotate(".concat(n?0:-90,"deg)")}],children:(0,i.tZ)(o.Z,{})}):null}function h(e){var t=e.expanded,n=e.depth,r=e.variable;return 0!==n||"parentVariableReference"in r?(0,i.tZ)("div",{css:[a.l0.flex.grow(0),a.l0.flex.shrink(0),a.l0.width(a.TV.space16),a.l0.display.flex,a.l0.align.center,a.l0.justify.end],children:(0,i.tZ)(f,{expanded:t,variable:r})}):(0,i.tZ)(f,{expanded:t,variable:r})}function p(e){var t=e.depth,n=e.variable,o=e.client,a=(0,r._)((0,u.useState)(!1),2),l=a[0],c=a[1],d=(0,r._)((0,u.useState)([]),2),f=d[0],m=d[1];return(0,u.useEffect)(function(){l&&o.fetchVariables(n.variablesReference).then(function(e){return m(e)},function(){return c(!1)})},[l,o,n.variablesReference]),(0,i.BX)(i.HY,{children:[(0,i.BX)("div",{className:"variable",onClick:function(){n.variablesReference>0&&c(function(e){return!e})},css:{"&":{display:"flex",alignItems:"center",maxWidth:"100%",height:"var(--space-32)",minHeight:"var(--space-32)",cursor:"pointer",color:"var(--foreground-dimmer)",borderRadius:"var(--border-radius-4)",fontSize:"var(--font-size-default)",paddingLeft:"calc(".concat(t," * var(--space-16))"),fontFamily:"var(--font-family-code)"},"&:hover":{backgroundColor:"var(--background-higher)",color:"var(--foreground-default)"},".label":{fontSize:"var(--font-size-default)",paddingLeft:"var(--space-8)",paddingRight:"var(--space-8)",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",flex:"1 0 auto"},".type":{opacity:"0.5"},".value":{textAlign:"right",flexShrink:1}},children:[(0,i.tZ)(h,{expanded:l,variable:n,depth:t}),(0,i.BX)("div",{className:"label",children:[n.name,n.type?(0,i.BX)("span",{className:"type",children:[" ",n.type]}):null,""!==n.value&&": "]}),(0,i.tZ)("div",{className:"label value",children:(0,i.tZ)("pre",{children:n.value})})]}),l?(0,i.tZ)(s.gC,{align:"stretch",constrainWidth:!0,children:f.map(function(e){return(0,i.tZ)(p,{depth:t+1,variable:e,client:o},"parentVariableReference"in e?e.parentVariableReference+"/"+e.name:e.name)})}):null]})}},5693:function(e,t,n){n.d(t,{Z:function(){return x}});var r=n(66626),i=n(74985),o=n(55534),a=n(59868),l=n(1498),c=n(74833),s=n(56596),u=n(98859),d=n(29287),f=n(75582),h=n(41733),p=n(21262),m=n(71440),v=n(73931),g=n(99165);function y(){var e=(0,p._)(["\n  mutation UnpublishReplUnpublish($input: UnpublishReplFromCommunityInput!) {\n    unpublishReplFromCommunity(input: $input) {\n      ... on Repl {\n        id\n        ...ReplViewReplActionsPermissions\n      }\n      ... on UnauthorizedError {\n        message\n      }\n      ... on NotFoundError {\n        message\n      }\n    }\n  }\n  ","\n"]);return y=function(){return e},e}var b={},Z=(0,m.Ps)(y(),v.jN),w=s.K.form;function x(e){var t,n,p=e.repl,m=e.source,v=e.onDone,y=(0,o.Z)(),x=y.showConfirm,C=y.showError,_=(0,r._)((t={variables:{input:{replId:p.id}},onCompleted:function(e){if("Repl"===e.unpublishReplFromCommunity.__typename){var t=e.unpublishReplFromCommunity,n=t.runCount,r=t.likeCount,i=t.commentCount;(0,a.j)(a.U3.REPL_UNPUBLISHED,{source:m,numRuns:n,numLikes:r,numComments:i,replType:p.publishedAs===f.O2.Template?"template_repl":"regular_repl"}),x("Repl removed from the community.")}else"NotFoundError"===e.unpublishReplFromCommunity.__typename||"UnauthorizedError"===e.unpublishReplFromCommunity.__typename?C(e.unpublishReplFromCommunity.message):C("An unexpected error occurred.");v()},onError:function(){C("Something went wrong. Please try again.")},update:function(e){e.modify({id:e.identify({__typename:"Repl",id:p.id}),fields:{comments:function(e,t){return t.DELETE},tags:function(e,t){return t.DELETE}}})}},n=(0,h._)({},b,t),g.D(Z,n)),2),S=_[0],E=_[1].loading;return(0,i.BX)(s.G,{css:[d.l0.colWithGap(24)],children:[(0,i.tZ)(c.xv,{variant:"subheadBig",children:"Unpublish this Repl from the Community"}),(0,i.BX)(w,{onSubmit:function(e){e.preventDefault(),S()},css:[d.l0.colWithGap(32)],children:[(0,i.tZ)(c.xv,{children:"Unpublishing a Repl will remove it from the Community. This action will delete all associated posts and tags. The Repl and all its comments will still be visible in your profile, but will not be shown in the Community or Trending views anymore. You can always re-publish the Repl again later."}),(0,i.BX)(s.G,{css:[d.l0.rowWithGap(8),d.l0.justify.end],children:[(0,i.tZ)(s.G,{children:(0,i.tZ)(l.zx,{type:"button",text:"Cancel",onClick:function(){return v()}})}),(0,i.tZ)(s.G,{children:(0,i.tZ)(l.zx,{disabled:E,colorway:"negative",text:E?"Unpublishing...":"Yes, unpublish this Repl",type:"submit",iconLeft:(0,i.tZ)(u.Z,{})})})]})]})]})}},51780:function(e,t,n){n.d(t,{d:function(){return l}});var r=n(21262),i=n(71440),o=n(20708);function a(){var e=(0,r._)(["\n  fragment BulkDeleteConfirmationModalRepl on Repl {\n    id\n    iconUrl\n    title\n    hostingDeployment {\n      ... on HostingDeployment {\n        id\n        replitAppSubdomain\n        ...BuildStatusBadgeHostingDeployment\n      }\n    }\n  }\n  ","\n"]);return a=function(){return e},e}var l=(0,i.Ps)(a(),o.u)},15053:function(e,t,n){var r=n(66626),i=n(74985),o=n(84096),a=n(73157),l=n(2161),c=n(1498),s=n(18836),u=n(49344),d=n(37951),f=n(74833),h=n(56596),p=n(93918),m=n(52682),v=n(20573),g=n(29287),y=n(50959),b=(0,p.X)({wrapper:[g.l0.colWithGap(16)],repls:[g.l0.maxHeight("60vh"),g.l0.overflow("auto"),{"& > div":[g.l0.py(8),{borderTop:"1px solid "+g.TV.outlineDimmest}],"& > div:last-of-type":{borderBottom:"1px solid "+g.TV.outlineDimmest}}],row:[g.l0.colWithGap(8)],replRow:[g.l0.rowWithGap(8),g.l0.align.center],additionalReplsCount:[g.l0.pl(12),g.l0.pt(8)],buttons:[g.l0.rowWithGap(12),g.l0.justify.end]}),Z=function(e){var t,n=e.repl,a=e.onConfirmedChange,c=(0,r._)((0,y.useState)(""),2),u=c[0],p=c[1],m=(null===(t=n.hostingDeployment)||void 0===t?void 0:t.__typename)==="HostingDeployment"?n.hostingDeployment:null,g=(0,y.useRef)(!1);return(0,i.BX)(h.G,{css:b.row,children:[(0,i.BX)(h.G,{css:b.replRow,children:[(0,i.tZ)(l.ZP,{size:24,iconUrl:n.iconUrl,alt:""}),(0,i.tZ)(f.xv,{height:"singleLine",multiline:!1,children:n.title}),m?(0,i.tZ)(o.e,{deployment:m}):null]},n.id),m?(0,i.BX)(i.HY,{children:[(0,i.tZ)(d.E,{icon:(0,i.tZ)(v.Z,{}),colorway:"red",text:"This repl has been deployed. If you delete this Repl, the associated\nproduction deployment will also be shut down and deleted. To\nproceed, please type: ".concat(m.replitAppSubdomain)}),(0,i.tZ)(s.II,{placeholder:"Type here",value:u,onChange:function(e){var t=e.currentTarget.value;p(t);var n=t===m.replitAppSubdomain;n!==g.current&&a(n),g.current=n}})]}):null]})};t.Z=function(e){var t=e.selectedRepls,n=e.isOpen,o=e.onClose,l=e.onDelete,s=e.deleting,d=t.length,p=(0,a.Z)("Repl",d),v=t.filter(function(e){var t;return(null===(t=e.hostingDeployment)||void 0===t?void 0:t.__typename)==="HostingDeployment"}).length,g=(0,a.Z)("Deployment",v),w=v>0?" & ".concat(v>1?v+" ":""," ").concat(g):"",x=(0,r._)((0,y.useState)(0),2),C=x[0],_=x[1];return(0,y.useEffect)(function(){n||_(0)},[n]),(0,i.tZ)(u.u,{isOpen:n,onRequestClose:o,children:(0,i.BX)(h.G,{css:b.wrapper,children:[(0,i.BX)(f.h4,{variant:"subheadBig",level:2,children:["Delete ",p,v>0?" & ".concat(g):"","?"]}),(0,i.tZ)(f.xv,{color:"dimmer",children:"Are you sure? This cannot be undone. Some Repls may take a few minutes to finish deleting."}),(0,i.tZ)(h.G,{css:b.repls,children:t.map(function(e){return(0,i.tZ)(Z,{css:b.row,repl:e,onConfirmedChange:function(e){return _(function(t){return t+(e?1:-1)})}},e.id)})}),(0,i.BX)(h.G,{css:b.buttons,children:[(0,i.tZ)(c.zx,{text:"Cancel",onClick:o,disabled:s}),(0,i.tZ)(c.zx,{iconLeft:(0,i.tZ)(m.Z,{}),onClick:l,disabled:s||C<v,text:"Yes, delete ".concat(d>1?d+" ":""," ").concat(p).concat(w),colorway:"negative"})]})]})})}},24463:function(e,t,n){n.d(t,{Z:function(){return a}});var r=n(74985);n(50959);var i=n(29287),o=n(38080);function a(e){var t=e.className,n=e.children;return(0,r.tZ)(o.Tg,{elevated:!0,tag:"span",css:[{display:"inline",lineHeight:1},i.l0.fontSize(i.TV.fontSizeSmall),i.l0.borderRadius(4),i.l0.px(4),i.l0.font.code,t],children:n})}},47075:function(e,t,n){var r=n(41733),i=n(30509),o=n(74985),a=n(43312),l=function(e){return{animationDuration:e?"2000ms":"800ms",animationIterationCount:"infinite",animationTimingFunction:"ease-in-out"}},c=(0,a.F4)("\n  0% { transform: translate(0px, 0px) }\n  25% { transform: translate(0px, 80px) }\n  50% { transform: translate(100px, 80px) }\n  75% { transform: translate(100px, 160px) }\n  100% { transform: translate(0px, 160px) }\n"),s=(0,a.F4)("\n  0% { transform: translate(0px, 0px) }\n  25% { transform: translate(0px, -80px) }\n  50% { transform: translate(-100px, -80px) }\n  100% { transform: translate(-100px, -80px) }\n"),u=(0,a.F4)("\n  0% { transform: translate(0px, 0px) }\n  50% { transform: translate(0px, 0px) }\n  75% { transform: translate(0px, -80px) }\n  100% { transform: translate(100px, -80px) }\n");t.Z=function(e){var t=e.height,n=void 0===t?24:t,a=e.color,d=e.slow,f=void 0!==d&&d,h={width:84,height:64,fill:void 0===a?"#F26207":a,rx:12};return(0,o.BX)("svg",{width:n/1.2,height:n,viewBox:"0 0 200 240",xmlns:"http://www.w3.org/2000/svg",children:[(0,o.tZ)("rect",(0,i._)((0,r._)({css:[l(f),{animationName:c}]},h),{x:8,y:8})),(0,o.tZ)("rect",(0,i._)((0,r._)({css:[l(f),{animationName:s}]},h),{x:108,y:88})),(0,o.tZ)("rect",(0,i._)((0,r._)({css:[l(f),{animationName:u}]},h),{x:8,y:168}))]})}},36227:function(e,t,n){n.d(t,{O:function(){return p}});var r=n(74985),i=n(4995),o=n(9331),a=n(58719),l=n(40282),c=n(1498),s=n(87659),u=n(15146),d=n(74833),f=n(56596),h=n(29287);function p(e){var t=e.title,n=e.content,l=e.colorway,p=void 0===l?"primary":l,v=e.totalSteps,g=void 0===v?1:v,y=e.currentStepIndex,b=void 0===y?0:y,Z=e.onDismiss,w=e.onCurrentStepChange,x=e.cypressCloseData;return(0,r.BX)(f.G,{css:[h.l0.p(8),{paddingBottom:12,paddingRight:t?void 0:32,backgroundColor:s.Br[p].dimmest,border:"1px solid "+s.Br[p].dimmer,position:"relative"},h.l0.borderRadius(8),h.l0.shadow(2),h.l0.colWithGap(8)],children:[(0,r.tZ)(u.hU,{alt:"Close",colorway:p,css:{position:"absolute",top:h.TV.space8,right:h.TV.space8},onClick:Z,dataCy:x,children:(0,r.tZ)(a.Z,{})}),t?(0,r.tZ)(d.xv,{variant:"subheadBig",multiline:!1,children:t}):null,"function"==typeof n?(0,r.tZ)(n,{}):(0,r.tZ)(d.xv,{children:n}),g>1&&w?(0,r.BX)(f.G,{css:[h.l0.flex.row,h.l0.align.center,h.l0.justify.spaceBetween],children:[(0,r.tZ)(c.zx,{css:{visibility:b<=0?"hidden":void 0},colorway:p,text:"Back",iconLeft:(0,r.tZ)(i.Z,{}),onClick:function(){return w(b-1)}}),(0,r.tZ)(m,{colorway:p,total:g,current:b}),(0,r.tZ)(c.zx,{"data-autofocus":!0,colorway:p,text:b>=g-1?"Done":"Next",iconLeft:(0,r.tZ)(o.Z,{}),onClick:function(){return b>=g-1?Z():w(b+1)}})]}):null]})}function m(e){var t=e.total,n=e.current,i=e.colorway;return(0,r.BX)(f.G,{children:[(0,r.tZ)(l.T,{children:(0,r.tZ)("progress",{value:n+1,max:t,"aria-label":"Step"})}),(0,r.tZ)(f.G,{"aria-hidden":!0,css:h.l0.rowWithGap(8),children:Array(t).fill(0).map(function(e,t){return(0,r.tZ)(f.G,{css:[h.l0.borderRadius("full"),{width:h.TV.space8,height:h.TV.space8,backgroundColor:t===n?s.Br[i].stronger:s.Br[i].dimmer}]},t)})})]})}},57118:function(e,t,n){n.d(t,{RY:function(){return m},U5:function(){return g},dW:function(){return v},iz:function(){return y},lq:function(){return p}});var r=n(41733),i=n(30509),o=n(98924),a=n(74985);n(50959);var l=n(29287),c=n(56596),s=n(38080),u=n(60769),d=n(48272);n(54843);var f=c.K.label,h=function(e){var t=e.children,n=(0,o._)(e,["children"]);return(0,a.tZ)(f,(0,i._)((0,r._)({css:[l.l0.justify.spaceBetween,l.l0.align.center,l.l0.flex.row,{fontSize:l.TV.fontSizeDefault,lineHeight:l.TV.lineHeightDefault}]},n),{children:t}))},p=function(e){e.onChange;var t=(0,o._)(e,["onChange"]);return(0,a.tZ)(b,(0,i._)((0,r._)({label:"Date created"},t),{children:(0,a.tZ)(d.P,(0,r._)({},e))}))},m=function(e){e.onChange;var t=(0,o._)(e,["onChange"]);return(0,a.tZ)(b,(0,i._)((0,r._)({label:"Sort"},t),{children:(0,a.tZ)(d.P,(0,r._)({},e))}))},v=function(e){return(0,a.tZ)(s.Tg,{css:[l.l0.p(8)],children:(0,a.BX)(h,{htmlFor:e.id,children:["Exact match ",(0,a.tZ)(u.X,(0,r._)({},e))]})})},g=function(e){return(0,a.tZ)(s.Tg,{css:[l.l0.p(8)],children:(0,a.BX)(h,{htmlFor:e.id,children:["My code only ",(0,a.tZ)(u.X,(0,r._)({},e))]})})},y=function(){return(0,a.tZ)("div",{css:[l.l0.p(0),l.l0.m(0),{borderBottom:"1px solid",borderBottomColor:l.TV.backgroundHighest}]})},b=function(e){var t=e.children,n=e.label,r=e.className,i=(0,o._)(e,["children","label","className"]);return(0,a.BX)(c.G,{className:r,css:[l.l0.colWithGap(8),l.l0.pb(8)],children:[(0,a.tZ)(s.Tg,{css:[l.l0.p(8),l.l0.mb(0),l.l0.position.relative],children:(0,a.tZ)(h,{htmlFor:i.id,children:n})}),(0,a.tZ)(c.G,{css:[l.l0.px(8)],children:t})]},n)}},81106:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(27387),i=n(66626),o=n(96583),a=n(7444),l=n(72067),c=n(50959);function s(e){var t=(0,l.Z)({container:e,service:"exec"}).channel,n=(0,c.useRef)(!1),s=(0,c.useRef)([]),u=(0,a.Z)((0,r._)(function(){var e,r,a,l,c,d,f,h,p,m;return(0,o.Jh)(this,function(o){switch(o.label){case 0:if(n.current||!s.current.length||(null==t?void 0:t.status)!=="open")return[2];if(!(e=s.current.pop()))throw Error("Expected request");return l=(a=(r=(0,i._)(e,2))[0]).args,c=a.env,d=r[1],f="",h=t.onCommand(function(e){e.output&&(f+=e.output)}),n.current=!0,[4,t.request({exec:{args:l,env:c}})];case 1:return p=o.sent(),n.current=!1,h(),m=p.channelClosed?"Channel closed":p.error,d(m?{error:m,output:f||null}:{output:f,error:null}),u.current(),[2]}})})),d=null==t?void 0:t.status;return(0,c.useEffect)(function(){"open"===d&&u.current()},[d,u]),(0,c.useCallback)(function(e){var t=e.args,n=e.env;return new Promise(function(e){s.current.push([{args:t,env:n},e]),u.current()})},[u])}},66349:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(66626),i=n(47001),o=n(54916),a=n(50959);function l(){var e,t,n=(0,o.Z)().container,l=(0,r._)((0,a.useState)(null!==(t=null===(e=n.getContext())||void 0===e?void 0:e.repl)&&void 0!==t?t:null),2),c=l[0],s=l[1];return(0,a.useEffect)(function(){return n.onConnectionStateChanged(function(e){var t,r;e===i.em.CONNECTED&&s(null!==(r=null===(t=n.getContext())||void 0===t?void 0:t.repl)&&void 0!==r?r:null)})},[s,n]),c}},88377:function(e,t,n){n.d(t,{H:function(){return t5}});var r,i,o,a,l,c,s,u,d,f,h,p=n(27387),m=n(41733),v=n(66626),g=n(96583),y=n(51305),b=n(42256),Z=n(59868),w=n(35375),x=n(50959),C=n(67795),_=n(30671),S=n(24418),E=n(90487),k=n(23015);(c||(c={})).MESSAGE_RECEIVED="MESSAGE_RECEIVED";var T=n(83493),R=n(47001),D=n(56158),I=n(33829),G=n(50431);function B(e,t){return A.apply(this,arguments)}function A(){return(A=(0,p._)(function(e,t){var n,r,i,o;return(0,g.Jh)(this,function(a){switch(a.label){case 0:return n=t.upstream,r=t.branchName,i=["--set-upstream-to",n],r&&i.push((0,G.Gw)(r)),[4,e("git branch ".concat(i.join(" ")),{serviceMethod:"git-set-branch-upstream"})];case 1:if((o=a.sent()).error)return[2,o];return[2,{error:null}]}})})).apply(this,arguments)}var P=["git diff -z --name-only --diff-filter=U","echo -n ".concat("\x1f"),"{ git grep -z -l -E '<{7,}|={7,}|>{7,}' || exit $(( $? == 1 ? 0 : $? )); }"].join(" && ");function N(e){return U.apply(this,arguments)}function U(){return(U=(0,p._)(function(e){var t,n,r,i,o,a,l,c,s,u,d;return(0,g.Jh)(this,function(f){switch(f.label){case 0:return[4,e(P,{serviceMethod:"git-get-conflicting-files"})];case 1:if((t=f.sent()).error)return[2,t];if(r=(n=(0,v._)(t.output.split("\x1f").map(function(e){return(0,G.so)(e,"\x00")}),2))[0],i=n[1],!r.length)return[2,{files:new Map,error:null}];o=new Map,a=!0,l=!1,c=void 0;try{for(s=r[Symbol.iterator]();!(a=(u=s.next()).done);a=!0)d=u.value,o.set(d,!i.includes(d))}catch(e){l=!0,c=e}finally{try{a||null==s.return||s.return()}finally{if(l)throw c}}return[2,{files:o,error:null}]}})})).apply(this,arguments)}var O=n(57369),L=n(75813);function M(e){return X.apply(this,arguments)}function X(){return(X=(0,p._)(function(e){var t,n,r,i,o,a;return(0,g.Jh)(this,function(l){switch(l.label){case 0:return[4,(0,O.ZP)(e)];case 1:if((t=l.sent()).error)return[2,t];if(t.state!==O.yG.MERGING)return[2,{error:L.aq.INVALID_STATE}];return[4,e("cat '.git/MERGE_HEAD'",{serviceMethod:"git-get-merging-refs"})];case 2:if((n=l.sent()).error)return[2,n];if(!(r=(0,G.so)(n.output,"\n")).length)return[2,{commits:[],branches:[],error:null}];return i="{ grep -F '".concat(r.join("\n"),"' || exit 0; }"),[4,e("".concat('git for-each-ref --format="%(objectname)	%(refname)" refs/heads/ refs/remotes/'," | ").concat(i),{serviceMethod:"git-get-merging-refs"})];case 3:if((o=l.sent()).error)return[2,o];if(!o.output)return[2,{commits:r,branches:[],error:null}];return a=(0,G.so)(o.output,"\n").map(function(e){return e.split("	")[1]}).map(G.C),[2,{commits:r,branches:a,error:null}]}})})).apply(this,arguments)}var F=n(65307);function W(e){return H.apply(this,arguments)}function H(){return(H=(0,p._)(function(e){var t,n;return(0,g.Jh)(this,function(r){switch(r.label){case 0:return[4,e("if [ -f '.git/FETCH_HEAD' ]; then stat -c %Y '.git/FETCH_HEAD'; fi",{serviceMethod:"git-last-fetched"})];case 1:if((t=r.sent()).error)return[2,t];if(!t.output||isNaN(n=parseInt(t.output,10)))return[2,{lastFetched:null,error:null}];return[2,{lastFetched:new Date(n*=1e3),error:null}]}})})).apply(this,arguments)}var V=n(21076),z=n(80433);function j(e,t){return q.apply(this,arguments)}function q(){return(q=(0,p._)(function(e,t){var n,r,i,o,a,l;return(0,g.Jh)(this,function(c){switch(c.label){case 0:if(n=(t=(0,V.Qj)(t)).startsWith("refs/heads/"),r=t.startsWith("refs/remotes/"),n)return[3,2];return i=r?t:"refs/remotes/".concat(t),[4,e("git show-ref --verify ".concat(i),{serviceMethod:"git-branch-exists"})];case 1:if(!(o=c.sent()).error)return[2,{exists:!0,ref:(0,z.L)(i),error:null}];if(o.error!==L.aq.INVALID_REFERENCE)return[2,o];c.label=2;case 2:if(r)return[3,4];return a=n?t:"refs/heads/".concat(t),[4,e("git show-ref --verify ".concat(a),{serviceMethod:"git-branch-exists"})];case 3:if(!(l=c.sent()).error)return[2,{exists:!0,ref:(0,z.L)(a),error:null}];if(l.error!==L.aq.INVALID_REFERENCE)return[2,l];c.label=4;case 4:return[2,{exists:!1,ref:null,error:null}]}})})).apply(this,arguments)}function Y(e,t,n){return $.apply(this,arguments)}function $(){return($=(0,p._)(function(e,t,n){var r,i,o;return(0,g.Jh)(this,function(a){switch(a.label){case 0:if((0,V.Pi)(t,n)){if(t=(0,V.bF)(t,!0),n=(0,V.bF)(n),t===n)return[2,{canMerge:!0,error:null}]}else t=(0,V.bF)(t),n=(0,V.bF)(n);return t=(0,G.Gw)(t),n=(0,G.Gw)(n),r="git merge-base ".concat(t," ").concat(n),i='git merge-tree "$('.concat(r,')" ').concat(t," ").concat(n),[4,e("set -eo pipefail; (".concat(i," | ").concat("( (grep -q -e '^+<* \\.our$' && echo '1') || echo '0')",") || test $? -eq 141"),{serviceMethod:"git-can-merge-branches"})];case 1:if((o=a.sent()).error)return[2,o];return[2,{canMerge:"0"===o.output,error:null}]}})})).apply(this,arguments)}function J(e,t){return K.apply(this,arguments)}function K(){return(K=(0,p._)(function(e,t){var n,r,i,o,a,l,c,s,u;return(0,g.Jh)(this,function(d){switch(d.label){case 0:return n=t.branch,r=t.message,o=void 0!==(i=t.allowConflicts)&&i,[4,(0,O.ZP)(e)];case 1:if((a=d.sent()).error)return[2,a];if(l=a.state,a.type!==O.y5.NORMAL||l===O.yG.DIRTY_WORKTREE||l===O.yG.DIRTY_INDEX)return[2,{error:L.aq.INVALID_STATE}];return[4,j(e,n)];case 2:if((c=d.sent()).error)return[2,c];if(!c.exists)return[2,{error:L.aq.INVALID_REFERENCE}];if(o)return[3,4];return[4,Y(e,n,"HEAD")];case 3:if((s=d.sent()).error)return[2,s];if(!s.canMerge)return[2,{error:L.aq.MERGE_CONFLICT}];d.label=4;case 4:var f,h,p,m;return h=(f={branch:n,message:r}).branch,p=f.message,h=(0,V.Qj)(h),m=["--quiet","--no-edit","--no-ff","--overwrite-ignore","--commit"],p&&m.push("-m",(0,G.Gw)(p)),m.push((0,G.Gw)(h)),[4,e("git merge ".concat(m.join(" ")),{serviceMethod:"git-merge"})];case 5:if((u=d.sent()).error!==L.aq.MERGE_CONFLICT)return[3,8];if(o)return[3,7];return[4,e("git merge --abort")];case 6:return d.sent(),[2,u];case 7:return[2,{hasConflicts:!0,error:null}];case 8:if(u.error)return[2,u];return[2,{hasConflicts:!1,error:null}]}})})).apply(this,arguments)}function Q(e){return ee.apply(this,arguments)}function ee(){return(ee=(0,p._)(function(e){var t;return(0,g.Jh)(this,function(n){switch(n.label){case 0:return[4,e("git merge --abort",{serviceMethod:"git-merge-abort"})];case 1:if((t=n.sent()).error)return[2,t];return[2,{error:null}]}})})).apply(this,arguments)}function et(e){return en.apply(this,arguments)}function en(){return(en=(0,p._)(function(e){var t;return(0,g.Jh)(this,function(n){switch(n.label){case 0:return[4,e("GIT_EDITOR=/bin/true git merge --continue",{serviceMethod:"git-merge-continue"})];case 1:if((t=n.sent()).error)return[2,t];return[2,{error:null}]}})})).apply(this,arguments)}var er=n(55103);function ei(e,t,n){return eo.apply(this,arguments)}function eo(){return(eo=(0,p._)(function(e,t,n){var r,i,o,a,l,c,s,u,d,f,h,p,m,v,y;return(0,g.Jh)(this,function(g){switch(g.label){case 0:if("string"==typeof t){if(""===t)return[2,{error:null}];t=[t]}if(!0!==t&&0===t.length)return[2,{error:null}];if(!(void 0!==n))return[3,2];return r=["--quiet","--no-overlay","--worktree","--source=".concat(n),!0===t?".":"-- ".concat(t.join(" "))],[4,e("git --literal-pathspecs restore ".concat(r.join(" ")),{serviceMethod:"git-restore-files"})];case 1:if((i=g.sent()).error)return[2,i];return[2,{error:null}];case 2:return[4,(0,er.Z)(e)];case 3:if((o=g.sent()).error)return[2,o];a=[],l=[],c=!0,s=!1,u=void 0;try{for(d=o.changes[Symbol.iterator]();!(c=(f=d.next()).done);c=!0)if(h=f.value,!0===t||t.includes(h.path))switch(h.type.worktree){case er.h.UNMODIFIED:continue;case er.h.UNTRACKED:a.push((0,G.Gw)(h.path));break;default:l.push((0,G.Gw)(h.path))}}catch(e){s=!0,u=e}finally{try{c||null==d.return||d.return()}finally{if(s)throw u}}if(0===a.length&&0===l.length&&void 0===n)return[2,{error:null}];return p=[],a.length&&(m=["--quiet","--force","--",a.join(" ")],p.push("git --literal-pathspecs clean ".concat(m.join(" ")))),l.length&&(v=["--quiet","--no-overlay","--worktree","-- ".concat(l.join(" "))],p.push("git --literal-pathspecs restore ".concat(v.join(" ")))),[4,e(p,{serviceMethod:"git-restore-files"})];case 4:if((y=g.sent()).error)return[2,y];return[2,{error:null}]}})})).apply(this,arguments)}var ea=n(12285),el=n(63257),ec=n(43182),es=n(2689),eu=function(){"use strict";function e(t,n){(0,ea._)(this,e),this.cache=new Map,this.lastInvalidation=0,this.ttl=t,this.debounceTime=n}var t=e.prototype;return t.has=function(e){return this.cache.has(e)},t.get=function(e){var t=this.cache.get(e);if(!t)throw Error("No value found for key: ".concat(e));return t.result},t.set=function(e,t){var n=this,r=this.cache.get(e);r&&(clearTimeout(r.timeout),this.cache.delete(e));var i={result:t,timeout:setTimeout(function(){return n.cache.delete(e)},this.ttl),pending:!0};t.finally(function(){return i.pending=!1}),this.cache.set(e,i)},t.invalidate=function(){if(!(Date.now()-this.lastInvalidation<this.debounceTime)){var e=new Map,t=!0,n=!1,r=void 0;try{for(var i,o=this.cache[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=(0,v._)(i.value,2),l=a[0],c=a[1];c.pending?e.set(l,c):clearTimeout(c.timeout)}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}this.cache=e,this.lastInvalidation=Date.now()}},t.clear=function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this.cache.values()[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value;clearTimeout(o.timeout)}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}this.cache.clear(),this.lastInvalidation=0},e}(),ed=n(97631),ef=/^(fatal: |error: |remote: error: |CONFLICT \([^)]+\): )/im,eh=/^cat: .*: No such file or directory$/im;function ep(e){return RegExp("^fatal: ".concat(e.source),"im")}function em(e){return RegExp("^error: ".concat(e.source),"im")}var ev=[{error:L.aq.NOT_INITIALIZED,match:[ep(/not a git repository/)]},{error:L.aq.UNAUTHENTICATED,match:[ep(/Authentication failed/),ep(/unable to access/),ep(/repository \S+ not found/),ep(/could not read Username/),ep(/could not read Password/),ep(/Could not read from remote/)]},{error:L.aq.INDEX_FILE_CORRUPT,match:[ep(/index file corrupt/),ep(/index file smaller than expected/),em(/index file .*?\.idx is too small/)]},{error:L.aq.UNKNOWN_REMOTE,match:[ep(/No such remote/),em(/No such remote/)]},{error:L.aq.INDEX_LOCKED,match:[ep(/Unable to create .*?\.git\/index\.lock/),em(/Unable to create .*?\.git\/index\.lock/)]},{error:L.aq.NO_COMMITS,match:[ep(/your current branch '.*?' does not have any commits yet/)]},{error:L.aq.PATH_MATCHED_NO_FILES,match:[ep(/pathspec '.*?' did not match any files/),ep(/pathspec '.*?' did not match any file\(s\) known to git/),ep(/path '.*?' does not exist/),ep(/path '.*?' exists on disk, but not in/)]},{error:L.aq.USER_NOT_CONFIGURED,match:[ep(/unable to auto-detect email address/),ep(/unable to auto-detect name/),ep(/empty ident name \(for <.*?>\) not allowed/)]},{error:L.aq.INVALID_REFERENCE,match:[ep(/invalid reference: .*?$/),ep(/'.*?' - not a valid ref/)]},{error:L.aq.BRANCH_ALREADY_EXISTS,match:[ep(/A branch named '.*?' already exists/)]},{error:L.aq.MERGE_CONFLICT,match:[ep(/Not possible to fast-forward, aborting/),ep(/refusing to merge unrelated histories/),ep(/Exiting because of an unresolved conflict/),ep(/Exiting because of unfinished merge/),em(/Failed to merge in the changes/),RegExp("^CONFLICT \\([^\\)]+\\): ".concat(/Merge conflict in/.source),"im")]},{error:L.aq.UPSTREAM_NOT_SET,match:[ep(/The current branch \S+ has no upstream branch/),ep(/No configured push destination/)]},{error:L.aq.HEAD_DETACHED,match:[ep(/HEAD does not point to a branch/),ep(/ref HEAD is not a symbolic ref/)]},{error:L.aq.DIRTY_WORKTREE,match:[em(/Your local changes to the following files would be overwritten/),em(/The following untracked working tree files would be overwritten/),em(/\S+ is not possible because you have unmerged files/),em(/cannot rebase: You have unstaged changes/)]},{error:L.aq.PROTECTED_BRANCH,match:[RegExp("^remote: error: ".concat(/.*? Protected branch update failed/.source),"im")]},{error:L.aq.PUSH_REJECTED,match:[em(/failed to push some refs to/)]},{error:L.aq.REMOTE_ALREADY_EXISTS,match:[ep(/remote .*? already exists/),em(/remote .*? already exists/)]},{error:L.aq.INVALID_STATE,match:[ep(/There is no merge in progress/),ep(/There is no merge to abort/),ep(/No rebase in progress/)]}],eg=n(26572),ey=n(59173);function eb(){return(eb=(0,p._)(function(e,t,n,r){var i,o,a,l,c,s,u;return(0,g.Jh)(this,function(d){switch(d.label){case 0:if("open"!==e.status)return[2,{output:"JS Error\nchannel closed before command was run",error:L.aq.CHANNEL_CLOSED}];d.label=1;case 1:return d.trys.push([1,3,,4]),i="",o=e.onCommand(function(e){null!==e.output&&void 0!==e.output&&(i+=e.output)}),a=void 0,(l=Promise.race([new Promise(function(e){return a=setTimeout(e,9e4)}),e.request({exec:{env:n,args:t,blocking:!0}})])).finally(function(){o(),clearTimeout(a)}),[4,l];case 2:if(void 0===(c=d.sent()))return es.kg.error("Git request timed out.",(0,m._)({appService:"git",command:t,gitEnv:JSON.stringify(n),TIMEOUT:9e4},r)),[2,{output:i,error:L.aq.TIMEOUT}];if(!c.ok&&c.channelClosed)return[2,{output:"JS Error\nchannel closed during command execution",error:L.aq.CHANNEL_CLOSED}];if(c.error||!c.ok)return[2,{output:s="".concat(c.error,"\n").concat(i),error:function(e){if(ef.test(e)){for(var t=0;t<ev.length;t++)for(var n=0;n<ev[t].match.length;n++)if(ev[t].match[n].test(e))return ev[t].error;return L.aq.UNKNOWN}return eh.test(e)?L.aq.PATH_MATCHED_NO_FILES:L.aq.UNKNOWN_NOT_GIT}(s)}];return[2,{output:i,error:null}];case 3:return u=d.sent(),ec.$e(function(e){e.setTag("service","git"),e.setExtra("command",t),e.setExtra("env",n),r&&e.setExtra("options",r),ec.Tb(u)}),[2,{output:"JS Error\n".concat(String(u)),error:L.aq.UNKNOWN_NOT_GIT}];case 4:return[2]}})})).apply(this,arguments)}var eZ=function(){"use strict";function e(t){var n=t.container,r=t.getEnv,i=t.awaitPromise,o=this;(0,ea._)(this,e),this.cache=new eu(3e4,2e3),this.running=(0,ey.u)(!1),this.queue=[],n.openChannel({service:"exec"},function(e){var t,n,a=e.channel,l=(t=(0,p._)(function(e,t){var n,o;return(0,g.Jh)(this,function(l){switch(l.label){case 0:if(0===e.length)throw Error("Expected at least one command");if(!i)return[3,2];return[4,i];case 1:l.sent(),l.label=2;case 2:return n=Date.now(),[4,function(e,t,n,r){return eb.apply(this,arguments)}(a,["bash","-c",Array.isArray(e)?e.join(" && "):e],r(),t)];case 3:if(o=l.sent(),(0,ed.J)(e,o,!1,n),o.error)return[2,o];return[2,{output:(null==t?void 0:t.verbatim)?o.output:o.output.trim(),error:null}]}})}),function(e,n){return t.apply(this,arguments)}),c=function(e,t){if(0===e.length)throw Error("Expected at least one command");var n=Array.isArray(e)?e.join(" && "):e;if(o.cache.has(n)){var r=o.cache.get(n);return r.then(function(t){(0,ed.J)(e,t,!0)}),r}var i=l(n,t);return o.cache.set(n,i),i},s=function(e,t){return o.cache.clear(),l(e,t)},u=(n=(0,p._)(function(){var e;return(0,g.Jh)(this,function(t){switch(t.label){case 0:if(!(o.queue.length>0)||"open"!==a.status)return[3,7];if(!(e=o.queue.shift()))return[3,6];if("read"!==e.type)return[3,2];return[4,e.fn(c)];case 1:case 3:return t.sent(),[3,6];case 2:if("write"!==e.type)return[3,4];return[4,e.fn(s)];case 4:return[4,e.fn(l)];case 5:t.sent(),t.label=6;case 6:return[3,0];case 7:return 0===o.queue.length&&o.running.set(!1),[2]}})}),function(){return n.apply(this,arguments)});return o.running.current&&u(),o.running.subscribe(function(e){e&&u()})})}var t=e.prototype;return t.add=function(e,t){var n,r=(0,eg.Z)();return this.queue.push({type:t,fn:(n=(0,p._)(function(t){var n;return(0,g.Jh)(this,function(i){switch(i.label){case 0:return[4,e(t)];case 1:return n=i.sent(),r.resolve(n),[2]}})}),function(e){return n.apply(this,arguments)})}),this.running.current||this.running.set(!0),r.promise},t.wrap=function(e,t){var n=this;if("function"!=typeof e)throw Error("Expected a function");return function(){for(var r=arguments.length,i=Array(r),o=0;o<r;o++)i[o]=arguments[o];return n.add(function(t){return e.apply(void 0,[t].concat((0,el._)(i)))},t)}},e}(),ew=n(86763),ex=n.n(ew);function eC(e,t){return e_.apply(this,arguments)}function e_(){return(e_=(0,p._)(function(e,t){var n,r,i;return(0,g.Jh)(this,function(o){switch(o.label){case 0:if(n=t.name,r=t.url,n=(0,G.ss)(n),!(0,V.GE)(n))return[2,{error:L.aq.INVALID_REFERENCE}];return n=(0,G.Gw)(n),r=(0,G.Gw)(r),[4,e("git remote add ".concat(n," ").concat(r),{serviceMethod:"git-add-remote"})];case 1:if((i=o.sent()).error)return[2,i];return[2,{error:null}]}})})).apply(this,arguments)}function eS(e,t){return eE.apply(this,arguments)}function eE(){return(eE=(0,p._)(function(e,t){var n;return(0,g.Jh)(this,function(r){switch(r.label){case 0:var i,o,a;return[4,e((i=t.message,o=t.files,a=["--allow-empty","--allow-empty-message","--cleanup=whitespace","--no-edit","--quiet","-m ".concat((0,G.Gw)(i))],o&&a.push.apply(a,["--only","--"].concat((0,el._)(o.map(G.Gw)))),"git --literal-pathspecs commit ".concat(a.join(" "))),{serviceMethod:"git-commit"})];case 1:if((n=r.sent()).error)return[2,n];return[2,{error:null}]}})})).apply(this,arguments)}function ek(e,t){return eT.apply(this,arguments)}function eT(){return(eT=(0,p._)(function(e,t){var n,r,i,o,a,l;return(0,g.Jh)(this,function(c){switch(c.label){case 0:return[4,j(e,t=(0,V.Qj)(t,!0))];case 1:if((n=c.sent()).error)return[2,n];if(!n.exists)return[2,{error:L.aq.INVALID_REFERENCE}];if(r=["--quiet","--no-guess"],n.ref.type!==z.l.REMOTE_BRANCH)return[3,3];return i=n.ref.branch,o=n.ref.name,[4,j(e,"refs/heads/".concat(i))];case 2:if((a=c.sent()).error)return[2,a];return a.exists?r.push((0,G.Gw)(i),"--"):r.push("-t","-b",(0,G.Gw)(i),(0,G.Gw)(o),"--"),[3,4];case 3:r.push((0,G.Gw)(n.ref.name),"--"),c.label=4;case 4:return[4,e("git checkout ".concat(r.join(" ")),{serviceMethod:"git-switch-branch"})];case 5:if((l=c.sent()).error)return[2,l];return[2,{error:null}]}})})).apply(this,arguments)}function eR(e,t){return eD.apply(this,arguments)}function eD(){return(eD=(0,p._)(function(e,t){var n,r,i,o,a,l,c,s,u,d,f;return(0,g.Jh)(this,function(h){switch(h.label){case 0:return n=t.name,i=void 0===(r=t.startPoint)?"HEAD":r,o=t.track,l=void 0!==(a=t.checkout)&&a,[4,j(e,n=(0,G.C)(n))];case 1:if((c=h.sent()).error)return[2,c];if(c.exists)return[2,{error:L.aq.BRANCH_ALREADY_EXISTS}];if("HEAD"===i){if(!0===o)return[2,{error:L.aq.INVALID_REFERENCE}];o=!1}if(!(!1!==o))return[3,3];return[4,j(e,i)];case 2:if((s=h.sent()).error)return[2,s];if(!s.exists&&!0===o)return[2,{error:L.aq.INVALID_REFERENCE}];s.exists&&s.ref.type===z.l.REMOTE_BRANCH&&void 0===o&&(o=!0),h.label=3;case 3:return u=["--quiet",o?"--track":"--no-track",(0,G.Gw)(n),(0,G.Gw)(i)],[4,e("git branch ".concat(u.join(" ")),{serviceMethod:"git-create-branch"})];case 4:if((d=h.sent()).error)return[2,d];if(!l)return[3,6];return[4,ek(e,n)];case 5:if((f=h.sent()).error)return[2,f];h.label=6;case 6:return[2,{error:null}]}})})).apply(this,arguments)}function eI(e){return eG.apply(this,arguments)}function eG(){return(eG=(0,p._)(function(e){var t,n,r,i,o=arguments;return(0,g.Jh)(this,function(a){switch(a.label){case 0:return t=o.length>1&&void 0!==o[1]?o[1]:{},n=["--quiet"],t.depth&&(r=t.deepen?"--deepen":"--depth",n.push("".concat(r,"=").concat(t.depth))),t.remote?n.push((0,G.Gw)(t.remote)):n.push("--all"),[4,e("git fetch ".concat(n.join(" ")),{serviceMethod:"git-fetch"})];case 1:if((i=a.sent()).error)return[2,i];return[2,{error:null}]}})})).apply(this,arguments)}var eB=["main","master","trunk","dev","develop","development","staging","prod","production"].map(function(e){return'if [ $(git rev-parse --verify --quiet "heads/'.concat(e,'") ]; then\n      echo "refs/heads/').concat(e,'"\n    fi')}).join("\n"),eA='\ngit remote | while IFS= read -r remote; do\n  if [ -z "$remote" ]; then continue; fi\n  branch="$('.concat('\nif [ -f ".git/refs/remotes/$remote/HEAD" ]; then\n  echo "$(sed -e "s/^ref: refs\\/remotes\\/$remote\\///" < .git/refs/remotes/$remote/HEAD)"\nelse\n  remote_result="$(git ls-remote --symref "$remote" HEAD)"\n  if [ -z "$remote_result" ]; then\n    echo ""\n  else\n    echo "$(\n      echo "$remote_result" | \\\n      head -1 | \\\n      awk \'{print $2}\' | \\\n      sed -e "s/^refs\\/heads\\///"\n    )"\n  fi\nfi\n'.trim(),')"\n  if [ -z "$branch" ]; then continue; fi\n  echo "refs/remotes/$remote/$branch"\n  if [ $(git rev-parse --verify --quiet "heads/$branch") ]; then\n    echo "refs/heads/$branch"\n  fi\ndone\n').concat(eB,"\n").trim();function eP(e){return eN.apply(this,arguments)}function eN(){return(eN=(0,p._)(function(e){var t;return(0,g.Jh)(this,function(n){switch(n.label){case 0:return[4,e(eA,{serviceMethod:"git-find-default-branches"})];case 1:if((t=n.sent()).error)return[2,t];return[2,{refs:(0,el._)(new Set((0,G.so)(t.output,"\n"))).map(function(e){return(0,z.L)(e)}),error:null}]}})})).apply(this,arguments)}var eU=n(75647);function eO(e,t){return eL.apply(this,arguments)}function eL(){return(eL=(0,p._)(function(e,t){var n,r,i,o,a,l,c,s,u,d,f,h;return(0,g.Jh)(this,function(p){switch(p.label){case 0:if(t=(0,V.bF)(t,!0),!(0,V.Dc)(t))return[2,{error:L.aq.INVALID_REFERENCE}];return n=(0,G.C)(t),i=(r=(0,v._)((0,G.Tg)(t),2))[0],o=r[1],a=["refs/heads/".concat(n),"refs/remotes/*/".concat(n)],i&&o&&(a.push("refs/heads/".concat(o)),a.push("refs/remotes/".concat(i,"/").concat(o))),[4,(0,eU.ZP)(e,{pattern:a})];case 1:if((l=p.sent()).error)return[2,l];if(0===l.branches.length)return[2,{error:L.aq.INVALID_REFERENCE}];c=!0,s=!1,u=void 0;try{for(d=l.branches[Symbol.iterator]();!(c=(f=d.next()).done);c=!0)if((h=f.value).type!==eU.HO.REMOTE&&h.name===n||i&&o&&h.type!==eU.HO.LOCAL&&h.remote===i&&h.name===o)return[2,{branch:h,error:null}]}catch(e){s=!0,u=e}finally{try{c||null==d.return||d.return()}finally{if(s)throw u}}return[2,{error:L.aq.INVALID_REFERENCE}]}})})).apply(this,arguments)}var eM=n(19659);function eX(e,t){return eF.apply(this,arguments)}function eF(){return(eF=(0,p._)(function(e,t){var n,r,i,o,a;return(0,g.Jh)(this,function(l){switch(l.label){case 0:if(n=t.path,i=void 0===(r=t.revision)?"HEAD":r,""===n)return[2,{content:null,error:null}];return o=(0,G.Gw)("".concat(i,":").concat(n)),[4,e((0,eM.T3)(n)?"git --no-pager show ".concat(o," | base64"):"git --no-pager show ".concat(o),{verbatim:!0,serviceMethod:"git-get-file-contents"})];case 1:if((a=l.sent()).error){if(a.error===L.aq.PATH_MATCHED_NO_FILES)return[2,{content:null,error:null}];return[2,a]}return[2,{content:a.output,error:null}]}})})).apply(this,arguments)}function eW(e){return eH.apply(this,arguments)}function eH(){return(eH=(0,p._)(function(e){var t,n,r,i,o,a,l,c,s,u,d,f,h,p;return(0,g.Jh)(this,function(m){switch(m.label){case 0:return[4,e("git remote -v",{serviceMethod:"git-get-remotes"})];case 1:if((t=m.sent()).error)return[2,t];if(""===t.output)return[2,{remotes:new Map,error:null}];n=new Map,r=!0,i=!1,o=void 0;try{for(a=(0,G.so)(t.output,"\n")[Symbol.iterator]();!(r=(l=a.next()).done);r=!0)c=l.value,u=(s=(0,v._)(c.split(/\s+/),3))[0],d=s[1],f=s[2],u&&d&&f&&(p=null!==(h=n.get(u))&&void 0!==h?h:{name:u,fetch:"",push:""},"(fetch)"===f?(p.fetch=d,""===p.push&&(p.push=d),n.set(u,p)):"(push)"===f&&(p.push=d,""===p.fetch&&(p.fetch=d),n.set(u,p)))}catch(e){i=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return[2,{remotes:n,error:null}]}})})).apply(this,arguments)}var eV='git commit --allow-empty --no-edit --quiet -m "Initial commit"',ez='git add -A && git commit --allow-empty --no-edit --quiet -m "Initial commit"';function ej(e){return eq.apply(this,arguments)}function eq(){return(eq=(0,p._)(function(e){var t,n,r,i,o,a,l,c,s,u=arguments;return(0,g.Jh)(this,function(d){switch(d.label){case 0:return r=void 0===(n=(t=u.length>1&&void 0!==u[1]?u[1]:{}).initialCommit)||n,o=void 0===(i=t.includeAllInitialFiles)||i,[4,(0,O.ZP)(e)];case 1:if((a=d.sent()).error)return[2,a];if(a.type!==O.y5.INITIALIZING)return[2,{error:L.aq.ALREADY_INITIALIZED}];if(a.state!==O.yG.ON_UNBORN_BRANCH)return[3,4];if(!r)return[3,3];return[4,e(o?ez:eV,{serviceMethod:"git-init"})];case 2:if((l=d.sent()).error)return[2,l];d.label=3;case 3:return[2,{error:null}];case 4:return[4,e(["git init","git checkout -b main"],{serviceMethod:"git-init"})];case 5:if((c=d.sent()).error)return[2,c];if(!r)return[3,7];return[4,e(o?ez:eV,{serviceMethod:"git-init"})];case 6:if((s=d.sent()).error)return[2,s];d.label=7;case 7:return[2,{error:null}]}})})).apply(this,arguments)}function eY(e){return e$.apply(this,arguments)}function e$(){return(e$=(0,p._)(function(e){var t;return(0,g.Jh)(this,function(n){switch(n.label){case 0:return[4,e("git rev-parse --is-inside-work-tree",{serviceMethod:"git-is-initialized"})];case 1:if((t=n.sent()).error){if(t.error===L.aq.NOT_INITIALIZED)return[2,{initialized:!1,error:null}];return[2,t]}return[2,{initialized:"true"===t.output,error:null}]}})})).apply(this,arguments)}function eJ(e){var t=(0,v._)(e.trimStart().split("\x1f"),11),n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],l=t[5],c=t[6],s=t[7],u=t[8],d=t[9],f=t[10],h=[],p=i?i.split(" "):null,m=!1,g=!0,y=!1,b=void 0;try{for(var Z,w=(0,G.so)(n,",")[Symbol.iterator]();!(g=(Z=w.next()).done);g=!0){var x=Z.value;if("grafted"===x){m=!0;continue}h.push((0,z.L)(x))}}catch(e){y=!0,b=e}finally{try{g||null==w.return||w.return()}finally{if(y)throw b}}return{refs:h,hash:r,parents:p,grafted:m,author:{name:o,email:a,date:1e3*parseInt(l,10)},committer:{name:c,email:s,date:1e3*parseInt(u,10)},subject:d?d.trim():"",body:f?f.trim():""}}function eK(e){return eQ.apply(this,arguments)}function eQ(){return(eQ=(0,p._)(function(e){var t,n=arguments;return(0,g.Jh)(this,function(r){switch(r.label){case 0:var i,o,a,l,c,s,u;return[4,e((a=void 0===(o=(i=n.length>1&&void 0!==n[1]?n[1]:{}).max)?25:o,l=i.skip,c=i.revRange,s=i.path,u=["-z","--decorate=full","--full-history",'--format="format:%D%x1f%H%x1f%P%x1f%an%x1f%ae%x1f%at%x1f%cn%x1f%ce%x1f%ct%x1f%s%x1f%b"'],a=Math.max(1,Math.min(a,200)),u.push("-n ".concat(a)),l&&u.push("--skip ".concat(l)),c&&u.push(c),u.push("--"),s&&u.push(s),"git log ".concat(u.join(" "))),{serviceMethod:"git-log"})];case 1:if((t=r.sent()).error){if(t.error===L.aq.NO_COMMITS)return[2,{commits:[],error:null}];return[2,t]}return[2,{commits:(0,G.so)(t.output,"\x00").map(eJ),error:null}]}})})).apply(this,arguments)}function e0(e){return e1.apply(this,arguments)}function e1(){return(e1=(0,p._)(function(e){var t,n=arguments;return(0,g.Jh)(this,function(r){switch(r.label){case 0:return[4,e(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=[];return e.cached&&t.push("--cached"),e.deleted&&t.push("--deleted"),e.modified&&t.push("--modified"),e.others&&t.push("--others"),e.ignored&&t.push("--ignored"),e.directory&&t.push("--directory"),e.noEmptyDirectory&&t.push("--no-empty-directory"),"git ls-files ".concat(t.join(" "))}(n.length>1&&void 0!==n[1]?n[1]:{}),{serviceMethod:"git-ls-files"})];case 1:if((t=r.sent()).error)return[2,t];return[2,{files:t.output.split("\n").filter(function(e){return e.length>0}),error:null}]}})})).apply(this,arguments)}var e2=n(91075);function e8(e){return e4.apply(this,arguments)}function e4(){return(e4=(0,p._)(function(e){var t,n,r,i,o,a,l,c,s,u,d,f=arguments;return(0,g.Jh)(this,function(h){switch(h.label){case 0:return t=f.length>1&&void 0!==f[1]?f[1]:{},[4,(0,er.Z)(e)];case 1:if((n=h.sent()).error)return[2,n];if(!n.branch)return[2,{error:L.aq.HEAD_DETACHED}];if(r=null,i=null,t.publish){if(n.upstream)return[2,{error:L.aq.BRANCH_ALREADY_EXISTS}];r=t.publish.remote,i=null!==(o=t.publish.name)&&void 0!==o?o:n.branch,r=(0,G.C)(r),i=(0,G.C)(i)}else{if(!n.upstream)return[2,{error:L.aq.UPSTREAM_NOT_SET}];if(!t.force&&n.upstream.behind>0)return[2,{error:L.aq.PUSH_REJECTED}];r=(a=(0,v._)((0,G.Tg)(n.upstream.branch),2))[0],i=a[1]}if(!r||!i)return[2,{error:L.aq.UPSTREAM_NOT_SET}];if(t.force)return[3,3];return[4,eI(e,{remote:r})];case 2:if((l=h.sent()).error)return[2,l];h.label=3;case 3:if(!t.publish)return[3,5];return[4,j(e,"refs/remotes/".concat(r,"/").concat(i))];case 4:if((c=h.sent()).error)return[2,c];if(c.exists&&c.ref.type===z.l.REMOTE_BRANCH)return[2,{error:L.aq.BRANCH_ALREADY_EXISTS}];h.label=5;case 5:return s=["--quiet"],t.force&&!t.publish&&s.push("--force-with-lease"),t.publish&&s.push("--set-upstream"),u="refs/heads/".concat(n.branch,":refs/heads/").concat(i),s.push((0,G.Gw)(r),(0,G.Gw)(u)),[4,e("git push ".concat(s.join(" ")),{serviceMethod:"git-push"})];case 6:if((d=h.sent()).error)return[2,d];return[2,{error:null}]}})})).apply(this,arguments)}function e3(e,t){return e5.apply(this,arguments)}function e5(){return(e5=(0,p._)(function(e,t){var n;return(0,g.Jh)(this,function(r){switch(r.label){case 0:if(t=(0,G.ss)(t),!(0,V.GE)(t))return[2,{error:L.aq.INVALID_REFERENCE}];return[4,e("git remote rm ".concat((0,G.Gw)(t)),{serviceMethod:"git-remove-remote"})];case 1:if((n=r.sent()).error)return[2,n];return[2,{error:null}]}})})).apply(this,arguments)}function e6(e,t){return e9.apply(this,arguments)}function e9(){return(e9=(0,p._)(function(e,t){var n,r,i;return(0,g.Jh)(this,function(o){switch(o.label){case 0:if(n=t.remote,r=t.url,n=(0,G.ss)(n),!(0,V.GE)(n)||!(0,V.LY)(r))return[2,{error:L.aq.INVALID_REFERENCE}];return n=(0,G.Gw)(n),r=(0,G.Gw)(r),[4,e("git remote set-url ".concat(n," ").concat(r),{serviceMethod:"git-set-remote-url"})];case 1:if((i=o.sent()).error)return[2,i];return[2,{error:null}]}})})).apply(this,arguments)}function e7(e,t){return te.apply(this,arguments)}function te(){return(te=(0,p._)(function(e,t){var n,r;return(0,g.Jh)(this,function(i){switch(i.label){case 0:if(!(n=function(e){if("all"in e)return e.all?["git add -A"]:["git reset -q -- ."];var t=e.add,n=e.reset;if(!(null==t?void 0:t.length)&&!(null==n?void 0:n.length))return null;var r=[];if(t){var i=t.map(G.Gw).join(" ");r.push("git --literal-pathspecs add -- ".concat(i))}if(n){var o=n.map(G.Gw).join(" ");r.push("git --literal-pathspecs reset -q -- ".concat(o))}return r}(t)))return[2,{error:null}];return[4,e(n,{serviceMethod:"git-stage-files"})];case 1:if((r=i.sent()).error)return[2,r];return[2,{error:null}]}})})).apply(this,arguments)}var tt=n(3720),tn=n(63043),tr=n(21262),ti=n(71440);function to(){var e=(0,tr._)(['\n  fragment GitServiceGitHubUser on CurrentUser {\n    image\n    username\n    email\n    gitHubInfo {\n      accessToken\n      userInfo {\n        username\n        email\n        avatarUrl\n      }\n    }\n    repositories(count: 1, after: "0") {\n      ... on RepositoryConnection {\n        items {\n          id\n        }\n      }\n    }\n  }\n']);return to=function(){return e},e}function ta(){var e=(0,tr._)(["\n  query GitServiceCurrentUser {\n    currentUser {\n      id\n      ...GitServiceGitHubUser\n    }\n  }\n  ","\n"]);return ta=function(){return e},e}var tl=(0,ti.Ps)(to()),tc=(0,ti.Ps)(ta(),tl);function ts(e){return tu.apply(this,arguments)}function tu(){return(tu=(0,p._)(function(e){var t,n,r,i,o,a,l,c,s,u,d,f,h,p,m,v,y,b;return(0,g.Jh)(this,function(g){switch(g.label){case 0:return t=e.defaultUsername,n=e.defaultUserId,r=e.onProfiles,a=new Map,[4,null===tt.l||void 0===tt.l?void 0:tt.l.query({query:tc,fetchPolicy:"network-only",context:{noBatch:!0}})];case 1:var Z,w;return d=(u=null!==(s=null==(c=(null!==(l=g.sent())&&void 0!==l?l:{data:null}).data)?void 0:c.currentUser)&&void 0!==s?s:{username:t,id:n}).id,f=u.username,d&&f&&(m={provider:L.rG.REPLIT_DEFAULT,email:"".concat(d,"-").concat(f,"@").concat(tn.J),username:f,avatar:null!==(p=null==c?void 0:null===(h=c.currentUser)||void 0===h?void 0:h.image)&&void 0!==p?p:null},a.set(m.provider,m)),(v=null==c?void 0:null===(o=c.currentUser)||void 0===o?void 0:null===(i=o.gitHubInfo)||void 0===i?void 0:i.userInfo)&&v.email&&v.username&&(null==c?void 0:null===(w=c.currentUser)||void 0===w?void 0:null===(Z=w.repositories)||void 0===Z?void 0:Z.__typename)==="RepositoryConnection"&&(b={provider:L.rG.GITHUB,email:v.email,username:v.username,avatar:null!==(y=v.avatarUrl)&&void 0!==y?y:null},a.set(b.provider,b)),r(a),[2]}})})).apply(this,arguments)}function td(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.author,n=e.committer,r={GIT_AUTHOR_NAME:"",GIT_AUTHOR_EMAIL:"",GIT_COMMITTER_NAME:"",GIT_COMMITTER_EMAIL:"",GIT_ASKPASS:"replit-git-askpass",GIT_PAGER:"",GIT_EDITOR:"",PAGER:"",EDITOR:""};if(t){r.GIT_AUTHOR_NAME=t.username,r.GIT_COMMITTER_NAME=t.username;var i=tf(t);r.GIT_AUTHOR_EMAIL=i,r.GIT_COMMITTER_EMAIL=i,n&&(r.GIT_COMMITTER_NAME=n.username,r.GIT_COMMITTER_EMAIL=tf(n))}return r}function tf(e){if("id"in e)return"".concat(e.id,"-").concat(e.username,"@users.noreply.replit.com");if("email"in e)return e.email;throw Error("Invalid user")}var th=n(39756),tp=n(30084),tm=".git",tv=n(90546),tg=n(36098),ty=n(16412),tb=n.n(ty),tZ=n(15482),tw=n(3341),tx=n.n(tw),tC=n(72526),t_=n(30509),tS=n(98924),tE=n(59510),tk=n.n(tE),tT=n(35554),tR=n.n(tT),tD=n(74207),tI=n(19012),tG=function(e){var t=e.configurationSupport;return{textDocument:{synchronization:{dynamicRegistration:!0,didSave:!0},signatureHelp:{dynamicRegistration:!0,signatureInformation:{documentationFormat:["markdown","plaintext"]}},publishDiagnostics:{relatedInformation:!0,tagSupport:{valueSet:[1,2]}},formatting:{dynamicRegistration:!0},documentSymbol:{dynamicRegistration:!0,hierarchicalDocumentSymbolSupport:!0,symbolKind:{valueSet:tI.Z}},definition:{dynamicRegistration:!0,linkSupport:!0},typeDefinition:{dynamicRegistration:!0},implementation:{dynamicRegistration:!0},references:{dynamicRegistration:!0},rename:{dynamicRegistration:!0,prepareSupport:!0},completion:{dynamicRegistration:!0,completionItem:{documentationFormat:["markdown","plaintext"],snippetSupport:!0}},codeAction:{resolveSupport:{properties:["edit"]},dataSupport:!0,dynamicRegistration:!0,codeActionLiteralSupport:{codeActionKind:{valueSet:Object.values(tD.CodeActionKind)}}},hover:{dynamicRegistration:!0,contentFormat:["markdown","plaintext"]}},workspace:{applyEdit:!0,didChangeConfiguration:t.clientToServer||t.serverToClient?{dynamicRegistration:!0}:void 0,configuration:t.serverToClient,executeCommand:{dynamicRegistration:!0},workspaceEdit:{documentChanges:!0,resourceOperations:[tD.ResourceOperationKind.Create,tD.ResourceOperationKind.Delete,tD.ResourceOperationKind.Rename]}}}},tB=n(20298),tA=n(8701),tP=n(73164),tN=function(){"use strict";function e(){(0,ea._)(this,e)}var t=e.prototype;return t.supports=function(e){return e.includes("css-language-server")},t.onResponse=function(e,t){return"textDocument/hover"===e?this.onHover(t):t},t.onHover=function(e){if("error"in e)return e;var t=e.result;return"cancelled"in e&&!1!==e.cancelled||!t?e:(Array.isArray(t.contents)&&(t.contents={kind:"markdown",value:["```html",t.contents[0],"```",t.contents[1],""].join("\n")}),(0,t_._)((0,m._)({},e),{result:t}))},e}(),tU=[new(function(){"use strict";function e(){(0,ea._)(this,e)}var t=e.prototype;return t.supports=function(e){return e.includes("typescript-language-server")},t.onResponse=function(e,t){return"textDocument/completion"===e?this.onCompletion(t):t},t.onCompletion=function(e){if("error"in e||"cancelled"in e&&!1!==e.cancelled)return e;var t=e.result;if(!t)return e;Array.isArray(t)&&(t={isIncomplete:!1,items:t});for(var n=0;n<t.items.length;n++){var r=t.items[n];r.sortText&&r.sortText.startsWith("")&&(r.sortText=r.sortText.replace("",""))}return(0,t_._)((0,m._)({},e),{result:t})},e}()),new tN],tO=function(){"use strict";function e(){(0,ea._)(this,e)}var t=e.prototype;return t.supports=function(){return!0},t.onResponse=function(e,t){return t},e}(),tL=n(79543),tM=n(91620).lW;function tX(e,t){var n,r;return null!==(r=null===(n=tP.$R.from(e))||void 0===n?void 0:n.id)&&void 0!==r?r:t}function tF(e,t){return e.line<t.line||e.line===t.line&&e.character<=t.character}function tW(){return Math.floor(2147483647*Math.random())}function tH(e){var t=JSON.stringify((0,t_._)((0,m._)({},e),{jsonrpc:"2.0"})),n=tM.byteLength(t,"utf8");return"Content-Length: ".concat(n,"\r\n\r\n").concat(t)}function tV(e,t){var n,r,i,o,a,l;return t&&t?!!(tx()(null==e?void 0:e.fileTypeAttrs,t.fileTypeAttrs)&&tx()(null==e?void 0:null===(n=e.config)||void 0===n?void 0:n.startCommand,null===(r=t.config)||void 0===r?void 0:r.startCommand)&&tx()(null==e?void 0:null===(i=e.config)||void 0===i?void 0:i.initializationOptionsJson,null===(o=t.config)||void 0===o?void 0:o.initializationOptionsJson)&&tx()(null==e?void 0:null===(a=e.config)||void 0===a?void 0:a.configurationJson,null===(l=t.config)||void 0===l?void 0:l.configurationJson)):!!t==!!t}function tz(e,t){return tj.apply(this,arguments)}function tj(){return(tj=(0,p._)(function(e,t){var n;return(0,g.Jh)(this,function(r){switch(r.label){case 0:return[4,e.exec("pwd")];case 1:if(null!==(n=r.sent()).error){if(!t())return[2,{error:Error("LSPNix: Could not get working directory "+n.error),workingDirectory:null}];return[2,tz(e,t)]}return[2,{error:null,workingDirectory:n.output.replace("\n","")}]}})})).apply(this,arguments)}(r=s||(s={})).INITIALIZED="INITIALIZED",r.READY="READY",r.DIAGNOSTICS="DIAGNOSTICS",r.SERVER_STATE_CHANGE="SERVER_STATE_CHANGE",r.SERVER_HEALTH_CHANGE="SERVER_HEALTH_CHANGE",r.SERVER_CAPABILITIES_CHANGE="SERVER_CAPABILITIES_CHANGE",r.REQUEST="REQUEST",r.RESPONSE="RESPONSE",r.CANCEL_REQUEST="CANCEL_REQUEST",r.SEND_NOTIFICATION="SEND_NOTIFICATION",(i=u||(u={})).OUTPUT="OUTPUT",i.ERROR="ERROR",i.STATE_CHANGED="STATE_CHANGED",i.CHANNEL_OPENED="CHANNEL_OPENED";var tq=n(53941),tY=n(80388);(o=d||(d={})).USER_JOIN="USER_JOIN",o.USER_LEAVE="USER_LEAVE",o.USERS_UPDATE="USERS_UPDATE",o.USER_OPENED_FILE="USER_OPENED_FILE",o.FOLLOWED_USER_CHANGED="FOLLOWED_USER_CHANGED",o.FOLLOWING_USERS_CHANGED="FOLLOWING_USERS_CHANGED";var t$=n(32902),tJ=n(1660);function tK(){var e=(0,tr._)(["\n  query GitHubAuth {\n    currentUser {\n      id\n      gitHubInfo {\n        accessToken\n      }\n    }\n  }\n"]);return tK=function(){return e},e}var tQ=(0,ti.Ps)(tK());function t0(){return(t0=(0,p._)(function(){var e;return(0,g.Jh)(this,function(t){switch(t.label){case 0:if(!tt.l)throw Error("Expected apollo");return[4,tt.l.query({query:tQ})];case 1:if(!(null==(e=t.sent().data)?void 0:e.currentUser))throw Error("Expected current user");return[2,e.currentUser]}})})).apply(this,arguments)}function t1(){document.activeElement instanceof HTMLElement&&document.activeElement.blur()}var t2=n(85492),t8=n(17789);(a=f||(f={})).DEEPLINK_CHANGED="DEEPLINK_CHANGED",a.SESSION_STATE_CHANGED="SESSION_STATE_CHANGED";var t4=n(42516),t3=n(45077);function t5(e){return(0,v._)((0,x.useState)(function(){var t,n,r,i,o,a,l,s,x,G,A,P,U,X,H,V,z,q,$,K,ee,en,eo,ea,eu,ed,ef,eh,ep,em,ev,eg,ey,eb,ew,e_,eE,eT,eD,eG,eB,eA,eN,eL,eF,eH,eV,ez,eq,e$,eJ,eQ,e1,e4,e5,e9,te,tt,tn,tr,ti,to,ta,tl,tc,tu,tf,ty,tw,tx,tE,tT,tD;return eD=(t=e).riverCtx,eB=void 0===(eG=t.runnerMode)?"outputs":eG,eA=t.onUnrecoverableError,eN=t.openFile,eL=t.openMultipleFiles,eF=t.openMultipleURLs,eH=t.onFirewallDenied,eV=t.channelRequestPriority,ez=t.enableUserEvents,eq=t.autoUpdateDotReplitOnPortInfo,e$=t.onPresenceCommand,eJ=t.getColorForUser,eQ=t.openTelemetryTracing,e1=t.ctx,e5=function(e){var t=e.container,n=e.enabled,r=e.onEventSent,i=(0,T.ZP)();r&&i.on(h.EVENT_SENT,r);var o=null;function a(e,t){return l.apply(this,arguments)}function l(){return(l=(0,p._)(function(e,r){var o,a,l,s,u,d,f,p;return(0,g.Jh)(this,function(g){switch(g.label){case 0:if(!n)return[2];return[4,function(){return c.apply(this,arguments)}()];case 1:if(l=g.sent(),u=null==(s=t.getContext())?void 0:null===(o=s.currentUser)||void 0===o?void 0:o.id,d=null==s?void 0:null===(a=s.repl)||void 0===a?void 0:a.id,f=window.location.href,p={userEvent:{eventName:e,eventData:function e(t){if(!("object"==typeof t&&null!==t&&null!==Object.getPrototypeOf(t)))throw Error("encodeBareStruct must be called with a plain object");return{fields:Object.entries(t).reduce(function(t,n){var r=(0,v._)(n,2),i=r[0],o=r[1];return void 0===o||"object"==typeof o&&o&&0===Object.keys(o).length?t:(0,t_._)((0,m._)({},t),(0,t4._)({},i,function t(n){switch(void 0===n?"undefined":(0,t3._)(n)){case"string":return{kind:"stringValue",stringValue:n};case"number":return{kind:"numberValue",numberValue:n};case"boolean":return{kind:"boolValue",boolValue:n};case"object":if(null===n)return{kind:"nullValue",nullValue:null};if(Array.isArray(n))return{kind:"listValue",listValue:{values:n.map(t)}};return{kind:"structValue",structValue:e(n)};default:throw Error("Unexpected value: ".concat(n))}}(o)))},{})}}((0,m._)({userId:u,replId:d,url:f},r))}},"open"!==l.status)return ec.$e(function(e){e.setTag("service","user-events"),e.setExtra("command",p),e.setExtra("userId",u),e.setExtra("replId",d),e.setExtra("url",f),e.setExtra("channelId",l.id),ec.Tb(Error("UserEvents channel is not open: ".concat(l.status)))}),[2];return i.emit(h.EVENT_SENT,e,r),l.send(p),[2]}})})).apply(this,arguments)}function c(){return(c=(0,p._)(function(){return(0,g.Jh)(this,function(e){return o?[2,o]:[2,new Promise(function(e){i.once(h.CHANNEL_OPENED,function(t){e(t)})})]})})).apply(this,arguments)}return a("meta:start",{}),t.openChannel({service:"null",skip:function(){return!n}},function(e){var t=e.channel;return a("meta:ready",{}),o=t,i.emit(h.CHANNEL_OPENED,t),function(){o=null}}),{emit:a}}({container:e4=(0,R.ZP)({riverCtx:eD,onUnrecoverableError:eA,onFirewallDenied:eH,ctx:e1}),enabled:!!(void 0!==ez&&ez)}),e9=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,T.ZP)();t.setMaxListeners(1e3);var n=null,r={openFiles:[],activeTab:0};function i(e){tk()(r,e)||(r=e,t.emit(f.SESSION_STATE_CHANGED,r))}return{onSessionStateChanged:function(e){return t.on(f.SESSION_STATE_CHANGED,e),function(){t.removeListener(f.SESSION_STATE_CHANGED,e)}},onDeeplinkUpdated:function(e){return t.on(f.DEEPLINK_CHANGED,e),n&&(e(n),n=null),function(){t.removeListener(f.DEEPLINK_CHANGED,e)}},openFile:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e.openFile){e.openFile({path:t,newTab:n.newTab,newPane:n.newPane,newPaneEdge:n.newPaneEdge,col:n.col,line:n.line});return}var o=n.tabIndex,a=n.newTab;if(void 0!==o){!function(e,t){var n=t||r.openFiles.length;if(e<0||e>=n||!Number.isInteger(e))throw Error("Invalid index: ".concat(e,". Index must be an integer between 0 and ").concat(n))}(o,r.openFiles.length+1);var l=r.openFiles.slice(),c=r.openFiles.indexOf(t);if(-1===c){l.splice(o,1,t),i({openFiles:l,activeTab:l.indexOf(t)});return}if(c===o){i((0,t_._)((0,m._)({},r),{activeTab:l.indexOf(t)}));return}l.splice(c,1),l.splice(o,0,t);var s=l.indexOf(t);i({openFiles:l,activeTab:s});return}if(r.openFiles.includes(t)){i((0,t_._)((0,m._)({},r),{activeTab:r.openFiles.indexOf(t)}));return}var u=r.openFiles.slice();if(a){var d=0===u.length?0:r.activeTab+1;u.splice(d,0,t),i({openFiles:u,activeTab:d});return}var f=r.activeTab;u.splice(f,1,t),i({openFiles:u,activeTab:f})},updateDeeplink:function(e){t.emit(f.DEEPLINK_CHANGED,e),n=e},getActiveFile:function(){var e=r.openFiles,t=r.activeTab;if(0!==e.length)return e[t]},getState:function(){return r}}}({openFile:eN}),te=(0,I.Z)({container:e4,channelRequestPriority:null==eV?void 0:eV.fs}),tt=function(e){var t=e.container,n=e.onCommand,r=e.getColorForUser,i=(0,T.ZP)();i.setMaxListeners(1/0);var o=[],a=null,l=[],c={},s=null;function u(){return f.apply(this,arguments)}function f(){return(f=(0,p._)(function(){return(0,g.Jh)(this,function(e){return s?[2,s]:[2,new Promise(function(e){i.once(d.USERS_UPDATE,function(){if(!s)throw Error("Expected presenceChannel to be set");e(s)})})]})})).apply(this,arguments)}function h(e){tk()(a,e)||(a=e,i.emit(d.FOLLOWED_USER_CHANGED,e))}function m(){return(m=(0,p._)(function(e){var t,n;return(0,g.Jh)(this,function(r){switch(r.label){case 0:if((null==a?void 0:a.username)===e)throw Error("Already following user with username ".concat(e));if(!a)return[3,2];return[4,v()];case 1:r.sent(),r.label=2;case 2:return[4,u()];case 3:if(t=r.sent(),!(n=o.find(function(t){return t.username===e})))return[2];return h(n),n.sessions.forEach(function(e){t.send({followUser:{session:e.id}})}),[2]}})})).apply(this,arguments)}function v(){return y.apply(this,arguments)}function y(){return(y=(0,p._)(function(){var e,t;return(0,g.Jh)(this,function(n){switch(n.label){case 0:if(!a)throw Error("No user to unfollow");return e=a,h(null),[4,u()];case 1:return t=n.sent(),e.sessions.forEach(function(e){t.send({unfollowUser:{session:e.id}})}),[2]}})})).apply(this,arguments)}return t.openChannel({service:"presence",name:"presencer"},function(e){var t=e.channel;return t.onCommand(function(e){null==n||n(e);var t={cmd:e,emitter:i,activeUsers:o,userIdToFile:c,followedUser:a,setFollowedUser:h,followingUsers:l,getColorForUser:r};switch(e.body){case"roster":!function(e){var t=e.cmd,n=e.emitter,r=e.activeUsers,i=e.userIdToFile,o=e.followedUser,a=e.followingUsers,l=e.setFollowedUser,c=e.getColorForUser,s=t.roster;if(s){var u=s.user,f=s.files;if(u&&f){var h=new Set;if(r.splice(0,r.length),u.forEach(function(e){if(!(!e.id||!e.name||!e.roles||h.has(e.id))){var t=f.filter(function(t){return t.userId===e.id}).map(function(e){if(!e.session||!e.timestamp)throw Error("Expected session and associated with user");return{id:e.session,activeFile:e.file||null,timestamp:(0,tY.gs)(e.timestamp)}}),n=null==c?void 0:c({userId:e.id});r.push({id:e.id,username:e.name,roles:e.roles,color:null!=n?n:(0,tY.i7)(r),sessions:t}),h.add(e.id)}}),r.forEach(function(e){i[e.id]=(0,tY.f0)(e)}),n.emit(d.USERS_UPDATE,(0,el._)(r)),a.filter(function(e){return!r.some(function(t){return t.id===e.id})}).forEach(function(e){var t=a.indexOf(e);-1!==t&&(a.splice(t,1),n.emit(d.FOLLOWING_USERS_CHANGED,{followingUsers:(0,el._)(a),user:e,type:"unfollow"}))}),o){if(!r.some(function(e){return e.id===o.id})){l(null);return}var p=i[o.id];n.emit(d.USER_OPENED_FILE,{user:o,file:p})}}}}(t);break;case"join":!function(e){var t=e.cmd,n=e.emitter,r=e.activeUsers,i=e.userIdToFile,o=e.getColorForUser,a=t.join;if(a.id&&a.name&&a.roles&&a.session){var l=r.find(function(e){return e.id===a.id}),c=Math.floor(Date.now()/1e3),s=b.google.protobuf.Timestamp.create({seconds:c}),u=(0,tY.gs)(s);if(l)l.sessions.push({id:a.session,activeFile:null,timestamp:u});else{var f=null==o?void 0:o({userId:a.id}),h={id:a.id,username:a.name,roles:a.roles,color:null!=f?f:(0,tY.i7)(r),sessions:[{id:a.session,activeFile:null,timestamp:u}]};i[a.id]=null,r.push(h),n.emit(d.USER_JOIN,h),n.emit(d.USERS_UPDATE,(0,el._)(r))}}}(t);break;case"part":!function(e){var t=e.cmd,n=e.emitter,r=e.activeUsers,i=e.userIdToFile,o=e.followedUser,a=e.followingUsers,l=e.setFollowedUser;if(t.part&&t.part.id&&t.part.session){var c=t.part,s=c.id,u=c.session,f=r.findIndex(function(e){return e.id===s}),h=r[f];if(1===h.sessions.length){r.splice(f,1),delete i[h.id],n.emit(d.USER_LEAVE,h),n.emit(d.USERS_UPDATE,(0,el._)(r)),o&&l(null);var p=a.findIndex(function(e){return e.id===h.id});-1!==p&&(a.splice(p,1),n.emit(d.FOLLOWING_USERS_CHANGED,{followingUsers:(0,el._)(a),user:h,type:"unfollow"}))}else{h.sessions=h.sessions.filter(function(e){return e.id!==u});var m=(0,tY.f0)(h);i[h.id]!==m&&(i[h.id]=m,n.emit(d.USER_OPENED_FILE,{user:h,file:m}))}}}(t);break;case"fileOpened":!function(e){var t=e.emitter,n=e.cmd,r=e.activeUsers,i=e.userIdToFile;if(n.fileOpened){var o=n.fileOpened,a=o.userId,l=o.file,c=o.timestamp,s=o.session,u=l||null;if(!a||!c)throw Error("Expected userId and timestamp associated with file opened command");var f=r.find(function(e){return e.id===a});if(!f)throw Error("Expected user with ID ".concat(a));var h=f.sessions.find(function(e){return e.id===s});if(!h)throw Error("Expected session with ID ".concat(h));h.activeFile=u,h.timestamp=(0,tY.gs)(c),i[a]=u,t.emit(d.USER_OPENED_FILE,{user:f,file:u})}}(t);break;case"followUser":!function(e){var t=e.cmd,n=e.emitter,r=e.activeUsers,i=e.followingUsers,o=t.followUser;if(!o.session)throw Error("Expected session associated with follow user");var a=o.session,l=(0,tY.N5)(a,r);i.some(function(e){return e.id===l.id})||(i.push(l),n.emit(d.FOLLOWING_USERS_CHANGED,{followingUsers:(0,el._)(i),user:l,type:"follow"}))}(t);break;case"unfollowUser":!function(e){var t=e.cmd,n=e.emitter,r=e.activeUsers,i=e.followingUsers,o=t.unfollowUser;if(!o.session)throw Error("Expected session associated with follow user");var a=o.session,l=(0,tY.N5)(a,r),c=i.findIndex(function(e){return e.id===l.id});-1!==c&&(i.splice(c,1),n.emit(d.FOLLOWING_USERS_CHANGED,{followingUsers:(0,el._)(i),user:l,type:"unfollow"}))}(t);break;case"sessionTimestampUpdated":!function(e){var t=e.cmd,n=e.emitter,r=e.activeUsers,i=e.userIdToFile,o=t.sessionTimestampUpdated;if(!o.session||!o.timestamp)throw Error("Expected session and tiemstamp associated with update");var a=o.session,l=(0,tY.N5)(a,r),c=i[l.id],s=l.sessions.find(function(e){return e.id===a});if(!s)throw Error("Expected user ".concat(l.id," to have a session with ID ").concat(a));s.timestamp=(0,tY.gs)(o.timestamp);var u=s.activeFile;u!==c&&(i[l.id]=u,n.emit(d.USER_OPENED_FILE,{user:l,file:u}))}(t)}}),s=t,function(){s=null}}),{onUserLeave:function(e){return i.on(d.USER_LEAVE,e),function(){i.removeListener(d.USER_LEAVE,e)}},onUserJoin:function(e){return i.on(d.USER_JOIN,e),function(){i.removeListener(d.USER_LEAVE,e)}},onActiveUsersChange:function(e){return i.on(d.USERS_UPDATE,e),function(){i.removeListener(d.USERS_UPDATE,e)}},onUserOpenedFile:function(e){return i.on(d.USER_OPENED_FILE,e),function(){i.removeListener(d.USER_OPENED_FILE,e)}},onFollowedUserChanged:function(e){return i.on(d.FOLLOWED_USER_CHANGED,e),function(){i.removeListener(d.FOLLOWED_USER_CHANGED,e)}},onFollowingUsersChanged:function(e){return i.on(d.FOLLOWING_USERS_CHANGED,e),function(){i.removeListener(d.FOLLOWING_USERS_CHANGED,e)}},getActiveFileForUser:function(e){var t=c[e];if(void 0===t)throw Error("Expected file for user with ID ".concat(e," to be defined"));return t},updateOpenFile:function(e){return(0,p._)(function(){return(0,g.Jh)(this,function(t){switch(t.label){case 0:return[4,u()];case 1:return t.sent().send({openFile:{file:e}}),[2]}})})()},updateSessionTimestamp:function(){return(0,p._)(function(){return(0,g.Jh)(this,function(e){switch(e.label){case 0:return[4,u()];case 1:return e.sent().send({updateSessionTimestamp:{}}),[2]}})})()},followUser:function(e){return m.apply(this,arguments)},unfollowUser:v,getActiveUsers:function(){return o},getFollowedUser:function(){return a},getFollowingUsers:function(){return l},getUserIdToFile:function(){return c},getPathToUserIds:function(){var e=new Map;return o.forEach(function(t){var n=t.id,r=c[n];r&&function t(n,r){if(""!==n){e.has(n)||e.set(n,[]);var i,o=e.get(n);if(!o)throw Error("Expected user Ids");o.some(function(e){return e===r})||(null===(i=e.get(n))||void 0===i||i.push(r),t((0,eM.Il)(n),r))}}(r,n)}),e}}}({container:e4,onCommand:e$,getColorForUser:eJ}),tn=(0,S.Z)({container:e4,fs:te,channelRequestPriority:null==eV?void 0:eV.dotReplit,ctx:e1}),tr=function(e){var t,n,r,i=e.container,o=(0,T.ZP)(),a=null;function l(){return c.apply(this,arguments)}function c(){return(c=(0,p._)(function(){return(0,g.Jh)(this,function(e){return a&&"open"===a.status?[2,a]:[2,new Promise(function(e){o.once(u.CHANNEL_OPENED,function(t){e(t)})})]})})).apply(this,arguments)}function s(){return d.apply(this,arguments)}function d(){return(d=(0,p._)(function(){return(0,g.Jh)(this,function(e){return[2,(0,tq.Y)({container:i,service:"nix"})]})})).apply(this,arguments)}return i.openChannel({service:"nix"},function(e){var t=e.channel;return a=t,o.emit(u.CHANNEL_OPENED,t),function(){a=null}}),{searchPackages:(t=(0,p._)(function(e){var t,n,r,i;return(0,g.Jh)(this,function(o){switch(o.label){case 0:return[4,s()];case 1:return n=(t=v._.apply(void 0,[o.sent(),2]))[0],r=t[1],[4,n.request({nixPackageSearchRequest:{query:e}})];case 2:if((i=o.sent()).channelClosed)return[2,{error:"Channel closed",packages:null}];if(r(),i.error)return[2,{error:i.error,packages:null}];if(!i.nixPackageSearchResponse)return[2,{error:"Response expected but none received",packages:null}];return[2,{packages:i.nixPackageSearchResponse.packages,error:null}]}})}),function(e){return t.apply(this,arguments)}),listPackages:(0,p._)(function(){var e,t,n,r;return(0,g.Jh)(this,function(i){switch(i.label){case 0:return[4,s()];case 1:return t=(e=v._.apply(void 0,[i.sent(),2]))[0],n=e[1],[4,t.request({nixPackageListRequest:{}})];case 2:if((r=i.sent()).channelClosed)return[2,{error:"Channel closed",packages:null}];if(n(),r.error)return[2,{error:r.error,packages:null}];if(!r.nixPackageListResponse)return[2,{error:"Response expected but none received",packages:null}];return[2,{packages:r.nixPackageListResponse.packages,error:null}]}})}),getChannels:(0,p._)(function(){var e,t,n,r;return(0,g.Jh)(this,function(i){switch(i.label){case 0:return[4,s()];case 1:return t=(e=v._.apply(void 0,[i.sent(),2]))[0],n=e[1],[4,t.request({nixChannelsRequest:{}})];case 2:if((r=i.sent()).channelClosed)return[2,{error:"Channel closed",channels:null}];if(n(),r.error)return[2,{error:r.error,channels:null}];if(!r.nixChannelsResponse)return[2,{error:"Response expected but none received",channels:null}];return[2,{channels:r.nixChannelsResponse.channels,error:null}]}})}),getLatestStableChannel:(0,p._)(function(){var e,t,n,r;return(0,g.Jh)(this,function(i){switch(i.label){case 0:return[4,s()];case 1:return t=(e=v._.apply(void 0,[i.sent(),2]))[0],n=e[1],[4,t.request({nixChannelLatestStableRequest:{}})];case 2:if((r=i.sent()).channelClosed)return[2,{error:"Channel closed",channel:null}];if(n(),r.error)return[2,{error:r.error,channel:null}];if(!r.nixChannelLatestStableResponse)return[2,{error:"Response expected but none received",channel:null}];return[2,{channel:r.nixChannelLatestStableResponse.channel,error:null}]}})}),addPackages:(n=(0,p._)(function(e){var t;return(0,g.Jh)(this,function(n){switch(n.label){case 0:return[4,l()];case 1:return[4,n.sent().request({nixPackageAddRequest:{packages:e}})];case 2:if((t=n.sent()).channelClosed)return[2,"channel closed"];if(t.error)return[2,t.error];if(!t.nixPackageAddResponse)return[2,"response expected but non received"];return[2,null]}})}),function(e){return n.apply(this,arguments)}),removePackages:(r=(0,p._)(function(e){var t;return(0,g.Jh)(this,function(n){switch(n.label){case 0:return[4,l()];case 1:return[4,n.sent().request({nixPackageRemoveRequest:{packages:e}})];case 2:if((t=n.sent()).channelClosed)return[2,"channel closed"];if(t.error)return[2,t.error];if(!t.nixPackageRemoveResponse)return[2,"response expected but non received"];return[2,null]}})}),function(e){return r.apply(this,arguments)})}}({container:e4}),ti=(0,k.Z)({container:e4,dotReplit:tn}),to=(0,E.Z)({container:e4,forceTrace:eQ,track:Z.j}),ta=(r=(n={container:e4,fs:te,openMultipleFiles:eL,openMultipleURLs:eF}).container,i=n.fs,o=n.openMultipleFiles,a=n.openMultipleURLs,l=new Set,s=!1,x=null,r.openChannel({service:"open"},function(e){e.channel.onCommand(function(e){if("replspaceApiOpenMultipleFiles"===e.body){if(!e.replspaceApiOpenMultipleFiles)throw Error("Expected replspaceApiOpenMultipleFiles");var t=e.replspaceApiOpenMultipleFiles,n=t.files,r=t.urls;o&&n.length>0&&(t1(),o({paths:n})),a&&r.length>0&&(t1(),a({urls:r}))}})}),r.openChannel({service:"git"},function(e){var t,n=e.channel;return n.onCommand((t=(0,p._)(function(e){var t,r,a,c,u,d,f,h,p,m,v,y,b,Z,w,C;return(0,g.Jh)(this,function(g){switch(g.label){case 0:switch(e.body){case"replspaceApiOpenFile":return[3,1];case"replspaceApiGetGitHubToken":return[3,7]}return[3,9];case 1:if(!e.replspaceApiOpenFile)throw Error("Expected replspaceApiOpenFile");if(r=(t=e.replspaceApiOpenFile).file,a=t.waitForClose,c=t.nonce,o)return[3,3];if(!r.endsWith(".git/COMMIT_EDITMSG"))return a&&n.send({replspaceApiCloseFile:{file:r,nonce:c}}),window.alert("tried to open ".concat(r," but failed")),[2];return u=window.prompt("Enter a commit message"),[4,i.writeFile(r,null!=u?u:"")];case 2:if(g.sent(),!a)return[2];return[3,5];case 3:if(t1(),o({paths:[r]}),!a||!x)return[2];return[4,x(r)];case 4:g.sent(),g.label=5;case 5:return[4,i.flush()];case 6:if(g.sent(),"open"!==n.status)return[2];return n.send({replspaceApiCloseFile:{file:r,nonce:c}}),[2];case 7:if(!e.replspaceApiGetGitHubToken)throw Error("Expected replspaceApiGetGitHubToken");return d=function(){var t;"open"===n.status&&n.send({replspaceApiGitHubToken:{token:"",nonce:null===(t=e.replspaceApiGetGitHubToken)||void 0===t?void 0:t.nonce}})},[4,function(){return t0.apply(this,arguments)}()];case 8:if(null==(f=g.sent()).gitHubInfo)return d(),[2];if(!l.size)return d(),es.kg.error("Got a replspaceApiGetGitHubToken command but no confirm listener is set up"),[2];if(h=function(){var t,r;"open"===n.status&&n.send({replspaceApiGitHubToken:{token:null===(t=f.gitHubInfo)||void 0===t?void 0:t.accessToken,nonce:null===(r=e.replspaceApiGetGitHubToken)||void 0===r?void 0:r.nonce}})},s)return h(),[2];p=!1,m=function(){var e=!0,t=!1,n=void 0;try{for(var r,i=l[Symbol.iterator]();!(e=(r=i.next()).done);e=!0)(0,r.value)(null)}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}},v=!0,y=!1,b=void 0;try{for(Z=l[Symbol.iterator]();!(v=(w=Z.next()).done)&&(C=w.value,!p);v=!0)C(function(e){var t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(!p){if(p=!0,!e){d(),m();return}t&&(s=e),h(),m()}})}catch(e){y=!0,b=e}finally{try{v||null==Z.return||Z.return()}finally{if(y)throw b}}g.label=9;case 9:return[2]}})}),function(e){return t.apply(this,arguments)})),function(){}}),r.openChannel({service:"shelltracker"},function(e){e.channel.onCommand(function(e){null!=e.replspaceApiShellTracker&&(0,Z.j)(Z.U3.SHELL_COMMAND_EVALED,{context:e.replspaceApiShellTracker.cmd,api:"replspace",pwd:e.replspaceApiShellTracker.pwd})})}),{onConfirmSendToken:function(e){var t=function(t){return e(t)};return l.add(t),function(){l.delete(t)}},setWaitForFileClose:function(e){x=e}}),tl=(G=(0,p._)(function(e,t){var n;return(0,g.Jh)(this,function(r){var i;return n=(null==t?void 0:t.ctx)||y.D.active(),[2,(0,_.nO)(n,"beforeRun",(i=(0,p._)(function(n){var r,i,o,a,l,c,s,u,d,f,h,p,v,y,w,x;return(0,g.Jh)(this,function(g){switch(g.label){case 0:return[4,(0,_.nO)(n,"toolchain.getConfigs",function(){return ti.getConfigs()})];case 1:if((r=g.sent()).disableInstallBeforeRun)return[2];return i=(0,m._)({},t),delete i.ctx,e5.emit("user:run:prerun",(0,m._)({runnerMode:eB},i)),[4,(0,_.nO)(n,"fs.flush",function(){return te.flush({consistency:b.api.Flush.Consistency.Disk})})];case 2:if(g.sent(),e&&e("prerun flush finished"),!(null==r?void 0:r.packagers))return[3,10];o=!0,a=!1,l=void 0,g.label=3;case 3:g.trys.push([3,8,9,10]),c=r.packagers[Symbol.iterator](),g.label=4;case 4:if(o=(s=c.next()).done)return[3,7];if(!(u=s.value).guessImports)return[3,6];return d=performance.now(),f=r.disableGuessImports,[4,to.installPackages(n,u.id,f)];case 5:h=g.sent(),p=performance.now()-d,e&&(h.error?e("prerun packager install finished",{packagerId:u.id,language:u.language,errorMessage:h.error,success:!1}):(w=(y=(null==(v=h.value)?void 0:v.guessedPkgs)||[]).length,e("prerun packager install finished",{packagerId:u.id,language:u.language,guessedPkgs:y,guessedPkgsCount:w,guessedAnyPkgs:w>0,upmGuessDurationMs:null==v?void 0:v.upmGuessDurationMs,upmAddDurationMs:null==v?void 0:v.upmAddDurationMs,upmLockDurationMs:null==v?void 0:v.upmLockDurationMs,backendTotalDurationMs:null==v?void 0:v.totalDurationMs,frontendTotalDurationMs:p,success:!0}),w>0&&(0,Z.j)(C.U3.PACKAGER_PACKAGES_GUESSED,{packages:y}))),g.label=6;case 6:return o=!0,[3,4];case 7:return[3,10];case 8:return x=g.sent(),a=!0,l=x,[3,10];case 9:try{o||null==c.return||c.return()}finally{if(a)throw l}return[7];case 10:return e5.emit("user:run:initiate",{}),[2]}})}),function(e){return i.apply(this,arguments)}))]})}),function(e,t){return G.apply(this,arguments)}),tc=(0,D.Z)({container:e4,beforeRun:tl}),tu=(0,w.TE)({container:e4,dotReplit:tn,enableBetterPortHandling:void 0!==eq&&eq}),tf=(0,t2.Z)({mode:eB,container:e4,toolchain:ti,beforeRun:tl,packager:to,debuggest:tc}),ty=(P=(0,T.ZP)(),U=new Promise(function(e){return A=e}),X=null,H=new Map,e4.openChannel({service:"chat",name:"broadcaster"},function(e){var t=e.channel,n=e.context;return n.currentUser&&(X=n.currentUser.username),t.onCommand(function(e){if("chatMessage"===e.body){var t=e.chatMessage;if(!t||!t.username||!t.text)throw Error("unexpected broadcast without a message");P.emit(c.MESSAGE_RECEIVED,{text:t.text,username:t.username})}}),A(t),function(){U=new Promise(function(e){return A=e})}}),{broadcastMessage:function(e,t){var n=t.text;return(0,p._)(function(){var t,r,i,o,a,l,c,s,u,d;return(0,g.Jh)(this,function(f){switch(f.label){case 0:return[4,U];case 1:if(t=f.sent(),!X)throw Error("Cannot broadcast without as username. Is currentUser in context?");r={text:n,username:X},i=!0,o=!1,a=void 0;try{for(l=H[Symbol.iterator]();!(i=(c=l.next()).done);i=!0)u=(s=(0,v._)(c.value,2))[0],d=s[1],u!==e&&d(r)}catch(e){o=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw a}}return t.send({chatMessage:r}),[2]}})})()},onBroadcastReceived:function(e,t){return H.set(e,t),P.on(c.MESSAGE_RECEIVED,t),function(){P.removeListener(c.MESSAGE_RECEIVED,t),H.delete(e)}}}),tw=function(e){var t=e.container,n=e.toolchain,r=e.fs,i=new Map,o=new Map,a={},l=!0;function c(e){var t=a[e];if(!t)throw Error("LSPNix: removeLanguage called with lspId never configured");var n=t.client;if(n){t.client=null,n.destroy();var r=!0,l=!1,c=void 0;try{for(var s,u=i[Symbol.iterator]();!(r=(s=u.next()).done);r=!0){var d=(0,v._)(s.value,2),f=d[0],h=d[1];if(o.get(f)===n){o.delete(f);var p=!0,m=!1,g=void 0;try{for(var y,b=h[Symbol.iterator]();!(p=(y=b.next()).done);p=!0)(0,y.value)(null)}catch(e){m=!0,g=e}finally{try{p||null==b.return||b.return()}finally{if(m)throw g}}}}}catch(e){l=!0,c=e}finally{try{r||null==u.return||u.return()}finally{if(l)throw c}}}t.closeChannel(),delete a[e]}function s(e,t){if(a[e])throw Error("LSPNix: addLanguage called with lspId already configured");a[e]={client:null,option:t,closeChannel:function(){}},l&&h(e)}var u=new Map;function d(e){if(!l)return!1;var t=a[e];return!!t&&!t.client}function f(e,t,n){new Date().getTime()-n.getTime()<5e3?t<3?setTimeout(function(){d(e)&&h(e,t+1)},1e3*Math.pow(2,t)):es.kg.error("LSP server is crash-looping. Giving up.",{lspId:e,appService:"lspnix"}):setTimeout(function(){d(e)&&h(e)})}function h(e){return y.apply(this,arguments)}function y(){return(y=(0,p._)(function(e){var n,c,s,d,h,y,Z,w,x=arguments;return(0,g.Jh)(this,function(C){switch(C.label){case 0:if(n=x.length>1&&void 0!==x[1]?x[1]:0,!l)throw Error("LSPNix: Called startClient while not enabled");if(!a[e])throw Error("LSPNix: No config found for lspId: ".concat(e));if(!u.get(e))return[3,2];return[4,u.get(e)];case 1:if(C.sent())return[2];C.label=2;case 2:if(s=(c=a[e]).client,c.closeChannel,d=c.option,s)throw Error("LSPNix: A previous client is already set for language: ".concat(e));return h=function(){},y=new Promise(function(e){h=e}),u.set(e,y),Z=[],w=t.openChannel({service:"lsp2",skip:function(e){var t=e.repl.language,n=t.startsWith("nix")||t.startsWith("html");return n||(es.kg.error("Skipped opening lsp channel for non-nix repl",{language:t,appService:"lspnix"}),h(null)),!n}},function(c){var s=c.channel,y=null,x=!1,C=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!x){x=!0,t||(h(null),u.delete(e)),Z.forEach(function(e){return e()}),null==y||y.destroy(),(null===(s=a[e])||void 0===s?void 0:s.client)===y&&(a[e].client=null),t&&l||w();var n=!0,r=!1,c=void 0;try{for(var s,d,f=i[Symbol.iterator]();!(n=(d=f.next()).done);n=!0){var p=(0,v._)(d.value,2),m=p[0],g=p[1];if(o.get(m)===y){o.delete(m);var b=!0,C=!1,_=void 0;try{for(var S,E=g[Symbol.iterator]();!(b=(S=E.next()).done);b=!0)(0,S.value)(null)}catch(e){C=!0,_=e}finally{try{b||null==E.return||E.return()}finally{if(C)throw _}}}}}catch(e){r=!0,c=e}finally{try{n||null==f.return||f.return()}finally{if(r)throw c}}}};if("open"!==s.status){es.kg.error("LSPNix got a channel that wasn't open. This is expected to be impossible.",{lspId:e,appService:"lspnix"});return}var _=new Date;return s.request({startLSP:{languageServerId:e}}).then(function(c){if(!c.ok){es.kg.error("LSP server failed to start",{lspId:e,appService:"lspnix",serverError:c.error});return}if(l&&a[e]){Z.push(s.onCommand(function(t){t.state===b.api.State.Stopped&&(es.kg.error("LSP server unexpectedly disconnected",{lspId:e,appService:"lspnix"}),C(),l&&f(e,n,_))}));var w=0;tz(t,function(){return w++<5&&l&&tV(a[e].option,d)&&"open"===s.status}).then(function(t){if(!tV(a[e].option,d)){es.kg.info("LSPNix: configuration changed while getting working directory",{lspId:e,appService:"lspnix"});return}if("open"!==s.status){es.kg.error("LSPNix: channel wasn't open after getting working directory",{lspId:e,appService:"lspnix"});return}if(t.error){es.kg.error("LSPNix: failed to get working directory",{lspId:e,appService:"lspnix",originalError:null===(w=t.error)||void 0===w?void 0:w.message});return}if(y=function(e){var t,n=e.connection,r=e.isSupportedFile,i=e.clientId,o=e.clientName,a=e.getWorkspaceConfiguration,l=e.onWorkspaceConfigurationChange,c=e.applyWorkspaceEdit,s=(0,T.ZP)();s.setMaxListeners(1/0);var u=null,d=tA.a.OFFLINE,f=tA.N.NOT_READY,h=null,v=!1,y=new Map,b=new Map,Z=null;function w(e){if(!u)throw Error("Expected rootUri");var t=e.slice(u.length+1);try{return decodeURIComponent(t)}catch(e){throw ec.$e(function(n){n.setExtra("fragment_to_decode",t),ec.Tb(e)}),e}}function x(e){if(!u)throw Error("Expected rootUri");if(e.startsWith("/"))throw Error("Path must be relative. Got: ".concat(e));return u+"/"+e}function C(e){d!==e&&(d!==tA.a.INITIALIZED&&_(tA.N.NOT_READY),d=e,s.emit("SERVER_STATE_CHANGE",d))}function _(e){f!==e&&(f=e,s.emit("SERVER_HEALTH_CHANGE",f))}function S(e){s.emit("SEND_NOTIFICATION",e),n.write(tH(e))}function E(e){return k.apply(this,arguments)}function k(){return(k=(0,p._)(function(e){var t,r,o,a,l,c,u,f;return(0,g.Jh)(this,function(h){if(a=void 0===(o=(r=void 0===(t=e.options)?{}:t).id)?tW():o,l=r.signal,c=r.tap,u=(0,tS._)(e,["options"]),!Number.isInteger(a))throw Error("Request ID must be an integer");return n.didClose()?[2,Promise.resolve({result:null,cancelled:!0})]:(s.emit("REQUEST",{id:a,data:u}),null==l||l.addEventListener("abort",function(){D(a)},{once:!0}),n.write(tH((0,t_._)((0,m._)({},u),{id:a}))),null===Z&&(Z=setTimeout(function(){_(tA.N.STALLED)},3e4)),f=new Promise(function(e){b.set(a,e)}),c&&c(f),[2,f.then(function(e){return null!==Z&&(clearTimeout(Z),Z=null),d!==tA.a.INITIALIZED||e.cancelled||_(tA.N.READY),(function(e){var t=!0,n=!1,r=void 0;try{for(var i,o=tU[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;if(a.supports(e))return a}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}return new tO})(i).onResponse(u.method,e)})])})})).apply(this,arguments)}function R(e,t){n.write(tH((0,t_._)((0,m._)({},t),{id:e})))}function D(e){var t=b.get(e);t&&(s.emit("CANCEL_REQUEST",e),t({result:null,cancelled:!0}),b.delete(e),S({method:"$/cancelRequest",params:{id:e}}))}var I=0,G=new tB.s(function(e){var t=b.get(e.id);if(e.id&&t){b.delete(e.id);var n=e.result,r=e.error;if((void 0!==n||r)&&s.emit("RESPONSE",e),void 0!==n){I=0,t({result:n,cancelled:!1});return}if(r){I++;var o=r.code,l=r.message,u=r.data;es.kg.error("LSP request failed",{code:o,lspId:i,errorMessage:l,data:JSON.stringify(u)}),t({error:r}),I>20&&(es.kg.error("LSP experienced 20 consecutive errors. Setting server health to 'BROKEN",{lspId:i}),_(tA.N.BROKEN),I=0);return}throw es.kg.error("LSP response message contained neither error nor result"),new tL.Z("Expected either message or error in LSP response").setExtra("message",JSON.stringify(e))}var d=e.method;if("client/registerCapability"===d){var f=e.params.registrations;if(!f||!Array.isArray(f))throw Error("Expected registrations array");f.forEach(function(e){var t=e.method;if(!t)throw Error("Expected registration method");if(!h)throw Error("Expected server capabilities");var n=e.registerOptions||!0;switch(t){case"textDocument/definition":h.definitionProvider=!0;break;case"textDocument/typeDefinition":h.typeDefinitionProvider=!0;break;case"textDocument/implementation":h.implementationProvider=!0;break;case"textDocument/references":h.referencesProvider=!0;break;case"textDocument/hover":h.hoverProvider=!0;break;case"textDocument/completion":h.completionProvider=n;break;case"textDocument/formatting":h.documentFormattingProvider=n;break;case"textDocument/rename":h.renameProvider=n;break;case"textDocument/codeAction":h.codeActionProvider=n;break;case"textDocument/signatureHelp":h.signatureHelpProvider=n;break;case"textDocument/didSave":if("number"==typeof h.textDocumentSync)break;h.textDocumentSync=(0,t_._)((0,m._)({},h.textDocumentSync||{}),{save:n});break;case"textDocument/willSaveWaitUntil":if("number"==typeof h.textDocumentSync)break;h.textDocumentSync=(0,t_._)((0,m._)({},h.textDocumentSync||{}),{willSave:!0});break;case"textDocument/didChange":if("number"==typeof h.textDocumentSync)break;h.textDocumentSync=(0,t_._)((0,m._)({},h.textDocumentSync||{}),{change:n});break;case"textDocument/didOpen":case"textDocument/didClose":if("number"==typeof h.textDocumentSync)break;h.textDocumentSync=(0,t_._)((0,m._)({},h.textDocumentSync||{}),{openClose:!0});break;case"workspace/executeCommand":h.executeCommandProvider=n;break;default:es.kg.info("Unexpected dynamically registered capability in LSP client",{method:t})}s.emit("SERVER_CAPABILITIES_CHANGE",h)}),R(e.id,{result:null,cancelled:!1});return}if("workspace/applyEdit"===d){var p=c(e.params);R(e.id,{result:p,cancelled:!1});return}if("textDocument/publishDiagnostics"===d){var v=w(e.params.uri),g=y.get(v);if(!g)return;var Z=e.params.diagnostics;if(tk()(g.diagnostics,Z))return;g.diagnostics=Z,s.emit("DIAGNOSTICS",{path:v,diagnostics:Z});return}if("workspace/configuration"===d){var x,C=e.params,S=Array(C.items.length).fill(null),E=null!==(x=null==a?void 0:a())&&void 0!==x?x:null;E&&(S=C.items.map(function(e){return e.section?tR()(E,e.section):E})),R(e.id,{result:S,cancelled:!1})}});function B(e){if(!h)throw Error("Expected client to be initialized");if(!h[e])throw Error("LSP Server does not support ".concat(e.replace(/Provider$/,"")));return h[e]}function A(e){return u&&e?e.filter(function(e){return"uri"in e?e.uri.startsWith(u):e.targetUri.startsWith(u)}):e}n.read(G.read);var P=function(){};return{initialize:function(e){var n=e.pwd,r=e.initializationOptions;return(0,p._)(function(){var e,i;return(0,g.Jh)(this,function(o){switch(o.label){case 0:return C(tA.a.INITIALIZING),u="file://".concat(n),[4,E({method:"initialize",params:{initializationOptions:r,capabilities:tG({configurationSupport:{serverToClient:!!a,clientToServer:!!l}}),processId:null,rootUri:u,workspaceFolders:[{name:u,uri:u}]}})];case 1:if("error"in(e=o.sent()))throw Error("Something went wrong initializing the LSP client: ".concat(e.error.message));if(e.cancelled)throw Error("Initialize request cancelled");if(!e.result)throw Error("Expected result in initialize request");return S({method:"initialized",params:{}}),h=e.result.capabilities,t=e.result.serverInfo,s.emit("SERVER_CAPABILITIES_CHANGE",h),C(tA.a.INITIALIZED),l&&(P=l(function(e){S({method:"workspace/didChangeConfiguration",params:{settings:e}})})),a&&(i=a())&&S({method:"workspace/didChangeConfiguration",params:{settings:i}}),[2]}})})()},generateId:tW,notify:{didOpen:function(e,t){if(!r(e))throw Error("Path not supported");var n,o=y.get(e);if(o&&0!==o.buffers){o.buffers++,y.set(e,o);return}var a=null!==(n=null==o?void 0:o.version)&&void 0!==n?n:0;y.set(e,{version:a,buffers:1,diagnostics:[]}),S({method:"textDocument/didOpen",params:{textDocument:{uri:x(e),languageId:tX(e,i),text:t,version:a}}})},didChange:function(e,t){var n=y.get(e);if(!n)throw Error('Document for "'.concat(e,'" is not open'));n.version++,S({method:"textDocument/didChange",params:{textDocument:{uri:x(e),version:n.version},contentChanges:t}})},didSave:function(e){if(!y.get(e))throw Error('Document for "'.concat(e,'" is not open'));B("textDocumentSync"),S({method:"textDocument/didSave",params:{textDocument:{uri:x(e)}}})},didClose:function(e){var t=y.get(e);if(!t)throw Error('Document for "'.concat(e,'" is not open'));t.buffers--,t.buffers>0||(S({method:"textDocument/didClose",params:{textDocument:{uri:x(e)}}}),y.delete(e))},cancelRequest:function(e){D(e)}},request:{completion:function(e,t,n,r){return B("completionProvider"),E({options:r,method:"textDocument/completion",params:{textDocument:{uri:x(e)},position:t,context:n}})},resolveCompletionItem:function(e){if(!B("completionProvider").resolveProvider)throw Error("LSP Server does not support resolving completion items");return E({method:"completionItem/resolve",params:e})},signatureHelp:function(e,t,n){return E({options:n,method:"textDocument/signatureHelp",params:{textDocument:{uri:x(e)},position:t}})},hover:function(e,t,n){return E({options:n,method:"textDocument/hover",params:{textDocument:{uri:x(e)},position:t}})},codeActions:function(e,t,n,r){var i=y.get(e);if(!i)throw Error("Document for path ".concat(e," is not open."));var o=i.diagnostics.filter(function(e){var n;return tF((n=e.range).start,t.end)&&tF(t.start,n.end)});return E({method:"textDocument/codeAction",params:{textDocument:{uri:x(e)},range:t,context:(0,t_._)((0,m._)({},r),{diagnostics:o})},options:n})},resolveCodeAction:function(e){return E({method:"codeAction/resolve",params:e})},executeCommand:function(e,t){return E({method:"workspace/executeCommand",params:{command:e,arguments:t}})},format:function(e,t){return B("documentFormattingProvider"),E({method:"textDocument/formatting",params:{textDocument:{uri:x(e)},options:t}})},formatRange:function(e,t,n){return B("documentRangeFormattingProvider"),E({method:"textDocument/rangeFormatting",params:{textDocument:{uri:x(e)},range:t,options:n}})},findDefinitions:function(e,t,n){var r=!(arguments.length>3)||void 0===arguments[3]||arguments[3];return(0,p._)(function(){var i,o;return(0,g.Jh)(this,function(a){switch(a.label){case 0:return B("definitionProvider"),[4,E({options:n,method:"textDocument/definition",params:{textDocument:{uri:x(e)},position:t}})];case 1:if(!1!==(i=a.sent()).cancelled)return[2,i];return(o=i.result)&&r&&(o=A(Array.isArray(o)?o:[o])),[2,(0,t_._)((0,m._)({},i),{result:o})]}})})()},findTypeDefinitions:function(e,t,n){var r=!(arguments.length>3)||void 0===arguments[3]||arguments[3];return(0,p._)(function(){var i,o;return(0,g.Jh)(this,function(a){switch(a.label){case 0:return B("typeDefinitionProvider"),[4,E({options:n,method:"textDocument/typeDefinition",params:{textDocument:{uri:x(e)},position:t}})];case 1:if(!1!==(i=a.sent()).cancelled)return[2,i];return(o=i.result)&&r&&(o=A(Array.isArray(o)?o:[o])),[2,(0,t_._)((0,m._)({},i),{result:o})]}})})()},findImplementations:function(e,t,n){var r=!(arguments.length>3)||void 0===arguments[3]||arguments[3];return(0,p._)(function(){var i,o;return(0,g.Jh)(this,function(a){switch(a.label){case 0:return B("implementationProvider"),[4,E({options:n,method:"textDocument/implementation",params:{textDocument:{uri:x(e)},position:t}})];case 1:if(!1!==(i=a.sent()).cancelled)return[2,i];return(o=i.result)&&r&&(o=A(Array.isArray(o)?o:[o])),[2,(0,t_._)((0,m._)({},i),{result:o})]}})})()},findReferences:function(e,t,n){return B("referencesProvider"),E({method:"textDocument/references",params:{textDocument:{uri:x(e)},position:t,context:n}})},rename:function(e,t,n,r){return B("renameProvider"),E({options:r,method:"textDocument/rename",params:{textDocument:{uri:x(e)},position:t,newName:n}})},prepareRename:function(e,t){var n=B("renameProvider");if("boolean"==typeof n||!n.prepareProvider)throw Error("LSP server does not support prepare rename");return E({method:"textDocument/prepareRename",params:{textDocument:{uri:x(e)},position:t}})},documentHighlights:function(e,t,n){return(0,p._)(function(){return(0,g.Jh)(this,function(r){switch(r.label){case 0:return[4,E({options:n,method:"textDocument/documentHighlight",params:{position:t,textDocument:{uri:x(e)}}})];case 1:return[2,r.sent()]}})})()},documentSymbol:function(e,t){return(0,p._)(function(){var n;return(0,g.Jh)(this,function(r){switch(r.label){case 0:return[4,E({options:t,method:"textDocument/documentSymbol",params:{textDocument:{uri:x(e)}}})];case 1:if(!("result"in(n=r.sent())))return[2,n];if(n.result)return[2,{result:n.result,cancelled:!1}];return[2]}})})()}},onDiagnostics:(0,T.JV)(s,"DIAGNOSTICS"),onServerStateChange:(0,T.JV)(s,"SERVER_STATE_CHANGE"),onServerHealthChange:(0,T.JV)(s,"SERVER_HEALTH_CHANGE"),onServerCapabilitiesChange:(0,T.JV)(s,"SERVER_CAPABILITIES_CHANGE"),onRequest:(0,T.JV)(s,"REQUEST"),onResponse:(0,T.JV)(s,"RESPONSE"),onCancelRequest:(0,T.JV)(s,"CANCEL_REQUEST"),onSendNotification:(0,T.JV)(s,"SEND_NOTIFICATION"),shutdown:function(){for(var e in C(tA.a.EXITING),y.clear(),b)D(Number(e));P(),E({method:"shutdown"}).then(function(){S({method:"exit"}),C(tA.a.EXITED),s.removeAllListeners()})},isDestroyed:function(){return v},destroy:function(){for(var e in v=!0,y.clear(),b)D(Number(e));P(),C(tA.a.EXITED),s.removeAllListeners()},getServerState:function(){return d},getServerHealth:function(){return f},getServerCapabilities:function(){return h},getServerInfo:function(){return t},getDiagnostics:function(e){var t=y.get(e);if(!t)throw Error("File with path ".concat(e," is not open."));return t.diagnostics},isOpen:function(e){return y.has(e)},documentUriToPath:w,pathToDocumentURI:x,isSupportedFile:r,getLanguageId:function(e){return tX(e,i)},clientId:i,clientName:o}}({connection:{read:function(e){"open"===s.status&&s.onCommand(function(t){t.output&&e(t.output)})},write:function(e){if("open"!==s.status){(null==y?void 0:y.isDestroyed())&&es.kg.error("LSPNix: tried to write to channel but the lsp client is already destroyed");return}s.send({input:e})},didClose:function(){return"open"!==s.status}},clientId:e,clientName:a[e].option.name,isSupportedFile:function(e){return(0,tZ.F)(e,d)},applyWorkspaceEdit:function(e){var t=e.edit;return y?(0,tC.w)({edit:t,fs:r,client:y}):{applied:!1}},getWorkspaceConfiguration:function(){if(!(null===(e=d.config)||void 0===e?void 0:e.configurationJson))return null;var e,t=null;try{t=JSON.parse(d.config.configurationJson)}catch(e){es.kg.error("Failed to parse LSP workspace configuration",{configurationJson:d.config.configurationJson})}return t}}),null===(b=d.config)||void 0===b?void 0:b.initializationOptionsJson)try{x=JSON.parse(d.config.initializationOptionsJson)}catch(e){es.kg.error("Failed to parse LSP initializationOptions",{initializationOptionsJson:d.config.initializationOptionsJson})}var c,b,w,x,S=y.initialize({pwd:t.workingDirectory,initializationOptions:x}).catch(function(t){if((null==t?void 0:t.message)!=="Initialize request cancelled")throw es.kg.error("LSPNix: failed to initialize client",{lspId:e,appService:"lspnix",originalError:null==t?void 0:t.message}),t});Z.push(y.onServerHealthChange(function(t){if(t===tA.N.BROKEN&&(es.kg.info("LSP: Server health broken",{lspId:e}),C(),l)){es.kg.info("LSP: retrying after server health broken",{lspId:e}),f(e,n,_);return}}),y.onServerStateChange((c=(0,p._)(function(t){var n,r,l,c,f,p,m,b,Z,w,x,_,E;return(0,g.Jh)(this,function(g){switch(g.label){case 0:if("open"!==s.status)return es.kg.info("LSPNix: channel wasn't open on state change",{lspId:e,appService:"lspnix",state:t}),C(),[2];if(!y)return es.kg.info("LSPNix: client was null on state change. This should never happen",{lspId:e,appService:"lspnix",state:t}),C(),[2];if(!tV(a[e].option,d))return es.kg.info("LSPNix: configuration changed and received state change",{lspId:e,appService:"lspnix",state:t}),C(),[2];if(t===tA.a.EXITED)return es.kg.info("LSP server exited via 'exit' notification",{lspId:e,appService:"lspnix"}),C(),[2];if(t!==tA.a.INITIALIZED)return[2];return[4,S];case 1:if(g.sent(),"open"!==s.status)return es.kg.info("LSPNix: channel wasn't open after initialization",{lspId:e,appService:"lspnix"}),C(),[2];h(y),u.delete(e),a[e].client=y,n=!0,r=!1,l=void 0;try{for(c=i[Symbol.iterator]();!(n=(f=c.next()).done);n=!0)if(m=(p=(0,v._)(f.value,2))[0],b=p[1],!(!(0,tZ.F)(m,d)||o.has(m))){o.set(m,y),Z=!0,w=!1,x=void 0;try{for(_=b[Symbol.iterator]();!(Z=(E=_.next()).done);Z=!0)(0,E.value)(y)}catch(e){w=!0,x=e}finally{try{Z||null==_.return||_.return()}finally{if(w)throw x}}}}catch(e){r=!0,l=e}finally{try{n||null==c.return||c.return()}finally{if(r)throw l}}return[2]}})}),function(e){return c.apply(this,arguments)})))})}}),function(e){C(e.willReconnect)}}),a[e].closeChannel=w,[2]}})})).apply(this,arguments)}function Z(e){var t=null==e?void 0:e.languageServers;if(!t||0===t.length){var n=!0,r=!1,i=void 0;try{for(var o,l=Object.keys(a)[Symbol.iterator]();!(n=(o=l.next()).done);n=!0){var u=o.value;c(u)}}catch(e){r=!0,i=e}finally{try{n||null==l.return||l.return()}finally{if(r)throw i}}return}var d={},f=!0,h=!1,p=void 0;try{for(var m,v=t[Symbol.iterator]();!(f=(m=v.next()).done);f=!0){var g=m.value;d[g.id]=g}}catch(e){h=!0,p=e}finally{try{f||null==v.return||v.return()}finally{if(h)throw p}}var y=!0,b=!1,Z=void 0;try{for(var w,x=Object.keys(a)[Symbol.iterator]();!(y=(w=x.next()).done);y=!0){var C=w.value;d[C]||c(C)}}catch(e){b=!0,Z=e}finally{try{y||null==x.return||x.return()}finally{if(b)throw Z}}var _=!0,S=!1,E=void 0;try{for(var k,T=Object.keys(d)[Symbol.iterator]();!(_=(k=T.next()).done);_=!0){var R=k.value,D=a[R],I=d[R];if(!D){s(R,I);continue}tV(D.option,I)||(c(R),s(R,I))}}catch(e){S=!0,E=e}finally{try{_||null==T.return||T.return()}finally{if(S)throw E}}}function w(){return(w=(0,p._)(function(){var e;return(0,g.Jh)(this,function(t){try{e=n.configs.current,Z(e),n.configs.subscribe(Z)}catch(e){es.kg.error("LSP initialization failed: "+e.message)}return[2]})})).apply(this,arguments)}return!function(){w.apply(this,arguments)}(),{disable:function(){if(l){l=!1;var e=!0,t=!1,n=void 0;try{for(var r,c=Object.values(a)[Symbol.iterator]();!(e=(r=c.next()).done);e=!0){var s=r.value;s.closeChannel(),null===(h=s.client)||void 0===h||h.destroy(),s.client=null;var u=!0,d=!1,f=void 0;try{for(var h,p,m=i[Symbol.iterator]();!(u=(p=m.next()).done);u=!0){var g=(0,v._)(p.value,2),y=g[0],b=g[1];if(o.has(y)){o.delete(y);var Z=!0,w=!1,x=void 0;try{for(var C,_=b[Symbol.iterator]();!(Z=(C=_.next()).done);Z=!0)(0,C.value)(null)}catch(e){w=!0,x=e}finally{try{Z||null==_.return||_.return()}finally{if(w)throw x}}}}}catch(e){d=!0,f=e}finally{try{u||null==m.return||m.return()}finally{if(d)throw f}}}}catch(e){t=!0,n=e}finally{try{e||null==c.return||c.return()}finally{if(t)throw n}}}},enable:function(){if(!l){l=!0;var e=!0,t=!1,n=void 0;try{for(var r,i=Object.keys(a)[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value;h(o)}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}},onClient:function(e,t){i.has(e)||i.set(e,[]),null===(s=i.get(e))||void 0===s||s.push(t);var n=o.get(e);if(n)t(n);else{var r=!0,l=!1,c=void 0;try{for(var s,u,d=Object.values(a)[Symbol.iterator]();!(r=(u=d.next()).done);r=!0){var f=u.value;if((0,tZ.F)(e,f.option)){f.client&&t(f.client);break}}}catch(e){l=!0,c=e}finally{try{r||null==d.return||d.return()}finally{if(l)throw c}}}return function(){var n,r=null!==(n=i.get(e))&&void 0!==n?n:[];i.set(e,r.filter(function(e){return e!==t}))}}}}({container:e4,toolchain:ti,fs:te}),tx=(z=(V={container:e4,beforeRun:tl}).container,q=V.beforeRun,$=(0,T.ZP)(),K=tg.Z.Idle,ee=new Date(0),en=!1,$.on(tg.z.TEST_RESULT,function(e){en=en&&"passed"===e.body}),eo=function(e){$.emit(tg.z.STATE_CHANGED,e),K=e},ea=(0,p._)(function(e,t){var n,r,i,o,a,l,c,s,u,d,f;return(0,g.Jh)(this,function(h){switch(h.label){case 0:if(n=tv.api.Payload.fromObject(t),r=tv.api.Payload.verify(n))throw r;return i=new(tb())(function(e){var t=tv.api.Response.fromObject(e),r=tv.api.Response.verify(t);if(r){ec.Tb(TypeError("invalid payload received"),function(i){return i.setExtras({validationError:r,payload:n,message:e,response:t})});return}switch(t.body){case"error":return $.emit(tg.z.ERROR,t.error);case"instructionResult":return $.emit(tg.z.INSTRUCTION_RESULT,t.instructionResult);case"testResult":return $.emit(tg.z.TEST_RESULT,t.testResult);case"status":switch(t.status){case tv.api.Status.Ready:return eo(tg.Z.Ready);case tv.api.Status.Building:return eo(tg.Z.Building);case tv.api.Status.Running:return eo(tg.Z.Running)}}}),o=e.onCommand(function(e){if(e.output)try{i.submit(e.output)}catch(t){ec.Tb(SyntaxError("invalid response received from i/o testing binary"),function(r){return r.setExtras({err:t,payload:n,cmd:e})})}}),a=e.request({exec:{args:["io-tester"],splitStderr:!0,lifecycle:b.api.Exec.Lifecycle.STDIN,splitLogs:!0}}),[4,new Promise(function(e,t){var n,r=function(){n(),e()};$.once(tg.z.STATE_CHANGED,r);var i=setTimeout(function(){n(),t(Error("timeout while waiting for iotester to start"))},2e4);n=function(){clearTimeout(i),$.off(tg.z.STATE_CHANGED,r)}})];case 1:return h.sent(),[4,e.request({input:JSON.stringify(n)+"\n"})];case 2:if(!(l=h.sent()).ok)throw s=Error(null!==(c=l.error)&&void 0!==c?c:"unexpected error occurred while sending input to i/o testing binary"),ec.Tb(s,function(e){return e.setExtra("status",l)}),s;return[4,a];case 3:return(u=h.sent()).ok||(f=Error(null!==(d=u.error)&&void 0!==d?d:"unexpected error occurred while executing i/o testing binary"),ec.Tb(f,function(e){return e.setExtra("result",u)})),o(),[2]}})}),{run:function(e){if(K!==tg.Z.Idle)throw Error("iotester already running");return eo(tg.Z.Starting),ee=new Date,en=!0,q().then(function(){return new Promise(function(t){var n=z.openChannel({service:"exec"},function(r){var i="",o="",a=r.channel.onCommand(function(e){e.log?i+=e.log:e.stderr&&(o+=e.stderr)});return t((function(e,t){return ea.apply(this,arguments)})(r.channel,e).finally(function(){a(),n(),(o||i)&&ec.Tb(Error("logs received from IOTester"),function(t){return t.setExtras({logs:i,stderr:o,payload:e})})})),n})})}).catch(function(e){return en=!1,Promise.reject(e)}).finally(function(){return eo(tg.Z.Idle)})},get lastRunAt(){return ee},get state(){return K},get lastRunDidPass(){return en},onInstructionResult:function(e){return $.on(tg.z.INSTRUCTION_RESULT,e),function(){$.off(tg.z.INSTRUCTION_RESULT,e)}},onStateChanged:function(e){return $.on(tg.z.STATE_CHANGED,e),function(){$.off(tg.z.STATE_CHANGED,e)}},onTestResult:function(e){return $.on(tg.z.TEST_RESULT,e),function(){$.off(tg.z.TEST_RESULT,e)}},onError:function(e){return $.on(tg.z.ERROR,e),function(){$.off(tg.z.ERROR,e)}}}),tE=(ed=(eu={container:e4,fs:te}).container,ef=eu.fs,ep=void 0===(eh=eu.provideProfiles)?ts:eh,(em=(0,T.ZP)()).setMaxListeners(1/0),ev=td(),eg=!1,ey=new Map,eb=null,ew=ed.getContext(),eT=new eZ({container:ed,getEnv:function(){return ev},awaitPromise:(e_=(0,p._)(function(e){var t,n;return(0,g.Jh)(this,function(r){switch(r.label){case 0:return[4,ep({defaultUsername:null==ew?void 0:null===(t=ew.currentUser)||void 0===t?void 0:t.username,defaultUserId:null==ew?void 0:null===(n=ew.currentUser)||void 0===n?void 0:n.id,onProfiles:function(t){var n=!0,r=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=(0,v._)(o.value,2),c=l[0],s=l[1];ey.set(c,s),em.emit(L.dq.NEW_PROFILE)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}t.has(L.rG.GITHUB)||ey.delete(L.rG.GITHUB);var u=ey.get(L.rG.REPLIT_DEFAULT),d=ey.get(L.rG.GITHUB);if(eb&&!e&&(e=eb.provider),e===L.rG.GITHUB&&d)eb=d;else{if(!u)return;eb=u}em.emit(L.dq.CHANGED_PROFILE)}})];case 1:return[2,r.sent()]}})}),eE=function(e){return e_.apply(this,arguments)})(L.rG.GITHUB)}),em.on(L.dq.FS_CHANGE,function(){return eT.cache.invalidate()}),em.on(L.dq.FORCED_REFRESH,function(){return eT.cache.invalidate()}),em.on(L.dq.NEW_PROFILE,function(){return eT.cache.invalidate()}),em.on(L.dq.CHANGED_PROFILE,function(){return eT.cache.invalidate()}),em.on(L.dq.CHANGED_PROFILE,function(){null!=eb&&(ev=td({author:{username:eb.username,email:eb.email}}))}),{getEnv:function(){return ev},getProfiles:function(){return Array.from(ey.values())},hasProfile:function(e){return ey.has(e)},getProfile:function(e){var t=ey.get(e);if(!t)throw Error("Fetched a profile that has not been setup!");return t},addProfile:function(e){ey.set(e.provider,e),em.emit(L.dq.NEW_PROFILE)},getCurrentProfile:function(){return eb},setCurrentProfile:function(e){var t=ey.get(e);if(!t)throw Error("Can't set a non-existent profile!");eb=t,ev=td({author:{username:t.username,email:t.email}}),em.emit(L.dq.CHANGED_PROFILE)},onProfileAdded:function(e){var t=function(){e(Array.from(ey.values()))};return em.on(L.dq.NEW_PROFILE,t),function(){em.off(L.dq.NEW_PROFILE,t)}},onCurrentProfileChanged:function(e){var t=function(){e(eb)};return em.on(L.dq.CHANGED_PROFILE,t),function(){em.off(L.dq.CHANGED_PROFILE,t)}},refreshProfiles:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).preferredProvider;return eE(e)},onRefresh:function(e){eg||(function(e,t,n){var r,i,o,a,l,c,s,u,d,f,h=!1,m=!1,v=(r=function(){return n.emit(L.dq.FS_CHANGE)},a=(i={wait:1e3,cooldown:5e3,maxWait:5e3}).wait,l=i.cooldown,c=i.maxWait,s=null,u=!1,d=ex()(function(e){return s=setTimeout(function(){return s=null},l),u=!1,o=r.apply(void 0,(0,el._)(e))},a,{maxWait:c}),(f=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return null!==s?o:(u||(u=!0),d(t))}).cancel=function(){null!==s?(clearTimeout(s),s=null):(d.cancel(),u=!1)},f.flush=function(){return null!==s?(clearTimeout(s),s=null,o):d.flush()},f.isPending=function(){return u},f.isInCooldown=function(){return null!==s},f);function y(){return(y=(0,p._)(function(){var n;return(0,g.Jh)(this,function(r){return n=!0,t.watchDir(th.Ql,{onChange:function(r){!h&&r.find(function(e){return e.filename===tm&&e.type===tp.Tv.Directory})&&(function(){if(!h){h=!0;var n=!0;t.watchDir(tm,{onChange:function(){n?n=!1:v()},onMoveOrDelete:function(){h=!1,v()},onError:function(t,n){h=!1,RegExp(".+permission denied","im").test(t.message)||e.unrecoverableError(t,n)}})}}(),n||v()),n&&(n=!1)},onError:function(t,n){return e.unrecoverableError(t,n)}}),[2]})})).apply(this,arguments)}(function(){y.apply(this,arguments)})(),t.onStatusChange(function(e){h&&(e===tp.kO.Syncing&&v.isInCooldown()?m=!0:e===tp.kO.Clean&&(m||v(),m=!1))})}(ed,ef,em),eg=!0);var t=function(){return e(L.dq.FS_CHANGE)},n=function(){return e(L.dq.FORCED_REFRESH)},r=function(){return e(L.dq.NEW_PROFILE)},i=function(){return e(L.dq.CHANGED_PROFILE)};return em.on(L.dq.FS_CHANGE,t),em.on(L.dq.FORCED_REFRESH,n),em.on(L.dq.NEW_PROFILE,r),em.on(L.dq.CHANGED_PROFILE,i),function(){em.off(L.dq.FS_CHANGE,t),em.off(L.dq.FORCED_REFRESH,n),em.off(L.dq.NEW_PROFILE,r),em.off(L.dq.CHANGED_PROFILE,i)}},forceRefresh:function(){em.emit(L.dq.FORCED_REFRESH)},isBusy:function(){return eT.running.current},onBusyChange:function(e){var t=!1,n=ex()(e,200);return eT.running.subscribe(function(e){t&&!e?(n(!1),t=!1):!t&&e&&(n(!0),t=!0)})},init:eT.wrap(ej,"write"),isInitialized:eT.wrap(eY,"read"),lsFiles:eT.wrap(e0,"read"),status:eT.wrap(er.Z,"read"),log:eT.wrap(eK,"read"),findDefaultBranches:eT.wrap(eP,"read"),listBranches:eT.wrap(eU.ZP,"read"),setBranchUpstream:eT.wrap(B,"write"),stageFiles:eT.wrap(e7,"write"),commit:eT.wrap(eS,"write"),switchBranch:eT.wrap(ek,"write"),branchExists:eT.wrap(j,"read"),createBranch:eT.wrap(eR,"write"),getRemotes:eT.wrap(eW,"read"),fetch:eT.wrap(eI,"write"),canMergeBranches:eT.wrap(Y,"read"),pull:eT.wrap(e2.Z,"write"),push:eT.wrap(e8,"write"),getRepositoryState:eT.wrap(O.ZP,"read"),getFileContents:eT.wrap(eX,"read"),addRemote:eT.wrap(eC,"write"),removeRemote:eT.wrap(e3,"write"),setRemoteURL:eT.wrap(e6,"write"),getBranch:eT.wrap(eO,"read"),restoreFiles:eT.wrap(ei,"write"),lastFetched:eT.wrap(W,"read"),merge:eT.wrap(J,"write"),mergeContinue:eT.wrap(et,"write"),mergeAbort:eT.wrap(Q,"write"),getConflictingFiles:eT.wrap(N,"read"),getMergingRefs:eT.wrap(M,"read"),getFilesForCommit:eT.wrap(F.Z,"read")}),tT=function(e){var t,n,r=e.container,i=e.nixService;function o(e){return a.apply(this,arguments)}function a(){return(a=(0,p._)(function(e){return(0,g.Jh)(this,function(t){switch(t.label){case 0:if(e&&(n=void 0),!n){var r;n=new Promise((r=(0,p._)(function(e){var t,n;return(0,g.Jh)(this,function(r){switch(r.label){case 0:return[4,i.listPackages()];case 1:if(null==(n=r.sent())?void 0:null===(t=n.packages)||void 0===t?void 0:t.some(function(e){return"pkgs.postgresql"===e.name}))return[3,3];return[4,i.addPackages(["pkgs.postgresql"])];case 2:return r.sent(),e(),[3,4];case 3:e(),r.label=4;case 4:return[2]}})}),function(e){return r.apply(this,arguments)}))}return[4,n];case 1:return t.sent(),[2]}})})).apply(this,arguments)}return{ensureNixPsqlPackageInstalled:o,run:(t=(0,p._)(function(e){var t,n,i,a,l,c,s,u,d,f,h,p,m;return(0,g.Jh)(this,function(v){switch(v.label){case 0:return t=e.query,n=e.connectionString,[4,o()];case 1:v.sent(),i=(0,tJ.Z)({container:r}),a=[],l=null,c=new t$.t(function(e){return a.push(e)}),s=null,u=!1,d=new Promise(function(e){var t=i.onStateChanged(function(n){var r=n.state,i=n.stderrBuffer;if(r===b.api.State.Running){u=!0;return}u&&(s=i,t(),e())})}),i.onOutput(function(e){try{c.process(e)}catch(t){l||(l=t,ec.Tb(t,function(t){return t.setExtra("chunk",e)}))}}),v.label=2;case 2:return v.trys.push([2,,5,6]),[4,i.request({args:["psql",n,"--csv","--command",t],splitStderr:!0})];case 3:return f=v.sent(),[4,d];case 4:return v.sent(),f.error&&!s&&(s=f.error),c.flush(),[3,6];case 5:return i.dispose(),[7];case 6:if(s)return[2,{columns:c.headers(),rows:a,error:s}];if(l)return h=l.message,[2,{columns:null!==(p=c.headers())&&void 0!==p?p:[],rows:a,error:h}];return[2,{columns:null!==(m=c.headers())&&void 0!==m?m:[],rows:a,error:null}]}})}),function(e){return t.apply(this,arguments)})}}({container:e4,nixService:tr}),tD=(0,t8.Z)({fs:te}),{session:e9,presence:tt,packager:to,container:e4,fs:te,runner:tf,debuggest:tc,broadcast:ty,dotReplit:tn,nixService:tr,lspnix:tw,iotester:tx,git:tE,psql:tT,userEvents:e5,replspaceApi:ta,toolchain:ti,ports:tu,secrets:tD}}),1)[0]}(l=h||(h={})).CHANNEL_OPENED="CHANNEL_OPENED",l.EVENT_SENT="EVENT_SENT"},41062:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(66626),i=n(50959);function o(e,t){var n=(0,r._)((0,i.useState)(null),2),o=n[0],a=n[1];return(0,i.useEffect)(function(){var n=!1;return e.readFile(t).then(function(e){n||a(e)}),function(){n=!0}},[e,t]),o}},57369:function(e,t,n){n.d(t,{ZP:function(){return f},y5:function(){return a},yG:function(){return o}});var r,i,o,a,l=n(27387),c=n(96583),s=n(75813);function u(e,t){return"{ ".concat(e,"; } > /dev/null 2>&1 && echo -n '").concat(t,"' && exit 0")}(r=o||(o={})).NOT_INITIALIZED="NOT_INITIALIZED",r.ON_UNBORN_BRANCH="ON_UNBORN_BRANCH",r.MERGING="MERGING",r.REBASING="REBASING",r.REVERTING="REVERTING",r.CHERRY_PICKING="CHERRY_PICKING",r.APPLYING_MAILBOX="APPLYING_MAILBOX",r.BISECTING="BISECTING",r.DIRTY_WORKTREE="DIRTY_WORKTREE",r.DIRTY_INDEX="DIRTY_INDEX",r.CLEAN="CLEAN",r.DETACHED_HEAD="DETACHED_HEAD",(i=a||(a={})).INITIALIZING="INITIALIZING",i.INTERMEDIATE="INTERMEDIATE",i.NORMAL="NORMAL",i.DETACHED_HEAD="DETACHED_HEAD";var d=[u("! git rev-parse --is-inside-work-tree","NOT_INITIALIZED"),u('[ "$(! git rev-parse HEAD -- 2>&1)" = "fatal: bad revision \'HEAD\'" ]',"ON_UNBORN_BRANCH"),u("git rev-parse -q --verify MERGE_HEAD","MERGING"),u("[ -d '.git/rebase-apply' ] && [ -f '.git/rebase-apply/applying' ]","APPLYING_MAILBOX"),u("[ -d '.git/rebase-apply' ] || [ -d '.git/rebase-merge' ]","REBASING"),u("git rev-parse -q --verify REVERT_HEAD","REVERTING"),u("git rev-parse -q --verify CHERRY_PICK_HEAD","CHERRY_PICKING"),u("[ -f '.git/BISECT_LOG' ]","BISECTING"),u("! git symbolic-ref -q HEAD","DETACHED_HEAD"),"git update-index -q --refresh > /dev/null || exit $?",u('{ ! git diff-files --quiet; } || [ -n "$(git ls-files --others --exclude-standard)" ]',"DIRTY_WORKTREE"),u("! git diff-index --cached --quiet HEAD --","DIRTY_INDEX"),'echo -n "CLEAN"'].join(";");function f(e){return h.apply(this,arguments)}function h(){return(h=(0,l._)(function(e){var t,n,r;return(0,c.Jh)(this,function(i){switch(i.label){case 0:return[4,e(d,{serviceMethod:"git-get-repository-state"})];case 1:if((t=i.sent()).error)return[2,t];if(!(t.output in o))return[2,{error:s.aq.UNKNOWN}];return r=function(e){switch(e){case"NOT_INITIALIZED":case"ON_UNBORN_BRANCH":return"INITIALIZING";case"MERGING":case"REBASING":case"REVERTING":case"CHERRY_PICKING":case"APPLYING_MAILBOX":case"BISECTING":return"INTERMEDIATE";case"DIRTY_WORKTREE":case"DIRTY_INDEX":case"CLEAN":return"NORMAL";case"DETACHED_HEAD":return"DETACHED_HEAD"}}(n=t.output),[2,{state:n,type:r,error:null}]}})})).apply(this,arguments)}},65307:function(e,t,n){n.d(t,{Z:function(){return g},y:function(){return a}});var r,i,o,a,l=n(27387),c=n(66626),s=n(63257),u=n(96583);function d(e){switch(e){case"A":return"ADDED";case"C":return"COPIED";case"D":return"DELETED";case"M":return"MODIFIED";case"R":return"RENAMED";case"T":return"TYPE_CHANGED";case"U":return"UNMERGED";case"X":default:return"UNKNOWN";case"B":return"BROKEN"}}(r=a||(a={})).ADDED="ADDED",r.COPIED="COPIED",r.DELETED="DELETED",r.MODIFIED="MODIFIED",r.RENAMED="RENAMED",r.TYPE_CHANGED="TYPE_CHANGED",r.UNMERGED="UNMERGED",r.UNKNOWN="UNKNOWN",r.BROKEN="BROKEN";var f=(i=(0,l._)(function(e,t){var n;return(0,u.Jh)(this,function(r){switch(r.label){case 0:return[4,e("git log -1 --pretty=%P ".concat(t))];case 1:if((n=r.sent()).error)return[2,!1];return[2,n.output.trim().length>0]}})}),function(e,t){return i.apply(this,arguments)}),h=(o=(0,l._)(function(e,t){var n,r,i,o,a,l,c,s,d;return(0,u.Jh)(this,function(u){switch(u.label){case 0:return[4,e("git ls-tree --name-only -r ".concat(t),{serviceMethod:"git-get-files-for-commit"})];case 1:if((n=u.sent()).error)return[2,n];r=[],i=n.output.split("\n").filter(Boolean),o=!0,a=!1,l=void 0;try{for(c=i[Symbol.iterator]();!(o=(s=c.next()).done);o=!0)d=s.value,r.push({path:d,type:"ADDED"})}catch(e){a=!0,l=e}finally{try{o||null==c.return||c.return()}finally{if(a)throw l}}return[2,{files:r,error:null}]}})}),function(e,t){return o.apply(this,arguments)});function p(){return(p=(0,l._)(function(e){return(0,u.Jh)(this,function(t){return[2,Array.from(e.matchAll(v)).map(function(e){var t=(0,c._)(e,4),n=t[1],r=t[2];return{path:t[3],originalPath:r,type:d(n)}})]})})).apply(this,arguments)}var m=/([ADMUXBT])\0([^\0]+)/g,v=/([RC])\d*\0([^\0]+)\0([^\0]+)/g;function g(e,t){return y.apply(this,arguments)}function y(){return(y=(0,l._)(function(e,t){var n,r,i;return(0,u.Jh)(this,function(o){switch(o.label){case 0:return[4,f(e,t)];case 1:if(!o.sent())return[2,h(e,t)];return[4,e("git diff-tree --no-commit-id --name-status -z -r -M ".concat(t),{serviceMethod:"git-get-files-for-commit"})];case 2:if((n=o.sent()).error)return[2,n];return[4,function(e){return p.apply(this,arguments)}(n.output)];case 3:return r=o.sent(),i=Array.from(n.output.matchAll(m)).map(function(e){var t=(0,c._)(e,3),n=t[1];return{path:t[2],type:d(n)}}),[2,{files:(0,s._)(r).concat((0,s._)(i)),error:null}]}})})).apply(this,arguments)}},21076:function(e,t,n){n.d(t,{CH:function(){return v},Dc:function(){return d},GE:function(){return f},LY:function(){return h},Pi:function(){return g},Qj:function(){return m},bF:function(){return p},dC:function(){return u}});var r=n(66626),i=n(50431),o=n(80433),a=n(75647),l=/[~^:?*[\\\0-\x20\x7F]/,c=/^(([A-Za-z0-9]+@|http(|s):\/\/)|(http(|s):\/\/[A-Za-z0-9]+@))([A-Za-z0-9.]+(:\d+)?)(?::|\/)([\d/\w.-]+?)$/,s=new RegExp([l,/^$/,/^\//,/\/$/,/\.lock$/,/\/{2,}/,/^\./,/\.$/,/\/\./,/\.\./,/@\{/,/^@$/,/^-/].map(function(e){return"(?:".concat(e.source,")")}).join("|"));function u(e){return 0===e.length||!l.test(e)}function d(e){return!s.test(e)}function f(e){return!s.test(e)}function h(e){return c.test(e)}function p(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return"string"==typeof e?(0,i.C)(e):"commit"in e?e.type===a.HO.LOCAL||t&&e.type===a.HO.TRACKED?e.name:"".concat(e.remote,"/").concat(e.name):e.name}function m(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("string"==typeof e)return e;if("commit"in e)return e.type===a.HO.LOCAL||t&&e.type===a.HO.TRACKED?"refs/heads/".concat(e.name):"refs/remotes/".concat(e.remote,"/").concat(e.name);if(e.type===o.l.BRANCH)return"refs/heads/".concat(e.name);if(e.type===o.l.REMOTE_BRANCH)return"refs/remotes/".concat(e.remote,"/").concat(e.branch);throw Error("Unknown branch object")}function v(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("string"==typeof e)return t&&!e.startsWith("refs/remotes/")?null:(0,r._)((0,i.Tg)(e),1)[0];if("commit"in e)return t&&e.type!==a.HO.REMOTE?null:e.remote;if(e.type===o.l.BRANCH)return null;if(e.type===o.l.REMOTE_BRANCH)return e.remote;throw Error("Unknown branch object")}function g(e,t){return e===t||null!==e&&null!==t&&m(e)===m(t)}},80433:function(e,t,n){n.d(t,{L:function(){return function e(t){var n;switch("HEAD"===(n=t)||"refs/HEAD"===n||n.startsWith(l)?"HEAD":n.startsWith(c)?"BRANCH":n.startsWith(s)?f.test(n)?"REMOTE_HEAD":"REMOTE_BRANCH":n.startsWith(d)||n.startsWith(u)?"TAG":"BRANCH"){case"HEAD":if(t.startsWith(l)){if(t.endsWith("(detached)"))return{type:"HEAD",name:"HEAD",detached:!0,ref:null};return{type:"HEAD",name:"HEAD",detached:!1,ref:e(t.slice(l.length))}}return{type:"HEAD",name:"HEAD",detached:!1,ref:null};case"REMOTE_HEAD":var r=t.slice(s.length);return{type:"REMOTE_HEAD",name:"HEAD",remote:(0,o._)(r.split("/"),1)[0]};case"BRANCH":return{type:"BRANCH",name:t.startsWith(c)?t.slice(c.length):t};case"REMOTE_BRANCH":var i=t.slice(s.length),h=(0,a._)(i.split("/"));return{type:"REMOTE_BRANCH",name:i,remote:h[0],branch:h.slice(1).join("/")};case"TAG":return t.startsWith(u)&&(t=t.slice(u.length)),t.startsWith(d)&&(t=t.slice(d.length)),{type:"TAG",name:t}}}},l:function(){return i}});var r,i,o=n(66626),a=n(78950),l="HEAD -> ",c="refs/heads/",s="refs/remotes/",u="tag: ",d="refs/tags/",f=/^refs\/remotes\/([^/]+)\/HEAD$/;(r=i||(i={})).HEAD="HEAD",r.REMOTE_HEAD="REMOTE_HEAD",r.BRANCH="BRANCH",r.REMOTE_BRANCH="REMOTE_BRANCH",r.TAG="TAG"},75647:function(e,t,n){n.d(t,{HO:function(){return i},ZP:function(){return h},p3:function(){return d}});var r,i,o=n(27387),a=n(66626),l=n(63257),c=n(96583),s=n(50431),u=n(80433);function d(e,t){return!!e&&!!t&&(e===t||e.name===t.name&&e.remote===t.remote)}function f(e){var t=(0,a._)(e.split("	"),6),n=t[0],r=t[1],i=t[2],o=t[3],l=t[4],c=t[5],d=(0,u.L)(n),f={hash:i,author:{name:o,email:(0,s.tc)(l),date:1e3*parseInt(c,10)}};if(d.type===u.l.BRANCH){var h=r?(0,u.L)(r):null,p=h&&(h.type===u.l.REMOTE_BRANCH||h.type===u.l.BRANCH)?h:null;return{type:"LOCAL",name:d.name,push:p,remote:null,tracking:null,commit:f}}return d.type===u.l.REMOTE_BRANCH?{type:"REMOTE",name:d.branch,remote:d.remote,push:null,tracking:null,commit:f}:null}function h(e){return p.apply(this,arguments)}function p(){return(p=(0,o._)(function(e){var t,n,r=arguments;return(0,c.Jh)(this,function(i){switch(i.label){case 0:return[4,e(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!1===e.local&&!1===e.remote)throw Error("Cannot specify both local and remote as false");var t=[];if(t.push('--format="%(refname)%09%(push)%09%(objectname)%09%(authorname)%09%(authoremail)%09%(authordate:unix)"'),e.max&&t.push("--count=".concat(e.max)),e.pattern){if("string"==typeof e.pattern)t.push((0,s.Gw)(e.pattern));else{var n,r,i=e.pattern.map(function(e){return(0,s.Gw)(e)});t.push.apply(t,(0,l._)(i))}}else(null===(n=e.local)||void 0===n||n)&&t.push("refs/heads"),(null===(r=e.remote)||void 0===r||r)&&t.push("refs/remotes");return"git for-each-ref ".concat(t.join(" "))}(r.length>1&&void 0!==r[1]?r[1]:{}),{serviceMethod:"git-list-branches"})];case 1:if((t=i.sent()).error)return[2,t];return(n=function(e){var t=[],n=[],r=!0,i=!1,o=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done);r=!0){var s=a.value;"LOCAL"===s.type?t.push(s):"REMOTE"===s.type&&n.push(s)}}catch(e){i=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}var d=new Set,f=[],h=!0,p=!1,m=void 0;try{for(var v,g=n[Symbol.iterator]();!(h=(v=g.next()).done);h=!0)!function(){var e=v.value,n=t.find(function(t){return t.push&&t.push.type===u.l.REMOTE_BRANCH&&t.push.remote===e.remote&&t.push.branch===e.name&&t.name===e.name});n&&(d.add(e),d.add(n),f.push({type:"TRACKED",name:n.name,remote:e.remote,push:n.push,tracking:e,commit:n.commit}))}()}catch(e){p=!0,m=e}finally{try{h||null==g.return||g.return()}finally{if(p)throw m}}var y=e.filter(function(e){return!d.has(e)});return(0,l._)(y).concat((0,l._)(f))}((0,s.so)(t.output,"\n").map(f).filter(function(e){return null!==e}))).sort(function(e,t){return t.commit.author.date-e.commit.author.date}),[2,{branches:n,error:null}]}})})).apply(this,arguments)}(r=i||(i={})).LOCAL="LOCAL",r.REMOTE="REMOTE",r.TRACKED="TRACKED"},91075:function(e,t,n){n.d(t,{T:function(){return i},Z:function(){return d}});var r,i,o=n(27387),a=n(66626),l=n(96583),c=n(75813),s=n(50431),u=n(55103);function d(e){return f.apply(this,arguments)}function f(){return(f=(0,o._)(function(e){var t,n,r,i,o,d,f,h,p,m=arguments;return(0,l.Jh)(this,function(l){switch(l.label){case 0:return t=m.length>1&&void 0!==m[1]?m[1]:{},[4,(0,u.Z)(e)];case 1:if((n=l.sent()).error)return[2,n];if(!n.branch)return[2,{error:c.aq.HEAD_DETACHED}];if(!n.upstream||(i=(r=(0,a._)((0,s.Tg)(n.upstream.branch),2))[0],o=r[1],!i||!o))return[2,{error:c.aq.UPSTREAM_NOT_SET}];if(n.changes.length>0)return[2,{error:c.aq.DIRTY_WORKTREE}];if("FF_ONLY"===(f=null!==(d=t.mode)&&void 0!==d?d:"FF_ONLY")&&n.upstream.ahead>0)return[2,{error:c.aq.MERGE_CONFLICT}];switch("FF_ONLY"!==f&&0===n.upstream.ahead&&(f="FF_ONLY"),h=["--quiet","--no-edit"],f){case"FF_ONLY":h.push("--no-rebase","--ff-only");break;case"MERGE":h.push("--no-rebase","--ff");break;case"REBASE":h.push("--rebase")}return h.push((0,s.Gw)(i),(0,s.Gw)(o)),[4,e("git pull ".concat(h.join(" ")),{serviceMethod:"git-pull"})];case 2:if((p=l.sent()).error!==c.aq.MERGE_CONFLICT)return[3,8];if(t.allowConflicts)return[2,{hasConflicts:!0,error:null}];switch(f){case"MERGE":return[3,3];case"REBASE":return[3,5]}return[3,7];case 3:return[4,e("git merge --abort",{serviceMethod:"git-pull"})];case 4:case 6:return l.sent(),[3,7];case 5:return[4,e("git rebase --abort",{serviceMethod:"git-pull"})];case 7:return[2,p];case 8:if(p.error)return[2,p];return[2,{hasConflicts:!1,error:null}]}})})).apply(this,arguments)}(r=i||(i={})).FF_ONLY="FF_ONLY",r.MERGE="MERGE",r.REBASE="REBASE"},63043:function(e,t,n){n.d(t,{J:function(){return r},O:function(){return i}});var r="users.noreply.replit.com",i="users.noreply.github.com"},97631:function(e,t,n){n.d(t,{J:function(){return i},e:function(){return r}});var r=(0,n(59173).u)(null);function i(e,t,n){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Date.now();Array.isArray(e)||(e=[e]);var a=null!==(i=t.output)&&void 0!==i?i:"",l=t.error,c=n?o:Date.now(),s="".concat(o,"-").concat(Math.random());r.set({input:e,output:a,error:l,start:o,end:c,cached:n,key:s})}},75813:function(e,t,n){var r,i,o,a,l,c;n.d(t,{aq:function(){return r},dq:function(){return i},rG:function(){return o}}),(a=r||(r={})).UNKNOWN_NOT_GIT="UNKNOWN_NOT_GIT",a.UNKNOWN="UNKNOWN",a.TIMEOUT="TIMEOUT",a.CHANNEL_CLOSED="CHANNEL_CLOSED",a.NOT_INITIALIZED="NOT_INITIALIZED",a.UNAUTHENTICATED="UNAUTHENTICATED",a.INDEX_FILE_CORRUPT="INDEX_FILE_CORRUPT",a.UNKNOWN_REMOTE="UNKNOWN_REMOTE",a.INDEX_LOCKED="INDEX_LOCKED",a.NO_COMMITS="NO_COMMITS",a.PATH_MATCHED_NO_FILES="PATH_MATCHED_NO_FILES",a.USER_NOT_CONFIGURED="USER_NOT_CONFIGURED",a.INVALID_REFERENCE="INVALID_REFERENCE",a.BRANCH_ALREADY_EXISTS="BRANCH_ALREADY_EXISTS",a.MERGE_CONFLICT="MERGE_CONFLICT",a.UPSTREAM_NOT_SET="UPSTREAM_NOT_SET",a.HEAD_DETACHED="HEAD_DETACHED",a.DIRTY_WORKTREE="DIRTY_WORKTREE",a.PUSH_REJECTED="PUSH_REJECTED",a.REMOTE_ALREADY_EXISTS="REMOTE_ALREADY_EXISTS",a.ALREADY_INITIALIZED="ALREADY_INITIALIZED",a.INVALID_STATE="INVALID_STATE",a.PROTECTED_BRANCH="PROTECTED_BRANCH",(l=i||(i={})).FS_CHANGE="FS_CHANGE",l.FORCED_REFRESH="FORCED_REFRESH",l.NEW_PROFILE="NEW_PROFILE",l.CHANGED_PROFILE="CHANGED_PROFILE",(c=o||(o={})).REPLIT_DEFAULT="REPLIT_DEFAULT",c.GITHUB="GITHUB"},19858:function(e,t,n){n.d(t,{Z:function(){return f}});var r=n(66626),i=n(63257),o=n(7444),a=n(50199),l=n(75813),c=n(54916),s=n(3341),u=n.n(s),d=n(50959);function f(e){var t,n,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],f=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},h=(0,r._)((0,d.useState)(null),2),p=h[0],m=h[1],v=(0,o.Z)(p),g=null===(n=null!==(t=f.keepStaleResult)&&void 0!==t?t:f.refresh)||void 0===n||n,y=(0,d.useCallback)(function(e){u()(e,v.current)||m(e)},[v]),b=(0,a.Z)(function(){return e},(0,i._)(s)),Z=(0,c.Z)().git,w=(0,d.useRef)(null),x=(0,d.useCallback)(function(){w.current?w.current():g||y(null);var e=!1;b(Z).then(function(t){e||(y(t),w.current=null)}).catch(function(){e||(y({error:l.aq.UNKNOWN}),w.current=null)}),w.current=function(){e=!0,w.current=null,g||y(null)}},[y,b,Z,g]);return(0,d.useEffect)(function(){return x()},[x]),(0,d.useEffect)(function(){var e;if(null===(e=f.refresh)||void 0===e||e)return Z.onRefresh(x)},[Z,x,f.refresh]),p}},36098:function(e,t,n){var r,i,o,a;n.d(t,{Z:function(){return i},z:function(){return r}}),(o=r||(r={})).INSTRUCTION_RESULT="INSTRUCTION_RESULT",o.TEST_RESULT="TEST_RESULT",o.ERROR="ERROR",o.STATE_CHANGED="STATE_CHANGED",(a=i||(i={}))[a.Idle=0]="Idle",a[a.Starting=1]="Starting",a[a.Ready=2]="Ready",a[a.Building=3]="Building",a[a.Running=4]="Running"},69521:function(e,t,n){n.d(t,{Z:function(){return r}});function r(e){var t,n=e.getServerCapabilities();return{isAutoCompleteSupported:!!(null==n?void 0:n.completionProvider),isCompletionItemResolveSupported:!!(null==n?void 0:null===(t=n.completionProvider)||void 0===t?void 0:t.resolveProvider),isDocumentSymbolSupported:!!(null==n?void 0:n.documentSymbolProvider),isFindReferencesSupported:!!(null==n?void 0:n.referencesProvider),isFindDefinitionSupported:!!(null==n?void 0:n.definitionProvider),isFindTypeDefinitionSupported:!!(null==n?void 0:n.typeDefinitionProvider),isFindImplementationSupported:!!(null==n?void 0:n.implementationProvider),isFormatSupported:!!(null==n?void 0:n.documentFormattingProvider),isFormatRangeSupported:!!(null==n?void 0:n.documentRangeFormattingProvider),isTextDocumentSyncSupported:!!(null==n?void 0:n.textDocumentSync),isHoverSupported:!!(null==n?void 0:n.hoverProvider),isRenameSupported:!!(null==n?void 0:n.renameProvider),isCodeActionsSupported:!!(null==n?void 0:n.codeActionProvider),isSignatureHelpSupported:!!(null==n?void 0:n.signatureHelpProvider)}}},19012:function(e,t,n){var r=n(7225);t.Z=[r.SymbolKind.Array,r.SymbolKind.Boolean,r.SymbolKind.Class,r.SymbolKind.Constant,r.SymbolKind.Constructor,r.SymbolKind.Enum,r.SymbolKind.EnumMember,r.SymbolKind.Event,r.SymbolKind.Field,r.SymbolKind.File,r.SymbolKind.Function,r.SymbolKind.Interface,r.SymbolKind.Key,r.SymbolKind.Method,r.SymbolKind.Module,r.SymbolKind.Namespace,r.SymbolKind.Object,r.SymbolKind.Operator,r.SymbolKind.Package,r.SymbolKind.Property,r.SymbolKind.String,r.SymbolKind.Struct,r.SymbolKind.TypeParameter,r.SymbolKind.Variable]},8701:function(e,t,n){var r,i,o,a;n.d(t,{N:function(){return r},a:function(){return i}}),(o=r||(r={})).NOT_READY="NOT_READY",o.READY="READY",o.STALLED="STALLED",o.BROKEN="BROKEN",(a=i||(i={})).OFFLINE="OFFLINE",a.INITIALIZING="INITIALIZING",a.INITIALIZED="INITIALIZED",a.EXITING="EXITING",a.EXITED="EXITED"},69926:function(e,t,n){n.d(t,{Z:function(){return v}});var r=n(66626),i=n(50782),o=n(54916),a=n(50959),l=n(41733),c=n(30509),s=n(2689),u=n(16783),d=n.n(u),f=n(99071),h=n(8701);function p(e){return Math.floor(performance.now()-e.startTime)}var m=new WeakSet;function v(e){var t=(0,i.Z)(),n=(0,o.Z)().lspnix,u=(0,r._)((0,a.useState)(null),2),v=u[0],g=u[1];return(0,a.useEffect)(function(){if(e){var t=n.onClient(e,g);return function(){t(),g(null)}}},[n,e]),(0,a.useEffect)(function(){if(v)return function(e){var t=e.client,n=e.replId,r=e.language;if(!m.has(t)){m.add(t);var i=new Map,o=function(e){var i,o=t.getServerState(),a=null!==(i=t.getServerInfo())&&void 0!==i?i:{name:"unknown",version:"none"},l=o===h.a.INITIALIZED?"".concat(null==a?void 0:a.name,"@").concat(null==a?void 0:a.version):"not_ready: server is ".concat(o);return{method:e.method,replid:n,language:r,startTime:Math.floor(e.startTime),languageServerInfo:l,lspId:t.clientId}},a=d()(function(e,t){var n=p(t);n>1e4&&s.kg.time("LSP unresponsive request",n,o(t))}),u=setInterval(function(){i.forEach(function(e){a(e.id,e)})},2e3);return(0,f.uf)([t.onRequest(function(e){var t=e.id,n=e.data;.01>Math.random()&&i.set(t,{id:t,method:n.method,startTime:performance.now()})}),t.onResponse(function(e){var t=e.id,n=e.error,r=i.get(t);null!=r&&(i.delete(t),s.kg.time("LSP request",p(r),(0,c._)((0,l._)({},o(r)),{result:null==n?"ok":"error"})))}),t.onCancelRequest(function(e){var t=i.get(e);null!=t&&(i.delete(e),s.kg.time("LSP request",p(t),(0,c._)((0,l._)({},o(t)),{result:"cancelled"})))}),function(){return clearInterval(u)},function(){return m.delete(t)}])}}({client:v,replId:t,language:v.getLanguageId(e)})},[v,t,e]),v}},56729:function(e,t,n){n.d(t,{Z:function(){return a}});var r=n(66626),i=n(50959),o=n(69521);function a(e){var t=(0,r._)((0,i.useState)(null),2),n=t[0],a=t[1];return(0,i.useEffect)(function(){if(!e){a(null);return}return a((0,o.Z)(e)),e.onServerCapabilitiesChange(function(){a((0,o.Z)(e))})},[e]),n}},73660:function(e,t,n){n.d(t,{Z:function(){return a}});var r=n(66626),i=n(54916),o=n(50959);function a(){var e=(0,i.Z)().presence,t=(0,r._)((0,o.useState)(e.getFollowedUser()),2),n=t[0],a=t[1];return(0,o.useEffect)(function(){return a(e.getFollowedUser()),e.onFollowedUserChanged(a)},[e]),n}},1518:function(e,t,n){n.d(t,{Z:function(){return i}});var r=n(73660);function i(){var e=(0,r.Z)();return e?e.color:null}},15482:function(e,t,n){n.d(t,{F:function(){return o}});var r=n(73164),i=n(40728);function o(e,t){var n=(0,r.rF)(t.fileTypeAttrs);return!n&&(null==t?void 0:t.language)&&(n=r.$R.from(t.language)),!!(n&&(0,i.JW)(e,n))}},30845:function(e,t,n){n.d(t,{M:function(){return _},l:function(){return C}});var r=n(42516),i=n(41733),o=n(30509),a=n(66626),l=n(74985),c=n(50782),s=n(93918),u=n(29287),d=n(74833),f=n(56596),h=n(75928),p=n(32078),m=n(93302),v=n(8279),g=n(50959),y=n(34785),b=n(42588),Z=n(91612),w=n(85838),x=(0,s.X)({storageBarWrapper:[u.l0.colWithGap(8)],summaryWrapper:[u.l0.colWithGap(8),u.l0.align.start],totalSummaryDot:[u.l0.backgroundColor.backgroundHigher,u.l0.width(8),u.l0.height(8),{borderRadius:"50%"}],replSummaryDot:[u.l0.backgroundColor.accentPrimaryDefault,u.l0.width(8),u.l0.height(8),{borderRadius:"50%"}],summaryRow:[u.l0.rowWithGap(8),u.l0.justify.start,u.l0.align.center,u.l0.fontSize(14),u.l0.height(14)],summaryRowWrap:[u.l0.rowWithGap(8),u.l0.justify.start,u.l0.align.center,u.l0.fontSize(14),{flexWrap:"wrap"}],replSummaryText:[u.l0.color.accentPrimaryStronger],replSummaryUsage:[u.l0.color.accentPrimaryStrongest],replSummaryTextPlaceholder:[v.p.backgroundPulse(u.TV.backgroundHigher,u.TV.backgroundRoot),{opacity:.5},u.l0.borderRadius(4),u.l0.height("100%"),u.l0.width(78)],replUsagePlaceholder:[v.p.backgroundPulse(u.TV.backgroundHigher,u.TV.backgroundRoot),{opacity:.5},u.l0.borderRadius(4),u.l0.height("100%"),u.l0.width(64)],totalUsagePlaceholder:[v.p.backgroundPulse(u.TV.backgroundHigher,u.TV.backgroundRoot),{opacity:.5},u.l0.borderRadius(4),u.l0.height("100%"),u.l0.width(140)],availablePlaceholder:[v.p.backgroundPulse(u.TV.backgroundHigher,u.TV.backgroundRoot),{opacity:.5},u.l0.borderRadius(4),u.l0.height("100%"),u.l0.width(64)],availableText:[u.l0.color.foregroundDimmest,(0,r._)({},u.BC.max(390),u.l0.pl(16))]}),C=function(e){var t=e.data,n=e.hideAlerts,r=(0,c.Z)(),s=(0,a._)((0,g.useState)(!1),2),u=s[0],v=s[1];if((0,g.useEffect)(function(){var e,n;t&&(null===(e=t.currentUser)||void 0===e?void 0:e.storageInfo.accountStorageUtilization.__typename)==="AccountStorageUtilization"&&(null===(n=t.currentUser.storageInfo.accountStorageUtilization.perRepl.find(function(e){return e.repl.id===r}))||void 0===n?void 0:n.__typename)==="ReplStorageUtilization"&&v(!0)},[t,r]),t&&(null===(C=t.currentUser)||void 0===C?void 0:C.__typename)==="CurrentUser"&&"StorageQuota"===t.currentUser.storageInfo.storageQuota.__typename&&"StorageGracePeriodQuota"===t.currentUser.storageInfo.storageGracePeriodQuota.__typename&&"AccountStorageUtilization"===t.currentUser.storageInfo.accountStorageUtilization.__typename&&"UserPowerUpsTypes"===t.currentUser.userPowerUpsByType.__typename&&u){var C,S,E,k=t.currentUser.username,T=t.currentUser.storageInfo.accountStorageUtilization,R=t.currentUser.storageInfo.storageQuota.quota,D=null!==(S=t.currentUser.userPowerUpsByType.storage.currentSku)&&void 0!==S?S:void 0,I=D?Z.zd[D]:void 0,G=T.total,B=T.perRepl,A=null!==(E=t.currentUser.userSubscriptionType)&&void 0!==E?E:void 0,P=A?Z.XR[A]:Z.XR.FREE,N=Math.max(Number(R)-Number(G),0),U="Bytes",O="(".concat((0,m.fZ)(N,{precision:1,resourceUsageType:U})," available)"),L=B.find(function(e){return e.repl.id===r}),M="0"!==R?(0,l.tZ)(d.xv,{css:x.availableText,multiline:!1,children:O}):null;return(0,l.BX)(f.G,{css:x.storageBarWrapper,children:[(0,l.tZ)(h.$,{context:{type:"workspace_info_modal",replId:r},summary:(0,p._4)((0,o._)((0,i._)({},T),{quota:R})),username:k,resourceUsageType:U}),(0,l.BX)(f.G,{css:x.summaryWrapper,children:[(0,l.BX)(f.G,{css:x.summaryRowWrap,children:[(0,l.BX)(d.xv,{multiline:!1,children:["Replit ",(0,y.s)(A)," storage: ",P," GiB",I?" + ".concat(I," GiB add-on"):null]}),M]}),(0,l.BX)(f.G,{css:x.summaryRow,children:[(0,l.tZ)("div",{css:x.replSummaryDot}),(0,l.tZ)(d.xv,{css:x.replSummaryText,multiline:!1,children:"This Repl:"}),L?(0,l.tZ)(d.xv,{css:x.replSummaryUsage,multiline:!1,children:(0,b.s)(Number(L.usage))}):(0,l.tZ)(f.G,{css:x.replUsagePlaceholder})]}),void 0!==n&&n?null:(0,l.tZ)(w.q,{})]})]})}return(0,l.tZ)(_,{})},_=function(){return(0,l.BX)(f.G,{css:x.storageBarWrapper,children:[(0,l.tZ)(h.X,{}),(0,l.BX)(f.G,{css:x.summaryWrapper,children:[(0,l.BX)(f.G,{css:x.summaryRow,children:[(0,l.tZ)(f.G,{css:x.totalUsagePlaceholder}),(0,l.tZ)(f.G,{css:x.availablePlaceholder})]}),(0,l.BX)(f.G,{css:x.summaryRow,children:[(0,l.tZ)(f.G,{css:x.replSummaryTextPlaceholder}),(0,l.tZ)(f.G,{css:x.replUsagePlaceholder})]})]})]})}},65243:function(e,t,n){n.d(t,{g:function(){return o}});var r=n(74985),i=n(43312);function o(){return(0,r.tZ)(i.xB,{styles:[{body:{overflow:"hidden"}}]})}},46218:function(e,t,n){n.d(t,{GB:function(){return c},Un:function(){return l},pJ:function(){return a}});var r=n(98924),i=n(2694),o=[{tag:{name:"variableName"},description:"The name of a variable that is being accessed",title:"Variable Names"},{tag:{name:"variableName",modifiers:["definition"]},description:"The declaration of a new variable name",title:"Variable Definitions"},{tag:{name:"variableName",modifiers:["function"]},description:"A variable name that refers to a function",title:"Function References"},{tag:{name:"variableName",modifiers:["function","definition"]},description:"The declaration of a new function name",title:"Function Definitions"},{tag:{name:"keyword"},description:"A reserved word in a language that cannot be used as a variable or function name",title:"Keywords"},{tag:{name:"propertyName"},description:"A reference to a property or field of an object",title:"Property Names"},{tag:{name:"propertyName",modifiers:["definition"]},description:"The declaration of a property or field of an object",title:"Property Definitions"},{tag:{name:"propertyName",modifiers:["function"]},description:"A reference to a function that is a property of an object",title:"Function Properties"},{tag:{name:"tagName"},description:"The name of a tag in a markup language such as HTML",title:"Tag Names"},{tag:{name:"typeName"},description:"The declaration or reference of a data type in a language",title:"Type Names"},{tag:{name:"className"},description:"The name of a class being referenced or declared",title:"Class Names"},{tag:{name:"attributeName"},description:"A special modifier of an object or tag, similar to a property",title:"Attribute Names"},{tag:{name:"atom"},description:"A keyword denoting some atomic value",title:"Atomic Keywords"},{tag:{name:"comment"},description:"Any comment in a language, including single-line and multi-line comments",title:"Comments"},{tag:{name:"string"},description:"A sequence of characters enclosed in quotes or other delimiters",title:"Strings"},{tag:{name:"number"},description:"A numerical value",title:"Numbers"},{tag:{name:"bool"},description:"A boolean value, such as true or false",title:"Booleans"},{tag:{name:"regexp"},description:"A regular expression pattern, used to match or manipulate strings",title:"Regular Expressions"},{tag:{name:"operator"},description:"A symbol that performs an operation on one or more values. Examples include +, -, *, and /",title:"Operators"},{tag:{name:"squareBracket"},description:"A pair of square brackets (usually [ and ] tokens)",title:"Square Brackets"},{tag:{name:"angleBracket"},description:"A pair of angle brackets (usually < and > tokens)",title:"Angle Brackets"}],a=o.map(function(e){return e.tag}),l=o.reduce(function(e,t){var n=t.tag,i=(0,r._)(t,["tag"]);return e[c(n)]=i,e},{});function c(e){var t=(0,i.nZ)(e.name);if(!e.modifiers||0===e.modifiers.length)return t;var n=e.modifiers.slice().sort().map(i.nZ).join(", ");return"".concat(t," (").concat(n,")")}},95677:function(e,t,n){n.d(t,{O:function(){return x},s:function(){return w}});var r=n(41733),i=n(30509),o=n(98924),a=n(74985),l=n(46218),c=n(2694),s=function(e,t,n){var r=e.tags,i=e.values.color;if("string"==typeof i){var o=!0,a=!1,s=void 0;try{for(var u,d=r[Symbol.iterator]();!(o=(u=d.next()).done);o=!0){var f=u.value,h=(0,l.GB)(f),p=(0,c.TH)(i,n.global);p&&t.set(h,p)}}catch(e){a=!0,s=e}finally{try{o||null==d.return||d.return()}finally{if(a)throw s}}}},u=function(e){var t=e.editor.syntaxHighlighting,n=new Map,r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var c=a.value;s(c,n,e)}}catch(e){i=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n};function d(e){var t=u(e);return{functionDefinitionColor:t.get(f),standardVariableColor:t.get(h),stringColor:t.get(p),regexpColor:t.get(m),numberColor:t.get(v),typeNameColor:t.get(g),commentColor:t.get(y),literalColor:t.get(b),keywordColor:t.get(Z)}}var f=(0,l.GB)({name:"variableName",modifiers:["definition","function"]}),h=(0,l.GB)({name:"variableName",modifiers:["standard"]}),p=(0,l.GB)({name:"string"}),m=(0,l.GB)({name:"regexp"}),v=(0,l.GB)({name:"number"}),g=(0,l.GB)({name:"typeName"}),y=(0,l.GB)({name:"comment"}),b=(0,l.GB)({name:"literal"}),Z=(0,l.GB)({name:"keyword"}),w=function(e){var t=e.values,n=(0,o._)(e,["values"]),l=d(t);return(0,a.BX)("svg",(0,i._)((0,r._)({width:"292",height:"126",viewBox:"0 0 292 126",fill:"none",preserveAspectRatio:"none",xmlns:"http://www.w3.org/2000/svg"},n),{children:[(0,a.tZ)("rect",{x:"0.5",y:"0.5",width:"291",height:"125",fill:t.global.backgroundRoot}),(0,a.tZ)("rect",{x:"10",y:"10",width:"38",height:"106",rx:"4",fill:t.global.backgroundDefault}),(0,a.tZ)("rect",{x:"18",y:"18",width:"22",height:"6",rx:"1",fill:t.global.backgroundHigher}),(0,a.tZ)("rect",{x:"18",y:"32",width:"22",height:"6",rx:"1",fill:t.global.backgroundHighest}),(0,a.tZ)("rect",{x:"56",y:"10",width:"162",height:"106",rx:"4",fill:t.global.backgroundDefault}),(0,a.tZ)("rect",{x:"64.8767",y:"18",width:"51.0411",height:"3",rx:"1.5",fill:l.functionDefinitionColor}),(0,a.tZ)("rect",{x:"123.374",y:"18",width:"40.8329",height:"3",rx:"1.5",fill:l.stringColor}),(0,a.tZ)("rect",{x:"64.8767",y:"29",width:"24.4997",height:"3",rx:"1.5",fill:l.standardVariableColor}),(0,a.tZ)("rect",{x:"96.8329",y:"29",width:"67.3743",height:"3",rx:"1.5",fill:l.regexpColor}),(0,a.tZ)("rect",{x:"64.8767",y:"40",width:"42.8745",height:"3",rx:"1.5",fill:l.numberColor}),(0,a.tZ)("rect",{x:"115.208",y:"40",width:"87.7907",height:"3",rx:"1.5",fill:l.typeNameColor}),(0,a.tZ)("rect",{x:"64.8767",y:"51",width:"75.5408",height:"3",rx:"1.5",fill:l.standardVariableColor}),(0,a.tZ)("rect",{x:"147.874",y:"51",width:"46.9578",height:"3",rx:"1.5",fill:l.commentColor}),(0,a.tZ)("rect",{x:"64.8767",y:"62",width:"40.8329",height:"3",rx:"1.5",fill:l.literalColor}),(0,a.tZ)("rect",{x:"113.166",y:"62",width:"32.6663",height:"3",rx:"1.5",fill:l.keywordColor}),(0,a.tZ)("rect",{x:"151.07",y:"62",width:"38.7912",height:"3",rx:"1.5",fill:l.standardVariableColor}),(0,a.tZ)("rect",{x:"64.8767",y:"84",width:"77.5825",height:"3",rx:"1.5",fill:l.commentColor}),(0,a.tZ)("rect",{x:"149.915",y:"84",width:"51.0411",height:"3",rx:"1.5",fill:l.commentColor}),(0,a.tZ)("rect",{x:"64.8767",y:"95",width:"53.0827",height:"3",rx:"1.5",fill:l.commentColor}),(0,a.tZ)("rect",{x:"226",y:"10",width:"56",height:"58",rx:"4",fill:t.global.backgroundDefault}),(0,a.tZ)("rect",{x:"245",y:"30",width:"18",height:"18",rx:"4",fill:t.global.backgroundHigher}),(0,a.tZ)("path",{d:"M256.092 39L250.833 41.8921L250.833 36.1079L256.092 39Z",fill:"white",stroke:"white",strokeWidth:"2"}),(0,a.tZ)("rect",{x:"226.5",y:"76.5",width:"55",height:"39",rx:"3.5",fill:t.global.backgroundDefault}),(0,a.tZ)("circle",{cx:"238",cy:"88",r:"4",fill:t.global.backgroundRoot}),(0,a.tZ)("circle",{cx:"254",cy:"88",r:"4",fill:t.global.foregroundDefault}),(0,a.tZ)("circle",{cx:"270",cy:"88",r:"4",fill:t.global.outlineDefault}),(0,a.tZ)("circle",{cx:"238",cy:"104",r:"4",fill:t.global.accentPrimaryDefault}),(0,a.tZ)("circle",{cx:"254",cy:"104",r:"4",fill:t.global.accentPositiveDefault}),(0,a.tZ)("circle",{cx:"270",cy:"104",r:"4",fill:t.global.accentNegativeDimmest}),(0,a.tZ)("rect",{x:"226.5",y:"76.5",width:"55",height:"39",rx:"3.5",stroke:t.global.outlineDefault})]}))},x=function(e){var t=e.values,n=(0,o._)(e,["values"]),l=d(t);return(0,a.BX)("svg",(0,i._)((0,r._)({width:"84",height:"84",viewBox:"0 0 84 84",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n),{children:[(0,a.tZ)("rect",{width:"84",height:"84",rx:"4",fill:t.global.backgroundDefault}),(0,a.tZ)("rect",{x:"8.375",y:"8.375",width:"67.25",height:"45.6774",rx:"4.75",fill:t.global.backgroundHigher}),(0,a.tZ)("rect",{x:"14.2397",y:"14.4375",width:"21.5034",height:"2.40423",rx:"0.727819",fill:l.functionDefinitionColor}),(0,a.tZ)("rect",{x:"38.3682",y:"14.4375",width:"17.2027",height:"2.40423",rx:"0.727819",fill:l.stringColor}),(0,a.tZ)("rect",{x:"14.2397",y:"22.0918",width:"10.3216",height:"2.40423",rx:"0.727819",fill:l.standardVariableColor}),(0,a.tZ)("rect",{x:"27.1865",y:"22.0918",width:"28.3845",height:"2.40423",rx:"0.727819",fill:l.regexpColor}),(0,a.tZ)("rect",{x:"14.2397",y:"29.7461",width:"18.0629",height:"2.40423",rx:"0.727819",fill:l.numberColor}),(0,a.tZ)("rect",{x:"34.9277",y:"29.7461",width:"36.9859",height:"2.40423",rx:"0.727819",fill:l.typeNameColor}),(0,a.tZ)("rect",{x:"14.2397",y:"37.4004",width:"31.8251",height:"2.40423",rx:"0.727819",fill:l.standardVariableColor}),(0,a.tZ)("rect",{x:"48.6899",y:"37.4004",width:"19.7831",height:"2.40423",rx:"0.727819",fill:l.commentColor}),(0,a.tZ)("rect",{x:"14.2397",y:"45.0547",width:"17.2027",height:"2.40423",rx:"0.727819",fill:l.literalColor}),(0,a.tZ)("rect",{x:"34.0674",y:"45.0547",width:"13.7622",height:"2.40423",rx:"0.727819",fill:l.keywordColor}),(0,a.tZ)("rect",{x:"50.4546",y:"45.0547",width:"16.3426",height:"2.40423",rx:"0.727819",fill:l.standardVariableColor}),(0,a.tZ)("rect",{x:"8.375",y:"8.375",width:"67.25",height:"45.6774",rx:"4.75",stroke:t.global.outlineDefault}),(0,a.tZ)("rect",{x:"8.05695",y:"59.9847",width:"67.8861",height:"15.9586",rx:"5.06805",fill:t.global.backgroundHigher}),(0,a.tZ)("circle",{cx:"18.375",cy:"67.9639",r:"5.25",fill:t.global.foregroundDefault}),(0,a.tZ)("circle",{cx:"34.125",cy:"67.9639",r:"5.25",fill:t.global.accentPrimaryDefault}),(0,a.tZ)("circle",{cx:"49.875",cy:"67.9639",r:"5.25",fill:t.global.accentPositiveDefault}),(0,a.tZ)("circle",{cx:"65.625",cy:"67.9639",r:"5.25",fill:t.global.accentNegativeDefault}),(0,a.tZ)("rect",{x:"8.05695",y:"59.9847",width:"67.8861",height:"15.9586",rx:"5.06805",stroke:t.global.outlineDefault,strokeWidth:"0.363909"}),(0,a.tZ)("rect",{x:"0.5",y:"0.5",width:"83",height:"83",rx:"3.5",stroke:t.global.outlineDefault})]}))}},17054:function(e,t,n){n.d(t,{Dv:function(){return o},FR:function(){return l},Ys:function(){return s},ZS:function(){return d},io:function(){return a},oM:function(){return u}});var r=n(41733),i=n(75582),o=function(e){var t=e.slug,n=e.username,r=e.themeId,i={pathname:"/theme/@".concat(n,"/").concat(t,"/edit")};return{href:{pathname:"/themes/edit",query:{slug:t,username:n,themeId:r}},as:i}},a=function(e){var t=e.slug,n=e.username;return"".concat(window.location.origin,"/theme/@").concat(n,"/").concat(t)},l=function(e){var t=e.slug,n=e.username,r=e.themeId,i={pathname:"/theme/@".concat(n,"/").concat(t)};return{href:{pathname:"/themes/theme",query:{slug:t,username:n,themeId:r}},as:i}},c=function(e){return"string"==typeof e?e:null},s=function(e){var t={searchQuery:"",colorScheme:null,colorValue:null,authorId:null},n=c(e.searchQuery),r=c(e.colorScheme),o=c(e.authorId),a=c(e.colorValue);if(n&&(t.searchQuery=n),r&&(t.colorScheme="light"===r?i.CD.Light:i.CD.Dark),o){var l=parseInt(o,10);isNaN(l)||(t.authorId=l)}return a&&(t.colorValue=a),t},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={};return e.searchQuery&&e.searchQuery.length>0&&(t.searchQuery=e.searchQuery),e.colorScheme&&(t.colorScheme=e.colorScheme),e.colorValue&&(t.colorValue=e.colorValue),null!=e.authorId&&(t.authorId=e.authorId),{href:{pathname:"/themes",query:(0,r._)({},t)},as:{pathname:"/themes",query:(0,r._)({},t)}}},d={href:{pathname:"/themes/create"},as:{pathname:"/themes/create"}}},30601:function(e,t,n){n.d(t,{w:function(){return h}});var r=n(41733),i=n(66626),o=n(74985),a=n(43312),l=n(26508),c=n(29287),s=n(30826),u=n.n(s),d=n(50959),f=n(10422);function h(e){var t=e.targetElement,n=(0,i._)((0,d.useState)(null),2),s=n[0],h=n[1],m=(0,l.Z)(function(){t&&h({rect:t.getBoundingClientRect(),docWidth:document.documentElement.clientWidth,docHeight:document.documentElement.clientHeight})},{type:"throttle",wait:100});if((0,d.useEffect)(function(){t&&m(t)},[t,m]),(0,d.useEffect)(function(){if(t){var e=u()(function(){h({rect:t.getBoundingClientRect(),docWidth:document.documentElement.clientWidth,docHeight:document.documentElement.clientHeight})},100);return window.addEventListener("resize",e),window.addEventListener("scroll",e),function(){window.removeEventListener("resize",e),window.removeEventListener("scroll",e)}}},[t]),!s||!t)return null;var v=(0,a.iv)({backgroundColor:c.TV.backgroundOverlay,zIndex:c.n0+1,position:"fixed",transition:"all 0.5s ease-out"});return(0,f.createPortal)((0,o.BX)(o.HY,{children:[(0,o.tZ)("div",{id:"wat",css:[p((0,r._)({side:"left-top"},s)),v]}),(0,o.tZ)("div",{css:[p((0,r._)({side:"top-right"},s)),v]}),(0,o.tZ)("div",{css:[p((0,r._)({side:"right-bottom"},s)),v]}),(0,o.tZ)("div",{css:[p((0,r._)({side:"bottom-left"},s)),v]})]}),document.body)}function p(e){var t=e.side,n=e.rect,r=e.docWidth,i=e.docHeight;switch(t){case"left-top":return(0,a.iv)({top:0,left:0,width:Math.max(0,n.left),height:Math.max(0,n.bottom)});case"top-right":return(0,a.iv)({top:0,right:0,width:"calc(".concat(r,"px - ").concat(Math.max(0,n.left),"px)"),height:Math.max(0,n.top)});case"right-bottom":return(0,a.iv)({bottom:0,right:0,width:"calc(".concat(r,"px - ").concat(Math.max(0,n.right),"px)"),height:"calc(".concat(i,"px - ").concat(Math.max(0,n.top),"px)")});case"bottom-left":return(0,a.iv)({bottom:0,left:0,width:Math.max(0,n.right),height:"calc(".concat(i,"px - ").concat(Math.max(0,n.bottom),"px)")})}}},30869:function(e,t,n){n.d(t,{k:function(){return v}});var r=n(41733),i=n(30509),o=n(66626),a=n(74985),l=n(22487),c=n(26508),s=n(87659),u=n(30983),d=n(36227),f=n(29287),h=n(50959),p=n(10422),m=n(34335);function v(e){var t=e.targetElement,n=e.activeStep,v=e.goto,g=e.currentStepIndex,y=e.totalSteps,b=e.done,Z=e.disableAnimation,w=e.placement,x=e.cypressCloseData,C=e.onClickOutside,_=e.innerRef,S=e.width,E=(0,o._)((0,h.useState)(null),2),k=E[0],T=E[1],R=(0,o._)((0,h.useState)(null),2),D=R[0],I=R[1],G=(0,m.D)(t,k,{placement:void 0===w?"right":w,modifiers:[{name:"arrow",options:{element:D,padding:8}},{name:"offset",options:{offset:[0,16]}},{name:"preventOverflow",options:{padding:8}},{name:"flip",options:{fallbackPlacements:["top","bottom","left","right"]}},{name:"computeStyles",options:{adaptive:!1}}]}),B=(0,c.Z)(function(){var e;null===(e=G.update)||void 0===e||e.call(G)},{type:"throttle",wait:100});(0,h.useEffect)(function(){B(t)},[t,B]),(0,h.useImperativeHandle)(_,function(){return{updateTooltip:function(){var e;null===(e=G.update)||void 0===e||e.call(G)}}});var A=(0,l.Z)(function(){C&&C()},[C]);return(0,p.createPortal)((0,a.BX)("div",(0,i._)((0,r._)({ref:function(e){A.current=e,T(e)},style:G.styles.popper,css:{transition:Z?"all":"all 0.5s ease-out",zIndex:f.n0+2,width:null!=S?S:320}},G.attributes.popper),{children:[(0,a.tZ)(d.O,{title:n.title,content:n.content,onDismiss:function(){b()},currentStepIndex:g,onCurrentStepChange:v,totalSteps:y,cypressCloseData:void 0===x?"tour-tooltip-close-button":x}),(0,a.tZ)("span",{style:G.styles.arrow,css:[u.wk,{"&::after":{backgroundColor:s.Br.primary.dimmest,border:"1px solid "+s.Br.primary.dimmer}}],ref:I})]})),document.body)}},70781:function(e,t,n){n.d(t,{r:function(){return g},e:function(){return y.e}});var r=n(42516),i=n(41733),o=n(30509),a=n(66626),l=n(74985),c=n(26635),s=n(50959),u=n(14818),d=n(49344),f=n(36227);function h(){var e=(0,u.X)();if(!e)return null;var t=e.activeStep,n=e.goto,r=e.steps,i=e.done;return(0,l.tZ)(d.u,{preventClose:!0,isOpen:!!t.isModal,onRequestClose:function(){},centered:!0,maxWidth:"fit-content",noPadding:!0,children:(0,l.tZ)(f.O,{title:t.title,content:t.content,onDismiss:function(){i()},currentStepIndex:r.findIndex(function(e){return t.id===e.id}),onCurrentStepChange:n,totalSteps:r.length,cypressCloseData:"tour-tooltip-close-button"})})}var p=n(30601),m=n(30869),v=n(49500);function g(e){var t,n,d,f,g,y,b,Z,w,x,C,_=e.children,S=e.tour,E=e.isDoneInitialOverride,k=e.onStep,T=e.onDone,R=(0,a._)((0,s.useState)(S.steps[0]),2),D=R[0],I=R[1],G=(0,a._)((0,s.useState)({}),2),B=G[0],A=G[1],P=(t=S.id,f=(d=(0,c.Pp)({variables:{tours:t}})).data,g=d.loading,y=(0,a._)((0,c.oe)({variables:{name:t},optimisticResponse:{__typename:"RootMutationType",markTourAsSeen2:{__typename:"TourSeen",id:t,seen:!0}}}),1)[0],Z=(b=(0,a._)((0,s.useState)(E),2))[0],w=b[1],x=!!(null==f?void 0:null===(n=f.currentUser)||void 0===n?void 0:n.toursSeen[0].seen),"boolean"==typeof Z&&(x=Z),{isLoading:g,isDone:x,setIsDone:function(e){w(e),e&&y()}}),N=P.isDone,U=P.isLoading,O=P.setIsDone,L=S.steps.findIndex(function(e){return D.id===e.id});if(-1===L)throw Error("Current tour step is not in tour steps");function M(){O(!0),null==T||T(D.id)}var X=(0,s.useRef)();function F(e){X.current=D,null==k||k(e.id),I(e)}function W(e){if("number"==typeof e)t=e;else{var t;t=S.steps.findIndex(function(t){return e===t.id})}if(!(t<0)&&!(t>=S.steps.length)){for(var n=S.steps[t],r=t<L;!B[n.id]&&n.autoSkipIfNoTarget;){if((t=r?t-1:t+1)<0||t>=S.steps.length)return;n=S.steps[t]}F(n)}}function H(){W(0),O(!1)}var V=(0,s.useCallback)(function(e,t){var n=S.steps.findIndex(function(t){return e===t.id});if(-1===n)throw Error("Invalid step id");if(S.steps[n].isModal)throw Error("Trying to set a target element for a modal step");A(function(n){return n[e]===t?n:(0,o._)((0,i._)({},n),(0,r._)({},e,t))})},[S]),z=B[D.id],j=!N&&!U;window.startTour=function(){v.log("starting tour:",S.id,"from",S.steps[0].id),H()};var q=S.steps.filter(function(e){return!e.autoSkipIfNoTarget||!!B[e.id]}),Y=q.findIndex(function(e){return D.id===e.id});return(0,l.BX)(u.z,{value:(0,o._)((0,i._)({},S),{setStepTargetElement:V,activeStep:D,next:function(){var e=S.steps[L+1];if(e&&e.autoSkipIfNoTarget)for(var t=L+1;e&&e.autoSkipIfNoTarget&&!B[e.id];)t++,e=S.steps[t];if(!e){M();return}F(e)},prev:function(){var e=S.steps[L-1];if(e&&e.autoSkipIfNoTarget)for(var t=L-1;e&&e.autoSkipIfNoTarget&&!B[e.id];)t--,e=S.steps[t];e&&F(e)},goto:W,isDone:N,isLoading:U,done:M,restart:H}),children:[j&&D.isModal?(0,l.tZ)(h,{}):null,j&&z?(0,l.BX)(l.HY,{children:[(0,l.tZ)(p.w,{targetElement:z}),(0,l.tZ)(m.k,{targetElement:z,activeStep:D,currentStepIndex:Y,done:M,goto:function(e){W(e+L-Y)},totalSteps:q.length,disableAnimation:!!(0===L||(null===(C=X.current)||void 0===C?void 0:C.isModal))})]}):null,_]})}var y=n(89783)},24549:function(e,t,n){var r,i;n.d(t,{z:function(){return r}}),(i=r||(r={})).FileNode="FILE_NODE",i.FileHeaderTab="FILE_HEADER_TAB",i.Code="CODE",i.Pane="PANE",i.NewPane="NEW_PANE"},10099:function(e,t,n){var r=n(74985),i=n(76999),o=n.n(i),a=n(97754),l=n.n(a),c=n(10981);n(50959),t.Z=function(e){var t=e.name,n=void 0===t?"toggle":t,i=e.id,a=e.elevation,s=void 0===a?"higher":a,u=e.isOn,d=e.onIcon,f=e.offIcon,h=e.onChange,p=e.dataCy,m=(0,c.U)(),v=null!=i?i:m(n);return(0,r.BX)("label",{"data-cy":p,htmlFor:v,className:o().dynamic([["8d56ad7b5afff72c",[s]]])+" "+(l()("toggle-label",{isOn:u})||""),children:[(0,r.tZ)("input",{name:n,checked:u,onChange:h,id:v,type:"checkbox",className:o().dynamic([["8d56ad7b5afff72c",[s]]])+" toggle-checkbox"}),(0,r.tZ)("span",{className:o().dynamic([["8d56ad7b5afff72c",[s]]])+" toggle-button",children:u&&d?d:f||null}),(0,r.tZ)(o(),{id:"8d56ad7b5afff72c",dynamic:[s],children:".toggle-checkbox.__jsx-style-dynamic-selector{height:0;width:0;visibility:hidden}.toggle-label.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;cursor:pointer;width:38px;height:24px;background:var(--background-".concat(s,');border:.5px solid var(--outline-dimmest);-webkit-border-radius:100px;-moz-border-radius:100px;border-radius:100px;position:relative;-webkit-transition:background-color.2s;-moz-transition:background-color.2s;-o-transition:background-color.2s;transition:background-color.2s}.toggle-button.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;content:"";position:absolute;left:1px;width:20px;height:20px;-webkit-border-radius:45px;-moz-border-radius:45px;border-radius:45px;-webkit-transition:.2s;-moz-transition:.2s;-o-transition:.2s;transition:.2s;background:var(--white);-webkit-box-shadow:var(--shadow-1);-moz-box-shadow:var(--shadow-1);box-shadow:var(--shadow-1);color:var(--foreground-dimmer)}.toggle-label.isOn.__jsx-style-dynamic-selector{background-color:var(--accent-primary-default);border-color:var(--accent-primary-default)}.toggle-checkbox.__jsx-style-dynamic-selector:checked+.toggle-button.__jsx-style-dynamic-selector{-webkit-transform:translatex(-webkit-calc(100% - 6px));-moz-transform:translatex(-moz-calc(100% - 6px));-ms-transform:translatex(calc(100% - 6px));-o-transform:translatex(calc(100% - 6px));transform:translatex(-webkit-calc(100% - 6px));transform:translatex(-moz-calc(100% - 6px));transform:translatex(calc(100% - 6px));color:var(--accent-primary-default)}.toggle-label.__jsx-style-dynamic-selector:active .toggle-button.__jsx-style-dynamic-selector{-webkit-box-shadow:var(--shadow-2);-moz-box-shadow:var(--shadow-2);box-shadow:var(--shadow-2)}')})]})}},47648:function(e,t,n){n.d(t,{Z:function(){return y}});var r=n(41733),i=n(30509),o=n(98924),a=n(74985),l=n(49344),c=n(87001),s=n(51965),u=n(21262),d=n(71440),f=n(58995);function h(){var e=(0,u._)(["\n  query UpgradeModal {\n    currentUser {\n      id\n      cycles {\n        transactions(count: 1) {\n          items {\n            id\n            time_created\n          }\n        }\n      }\n    }\n  }\n"]);return h=function(){return e},e}function p(){var e=(0,u._)(["\n  query CurrentUserSubscriptionIdentify {\n    currentUser {\n      id\n      userSubscriptionType\n    }\n  }\n"]);return p=function(){return e},e}var m={},v=(0,d.Ps)(h()),g=(0,d.Ps)(p());function y(e){var t,n,u=e.isOpen,d=e.onRequestClose,h=e.onPlanCheckoutComplete,p=(0,o._)(e,["isOpen","onRequestClose","onPlanCheckoutComplete"]);return t=(0,r._)({},m,{ssr:!1,context:{noBatch:!0}}),f.a(v,t),n=(0,r._)({},m,void 0),f.a(g,n),(0,a.tZ)(l.u,(0,i._)((0,r._)({noPadding:!0,maxWidth:s.W,fitContent:!0,isOpen:u,onRequestClose:d},p),{children:(0,a.tZ)(s.Z,(0,i._)((0,r._)({},p),{onCyclesCheckoutComplete:d,onPlanCheckoutComplete:function(e){"function"==typeof h&&h(e),e!==c.Pg&&d()}}))}))}},62808:function(e,t,n){n.d(t,{Y:function(){return x},Z:function(){return E}});var r=n(74985),i=n(90367),o=n(51051),a=n(80979),l=n(92994),c=n(40497),s=n(16643),u=n(56596),d=n(29287),f=n(63461),h=n(86790),p=n(50959),m=n(99071),v=n(59173),g=(0,v.u)(null),y=(0,v.u)(null),b=(0,v.u)({from:0,to:0}),Z=a.p.mark({class:"ast-hover"}),w=a.tk.baseTheme({".ast-hover":{background:d.TV.backgroundHighest}});function x(e){var t=e.view,n=(0,l.Z)({view:t}),r=(0,h.k)();(0,p.useEffect)(function(){if(r&&t){g.current=t.state;var e=o.Py.define(),i=(0,m.uf)([y.subscribe(function(n){t.dispatch({effects:e.of(n)})}),b.subscribe(function(e){t.dispatch({selection:{anchor:e.from,head:e.to}})})]);return t.dispatch({effects:n.reconfigure([a.tk.updateListener.of(function(e){(e.selectionSet||e.docChanged)&&(g.current=e.state)}),o.QQ.define({create:function(){return a.p.none},update:function(t,n){return t=t.map(n.changes),(0,c.j)(n,e,function(e){t=null==e.value?a.p.none:a.p.set([Z.range(e.value.from,e.value.to)])}),t},provide:function(e){return a.tk.decorations.from(e)}}),w])}),function(){g.current=null,i(),t.dispatch({effects:n.reconfigure([])})}}},[t,r,n])}var C=(0,p.memo)(function(e){var t=e.node,n=e.index,i=e.active,o=e.terminal,a=t.type.name,l={from:t.from,to:t.to};return(0,r.BX)(u.G,{css:[{marginLeft:4*n+(o?4:0)},d.l0.mb(4),d.l0.rowWithGap(2),d.l0.align.center,d.l0.cursor.pointer],onMouseEnter:function(){y.current=l},onClick:function(){y.current=null,b.current=l},children:[(0,r.tZ)(f.Z,{size:"small",fontFamily:a.length>1?"sans-serif":"monospace",fontWeight:i?"bold":"regular",children:a}),(0,r.BX)(f.Z,{size:"xsmall",truncate:!0,children:["(",t.from,"  ",t.to,")"]})]})});function _(e,t){for(var n=[];t(e);)n.push(e.node);return n}var S=(0,p.memo)(function(e){var t=e.state,n=(0,i.qz)(t),o=t.selection.main.head,a=(0,p.useMemo)(function(){return _(n.cursorAt(o),function(e){return e.parent()}).reverse()},[n,o]),l=(0,p.useMemo)(function(){return _(n.cursorAt(o),function(e){return e.prevSibling()})},[n,o]),c=(0,p.useMemo)(function(){return _(n.cursorAt(o),function(e){return e.nextSibling()})},[n,o]);return(0,r.BX)(u.G,{css:d.l0.ml(4),onMouseLeave:function(){y.current=null},children:[a.map(function(e,t){return(0,r.tZ)(C,{node:e,index:t},t)}),l.map(function(e,t){return(0,r.tZ)(C,{node:e,index:a.length,terminal:!0},t)}),(0,r.tZ)(C,{node:n.resolveInner(t.selection.main.head),index:a.length,terminal:!0,active:!0}),c.map(function(e,t){return(0,r.tZ)(C,{node:e,index:a.length,terminal:!0},t)})]})});function E(e){var t=e.isHidden,n=(0,s.Z)(g);return t?null:n?(0,r.tZ)(S,{state:n}):null}},12621:function(e,t,n){n.d(t,{YX:function(){return Z},ho:function(){return w}});var r=n(12285),i=n(41733),o=n(30509),a=n(66626),l=n(74985),c=n(16643),s=n(74833),u=n(56596),d=n(32377),f=n(34815),h=n(88936),p=n(29287),m=n(61155),v=n(71984),g=n(50959),y=n(59173),b=n(98463),Z=new(function(){"use strict";function e(){var t=this;(0,r._)(this,e),this.counter=0,this.enabled=!1,this.maxEntries=10,this.logs=(0,y.u)([]),this.clear=function(){t.logs.current=[]}}var t=e.prototype;return t.toggle=function(e){this.enabled=e},t.add=function(e){var t=this,n=this.counter++;if(!this.enabled)return{id:n};var r={id:n,request:e,requestTime:Date.now()};return this.logs.update(function(e){return[r].concat(e).slice(0,t.maxEntries)}),{id:n}},t.update=function(e,t){this.enabled&&this.logs.update(function(n){var r=n.findIndex(function(t){return t.id===e.id});if(-1===r)return n;var i=n.slice();return i[r]=t(i[r]),i})},t.complete=function(e,t){this.update(e,function(e){return(0,o._)((0,i._)({},e),{response:t,responseTime:Date.now()})})},t.abort=function(e){this.logs.update(function(t){return t.filter(function(t){return t.id!==e.id||null!=t.responseTime})})},e}()),w=function(e){var t=e.isHidden,n=(0,c.Z)(Z.logs);return t?null:(0,l.BX)(u.G,{css:[p.l0.flex.column],children:[(0,l.BX)(u.G,{css:[p.l0.flex.row,p.l0.align.center,p.l0.m(4),p.l0.position.sticky,p.l0.top(0),p.l0.backgroundColor.backgroundDefault,p.l0.zIndex(1)],children:[(0,l.tZ)(s.xv,{css:p.l0.flex.grow(1),multiline:!1,children:"Requests"}),(0,l.tZ)(v.Z,{onClick:Z.clear})]}),(0,l.BX)(u.G,{css:[p.l0.flex.grow(1),p.l0.flex.column,p.l0.overflow("auto")],children:[n.map(function(e){var t;return(0,l.tZ)(x,{log:e},null!==(t=e.id)&&void 0!==t?t:e.requestTime.valueOf())}),!n.length&&(0,l.tZ)(u.G,{css:p.l0.m(4),children:"\uD83D\uDE14 No logs yet..."})]})]})},x=(0,g.memo)(function(e){var t,n=e.log,r=n.requestTime,i=n.responseTime,o=n.request,c=n.response,v=(0,a._)((0,m.Z)(!0),2),g=v[0],y=v[1],Z=o.code.length>20?"...".concat(o.code.slice(-20)):o.code;return(0,l.BX)(u.G,{css:[p.l0.my(4),p.l0.mx(4)],children:[(0,l.BX)(u.G,{role:"button",onClick:y,onKeyDown:y,tabIndex:0,css:[p.l0.flex.row,p.l0.rowWithGap(4),{"&:hover":{cursor:"pointer",".lspLog-requestMethod":{textDecoration:"underline"}}}],children:[(0,l.BX)(u.G,{css:[p.l0.flex.grow(1),p.l0.rowWithGap(2)],children:[(0,l.tZ)(s.xv,{multiline:!1,children:(t=n.response)?"CompleteCodeResult"===t.__typename?(0,l.tZ)(d.Z,{}):(0,l.tZ)(f.Z,{}):(0,l.tZ)(h.Z,{})}),(0,l.tZ)(s.xv,{multiline:!1,children:(0,l.tZ)("code",{children:Z})})]}),(0,l.tZ)(u.G,{css:{opacity:.5},children:null!=i&&(0,l.BX)(s.xv,{css:p.l0.fontSize(13),multiline:!1,children:[i.valueOf()-r.valueOf()," ms"]})})]}),!g&&(0,l.BX)(l.HY,{children:[void 0!==o&&(0,l.tZ)(b.g,{name:"request",src:o}),void 0!==c&&("CompleteCodeResult"===c.__typename?(0,l.BX)("details",{children:[(0,l.tZ)("summary",{children:"Response"}),(0,l.tZ)("pre",{css:[p.l0.overflow("scroll"),p.l0.borderRadius(4),p.l0.p(4),{border:"1px solid ".concat(p.TV.outlineDimmest)}],children:c.code})]}):(0,l.tZ)(b.g,{name:"response",src:c}))]})]})})},87271:function(e,t,n){n.d(t,{Sj:function(){return l},Th:function(){return o},UB:function(){return c},a0:function(){return s},cF:function(){return i},ot:function(){return a}});var r=n(90234),i=function(e,t){var n=e.dir,r=e.channel,i=e.cmd;return(!t.direction||n===t.direction)&&(!t.regexp||!t.regexp.test||!!(r.name&&t.regexp.test(r.name))||!!(r.service&&t.regexp.test(r.service))||!!t.regexp.test(JSON.stringify(i)))},o=(0,r.cn)([]),a=(0,r.cn)({regexp:null,direction:"",highlightOnly:!1}),l=(0,r.cn)(function(e){var t,n;return t=e(o),((n=e(a)).regexp||n.direction)&&!n.highlightOnly?t.filter(function(e){return i(e,n)}):t}),c=(0,r.cn)(null,function(e,t){t(o,[])}),s=(0,r.cn)(!1)},28131:function(e,t,n){n.d(t,{Z:function(){return u}});var r=n(66626),i=n(63257),o=n(54916),a=n(87271),l=n(71999),c=n(47611),s=n(50959);function u(){var e=(0,c.useRouter)(),t=(0,o.Z)().container,n=(0,r._)((0,l.KO)(a.a0),2),u=n[0],d=n[1],f=(0,l.b9)(a.Th);(0,s.useEffect)(function(){e.query.debug&&"undefined"!==e.query.debug&&d(!0)},[d,e.query.debug]),(0,s.useEffect)(function(){if(u)return t.client().onDebugLog(function(e){if("log"===e.type){if(e.log.channel){if(n={name:e.log.channel.name,service:null},"string"==typeof e.log.channel.service)n.service=e.log.channel.service;else if(e.log.channel.service){var n,r=t.getContext();r&&(n.service=e.log.channel.service(r))}}f(function(t){return(0,i._)(t).concat([{index:t[t.length-1]?t[t.length-1].index+1:0,channel:n,dir:e.log.direction,cmd:e.log.cmd,timestamp:window.performance.now()}])})}})},[u,f,t])}},98463:function(e,t,n){n.d(t,{L:function(){return B},g:function(){return P}});var r=n(42516),i=n(41733),o=n(30509),a=n(66626),l=n(63257),c=n(74985),s=n(10981),u=n(50959),d=n(97703),f=n(60769),h=n(15146),p=n(18836),m=n(74833),v=n(56596),g=n(87279),y=n(32377),b=n(58719),Z=n(12036),w=n(80339),x=n(21869),C=n(69640),_=n(97615),S=n(88936),E=n(29287),k=n(69926),T=n(10099),R=n(61155),D=n(71984),I=n(58091),G=n(99071),B=function(e){var t,n,r,d,g=e.isHidden,y=(n=(t=(0,a._)((0,u.useState)(null),2))[0],r=t[1],d=(0,I.R3)(),(0,u.useEffect)(function(){d!==n&&null!=d&&r(d)},[d,n]),n),b=(0,k.Z)(y||""),Z=(0,s.U)(),C=(0,a._)((0,R.Z)(!0),2),_=C[0],S=C[1],B=(0,a._)((0,u.useState)(""),2),P=B[0],U=B[1],O=(0,a._)((0,u.useState)(function(){return[]}),2),L=O[0],M=O[1],X=(0,a._)((0,R.Z)(!0),2),F=X[0],W=X[1],H=(0,a._)((0,R.Z)(!0),2),V=H[0],z=H[1],j=(0,u.useCallback)(function(e){M(function(t){return[e].concat((0,l._)(t)).slice(0,100)})},[]),q=(0,u.useCallback)(function(e,t){M(function(n){for(var r=0;r<n.length;r++)if(n[r].id===e){n[r]=t(n[r]);break}return n.slice(0,100)})},[]),Y=(0,u.useCallback)(function(){M([])},[]),$=null==b?void 0:b.isOpen(y||""),J=(0,u.useCallback)(function(){j({canceled:!1,notification:{method:"probe",params:{filePath:y,state:null==b?void 0:b.getServerState(),capabilities:null==b?void 0:b.getServerCapabilities(),diagnostics:$?null==b?void 0:b.getDiagnostics(y||""):[],isOpen:$,isSupportedFile:null==b?void 0:b.isSupportedFile(y||"")}},requestTime:new Date,type:"probe"})},[j,b,y,$]),K=(0,u.useMemo)(function(){var e=P.split(",").map(function(e){return e.trim()}).filter(Boolean);if(!e.length)return L;var t=L;return F||(t=t.filter(function(e){return null==e.notification})),V||(t=t.filter(function(e){return null==e.request})),P&&(t=t.filter(function(t){return e.some(function(e){var n;return null===(n=t.request||t.notification)||void 0===n?void 0:n.method.toLowerCase().includes(e.toLowerCase())})})),t},[L,F,V,P]);return((0,u.useEffect)(function(){return(0,G.uf)([null==b?void 0:b.onRequest(function(e){_&&j({id:e.id,canceled:!1,request:e.data,requestTime:new Date})}),null==b?void 0:b.onResponse(function(e){_&&q(e.id,function(t){return(0,i._)((0,o._)((0,i._)({},t),{responseTime:new Date}),void 0!==e.result?{response:e.result}:{error:e.error})})}),null==b?void 0:b.onCancelRequest(function(e){_&&q(e,function(e){return(0,o._)((0,i._)({},e),{canceled:!0})})}),null==b?void 0:b.onDiagnostics(function(e){var t=e.path,n=e.diagnostics;_&&j({canceled:!1,notification:{method:"textDocument/publishDiagnostics for "+t,params:n},requestTime:new Date,type:"diagnostics"})}),null==b?void 0:b.onServerStateChange(function(e){_&&j({canceled:!1,notification:{method:"state",params:{serverState:e}},requestTime:new Date,type:"state"})}),null==b?void 0:b.onServerCapabilitiesChange(function(e){_&&j({canceled:!1,notification:{method:"capabilities",params:{serverCapabilities:e}},requestTime:new Date,type:"capabilities"})}),null==b?void 0:b.onSendNotification(function(e){_&&j({canceled:!1,notification:e,requestTime:new Date})})])},[b,j,q,_]),g)?null:(0,c.BX)(v.G,{css:[E.l0.flex.column],children:[(0,c.BX)(v.G,{css:[E.l0.flex.row,E.l0.align.center,E.l0.m(4),E.l0.position.sticky,E.l0.top(0),E.l0.backgroundColor.backgroundDefault,E.l0.zIndex(1)],children:[(0,c.tZ)(m.xv,{multiline:!1,children:b?(0,c.BX)(c.HY,{children:[(0,c.tZ)(N,{})," logs for ",(0,c.tZ)("code",{children:y})]}):"No LSP client available"}),(0,c.tZ)(h.hU,{alt:"Probe LSP",onClick:J,children:(0,c.tZ)(w.Z,{})}),(0,c.tZ)(v.G,{css:E.l0.flex.grow(1)}),(0,c.tZ)(T.Z,{id:"toggleIsLogging",isOn:_,onChange:S})," "]}),(0,c.BX)(v.G,{css:[E.l0.rowWithGap(8),E.l0.m(4),E.l0.mb(8)],children:[(0,c.BX)(v.G,{css:E.l0.rowWithGap(4),children:[(0,c.tZ)(x.Z,{}),(0,c.tZ)(m.xv,{multiline:!1,children:"Show"})]}),(0,c.BX)(v.G,{css:E.l0.rowWithGap(4),children:[(0,c.tZ)(f.X,{id:Z("showNotifications"),checked:F,onChange:W}),(0,c.tZ)("label",{htmlFor:Z("showNotifications"),children:" Notifications"})]}),(0,c.BX)(v.G,{css:E.l0.rowWithGap(4),children:[(0,c.tZ)(f.X,{id:Z("showRequests"),checked:V,onChange:z}),(0,c.tZ)("label",{htmlFor:Z("showRequests"),children:" Requests"})]}),(0,c.tZ)(v.G,{css:E.l0.flex.growAndShrink(1)}),(0,c.tZ)(v.G,{css:E.l0.rowWithGap(4),children:(0,c.tZ)(D.Z,{onClick:Y})})]}),(0,c.tZ)(v.G,{css:E.l0.rowWithGap(4),children:(0,c.tZ)(p.II,{id:Z("filterLsp"),placeholder:"Filter by method (Separate by ,)",onChange:function(e){return U(e.target.value)},value:P})}),(0,c.BX)(v.G,{css:[E.l0.flex.grow(1),E.l0.flex.column,E.l0.overflow("auto")],children:[K.map(function(e,t){var n;return(0,c.tZ)(A,{log:e},null!==(n=e.id)&&void 0!==n?n:e.requestTime.valueOf()+""+t)}),!K.length&&(0,c.tZ)(v.G,{css:E.l0.m(4),children:"\uD83D\uDE14 No logs yet..."})]})]})},A=u.memo(function(e){var t,n,r,i,o,l=e.log,s=l.requestTime,u=l.responseTime,d=l.request,f=l.response,h=l.notification,p=l.id,x=(0,a._)((0,R.Z)(!0),2),k=x[0],T=x[1];return(0,c.BX)(v.G,{css:[E.l0.my(4),E.l0.mx(4)],children:[(0,c.BX)(v.G,{role:"button",onClick:T,onKeyDown:T,tabIndex:0,css:[E.l0.flex.row,E.l0.rowWithGap(4),{"&:hover":{cursor:"pointer",".lspLog-requestMethod":{textDecoration:"underline"}}}],children:[(0,c.BX)(v.G,{css:[E.l0.flex.grow(1),E.l0.rowWithGap(2)],children:[(0,c.tZ)(m.xv,{className:"lspLog-emoji",multiline:!1,children:(t=l.type,n=l.canceled,r=l.response,i=l.notification,"state"===t?(0,c.tZ)(Z.Z,{}):"diagnostics"===t?(0,c.tZ)(g.Z,{}):"capabilities"===t?(0,c.tZ)(C.Z,{}):"probe"===t?(0,c.tZ)(w.Z,{}):n?(0,c.tZ)(b.Z,{}):i?(0,c.tZ)(_.Z,{}):void 0!==r?(0,c.tZ)(y.Z,{}):(0,c.tZ)(S.Z,{}))}),(0,c.BX)(m.xv,{className:"lspLog-requestMethod",multiline:!1,children:[(0,c.tZ)("code",{children:null===(o=d||h)||void 0===o?void 0:o.method}),null!=p&&(0,c.BX)("code",{className:"lspLog-logId",css:{opacity:.5},children:["#",p]})]})]}),(0,c.tZ)(v.G,{css:{opacity:.5},children:null!=u&&(0,c.BX)(m.xv,{css:E.l0.fontSize(13),multiline:!1,children:[u.valueOf()-s.valueOf()," ms"]})})]}),!k&&(0,c.BX)(c.HY,{children:[void 0!==d&&(0,c.tZ)(P,{name:"request.params",src:d.params}),void 0!==h&&(0,c.tZ)(P,{name:"notification.params",src:h.params}),void 0!==f&&(0,c.tZ)(P,{name:"response",src:f})]})]})}),P=(0,u.memo)(function(e){var t=e.name,n=e.src;return(0,c.tZ)(v.G,{css:{marginTop:5,".node-ellipsis":{letterSpacing:-2},".object-key span":{letterSpacing:0},".object-key-val":{paddingBottom:"0 !important"},'.object-key + span[style*="margin"], .array-key + span[style*="margin"]':{marginLeft:"0 !important"},".variable-row, .pushed-content .object-key-val":{paddingLeft:"10px !important",paddingBottom:"0 !important"}},children:(0,c.tZ)(d.Z,{json:(0,r._)({},t,n)})})}),N=function(){return(0,c.tZ)(m.xv,{multiline:!1,css:{display:"inline",fontStyle:"italic",fontWeight:600,textShadow:"".concat(E.TV.redDimmer," 2px 2px")},children:"LSP"})}},61155:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(66626),i=n(50959);function o(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=(0,r._)((0,i.useState)(e),2),n=t[0],o=t[1];return[n,(0,i.useCallback)(function(){return o(function(e){return!e})},[])]}},46689:function(e,t,n){n.d(t,{AA:function(){return _},CH:function(){return y},Gg:function(){return v},Ne:function(){return E},pV:function(){return x},vk:function(){return Z}});var r=n(41733),i=n(21262),o=n(71440),a=n(79962),l=n(58995),c=n(99165);function s(){var e=(0,i._)(["\n  fragment AutograderTest on ReplTemplateTest {\n    id\n    name\n    input\n    output\n    name\n    type\n  }\n"]);return s=function(){return e},e}function u(){var e=(0,i._)(["\n  query Autograder($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        currentUserPermissions {\n          writeTests\n        }\n        template {\n          id\n        }\n        ioTests {\n          id\n          ...AutograderTest\n        }\n        unitTests {\n          meta {\n            id\n            ...UnitTestsReplUnitTestMeta\n          }\n          tests {\n            id\n            ...UnitTestsReplUnitTest\n            lastRun(replId: $replId) {\n              ... on ReplUnitTestLastRun {\n                status\n              }\n              ... on UserError {\n                message\n              }\n            }\n          }\n        }\n        isProject\n        isProjectFork\n        owner {\n          ... on Team {\n            id\n            isAdmin\n          }\n          ... on User {\n            id\n          }\n        }\n      }\n    }\n  }\n  ","\n  ","\n  ","\n"]);return u=function(){return e},e}function d(){var e=(0,i._)(["\n  mutation SaveIOTestResults(\n    $teamId: Int!\n    $replId: String!\n    $results: [IOTestResultInput!]!\n  ) {\n    saveIOTestResults(teamId: $teamId, replId: $replId, results: $results) {\n      ... on UserError {\n        message\n      }\n      ... on NotFoundError {\n        message\n      }\n    }\n  }\n"]);return d=function(){return e},e}function f(){var e=(0,i._)(["\n  mutation CreateAutograderTest($input: CreateTemplateTestInput!) {\n    createTemplateTest(input: $input) {\n      ... on ReplTemplateTest {\n        id\n        ...AutograderTest\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return f=function(){return e},e}function h(){var e=(0,i._)(["\n  mutation UpdateAutograderTest($input: UpdateTemplateTestInput!) {\n    updateTemplateTest(input: $input) {\n      ... on ReplTemplateTest {\n        id\n        ...AutograderTest\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return h=function(){return e},e}function p(){var e=(0,i._)(["\n  mutation DeleteAutograderTest($testId: Int!) {\n    deleteTemplateTest(testId: $testId) {\n      ... on ReplTemplate {\n        id\n        tests {\n          id\n          ...AutograderTest\n        }\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return p=function(){return e},e}var m={},v=(0,o.Ps)(s()),g=(0,o.Ps)(u(),v,a.aA,a.Rb);function y(e){var t=(0,r._)({},m,e);return l.a(g,t)}var b=(0,o.Ps)(d());function Z(e){var t=(0,r._)({},m,e);return c.D(b,t)}var w=(0,o.Ps)(f(),v);function x(e){var t=(0,r._)({},m,e);return c.D(w,t)}var C=(0,o.Ps)(h(),v);function _(e){var t=(0,r._)({},m,e);return c.D(C,t)}var S=(0,o.Ps)(p(),v);function E(e){var t=(0,r._)({},m,e);return c.D(S,t)}},37054:function(e,t,n){n.d(t,{pZ:function(){return eS},aT:function(){return e_},jg:function(){return ew},fD:function(){return ex},Ls:function(){return eZ}});var r=n(27387),i=n(96583),o=n(74985),a=n(51051),l=n(80979),c=n(57111),s=n(9135),u=n(76363),d=n(51944),f=n(92994);function h(e){var t=[],n=[],r=!1,i=!0,o=!1,a=void 0;try{for(var l,c=e.selection.ranges[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var s=l.value;s.empty||(t.push(e.sliceDoc(s.from,s.to)),n.push(s))}}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}if(!t.length){var u=-1,d=!0,f=!1,h=void 0;try{for(var p,m=e.selection.ranges[Symbol.iterator]();!(d=(p=m.next()).done);d=!0){var v=p.value.from,g=e.doc.lineAt(v);g.number>u&&(t.push(g.text),n.push({from:g.from,to:Math.min(e.doc.length,g.to+1)})),u=g.number}}catch(e){f=!0,h=e}finally{try{d||null==m.return||m.return()}finally{if(f)throw h}}r=!0}return{text:t.join(e.lineBreak),ranges:n,linewise:r}}function p(e){var t=e.selection,n=e.doc,r=t.ranges.map(function(e){return e.extend(n.lineAt(e.from).from,n.lineAt(e.to).to)});return a.jT.create(r)}var m=n(82200),v=n(445),g=n(22031),y=n(22421),b=n(13358),Z=n(23758),w=n(61018),x=n(75023),C=n(74106),_=n(25425),S=n(7444),E=n(10041),k=n(2689),T=n(59868),R=n(93918),D=n(44680),I=n(83215),G=n(87279),B=n(74883),A=n(32377),P=n(48728),N=n(78786),U=n(41859),O=n(64595),L=n(52924),M=n(44620),X=n(81),F=n(73030),W=n(19408),H=n(25934),V=n(12880),z=n(32781),j=n(8017),q=n(4832),Y=n(82723),$=n(48282),J=n(29287),K=n(72526),Q=n(69926),ee=n(56729),et=n(54916),en=n(50978),er=n(67774),ei=n(18440),eo=n(19724),ea=n(74652),el=n(27308),ec=n(38806),es=n(50959),eu=n(19659),ed=n(80259),ef=n(83898),eh=n(14917),ep=n(99952),em=n(50586);function ev(e,t,n){var r=e.selection.main,i=e.sliceDoc(r.from,r.to),o=(0,eu.r6)(t);return{code:i,filePath:t,fileVersion:n,fileContent:e.doc.toString(),range:{indexFrom:r.from,indexTo:r.to,lineFrom:e.doc.lineAt(r.from).number,lineTo:e.doc.lineAt(r.to).number},language:o}}var eg=(0,R.X)({ghostwriterIcon:[J.l0.color.blurpleStronger]});function ey(e){var t=e.label,n=e.icon,r=e.run,i=e.keyboardShortcut,o=e.dataCy;return{match:ed.pl,data:{type:"action",label:t,icon:n,run:r,keyboardShortcut:i,dataCy:o}}}function eb(e){var t=e.view,n=e.mainSelection,r=e.codeReference;t.dispatch({selection:{anchor:n.to},effects:[d.Q.of({codeReference:r,type:"ghostwriterKillswitch"}),l.tk.scrollIntoView(n.to,{y:"center"})]})}function eZ(e){var t=e.path,n=(0,et.Z)().fs,r=(0,eh.eD)(),i=(0,_.P5)({controlName:"flag-killswitch-ghostwriter-chat",logFlagToAnalytics:!1});return(0,es.useCallback)(function(e){r(t);var o=e.state,c=o.doc,s=o.selection,u=o.lineBreak,f=c.lineAt(s.main.head);f.length&&e.dispatch({changes:{from:f.to,insert:u},selection:a.jT.cursor(f.to+1)});var h=n.getOTVersion(t),p=ev(e.state,t,h);if((0,T.j)(T.U3.GHOSTWRITER_CHAT_INLINE_OPENED,{action:"GENERATE"}),i){eb({view:e,mainSelection:e.state.selection.main,codeReference:p});return}var m=e.state.selection.main.to;e.dispatch({selection:{anchor:m},effects:[d.Q.of({codeReference:p,type:"generateCode"}),l.tk.scrollIntoView(m,{y:"center"})]})},[t,n,r,i])}function ew(e){var t=e.path,n=(0,et.Z)().fs,r=(0,ep.Ef)(),i=(0,_.P5)({controlName:"flag-killswitch-ghostwriter-chat",logFlagToAnalytics:!1});return(0,es.useCallback)(function(e){r(t),e.dispatch({selection:p(e.state)});var o=n.getOTVersion(t),a=ev(e.state,t,o);if(i){eb({view:e,mainSelection:e.state.selection.main,codeReference:a});return}(0,T.j)(T.U3.GHOSTWRITER_CHAT_INLINE_OPENED,{action:"TRANSFORM"});var c=e.state.selection.main.to;e.dispatch({selection:{anchor:c},effects:[d.Q.of({type:"transformCode",codeReference:a}),l.tk.scrollIntoView(c,{y:"center"})]})},[t,n,r,i])}function ex(e){var t=e.path,n=(0,et.Z)().fs,r=(0,ef.ql)(),i=(0,_.P5)({controlName:"flag-killswitch-ghostwriter-chat",logFlagToAnalytics:!1});return(0,es.useCallback)(function(e){e.dispatch({selection:p(e.state)});var o=n.getOTVersion(t),a=ev(e.state,t,o);if((0,T.j)(T.U3.GHOSTWRITER_CHAT_INLINE_OPENED,{action:"EXPLAIN"}),i){eb({view:e,mainSelection:e.state.selection.main,codeReference:a});return}r({chatMessage:{type:"explainCode",codeReference:a,text:"Explain code"}});var c=e.state.selection.main.to;e.dispatch({selection:{anchor:c},effects:[d.Q.of({codeReference:a,type:"explainCode"}),l.tk.scrollIntoView(c,{y:"center"})]})},[n,t,i,r])}var eC="Rename all occurrences";function e_(e){var t,n,a,d,p,x,T,R,J,eu,ef,eh,ep,ev,eb,e_,eS,eE,ek,eT,eR,eD,eI,eG,eB,eA,eP,eN,eU=e.path,eO=e.openFile,eL=e.openSearchAndReplace,eM=e.view,eX=e.onCommand,eF=(t=eZ({path:eU}),n=ew({path:eU}),a=ex({path:eU}),d=(0,ea.gf)(em.x.id),(0,es.useCallback)(function(e){var r=[],i=!e.state.selection.main.empty;return t&&!i&&r.push(ey({label:"Generate",icon:(0,o.tZ)(H.Z,{css:eg.ghostwriterIcon}),keyboardShortcut:d,run:function(){t(e)},dataCy:"context-menu-GenerateCode"})),i&&(r.push(ey({label:"Explain",icon:(0,o.tZ)(W.Z,{css:eg.ghostwriterIcon}),dataCy:"context-menu-ExplainCode",run:function(){a(e)}})),r.push(ey({label:"Modify",icon:(0,o.tZ)(V.Z,{css:eg.ghostwriterIcon}),keyboardShortcut:d,dataCy:"context-menu-TransformCode",run:function(){n(e)}}))),r},[t,n,a,d])),eW=(p=(0,ea.gf)("editor.action.startThread"),(0,es.useCallback)(function(e){var t=[];return t.push(ey({label:"Start thread",icon:(0,o.tZ)(B.Z,{}),keyboardShortcut:p,run:function(){(0,en.h$)(e)}})),t},[p])),eH=(0,es.useCallback)(function(e){var t=[ey({label:"Copy link to position",icon:(0,o.tZ)(j.Z,{}),run:function(){var t=(0,C.sg)(e.state.doc,e.state.selection.main.head),n=t.line,r=t.character,i=(0,ec.dr)({path:eU,line:n+1,col:r});(0,E.Z)(i)}}),ey({label:"Copy",icon:(0,o.tZ)(U.Z,{}),keyboardShortcut:(0,el.l2)({cmdOrCtrl:!0,key:"c"}),run:function(){var t=h(e.state).text;(0,E.Z)(t)}}),ey({label:"Cut",icon:(0,o.tZ)(O.Z,{}),keyboardShortcut:(0,el.l2)({cmdOrCtrl:!0,key:"x"}),run:function(){var t=h(e.state),n=t.text,r=t.ranges;(0,E.Z)(n),e.state.readOnly||e.dispatch({changes:r,scrollIntoView:!0,userEvent:"delete.cut"})}})];return window.navigator.clipboard&&"readText"in window.navigator.clipboard&&t.push(ey({label:"Paste",icon:(0,o.tZ)(P.Z,{}),keyboardShortcut:(0,el.l2)({cmdOrCtrl:!0,key:"v"}),run:function(){return(0,r._)(function(){var t,n;return(0,i.Jh)(this,function(r){switch(r.label){case 0:t="",r.label=1;case 1:return r.trys.push([1,3,,4]),[4,window.navigator.clipboard.readText()];case 2:return t=r.sent(),[3,4];case 3:return n=r.sent(),k.kg.error("CodeMirror context menu paste failed",{message:n.message}),[2];case 4:return(0,w.l)({filePath:eU,view:e,clipboardText:t}),[2]}})})()}})),t},[eU]),eV=(T=(x={path:eU,openFile:eO,openSearchAndReplace:eL}).path,R=x.openFile,J=x.openSearchAndReplace,eu=(0,Q.Z)(T),ef=(0,ee.Z)(eu),eh=(0,es.useRef)(null),ep=(0,et.Z)().fs,ev=(0,_.P5)({controlName:"flag-clui-ctx-menu-rename-all",logFlagToAnalytics:!1}),eb=(0,ea.gf)("editor.action.goToDefinition"),e_=(0,ea.gf)("editor.action.goToTypeDefinition"),eS=(0,ea.gf)("editor.action.goToImplementation"),eE=(0,ea.gf)("editor.action.goToReferences"),ek=(0,ea.gf)("editor.selection.allOccurrences"),eT=(0,ea.gf)("editor.action.formatDocument"),eR=(0,ea.gf)("editor.action.codeActions"),(0,es.useCallback)(function(e){var t=[],n=ef&&eu;n&&ef.isFindDefinitionSupported&&R&&t.push(ey({label:"Go to definition",icon:(0,o.tZ)(M.Z,{}),dataCy:"context-menu-JumpToDefinition",run:function(t){(0,g.wK)(e,t)},keyboardShortcut:eb})),n&&ef.isFindTypeDefinitionSupported&&R&&t.push(ey({label:"Go to type definition",icon:(0,o.tZ)(D.Z,{}),run:function(){(0,g.OM)(e)},keyboardShortcut:e_})),n&&ef.isFindImplementationSupported&&R&&t.push(ey({label:"Go to implementation",icon:(0,o.tZ)($.Z,{}),run:function(){(0,g.Zc)(e)},keyboardShortcut:eS})),n&&(ef.isFindDefinitionSupported||ef.isFindReferencesSupported)&&t.push(ey({label:"Go to references",icon:(0,o.tZ)(I.Z,{}),keyboardShortcut:eE,run:function(){(0,y.Z)(e)}})),J&&t.push(ey({label:"Find in Repl",icon:(0,o.tZ)(Y.Z,{}),run:function(){J(h(e.state).text)}})),n&&ef.isRenameSupported&&(ev?t.push(ey({label:eC,icon:(0,o.tZ)(L.Z,{}),keyboardShortcut:"F2",run:function(){(0,b.Z)(e)}})):t.push({match:ed.pl,data:{type:"context",label:eC,icon:(0,o.tZ)(L.Z,{}),keyboardShortcut:"F2"},commands:function(t){var n=t.active,a=t.search;return n&&a?[{match:function(){return{score:1}},data:{type:"action",label:"Rename",icon:(0,o.tZ)(A.Z,{}),keyboardShortcut:"Enter",run:function(){return(0,r._)(function(){var t,n,r;return(0,i.Jh)(this,function(i){switch(i.label){case 0:if(t=e.state.selection.main.head,!e.state.wordAt(t))return[2,{type:"error",message:"You cannot rename this element"}];return eh.current&&eu.notify.cancelRequest(eh.current),eh.current=eu.generateId(),[4,eu.request.rename(T,(0,C.sg)(e.state.doc,t),a,{id:eh.current,tap:function(t){return(0,m.SC)(e,t)}})];case 1:if((n=i.sent()).cancelled)return[2];if("error"in n)return[2,{type:"error",message:"Something went wrong renaming ".concat(n.error.message)}];if(!(r=n.result))return[2];return(0,K.w)({edit:r,fs:ep,client:eu}),[2]}})})()}}}]:[]}})),e.state.facet(s.SD)&&t.push(ey({label:"Format document",icon:(0,o.tZ)(X.Z,{}),keyboardShortcut:eT,run:function(){(0,s.z1)(e)}})),!e.state.selection.main.empty&&e.state.facet(u.R2)&&t.push(ey({label:"Format selection",icon:(0,o.tZ)(X.Z,{}),run:function(){(0,s.uy)(e)}})),t.push(ey({label:"Select all occurrences",icon:(0,o.tZ)(N.Z,{}),keyboardShortcut:ek,run:function(){(0,en.SK)(e)}}));var a=void 0!==e.state.field(c.K0,!1);return n&&a&&t.push(ey({label:"Toggle breakpoint",icon:(0,o.tZ)(G.Z,{}),run:function(){(0,en.QF)(e)}})),n&&ef.isCodeActionsSupported&&t.push(ey({label:"More actions",icon:(0,o.tZ)(z.Z,{}),keyboardShortcut:eR,run:function(){(0,v.b)(e,!0)}})),t},[ef,eu,R,J,ek,eb,e_,eS,eE,ev,T,ep,eT,eR])),ez=(eD=(0,ei.s6)(eo.Y.EditorContextMenu),(0,es.useCallback)(function(e){var t=[];return t.push({data:{type:"group",key:"extensions"},commands:(0,r._)(function(){var t;return(0,i.Jh)(this,function(n){switch(n.label){case 0:var o;return t=[{data:{filePath:e.filePath,selection:e.view.state.selection.toJSON()}}],[4,Promise.all(eD.map((o=(0,r._)(function(e){var n;return(0,i.Jh)(this,function(r){switch(r.label){case 0:return[4,e.create({path:t})];case 1:if(!(n=r.sent()))return[2,null];return[2,(0,er.C)(n,{path:t})]}})}),function(e){return o.apply(this,arguments)})))];case 1:return[2,n.sent().filter(Boolean)]}})})}),t},[eD])),ej=(0,es.useMemo)(function(){return eM?eV(eM):[]},[eM,eV]);return eG=(eI={view:eM,commands:ej,onCommand:eX}).view,eB=eI.commands,eA=eI.onCommand,eP=(0,S.Z)(eA),eN=(0,f.Z)({view:eG}),(0,es.useEffect)(function(){if(eG){var e=[],t=!0,n=!1,r=void 0;try{for(var i,o=eB[Symbol.iterator]();!(t=(i=o.next()).done);t=!0)!function(){var t=i.value,n=t.data;if(("context"===n.type||"action"===n.type)&&n.keyboardShortcut){var r=Array.isArray(n.keyboardShortcut)?n.keyboardShortcut.join(" "):n.keyboardShortcut;e.push({run:function(){if("action"===n.type)return n.run(null),!0;var e=eG.state.selection.main.head;return"context"!==n.type||n.label!==eC||eG.state.wordAt(e)?eP.current(t):(0,Z.J)(eG,{message:"You cannot rename this element",offset:e}),!0},key:r,preventDefault:!0})}}()}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}try{eG.dispatch({effects:eN.reconfigure(l.$f.of(e))})}catch(e){(0,l.OO)(eG.state,e,"contextMenu")}return function(){try{eG.dispatch({effects:eN.reconfigure([])})}catch(e){(0,l.OO)(eG.state,e,"contextMenu")}}}},[eG,eB,eN,eP]),(0,es.useCallback)(function(){var e=eM?[{data:{type:"context",label:"AI",icon:(0,o.tZ)(F.Z,{})},commands:function(){return eF(eM)}},{data:{type:"context",label:"Code actions",icon:(0,o.tZ)(z.Z,{})},commands:function(){return eV(eM)}},{data:{type:"context",label:"Social",icon:(0,o.tZ)(B.Z,{})},commands:function(){return eW(eM)}},{data:{type:"context",label:"Clipboard",icon:(0,o.tZ)(P.Z,{})},commands:function(){return eH(eM)}},{data:{type:"context",label:"Extensions",icon:(0,o.tZ)(q.Z,{})},commands:function(){return ez({view:eM,filePath:eU})}}]:[];return{data:{type:"context",label:"Search actions",icon:(0,o.tZ)(Y.Z,{})},commands:function(){return e}}},[eM,eF,eV,eW,eH,eU,ez])}var eS=new x.j(function(e,t){return e?null:l.tk.domEventHandlers({contextmenu:function(e,n){var r=e.clientX,i=e.clientY,o=n.state.selection.main,l=n.posAtCoords({x:r,y:i}),c=n.state.doc.length,s=null===l?c:l;if(s<o.from||s>o.to){var u=a.jT.cursor(s);n.dispatch({selection:u})}return t(e),!0}})})},45549:function(e,t,n){n.d(t,{u:function(){return eb}});var r,i=n(66626),o=n(74985),a=n(51051),l=n(12285),c=n(42516),s=n(80979),u=n(35895),d=n(75023),f=n(93918),h=n(74833),p=n(29287),m=n(56596),v=n(74652),g=n(59510),y=n.n(g),b=n(53466),Z=n(54472),w=n(7612),x=(0,f.X)({root:[p.l0.p(16),p.l0.align.center,p.l0.colWithGap(8),{marginTop:"10%",pointerEvents:"none","*":{pointerEvents:"all"}}],button:[p.l0.reset.button,p.l0.rowWithGap(4),p.l0.align.center,p.l0.color.foregroundDimmest,p.l0.cursor.pointer,{fontFamily:p.TV.fontFamilyDefault,"*":{borderColor:p.TV.foregroundDimmest,color:p.TV.foregroundDimmest},":hover *":{borderColor:p.TV.foregroundDefault,color:p.TV.foregroundDefault}}]}),C={layer:"cm-empty-state-layer",dom:"cm-empty-state-dom"},_=s.tk.theme((r={},(0,c._)(r,".".concat(C.layer),{width:"100%",height:"100%",pointerEvents:"none",zIndex:"201 !important"}),(0,c._)(r,".".concat(C.dom),{position:"absolute",width:"100%",pointerEvents:"none",display:"flex",justifyContent:"center"}),r)),S=function(){"use strict";function e(t){(0,l._)(this,e),this.options=t}var t=e.prototype;return t.draw=function(){var e=this.options,t=e.ctas,n=e.view,r=e.width,i=(0,Z.VV)((0,o.tZ)(m.G,{css:x.root,children:t.map(function(e){return(0,o.BX)(m.G,{css:x.button,onClick:function(){return e.onClick(n)},children:[e.icon,(0,o.tZ)(h.xv,{variant:"small",children:e.text}),e.shortcut?(0,o.tZ)(v.bM,{keyCombo:e.shortcut,small:!0}):null]},e.text)})}));return i.className=C.dom,i.style.width=r+"px",i.style.visibility=r>240?"visibile":"hidden",i.style.left="0px",i},t.eq=function(e){return y()(e.options,this.options)},e}(),E=new d.j(function(e){var t=function(e){var t;return!(e.doc.length>0||e.field(b.$))&&(null===(t=e.field(u.xg,!1))||void 0===t||!t.size)},n=a.QQ.define({create:t,update:function(e,n){return t(n.state)}}),r=(0,s.EY)({above:!0,class:C.layer,update:function(e){return(0,w.a)(e,n)},markers:function(t){if(!t.state.field(n,!1))return[];var r=t.dom.getBoundingClientRect();return[new S({ctas:e,width:Math.round(t.contentDOM.getBoundingClientRect().right-r.left),view:t})]}});return[_,n,r]}),k=n(75595),T=n(40497),R=n(73164),D=n(2038),I=n(59868),G=n(49344),B=n(25934),A=n(31270),P=n(48282),N=n(43312),U=n(4498),O=n(93496),L=n(29479),M=n(88936),X=n(50959),F=n(41733),W=n(21262),H=n(71440),V=n(58995);function z(){var e=(0,W._)(["\n  query ReplCodeExamples($language: String!) {\n    languageExamples(language: $language) {\n      ... on LanguageExamples {\n        examples {\n          ... on LanguageExample {\n            mainFile\n            name\n            code\n          }\n        }\n      }\n    }\n  }\n"]);return z=function(){return e},e}var j={},q=(0,H.Ps)(z());function Y(e){var t=(0,F._)({},j,e);return V.a(q,t)}var $=m.K.button;function J(e){var t=e.name,n=e.children,r=e.onClick;return(0,o.BX)($,{onClick:function(){return r()},css:[O.gU.nofill,p.l0.p(8),p.l0.focusRing,p.l0.textAlign.left],children:[(0,o.tZ)(h.xv,{variant:"subheadDefault",css:p.l0.pb(16),multiline:!1,children:t}),(0,o.tZ)(m.G,{css:[p.l0.backgroundColor.backgroundDefault,p.l0.p(8),p.l0.borderRadius(8)],children:n})]})}var K="@media (min-width: ".concat(L.j.tabletMax,"px)"),Q=(0,N.iv)([p.l0.colWithGap(16),(0,c._)({},K,{width:"calc(50%  - 8px)",flex:"0 0 auto",gap:"16px"})]);function ee(e){var t=e.children;return(0,o.tZ)(m.G,{css:[(0,c._)({},K,[p.l0.rowWithGap(16)])],children:t})}function et(e){var t=e.mainFile,n=e.examples,r=e.onSelect;return(0,o.BX)(m.G,{css:[p.l0.colWithGap(24)],children:[(0,o.tZ)(h.h4,{level:1,variant:"headerDefault",children:"Code examples"}),(0,o.tZ)(h.xv,{children:"Get started with some program examples."}),(0,o.BX)(ee,{css:[p.l0.colWithGap(16)],children:[(0,o.tZ)(m.G,{css:Q,children:n.slice(0,(n.length+1)/2).map(function(e){return(0,o.tZ)(J,{name:e.name,onClick:function(){return r(e)},children:(0,o.tZ)(U.Z,{code:e.code,filePath:t,fontSize:12,disableCursorStyling:!0})},e.name)})}),(0,o.tZ)(m.G,{css:Q,children:n.slice((n.length+1)/2).map(function(e){return(0,o.tZ)(J,{name:e.name,onClick:function(){return r(e)},children:(0,o.tZ)(U.Z,{code:e.code,filePath:t,fontSize:12,disableCursorStyling:!0})},e.name)})})]})]})}function en(e){var t=e.filePath,n=e.language,r=e.onSelect,i=Y({variables:{language:n}}),a=i.data,l=i.loading,c=i.error;if(l)return(0,o.tZ)(m.G,{css:[p.l0.colWithGap(0),p.l0.justify.center,p.l0.align.center,p.l0.pt(32),p.l0.pb(32)],children:(0,o.tZ)(M.Z,{})});if(c)return(0,o.tZ)(m.G,{css:[p.l0.colWithGap(0),p.l0.justify.center,p.l0.align.center,p.l0.pt(32),p.l0.pb(32)],children:c.message});var s=(null==a?void 0:a.languageExamples.__typename)==="LanguageExamples"?a.languageExamples.examples:null;return(null==s?void 0:s.length)?(null==s?void 0:s.length)?(0,o.tZ)(et,{mainFile:t,examples:s,onSelect:r}):(0,o.tZ)(m.G,{css:[p.l0.colWithGap(0),p.l0.justify.center,p.l0.align.center,p.l0.pt(32),p.l0.pb(32)],children:(0,o.BX)(h.xv,{children:["Sorry, this language doesnt have any examples. Want to add some? Contact us at ",(0,o.tZ)("a",{href:"mailto:support@replit.com",children:"support@replit.com"}),"!"]})}):null}var er=n(50586),ei=n(88883),eo={python:'from replit.ai.modelfarm import ChatExample, ChatMessage, ChatModel, ChatSession\n\nmodel = ChatModel("chat-bison")\nresponse = model.chat([\n  ChatSession(\n    context="You are philosophy bot.",\n    examples=[\n      ChatExample(\n        input=ChatMessage(content="1 + 1"),\n        output=ChatMessage(content="2")\n      )\n    ],\n    messages=[\n      ChatMessage(author="USER", content="How much wood can a woodchuck chuck?"),\n    ],\n  )\n], temperature=0.2)\n\nprint(response.responses[0].candidates[0].message.content)',typescript:"import * as replitai from '@replit/ai-modelfarm';\n\nconst result = await replitai.chat({\n  model: 'chat-bison',\n  temperature: 0.5,\n  messages: [{ author: 'user', content: 'how are you?' }],\n});\n\nconsole.log(result);"},ea=n(75582),el=n(73524);function ec(){var e=(0,W._)(["\n  query EditorEmptyStateCurrentUser {\n    currentUser {\n      id\n      userSubscriptionType\n      userPowerUpsByType {\n        __typename\n        ... on UserPowerUpsTypes {\n          ghostwriter {\n            active\n            CTA\n          }\n        }\n      }\n    }\n  }\n"]);return ec=function(){return e},e}var es={},eu=(0,H.Ps)(ec()),ed=n(38041),ef=n(917),eh=n(70781),ep=n(19659),em=a.Py.define(),ev=a.QQ.define({create:function(){return null},update:function(e,t){var n=e;return(0,T.j)(t,em,function(e){n=e.value}),n}}),eg=k.t.from(ev,function(e){if(!e)return null;var t=e.language,n=e.filePath;return{key:"examplesModal",node:function(e){var r=function(){e.dispatch({effects:em.of(null)})};return(0,o.tZ)(G.u,{maxWidth:872,isOpen:!0,onRequestClose:r,children:(0,o.tZ)(eZ,{onRequestClose:r,language:t,filePath:n})})}}}),ey=[ev,eg];function eb(e){var t,n,r,i,a,l,c,s,u,d,f,h,p,m,g,y,b,Z=e.isMobile,w=e.filePath,x=e.generateCode,C=e.openPane,_=(0,v.gf)(er.x.id),S=null!==(y=null===(p=R.$R.from(w))||void 0===p?void 0:p.id)&&void 0!==y?y:null,k=Y({variables:{language:S},skip:!S}).data,T=(a=(t={openPane:C,filePath:w,language:S}).filePath,l=t.language,c=t.openPane,s=(0,D.T3)(),d=((null==(u=(n=(0,F._)({},es,void 0),V.a(eu,n)).data)?void 0:null===(r=u.currentUser)||void 0===r?void 0:r.userSubscriptionType)===ea.HP.Hacker||(null==u?void 0:null===(i=u.currentUser)||void 0===i?void 0:i.userSubscriptionType)===ea.HP.HackerPro)&&l&&["python","javascript","typescript","javascriptreact","typescriptreact"].includes(l),f=(0,ei.Z)(a),h=(0,X.useCallback)(function(){if(l){var e="python"===l?"python":"typescript";(0,I.j)(I.U3.GHOSTWRITER_CHAT_MODELFARM_PLACEHOLDER_CLICKED,{language:e}),c({type:"docs",data:{url:el.TT.MODEL_FARM+"/".concat(e,"#installation")}}),f&&f({code:eo[e],insertAt:0})}},[f,l,c]),s?null:d?h:null),G=(null!==(b=null==k?void 0:null===(g=k.languageExamples)||void 0===g?void 0:null===(m=g.examples)||void 0===m?void 0:m.length)&&void 0!==b?b:0)>=1,N=(0,X.useMemo)(function(){var e=[];return(0,ep.gK)(w)||e.push({icon:(0,o.tZ)(B.Z,{}),text:"Generate Code with AI",shortcut:Z?void 0:_,onClick:function(e){(0,ed.S)({cta:"generate",version:"new"}),x(e)}}),T&&e.push({icon:(0,o.tZ)(A.Z,{}),text:"Build an AI app for free with ModelFarm",onClick:function(){(0,ed.S)({cta:"modelFarm",version:"new"}),T()}}),S&&G&&e.push({icon:(0,o.tZ)(P.Z,{}),text:"Start with a code example",onClick:function(e){(0,ed.S)({cta:"examples",version:"new"}),e.dispatch({effects:em.of({language:S,filePath:w})})}}),e},[Z,_,T,S,G,x,w]);return[E.use(N),ey]}function eZ(e){var t=e.onRequestClose,n=e.language,r=e.filePath,a=(0,eh.e)(ef.y.Examples),l=(0,eh.e)(ef.y.Editor),c=(0,i._)((0,X.useState)(!1),2),s=c[0],u=c[1],d=(0,ei.Z)(r),f=(0,X.useRef)(null==a?void 0:a.isActive),h=(0,X.useRef)();h.current=null==a?void 0:a.isActive;var p=(0,X.useRef)(null==a?void 0:a.goto);return(p.current=null==a?void 0:a.goto,(0,X.useEffect)(function(){return function(){var e;h.current&&(null===(e=p.current)||void 0===e||e.call(p,ef.y.Editor))}},[]),(0,X.useEffect)(function(){if((null==l?void 0:l.isActive)&&!f.current){if(!s){u(!0);return}l.goto(ef.y.Examples)}},[l,t,s]),(0,X.useEffect)(function(){if(null==a?void 0:a.isActive){f.current=!0;return}f.current&&t(null)},[t,null==a?void 0:a.isActive]),d)?(0,o.tZ)("div",{ref:null==a?void 0:a.delegateTooltip,children:(0,o.tZ)(en,{filePath:r,language:n,onSelect:function(e){d({code:e.code,insertAt:0}),t({exampleName:e.name})}})}):(0,o.tZ)("div",{children:"Please make sure you have a file open"})}},5018:function(e,t,n){n.d(t,{Fs:function(){return l},ZM:function(){return c}});var r=n(51051),i=n(75023);n(3947);var o=r.r$.define({combine:function(e){var t;return null!==(t=e[0])&&void 0!==t?t:null}}),a=new i.j(function(e){return o.of(e)});function l(e){return a.use(e)}function c(e,t){var n,r=t.pane,i=t.secondary;return!!(n=e.facet(o))&&n({operation:"open",pane:r,secondary:void 0===i||i})}},50586:function(e,t,n){n.d(t,{x:function(){return $},W:function(){return J}});var r,i=n(74985),o=n(80979),a=n(12285),l=n(42516),c=n(41733),s=n(30509),u=n(51051),d=n(75023),f=n(91608),h=n(44166),p=n(93496),m=n(38080),v=n(74833),g=n(30983),y=n(56596),b=n(93918),Z=n(13900),w=n(29287),x=n(74652),C=n(95684),_=n(59510),S=n.n(_),E=n(50959),k=n(53466),T=n(54472),R=n(40497),D=n(7612),I=(0,f.$)(["opacity","transform"]),G=I.cssVars,B=I.styleTokens,A=[w.l0.display.flex,w.l0.reset.button,w.l0.cursor.pointer,w.l0.center,p.gU.nofill,w.l0.height("100%"),w.l0.borderRadius(0)],P=[A,w.l0.width(28),{"& svg":w.l0.display.block}],N=(0,b.X)({root:[w.l0.align.stretch,w.l0.flex.row,w.l0.borderRadius(6),w.l0.border({color:w.TV.outlineDefault}),w.l0.position.relative,w.l0.height(30),{opacity:B.opacity,transform:B.transform,transition:"opacity 120ms, transform 120ms","button:first-of-type":{borderTopLeftRadius:6,borderBottomLeftRadius:6},"button:last-of-type":{borderTopRightRadius:6,borderBottomRightRadius:6}}],moreButton:P,button:[A,w.l0.rowWithGap(4),w.l0.align.center,w.l0.pl(4),w.l0.pr(6),w.l0.flex.growAndShrink(1),w.l0.border({direction:"right",color:w.TV.outlineDefault}),{fontFamily:w.TV.fontFamilyDefault,"*":{color:w.TV.foregroundDimmer},":hover *":{color:w.TV.foregroundDefault},".shortcut":{color:w.TV.foregroundDimmest},":hover .shortcut":{color:w.TV.foregroundDimmer}}],iconButton:[P,w.l0.border({direction:"right",color:w.TV.outlineDefault})],tooltip:[w.l0.rowWithGap(2),w.l0.align.center]}),U=new T.Jf(function(e){var t,n=e.controls,r=e.verticalPlacement,o=e.onMoreClick,a=(0,E.useRef)(null),u=(0,C.xx)();(0,E.useEffect)(function(){var e;u(),(0,h.A)(a,(e={},(0,l._)(e,G.opacity,"1"),(0,l._)(e,G.transform,"translateY(calc(".concat("top"===r?1:-1," * ").concat(w.TV.space4,"))")),e))},[r,u]);var d=(0,E.useRef)((0,C.qm)());return(0,i.BX)(m.Tg,{innerRef:a,elevated:!0,css:N.root,style:(t={},(0,l._)(t,G.opacity,"0"),(0,l._)(t,G.transform,"translateY(calc(".concat("top"===r?1:-1," * ").concat(w.TV.space16,"))")),t),children:[n.map(function(e){if(d.current){var t=(0,i.BX)(y.G,{css:N.tooltip,children:[(0,i.tZ)(v.xv,{variant:"small",multiline:!1,children:e.text}),e.shortcut?(0,i.tZ)(v.xv,{variant:"small",className:"shortcut",color:"dimmest",children:(0,x.Ih)(e.shortcut)}):null]});return(0,i.tZ)(g.u,{tooltip:t,children:function(t,n){return(0,i.tZ)(y.G,(0,s._)((0,c._)({},t),{innerRef:n,css:N.iconButton,onClick:e.onClick,tag:"button",children:e.icon}))}},e.text)}return(0,i.BX)(y.G,{css:N.button,onClick:e.onClick,tag:"button",children:[e.icon,(0,i.tZ)(v.xv,{variant:"small",multiline:!1,children:e.text}),e.shortcut?(0,i.BX)(v.xv,{variant:"small",className:"shortcut",children:["(",(0,x.Ih)(e.shortcut),")"]}):null]},e.text)}),o?(0,i.tZ)(y.G,{"aria-label":"More",css:N.moreButton,onClick:function(e){var t=(a.current||e.currentTarget).getBoundingClientRect();o({top:t.top,right:t.right})},tag:"button",children:(0,i.tZ)(Z.Z,{size:16})}):null]})}),O={layer:"cm-selection-controls-layer",dom:"cm-selection-controls-dom"},L=o.tk.theme((r={},(0,l._)(r,".".concat(O.layer),{width:"100%"}),(0,l._)(r,".".concat(O.dom),{position:"absolute"}),r)),M=function(){"use strict";function e(t){(0,a._)(this,e),this.options=t}var t=e.prototype;return t.draw=function(){var e=this.options,t=e.controls,n=e.onMoreClick,r=e.top,i=e.align,o=e.verticalPlacement,a=U.create({controls:t,onMoreClick:n,verticalPlacement:o});return a.className=O.dom,a.style.top=r+"px","left"===i.side?(a.style.left=i.value+"px",a.style.right=""):(a.style.right=i.value+"px",a.style.left=""),a},t.eq=function(e){return S()(e.options,this.options)},e}(),X=u.Py.define(),F=u.QQ.define({create:function(){return null},update:function(e,t){var n;return!t.state.selection||(null===(n=t.state.selection)||void 0===n?void 0:n.main.empty)?null:((0,R.j)(t,X,function(t){e=t.value}),e)}}),W=u.QQ.define({create:function(e){return!e.selection.main.empty},update:function(e,t){return!t.state.selection.main.empty}}),H=o.lg.define(function(e){var t=function(){var t=e.state.selection.main;e.dispatch({effects:X.of(t.empty?null:Date.now())})},n=function(e){"Shift"===e.key&&t()},r=function(){document.addEventListener("mouseup",t),document.addEventListener("keyup",n)},i=function(){document.removeEventListener("mouseup",t),document.removeEventListener("keyup",n)};return{update:function(e){(0,D.a)(e,W)&&(e.state.field(W)?r():i())},destroy:i}}),V=new d.j(function(e){return[L,(0,o.EY)({above:!0,class:O.layer,update:function(e){return(0,D.a)(e,k.$,F)},markers:function(t){var n=t.state.field(F)?t.state.selection.main:null;if(!n||t.state.field(k.$,!1))return[];var r=function(e,t){for(var n=Math.min(t.from,t.to),r=Math.max(t.from,t.to),i=null;n<=r;){var o=e.lineAt(n);n=o.to+1,null!==i&&o.length<i.length||(i=o)}return i}(t.state.doc,n);if(!r)return[];var i=t.coordsAtPos(r.to);if(!i)return[];var o=t.lineBlockAt(Math.min(n.anchor,n.head)),a=t.dom.getBoundingClientRect(),l=t.contentDOM.getBoundingClientRect(),c=o.top+t.documentPadding.top-30,s=l.right-i.left<200?{side:"right",value:a.right-l.right+16}:{side:"left",value:i.left-a.left},u="top";if(c<t.scrollDOM.scrollTop){var d=t.lineBlockAt(n.to);c=d.top+d.height,u="bottom"}return[new M({top:c,align:s,controls:e.controls(t),onMoreClick:e.onMoreClick,verticalPlacement:u})]}}),W,F,H]}),z=n(19408),j=n(12880),q=n(27308),Y=n(49932),$={id:"editor.generateOrModifyWithAI",name:"AI",description:"Generate or modify selection with AI",default:(0,q.l2)({cmdOrCtrl:!0,key:"i"})};function J(e){var t=e.editCode,n=e.explainCode,r=e.generateCode,a=e.onMoreClick,l=(0,x.gf)($.id),c=(0,E.useMemo)(function(){if(!l)return[];var e=Array.isArray(l)?l.join(" "):l;return o.$f.of([{key:e,scope:"editor",run:function(e){return e.state.selection.main.empty?r(e):t(e),!0}}])},[l,r,t]),s=(0,E.useMemo)(function(){return{controls:function(e){return[{text:"Modify",icon:(0,i.tZ)(j.Z,{size:16,color:Y.TV.blurpleStronger}),onClick:function(){return t(e)},shortcut:l},{text:"Explain",icon:(0,i.tZ)(z.Z,{size:16,color:Y.TV.blurpleStronger}),onClick:function(){return n(e)}}]},onMoreClick:a}},[t,n,a,l]),u=V.use(s);return(0,E.useMemo)(function(){return[u,c]},[u,c])}},38041:function(e,t,n){n.d(t,{S:function(){return p},r:function(){return h}});var r,i=n(27387),o=n(96583),a=n(89446),l=n(59868),c=n(19659),s=n(39756),u=RegExp("_(?<num>\\d+)$");function d(){return(d=(0,i._)(function(e,t){var n,r,i,a;return(0,o.Jh)(this,function(o){switch(o.label){case 0:return n=(0,c.Il)(t),[4,e.readDir(n||s.Ql)];case 1:if((r=o.sent()).error)return[2,t];return a=(i=function(e){if(r.children.find(function(t){return"FILE"===t.type&&t.filename===e})){var t,n=(0,c.eb)(e),o=(0,c.r6)(e),a=n.match(u);if(null==a?void 0:null===(t=a.groups)||void 0===t?void 0:t.num){var l=Number(a.groups.num);return i("".concat(n.replace(u,""),"_").concat(l+1,".").concat(o))}return i("".concat(n,"_2.").concat(o))}return e})((0,c.UO)(t)),[2,n?n+"/"+a:a]}})})).apply(this,arguments)}var f=n(41500),h=(r=(0,i._)(function(e,t,n){var r,i,l,s,u,h;return(0,o.Jh)(this,function(o){switch(o.label){case 0:return r=encodeURI(e.name),[4,function(e,t){return d.apply(this,arguments)}(t,(i=(0,c.Il)(n))?i+"/"+r:r)];case 1:return l=o.sent(),[4,(0,a.pV)(e)];case 2:return s=o.sent(),[4,t.writeFile(l,f.Z.from(s))];case 3:return o.sent(),u=(0,c.eb)(e.name),h=(0,c.UO)(l),[2,"![".concat(u,"](").concat(h,")")]}})}),function(e,t,n){return r.apply(this,arguments)});function p(e){var t=e.cta,n=e.version;(0,l.j)(l.U3.EDITOR_EMPTY_STATE_CLICKED,{cta:t,version:n})}},11398:function(e,t,n){n.d(t,{Mp:function(){return l},ac:function(){return a},ev:function(){return o}});var r=n(43312),i=n(29287),o=(0,r.iv)({position:"relative",overflowY:"auto",width:"100%",height:"100%",zIndex:3}),a=(0,r.iv)({position:"relative",overflowY:"auto",width:"100%",height:"100%",fontSize:"14px",backgroundColor:i.TV.backgroundDefault}),l=(0,r.iv)({display:"flex",alignItems:"stretch",width:"100%",height:"100%","& > .cm-editor":{flex:"1 1 auto",width:"100%"}})},17225:function(e,t,n){n.d(t,{Q1:function(){return b},Rz:function(){return g},xy:function(){return Z}});var r=n(27387),i=n(63257),o=n(96583),a=n(74985),l=n(69119),c=n(57468),s=n(56596),u=n(93918),d=n(29287),f=n(85045),h=n(19659),p=(0,u.X)({root:[d.l0.rowWithGap(8),d.l0.align.center,d.l0.flex.growAndShrink(1),d.l0.px(8),{userSelect:"none"}],header:[{fontSize:d.TV.fontSizeSmall,opacity:.6},d.l0.color.foregroundDimmest,d.l0.truncate],result:[d.l0.colWithGap(0)],fileName:[d.l0.truncate,d.l0.flex.row]});function m(e){var t=e.height,n=e.active,r=e.match,i=r.directory,o=r.filename;return(0,a.BX)(s.G,{css:p.root,style:{height:t},children:[(0,a.tZ)(c.Z,{path:o.text,size:16}),(0,a.BX)(s.G,{css:p.result,children:[i?(0,a.tZ)(s.G,{css:p.header,children:(0,a.tZ)(l.x,{text:i.text+"/",highlight:i.ranges,dimmed:!n})}):null,(0,a.tZ)(s.G,{css:p.fileName,children:(0,a.tZ)(l.x,{text:o.text,highlight:o.ranges,dimmed:!n})})]})]})}var v={match:f.kN,forward:!1,tiebreakers:[function(e,t,n){return n(e.item).trim().length-n(t.item).trim().length}]};function g(e,t){return y.apply(this,arguments)}function y(){return(y=(0,r._)(function(e,t){return(0,o.Jh)(this,function(n){switch(n.label){case 0:return[4,new f.Zn(t,v).find(e)];case 1:return[2,n.sent().map(function(e){return{path:e.item,score:e.score,ranges:function(e){for(var t=(0,i._)(e.values()).sort(function(e,t){return e-t}),n=[],r=t[0],o=t[0],a=1;a<t.length;a++)t[a]===o+1?o++:(n.push({from:r,to:o+1}),r=t[a],o=t[a]);return n.push({from:r,to:o+1}),n}(e.positions)}})]}})})).apply(this,arguments)}function b(e){var t=e.ranges,n=e.path,r=(0,h.UO)(n),i=(0,h.Il)(n);if(!i)return{filename:{text:r,ranges:t.length?t:void 0}};var o=i.length,a=o+1,l=[],c=[],s=!0,u=!1,d=void 0;try{for(var f,p=t[Symbol.iterator]();!(s=(f=p.next()).done);s=!0){var m=f.value;if(m.from<o){l.push({from:m.from,to:Math.min(m.to,o)});var v=m.to-a;if(v<=0)continue;c.push({from:0,to:v});continue}m.from<a||c.push({from:m.from-a,to:m.to-a})}}catch(e){u=!0,d=e}finally{try{s||null==p.return||p.return()}finally{if(u)throw d}}return{filename:{text:r,ranges:c.length?c:void 0},directory:{text:i,ranges:l.length?l:void 0}}}function Z(e){var t=e.path,n=e.ranges,r=b({path:t,ranges:null!=n?n:[]}),i=r.directory?44:32;return{height:i,content:(0,a.tZ)(m,{match:r,height:i})}}},7727:function(e,t,n){n.d(t,{i:function(){return Z},w:function(){return g}});var r=n(27387),i=n(66626),o=n(96583),a=n(74985),l=n(57468),c=n(74833),s=n(56596),u=n(81764),d=n(93646),f=n(20573),h=n(29287),p=n(80259),m=n(41500),v=n(17225);function g(e){return y.apply(this,arguments)}function y(){return(y=(0,r._)(function(e){var t,n,r;return(0,o.Jh)(this,function(i){switch(i.label){case 0:if(t=e.search,n=e.paths,r=e.run,!t)return[2,n.map(function(e){return{data:{type:"action",label:e,icon:(0,a.tZ)(l.Z,{path:e}),run:function(){return r(e)}},match:function(){return{score:1,render:(0,v.xy)({path:e})}}}})];return[4,(0,v.Rz)(t,n)];case 1:return[2,i.sent().map(function(e){var t=e.path,n=e.score,i=e.ranges;return{data:{type:"action",label:t,icon:(0,a.tZ)(l.Z,{path:t}),run:function(){return r(t)}},match:function(){return{score:n,render:(0,v.xy)({path:t,ranges:i})}}}})]}})})).apply(this,arguments)}function b(){return(0,a.BX)(s.G,{css:[h.l0.rowWithGap(8)],children:[(0,a.tZ)(f.Z,{}),(0,a.tZ)(c.xv,{color:"dimmest",multiline:!1,children:"Something went wrong searching your Repl's files. Please try again."})]})}function Z(e){var t;return(0,p.fA)({type:"context",label:"Files",description:"Find a file",icon:(0,a.tZ)(d.Z,{}),keyboardShortcut:e.keyboardShortcut?e.keyboardShortcut:void 0},{match:(0,p.zf)({defaultScore:3}),commands:(t=(0,r._)(function(t){var n,c,s,d,h,p,v,y,Z,w,x,C,_,S,E,k;return(0,o.Jh)(this,function(T){switch(T.label){case 0:if(n=e.fs,c=e.shouldHideFile,!t.search&&(!t.active||e.lazyLoad))return[2,[]];return[4,Promise.resolve(e.getRecentFiles())];case 1:if(s=T.sent(),d=[],!(t.search||t.active))return[3,3];return[4,n.listFiles()];case 2:if((h=T.sent()).error)return[2,[{data:{type:"error",label:h.error,icon:(0,a.tZ)(f.Z,{})},match:function(){return{score:1,render:{content:(0,a.tZ)(b,{})}}}}]];if(!h.files)throw Error("Expected files");p=!0,v=!1,y=void 0;try{for(Z=h.files[Symbol.iterator]();!(p=(w=Z.next()).done);p=!0)x=w.value,c(x)||s.includes(x)||d.push(x)}catch(e){v=!0,y=e}finally{try{p||null==Z.return||Z.return()}finally{if(v)throw y}}T.label=3;case 3:return C=[],[4,Promise.all([g({search:t.search,paths:s,run:function(t){e.openFile({path:t})}}),g({search:t.search,paths:d,run:function(t){e.openFile({path:t})}})])];case 4:return S=(_=i._.apply(void 0,[T.sent(),2]))[0],E=_[1],S.length&&C.push({data:{type:"context",label:"Recent",icon:(0,a.tZ)(u.Z,{})},commands:function(){return S}}),E.length&&C.push({data:{type:"group",key:"files"},commands:function(){return E}}),0===E.length&&0===S.length&&t.active&&(k=t.search,C.push({data:{label:k,description:"Create a new file",icon:(0,a.tZ)(l.Z,{path:k}),type:"action",run:(0,r._)(function(){return(0,o.Jh)(this,function(t){switch(t.label){case 0:return[4,n.writeFile(k,m.Z.from(""))];case 1:if(t.sent().error)return[2,{type:"error",message:'Could not create "'+k+'"'}];return e.openFile({path:k}),[2]}})})},match:function(){return{score:1}}})),[2,C]}})}),function(e){return t.apply(this,arguments)})})}},56287:function(e,t,n){n.d(t,{F:function(){return S},q:function(){return _}});var r=n(27387),i=n(66626),o=n(96583),a=n(74985),l=n(39313),c=n(43208),s=n(57468),u=n(74833),d=n(56596),f=n(93918),h=n(82723),p=n(20573),m=n(29287),v=n(80259),g=n(27308),y=n(19924),b=(0,f.X)({root:[m.l0.colWithGap(4),m.l0.align.start,m.l0.flex.growAndShrink(1),m.l0.p(8)],header:[m.l0.rowWithGap(4),m.l0.align.center],singleLine:[{whiteSpace:"nowrap",fontFamily:m.TV.fontFamilyCode},m.l0.truncate,m.l0.color.foregroundDimmest]});function Z(e){var t=e.path,n=e.line;return(0,a.BX)(d.G,{css:b.root,children:[(0,a.BX)(d.G,{css:b.header,children:[(0,a.tZ)(s.Z,{path:t,size:12}),(0,a.BX)(u.xv,{variant:"small",color:"dimmest",multiline:!1,children:[t.replace(/^\.\//,""),":",n.lineNumber]})]}),(0,a.tZ)(d.G,{css:b.singleLine,children:(0,a.tZ)(l.xK,{source:n.content,matches:n.matches})})]})}function w(){return(0,a.BX)(d.G,{css:[m.l0.px(8),m.l0.rowWithGap(8),m.l0.align.center],children:[(0,a.tZ)(p.Z,{}),(0,a.tZ)(u.xv,{color:"dimmest",multiline:!1,children:"Something went wrong searching your Repl's contents. Please try again."})]})}function x(){return(0,a.BX)(d.G,{css:[m.l0.rowWithGap(8),m.l0.p(8),m.l0.align.center],children:[(0,a.tZ)(p.Z,{}),(0,a.tZ)(u.xv,{color:"dimmest",multiline:!1,children:"Displaying only part of the results, try being more specific with your search."})]})}function C(){return(0,a.tZ)(d.G,{css:[m.l0.rowWithGap(8),m.l0.p(8),m.l0.align.center],children:(0,a.tZ)(u.xv,{color:"dimmest",multiline:!1,children:"Nothing came up searching your Repl's content."})})}var _=(0,g.l2)({cmdOrCtrl:!0,shift:!0,key:"f"});function S(e){var t,n,l=(0,y.e)({container:e.container});return(0,v.fA)({type:"context",description:"Search through your files",label:"Search",icon:(0,a.tZ)(h.Z,{}),keyboardShortcut:e.keyboardShortcut?_:void 0},{match:(0,v.zf)({defaultScore:2}),commands:(t=(0,r._)(function(t){var r,u,f,h,m,v,g,y,b,_,S,E;return(0,o.Jh)(this,function(o){switch(o.label){case 0:if(!t.search||!t.active&&e.activeOnly)return[2,[]];return n=r=Math.random(),[4,l({query:t.search})];case 1:if(f=(u=o.sent()).results,h=u.error,m=u.isPartialResult,r!==n)return[2,[]];if(null!==h){if(!t.active)return[2,[]];return[2,[{data:{type:"error",label:"error",icon:(0,a.tZ)(p.Z,{})},match:function(){return{score:1,render:{content:(0,a.tZ)(w,{})}}}}]]}v=[],g=!0,y=!1,b=void 0;try{for(_=function(){var n=(0,i._)(E.value,2),r=n[0];n[1].forEach(function(n){var i=n.matches[0].column;v.push({match:function(){var e=c.Z.match(t.search,n.content);return{score:(null==e?void 0:e.score)||1,render:{height:60,content:(0,a.tZ)(Z,{path:r,line:n})}}},data:{type:"action",label:r,icon:(0,a.tZ)(s.Z,{path:r}),key:[r,n.lineNumber,i].join(":"),run:function(){e.openFile({path:r,line:n.lineNumber,col:i})}}})})},S=Object.entries(f)[Symbol.iterator]();!(g=(E=S.next()).done);g=!0)_()}catch(e){y=!0,b=e}finally{try{g||null==S.return||S.return()}finally{if(y)throw b}}if(0===v.length&&t.active)return[2,[{data:{type:"output",label:"",icon:(0,a.tZ)(d.G,{})},match:function(){return{score:1,render:{content:(0,a.tZ)(C,{})}}}}]];if(t.active){if(0===v.length)return[2,[{data:{type:"output",label:"",icon:(0,a.tZ)(d.G,{})},match:function(){return{score:1,render:{content:(0,a.tZ)(C,{})}}}}]];m&&v.push({data:{type:"error",label:"error",icon:(0,a.tZ)(p.Z,{})},match:function(){return{score:1/0,render:{content:(0,a.tZ)(x,{})}}}})}return[2,v]}})}),function(e){return t.apply(this,arguments)})})}},15011:function(e,t,n){n.d(t,{Z:function(){return eZ}});var r,i,o=n(27387),a=n(41733),l=n(30509),c=n(66626),s=n(96583),u=n(74985),d=n(50959),f=n(39426),h=n(39713),p=n(59735),m=n(76999),v=n.n(m),g=function(e){var t=(0,h._)({},(0,p._)(e));return(0,u.BX)(u.HY,{children:[(0,u.tZ)(v(),{id:"fcfe85a13ecbf46b",children:".one.jsx-fcfe85a13ecbf46b{opacity:.1;-webkit-animation:dot 1.5s ease-in-out infinite;-moz-animation:dot 1.5s ease-in-out infinite;-o-animation:dot 1.5s ease-in-out infinite;animation:dot 1.5s ease-in-out infinite;-webkit-animation-delay:0s;-moz-animation-delay:0s;-o-animation-delay:0s;animation-delay:0s}.two.jsx-fcfe85a13ecbf46b{opacity:.1;-webkit-animation:dot 1.5s ease-in-out infinite;-moz-animation:dot 1.5s ease-in-out infinite;-o-animation:dot 1.5s ease-in-out infinite;animation:dot 1.5s ease-in-out infinite;-webkit-animation-delay:.1s;-moz-animation-delay:.1s;-o-animation-delay:.1s;animation-delay:.1s}.three.jsx-fcfe85a13ecbf46b{opacity:.1;-webkit-animation:dot 1.5s ease-in-out infinite;-moz-animation:dot 1.5s ease-in-out infinite;-o-animation:dot 1.5s ease-in-out infinite;animation:dot 1.5s ease-in-out infinite;-webkit-animation-delay:.2s;-moz-animation-delay:.2s;-o-animation-delay:.2s;animation-delay:.2s}@-webkit-keyframes dot{0%{opacity:.1}50%{opacity:1}100%{opacity:.1}}@-moz-keyframes dot{0%{opacity:.1}50%{opacity:1}100%{opacity:.1}}@-o-keyframes dot{0%{opacity:.1}50%{opacity:1}100%{opacity:.1}}@keyframes dot{0%{opacity:.1}50%{opacity:1}100%{opacity:.1}}"}),(0,u.tZ)("span",(0,l._)((0,a._)({},t),{className:"jsx-fcfe85a13ecbf46b "+(t&&null!=t.className&&t.className||"one"),children:"."})),(0,u.tZ)("span",(0,l._)((0,a._)({},t),{className:"jsx-fcfe85a13ecbf46b "+(t&&null!=t.className&&t.className||"two"),children:"."})),(0,u.tZ)("span",(0,l._)((0,a._)({},t),{className:"jsx-fcfe85a13ecbf46b "+(t&&null!=t.className&&t.className||"three"),children:"."}))]})},y=n(78975),b=n(59121),Z=n(72310),w=n(76433),x=n(50782),C=n(59868),_=n(1498),S=n(59639),E=n(18836),k=n(93496),T=n(49344),R=n(38080),D=n(74833),I=n(56596),G=n(88936),B=n(20573),A=n(29287),P=n(54916),N=n(35972),U=n(43891),O=n(24418),L=n(30084),M=n(43778),X=function(e){var t=e.split("/");if(1===t.length)return t;for(var n=[],r=0;r<t.length;r++)n.push(t.slice(0,r+1).join("/"));return n},F=function(){var e=(0,P.Z)(),t=e.fs,n=e.dotReplit,r=(0,U.P)(n),i=(0,c._)((0,d.useState)(null),2),a=i[0],l=i[1];return(0,d.useEffect)(function(){var e;(e=(0,o._)(function(){var e,n,i,o;return(0,s.Jh)(this,function(a){switch(a.label){case 0:if(!r)return[2];return[4,t.listFiles()];case 1:if((e=a.sent()).error||!e.files)return l([]),[2];return[4,t.readFile(O.l)];case 2:return n=a.sent(),i=e.files,o=M.uP.concat(M.nh),l(i.filter(function(e){return(n.error===L.Df.NotFound||!r.some(function(t){return X(e).some(function(e){return null!=e.match(t)})}))&&!o.includes(e)})),[2]}})}),function(){return e.apply(this,arguments)})()},[r,t]),a},W=n(55552),H=n(21262),V=n(71440),z=n(58995),j=n(99165);function q(){var e=(0,H._)(["\n  query ConfigReplLanguage($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        language\n      }\n    }\n  }\n"]);return q=function(){return e},e}function Y(){var e=(0,H._)(["\n  mutation ConfigUpdateRepl($input: UpdateReplInput!) {\n    updateRepl(input: $input) {\n      repl {\n        id\n      }\n    }\n  }\n"]);return Y=function(){return e},e}var $={},J=(0,V.Ps)(q()),K=(0,V.Ps)(Y()),Q=n(43312),ee=n(31366),et=n(42308),en=n(7444),er=n(35273),ei=n(79217),eo=n(82723),ea=n(43208),el=n(21371),ec=(0,Q.iv)([A.l0.py(8),A.l0.pl(8),A.l0.pr(32),{color:"inherit",outline:"0 none",border:"1px solid",fontSize:"inherit",lineHeight:A.TV.space16,display:"block",width:"100%","::placeholder, :disabled":{color:A.TV.foregroundDimmer,borderColor:"transparent"},cursor:"text"}]),es=(0,Q.iv)([A.l0.reset.button,k.gU.listItem,A.l0.borderRadius(8),A.l0.center,{width:24,height:24}]),eu=I.K.button;function ed(e){var t,n,r,i,o,s,f,h,p,m,v,g=e.id,y=e.onSelect,b=e.onInit,Z=e.options,w=e.initialSelectedOption,x=e.placeholderText,C=e.autoFocus,_=e.disabled,S=(0,d.useRef)(null),k=(0,c._)((0,d.useState)(null!=w?w:""),2),T=k[0],R=k[1],G=(n=(t={options:Z,initialSelectedOption:w,inputRef:S,setInputValue:R}).options,r=t.initialSelectedOption,i=t.inputRef,o=t.setInputValue,f=(s=(0,c._)((0,d.useState)(""),2))[0],h=s[1],p={options:n,filter:f},m=(0,d.useMemo)(function(){return p.filter?ea.Z.filter(p.filter.toLowerCase(),p.options).map(function(e){return e.original}):p.options},[p.options,p.filter]),v=(0,el.Kb)({items:m,initialHighlightedIndex:0,initialSelectedItem:r,stateReducer:function(e,t){var n,r,c=t.type,s=t.changes;return((c===el.Kb.stateChangeTypes.ItemClick||c===el.Kb.stateChangeTypes.InputKeyDownEnter&&s.selectedItem)&&(null===(n=i.current)||void 0===n||n.blur()),c!==el.Kb.stateChangeTypes.InputBlur||s.selectedItem)?(c===el.Kb.stateChangeTypes.InputBlur&&s.selectedItem&&o(null!==(r=s.selectedItem)&&void 0!==r?r:""),s):(0,l._)((0,a._)({},s),{isOpen:!0})}}),{filteredOptions:m,combobox:v,setFilter:h,filter:f}),B=G.filteredOptions,P=G.filter,N=G.combobox,U=G.setFilter,O=(0,en.Z)(y),L=(0,en.Z)(b);return(0,d.useEffect)(function(){w&&(L.current(w),R(w),U(""))},[w]),(0,er.Z)(function(){var e;N.selectedItem&&(null===(e=S.current)||void 0===e||e.blur(),O.current(N.selectedItem),R(N.selectedItem),U(""))},[N.selectedItem,O]),(0,d.useEffect)(function(){w&&(N.selectItem(w),R(w),U(""))},[w]),(0,u.BX)(I.G,{children:[(0,u.tZ)("div",(0,l._)((0,a._)({},N.getComboboxProps()),{children:(0,u.BX)(I.G,{css:[A.l0.flex.row,{position:"relative"}],children:[(0,u.tZ)(I.G,{css:[A.l0.flex.growAndShrink(1)],children:(0,u.tZ)(E.II,(0,l._)((0,a._)({},N.getInputProps({id:g,spellCheck:!1,autoFocus:C,onChange:function(e){U(e.currentTarget.value.toLowerCase()),R(e.currentTarget.value)},ref:S,onFocus:function(e){N.openMenu(),e.currentTarget.select()}})),{value:T,placeholder:null!=w?w:x,css:[ec],disabled:_}))}),_?null:(0,u.tZ)(I.G,{css:[{position:"absolute",top:0,right:0,height:"100%"},A.l0.center],children:(0,u.tZ)(eu,(0,l._)((0,a._)({},N.getToggleButtonProps()),{css:es,type:"button",children:N.inputValue&&!N.isOpen?(0,u.tZ)(ei.Z,{}):(0,u.tZ)(eo.Z,{})}))})]})})),(0,u.BX)("div",(0,l._)((0,a._)({},N.getMenuProps()),{css:{position:"relative"},children:[N.isOpen&&B.length?(0,u.tZ)(ee.Z,{children:(0,u.tZ)("ul",{css:[A.l0.pt(4),A.l0.pb(8)],children:B.map(function(e,t){return(0,u.tZ)("li",(0,l._)((0,a._)({},N.getItemProps({item:e,index:t})),{children:(0,u.tZ)(et.Z,(0,l._)((0,a._)({},{title:e,key:e.toLowerCase()}),{filter:P,selected:N.selectedItem===e,highlighted:N.highlightedIndex===t}))}),e.toLowerCase())})})}):null,P&&!B.length&&N.isOpen?(0,u.tZ)(ee.Z,{children:(0,u.tZ)(I.G,{css:[A.l0.p(16),A.l0.colWithGap(4)],children:(0,u.BX)(D.xv,{color:"dimmer",multiline:!1,children:['No results for "',P,'"']})})}):null]}))]})}var ef=n(37229),eh=n(19659);(r=i||(i={})).Unknown="UNKNOWN",r.Npm="NPM",r.Django="DJANGO",r.Rails="RAILS",r.DotNet="DOTNET",r.Cargo="CARGO",r.Make="MAKE",r.RegularRun="REGULAR_RUN";var ep=RegExp("((index)|(main)|(app)|(run)|(start)|(server))\\..+","i"),em=RegExp("((node_modules)|(venv)|(bower_components)|(vendor)|(build)|(dist)|(target)|(\\.git)|(\\.vscode)|(\\.idea)).+$","i");function ev(e){var t=e.children;return(0,u.BX)(R.Tg,{background:"default",css:[A.l0.borderRadius(8),{width:"100%",height:"calc(100% - var(--space-2))",backgroundColor:"var(--background-default)",overflowY:"auto",marginTop:"0px"}],children:[(0,u.tZ)(I.G,{children:(0,u.tZ)(D.xv,{multiline:!1,variant:"subheadDefault",css:[A.l0.color.foregroundDimmest,A.l0.pl(16),A.l0.pt(16)],children:".replit"})}),(0,u.tZ)(I.G,{css:[A.l0.p(16),A.l0.justify.center,A.l0.align.center,{flex:"1 1 auto"}],children:t})]})}function eg(e){var t,n=!!e.hasInterpreter,r=e.initialRun,o=null!==(t=e.initialCompile)&&void 0!==t?t:"",s=e.isFrameworkRecommended,h=!!e.projType&&e.projType===i.Rails,p=e.isApplyingConfig,m=(0,c._)((0,d.useState)("Unknown"===f.ZP.get(e.initialLanguage).displayName?"bash":e.initialLanguage),2),v=m[0];m[1];var g=(0,Z.Y)(e.initialRun,function(e){if(!e)return{message:"Add a run command"}}),y=(0,c._)((0,d.useState)(e.initialCompile),2),b=y[0],w=y[1];(0,d.useEffect)(function(){g.setValue(r)},[r]),(0,d.useEffect)(function(){w(null!=o?o:"")},[o]);var x=(0,Z.Y)("",function(e){if(!e)return{message:"Choose an entry point file"}}),C=(0,c._)((0,d.useState)(!!(n&&!s)),2),R=C[0],P=C[1];(0,d.useEffect)(function(){P(!!(n&&!s))},[n,s]);var U=I.K.a,O=(0,c._)((0,d.useState)([]),2),L=O[0],M=O[1],X=F();return(0,d.useEffect)(function(){X&&M(X)},[X]),(0,u.BX)("form",{onSubmit:function(t){if(t.preventDefault(),e.setIsApplyingConfig(!0),!g.value&&!R){g.validate();return}e.onSubmit({run:g.value,compile:null!=b?b:"",entry:x.value,deleteInterp:!R,onDone:e.closeConfigPane,runChanged:g.value!==r,compileChanged:b!==o,projType:e.projType})},css:[A.l0.maxWidth(400),{width:"100%"}],children:[(0,u.BX)(I.G,{css:[A.l0.colWithGap(8)],children:[e.hasProcfile?(0,u.tZ)(I.G,{css:[A.l0.colWithGap(8)],children:(0,u.BX)(D.xv,{variant:"small",css:[A.l0.mb(24)],children:["Looks like you came from Heroku!",(0,u.tZ)(U,{target:"_blank",href:"https://docs.replit.com/tutorials/import-heroku",rel:"noopener noreferrer",children:"Read more about Replit and Heroku here."})]})}):null,n?(0,u.tZ)(I.G,{css:[A.l0.pb(16)],children:(0,u.BX)(S.hE,{disabled:p,name:"interpreterView",value:R.toString(),row:!0,onChange:function(){return P(function(e){return!e})},stretch:!0,primary:!0,children:[(0,u.tZ)(S.rK,{id:"interpreterFalse",value:"false",text:"Use run command"}),(0,u.tZ)(S.rK,{id:"interpreterTrue",value:"true",text:"Use default interpreter"})]})}):null,(0,u.BX)(I.G,{css:[A.l0.height(e.initialCompile?210:170),A.l0.colWithGap(8)],children:[R?null:(0,u.BX)(I.G,{css:[A.l0.maxWidth(400),A.l0.colWithGap(8)],children:[e.initialCompile?(0,u.BX)(I.G,{css:[A.l0.colWithGap(4)],children:[(0,u.tZ)("label",{htmlFor:"compile-sel",children:"Configure the Compile Command"}),(0,u.tZ)(D.xv,{variant:"small",color:"dimmest",children:"This is optional, and is executed before your run command."}),(0,u.tZ)(E.II,{disabled:p,id:"compile-sel",type:"text",value:b,placeholder:"Enter a command to compile the program",onChange:function(e){w(e.currentTarget.value)},css:{"&:disabled":{color:A.TV.foregroundDimmer}}})]}):null,(0,u.tZ)("label",{htmlFor:"run-sel",css:[A.l0.mt(4)],"data-cy":"import-config-run-command",children:"Configure the Run Command"}),(0,u.tZ)(E.II,{disabled:p,id:"run-sel",dataCy:"import-config-run-command-input",type:"text",value:g.value,placeholder:"Enter a command to run the program",onChange:function(e){g.setValue(e.currentTarget.value)},css:[{"&:disabled":{color:A.TV.foregroundDimmer,cursor:"auto"},cursor:"text"}]}),h?(0,u.BX)(D.xv,{variant:"small",color:"dimmest",children:["We detected this is a Rails project. You will need",(0,u.BX)("a",{target:"_blank",rel:"noopener noreferrer",href:"https://docs.replit.com/misc/rails-on-replit",children:[" ","additional changes"," "]}),"to your config files to use all of Replits features."]}):null,g.error||!g.value?(0,u.BX)(I.G,{css:[A.l0.color.accentNegativeDefault,A.l0.rowWithGap(4),A.l0.align.center],children:[(0,u.tZ)(B.Z,{size:12}),(0,u.tZ)(I.G,{children:g.error?g.error.message:"Add a run command"})]}):null]}),R?(0,u.BX)(I.G,{css:[{maxWidth:400},A.l0.colWithGap(8)],children:[(0,u.tZ)("label",{htmlFor:"entry-sel",children:"Configure entry point"}),(0,u.tZ)(D.xv,{variant:"small",css:[A.l0.color.foregroundDimmest],children:"The entry point is the file thats run by default and shown first."}),0!==L.length?(0,u.tZ)(ed,(0,l._)((0,a._)({id:"config-selector",onSelect:x.setValue,onInit:x.setValue,options:L},L.length&&!!X&&{initialSelectedOption:L[0]}),{disabled:p})):(0,u.tZ)(E.II,{disabled:p,id:"entry-sel",type:"text",value:x.value,placeholder:"Choose entry point file",onChange:function(e){x.setValue(e.currentTarget.value)},css:[k.gU.filled,{cursor:"text"}]}),x.error?(0,u.BX)(I.G,{css:[{color:"var(--accent-negative-default)"},A.l0.rowWithGap(4),A.l0.align.center],children:[(0,u.tZ)(B.Z,{size:12}),(0,u.tZ)(I.G,{children:x.error.message})]}):null]}):null,(0,u.tZ)(U,{css:[A.l0.color.accentPrimaryStronger,{fontWeight:A.TV.fontWeightMedium}],target:"_blank",href:"https://docs.replit.com/programming-ide/running-github-repositories-replit",rel:"noopener noreferrer",children:"Not sure what to do?"}),(0,u.tZ)(I.G,{css:[A.l0.flex.row,A.l0.pt(16)],children:(0,u.tZ)(_.zx,{colorway:"primary",variant:"outlined",type:"submit",text:p?"Saving...":"Done",disabled:p||!R&&(!!g.error||!g.value),css:[k.gU.filledAndOutlined,{fontWeight:A.TV.fontWeightMedium,color:A.TV.accentPrimaryStronger}],dataCy:"import-config-done"})})]})]}),(0,u.tZ)(T.u,{isOpen:!1,preventClose:!0,onRequestClose:function(){},children:(0,u.tZ)(I.G,{css:[A.l0.borderRadius(16),A.l0.p(32),{backgroundColor:"var(--background-default)"}],children:(0,u.BX)(N.gC,{align:"center",spacing:1,children:[(0,u.tZ)(G.Z,{size:32}),(0,u.BX)(D.xv,{multiline:!1,children:["Upgrading to ",f.ZP.get(v).displayName]})]})})})]})}function ey(){return(0,u.BX)(I.G,{children:[(0,u.tZ)(I.G,{children:".replit looks a lil messed up :/"}),(0,u.tZ)("a",{css:[A.l0.pt(8),{fontSize:A.TV.fontSizeSmall}],target:"_blank",href:"https://docs.replit.com/programming-ide/configuring-repl",children:"View docs"})]})}function eb(){return(0,u.tZ)(I.G,{children:(0,u.BX)("p",{children:["Initializing run configuration",(0,u.tZ)(g,{style:{color:"var(--foreground-default)"}})]})})}var eZ=function(e){var t,n,r,l,f=(0,x.Z)(),h=(0,P.Z)(),p=h.fs,m=h.dotReplit,v=(0,c._)((t=(0,a._)({},$,void 0),j.D(K,t)),1)[0],g=(n=(0,a._)({},$,{variables:{replId:f}}),z.a(J,n)),Z=(null===(l=g.data)||void 0===l?void 0:l.repl.__typename)==="Repl"?g.data.repl:null,_=e.useReadFile(p,O.l),S=(0,c._)((0,d.useState)(!1),2),E=S[0],k=S[1],T=(0,c._)((0,d.useState)(!1),2),R=T[0],D=T[1],I=_&&!_.error?_.content.toString("utf8"):"",G=(0,c._)((0,d.useState)(""),2),B=G[0],A=G[1],N=(0,c._)((0,d.useState)(""),2),U=N[0],L=N[1],M=(0,c._)((0,d.useState)(!1),2),X=M[0],F=M[1],H=(0,c._)((0,d.useState)(i.Unknown),2),V=H[0],q=H[1],Y=(0,c._)((0,d.useState)(!1),2),Q=Y[0],ee=Y[1];(0,d.useEffect)(function(){function e(){return(e=(0,o._)(function(){var e,t,n,r,o,a,l,c,u,d,f,h,v,g,y,Z,w;return(0,s.Jh)(this,function(s){switch(s.label){case 0:return[4,m.getConfig()];case 1:if(t=(e=s.sent()).config,e.error)return[2];return r=(0,W.Cq)(null!==(n=t.run)&&void 0!==n?n:void 0),a=(0,W.Cq)(null!==(o=t.compile)&&void 0!==o?o:void 0),l=!!t.compile,c=!!t.interpreter,[4,p.listFiles()];case 2:if(null!=(u=s.sent()).error||null==u.files||0===u.files.length)return[2];return d=u.files,h=(f=function(e,t,n){if(0===n.length)return{projType:"UNKNOWN",runCommand:null,compileCommand:null};var r,i,o,a,l,c={initRunCommand:e,isCompiled:t,allFiles:n},s=(i=(r=c).initRunCommand,o=r.isCompiled,a=r.allFiles,(l=new Set(a)).has("Makefile")||l.has("makefile")?"MAKE":l.has("package.json")?"NPM":l.has("Cargo.toml")?"CARGO":o?"UNKNOWN":l.has("config/application.rb")?"RAILS":a.some(function(e){return"csproj"===(0,eh.r6)(e)})?"DOTNET":l.has("manage.py")?"DJANGO":ep.test(i)?"REGULAR_RUN":"UNKNOWN");return{projType:s,runCommand:function(e,t){var n=t.initRunCommand,r=t.allFiles;switch(e){case"NPM":return"npm run start";case"REGULAR_RUN":var i,o=null!==(i=r.filter(function(e){return!em.test(e)}).find(function(e){return ep.test(e)}))&&void 0!==i?i:null;if(null==o)return null;return n.replace(ep,o);case"DJANGO":return"python3 manage.py runserver 0.0.0.0:3000";case"RAILS":return"bundle exec rails server --binding=0.0.0.0";case"DOTNET":return"dotnet run";case"CARGO":return"cargo run";default:return null}}(s,c),compileCommand:function(e){switch(e){case"MAKE":return"make";case"CARGO":case"DOTNET":case"NPM":return"";default:return null}}(s)}}(r,l,d)).projType,v=f.runCommand,g=f.compileCommand,Z=(y=d.includes(b.E))?null!=r?r:v:null!=v?v:r,w=null!=g?g:a,k(y),A(Z),L(w),F(h!==i.Unknown&&h!==i.RegularRun),q(h),ee(c),[2]}})})).apply(this,arguments)}I&&function(){e.apply(this,arguments)}()},[I,m,p]),(0,d.useEffect)(function(){(0,C.j)(C.U3.NIX_GH_IMPORT_USED,{action:y.D.ImportEnded,replId:f})},[f]);var et=(0,w.Z)();(0,d.useEffect)(function(){et(!1)},[et]);var en=(r=(0,o._)(function(e){var t,n,r,i,o,a,l,c,u,d;return(0,s.Jh)(this,function(s){switch(s.label){case 0:var h;return t=e.run,n=e.compile,r=e.entry,i=e.deleteInterp,o=e.onDone,a=e.runChanged,l=e.compileChanged,c=e.projType,(0,C.j)(C.U3.NIX_GH_IMPORT_USED,{action:y.D.ConfigDone,interpUsed:!i,isCompiled:""!==n,runChanged:a,compileChanged:l,projType:c,replId:f}),h=[],i?(h.push((0,ef.xz)("interpreter")),h.push((0,ef.xz)("entrypoint")),h.push((0,ef.KQ)(t)),h.push((0,ef.X6)(t)),n?(h.push((0,ef.D3)(n)),h.push((0,ef.pi)(n))):(h.push((0,ef.xz)("compile")),h.push((0,ef.xz)("deployment/build")))):(h.push((0,ef.xz)("run")),h.push((0,ef.If)(r))),u=h,d=v({variables:{input:{id:f}}}),[4,m.updateDotReplit(u)];case 1:return s.sent(),p.flush().then(function(){p.persist({skipDebounce:!0})}),[4,d];case 2:return s.sent(),o(),[2]}})}),function(e){return r.apply(this,arguments)});return Z&&_?(null==_?void 0:_.error)?(0,u.tZ)(ev,{children:(0,u.tZ)(ey,{})}):(0,u.tZ)(ev,{children:(0,u.tZ)(eg,{initialLanguage:"",initialRun:B,initialCompile:U,hasInterpreter:Q,fs:p,hasProcfile:E,isApplyingConfig:R,setIsApplyingConfig:D,onSubmit:en,isFrameworkRecommended:X,projType:V,closeConfigPane:e.closeConfigPane})}):(0,u.tZ)(ev,{children:(0,u.tZ)(eb,{})})}},9626:function(e,t,n){var r=n(74985),i=n(47075),o=n(1415),a=n(74833),l=n(56596),c=n(29287),s=n(50959),u=function(e){var t=e.reason,n=e.children;return(0,r.BX)(l.G,{css:[c.l0.center,c.l0.minWidth(225),c.l0.height(225),c.l0.p(16),c.l0.color.foregroundDefault,c.l0.borderRadius(8),c.l0.backgroundColor.backgroundOverlay,c.l0.zIndex(5e5),{cursor:"not-allowed"}],children:[(0,r.tZ)(i.Z,{height:80}),(0,r.BX)(a.xv,{multiline:!1,variant:"subheadBig",css:[c.l0.mt(32)],dataCy:"import-loading-spinner",children:[t,"..."]}),n]})};t.Z=(0,s.memo)(function(e){var t=e.reason,n=e.children;return(0,r.tZ)(o.h,{children:(0,r.tZ)(l.G,{css:[c.l0.position.fixed,c.l0.flex.row,c.l0.align.center,c.l0.justify.center,c.l0.backgroundColor.backgroundOverlay,{top:0,bottom:0,left:0,right:0,zIndex:5e5,cursor:"not-allowed"}],children:(0,r.tZ)(u,{reason:null!=t?t:"Importing",children:n})})})})},27695:function(e,t,n){n.d(t,{Z:function(){return v}});var r=n(66626),i=n(74985),o=n(1498),a=n(49344),l=n(74833),c=n(56596),s=n(32377),u=n(29287),d=n(47001),f=n(17867),h=n(50959),p=n(12285),m=function e(){"use strict";var t=this;(0,p._)(this,e),this.audioStart=0,this.feed=function(e){var n=t.getFormatedValue(e),r=new Float32Array(t.samples.length+n.length);r.set(t.samples,0),r.set(n,t.samples.length),t.samples=r},this.getFormatedValue=function(e){for(var t=new Float32Array(e.length),n=0;n<e.length;n++)t[n]=e[n]/2147483648;return t},this.stop=function(){if(t.bufferSource)try{t.bufferSource.stop()}catch(e){if("InvalidStateError"!==e.name&&"RangeError"!==e.name)throw e}},this.flush=function(e){if(t.audioCtx&&t.samples.length){var n,r,i,o=0,a=t.audioCtx.currentTime;if(0===e)t.startTime=a,t.audioStart=a;else{for(var l=Math.floor((a-t.audioStart)*44100);l>e-32896;)t.audioStart+=.7459410430839002,l-=32896;l>e&&(o=l-e,t.startTime=a),t.startTime=a}t.samples=t.samples.slice(o,t.samples.length);for(var c=t.audioCtx.createBufferSource(),s=t.samples.length/1,u=t.audioCtx.createBuffer(1,s,44100),d=0;d<1;d++)for(i=0,n=u.getChannelData(d),r=d;i<s;i++)n[i]=t.samples[r],r+=1;t.startTime<t.audioCtx.currentTime&&(t.startTime=t.audioCtx.currentTime),c.buffer=u,c.connect(t.gainNode),c.start(t.startTime),t.stop(),t.bufferSource=c,t.startTime+=u.duration,t.samples=new Float32Array}},this.samples=new Float32Array;var n=window.AudioContext||window.webkitAudioContext;this.audioCtx=new n,this.gainNode=this.audioCtx.createGain(),this.gainNode.gain.value=1,this.gainNode.connect(this.audioCtx.destination),this.startTime=this.audioCtx.currentTime};function v(e){var t=e.container,n=(0,r._)((0,h.useState)(!1),2),p=n[0],v=n[1],g=(0,r._)((0,h.useState)(!1),2),y=g[0],b=g[1],Z=(0,f.Z)(t);(0,h.useEffect)(function(){if(Z===d.em.CONNECTED&&!0!==y){var e=setTimeout(function(){b(!0)},1e3);return function(){clearTimeout(e)}}},[Z,y]);var w=(0,h.useRef)(null);(0,h.useEffect)(function(){if(y&&t.getConnectionState()!==d.em.DISCONNECTED)return t.openChannel({name:"audio",service:"audio"},function(e){var t=e.channel,n=null,r=!1;return t.onCommand(function(e){var t;r||(r=!0,w.current=function(){n=new m,w.current=null},v(!0)),n&&(null==e?void 0:null===(t=e.audio2)||void 0===t?void 0:t.data)&&(e.audio2.samples||(e.audio2.samples=0),n.feed(Int32Array.from(e.audio2.data)),n.flush(e.audio2.samples))}),function(){v(!1),n&&(n.stop(),n=null),w.current=null}})},[t,y]);var x=function(){v(!1)};return(0,i.tZ)(a.u,{isOpen:p,onRequestClose:x,children:(0,i.BX)(c.G,{css:[u.l0.colWithGap(24)],children:[(0,i.tZ)(l.h4,{variant:"headerDefault",level:1,children:"We hear audio!"}),(0,i.BX)(c.G,{css:[u.l0.colWithGap(8)],children:[(0,i.tZ)(l.xv,{children:"Hey! It appears that this Repl is playing audio."}),(0,i.tZ)(l.xv,{children:"In order for us to hear the audio youre receiving, please click confirm."})]}),(0,i.BX)(c.G,{css:[u.l0.rowWithGap(12),u.l0.justify.end],children:[(0,i.tZ)(o.zx,{onClick:x,text:"Cancel"}),(0,i.tZ)(o.zx,{colorway:"positive",onClick:function(){v(!1),w.current&&w.current()},text:"Confirm",iconLeft:(0,i.tZ)(s.Z,{})})]})]})})}},30249:function(e,t,n){n.d(t,{Z:function(){return y},e:function(){return w}});var r=n(41733),i=n(98924),o=n(74985),a=n(55534),l=n(1498),c=n(15146),s=n(38080),u=n(74833),d=n(56596),f=n(93918),h=n(9331),p=n(41859),m=n(29287),v=n(19659),g=(0,f.X)({code:[m.l0.font.code,m.l0.flex.grow(1)],surface:[m.l0.borderRadius(8),m.l0.p(8),m.l0.flex.row,m.l0.rowWithGap(8),m.l0.align.center]});function y(e){var t=w(e.filePath,e.keyName);if(!t)return null;var n=t.import,i=t.access;return(0,o.BX)(d.G,{css:m.l0.colWithGap(8),children:[n?(0,o.tZ)(b,(0,r._)({code:n},e)):null,(0,o.tZ)(b,(0,r._)({code:i},e))]})}function b(e){var t=e.code,n=e.onInsert,r=(0,i._)(e,["code","onInsert"]);return(0,o.BX)(s.Tg,{elevated:r.elevated,css:g.surface,children:[(0,o.tZ)(Z,{value:t}),(0,o.tZ)(u.xv,{variant:"small",css:g.code,multiline:!1,children:t}),n?(0,o.tZ)(l.zx,{variant:"outlined",size:"small",onClick:function(){return n(t)},text:"Insert",iconRight:(0,o.tZ)(h.Z,{})}):null]})}function Z(e){var t=e.value,n=(0,a.Z)();return(0,o.tZ)(c.hU,{alt:"Copy",tooltipHidden:!0,onClick:function(){navigator.clipboard.writeText(t).then(function(){n.showConfirm("Copied")})},children:(0,o.tZ)(p.Z,{})})}function w(e,t){if(!e)return null;switch((0,v.r6)(e)){case"js":case"ts":case"jsx":case"tsx":return{import:null,access:"const mySecret = process.env['".concat(t,"']")};case"py":return{import:"import os",access:"my_secret = os.environ['".concat(t,"']")};case"go":return{import:'import "os"',access:'mySecret := os.Getenv("'.concat(t,'")')};case"java":case"scala":return{import:null,access:'System.getenv("'.concat(t,'")')};case"rb":return{import:null,access:'ENV["'.concat(t,'"]')};case"c":case"cpp":return{import:"#include <stdlib.h>",access:'char* mySecret = getenv("'.concat(t,'")')};case"cs":return{import:"using System;",access:'string mySecret = System.Environment.GetEnvironmentVariable("'.concat(t,'");')};case"sh":return{import:null,access:'"$'.concat(t,'"')};default:return null}}},52489:function(e,t,n){n.d(t,{qi:function(){return ea},$M:function(){return es},u_:function(){return eh},BH:function(){return ep},ZP:function(){return eb}});var r=n(27387),i=n(41733),o=n(30509),a=n(66626),l=n(96583),c=n(74985),s=n(31900),u=n(76588),d=n(55534),f=n(50199),h=n(11516),p=n(59868),m=n(1498),v=n(70002),g=n(68514),y=n(15146),b=n(18836),Z=n(49344),w=n(48272),x=n(38080),C=n(74833),_=n(30983),S=n(56596),E=n(93918),k=n(44680),T=n(41859),R=n(52924),D=n(80339),I=n(98859),G=n(88936),B=n(99656),A=n(52682),P=n(29287),N=n(66349),U=n(18107),O=n(30249),L=n(88883),M=n(58091),X=n(50959),F=n(28268),W=n(30084),H=n(13747),V=n(80979),z=n(43182),j=n(20142),q=n(81013),Y=n(37951),$=n(32377),J=n(52686),K=n(15006),Q=n(27308),ee=p.U3.ENV_EDITOR_USED;function et(e){var t,n=e.secrets,i=e.update,o=(0,a._)((0,X.useState)(!1),2),s=o[0],u=o[1],d=(0,a._)((0,X.useState)(!1),2),f=d[0],h=d[1],v=(0,a._)((0,X.useState)(!1),2),g=v[0],y=v[1],b=(0,a._)((0,X.useState)(0),2),w=b[0],_=b[1],E=0===w,k=(0,X.useRef)();k.current||(k.current=(0,H.ir)(function(e){var t=en(e.state.doc.toString());return _(t),0!==t?(0,p.j)(ee,{action:"rawEditorUpdatedError"}):(0,p.j)(ee,{action:"rawEditorUpdated"}),[]}));var T=(0,q.Z)(),R=T.ref,D=T.view,I=function(){f||u(!1)},G=function(){y(!1),u(!0),(0,p.j)(ee,{action:"rawEditorOpened"})},B=function(){if(!D)return!1;var e=en(D.state.doc.toString());return _(e),0===e},A=(t=(0,r._)(function(){var e;return(0,l.Jh)(this,function(t){switch(t.label){case 0:if(!D||!B())return[2];h(!0),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,i(JSON.parse(D.state.doc.toString()))];case 2:return t.sent(),h(!1),y(!0),setTimeout(function(){I(),setTimeout(function(){y(!1)},500)},500),[3,4];case 3:return e=t.sent(),z.Tb(e),(0,p.j)(ee,{action:"rawEditorUpdatedError"}),_(3),h(!1),[3,4];case 4:return[2]}})}),function(){return t.apply(this,arguments)});return(0,X.useEffect)(function(){if(D){var e=JSON.stringify(n,null,2);"{}"===e&&(e="{\n  \n}"),D.dispatch({changes:{from:0,to:D.state.doc.length,insert:e}}),D.dispatch({selection:{anchor:D.state.doc.length-2}}),D.focus()}},[D,n]),(0,c.BX)(c.HY,{children:[(0,c.tZ)(m.zx,{onClick:function(){return G()},text:"Edit as JSON",iconLeft:(0,c.tZ)(J.Z,{}),size:"small"}),(0,c.tZ)(Z.u,{isOpen:s,onRequestClose:function(){return I()},children:(0,c.BX)(S.G,{css:[P.l0.colWithGap(24)],children:[(0,c.tZ)(C.h4,{level:1,variant:"headerDefault",children:"Raw Secrets Editor"}),(0,c.tZ)(C.xv,{children:"Secrets are specified in JSON. Values must be strings."}),(0,c.tZ)(x.Tg,{css:[P.l0.borderRadius(8),P.l0.transition.snappy,P.l0.p(4),{border:"1px solid var(--outline-dimmer)",":hover":{borderColor:"var(--outline-stronger)"}}],elevated:!0,children:(0,c.tZ)(j.ZP,{ref:R,readOnly:f||g,extensions:[k.current,V.$f.of([{key:(0,Q.l2)({cmdOrCtrl:!0,key:"Enter"}),run:function(){return A(),!0},preventDefault:!0,stopPropagation:!0}])],language:"json",hideGutter:!0})}),(0,c.BX)(S.G,{css:[P.l0.rowWithGap(4),P.l0.justify.end],children:[!E&&(0,c.tZ)(Y.E,{icon:(0,c.tZ)(K.Z,{}),colorway:"negative",text:function(e){switch(e){case 1:return"Make sure the data is valid JSON.";case 2:return"Make sure that all values are strings.";case 3:return"There was an error saving the secrets.";default:return""}}(w)}),(0,c.BX)(S.G,{css:[P.l0.rowWithGap(12)],children:[(0,c.tZ)(m.zx,{onClick:I,text:"Cancel"}),(0,c.tZ)(m.zx,{iconLeft:(0,c.tZ)($.Z,{}),stretch:!0,colorway:g?"positive":"primary",text:g?"Saved!":"Save",disabled:!E||f||g,onClick:function(){return A()}})]})]})]})})]})}function en(e){try{var t=JSON.parse(e);for(var n in t)if("string"!=typeof n||"string"!=typeof t[n])return 2;return 0}catch(e){return 1}}var er=(0,E.X)({addSecretContainer:[P.l0.flex.column,P.l0.colWithGap(8),P.l0.py(8)],secretItemEdit:[P.l0.colWithGap(8)],secretItemEditInputs:[P.l0.rowWithGap(8)],secretItem:[P.l0.flex.row,P.l0.rowWithGap(8),P.l0.align.center],headerStyle:[P.l0.flex.row,P.l0.rowWithGap(8),P.l0.align.center,P.l0.p(8)],accessSecrect:[P.l0.px(8),P.l0.py(16),P.l0.colWithGap(8)],accessSecrectHeader:[P.l0.rowWithGap(8),P.l0.align.center]}),ei={fontFamily:"text-security-disc"};function eo(e){var t=e.onClose,n=e.onAdd,r=e.otherKeys,l=(0,a._)((0,X.useState)(!0),2),s=l[0],u=l[1],d=(0,a._)((0,X.useState)({key:"",value:""}),2),f=d[0],h=d[1],p=f.key.length>0&&!r.includes(f.key);return(0,c.tZ)(c.HY,{children:(0,c.BX)(S.G,{css:er.addSecretContainer,children:[(0,c.BX)(S.G,{css:P.l0.rowWithGap(8),children:[(0,c.BX)(S.G,{css:[P.l0.colWithGap(4),P.l0.width("40%")],children:[(0,c.tZ)(C.xv,{css:[P.l0.pt(2),P.l0.pb(4)],variant:"small",color:"dimmer",multiline:!1,children:"Key"}),(0,c.tZ)(b.II,{value:f.key,onChange:function(e){return h((0,o._)((0,i._)({},f),{key:e.target.value}))},placeholder:"SECRET_KEY",autoComplete:"off"}),r.includes(f.key)?(0,c.BX)(C.xv,{multiline:!1,variant:"small",css:{color:P.TV.accentNegativeDefault},children:['Secret "',f.key,'" already exists']}):null]}),(0,c.BX)(S.G,{css:[P.l0.colWithGap(4),P.l0.flex.growAndShrink(1)],children:[(0,c.BX)(S.G,{css:[P.l0.flex.row,P.l0.rowWithGap(4),P.l0.align.center],children:[(0,c.tZ)(C.xv,{variant:"small",color:"dimmer",multiline:!1,children:"Value"}),(0,c.tZ)(y.hU,{alt:"Toggle Visibility",tooltipHidden:!0,onClick:function(){return u(!s)},children:s?(0,c.tZ)(D.Z,{}):(0,c.tZ)(I.Z,{})})]}),(0,c.tZ)(b.II,{value:f.value,onChange:function(e){return h((0,o._)((0,i._)({},f),{value:e.target.value}))},style:s?ei:void 0,autoComplete:"off",placeholder:"Value"})]})]}),(0,c.BX)(S.G,{css:[P.l0.rowWithGap(8),P.l0.justify.end],children:[(0,c.tZ)(m.zx,{size:"small",text:"Cancel",onClick:function(){return t()}}),(0,c.tZ)(m.zx,{size:"small",text:"Add Secret",colorway:"primary",disabled:!p,onClick:function(){n({key:f.key.trim(),value:f.value}),h({key:"",value:""})}})]})]})})}function ea(e){var t=e.value,n=(0,d.Z)();return(0,c.tZ)(y.hU,{alt:"Copy",tooltipHidden:!0,onClick:function(){navigator.clipboard.writeText(t).then(function(){n.showConfirm("Copied")})},children:(0,c.tZ)(T.Z,{})})}var el=[P.l0.flex.row,P.l0.rowWithGap(8),P.l0.align.center],ec=(0,E.X)({root:[P.l0.height("100%"),P.l0.borderRadius(8),{'& [aria-haspopup="listbox"]':[P.l0.height(32)]}],item:el,itemDanger:[el,{color:P.TV.accentNegativeStronger}]});function es(e){var t=e.onEdit,n=e.onDelete;return(0,c.tZ)(x.Tg,{elevated:!0,css:ec.root,children:(0,c.tZ)(s.Z,{label:"Options",items:[{label:(0,c.BX)(S.G,{css:ec.item,children:[(0,c.tZ)(R.Z,{}),(0,c.tZ)(C.xv,{multiline:!1,children:"Edit"})]}),onClick:t},{label:(0,c.BX)(S.G,{css:ec.itemDanger,children:[(0,c.tZ)(A.Z,{}),(0,c.tZ)(C.xv,{multiline:!1,children:"Delete"})]}),isDescructive:!0,onClick:n}],onItemClick:function(e){var t;return null===(t=e.onClick)||void 0===t?void 0:t.call(e)}})})}var eu=[P.l0.p(4),P.l0.rowWithGap(4),P.l0.borderRadius(8)],ed=(0,E.X)({root:[eu,P.l0.width("40%"),P.l0.display.flex,P.l0.overflowX("hidden")],text:[P.l0.flex.growAndShrink(1)]}),ef=(0,E.X)({root:[eu,P.l0.flex.growAndShrink(1)],text:[P.l0.flex.growAndShrink(1),P.l0.truncate,{fontFamily:P.TV.fontFamilyCode}]});function eh(e){var t=e.value;return(0,c.BX)(x.Tg,{elevated:!0,css:ed.root,children:[(0,c.tZ)(ea,{value:t}),(0,c.tZ)(_.u,{tooltip:(0,c.tZ)(C.xv,{children:t}),children:function(e,n){return(0,c.tZ)(C.xv,(0,o._)((0,i._)({ref:n},e),{multiline:!1,css:ed.text,children:t}))}})]})}function ep(e){var t=e.value,n=(0,a._)((0,X.useState)(!1),2),r=n[0],i=n[1];return(0,c.BX)(x.Tg,{elevated:!0,css:ef.root,children:[(0,c.tZ)(ea,{value:t}),(0,c.tZ)(C.xv,{multiline:!1,css:ef.text,children:r?t:"".repeat(12)}),(0,c.tZ)(y.hU,{alt:"Toggle Secret",tooltipHidden:!0,onClick:function(){return i(!r)},children:r?(0,c.tZ)(I.Z,{}):(0,c.tZ)(D.Z,{})})]})}function em(e){var t=(0,a._)((0,X.useState)(""===e.secret.value?{key:e.secret.key,value:""}:null),2),n=t[0],r=t[1],l=(0,a._)((0,X.useState)(!1),2),s=l[0],u=l[1],d=(0,a._)((0,X.useState)(!0),2),f=d[0],h=d[1],p=e.secret;if(n&&!e.readOnly){var v,g=e.onDeleteSecret,w=e.onUpdateSecret;return(0,c.BX)(c.HY,{children:[(0,c.BX)(S.G,{css:er.secretItemEdit,children:[(0,c.BX)(S.G,{css:er.secretItemEditInputs,children:[(0,c.BX)(S.G,{css:[P.l0.colWithGap(2),P.l0.width("40%")],children:[(0,c.tZ)(C.xv,{multiline:!1,css:[P.l0.pt(2),P.l0.pb(4)],variant:"small",color:"dimmer",children:"Key"}),(0,c.tZ)(S.G,{children:(0,c.tZ)(b.II,{value:null!==(v=null==n?void 0:n.key)&&void 0!==v?v:"",onChange:function(e){return r(function(t){return t?(0,o._)((0,i._)({},t),{key:e.target.value}):t})},placeholder:"SECRET_KEY",autoComplete:"off"})})]}),(0,c.BX)(S.G,{css:[P.l0.flex.growAndShrink(1),P.l0.colWithGap(2)],children:[(0,c.BX)(S.G,{css:[P.l0.flex.row,P.l0.rowWithGap(4),P.l0.align.center],children:[(0,c.tZ)(C.xv,{multiline:!1,css:[P.l0.pt(2),P.l0.pb(4)],variant:"small",color:"dimmer",children:"Value"}),(0,c.tZ)(y.hU,{alt:"Toggle Visibility",tooltipHidden:!0,onClick:function(){return h(!f)},children:f?(0,c.tZ)(D.Z,{}):(0,c.tZ)(I.Z,{})})]}),(0,c.tZ)(S.G,{children:(0,c.tZ)(b.II,{value:n.value,style:f?ei:void 0,onChange:function(e){return r(function(t){return t?(0,o._)((0,i._)({},t),{value:e.target.value}):t})}})})]})]}),(0,c.BX)(S.G,{css:[P.l0.flex.row,P.l0.rowWithGap(8)],children:[(0,c.tZ)(m.zx,{size:"small",text:"Delete",colorway:"negative",onClick:function(){return u(!0)}}),(0,c.tZ)(S.G,{css:P.l0.flex.grow(1)}),(0,c.tZ)(m.zx,{size:"small",text:"Cancel",onClick:function(){return r(null)}}),(0,c.tZ)(m.zx,{size:"small",colorway:"primary",text:""===e.secret.value?"Add Secret":"Update Secret",disabled:!(null==n?void 0:n.key.length),onClick:function(){n&&(w(p.key,{key:n.key.trim(),value:n.value}),r(null))}})]})]}),(0,c.tZ)(Z.u,{isOpen:s,onRequestClose:function(){return u(!1)},children:(0,c.BX)(S.G,{children:[(0,c.BX)(C.xv,{variant:"subheadDefault",multiline:!1,children:["Delete ",p.key,"?"]}),(0,c.tZ)(C.xv,{color:"dimmer",multiline:!1,children:"Are you sure you would like to delete this secret? This cannot be undone."}),(0,c.BX)(S.G,{css:[P.l0.justify.end,P.l0.flex.row,P.l0.rowWithGap(8)],children:[(0,c.tZ)(m.zx,{text:"Cancel",onClick:function(){return u(!1)}}),(0,c.tZ)(m.zx,{text:"Delete",colorway:"negative",onClick:function(){return g(p.key)}})]})]})})]})}return(0,c.BX)(S.G,{css:er.secretItem,children:[(0,c.tZ)(eh,{value:p.key}),(0,c.tZ)(ep,{value:p.value}),e.readOnly?null:(0,c.BX)(c.HY,{children:[(0,c.tZ)(S.G,{children:(0,c.tZ)(es,{onEdit:function(){return r(p)},onDelete:function(){return u(!0)}})}),(0,c.tZ)(Z.u,{isOpen:s,onRequestClose:function(){return u(!1)},children:(0,c.BX)(S.G,{css:[P.l0.colWithGap(24)],children:[(0,c.BX)(C.xv,{multiline:!1,variant:"headerDefault",children:["Delete ",p.key,"?"]}),(0,c.tZ)(C.xv,{color:"dimmer",multiline:!1,children:"Are you sure you would like to delete this secret? This cannot be undone."}),(0,c.BX)(S.G,{css:[P.l0.justify.end,P.l0.flex.row,P.l0.rowWithGap(12)],children:[(0,c.tZ)(m.zx,{text:"Cancel",onClick:function(){return u(!1)}}),(0,c.tZ)(m.zx,{iconLeft:(0,c.tZ)(A.Z,{}),text:"Yes, delete secret",colorway:"negative",onClick:function(){return e.onDeleteSecret(p.key)}})]})]})})]})]})}function ev(e){var t=e.secrets,n=e.onUpdateSecret,r=e.onDeleteSecret,i=e.onAddSecret,o=e.showAddSecret,l=e.onClose,s=Object.entries(t).filter(function(e){var t=(0,a._)(e,2);return""===(t[0],t[1])}),u=Object.entries(t).filter(function(e){var t=(0,a._)(e,2);return""!==(t[0],t[1])});return(0,c.BX)(S.G,{css:[P.l0.colWithGap(8),P.l0.px(8),P.l0.py(8)],children:[0!==s.length&&(0,c.BX)(c.HY,{children:[(0,c.BX)(S.G,{css:[P.l0.colWithGap(8)],children:[(0,c.tZ)(C.xv,{variant:"subheadDefault",multiline:!1,children:"Configure missing Secret values"}),(0,c.tZ)(C.xv,{variant:"small",children:"This Repl contains Secrets that might be required. Add values to ensure the code runs as expected."}),(0,c.tZ)(S.G,{css:[P.l0.colWithGap(8)],children:s.map(function(e){var t=(0,a._)(e,2),i=t[0],o=t[1];return(0,c.tZ)(em,{secret:{key:i,value:o},onUpdateSecret:n,onDeleteSecret:r},i)})})]}),(0,c.tZ)(g.R,{})]}),(0,c.BX)(S.G,{css:[P.l0.colWithGap(8)],children:[o?(0,c.tZ)(eo,{onClose:l,onAdd:i,otherKeys:Object.keys(t)}):null,u.map(function(e){var t=(0,a._)(e,2),i=t[0],o=t[1];return(0,c.tZ)(em,{secret:{key:i,value:o},onUpdateSecret:n,onDeleteSecret:r},i)})]})]})}function eg(e){var t=e.secrets,n=e.activeFile,r=(0,a._)((0,X.useState)(Object.keys(t)[0]),2),i=r[0],o=r[1];return(0,L.Z)(n)&&(0,O.e)(n,i)&&0!==Object.keys(t).length?(0,c.BX)(S.G,{css:er.accessSecrect,children:[(0,c.BX)(S.G,{css:er.accessSecrectHeader,children:[(0,c.tZ)(C.xv,{multiline:!1,children:"Access secret"}),(0,c.tZ)(w.P,{css:P.l0.minWidth(48),items:Object.keys(t).map(function(e){return{title:e}}),selectedItem:{title:i},onChange:function(e){return o(e.title)}})]}),(0,c.tZ)(O.Z,{elevated:!0,keyName:i,filePath:n})]}):null}function ey(e,t){var n=(0,i._)({},e);return"add"===t.type?n[t.key]=t.value:"update"===t.type?(delete n[t.oldKey],n[t.key]=t.value):delete n[t.key],n}function eb(e){var t,n,o,s,y,b=e.readRawEnv,Z=e.writeRawEnv,w=e.getRunState,x=(0,M.R3)(),_=(0,a._)((0,X.useState)(null),2),E=_[0],T=_[1],R=(0,a._)((0,X.useState)(!1),2),D=R[0],I=R[1],A=function(){I(!1)},O=(0,N.Z)();(0,X.useEffect)(function(){(0,p.Cn)(p.U3.ENV_EDITOR_USED,{action:"opened"}),h.Z.set("enveditortour",!0)},[]),(0,X.useEffect)(function(){function e(){return(e=(0,r._)(function(){var e;return(0,l.Jh)(this,function(t){switch(t.label){case 0:return[4,b()];case 1:if((e=t.sent()).error===W.Df.NotFound)return T({}),[2];if(e.error)throw Error("Error getting .env");return T(F.Z.parse(e.content.toString())),[2]}})})).apply(this,arguments)}!function(){e.apply(this,arguments)}()},[b,T]);var L=(0,X.useRef)(null),H=(0,X.useRef)([]),V=(t=(0,r._)(function(e){var t,n,r,i;return(0,l.Jh)(this,function(o){switch(o.label){case 0:if(!E)throw Error("trying to write secrets before loading");return T(t=ey(E,e)),H.current.push(e),n=Math.random(),L.current=n,[4,b()];case 1:if(i=o.sent(),L.current!==n)return[2];return i.error?r=t:(r=F.Z.parse(i.content.toString()),H.current.forEach(function(e){r=ey(r,e)}),T(r)),H.current=[],[4,Z(F.Z.serialize(r))];case 2:return o.sent(),[2]}})}),function(e){return t.apply(this,arguments)}),z=(0,d.Z)().showConfirm,j=(n=(0,r._)(function(e){return(0,l.Jh)(this,function(t){return(0,p.j)(p.U3.ENV_EDITOR_USED,{action:"created",multiline:e.value.includes("\n")}),V((0,i._)({type:"add"},e)),w()===U.Ah.RUNNING&&z("Re-run your Repl to use this secret"),A(),[2]})}),function(e){return n.apply(this,arguments)}),q=(o=(0,r._)(function(e,t){return(0,l.Jh)(this,function(n){return(0,p.j)(p.U3.ENV_EDITOR_USED,{action:"updated",multiline:t.value.includes("\n")}),V((0,i._)({type:"update",oldKey:e},t)),[2]})}),function(e,t){return o.apply(this,arguments)}),Y=(s=(0,r._)(function(e){return(0,l.Jh)(this,function(t){return(0,p.j)(p.U3.ENV_EDITOR_USED,{action:"deleted"}),V({type:"delete",key:e}),[2]})}),function(e){return s.apply(this,arguments)}),$=(0,f.Z)(function(){return E&&Object.keys(E).length>0},[E]);return E&&O?(0,c.BX)(S.G,{css:[P.l0.flex.column],children:[(0,c.BX)(S.G,{css:er.headerStyle,children:[(0,c.tZ)(C.xv,{css:P.l0.flex.growAndShrink(1),variant:"subheadDefault",multiline:!1,children:"Secrets"}),(0,c.tZ)(et,{secrets:E,update:(y=(0,r._)(function(e){return(0,l.Jh)(this,function(t){switch(t.label){case 0:return T(e),[4,Z(F.Z.serialize(e))];case 1:return t.sent(),[2]}})}),function(e){return y.apply(this,arguments)})}),(0,c.tZ)(v.Z,{iconLeft:(0,c.tZ)(k.Z,{}),href:"https://docs.replit.com/programming-ide/workspace-features/secrets",size:"small",text:"Docs",target:"_blank"}),(0,c.tZ)(m.zx,{iconLeft:(0,c.tZ)(B.Z,{}),text:"New Secret",colorway:"primary",size:"small",onClick:function(){return I(!0)}})]}),(0,c.tZ)(S.G,{css:[P.l0.px(8)],children:(0,c.tZ)(g.R,{})}),0===Object.keys(E).length&&!1===D?(0,c.BX)(S.G,{css:[P.l0.center,P.l0.flex.shrink(1)],children:[(0,c.tZ)(u.Z,{alt:"A rotating key",src:"/public/images/secrets/secretskey.gif",height:200,width:200,objectFit:"contain"}),(0,c.tZ)(C.xv,{variant:"subheadDefault",multiline:!1,children:"Store sensitive information securely using Secrets."}),(0,c.tZ)(C.xv,{css:[P.l0.textAlign.center,P.l0.mt(8),P.l0.color],multiline:!1,children:(0,c.tZ)("a",{href:"https://docs.replit.com/programming-ide/workspace-features/secrets#how-replit-keeps-your-secrets-safe",target:"_blank",rel:"noopener",children:"How does Replit keep my Secrets safe?"})})]}):null,(0,c.tZ)(ev,{secrets:E,onUpdateSecret:q,onDeleteSecret:Y,onAddSecret:j,showAddSecret:D,onClose:A}),x&&$?(0,c.tZ)(eg,{secrets:E,activeFile:x}):null]}):(0,c.tZ)(S.G,{css:[P.l0.center,P.l0.coverContainer],children:(0,c.tZ)(G.Z,{size:24})})}},66995:function(e,t,n){n.d(t,{tr:function(){return U}});var r=n(42516),i=n(66626),o=n(74985),a=n(43312),l=n(25632),c=n(22487),s=n(91608),u=n(93496),d=n(57468),f=n(1415),h=n(38080),p=n(56596),m=n(93918),v=n(9331),g=n(50451),y=n(29287),b=n(54916),Z=n(72676),w=n(21488),x=n(50959),C=n(19659),_=n(39756),S=n(30084);function E(e){var t=e.node;return t.type===S.Tv.Directory?(0,o.tZ)(g.Z,{size:16}):(0,o.tZ)(d.Z,{size:16,path:t.path})}var k=(0,s.$)(["menuY","menuX"]),T=k.cssVars,R=k.styleTokens,D=(0,m.X)({root:[y.l0.maxHeight(400),y.l0.position.absolute,y.l0.borderRadius(8),y.l0.shadow(3),{border:"1px solid",borderColor:y.TV.outlineDefault,top:R.menuY,left:R.menuX,"& > div":[y.l0.maxHeight(400)]}]}),I=(0,a.iv)([u.gU.nofill,{transitionProperty:"background-color, box-shadow, opacity",opacity:.8,":focus":{zIndex:1,opacity:1}}]),G={button:(0,a.iv)([y.l0.reset.button,y.l0.p(2),y.l0.rowWithGap(4),y.l0.align.center,I]),text:(0,a.iv)({fontSize:y.TV.fontSizeSmall})},B={opacity:1};function A(e){var t,n=e.node,a=e.openFile,l=e.expandable,s=void 0===l||l,u=(0,i._)((0,x.useState)(!1),2),d=u[0],m=u[1],v=(0,x.useRef)(null),g=(0,c.Z)(function(e){var t;!d||e.target instanceof HTMLElement&&(null===(t=v.current)||void 0===t?void 0:t.contains(e.target))||m(!1)},[d]),y=(0,x.useId)(),b=(0,x.useId)(),Z=(0,C.Il)(n.path)||_.Ql,w=(0,C.UO)(n.path);function S(){var e,t=null===(e=v.current)||void 0===e?void 0:e.getBoundingClientRect();t&&s&&m({x:t.x+"px",y:t.y+t.height+4+"px"})}return(0,o.BX)(o.HY,{children:[(0,o.BX)(p.G,{innerRef:v,tag:"button",id:y,style:d?B:void 0,"aria-haspopup":"true","aria-expanded":!!d,"aria-controls":b,css:G.button,onClick:function(){s&&(d?m(!1):S())},onKeyDown:function(e){switch(e.key){case" ":case"Enter":case"ArrowDown":if(!s)return;S()}},children:[(0,x.cloneElement)((0,o.tZ)(E,{node:n}),{size:12}),(0,o.tZ)(p.G,{css:G.text,children:w})]}),d&&s?(0,o.tZ)(f.h,{children:(0,o.tZ)(h.Tg,{id:b,css:D.root,innerRef:g,style:(t={},(0,r._)(t,T.menuX,d.x),(0,r._)(t,T.menuY,d.y),t),onKeyDown:function(e){if("Escape"===e.key){var t;m(!1),null===(t=v.current)||void 0===t||t.focus()}},children:(0,o.tZ)(P,{openFile:a,parentPath:Z,currentPath:n.path})})}):null]})}function P(e){var t=(0,b.Z)().fs,n=(0,l.Gn)("fontSize").preferences,r=(0,w.T)(!0),i=(0,x.useCallback)(function(e){return!r(e.filename)},[r]),a=(0,Z.p)({fs:t,filter:i,focusedPath:e.currentPath,fontSize:n.fontSize,root:e.parentPath,manageWidth:!0,onFileSelect:function(t){var n=t.path;e.openFile(n)},alwaysShowCreateRow:!0});return(0,o.tZ)(Z.s,{store:a.store})}var N=(0,a.iv)([y.l0.flex.row,y.l0.align.center,y.l0.height("100%"),y.l0.px(2)]),U=(0,x.memo)(function(e){var t,n,r=e.path,i=e.onFileClick,a=e.expandable,l=void 0===a||a,c=e.children,s=(n=(t=r.split("/")).length,t.map(function(e,r){return{type:r===n-1?S.Tv.File:S.Tv.Directory,path:t.slice(0,r+1).join("/")}}));return(0,o.BX)(p.G,{css:N,children:[s.map(function(e){return(0,o.BX)(x.Fragment,{children:[(0,o.tZ)(A,{node:e,openFile:i,expandable:l}),e.type===S.Tv.Directory?(0,o.tZ)(v.Z,{size:12}):null]},CSS.escape(e.path))}),c||null]})})},12506:function(e,t,n){n.d(t,{VY:function(){return B},HK:function(){return P},h4:function(){return R},Qc:function(){return I},H4:function(){return N},$E:function(){return A},Mp:function(){return U}});var r=n(27387),i=n(96583),o=n(74985),a=n(43312),l=n(50199),c=n(10041),s=n(19659);function u(){return(u=(0,r._)(function(e,t){var n,r,o,a,l;return(0,i.Jh)(this,function(i){return n=(0,s.yC)(e),r=(0,s.UO)(e),o=new Blob([t.toBuffer()],{type:n}),(a=document.createElement("a")).download=r,l=window.URL.createObjectURL(o),a.href=l,a.style.display="none",document.body.appendChild(a),a.click(),setTimeout(function(){document.body.removeChild(a),URL.revokeObjectURL(l)},1e4),[2]})})).apply(this,arguments)}var d=n(24227),f=n(56596),h=n(48728),p=n(41859),m=n(42463),v=n(8017),g=n(52682),y=n(29287),b=n(54916),Z=n(47611),w=n.n(Z),x=n(50959),C=n(38806),_=n(3947),S=n(58091),E=n(80259),k=n(66995),T=(0,a.iv)([y.l0.height(28),y.l0.flex.row,y.l0.align.center,{borderBottom:"1px solid ".concat(y.TV.backgroundHigher),opacity:.8,":hover":{opacity:1}}]);function R(e){return"/replEnvironmentDesktop"!==w().pathname?null:(0,o.tZ)(f.G,{css:T,children:e.children})}var D=(0,a.iv)([y.l0.flex.row,y.l0.align.center,y.l0.flex.growAndShrink(1),y.l0.overflowX("auto"),y.l0.height("100%"),{"&::-webkit-scrollbar":{height:0},scrollbarWidth:"none"}]);function I(e){return(0,o.tZ)(f.G,{css:D,children:e.children})}var G=(0,a.iv)([y.l0.flex.growAndShrink(1),y.l0.position.relative,y.l0.overflow("hidden"),y.l0.borderRadius(0,0,8,8)]);function B(e){return(0,o.tZ)(f.G,{css:[G,e.children&&y.l0.center],children:e.children})}function A(e){return{type:(0,_.Dp)({path:e}),data:{path:e}}}function P(e){var t=e.path,n=e.performPaneOperation,r=(0,x.useCallback)(function(e){n({operation:"replace",pane:A(e)})},[n]);return(0,o.tZ)(R,{children:(0,o.tZ)(I,{children:(0,o.tZ)(k.tr,{path:t,onFileClick:r})})})}function N(e,t){return{match:E.pl,data:{label:"Download",icon:(0,o.tZ)(m.Z,{}),type:"action",run:function(){return(0,r._)(function(){var n;return(0,i.Jh)(this,function(r){switch(r.label){case 0:return[4,t.readFile(e)];case 1:if((n=r.sent()).error)return[2,{type:"error",message:"Error downloading file"}];return[4,function(e,t){return u.apply(this,arguments)}(e,n.content)];case 2:return r.sent(),[2]}})})()}}}}function U(e){var t=e.path,n=e.performPaneOperation,a=(0,b.Z)(),s=(0,S._o)();return(0,l.Z)(function(){var e,l;return t?[{match:E.pl,data:{label:"Copy file path",icon:(0,o.tZ)(h.Z,{}),type:"action",run:function(){(0,c.Z)(t)}}},{match:E.pl,data:{label:"Copy link",icon:(0,o.tZ)(v.Z,{}),type:"action",run:function(){var e=(0,C.dr)({path:t});(0,c.Z)(e)}}},(e=a.fs,l=function(e){n({operation:"replace",pane:{type:(0,_.Dp)({path:e}),data:{path:e}}})},{match:E.pl,data:{label:"Duplicate file",icon:(0,o.tZ)(p.Z,{}),type:"action",run:function(){return(0,r._)(function(){var n;return(0,i.Jh)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,(0,d.Z)(t,e)];case 1:return n=r.sent(),[3,3];case 2:return r.sent(),[2,{type:"error",message:"Error duplicating file"}];case 3:return l(n),[2]}})})()}}}),N(t,a.fs),{match:E.pl,data:{label:"Delete",icon:(0,o.tZ)(g.Z,{color:y.TV.redDefault}),type:"action",run:function(){s(t)}}}]:null},[t,a.fs,n,s])}},85267:function(e,t,n){n.d(t,{Z:function(){return u}});var r=n(74985),i=n(1498),o=n(74833),a=n(56596),l=n(39469),c=n(29287),s=n(19659);function u(e){var t,n=e.paths,u=e.onCancel,d=e.onConfirm;return(0,r.BX)(a.G,{css:[c.l0.colWithGap(24)],children:[(0,r.tZ)(o.h4,{level:1,variant:"headerDefault",children:n.length>1?"Overwrite files?":"Overwrite file?"}),(0,r.BX)(o.xv,{children:[(t=(t=n).map(s.UO)).length<2?t[0]:"".concat(t.slice(0,-1).join(", ")," and ").concat(t.slice(-1))," already"," ",n.length>1?"exist":"exists"," in the destination, are you sure you want to overwrite ",n.length>1?"them":"it","? This cannot be undone."]}),(0,r.BX)(a.G,{css:[c.l0.rowWithGap(12),c.l0.justify.end],children:[(0,r.tZ)(i.zx,{onClick:function(){return u()},text:"Cancel"}),(0,r.tZ)(i.zx,{colorway:"negative",onClick:function(){return d()},text:"Yes, overwrite ".concat(n.length>1?"these files":"this file"),iconLeft:(0,r.tZ)(l.Z,{})})]})]})}},1642:function(e,t,n){n.d(t,{eo:function(){return b},fO:function(){return y},pe:function(){return Z}});var r=n(66626),i=n(74985),o=n(43312),a=n(10041),l=n(59868),c=n(1498),s=n(30983),u=n(93918),d=n(41859),f=n(64992),h=n(2532),p=n(29287),m=n(50959),v=(0,o.F4)({"0%":{opacity:0,transform:"translateX(8px)"},"10%":{opacity:1,transform:"translateX(0)"},"95%":{opacity:1},"100%":{opacity:0}}),g=(0,u.X)({buttonContainer:[p.l0.position.relative,{transition:"opacity 75ms linear",opacity:1}],buttonWrapper:[p.l0.flex.row],button:[p.l0.backgroundColor.backgroundDefault],buttonToast:{position:"absolute",display:"block",bottom:"100%",paddingBottom:p.TV.space4,paddingRight:p.TV.space8,animation:"".concat(v," 3s"),fontFamily:p.TV.fontFamilyDefault,fontSize:p.TV.fontSizeDefault,whiteSpace:"nowrap",userSelect:"none"}}),y=function(e){var t=e.code,n=e.language,o=(0,r._)((0,m.useState)(!1),2),s=o[0],u=o[1];return(0,i.BX)("div",{css:g.buttonContainer,children:[s?(0,i.tZ)("span",{css:g.buttonToast,onAnimationEnd:function(){requestAnimationFrame(function(){u(!1)})},"aria-hidden":!0,children:"Copied!"}):null,(0,i.tZ)(c.zx,{css:g.button,text:"Copy",size:"small",iconLeft:(0,i.tZ)(d.Z,{}),onClick:function(){(0,l.j)(l.U3.GHOSTWRITER_CHAT_CODE_COPIED,{language:n}),(0,a.Z)(t),u(!0)}})]})},b=function(e){var t=e.code,n=e.disabled,o=e.insertCode,a=(0,r._)((0,m.useState)(!1),2),l=a[0],u=a[1],d=(0,i.tZ)(c.zx,{css:g.button,text:"Insert",disabled:n,size:"small",iconLeft:(0,i.tZ)(h.Z,{}),onClick:function(){o&&(o(t),u(!0))}});return(0,i.BX)("div",{css:g.buttonContainer,children:[l?(0,i.tZ)("span",{css:g.buttonToast,onAnimationEnd:function(){requestAnimationFrame(function(){u(!1)})},"aria-hidden":!0,children:"Inserted!"}):null,(0,i.tZ)(s.u,{placement:"bottom",tooltip:n?"Place cursor in a file to insert code":"Insert code at cursor position",children:d})]})},Z=function(e){var t=e.revertCodeInsert,n=(0,r._)((0,m.useState)(!1),2),o=n[0],a=n[1],l=(0,i.tZ)(c.zx,{css:g.button,text:"Revert",size:"small",iconLeft:(0,i.tZ)(f.Z,{}),onClick:function(){t(),a(!0)}});return(0,i.BX)("div",{css:g.buttonContainer,children:[o?(0,i.tZ)("span",{css:g.buttonToast,onAnimationEnd:function(){requestAnimationFrame(function(){a(!1)})},"aria-hidden":!0,children:"Reverting..."}):null,(0,i.tZ)(s.u,{placement:"bottom",tooltip:"Revert code insertion",children:l})]})}},43409:function(e,t,n){n.d(t,{As:function(){return eD},v0:function(){return eG}});var r=n(41733),i=n(74985),o=n(66626),a=n(59868),l=n(15146),c=n(56596),s=n(34815),u=n(1652),d=n(13660),f=n(36461),h=n(65434),p=n(29287),m=n(92815),v=n(75582),g=n(50959),y=n(21262),b=n(71440),Z=n(99165);function w(){var e=(0,y._)(["\n  mutation AIFeedback($input: CodexFeedback2Input!) {\n    giveCodexFeedback2(input: $input) {\n      ... on CodexFeedback2 {\n        id\n        __typename\n      }\n      ... on UnauthorizedError {\n        __typename\n      }\n      ... on NotFoundError {\n        __typename\n      }\n    }\n  }\n"]);return w=function(){return e},e}var x={},C=(0,b.Ps)(w()),_=n(93918),S=(0,_.X)({styles0:[p.l0.rowWithGap(4),p.l0.align.center],styles1:[p.l0.color.foregroundDimmer],styles2:[p.l0.color.foregroundDimmer]}),E=function(e){var t=e.provideFeedback;return(0,i.BX)(c.G,{css:S.styles0,children:[(0,i.tZ)(l.hU,{alt:"Helpful",colorway:"positive",children:(0,i.tZ)(f.Z,{css:{"&:not(:hover)":S.styles1},onClick:function(){return t(v.TY.Yes)}})}),(0,i.tZ)(l.hU,{alt:"Unhelpful",colorway:"negative",children:(0,i.tZ)(u.Z,{css:{"&:not(:hover)":S.styles2},onClick:function(){return t(v.TY.No)}})})]})},k=function(e){return e.feedback===v.TY.Yes?(0,i.tZ)(h.Z,{}):(0,i.tZ)(d.Z,{})};function T(e){var t,n=e.inferenceId,l=e.inferenceClass,c=(0,o._)((0,g.useState)(null),2),u=c[0],d=c[1],f=(0,m.v)(),h=(0,o._)((t=(0,r._)({},x,void 0),Z.D(C,t)),2),p=h[0];return h[1].error?(0,i.tZ)(s.Z,{}):(0,i.tZ)(i.HY,{children:u?(0,i.tZ)(k,{feedback:u}):(0,i.tZ)(E,{provideFeedback:function(e){l===v.Sg.Chat&&(0,a.j)(a.U3.GHOSTWRITER_CHAT_FEEDBACK_SUBMITTED,{feedback:e}),p({variables:{input:{feedback:e,inferenceClass:l,inferenceId:n}}}),d(e),f(!0)}})})}var R=n(88936),D=n(74833),I=n(59510),G=n.n(I),B=n(34495),A=n(50199),P=n(2038),N=n(73030),U=n(67914),O=n(19408),L=n(25934),M=n(20573),X=n(48272),F=n(55534),W=n(50782),H=n(1498),V=n(18836),z=n(8279);function j(){var e=(0,y._)(["\n  mutation GiveChatGhostwriterFeedback($input: WorkflowFeedbackInputType!) {\n    giveWorkflowFeedback(input: $input) {\n      ... on WorkflowFeedbackOutputType {\n        __typename\n        id\n      }\n      ... on UnauthorizedError {\n        __typename\n        message\n      }\n      ... on UserError {\n        __typename\n        message\n      }\n      ... on TooManyRequestsError {\n        __typename\n        message\n      }\n    }\n  }\n"]);return j=function(){return e},e}var q={},Y=(0,b.Ps)(j()),$=n(83898),J=n(49275),K=(0,_.X)({wrapper:[p.l0.colWithGap(8)],textInput:[[p.l0.flex.growAndShrink(1),p.l0.width("100%"),p.l0.height(64),{resize:"none"}]],buttonGroup:[p.l0.rowWithGap(8),p.l0.justify.end]}),Q=function(e){var t,n=e.isOpen,l=e.message,s=e.closeFeedback,u=(0,o._)((0,g.useState)(""),2),d=u[0],f=u[1],h=(0,F.Z)().showError,m=(0,$.zu)(),v=(0,J.nS)(),y=(0,W.Z)(),b=(0,P.T3)(),w=(0,o._)((t=(0,r._)({},q,{onError:function(){h("Unable to provide feedback")},onCompleted:function(e){var t;(null===(t=e.giveWorkflowFeedback)||void 0===t?void 0:t.__typename)!=="WorkflowFeedbackOutputType"?h(e.giveWorkflowFeedback.message):(v({message:l,feedback:d}),f(""),s())}}),Z.D(Y,t)),2),x=w[0],C=w[1].loading,_=(0,g.useCallback)(function(){(0,a.j)(a.U3.GHOSTWRITER_CHAT_INLINE_FEEDBACK_CANCELLED),s()},[s]),S=(0,g.useCallback)(function(){0!==d.length&&((0,a.j)(a.U3.GHOSTWRITER_CHAT_INLINE_FEEDBACK_SUBMITTED),x({variables:{input:{ghostwriterChatFeedback:{chatHistory:JSON.stringify(m),feedback:d,metadata:JSON.stringify({messageId:l.inferenceId,replId:y,chatMessageId:l.id,isMobile:b})}}}}))},[m,x,b,l.id,l.inferenceId,y,d]);if(!n)return null;var E=C?z.p.backgroundPulse(p.TV.accentPrimaryDimmest,p.TV.accentPrimaryDimmer):null;return(0,i.BX)(c.G,{css:K.wrapper,children:[(0,i.tZ)(V.B,{css:[K.textInput],maxLength:5e3,autoFocus:!0,inputMode:"text",placeholder:"Let us know how we can improve this response",value:d,onChange:function(e){f(e.target.value)},onKeyDown:function(e){if("Escape"===e.key&&!C){_();return}"Enter"!==e.key||e.shiftKey||(e.stopPropagation(),S())}}),(0,i.BX)(c.G,{css:K.buttonGroup,children:[(0,i.tZ)(H.zx,{variant:"outlined",text:"Cancel",disabled:C,onClick:_}),(0,i.tZ)(H.zx,{css:E,iconLeft:C?(0,i.tZ)(R.Z,{}):void 0,text:C?"Submitting...":"Submit",disabled:C,colorway:"primary",onClick:S})]})]})},ee=n(99741),et=n(67313),en=function(e){var t=e.isOpen,n=e.onToggle,r=t?(0,i.tZ)(et.Z,{}):(0,i.tZ)(ee.Z,{});return(0,i.tZ)(H.zx,{variant:"outlined",text:"Send feedback",iconRight:r,onClick:function(){(0,a.j)(a.U3.GHOSTWRITER_CHAT_INLINE_FEEDBACK_TOGGLED,{state:t?"closed":"opened"}),n()}})},er=n(22580),ei=n(9100),eo=n(60769),ea=n(30983),el=n(30509),ec=n(26);function es(e){return(0,i.tZ)(ec.Z,(0,el._)((0,r._)({viewBox:"0 0 13 12"},e),{children:(0,i.tZ)("path",{d:"M6.25 0.721688C6.4047 0.632371 6.5953 0.632371 6.75 0.721688L10.9462 3.14434C11.1009 3.23365 11.1962 3.39872 11.1962 3.57735V8.42265C11.1962 8.60128 11.1009 8.76635 10.9462 8.85566L6.75 11.2783C6.5953 11.3676 6.4047 11.3676 6.25 11.2783L2.05385 8.85566C1.89915 8.76635 1.80385 8.60128 1.80385 8.42265V3.57735C1.80385 3.39872 1.89915 3.23365 2.05385 3.14434L6.25 0.721688Z",fill:"#5239CC",stroke:"#795EFF"})}))}var eu=n(97615),ed=n(64992),ef=n(90719),eh=n(87001),ep=(0,_.X)({footerContainer:[p.l0.rowWithGap(8),p.l0.flex.wrap],retryButton:[p.l0.width(100),{"@keyframes slideLeft":{"0%":{paddingLeft:30},"100%":{paddingLeft:8}},"@keyframes slideRight":{"0%":{paddingLeft:8},"100%":{paddingLeft:30}}}]}),em=function(e){var t,n=e.onRetry,r=e.limitReached,s=(0,o._)((0,ef.Ni)(),2),u=s[0],d=s[1],f=(0,g.useRef)(!1),h=(0,P.T3)(),m="advanced"===u&&!r,v=(0,g.useId)(),y=(0,ef.Lw)();t=!f.current||r?void 0:m?"slideLeft 300ms ease-out":"slideRight 300ms ease-out";var b=(0,i.BX)(i.HY,{children:[(0,i.tZ)(eo.X,{onChange:function(e){f.current||(f.current=!0),(0,a.j)(a.U3.GHOSTWRITER_CHAT_MODEL_CHANGED,{source:"footer",model:e.target.checked?"advanced":"default"}),d(e.target.checked?"advanced":"basic")},id:v,disabled:r,checked:!r&&m}),(0,i.tZ)("label",{htmlFor:v,css:r?[p.l0.color.foregroundDimmer]:void 0,children:"Advanced model"})]}),Z=y?"You have reached the weekly limit.":"Upgrade to Replit ".concat(eh.we," for the advanced model");return(0,i.BX)(c.G,{css:[p.l0.rowWithGap(8),p.l0.flex.growAndShrink(1),{justifyContent:"flex-end"}],children:["advanced"!==u||f.current?(0,i.BX)(c.G,{css:[p.l0.rowWithGap(8),p.l0.align.center],children:[r?(0,i.tZ)(ea.u,{tooltip:Z,children:(0,i.tZ)(c.G,{css:[p.l0.rowWithGap(8)],children:b})}):b,h?null:(0,i.tZ)(l.hU,{alt:r?Z:"Useful for more complex, vague, or creative requests.",size:24,children:(0,i.tZ)(eu.Z,{})})]}):null,(0,i.tZ)(H.zx,{css:[ep.retryButton,{paddingLeft:m?8:30,animation:t}],variant:"outlined",iconLeft:(0,i.tZ)(ed.Z,{}),iconRight:(0,i.tZ)(es,{css:[{transition:"opacity 300ms ease-out",opacity:m?1:0}]}),text:"Retry",onClick:function(e){return n(!!m)}})]})},ev=function(e){var t=e.onRetry,n=e.limitReached;return(0,i.tZ)(c.G,{css:ep.footerContainer,children:(0,i.tZ)(em,{onRetry:t,limitReached:n})})},eg=n(20766),ey=n(4736),eb=n(26568),eZ=n.n(eb),ew=n(45434),ex=n(19615),eC=n(84657),e_=(0,_.X)({root:[p.l0.px(8),p.l0.py(12),p.l0.colWithGap(8)],header:[p.l0.rowWithGap(8),p.l0.align.center],headerLeft:[p.l0.flex.growAndShrink(1),p.l0.rowWithGap(8),p.l0.align.center],intent:[p.l0.rowWithGap(4),p.l0.align.center,p.l0.color.foregroundDimmest],intentSelect:[p.l0.color.foregroundDimmer,{backgroundColor:"transparent",padding:4,height:"auto","& div":p.l0.rowWithGap(4),"& div > span":{fontSize:p.TV.fontSizeSmall},"& div > svg":{width:"12px !important",height:"12px !important",minWidth:"12px !important",minHeight:"12px !important"}}],message:[p.l0.colWithGap(8),p.l0.flex.growAndShrink(1)],footerContainer:[p.l0.rowWithGap(4),p.l0.justify.spaceBetween,p.l0.flex.wrapReverse]}),eS=new Map([["GENERATE",(0,i.tZ)(L.Z,{},"generate")],["EXPLAIN",(0,i.tZ)(O.Z,{},"explain")],["TRANSFORM",(0,i.tZ)(U.Z,{},"transform")]]),eE=[{title:"Ask chat",value:"NONE"},{title:"Generate code",value:"GENERATE"},{title:"Explain code",value:"EXPLAIN"},{title:"Edit code",value:"TRANSFORM"},{title:"Ask Replit docs",value:"REPLIT_DOCS"}].map(function(e){return(0,r._)({icon:eS.get(e.value)||(0,i.tZ)(N.Z,{})},e)}).sort(function(e,t){return e.title.localeCompare(t.title)}),ek=eZ()(function(){return n.e(4989).then(n.bind(n,54989))},{loadableGenerated:{webpack:function(){return[54989]}}}),eT=function(){return(0,i.BX)(c.G,{css:[p.l0.color.accentNegativeStronger,p.l0.flex.row,p.l0.rowWithGap(4),p.l0.align.center],children:[(0,i.tZ)(M.Z,{}),(0,i.tZ)(D.xv,{children:"Response reached maximum output length"})]})},eR=(0,_.X)({root:[p.l0.rowWithGap(4),p.l0.align.center,p.l0.color.foregroundDimmest]}),eD=function(e){var t=e.intent,n=eE.find(function(e){return e.value===t});return n?(0,i.BX)(c.G,{css:eR.root,children:[n.icon,(0,i.tZ)(D.xv,{variant:"small",color:"dimmest",children:n.title})]}):null},eI=function(e){var t=e.id,n=e.intent,r=e.regenerate,o=(0,$.gp)(),l="NONE"===n?null:eE.find(function(e){return e.value===n}),c=eE.filter(function(e){return e.value!==n});return(0,i.tZ)(X.P,{"aria-label":"Reclassify message",items:c,disabled:o,css:e_.intentSelect,placeholder:"Select action",selectedItem:l,onChange:function(e){(0,ew.J1)(e.value)&&((0,a.j)(a.U3.GHOSTWRITER_CHAT_INTENT_RECLASSIFIED,{from:n,to:e.value}),r({responseId:t,action:e.value}))}})},eG=(0,g.memo)(function(e){var t=e.message,n=e.autoScroll,r=e.isLastAssistantMessage,o=void 0!==r&&r,l=t.text,s=t.loading,u=t.error,d=t.inferenceId,f=t.stopReason,h=(0,$.Gd)(),y=(0,eg.d$)(),b=!!(t.stopReason||t.aborted),Z=(0,P.T3)(),w=(0,ey.ll)(),x=(0,ey.Tt)(),C=((t.tokenUsage||x)&&b||t.aborted||t.error)&&o,_=(b||void 0!==t.error)&&void 0!==d&&o,S=(0,m.M)(),E=(0,m.v)(),k=(0,g.useRef)(null),I=(0,eC.rM)();(0,g.useLayoutEffect)(function(){n&&k.current&&requestAnimationFrame(function(){n&&k.current&&((0,B.Z)(k.current,{skipOverflowHiddenElements:!0,behavior:"auto",scrollMode:"always"}),I(!0))})},[l,n,I,C,S]);var G=(0,A.Z)(function(){return(0,ei.BW)(t.id)},[t.id]);if("transformCode"===t.type&&!y)return null;var N="TRANSFORM"===t.intent?void 0:G,U="NONE"!==t.intent;return(0,i.BX)(c.G,{css:e_.root,children:[(0,i.tZ)(c.G,{css:e_.header,children:(0,i.BX)(c.G,{css:e_.headerLeft,children:[(0,i.tZ)(ex.R,{advanced:t.useAdvancedModel}),t.intent?(0,i.tZ)(c.G,{css:e_.intent,children:o?(0,i.tZ)(eI,{intent:t.intent,id:t.id,regenerate:h}):U&&(0,i.tZ)(eD,{intent:t.intent})}):null]})}),(0,i.BX)(c.G,{children:[s?(0,i.tZ)(R.Z,{}):null,(0,i.tZ)(c.G,{css:e_.message,children:(0,i.tZ)(er.J,{text:l,codeComponent:N})})]}),"string"==typeof u?(0,i.tZ)(c.G,{children:(0,i.tZ)(D.xv,{css:[p.l0.color.accentNegativeStronger,p.l0.fontSize(16)],children:u})}):null,"maxTokens"===f?(0,i.tZ)(eT,{}):null,(0,i.BX)(c.G,{css:e_.footerContainer,children:[_?(0,i.BX)(c.G,{css:[p.l0.rowWithGap(4)],children:[Z?null:(0,i.tZ)(en,{isOpen:S,onToggle:function(){return E(!S)}}),(0,i.tZ)(c.G,{css:[p.l0.rowWithGap(8),p.l0.align.center],children:(0,i.tZ)(T,{inferenceClass:v.Sg.Chat,inferenceId:d})})]}):null,C?(0,i.tZ)(ev,{limitReached:!w,onRetry:function(e){(0,a.j)(a.U3.GHOSTWRITER_CHAT_RESPONSE_REGENERATED,{isAdvancedModel:e,timesRegenerated:(t.timesRegenerated||0)+1}),h({responseId:t.id,action:t.intent})}}):null]}),(0,i.tZ)(Q,{isOpen:_&&S,closeFeedback:function(){return E(!1)},message:t}),y?(0,i.tZ)(ek,{message:t}):null,n?(0,i.tZ)(c.G,{css:{marginTop:-8,marginBottom:0},innerRef:k}):null]})},function(e,t){return t.autoScroll===e.autoScroll&&t.isLastAssistantMessage===e.isLastAssistantMessage&&G()(t.message,e.message)})},22580:function(e,t,n){n.d(t,{J:function(){return m}});var r=n(41733),i=n(74985),o=n(68333),a=n(74833),l=n(56596),c=n(50959),s=n(71253),u=n(66164),d=[n(25462).Z,u.Z,s.Z],f=[],h=function(e){return(0,i.tZ)(l.G,{children:(0,i.tZ)(a.xv,{children:e.children})})},p={h1:h,h2:h,h3:h,h4:h,h5:h,h6:h},m=(0,c.memo)(function(e){var t=e.text,n=e.codeComponent;return(0,i.tZ)(o.ZP,{remarkPlugins:d,rehypePlugins:f,components:(0,r._)({},p,n?{code:n}:void 0),lineBreaks:!0,themed:!0,children:t})})},9100:function(e,t,n){n.d(t,{BW:function(){return b},Vt:function(){return y}});var r=n(41733),i=n(74985),o=n(73164),a=n(53326),l=n(59868),c=n(57468),s=n(38080),u=n(74833),d=n(56596),f=n(93918),h=n(29287),p=n(1642),m=n(6079),v=n(29217),g=n(58091);function y(e){switch(e){case"crystal":return"main.cr";case"python":case"py":return"main.py";case"sh":case"fish":case"zsh":case"bash":return"main.sh";case"javascript":case"js":return"index.js";case"typescript":case"ts":return"index.ts";case"csharp":case"cs":return"main.cs";case"java":return"Main.java";case"go":return"main.go";case"ruby":case"rb":return"main.rb";case"php":return"main.php";case"rust":return"main.rs";case"swift":return"main.swift";case"kotlin":return"main.kt";case"scala":return"main.scala";case"c":return"main.c";case"cpp":case"c++":return"main.cpp";case"dart":return"main.dart";case"elixir":return"main.ex";case"haskell":return"Main.hs";case"lua":return"main.lua";case"perl":return"main.pl";case"r":return"main.r";case"sql":return"main.sql";case"ocaml":return"main.ml";case"html":return"index.html";case"json":return"main.json";case"css":return"main.css";default:return}}var b=function(e){return function(t){return w(t,e)}},Z=(0,f.X)({root:[h.l0.borderRadius(4),h.l0.border({color:h.TV.outlineDimmest})],header:[h.l0.rowWithGap(8),h.l0.border({color:h.TV.outlineDimmest,direction:"bottom"}),{fontFamily:h.TV.fontFamilyDefault}],headerLeft:[h.l0.rowWithGap(0),h.l0.pl(4),h.l0.flex.growAndShrink(1),h.l0.align.center],headerRight:[h.l0.rowWithGap(0),{"& button":{borderRadius:0},"& > div:last-of-type button":{borderTopRightRadius:4}}],blockStyles:{backgroundColor:"transparent"}}),w=function(e,t){if(e.inline)return(0,i.tZ)(a.Z,(0,r._)({},e));var n=(0,a.F)(e.className),l=n&&y(n),f=l?o.$R.from(l):void 0,m=null==f?void 0:f.name,v=String(e.children);return(0,i.BX)(s.Tg,{css:Z.root,children:[(0,i.BX)(d.G,{css:Z.header,children:[(0,i.BX)(d.G,{css:Z.headerLeft,children:[l?(0,i.tZ)(c.Z,{size:12,path:l}):null,m?(0,i.tZ)(u.xv,{multiline:!1,css:[h.l0.pl(4),h.l0.fontSize(12),h.l0.color.foregroundDimmer],children:m}):null]}),(0,i.BX)(d.G,{css:Z.headerRight,children:[(0,i.tZ)(p.fO,{code:v,language:n}),(0,i.tZ)(_,{messageId:t,code:v,language:n})]})]}),(0,i.tZ)(a.Z,(0,r._)({blockStyles:Z.blockStyles,disableCopy:!0},e))]})},x=function(e){(0,l.j)(l.U3.GHOSTWRITER_CHAT_CODE_INSERTED,{language:e})},C=function(){(0,l.j)(l.U3.GHOSTWRITER_CHAT_CODE_INSERT_REVERTED)},_=function(e){var t=e.code,n=e.messageId,r=e.language,o=(0,m.$L)(),a=o.onInsertCode,l=o.onRevertCode,c=(0,g.R3)(),s=(0,g.ex)(),u=(0,v.$0)();return(0,m.y6)(n)?(0,i.tZ)(p.pe,{revertCodeInsert:function(){l(C),u(null)}}):(0,i.tZ)(p.eo,{code:t,disabled:!(null!=c?c:s),insertCode:function(){a({toInsert:t,onInsert:function(){return x(r)}}),n&&u(n)}})}},24796:function(e,t,n){n.d(t,{r:function(){return c}});var r=n(74985),i=n(76588),o=n(74833),a=n(56596),l=n(29287);function c(e){var t=e.textVariant;return(0,r.BX)(o.xv,{variant:t,children:["AI Chat is currently unavailable. For more information, visit"," ",(0,r.tZ)("a",{href:"https://status.replit.com",target:"_blank",children:"our status page."})]})}t.Z=function(e){var t=e.textVariant,n=e.showImage;return(0,r.BX)(a.G,{css:[l.l0.center,l.l0.textAlign.center,l.l0.px(16),l.l0.colWithGap(8),l.l0.flex.growAndShrink(1)],children:[(0,r.tZ)(c,{textVariant:t}),n?(0,r.tZ)(i.Z,{src:"/public/images/ghostwriter/orb.png",css:[{userSelect:"none",mixBlendMode:"screen",filter:"brightness(110%) saturate(1.2)",maskImage:"linear-gradient(".concat(l.TV.backgroundRoot,", transparent)")}],width:200,height:200,objectFit:"contain","aria-hidden":"true",alt:"",draggable:!1}):null]})}},6079:function(e,t,n){n.d(t,{$L:function(){return d},$h:function(){return u},y6:function(){return f}});var r=n(66626),i=n(29217),o=n(3947),a=n(58091),l=n(76568),c=n(34581),s=n(50959);function u(){var e=(0,i.n3)(),t=(0,i.PM)(),n=(0,c.Vu)();(0,s.useEffect)(function(){e&&(n.includes(e)||t(null))},[e,n,t])}var d=function(){var e,t,n=(0,a.R3)(),u=(0,c.ex)(),d=(0,i.PM)(),f=null!=n?n:u,h=(e=(0,c.nC)(),t=(0,l.dr)(),(0,s.useCallback)(function(n){if(!n)return null;var i=e().find(function(e){var t=(0,r._)(e,2),i=(t[0],t[1]);return(0,o.Ur)(i)&&i.data.path===n});if(!i)return null;var a=t(i[0]);if((null==a?void 0:a.type)!=="codeEditor")throw Error("Expected code editor pane to insert into");if(!a||!a.insertGhostwriterChatCode||!a.revertGhostwriterChatCode)throw Error("Expected ghostwriter pane bindings");return{insert:a.insertGhostwriterChatCode,revert:a.revertGhostwriterChatCode}},[t,e]));return{onInsertCode:(0,s.useCallback)(function(e){var t=e.toInsert,n=e.overwrite,r=e.onInsert,i=h(f);i&&(i.insert(t,n),d(f),null==r||r())},[h,f,d]),onRevertCode:(0,s.useCallback)(function(e){var t=h(f);t&&(t.revert(),d(null),null==e||e())},[f,h,d])}},f=function(e){var t=(0,i.n3)(),n=(0,i.U4)();return!!e&&t&&n&&n===e}},35515:function(e,t,n){n.d(t,{I:function(){return s}});var r=n(27387),i=n(96583),o=n(99149),a=n(74044);n(34471),a.Dy.Object({replId:a.Dy.String({format:"uuid"})});var l=a.Dy.Object({token:a.Dy.String()}),c=n(9384);function s(e){return u.apply(this,arguments)}function u(){return(u=(0,r._)(function(e){var t;return(0,i.Jh)(this,function(n){switch(n.label){case 0:return[4,fetch("/ai/auth",{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({replId:e})})];case 1:return[4,n.sent().json()];case 2:if(t=n.sent(),!o.B4.Check(l,t))throw(0,c.o)("Authentication to chat service failed",{detail:t});return[2,t.token]}})})).apply(this,arguments)}},9384:function(e,t,n){n.d(t,{o:function(){return i}});var r=n(43182);function i(e,t){var n=Error(e);return r.$e(function(e){e.setTag("ghostwriter-chat",!0),t&&e.setExtras(t),r.Tb(n)}),n}},78228:function(e,t,n){n.d(t,{Th:function(){return T},c8:function(){return G},fT:function(){return k}});var r=n(13718),i=n(31417),o=n(27387),a=n(17528),l=n(66626),c=n(63257),s=n(2178),u=n(96583),d=n(43182),f=n(99149),h=n(56511),p=n(25632),m=n(15542),v=n(25425),g=n(50782),y=n(3590),b=n(4736),Z=n(50959),w=n(11548),x=n(52297),C=n(26572),_=n(83898),S=n(35515),E=n(9384),k={production:"wss://production-ai-chat.replit.com/ws",staging:"wss://staging-ai-chat.replit.com/ws",development:"ws://127.0.0.1:8000/ws"},T=function(){return(0,p.Gn)("ghostwriterChatServiceEnvironment").preferences.ghostwriterChatServiceEnvironment||k.production},R=function(e){if(f.B4.Check(x.LD,e)||f.B4.Check(x.t3,e))return e;throw(0,E.o)("Invalid model",{model:e})};function D(e){var t=f.B4.Convert(x.EI,JSON.parse(e.data));if(!f.B4.Check(x.EI,t)){var n=f.B4.Errors(x.EI,t);throw(0,E.o)("Invalid Ghostwriter Chat service message",{errors:(0,c._)(n)})}return t}function I(e,t){return new Date(e.timeCreated).getTime()-new Date(t.timeCreated).getTime()}var G=function(){var e,t=(0,h.l)(),n=(0,g.Z)(),f=(0,m.d)(),p=(0,y.jC)(),x=(0,_.kL)(),k=(0,l._)((0,Z.useState)(!1),2),G=k[0],B=k[1],A=(0,l._)((0,Z.useState)(0),2),P=A[0],N=A[1],U=T(),O=(0,b.Lv)(),L=(0,l._)((0,Z.useState)(function(){return(0,C.Z)()}),2),M=L[0],X=L[1],F=(0,v.P5)({controlName:"flag-blue-water-token"}),W=(0,Z.useCallback)((0,o._)(function(){var e,t;return(0,u.Jh)(this,function(r){switch(r.label){case 0:return[4,(0,S.I)(n)];case 1:return e=r.sent(),(t=new URL(U)).searchParams.set("authToken",e),[2,t.toString()]}})}),[U,n]),H=(0,w.ZP)(F?W:U,{shouldReconnect:function(){return P<10},reconnectInterval:function(e){var t=Math.min(1e3*Math.pow(2,Math.max(e,P)),1e4);return t+Math.floor(t/2*Math.random())},reconnectAttempts:10,onClose:function(){X((0,C.Z)()),B(!1)},onReconnectStop:function(){var e=(0,C.Z)();e.resolve(!1),X(e)},onOpen:(0,o._)(function(){return(0,u.Jh)(this,function(e){switch(e.label){case 0:if(F)return J?K():$(),B(!0),M.resolve(!0),[2];return[4,Y()];case 1:return V({authRequest:{authToken:e.sent()}},!1),[2]}})}),onError:function(e){P>=10&&(0,E.o)("Ghostwriter Chat websocket error",{endpoint:U,event:e})},onMessage:function(e){var t=D(e);t.authResponse?Q(t):t.sessionCreationResponse?ee(t):t.usageQuota?er(t):t.chatReplSessions?en(t.chatReplSessions):t.invalidMessage&&(0,E.o)("Invalid request",{endpoint:U,replId:n,currentUserId:f,detail:t.invalidMessage.error})}},!t&&null!==f),V=H.sendJsonMessage,z=H.readyState,j=H.getWebSocket,q=z===w.kQ.OPEN&&G;(0,Z.useEffect)(function(){if(q){var e,t=j();if(t){var n=function(){},r=!1;return(e=(0,o._)(function(){var e;return(0,u.Jh)(this,function(i){switch(i.label){case 0:if(!(!r&&t.readyState===w.kQ.OPEN))return[3,3];return[4,new Promise(function(e){var r=function(t){D(t).pong&&(n(),e({success:!0}))},i=setTimeout(function(){n(),e({success:!1})},2e3);t.addEventListener("message",r),n=function(){t.removeEventListener("message",r),clearTimeout(i),n=function(){}},V({ping:{}},!1)})];case 1:if(e=i.sent().success,r)return[2];if(!e)return t.close(),[2];return[4,new Promise(function(e){return setTimeout(e,2e4)})];case 2:return i.sent(),[3,0];case 3:return[2]}})}),function(){return e.apply(this,arguments)})(),function(){r=!0,n()}}}},[j,V,q]);var Y=(0,Z.useCallback)((0,o._)(function(){return(0,u.Jh)(this,function(e){return[2,(0,S.I)(n)]})}),[n]),$=(0,Z.useCallback)((0,o._)(function(){return(0,u.Jh)(this,function(e){if(!f)throw(0,E.o)("Cannot create session without a user id",{endpoint:U,replId:n});return V({sessionCreationRequest:{userId:f,replId:n}}),[2,null]})}),[f,U,n,V]),J=(0,v.P5)({controlName:"flag-gigantic-events"}),K=(0,Z.useCallback)(function(){V({getReplSessionsRequest:{replId:n,includeFirstSessionEvents:!0,messagesLimit:1e3}})},[n,V]),Q=(0,Z.useCallback)(function(e){if(e.authResponse){if(e.authResponse.success)J?K():$(),B(!0),M.resolve(!0),N(0);else throw N(function(e){return e+1}),(0,E.o)("Authentication failed",{endpoint:U,replId:n,currentUserId:f,detail:e.authResponse.error})}},[$,f,U,n,N,J,K,M]),ee=(0,Z.useCallback)(function(e){if(e.sessionCreationResponse){if(e.sessionCreationResponse.sessionId)p(e.sessionCreationResponse.sessionId);else throw(0,E.o)("Session creation failed",{endpoint:U,replId:n,currentUserId:f,detail:e.sessionCreationResponse.error})}},[f,U,n,p]),et=(0,v.P5)({controlName:"flag-gigantic-events-display"}),en=(0,Z.useCallback)(function(e){if(!e.sessions.length){$();return}var t=function(e){var t=null,n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value;if(!t){t=l;continue}if(l.values.length){if(!t.values.length){t=l;continue}new Date(l.values[l.values.length-1].timeCreated)>new Date(t.values[t.values.length-1].timeCreated)&&(t=l)}}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return t}(e.sessions);if(t){et&&x((function(e){try{var t=[],n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value;if("this_message_was_retried"===l.parentEventId&&"Human"===l.role){if(t.length>1&&"Assistant"===t[t.length-1].role&&"Human"===t[t.length-2].role)t.pop(),t.pop();else throw Error("The last two messages do not have 'Assistant' and 'Human' roles.")}t.push(l)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return t}catch(t){return e}})((0,c._)(t.values).sort(I)).map(function(e){var t;return{id:e.id,text:e.content,attribution:"Human"===e.role?"Human":"Assistant",timeCreated:new Date(e.timeCreated),type:e.eventType,codeReference:e.codeReference,intent:null!==(t=e.intent)&&void 0!==t?t:"NONE"}})),p(t.sessionId);return}},[et,$,x,p]),er=(0,Z.useCallback)(function(e){var t=e.usageQuota;t&&O({basicModelUsage:t.basicModelUsage,basicModelLimit:t.basicModelLimit,basicModelTTLEnd:1e3*t.basicLimitRefreshTime+Date.now(),advancedModelUsage:t.advancedModelUsage,advancedModelLimit:t.advancedModelLimit,advancedModelTTLEnd:1e3*t.advancedLimitRefreshTime+Date.now()})},[O]),ei=(0,Z.useCallback)((e=(0,o._)(function(e){var t,r,i,o,l,c,h,p,m,v,g,y,b,Z,w,x,_,S,k,T,I,B,A;return(0,u.Jh)(this,function(P){switch(P.label){case 0:return t=e.body,r=e.options,i=t.sessionId,o=t.message,l=t.chatHistory,c=t.model,h=t.context,p=t.useAdvancedModel,m={chatRequest:{sessionId:i,replId:n,message:o,chatHistory:l,model:R(c),context:h,useAdvancedModel:p}},v=[],g=(0,C.Z)(),y=!1,b=0,Z="",w=null,x=new Promise(function(e,t){w=setTimeout(function(){t((0,E.o)("Authentication timed out while sending a message",{endpoint:U,replId:n,currentUserId:f,requestId:Z,finished:y,dispatched:b,isAuthed:G,timeout:6e4}))},6e4)}),[4,Promise.race([M.promise,x])];case 1:if(P.sent(),w&&clearTimeout(w),!(_=j()))throw(0,E.o)("Websocket is not ready to send messages",{endpoint:U,isAuthed:G,replId:n,currentUserId:f,sessionId:i});return S=function(){y=!0,_.removeEventListener("message",T),_.removeEventListener("close",k)},r.abortSignal.onabort=function(){if(!Z)throw(0,E.o)("Cannot abort request",{endpoint:U,replId:n,currentUserId:f});V({abortRequest:{requestId:Z}})},k=function(){if(!y){var e=(0,E.o)("Request did not finished - websocket closed",{endpoint:U,replId:n,currentUserId:f,dispatched:b});g.reject(e)}},T=function(e){e.data&&"string"==typeof e.data||g.reject((0,E.o)("Invalid Event - does not match Message Event",{event:e}));try{var t=D(e);if(t.invalidMessage&&!Z)throw Error("Invalid request: ".concat(t.invalidMessage));if(t.chatResponseStart&&!Z&&(Z=t.chatResponseStart.requestId),t.chatResponseChunk){var r=t.chatResponseChunk;if(r.requestId!==Z)return;v.push(r)}if(t.chatResponseEnd){var i,o=t.chatResponseEnd;if(o.requestId!==Z)return;o.success||g.reject(Error("Chat request failed: ".concat(null!==(i=o.error)&&void 0!==i?i:"Unknown error"))),S()}if(t.abortResponse){var a=t.abortResponse;if((null==a?void 0:a.requestId)!==Z)return;S()}g.resolve()}catch(e){d.$e(function(t){t.setExtra("requestId",Z),t.setExtra("finished",y),t.setExtra("dispatched",b),t.setExtra("userId",f),t.setExtra("replId",n),t.setTag("ghostwriter-chat",!0),d.Tb(e)}),g.reject(e)}},_.addEventListener("message",T),_.addEventListener("close",k),V(m),I=setTimeout(function(){var e=(0,E.o)("Message total timed out",{endpoint:U,replId:n,dispatched:b});g.reject(e)},12e4),A=(B=function(){return setTimeout(function(){var e=(0,E.o)("Message chunk timed out",{endpoint:U,replId:n,dispatched:b});g.reject(e)},2e4)})(),[2,(0,s._)(function(){return(0,u.Jh)(this,function(e){switch(e.label){case 0:e.trys.push([0,,8,9]),e.label=1;case 1:if(y)return[3,7];return[4,(0,a._)(g.promise)];case 2:e.sent(),A&&(clearTimeout(A),A=B()),g=(0,C.Z)(),e.label=3;case 3:if(!(b<v.length))return[3,6];return[4,v[b]];case 4:e.sent(),e.label=5;case 5:return b++,[3,3];case 6:return[3,1];case 7:return[3,9];case 8:return S(),clearTimeout(I),clearTimeout(A),[7];case 9:return[2]}})})()]}})}),function(t){return e.apply(this,arguments)}),[f,U,j,G,n,V,M]);return(0,Z.useCallback)(function(){return{sendMessage:function(e){var t=e.body,n=e.options;return(0,s._)(function(){var e;return(0,u.Jh)(this,function(o){switch(o.label){case 0:return[4,(0,a._)(ei({body:t,options:n}))];case 1:return e=o.sent(),[5,(0,u.XA)((0,r._)((0,i._)(e),a._))];case 2:return o.sent(),[2]}})})()},createNewSession:$}},[$,ei])}},10676:function(e,t,n){n.d(t,{$c:function(){return S},$h:function(){return _},BY:function(){return v},FF:function(){return x},FM:function(){return y},FW:function(){return w},G_:function(){return Z},MD:function(){return g},Ui:function(){return ec},ai:function(){return k},e6:function(){return H},he:function(){return b},i6:function(){return V},ju:function(){return ea},lZ:function(){return E},nn:function(){return ee},sh:function(){return Q},wc:function(){return C}});var r,i,o,a,l,c,s,u,d,f,h,p,m,v,g,y,b,Z,w,x,C,_,S,E,k,T,R=n(74044);(r=v||(v={}))[r.BASIC=0]="BASIC",r[r.ADVANCED=1]="ADVANCED",r[r.OVERRIDE=2]="OVERRIDE";var D=R.Dy.Enum(v);(i=g||(g={}))[i.CODE_REFERENCE_TYPE_UNKNOWN=0]="CODE_REFERENCE_TYPE_UNKNOWN",i[i.FILE=1]="FILE",i[i.INLINE=2]="INLINE";var I=R.Dy.Enum(g);(o=y||(y={}))[o.DEBUG_ERROR_SOURCE_UNKNOWN=0]="DEBUG_ERROR_SOURCE_UNKNOWN",o[o.CONSOLE=1]="CONSOLE",o[o.LSP=2]="LSP";var G=R.Dy.Enum(y);(a=b||(b={}))[a.EVENT_STATE_UNKNOWN=0]="EVENT_STATE_UNKNOWN",a[a.IN_PROGRESS=1]="IN_PROGRESS",a[a.COMPLETE=2]="COMPLETE";var B=R.Dy.Enum(b);(l=Z||(Z={}))[l.INLINE_MESSAGE_TYPE_UNKNOWN=0]="INLINE_MESSAGE_TYPE_UNKNOWN",l[l.EXPLAIN_CODE=1]="EXPLAIN_CODE",l[l.DEBUGGER=2]="DEBUGGER",l[l.GENERATE_CODE=3]="GENERATE_CODE",l[l.TRANSFORM_CODE=4]="TRANSFORM_CODE";var A=R.Dy.Enum(Z);(c=w||(w={}))[c.USER_TYPE_UNKNOWN=0]="USER_TYPE_UNKNOWN",c[c.USER=1]="USER",c[c.AI=2]="AI",c[c.SERVICE=3]="SERVICE";var P=R.Dy.Enum(w);(s=x||(x={}))[s.SESSION_TYPE_UNKNOWN=0]="SESSION_TYPE_UNKNOWN",s[s.CHAT=1]="CHAT",s[s.INLINE_CHAT=2]="INLINE_CHAT",s[s.SINGLE_USE_SESSION=3]="SINGLE_USE_SESSION";var N=R.Dy.Enum(x);(u=C||(C={}))[u.MESSAGE_STOP_REASON_UNKNOWN=0]="MESSAGE_STOP_REASON_UNKNOWN",u[u.MAX_TOKENS=1]="MAX_TOKENS",u[u.STOP_TOKEN=2]="STOP_TOKEN";var U=R.Dy.Enum(C);(d=_||(_={}))[d.MESSAGE_ACTION_UNKNOWN=0]="MESSAGE_ACTION_UNKNOWN",d[d.NONE=1]="NONE",d[d.REPLIT_DOCS=2]="REPLIT_DOCS",d[d.GENERATE=3]="GENERATE",d[d.EXPLAIN=4]="EXPLAIN",d[d.TRANSFORM=5]="TRANSFORM",d[d.DEBUG=6]="DEBUG",d[d.FIND_INTENT=7]="FIND_INTENT";var O=R.Dy.Enum(_);(f=S||(S={}))[f.MEMBERSHIP_TYPE_UNKNOWN=0]="MEMBERSHIP_TYPE_UNKNOWN",f[f.FREE=1]="FREE",f[f.CORE=2]="CORE";var L=R.Dy.Enum(S);(h=E||(E={}))[h.EVENT_ERROR_TYPE_UNKNOWN=0]="EVENT_ERROR_TYPE_UNKNOWN",h[h.MANUALLY_ABORTED=1]="MANUALLY_ABORTED",h[h.INCOMPLETE_UPDATE=2]="INCOMPLETE_UPDATE",h[h.INTERNAL_SERVER_ERROR=3]="INTERNAL_SERVER_ERROR",h[h.USAGE_LIMIT=4]="USAGE_LIMIT",h[h.TEST_ERROR=5]="TEST_ERROR";var M=R.Dy.Enum(E);(p=k||(k={}))[p.SET=0]="SET",p[p.ADD=1]="ADD",p[p.CLEAR=2]="CLEAR";var X=R.Dy.Enum(k);(m=T||(T={}))[m.UNKNOWN=0]="UNKNOWN",m[m.ENGLISH=1]="ENGLISH",m[m.CRON=2]="CRON";var F=R.Dy.Enum(T),W=R.Dy.Object({}),H=R.Dy.Object({indexFrom:R.Dy.Number(),indexTo:R.Dy.Number(),lineFrom:R.Dy.Number(),lineTo:R.Dy.Number()}),V=R.Dy.Object({code:R.Dy.String(),filePath:R.Dy.String(),fileVersion:R.Dy.Number(),fileContent:R.Dy.String(),range:H,language:R.Dy.String(),referenceType:I}),z=R.Dy.Object({identifier:R.Dy.String(),url:R.Dy.String(),mimeType:R.Dy.String()}),j=R.Dy.Object({content:R.Dy.String(),intent:O,stopReason:U,debugFullPrompt:R.Dy.String(),codeReference:V,debugErrorSource:G,media:R.Dy.Array(z)}),q=R.Dy.Object({messageType:A,debugErrorSource:G,content:R.Dy.String(),codeReference:V}),Y=R.Dy.Object({command:R.Dy.String(),result:R.Dy.String(),eventId:R.Dy.String(),index:R.Dy.Number(),exitCode:R.Dy.Number(),channelName:R.Dy.String()}),$=R.Dy.Object({contents:R.Dy.Union([R.Dy.Object({$kind:R.Dy.Literal("sessionCreationEventContents"),sessionCreationEventContents:W}),R.Dy.Object({$kind:R.Dy.Literal("messageEventContents"),messageEventContents:j}),R.Dy.Object({$kind:R.Dy.Literal("inlineActionEventContents"),inlineActionEventContents:q}),R.Dy.Object({$kind:R.Dy.Literal("localShellExecutionEventContents"),localShellExecutionEventContents:Y})])}),J=R.Dy.Object({}),K=R.Dy.Object({type:D,overrideModelName:R.Dy.String()}),Q=R.Dy.Object({mostRecentFile:R.Dy.String(),fileContext:R.Dy.Array(V),modelSelector:K}),ee=R.Dy.Object({mostRecentFile:R.Dy.String(),fileContext:R.Dy.Array(V),modelSelector:K}),et=R.Dy.Object({}),en=R.Dy.Object({metadata:R.Dy.Union([R.Dy.Object({$kind:R.Dy.Literal("sessionCreationEventContext"),sessionCreationEventContext:J}),R.Dy.Object({$kind:R.Dy.Literal("messageEventContext"),messageEventContext:Q}),R.Dy.Object({$kind:R.Dy.Literal("inlineActionEventContext"),inlineActionEventContext:ee}),R.Dy.Object({$kind:R.Dy.Literal("localShellExecutionEventContext"),localShellExecutionEventContext:et})])}),er=R.Dy.Object({type:P,id:R.Dy.String(),membership:L,roles:R.Dy.Array(R.Dy.String()),isTeam:R.Dy.Boolean()}),ei=R.Dy.Object({id:R.Dy.String(),operationType:X,key:R.Dy.String(),value:R.Dy.String()}),eo=R.Dy.Object({type:M,message:R.Dy.String()}),ea=R.Dy.Object({id:R.Dy.String(),parentEventId:R.Dy.String(),contents:$,context:en,state:B,created:R.Dy.Date(),updated:R.Dy.Date(),sender:er,sessionId:R.Dy.String(),updateEventOperations:R.Dy.Array(ei),error:eo}),el=R.Dy.Object({id:R.Dy.String(),title:R.Dy.String(),sessionType:N,replId:R.Dy.String(),events:R.Dy.Array(ea),sessionCreationEventId:R.Dy.String(),lastEventTime:R.Dy.Date(),created:R.Dy.Date(),updated:R.Dy.Date()});R.Dy.Object({user:er,replIds:R.Dy.Array(R.Dy.String())});var ec=R.Dy.Object({parentEventId:R.Dy.String(),sessionId:R.Dy.String(),state:B,contents:$,context:en,eventId:R.Dy.String(),error:eo});R.Dy.Object({eventId:R.Dy.String()}),R.Dy.Object({eventId:R.Dy.String(),operations:R.Dy.Array(ei),state:B,error:eo,requireCompletion:R.Dy.Optional(R.Dy.Boolean())}),R.Dy.Object({}),R.Dy.Object({eventId:R.Dy.String(),context:en}),R.Dy.Object({}),R.Dy.Object({mimeType:R.Dy.String(),replId:R.Dy.String(),sessionId:R.Dy.String()}),R.Dy.Object({uploadUrl:R.Dy.String(),downloadUrl:R.Dy.String(),identifier:R.Dy.String()}),R.Dy.Object({eventId:R.Dy.String()}),R.Dy.Object({eventId:R.Dy.String()}),R.Dy.Object({beforeTimestamp:R.Dy.Date(),limit:R.Dy.Number(),includeFirstSessionEvents:R.Dy.Boolean(),firstSessionEventsLimit:R.Dy.Number(),replId:R.Dy.String(),sessionTypes:R.Dy.Array(N)}),R.Dy.Object({hasMore:R.Dy.Boolean(),sessions:R.Dy.Array(el)}),R.Dy.Object({sessionId:R.Dy.String(),limit:R.Dy.Number()}),R.Dy.Object({events:R.Dy.Array(ea),session:el}),R.Dy.Object({replId:R.Dy.String(),sessionType:N,title:R.Dy.String()}),R.Dy.Object({sessionId:R.Dy.String(),sessionCreationEventId:R.Dy.String()}),R.Dy.Object({replId:R.Dy.String()});var es=R.Dy.Object({}),eu=R.Dy.Object({eventId:R.Dy.String(),parentEventId:R.Dy.String(),sessionId:R.Dy.String(),state:B,contents:$,sender:er,error:eo}),ed=R.Dy.Object({sessionId:R.Dy.String(),title:R.Dy.String(),replId:R.Dy.String(),sessionCreationEventId:R.Dy.String()}),ef=R.Dy.Object({sessionId:R.Dy.String(),eventId:R.Dy.String(),operations:R.Dy.Array(ei),state:B,error:eo}),eh=R.Dy.Object({sessionId:R.Dy.String(),title:R.Dy.String(),sessionType:N});R.Dy.Object({message:R.Dy.Union([R.Dy.Object({$kind:R.Dy.Literal("sender"),sender:er}),R.Dy.Object({$kind:R.Dy.Literal("subscriptionStatusMessage"),subscriptionStatusMessage:es}),R.Dy.Object({$kind:R.Dy.Literal("createEventMessage"),createEventMessage:eu}),R.Dy.Object({$kind:R.Dy.Literal("createSessionMessage"),createSessionMessage:ed}),R.Dy.Object({$kind:R.Dy.Literal("updateEventMessage"),updateEventMessage:ef}),R.Dy.Object({$kind:R.Dy.Literal("updateSessionMessage"),updateSessionMessage:eh})])});var ep=R.Dy.Object({limit:R.Dy.Number(),usage:R.Dy.Number(),resetTime:R.Dy.Date()}),em=R.Dy.Object({basicModelLimits:ep,advancedModelLimits:ep});R.Dy.Object({user:er}),R.Dy.Object({limits:em}),R.Dy.Object({id:R.Dy.String(),title:R.Dy.String(),sessionType:N}),R.Dy.Object({}),R.Dy.Object({replId:R.Dy.String(),contents:$,context:en});var ev=R.Dy.Object({rootId:R.Dy.String()});R.Dy.Object({message:R.Dy.Union([R.Dy.Object({$kind:R.Dy.Literal("startMessage"),startMessage:ev}),R.Dy.Object({$kind:R.Dy.Literal("createEventMessage"),createEventMessage:eu}),R.Dy.Object({$kind:R.Dy.Literal("updateEventMessage"),updateEventMessage:ef})])}),R.Dy.Object({inputTarget:F,outputTarget:F,content:R.Dy.String(),extraContext:R.Dy.String()}),R.Dy.Object({content:R.Dy.String()})},99708:function(e,t,n){n.d(t,{yz:function(){return u}});var r=n(41733),i=n(21262),o=n(71440),a=n(58995);function l(){var e=(0,i._)(["\n  query GhostwriterChatCurrentUserQuery {\n    currentUser {\n      username\n      id\n      image\n      isStaff: hasRole(role: REPLIT_STAFF)\n      isVerified\n      userSubscriptionType\n      userPowerUpsByType {\n        ... on UserPowerUpsTypes {\n          ghostwriter {\n            active\n          }\n        }\n      }\n    }\n  }\n"]);return l=function(){return e},e}var c={},s=(0,o.Ps)(l());function u(e){var t=(0,r._)({},c,e);return a.a(s,t)}},92815:function(e,t,n){n.d(t,{M:function(){return a},v:function(){return o}});var r=n(78094),i=(0,n(90234).cn)(!1),o=function(){return(0,r.$X)(i)},a=function(){return(0,r.c1)(i)}},82017:function(e,t,n){n.d(t,{b:function(){return s}});var r=n(85172),i=n(78228),o=n(50959),a=function(){var e=(0,i.c8)();return(0,o.useCallback)(function(){return e()},[e])},l=n(29217),c=n(78094);function s(){var e=a(),t=(0,l.e)(),n=(0,c.$X)(l.Rr),i=(0,r.v)().isTeamWithAiDisabled;(0,o.useEffect)(function(){n(i)},[n,i]),(0,o.useEffect)(function(){return t(e()),function(){t(null)}},[e,t])}},46868:function(e,t,n){n.d(t,{CN:function(){return o},CT:function(){return i},bO:function(){return a}});var r=n(27308),i="git",o={gitCommit:{id:"git.commit",name:"Git: Commit",scope:i,default:(0,r.l2)({cmdOrCtrl:!0,key:"Enter"})}},a=Object.values(o)},31171:function(e,t,n){n.d(t,{Ai:function(){return g},BI:function(){return u},Jp:function(){return d},_H:function(){return f},_Z:function(){return v},bA:function(){return m},ox:function(){return y}});var r=n(41733),i=n(30509),o=n(50199),a=n(71999),l=n(90234),c=n(50959),s=n(59173),u=(0,s.u)(function(){return null}),d=(0,s.u)(function(){return null});function f(e){var t=d.current();(0,c.useEffect)(function(){e!==t&&d.set(function(){return e})},[e,t])}var h=(0,l.cn)(null),p=(0,l.cn)(null,function(e,t,n){var o,a,l=e(h),c=l?(0,r._)({},l,n):(0,r._)({},n),s=null==c?void 0:c.changes,d=null==c?void 0:c.filePath;if(!d||!s)throw Error('"filePath", "changes", "users" required when initializing history state');var f=(a=(o=(0,i._)((0,r._)({},c),{changes:s,filePath:d})).changes.length,(0,r._)({users:{},count:a,version:Math.max(0,a-1),playing:!1,comparing:!1},o));u.set(function(){return f});var p=f.changes.length;if(0===p){t(h,f);return}(null==l?void 0:l.changes)&&f.changes!==l.changes&&(f.count=p,f.version=Math.min(f.version,p-1),f.playing=!1,f.comparing=!1),f.version===p-1&&(f.playing=!1),t(h,f)});function m(){return(0,a.Dv)(h,{store:b()})}function v(){return(0,a.b9)(p,{store:b()})}function g(){return(0,a.b9)((0,o.Z)(function(){return(0,l.cn)(null,function(e,t){t(h,null)})},[]),{store:b()})}var y=(0,c.createContext)(null);function b(){var e=(0,c.useContext)(y);if(!e)throw Error("Expected store in context");return e}},99418:function(e,t,n){n.d(t,{j:function(){return s},p:function(){return u}});var r=n(41733),i=n(59868),o=n(63009),a=n(50959),l=n(67795),c=n(31171);function s(){var e=(0,o.uV)();return(0,a.useCallback)(function(t,n,i){e({origin:"History2: useHistoryBSOD",error:t,tags:{source:"ws-history2",type:n},extras:(0,r._)({state:c.BI.current()},i)})},[e])}function u(e){(0,i.j)(l.U3.HISTORY_USED,{action:e,which:"ws"})}},92854:function(e,t,n){var r=n(74985),i=n(1498),o=n(49344),a=n(74833),l=n(56596),c=n(93918),s=n(39233),u=n(29287),d=n(47611),f=(0,c.X)({root:[u.l0.colWithGap(32)],header:[u.l0.rowWithGap(16),u.l0.align.center],icon:[u.l0.color.orangeStrongest],body:[u.l0.pr(32),u.l0.colWithGap(16)],list:[u.l0.colWithGap(16),u.l0.pl(16)],buttons:[u.l0.rowWithGap(16),u.l0.justify.end]});t.Z=function(e){var t=e.isOpen,n=(0,d.useRouter)();return(0,r.tZ)(o.u,{preventClose:!0,isOpen:t,centered:!0,onRequestClose:function(){},maxWidth:600,children:(0,r.BX)(l.G,{css:f.root,children:[(0,r.BX)(l.G,{css:f.header,children:[(0,r.tZ)(s.Z,{size:24,css:f.icon}),(0,r.tZ)(a.h4,{css:[{width:"fit-content"}],level:2,variant:"headerDefault",children:"You cant join this Repl from Firewall Mode."})]}),(0,r.BX)(l.G,{css:f.body,children:[(0,r.tZ)(a.xv,{children:"This Repl was started by someone not in Firewall Mode. If you would like to join, please do one of the following:"}),(0,r.BX)(l.G,{css:f.list,children:[(0,r.tZ)(a.xv,{multiline:!1,children:" Exit Firewall Mode."}),(0,r.tZ)(a.xv,{multiline:!1,children:" Ask the creator to open this Repl in Firewall Mode."})]})]}),(0,r.BX)(l.G,{css:f.buttons,children:[(0,r.tZ)(i.zx,{text:"Exit Firewall Mode",onClick:function(){window.location.href="https://www.replit.com".concat(n.asPath)}}),(0,r.tZ)(i.zx,{text:"Leave",onClick:function(){n.push("/home","~/")}})]})]})})}},94655:function(e,t,n){n.d(t,{h:function(){return E},w:function(){return _}});var r=n(41733),i=n(30509),o=n(74985),a=n(50199),l=n(95571),c=n(18836),s=n(50959),u=n(64461),d=n(90234),f=n(66626),h=n(71999);function p(){return(0,f._)((0,s.useState)(function(){return(0,d.MT)()}),1)[0]}var m=(0,s.createContext)(null),v=function(e){return(0,h.b9)(e,{store:function(){var e=(0,s.useContext)(m);if(!e)throw Error("Expected store in context");return e}()})},g=(0,d.cn)(-1),y=(0,d.cn)([]),b=(0,d.cn)(void 0),Z=(0,d.cn)(null,function(e,t,n){var r=e(b);switch(r&&(clearTimeout(r.id),r.cb()),n){case"forward":t(g,function(t){return Math.min(e(y).length,t+1)});break;case"backward":t(g,function(e){return Math.max(0,e-1)})}var i=e(y),o=e(g);return o>=i.length?"":i[o]}),w=(0,d.cn)(null,function(e,t,n){clearTimeout(null===(r=e(b))||void 0===r?void 0:r.id);var r,i=function(){if(n.length>0){var r=!1;t(y,function(t){return(0,u.Uy)(t,function(t){if(n!==t[e(g)])for(r=!0,t.push(n);t.length>20;)t.shift()})}),r&&t(g,e(y).length-1)}t(b,void 0)};t(b,{id:setTimeout(i,2e3),cb:i})});function x(e){var t,n=v(w),o=(t=v(Z),{forward:(0,a.Z)(function(){return function(){return t("forward")}},[t]),backward:(0,a.Z)(function(){return function(){return t("backward")}},[t])}),c=o.forward,u=o.backward,d=(0,s.useRef)(e.value);return(0,s.useEffect)(function(){e.value!==(null==d?void 0:d.current)&&(e.value&&n(e.value),d.current=e.value)},[n,e.value]),(0,i._)((0,r._)({},e),{onKeyDown:(0,a.Z)(function(){return function(t){if(t.shiftKey||(0,l.jh)(t)){null===(r=e.onKeyDown)||void 0===r||r.call(e,t);return}var n,r,i=t.currentTarget,o=!!i.value.match(/\n/);if("ArrowUp"===t.key){if(o&&i.selectionStart&&i.selectionStart>0)return;e.onChange(u()),t.preventDefault(),t.stopPropagation();return}if("ArrowDown"===t.key){if(o&&i.selectionEnd&&i.selectionEnd<i.value.length)return;e.onChange(c()),t.preventDefault(),t.stopPropagation();return}null===(n=e.onKeyDown)||void 0===n||n.call(e,t)}},[u,c,e]),onChange:(0,a.Z)(function(){return function(t){e.onChange(t.target.value)}},[e])})}var C=s.forwardRef(function(e,t){var n=x(e);return(0,o.tZ)(c.B,(0,r._)({ref:t},n))}),_=s.forwardRef(function(e,t){var n=p();return(0,o.tZ)(m.Provider,{value:n,children:(0,o.tZ)(C,(0,r._)({ref:t},e))})}),S=s.forwardRef(function(e,t){var n=x(e);return(0,o.tZ)(c.II,(0,r._)({ref:t},e,n))}),E=s.forwardRef(function(e,t){var n=p();return(0,o.tZ)(m.Provider,{value:n,children:(0,o.tZ)(S,(0,r._)({ref:t},e))})})},80499:function(e,t,n){n.d(t,{m:function(){return p}});var r=n(74985),i=n(43312),o=n(30983),a=n(56596),l=n(59811),c=n(88546),s=n(4901),u=n(29287),d=n(73858),f=(0,i.F4)("0%,100%{opacity:1;}50%{opacity:0.25;}"),h={root:(0,i.iv)([u.l0.height(20),u.l0.width(20),u.l0.center]),pulse:(0,i.iv)({animation:"".concat(f," 2s infinite")})};function p(){var e=(0,d.Z)(),t=e.isSaving;return e.isOffline?(0,r.tZ)(o.u,{tooltip:"Reconnecting, changes will be synced when youre online",placement:"right",children:(0,r.tZ)(a.G,{css:h.root,children:(0,r.tZ)(s.Z,{size:16,color:u.TV.redDefault})})}):t?(0,r.tZ)(o.u,{tooltip:"Saving",placement:"right",children:(0,r.tZ)(a.G,{css:[h.root,h.pulse],children:(0,r.tZ)(l.Z,{size:16,color:u.TV.foregroundDimmest})})}):(0,r.tZ)(o.u,{tooltip:"Saved",placement:"right",children:(0,r.tZ)(a.G,{css:h.root,children:(0,r.tZ)(c.Z,{size:16,color:u.TV.foregroundDimmest})})})}},72903:function(e,t,n){n.d(t,{BM:function(){return W},Dq:function(){return H},GZ:function(){return V},Wz:function(){return q},Zp:function(){return i},_g:function(){return K},aP:function(){return J},mH:function(){return F},rl:function(){return j}});var r,i,o=n(66626),a=n(74985),l=n(55534),c=n(16643),s=n(50782),u=n(1498),d=n(68514),f=n(15146),h=n(18836),p=n(93496),m=n(20399),v=n(37951),g=n(74833),y=n(30983),b=n(56596),Z=n(93918),w=n(12874),x=n(58719),C=n(44620),_=n(96239),S=n(13900),E=n(99656),k=n(52682),T=n(20573),R=n(29287),D=n(35375),I=n(54916),G=n(52489),B=n(51533),A=n(66985),P=n(33988),N=n.n(P),U=n(50959),O=n(1854),L=(0,Z.X)({self:[R.l0.p(12),R.l0.colWithGap(16)],devUrl:[R.l0.rowWithGap(4),R.l0.align.center],url:[R.l0.color.accentPositiveStronger,R.l0.fontSize("small"),R.l0.focusRing,{"&:hover":[R.l0.cursor.pointer,R.l0.color.accentPositiveStrongest]}],section:[R.l0.colWithGap(4)],openPort:[R.l0.color.accentPositiveStronger],localPortIcon:[R.l0.color.foregroundDefault,R.l0.px(4),{flex:"0 0 auto",marginLeft:"auto",marginRight:"auto !important"}],internalMessage:[R.l0.flex.shrink(1),{marginLeft:"auto",span:R.l0.color.foregroundDimmest}],portStatus:[R.l0.py(0),R.l0.px(4)],newPort:[R.l0.color.foregroundDefault,R.l0.rowWithGap(4),R.l0.align.center,R.l0.my(1),R.l0.borderRadius(16),R.l0.height(20)],externalPortButton:[{"&":[R.l0.height(20),R.l0.borderRadius(16),R.l0.color.foregroundDefault]}],externalPortPopup:[{"&":[R.l0.height(20),R.l0.p(6),R.l0.borderRadius(16),R.l0.color.foregroundDefault],"& > span":[R.l0.fontSize(12)],"& > svg":[R.l0.mr(4)]}],textButton:[R.l0.cursor.pointer,R.l0.reset.button,R.l0.color.accentPrimaryStronger,R.l0.focusRing,R.l0.hover(R.l0.color.accentPrimaryStrongest),{lineHeight:1.2,":not([disabled])":{cursor:"pointer"}}],newPortInput:[R.l0.height(20),R.l0.my(1)],newPortClose:R.l0.mr(4),portActionItem:[R.l0.fontSize(R.TV.fontSizeDefault),R.l0.viewStyle,R.l0.height(32),R.l0.px(16),R.l0.py(8),R.l0.flex.row,R.l0.align.center,R.l0.color.foregroundDefault,R.l0.backgroundColor.backgroundDefault,p.gU.listItem,{":not([disabled])":{":hover":{backgroundColor:R.TV.backgroundHigher}}}]});function M(e){var t,n,r,i=e.localPort,o=e.externalPort,l=e.isLocalhost,s=e.onPortChange,d=(0,I.Z)().ports.updateDotReplitPortsMapping,f=(t=(0,I.Z)().ports,n=(0,c.Z)(t.portsState),r=new Set(null==n?void 0:n.map(function(e){var t;return null!==(t=(0,D.OD)(e.configuration))&&void 0!==t&&t}).filter(Boolean)),Array.from(D.UK).sort(function(e,t){return e-t}).map(function(e){return{isAvailable:!r.has(e),externalPort:e}}));return(0,a.tZ)(b.G,{css:R.l0.flex.row,children:void 0!==o&&0!==o?(0,a.tZ)(u.zx,{css:L.externalPortButton,iconRight:(0,a.tZ)(x.Z,{}),text:":".concat(o),size:"small",onClick:function(){i&&(d(i,void 0,l),null==s||s())}}):(0,a.tZ)(m.ZE,{cssProps:[L.externalPortPopup],label:"Set external port",onAction:function(e){if(i){var t=f.find(function(t){return String(t.externalPort)===e});t&&t.isAvailable&&(d(i,t.externalPort,l),null==s||s())}},children:f.map(function(e){var t=e.isAvailable,n=e.externalPort;return(0,a.tZ)(m.ck,{"aria-label":String(n),children:(0,a.BX)(b.G,{css:t?R.l0.color.foregroundDefault:R.l0.color.foregroundDimmest,children:[":",n]})},String(n))})})})}function X(e){var t=e.portState,n=null;switch(t.configuration.type){case D.DL.MISCONFIGURED:n=(0,a.tZ)(y.u,{tooltip:"Port misconfigured",delay:"default",children:(0,a.tZ)(T.Z,{})});break;case D.DL.CONFIG_MISSING:n=(0,a.tZ)(y.u,{tooltip:"Configuration missing",delay:"default",children:(0,a.tZ)(T.Z,{})});break;case D.DL.NO_MORE_EXTERNAL_PORTS_AVAILABLE:n=(0,a.tZ)(T.Z,{});break;case D.DL.FORWARDED:n=(0,a.tZ)(w.Z,{});case D.DL.INTERNAL_ONLY:}return(0,a.tZ)("span",{css:L.localPortIcon,children:n})}var F=105;function W(e){var t=e.portState,n=e.width;return(0,a.BX)(O.sg,{width:n||F,children:[(0,a.BX)(g.xv,{css:t.isOpen?L.openPort:{},children:[":",t.configuration.localPort]}),(0,a.tZ)(X,{portState:t})]})}var H=160;function V(e){var t=e.portState,n=e.openWebview,r=e.width;return t.configuration.type===D.DL.NO_MORE_EXTERNAL_PORTS_AVAILABLE?(0,a.tZ)(O.sg,{width:r||H,children:(0,a.tZ)(v.E,{css:L.portStatus,icon:(0,a.tZ)(T.Z,{}),text:"No ports available"})}):(0,a.BX)(O.sg,{width:r||H,children:[(0,a.tZ)(M,{localPort:t.configuration.localPort,externalPort:(0,D.OD)(t.configuration),isLocalhost:(0,D.VZ)(t.configuration)}),n?(0,a.tZ)(f.hU,{alt:"Open in webview",onClick:n,css:[R.l0.color.foregroundDefault],children:(0,a.tZ)(_.Z,{})}):null]})}function z(e){var t,n=e.portState;return n.isOpen?(0,a.BX)(a.HY,{children:[(0,a.tZ)(O.sg,{width:100,children:(t=n.processInfo.cmdline[0].split("/"))[t.length-1]}),(0,a.tZ)(O.sg,{width:100,children:n.processInfo.pid})]}):(0,a.tZ)(O.sg,{width:100})}(r=i||(i={})).OPEN_WEBVIEW="OPEN_WEBVIEW",r.EXTERNAL_LINK="EXTERNAL_LINK",r.REMOVE="REMOVE";var j=26;function q(e){var t=e.portState,n=e.onAction,r=e.allowedActions,i=void 0===r?["OPEN_WEBVIEW","EXTERNAL_LINK","REMOVE"]:r,o=[];return i.includes("OPEN_WEBVIEW")&&o.push({label:"Open webview",key:"OPEN_WEBVIEW",icon:(0,a.tZ)(_.Z,{})}),i.includes("EXTERNAL_LINK")&&o.push({label:"Open external link",key:"EXTERNAL_LINK",icon:(0,a.tZ)(C.Z,{})}),i.includes("REMOVE")&&o.push({label:"Remove port config",key:"REMOVE",icon:(0,a.tZ)(k.Z,{})}),(0,a.tZ)(O.sg,{width:j,last:!0,children:(0,a.tZ)(m.ZE,{cssProps:[R.l0.height(22),R.l0.width(22),R.l0.color.foregroundDefault,{background:"transparent"}],menuCssProps:[{li:[R.l0.p(0)],"li > div":[R.l0.pl(6),R.l0.rowWithGap(4),R.l0.align.center]}],items:o,icon:(0,a.tZ)(S.Z,{}),onAction:function(e){switch(e){case"OPEN_WEBVIEW":case"EXTERNAL_LINK":case"REMOVE":n({type:e,payload:{portState:t}})}},children:o.map(function(e){return(0,a.tZ)(m.ck,{children:(0,a.BX)(b.G,{css:L.portActionItem,children:[e.icon?e.icon:(0,a.tZ)(b.G,{css:[R.l0.width(16)]}),(0,a.tZ)(g.xv,{multiline:!1,children:e.label})]})},e.key)})})})}function Y(e){var t=e.portState,n=e.portAction;return(0,a.BX)(O.X2,{children:[(0,a.tZ)(W,{portState:t}),(0,a.tZ)(V,{portState:t,openWebview:function(){n({type:"OPEN_WEBVIEW",payload:{portState:t}})}}),(0,a.tZ)(z,{portState:t}),(0,a.tZ)(q,{portState:t,onAction:n})]},t.configuration.localPort)}var $=function(e){var t=e.text,n=e.onClick;return(0,a.tZ)("button",{css:L.textButton,onClick:n,children:t})};function J(e){var t,n=e.openDotReplit,r=(0,o._)((0,U.useState)(!1),2),i=r[0],l=r[1],c=(0,o._)((0,U.useState)(),2),s=c[0],d=c[1],p=null===(t=(0,I.Z)().ports.portsState.current)||void 0===t?void 0:t.some(function(e){return e.configuration.localPort===s});return i?(0,a.BX)(O.X2,{children:[(0,a.BX)(O.sg,{width:F,children:[(0,a.tZ)(f.hU,{css:L.newPortClose,alt:"Close",onClick:function(){return l(!1)},size:18,children:(0,a.tZ)(x.Z,{})}),(0,a.tZ)(h.II,{css:L.newPortInput,value:(null==s?void 0:s.toString())||"",onChange:function(e){return d(e.target.value?parseInt(e.target.value,10):void 0)}})]}),(0,a.tZ)(O.sg,{children:p?(0,a.tZ)(v.E,{css:L.portStatus,colorway:"warning",text:"Local port already exists"}):(0,a.tZ)(M,{localPort:s,isLocalhost:!1,onPortChange:function(){return l(!1)}})})]}):(0,a.BX)(O.X2,{children:[(0,a.tZ)(O.sg,{width:F,children:(0,a.tZ)(u.zx,{css:L.newPort,iconLeft:(0,a.tZ)(E.Z,{size:12}),text:"New port",size:"small",onClick:function(){return l(!0)}})}),(0,a.tZ)(O.sg,{children:(0,a.BX)(g.xv,{variant:"small",children:["This port config is saved in the"," ",(0,a.tZ)($,{text:".replit file",onClick:n}),"."," "]})})]})}function K(e){var t,n=e.openDotReplit,r=e.openWebview,i=(0,s.Z)(),o=(0,B.J)(i),c=(0,l.Z)().showError,u=(0,I.Z)().ports,f=u.portsState,h=u.removeDotReplitPortsMapping,p=function(e){switch(e.type){case"OPEN_WEBVIEW":r(e.payload.portState.configuration.localPort);break;case"EXTERNAL_LINK":var t=(0,D.OD)(e.payload.portState.configuration);if(!(null==o?void 0:o.presentationUrl)){c("URL not available.");return}var n=(0,A.hw)(null==o?void 0:o.presentationUrl,t).toString();window.open(n,"_blank");break;case"REMOVE":h(e.payload.portState.configuration.localPort,(0,D.OD)(e.payload.portState.configuration))}};return(0,a.BX)(b.G,{css:L.self,children:[(null==o?void 0:o.presentationUrl)?(0,a.BX)(a.HY,{children:[(0,a.BX)(b.G,{css:L.section,children:[(0,a.tZ)(g.xv,{children:"Dev URL:"}),(0,a.BX)(b.G,{css:L.devUrl,children:[(0,a.tZ)(N(),{legacyBehavior:!0,href:o.presentationUrl,passHref:!0,children:(0,a.tZ)("a",{css:L.url,target:"_blank",children:o.presentationUrl})}),(0,a.tZ)(G.qi,{value:o.presentationUrl})]})]}),(0,a.tZ)(d.R,{})]}):null,(0,a.BX)(b.G,{css:L.section,children:[(0,a.tZ)(g.xv,{children:"Ports"}),(0,a.BX)(O.iA,{children:[(0,a.BX)(O.X2,{children:[(0,a.tZ)(O.sg,{header:!0,width:F,children:"Internal Port"}),(0,a.tZ)(O.sg,{header:!0,width:H,children:"External Port"}),(0,a.tZ)(O.sg,{header:!0,width:100,children:"Name"}),(0,a.tZ)(O.sg,{header:!0,width:100,children:"Pid"})]}),f.current&&(null===(t=f.current)||void 0===t?void 0:t.length)>0?f.current.map(function(e){return(0,a.tZ)(Y,{portState:e,portAction:p},e.configuration.localPort)}):null,(0,a.tZ)(J,{openDotReplit:n})]})]})]})}},1854:function(e,t,n){n.d(t,{X2:function(){return c},iA:function(){return u},sg:function(){return s}});var r=n(74985),i=n(56596),o=n(93918),a=n(29287);n(50959);var l=(0,o.X)({table:{},tableRow:[a.l0.rowWithGap(12),a.l0.align.center,a.l0.border({direction:"bottom"}),{"box-sizing":"border-box"}],wrapper:[a.l0.rowWithGap(0)],column:[a.l0.display.flex,a.l0.colWithGap(0),a.l0.justify.center,a.l0.border({direction:"right"}),{":last-child":{borderRight:0}}],header:[a.l0.colWithGap(0),a.l0.justify.center],cell:[a.l0.rowWithGap(0),a.l0.align.center,a.l0.color.foregroundDimmest,a.l0.justify.spaceBetween,a.l0.fontSize("small"),a.l0.px(4),a.l0.py(2)],responsiveWrapper:[],responsiveColumn:[]}),c=function(e){var t=e.children;return(0,r.tZ)("tr",{css:l.tableRow,children:(0,r.tZ)(i.G,{css:l.wrapper,children:t})})},s=function(e){var t=e.header,n=e.width,o=e.last,a=e.children,c={};return n&&(c.width=n),o&&(c.marginLeft="auto"),(0,r.tZ)("td",{css:void 0!==t&&t?l.header:l.column,style:c,children:(0,r.tZ)(i.G,{css:l.cell,children:a})})},u=function(e){var t=e.children;return(0,r.tZ)("table",{css:l.table,children:t})}},16278:function(e,t,n){n.d(t,{I:function(){return f}});var r=n(41733),i=n(30509),o=n(66626),a=n(25425),l=n(23896),c=n(66349),s=n(54916),u=n(50959),d={nodejs:["package.json","package-lock.json","yarn.lock","node_modules/"],python:["poetry.lock","pyproject.toml","requirements.txt",".venv/",".local"],ruby:["Gemfile","Gemfile.lock"],java:["pom.xml","target"]};function f(){var e=(0,c.Z)(),t=(0,l.T)(),n=(0,s.Z)(),f=(0,o._)((0,u.useState)(null),2),h=f[0],p=f[1],m=(0,a.P5)({controlName:"flag-system-dependencies-search-unstable"}),v=(0,a.P5)({controlName:"flag-system-dependencies-search-23_05"});return(0,u.useEffect)(function(){var e=n.dotReplit.watch(function(e){var t,n;null===e.error&&p(null!==(n=null===(t=e.config.nix)||void 0===t?void 0:t.channel)&&void 0!==n?n:null)});return function(){e()}},[n]),(0,u.useMemo)(function(){var n=(null==t?void 0:t.packagers)||[],o=(null==n?void 0:n.map(function(e){var t,n;return(0,i._)((0,r._)({},e),{title:e.language,packagerFiles:(null===(t=e.packagerFiles)||void 0===t?void 0:t.length)?e.packagerFiles:null!==(n=d[e.language])&&void 0!==n?n:[]})}))||[];((null==e?void 0:e.language)==="html"||(null==e?void 0:e.language)==="html_beta")&&o.push({id:"html",title:"html",name:"HTML Packager",language:"html",packageSearch:!0,guessImports:!1,packagerFiles:[]});var a="unstable"===h&&m||"stable-23_05"===h&&v;return o.push({id:"nix",title:"system",name:"System Dependencies",language:"nix",packageSearch:a,guessImports:!1,packagerFiles:["replit.nix"]}),o},[t,e,h,m,v])}},46801:function(e,t,n){n.d(t,{C:function(){return g}});var r,i,o,a=n(27387),l=n(42516),c=n(96583),s="index.html",u=/^\s*<script src="https:\/\/cdnjs\.cloudflare\.com\/ajax\/libs\/([^/]+)\/([^/]+)\/.+.js"><\/script>$/,d=(r={name:"html",getInstalledPackages:function(e){var t=e.services.fs;return(0,a._)(function(){return(0,c.Jh)(this,function(e){switch(e.label){case 0:return[4,t.stat(s)];case 1:var n;if(!e.sent().exists)return[2,[]];return[2,new Promise((n=(0,a._)(function(e){var n;return(0,c.Jh)(this,function(r){return n=t.watchTextFile(s,{onReady:function(t){var r=t.initialContent,i=[],o=!0,a=!1,l=void 0;try{for(var c,s=r.split("\n")[Symbol.iterator]();!(o=(c=s.next()).done);o=!0){var d=c.value.match(u);d&&i.push({name:d[1],version:d[2]})}}catch(e){a=!0,l=e}finally{try{o||null==s.return||s.return()}finally{if(a)throw l}}n(),e(i)},onError:function(){n(),e([])}}),[2]})}),function(e){return n.apply(this,arguments)}))]}})})()},getPackageInfo:function(e){var t=e.name;return(0,a._)(function(){var e,n;return(0,c.Jh)(this,function(r){switch(r.label){case 0:return[4,fetch("/data/cdnjs/info/".concat(encodeURIComponent(t)),{credentials:"same-origin",headers:{"Content-Type":"application/json",Accept:"application/json"}})];case 1:if(!(e=r.sent()).ok)return[2,void 0];r.label=2;case 2:return r.trys.push([2,4,,5]),[4,e.json()];case 3:if(n=r.sent())return[2,{name:n.name,version:n.version,description:n.description,homepageURL:n.link,sourceCodeURL:n.include}];return[3,5];case 4:return r.sent(),[2,void 0];case 5:return[2]}})})()},search:function(e){var t=e.query;return(0,a._)(function(){var e;return(0,c.Jh)(this,function(n){switch(n.label){case 0:return[4,fetch("/data/cdnjs/search/".concat(encodeURIComponent(t)),{credentials:"same-origin",headers:{"Content-Type":"application/json",Accept:"application/json"}})];case 1:if(!(e=n.sent()).ok)return[2,[]];return[4,e.json()];case 2:return[2,n.sent().map(function(e){return{name:e.name,version:e.version,description:e.description,homepageURL:e.link,sourceCodeURL:e.include}})]}})})()}},(0,l._)(r,"install",function(e){var t=e.pkgs,n=e.services.fs;return(0,a._)(function(){var e,r,i,o,l,u,d;return(0,c.Jh)(this,function(f){switch(f.label){case 0:return[4,n.stat(s)];case 1:if(!f.sent().exists)return[2];e=!0,r=!1,i=void 0,f.label=2;case 2:f.trys.push([2,7,8,9]),o=function(){var e;return(0,c.Jh)(this,function(t){switch(t.label){case 0:var r;return e=u.value,[4,new Promise((r=(0,a._)(function(t){var r;return(0,c.Jh)(this,function(i){return r=n.watchTextFile(s,{onReady:function(i){var o=i.initialContent,l=i.writeChange;return(0,a._)(function(){var i,a;return(0,c.Jh)(this,function(c){switch(c.label){case 0:i='<script src="'.concat(e.sourceCodeURL,'"></script>\n'),-1===(a=o.indexOf("<script"))&&(a=o.indexOf("</body>")),-1===a&&(a=o.length),l({from:a,insert:i}),c.label=1;case 1:return c.trys.push([1,3,4,5]),[4,n.flush()];case 2:case 3:return c.sent(),[3,5];case 4:return r(),t(),[7];case 5:return[2]}})})()},onError:function(){r(),t()}}),[2]})}),function(e){return r.apply(this,arguments)}))];case 1:return t.sent(),[2]}})},l=t[Symbol.iterator](),f.label=3;case 3:if(e=(u=l.next()).done)return[3,6];return[5,(0,c.XA)(o())];case 4:f.sent(),f.label=5;case 5:return e=!0,[3,3];case 6:return[3,9];case 7:return d=f.sent(),r=!0,i=d,[3,9];case 8:try{e||null==l.return||l.return()}finally{if(r)throw i}return[7];case 9:return[2]}})})()}),(0,l._)(r,"uninstall",function(e){var t=e.pkgs,n=e.services.fs;return(0,a._)(function(){var e,r,i,o,l,d,f;return(0,c.Jh)(this,function(h){switch(h.label){case 0:return[4,n.stat(s)];case 1:if(!h.sent().exists)return[2];e=!0,r=!1,i=void 0,h.label=2;case 2:h.trys.push([2,7,8,9]),o=function(){var e;return(0,c.Jh)(this,function(t){switch(t.label){case 0:var r;return e=d.value,[4,new Promise((r=(0,a._)(function(t){var r;return(0,c.Jh)(this,function(i){return r=n.watchTextFile(s,{onReady:function(i){var o=i.initialContent,l=i.writeChange;return(0,a._)(function(){var i,a,s,d,f,h,p,m,v;return(0,c.Jh)(this,function(c){switch(c.label){case 0:i=0,a=!0,s=!1,d=void 0;try{for(f=o.split("\n")[Symbol.iterator]();!(a=(h=f.next()).done);a=!0)(m=(p=h.value).match(u))&&(v=m[1],e.name===v&&l({from:i,to:i+p.length+1})),i+=p.length+1}catch(e){s=!0,d=e}finally{try{a||null==f.return||f.return()}finally{if(s)throw d}}c.label=1;case 1:return c.trys.push([1,3,4,5]),[4,n.flush()];case 2:case 3:return c.sent(),[3,5];case 4:return r(),t(),[7];case 5:return[2]}})})()},onError:function(){r(),t()}}),[2]})}),function(e){return r.apply(this,arguments)}))];case 1:return t.sent(),[2]}})},l=t[Symbol.iterator](),h.label=3;case 3:if(e=(d=l.next()).done)return[3,6];return[5,(0,c.XA)(o())];case 4:h.sent(),h.label=5;case 5:return e=!0,[3,3];case 6:return[3,9];case 7:return f=h.sent(),r=!0,i=f,[3,9];case 8:try{e||null==l.return||l.return()}finally{if(r)throw i}return[7];case 9:return[2]}})})()}),r),f=(i={name:"upm",getInstalledPackages:function(e){var t=e.id,n=e.services.packager;return(0,a._)(function(){var e;return(0,c.Jh)(this,function(r){switch(r.label){case 0:return[4,n.listSpecfile(t)];case 1:if((e=r.sent()).error||null===e.packages)return[2,[]];return[2,e.packages]}})})()}},(0,l._)(i,"getPackageInfo",function(e){var t=e.id,n=e.name,r=e.services.packager;return(0,a._)(function(){return(0,c.Jh)(this,function(e){return[2,r.fetchPackageInfo(n,t)]})})()}),(0,l._)(i,"search",function(e){var t=e.id,n=e.query,r=e.services.packager;return(0,a._)(function(){return(0,c.Jh)(this,function(e){return[2,r.searchPackages(n,t)]})})()}),(0,l._)(i,"install",function(e){var t=e.id,n=e.pkgs,r=e.services.packager;return(0,a._)(function(){return(0,c.Jh)(this,function(e){switch(e.label){case 0:return[4,r.addPackages(n,t)];case 1:if(!e.sent())throw Error("Package install failed");return[2]}})})()}),(0,l._)(i,"uninstall",function(e){var t=e.id,n=e.pkgs,r=e.services.packager;return(0,a._)(function(){var e;return(0,c.Jh)(this,function(i){switch(i.label){case 0:return e=n.filter(function(e){return e.name}).map(function(e){return e.name}),[4,r.removePackages(e,t)];case 1:if(!i.sent())throw Error("Package uninstall failed");return[2]}})})()}),i),h=n(21262),p=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.map(function(e,t){var r;return e+(null!==(r=n[t])&&void 0!==r?r:"")}).join("")};function m(){var e=(0,h._)(["\n        let\n          pkgs = import <nixpkgs> {};\n          pkg = pkgs."," or {};\n          meta = pkg.meta or {};\n        in {\n          name = pkg.pname or pkg.name or null;\n          version = pkg.version or null;\n          license = meta.license or null;\n          description = meta.description or null;\n          homepage = meta.homepage or null;\n         }\n     "]);return m=function(){return e},e}var v=(o={name:"nix",getInstalledPackages:function(e){var t=e.services.nixService;return(0,a._)(function(){var e;return(0,c.Jh)(this,function(n){switch(n.label){case 0:return[4,t.listPackages()];case 1:if(null!==(e=n.sent()).error)return[2,[]];return[2,e.packages.filter(function(e){return!!e.name}).map(function(e){return{name:e.name,version:e.version}})]}})})()}},(0,l._)(o,"getPackageInfo",function(e){var t=e.name,n=e.services.container;return(0,a._)(function(){var e,r,i,o,a,l,s,u,d,f;return(0,c.Jh)(this,function(c){switch(c.label){case 0:return e=t.replace(/^pkgs\./,""),[4,n.exec("nix-instantiate","--strict","--json","--eval","--expr",p(m(),e))];case 1:if(null!==(r=c.sent()).error)return[2,{name:t}];return a=null!==(o=(i=JSON.parse(r.output)).license)&&void 0!==o?o:void 0,void 0!==i.license&&"string"!=typeof i.license&&(a=null===(l=i.license)||void 0===l?void 0:l.fullName),[2,{name:t,prettyName:null!==(s=i.name)&&void 0!==s?s:void 0,version:null!==(u=i.version)&&void 0!==u?u:void 0,license:a,description:null!==(d=i.description)&&void 0!==d?d:void 0,homepageURL:null!==(f=i.homepage)&&void 0!==f?f:void 0}]}})})()}),(0,l._)(o,"search",function(e){var t=e.query,n=e.services.nixService;return(0,a._)(function(){var e;return(0,c.Jh)(this,function(r){switch(r.label){case 0:return[4,n.searchPackages(t)];case 1:if(null!==(e=r.sent()).error)throw Error("Could not search Nix packages");return[2,e.packages.map(function(e){return{name:"pkgs.".concat(e.name),version:e.version}})]}})})()}),(0,l._)(o,"install",function(e){var t=e.pkgs,n=e.services.nixService;return(0,a._)(function(){var e;return(0,c.Jh)(this,function(r){switch(r.label){case 0:return e=t.map(function(e){return e.name}).filter(function(e){return null!=e}),[4,n.addPackages(e)];case 1:return r.sent(),[2]}})})()}),(0,l._)(o,"uninstall",function(e){var t=e.pkgs,n=e.services.nixService;return(0,a._)(function(){var e;return(0,c.Jh)(this,function(r){switch(r.label){case 0:return e=t.map(function(e){return e.name}).filter(function(e){return null!=e}),[4,n.removePackages(e)];case 1:return r.sent(),[2]}})})()}),o);function g(e){switch(e){case"html":return d;case"nix":return v;default:return f}}},71071:function(e,t,n){n.d(t,{Z:function(){return v}});var r=n(27387),i=n(96583),o=n(74985),a=n(55534),l=n(59868),c=n(54916),s=n(86763),u=n.n(s),d=n(50959),f=n(16278),h=n(46801),p=n(59072);function m(){var e=(0,c.Z)(),t=(0,p.Hg)(p.NC),n=(0,p.Hg)(p.w$),o=(0,p.XD)(p.w$),s=(0,p.$X)(p.w$),m=(0,p.Hg)(p.vO),v=(0,p.Mi)(),g=(0,p.Zq)(),y=(0,p.OO)(),b=(0,p.np)(),Z=(0,a.Z)(),w=(0,f.I)(),x=(0,p.T9)();return(0,d.useEffect)(function(){if(0!==w.length){var t=[],n=!1,r=!0,i=!1,a=void 0;try{for(var l,c=w[Symbol.iterator]();!(r=(l=c.next()).done);r=!0)!function(){var r=l.value,i=Promise.resolve(),a=g(r.id),c=u()(function(){var t=g(r.id),a=o();if(t===p.C0.Idle||(null==a?void 0:a.id)!==r.id){var l=(0,h.C)(r.id);i=i.then(function(){if(!n)return l.getInstalledPackages({id:r.id,services:e}).then(function(e){n||(y(r.id,e),v(r.id,p.C0.Idle))})})}},500);if(r.packagerFiles.length>0){var s=!0,d=!1,f=void 0;try{for(var m,b=r.packagerFiles[Symbol.iterator]();!(s=(m=b.next()).done);s=!0)!function(){var n=m.value;if(!n.endsWith("/")){var r=null!==a&&a!==p.C0.Initializing&&a!==p.C0.Uninitialized,i=e.fs.watchFilePath(n,{onChange:function(){if(!r){r=!0;return}c()}});t.push(i)}}()}catch(e){d=!0,f=e}finally{try{s||null==b.return||b.return()}finally{if(d)throw f}}}}()}catch(e){i=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return function(){n=!0;var e=!0,r=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(e=(o=a.next()).done);e=!0)(0,o.value)()}catch(e){r=!0,i=e}finally{try{e||null==a.return||a.return()}finally{if(r)throw i}}}}},[w,e.fs]),(0,d.useEffect)(function(){var t,n=!1;return(t=(0,r._)(function(){var t,r,o,a,l,c;return(0,i.Jh)(this,function(i){t=!0,r=!1,o=void 0;try{for(a=function(){var t=c.value,r=g(t.id);if(r&&r!==p.C0.Uninitialized&&r!==p.C0.Initializing)return"continue";v(t.id,p.C0.Initializing),(0,h.C)(t.id).getInstalledPackages({id:t.id,services:e}).then(function(e){n||(y(t.id,e),v(t.id,p.C0.Idle))})},l=w[Symbol.iterator]();!(t=(c=l.next()).done);t=!0)a()}catch(e){r=!0,o=e}finally{try{t||null==l.return||l.return()}finally{if(r)throw o}}return[2]})}),function(){return t.apply(this,arguments)})(),function(){n=!0}},[w]),(0,d.useEffect)(function(){if(null===n&&0!==t.length){var e=t[0];g(e.id)===p.C0.Idle&&b(e)}},[m,n,t]),(0,d.useEffect)(function(){if(null!==n){var t,o=!1;return(t=(0,r._)(function(){var t,r,a,c,u,d,f,m,g,b,w,C,_,S,E,k,T,R;return(0,i.Jh)(this,function(i){switch(i.label){case 0:switch(t=(0,h.C)(n.id),n.kind){case p.TH.Install:return[3,1];case p.TH.Uninstall:return[3,6]}return[3,11];case 1:v(n.id,p.C0.Installing),r=!0,a=!1,c=void 0;try{for(u=n.pkgs[Symbol.iterator]();!(r=(d=u.next()).done);r=!0)f=d.value,(0,l.j)(l.U3.PACKAGE_MANAGER_USED,{action:"installed",packageId:f.name})}catch(e){a=!0,c=e}finally{try{r||null==u.return||u.return()}finally{if(a)throw c}}i.label=2;case 2:return i.trys.push([2,4,,5]),[4,t.install({id:n.id,pkgs:n.pkgs,services:e})];case 3:return i.sent(),1===n.pkgs.length?Z.showNotice("Installed ".concat(null!==(m=n.pkgs[0].name)&&void 0!==m?m:"package")):Z.showNotice("Installed ".concat(n.pkgs.length," packages")),[3,5];case 4:return i.sent(),1===n.pkgs.length?Z.showError("Failed to install ".concat(null!==(g=n.pkgs[0].name)&&void 0!==g?g:"package")):Z.showError("Failed to install ".concat(n.pkgs.length," packages")),x(n.id,n.pkgs),[3,5];case 5:return[3,11];case 6:v(n.id,p.C0.Uninstalling),b=!0,w=!1,C=void 0;try{for(_=n.pkgs[Symbol.iterator]();!(b=(S=_.next()).done);b=!0)E=S.value,(0,l.j)(l.U3.PACKAGE_MANAGER_USED,{action:"removed",packageId:E.name})}catch(e){w=!0,C=e}finally{try{b||null==_.return||_.return()}finally{if(w)throw C}}i.label=7;case 7:return i.trys.push([7,9,,10]),[4,t.uninstall({id:n.id,pkgs:n.pkgs,services:e})];case 8:return i.sent(),1===n.pkgs.length?Z.showNotice("Removed ".concat(null!==(k=n.pkgs[0].name)&&void 0!==k?k:"package")):Z.showNotice("Removed ".concat(n.pkgs.length," packages")),[3,10];case 9:return i.sent(),1===n.pkgs.length?Z.showError("Failed to remove ".concat(null!==(T=n.pkgs[0].name)&&void 0!==T?T:"package")):Z.showError("Failed to remove ".concat(n.pkgs.length," packages")),x(n.id,n.pkgs),[3,10];case 10:return[3,11];case 11:if(o)return[2];return[4,t.getInstalledPackages({id:n.id,services:e})];case 12:if(R=i.sent(),o)return[2];return y(n.id,R),v(n.id,p.C0.Idle),s(null),[2]}})}),function(){return t.apply(this,arguments)})(),function(){o=!0}}},[n]),null}function v(e){var t=e.children,n=(0,p.ns)();return(0,o.BX)(p.vN.Provider,{value:n,children:[(0,o.tZ)(m,{}),t]})}},59072:function(e,t,n){n.d(t,{$X:function(){return Z},$z:function(){return T},B2:function(){return G},C0:function(){return o},Hg:function(){return x},Mi:function(){return D},NC:function(){return B},OO:function(){return U},T9:function(){return S},TH:function(){return a},Wx:function(){return X},XD:function(){return w},Zq:function(){return R},cW:function(){return A},jh:function(){return L},np:function(){return W},ns:function(){return g},pN:function(){return _},te:function(){return N},vN:function(){return y},vO:function(){return k},w$:function(){return I},wY:function(){return E},zi:function(){return V}});var r,i,o,a,l=n(42516),c=n(41733),s=n(30509),u=n(66626),d=n(78950),f=n(64461),h=n(90234),p=n(71999),m=n(28999),v=n(50959);function g(){return(0,u._)((0,v.useState)(function(){return(0,h.MT)()}),1)[0]}(0,h.cn)({replId:"",packageManagers:{}}),(r=o||(o={})).Uninitialized="Uninitialized",r.Initializing="Initializing",r.Installing="Installing",r.Uninstalling="Uninstalling",r.Idle="Idle",(i=a||(a={})).Install="Install",i.Uninstall="Uninstall";var y=(0,v.createContext)(null);function b(){var e=(0,v.useContext)(y);if(!e)throw Error("Expected store in context");return e}var Z=function(e){return(0,p.b9)(e,{store:b()})};function w(e){return(0,m.lV)((0,v.useCallback)(function(t){return t(e)},[e]),{store:b()})}function x(e){return(0,p.Dv)(e,{store:b()})}(0,h.cn)(null),(0,h.cn)(null);var C=(0,h.cn)({});function _(e){var t,n=x(C);return e&&null!==(t=n[e])&&void 0!==t?t:[]}function S(){var e=Z(C);return function(t,n){e(function(e){return(0,f.Uy)(e,function(e){var r=e[t];if(!r||0===r.length){e[t]=n;return}var i=!0,o=!1,a=void 0;try{for(var l,c=n[Symbol.iterator]();!(i=(l=c.next()).done);i=!0)!function(){var e=l.value;r.find(function(t){return t.name===e.name})||r.push(e)}()}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}})})}}function E(){var e=Z(C);return function(t,n){e(function(e){return(0,f.Uy)(e,function(e){var r=e[t];if(r&&0!==r.length){var i=!0,o=!1,a=void 0;try{for(var l,c=n[Symbol.iterator]();!(i=(l=c.next()).done);i=!0)!function(){var e=l.value,t=r.findIndex(function(t){return t.name===e.name});-1!==t&&r.splice(t,1)}()}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}}})})}}var k=(0,h.cn)({});function T(e){var t,n=x(k);return e&&null!==(t=n[e])&&void 0!==t?t:null}function R(){var e=w(k);return function(t){var n;return null!==(n=e()[t])&&void 0!==n?n:null}}function D(){var e=Z(k);return function(t,n){e(function(e){return(0,s._)((0,c._)({},e),(0,l._)({},t,n))})}}var I=(0,h.cn)(null);function G(){return x(I)}var B=(0,h.cn)([]);function A(){return x(B)}var P=(0,h.cn)({});function N(e){var t,n=x(P);return e&&null!==(t=n[e])&&void 0!==t?t:[]}function U(){var e=Z(P);return function(t,n){e(function(e){return(0,s._)((0,c._)({},e),(0,l._)({},t,n))})}}var O=(0,h.cn)(null,function(e,t,n){var r=n.id,i=n.pkg;if(!i.name)throw Error("Package does not have a name.");t(B,function(e){return(0,f.Uy)(e,function(e){if(!e.find(function(e){return e.pkgs.find(function(t){return e.id===r&&t.name===i.name})})){var t=e.find(function(e){return"Install"===e.kind});t?t.pkgs.push(i):e.push({kind:"Install",id:r,pkgs:[i]})}})})});function L(){return Z(O)}var M=(0,h.cn)(null,function(e,t,n){var r=n.id,i=n.pkg;if(!i.name)throw Error("Package does not have a name.");t(B,function(e){return(0,f.Uy)(e,function(e){if(!e.find(function(e){return e.pkgs.find(function(t){return e.id===r&&t.name===i.name})})){var t=e.find(function(e){return"Uninstall"===e.kind});t?t.pkgs.push(i):e.push({kind:"Uninstall",id:r,pkgs:[i]})}})})});function X(){return Z(M)}(0,h.cn)(null);var F=(0,h.cn)(null,function(e,t,n){var r=(0,d._)(e(B)),i=r[0],o=r.slice(1);n===i&&(t(B,o),t(I,n))});function W(){return Z(F)}var H=(0,h.cn)(null,function(e,t,n){t(B,function(e){return(0,f.Uy)(e,function(e){var t=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var l=o.value,c=l.pkgs.findIndex(function(e){return e.name===n});-1!==c&&l.pkgs.splice(c,1)}}catch(e){r=!0,i=e}finally{try{t||null==a.return||a.return()}finally{if(r)throw i}}})})});function V(){return Z(H)}},4662:function(e,t,n){n.d(t,{Z:function(){return c}});var r=n(63257),i=n(74985),o=n(56167),a=n.n(o),l=n(58091);function c(e){var t=e.replTitle,n=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,r._)(t.filter(Boolean)).concat(["Replit"]).join(" - ")}((0,l.ex)(),t);return(0,i.tZ)(a(),{children:(0,i.tZ)("title",{children:n},"title")})}},71914:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(74985),i=n(76999),o=n.n(i),a=n(96179),l=n(29287),c=n(1518);function s(e){var t=e.preventHighlightBorder,n=(0,c.Z)();return(0,r.BX)("div",{className:o().dynamic([["abfe52c92a5cedca",[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"]]])+" loader",children:[(0,r.tZ)("div",{className:o().dynamic([["abfe52c92a5cedca",[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"]]])+" wrap",children:(0,r.BX)(a.Z,{backgroundColor:l.TV.backgroundHighest,foregroundColor:l.TV.backgroundHigher,uniqueKey:"editorLoader",children:[(0,r.tZ)("rect",{x:"0",y:"0",rx:"3",ry:"3",width:"70",height:"10",className:o().dynamic([["abfe52c92a5cedca",[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"]]])}),(0,r.tZ)("rect",{x:"80",y:"0",rx:"3",ry:"3",width:"100",height:"10",className:o().dynamic([["abfe52c92a5cedca",[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"]]])}),(0,r.tZ)("rect",{x:"190",y:"0",rx:"3",ry:"3",width:"10",height:"10",className:o().dynamic([["abfe52c92a5cedca",[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"]]])}),(0,r.tZ)("rect",{x:"15",y:"20",rx:"3",ry:"3",width:"130",height:"10",className:o().dynamic([["abfe52c92a5cedca",[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"]]])}),(0,r.tZ)("rect",{x:"155",y:"20",rx:"3",ry:"3",width:"130",height:"10",className:o().dynamic([["abfe52c92a5cedca",[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"]]])}),(0,r.tZ)("rect",{x:"15",y:"40",rx:"3",ry:"3",width:"90",height:"10",className:o().dynamic([["abfe52c92a5cedca",[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"]]])}),(0,r.tZ)("rect",{x:"115",y:"40",rx:"3",ry:"3",width:"60",height:"10",className:o().dynamic([["abfe52c92a5cedca",[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"]]])}),(0,r.tZ)("rect",{x:"185",y:"40",rx:"3",ry:"3",width:"60",height:"10",className:o().dynamic([["abfe52c92a5cedca",[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"]]])}),(0,r.tZ)("rect",{x:"0",y:"60",rx:"3",ry:"3",width:"30",height:"10",className:o().dynamic([["abfe52c92a5cedca",[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"]]])}),(0,r.tZ)("rect",{x:"15",y:"80",rx:"3",ry:"3",width:"70",height:"10",className:o().dynamic([["abfe52c92a5cedca",[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"]]])}),(0,r.tZ)("rect",{x:"95",y:"80",rx:"3",ry:"3",width:"60",height:"10",className:o().dynamic([["abfe52c92a5cedca",[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"]]])}),(0,r.tZ)("rect",{x:"165",y:"80",rx:"3",ry:"3",width:"30",height:"10",className:o().dynamic([["abfe52c92a5cedca",[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"]]])}),(0,r.tZ)("rect",{x:"15",y:"100",rx:"3",ry:"3",width:"110",height:"10",className:o().dynamic([["abfe52c92a5cedca",[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"]]])}),(0,r.tZ)("rect",{x:"135",y:"100",rx:"3",ry:"3",width:"100",height:"10",className:o().dynamic([["abfe52c92a5cedca",[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"]]])}),(0,r.tZ)("rect",{x:"0",y:"120",rx:"3",ry:"3",width:"70",height:"10",className:o().dynamic([["abfe52c92a5cedca",[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"]]])})]})}),(0,r.tZ)(o(),{id:"abfe52c92a5cedca",dynamic:[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"],children:".loader.__jsx-style-dynamic-selector{z-index:3;height:100%;width:100%;background-color:var(--background-default);overflow:hidden;padding:var(--space-16);-webkit-border-bottom-right-radius:var(--border-radius-4);-moz-border-radius-bottomright:var(--border-radius-4);border-bottom-right-radius:var(--border-radius-4);-webkit-border-bottom-left-radius:var(--border-radius-4);-moz-border-radius-bottomleft:var(--border-radius-4);border-bottom-left-radius:var(--border-radius-4);-webkit-box-shadow:".concat(n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)",";-moz-box-shadow:").concat(n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)",";box-shadow:").concat(n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)","}.wrap.__jsx-style-dynamic-selector{overflow:hidden}.wrap.__jsx-style-dynamic-selector>svg{max-width:640px;min-width:500px;height:auto}@media screen and (min-width:900px){.loader.__jsx-style-dynamic-selector{padding:30px}}")})]})}},81662:function(e,t,n){n.d(t,{Ly:function(){return v},ZP:function(){return y},qm:function(){return Z}});var r=n(66626),i=n(63257),o=n(74985),a=n(25632),l=n(68514),c=n(18836),s=n(48272),u=n(4070),d=n(74833),f=n(93918),h=n(29287),p=n(18330),m=n(50959),v=[{value:"spaces",title:"spaces"},{value:"tabs",title:"tabs"}],g=(0,f.X)({sizeInput:[h.l0.py(6),h.l0.flex.growAndShrink(0),{border:"none"}]});function y(){var e=(0,a.Gn)("indentDetection","indentFormatPastes","indentIsSpaces","indentSize"),t=e.preferences,n=e.update;return(0,o.BX)(o.HY,{children:[(0,o.tZ)(p.$,{id:"indentDetection",title:(0,o.BX)(o.HY,{children:[(0,o.tZ)(d.xv,{multiline:!1,children:"Indentation detection"}),(0,o.tZ)(d.xv,{variant:"small",color:"dimmest",children:"Automatically detect indentation settings when opening a file."})]}),children:(0,o.tZ)(u.r,{"aria-label":"Indentation detection",isSelected:t.indentDetection,onChange:function(e){n({indentDetection:e})}})}),(0,o.tZ)(l.R,{}),(0,o.tZ)(p.$,{id:"indentFormatPastes",title:(0,o.BX)(o.HY,{children:[(0,o.tZ)(d.xv,{multiline:!1,children:"Format pasted text indentation"}),(0,o.tZ)(d.xv,{variant:"small",color:"dimmest",children:"Automatically format the indentation of pasted text."})]}),children:(0,o.tZ)(u.r,{"aria-label":"Format pasted text indentation",isSelected:t.indentFormatPastes,onChange:function(e){n({indentFormatPastes:e})}})}),(0,o.tZ)(l.R,{}),(0,o.tZ)(p.$,{id:"indentType",title:(0,o.BX)(o.HY,{children:[(0,o.tZ)(d.xv,{multiline:!1,children:"Indentation character"}),(0,o.tZ)(d.xv,{variant:"small",color:"dimmest",children:"The character used for indenting lines."})]}),children:(0,o.tZ)(s.P,{initialSelectedItem:v.find(function(e){return e.value===(t.indentIsSpaces?"spaces":"tabs")}),onChange:function(e){n({indentIsSpaces:(null==e?void 0:e.value)==="spaces"})},items:(0,i._)(v)})}),(0,o.tZ)(l.R,{}),(0,o.tZ)(p.$,{id:"indentSize",title:(0,o.BX)(o.HY,{children:[(0,o.tZ)(d.xv,{multiline:!1,children:"Indentation size"}),(0,o.tZ)(d.xv,{variant:"small",color:"dimmest",children:"The number of columns taken up by an indentation level."})]}),children:(0,o.tZ)(Z,{css:g.sizeInput,size:t.indentSize,onChange:function(e){n({indentSize:e})}})})]})}function b(e){return null==e?2:("string"==typeof e&&(e=parseInt(e,10)),isNaN(e))?2:(Number.isInteger(e)||(e=Math.round(e)),e<1)?1:e>16?16:e}function Z(e){var t=e.size,n=e.onChange,i=e.className,a=(0,r._)((0,m.useState)(null),2),l=a[0],s=a[1],u=null!==l?l:t.toString(),d=""===u?"6ch":u.length+5.5+"ch";return(0,o.tZ)(c.II,{type:"number",style:{width:d},className:i,min:1,max:16,value:u,onBlur:function(){return s(null)},onChange:function(e){var t=e.target.value.trim(),r=e.target.valueAsNumber;if(""===t||isNaN(r)){s(t);return}e.target.validity.valid?(s(null),n(b(r))):(s(t),""===t||isNaN(parseInt(t,10))||n(b(t)))}})}},18330:function(e,t,n){n.d(t,{$:function(){return s}});var r=n(74985),i=n(74833),o=n(56596),a=n(29287),l=n(10981),c=n(50959);function s(e){var t=e.id,n=e.title,s=e.children,u=(0,l.U)()(t);return(0,r.BX)(o.G,{css:[a.l0.rowWithGap(8),a.l0.justify.spaceBetween,a.l0.align.center],children:[(0,r.tZ)(o.G,{css:a.l0.flex.growAndShrink(1),tag:"label",htmlFor:u,children:"string"==typeof n?(0,r.tZ)(i.xv,{multiline:!1,children:n}):n}),c.cloneElement(s,{id:u})]})}},91215:function(e,t,n){n.d(t,{Z:function(){return tR}});var r,i,o,a=n(74985),l=n(2038),c=n(83447),s=n(74833),u=n(56596),d=n(29287),f=n(63257),h=n(25632),p=n(25425),m=n(95571),v=n(59868),g=n(18059),y=n(68514),b=n(15146),Z=n(48272),w=n(37951),x=n(38080),C=n(4070),_=n(88936),S=n(73722),E=n(41733),k=n(98924),T=n(66626),R=n(55534),D=n(8279),I=n(38202),G=n(21262),B=n(71440),A=n(58995),P=n(78711);function N(){var e=(0,G._)(["\n  fragment ThemesSwitcherCustomTheme on CustomTheme {\n    id\n    title\n    isCurrentUserThemeAuthor\n    colorScheme\n  }\n"]);return N=function(){return e},e}function U(){var e=(0,G._)(["\n  query ThemesSwitcherCurrentUserAuthoredThemes(\n    $input: CurrentUserAuthoredThemesInput!\n  ) {\n    currentUser {\n      id\n      authoredThemes(input: $input) {\n        ... on CustomThemeConnection {\n          items {\n            id\n            ...ThemesSwitcherCustomTheme\n          }\n          pageInfo {\n            nextCursor\n            hasNextPage\n          }\n        }\n        ... on UnauthorizedError {\n          message\n        }\n        ... on UserError {\n          message\n        }\n      }\n    }\n  }\n  ","\n"]);return U=function(){return e},e}function O(){var e=(0,G._)(["\n  query ThemesSwitcherCurrentUserInstalledThemes(\n    $input: CurrentUserInstalledThemesInput!\n  ) {\n    currentUser {\n      id\n      installedThemes(input: $input) {\n        ... on InstalledThemeConnection {\n          items {\n            id\n            themeVersion {\n              id\n            }\n            customTheme {\n              id\n              ...ThemesSwitcherCustomTheme\n            }\n          }\n          pageInfo {\n            nextCursor\n            hasNextPage\n          }\n        }\n        ... on UnauthorizedError {\n          message\n        }\n        ... on UserError {\n          message\n        }\n      }\n    }\n  }\n  ","\n"]);return O=function(){return e},e}var L={},M=(0,B.Ps)(N()),X=(0,B.Ps)(U(),M),F=(0,B.Ps)(O(),M),W=n(30509),H=n(42308),V=n(50959),z=n(4062),j=function(e){var t=(0,T._)((0,V.useState)(0),2),n=t[0],r=t[1];return(0,z.Z)(function(){null!==e.current&&r(e.current.getBoundingClientRect().height)},[e]),n},q=n(7444),Y=n(35597),$=n(93496),J=n(93918),K=n(79217),Q=n(84822),ee=n(21371),et=n(40282),en=n(99656),er=n(17054),ei=n(33988),eo=n.n(ei),ea=(0,J.X)({self:[{border:"1px solid",borderColor:d.TV.outlineDimmest},d.l0.zIndex(5),d.l0.maxHeight(300),d.l0.position.absolute,d.l0.overflowY("auto"),d.l0.width("100%"),d.l0.left(0),d.l0.borderRadius(8),d.l0.flex.column],apron:[d.l0.flex.grow(1),{borderTop:"1px solid",borderTopColor:d.TV.outlineDimmest}],menuItems:[d.l0.flex.growAndShrink(1),d.l0.overflowY("auto"),{listStyle:"none"}],menuApronItem:[d.l0.p(8),d.l0.rowWithGap(12),d.l0.justify.start,d.l0.align.center,$.gU.listItem],menuApronWrapper:[d.l0.flex.column]}),el=(0,er.oM)(),ec=function(e){var t=e.children,n=e.className,r=e.bottomOffset;return(0,a.BX)(x.Tg,{className:n,tag:"ul",elevated:!0,css:ea.self,style:{bottom:"calc(".concat(r,"px + ").concat(d.TV.space8,")")},children:[(0,a.tZ)(u.G,{css:ea.menuItems,children:t}),(0,a.tZ)(x.Tg,{css:ea.apron,children:(0,a.BX)(u.G,{css:ea.menuApronWrapper,children:[(0,a.tZ)(eo(),{legacyBehavior:!0,href:el.href,as:el.as,children:(0,a.BX)(u.G,{css:ea.menuApronItem,children:[(0,a.tZ)(Q.Z,{}),(0,a.tZ)(s.xv,{multiline:!1,children:"Explore Themes"})]})}),(0,a.tZ)(eo(),{legacyBehavior:!0,href:er.ZS.href,as:er.ZS.as,children:(0,a.BX)(u.G,{css:ea.menuApronItem,children:[(0,a.tZ)(en.Z,{}),(0,a.tZ)(s.xv,{multiline:!1,children:"Create a Theme"})]})})]})})]})},es=(0,J.X)({trigger:[$.gU.filled,d.l0.p(8),d.l0.color.foregroundDefault,d.l0.border({width:0})],triggerContent:[d.l0.align.center,d.l0.rowWithGap(8)],chevron:[d.l0.transition.snappy],selectLabel:[d.l0.flex.growAndShrink(1),{textAlign:"left",lineHeight:d.TV.lineHeightHeaderBig}],menuWrapper:[d.l0.position.relative],sectionHeadings:[d.l0.p(8),d.l0.fontWeight.bold,d.l0.fontSize(12),{borderTop:"1px solid ".concat(d.TV.outlineDimmer),textTransform:"uppercase"}],officialHeading:[d.l0.p(8),d.l0.fontWeight.bold,d.l0.fontSize(12),{textTransform:"uppercase"}],showMoreWrapper:[d.l0.align.center],spinnerWrapper:[d.l0.p(8),d.l0.align.center]}),eu=u.K.li;function ed(e){var t=e.id,n=e.sections,r=e.initialSelectedItem,i=e.selectedItem,o=e.onChange,l=e.placeholder,c=e.dataCy,d=e.paginationOptions,f=(0,k._)(e,["id","sections","initialSelectedItem","selectedItem","onChange","placeholder","dataCy","paginationOptions"]),h=(0,V.useId)(),p=(0,q.Z)(o),m=(0,V.useRef)(null),v=j(m),g=Object.values(n).flat(),y=(0,ee.L7)((0,W._)((0,E._)({items:g,initialSelectedItem:r,onSelectedItemChange:function(e){var t=e.selectedItem;t&&p.current(t)},stateReducer:function(e,t){var n=t.type,r=t.changes;switch(n){case ee.L7.stateChangeTypes.MenuKeyDownEnter:case ee.L7.stateChangeTypes.MenuKeyDownSpaceButton:case ee.L7.stateChangeTypes.ItemClick:return(0,W._)((0,E._)({},r),{isOpen:!0});default:return r}}},void 0!==i&&{selectedItem:i}),{id:h})),Z=(0,Y.Z)({onLoadMore:d.loadMore,rootMargin:"0px 0px 300px 0px"}).targetRef,w=function(e){var t,n=e.item,r=e.index;return(0,a.tZ)(eu,(0,W._)((0,E._)({},y.getItemProps({item:n,index:r})),{"data-cy":n.dataCy,children:(0,a.tZ)(H.Z,{highlighted:r===y.highlightedIndex,selected:n.id===(null===(t=y.selectedItem)||void 0===t?void 0:t.id),title:n.title})}))};return(0,a.BX)(u.G,{id:t,dataCy:c,children:[(0,a.tZ)(et.T,{children:(0,a.tZ)("label",(0,W._)((0,E._)({},y.getLabelProps()),{children:"select a theme"}))}),(0,a.tZ)("button",(0,W._)((0,E._)({type:"button",css:es.trigger},f,y.getToggleButtonProps({ref:m})),{children:(0,a.BX)(u.G,{css:es.triggerContent,children:[(0,a.tZ)(Q.Z,{size:16}),y.selectedItem?(0,a.tZ)(s.xv,{css:es.selectLabel,multiline:!1,children:y.selectedItem.title}):(0,a.tZ)(s.xv,{color:"dimmer",css:es.selectLabel,multiline:!1,children:l}),(0,a.tZ)(K.Z,{rotate:y.isOpen?180:0,css:es.chevron})]})})),(0,a.tZ)("div",(0,W._)((0,E._)({},y.getMenuProps()),{css:es.menuWrapper,children:y.isOpen&&g.length>0?(0,a.BX)(ec,{bottomOffset:v,children:[(0,a.tZ)(s.xv,{color:"dimmer",css:es.officialHeading,multiline:!1,children:"Official Themes"}),n.official.map(function(e,t){return(0,a.tZ)(w,{item:e,index:t},"".concat(e.id))}),n.authored.length?(0,a.BX)(a.HY,{children:[(0,a.tZ)(s.xv,{color:"dimmer",css:es.sectionHeadings,multiline:!1,children:"Your Themes"}),n.authored.map(function(e,t){var r=n.official.length;return(0,a.tZ)(w,{item:e,index:r+t},"".concat(e.id))})]}):null,n.installed.length?(0,a.BX)(a.HY,{children:[(0,a.tZ)(s.xv,{color:"dimmer",css:es.sectionHeadings,multiline:!1,children:"Community Themes"}),n.installed.map(function(e,t){var r=n.official.length+n.authored.length;return(0,a.tZ)(w,{item:e,index:r+t},"".concat(e.id))})]}):null,d.authoredHasNextPage||d.installedHasNextPage?(0,a.tZ)(u.G,{css:es.showMoreWrapper,children:d.loading?(0,a.tZ)(u.G,{css:es.spinnerWrapper,children:(0,a.tZ)(_.Z,{size:12})}):(0,a.tZ)(b.hU,{tooltipHidden:!0,alt:"Show more",onClick:d.loadMore,ref:Z,children:(0,a.tZ)(K.Z,{})})}):null]}):null}))]})}var ef=n(70671),eh=n(49932),ep=n(43349),em=n(67225),ev=function(e,t){var n,r,i=t.fetchMoreResult;if((null===(n=e.currentUser)||void 0===n?void 0:n.authoredThemes.__typename)==="CustomThemeConnection"&&(null===(r=i.currentUser)||void 0===r?void 0:r.authoredThemes.__typename)==="CustomThemeConnection"){var o=e.currentUser.authoredThemes.items,a=i.currentUser.authoredThemes.items;return(0,W._)((0,E._)({},i),{currentUser:(0,W._)((0,E._)({},i.currentUser),{authoredThemes:(0,W._)((0,E._)({},i.currentUser.authoredThemes),{items:(0,f._)(o).concat((0,f._)(a))})})})}return i},eg=function(e,t){var n,r,i=t.fetchMoreResult;if((null===(n=e.currentUser)||void 0===n?void 0:n.installedThemes.__typename)==="InstalledThemeConnection"&&(null===(r=i.currentUser)||void 0===r?void 0:r.installedThemes.__typename)==="InstalledThemeConnection"){var o=e.currentUser.installedThemes.items,a=i.currentUser.installedThemes.items;return(0,W._)((0,E._)({},i),{currentUser:(0,W._)((0,E._)({},i.currentUser),{installedThemes:(0,W._)((0,E._)({},i.currentUser.installedThemes),{items:(0,f._)(o).concat((0,f._)(a))})})})}return i},ey=function(e){var t=e.authoredThemesData,n=e.installedThemesData,r=e.fetchMoreAuthored,i=e.fetchMoreInstalled;return(0,V.useCallback)(function(){var e,o;(null==t?void 0:null===(e=t.currentUser)||void 0===e?void 0:e.authoredThemes.__typename)==="CustomThemeConnection"&&t.currentUser.authoredThemes.pageInfo.hasNextPage?r({variables:{input:{after:t.currentUser.authoredThemes.pageInfo.nextCursor,count:100}},updateQuery:ev}):(null==n?void 0:null===(o=n.currentUser)||void 0===o?void 0:o.installedThemes.__typename)==="InstalledThemeConnection"&&n.currentUser.installedThemes.pageInfo.hasNextPage&&i({variables:{input:{after:n.currentUser.installedThemes.pageInfo.nextCursor,count:100}},updateQuery:eg})},[t,n,r,i])},eb=function(e){var t,n,r,i,o,l,c,s,f=e.context,h=(0,k._)(e,["context"]),p=(0,V.useId)(),m=(0,R.Z)().showError,v=(t=(0,E._)({},L,{variables:{input:{count:100}},fetchPolicy:"network-only",ssr:!1,notifyOnNetworkStatusChange:!0,onError:function(e){return m(e.message)},onCompleted:function(e){var t,n=null===(t=e.currentUser)||void 0===t?void 0:t.authoredThemes;((null==n?void 0:n.__typename)==="UnauthorizedError"||(null==n?void 0:n.__typename)==="UserError")&&m(n.message)}}),A.a(X,t)),g=v.data,y=v.loading,b=v.error,Z=v.fetchMore,x=(0,T._)((n=(0,E._)({},L,{variables:{input:{count:100}},fetchPolicy:"network-only",ssr:!1,notifyOnNetworkStatusChange:!0,onError:function(e){return m(e.message)},onCompleted:function(e){var t,n=null===(t=e.currentUser)||void 0===t?void 0:t.installedThemes;((null==n?void 0:n.__typename)==="UnauthorizedError"||(null==n?void 0:n.__typename)==="UserError")&&m(n.message)}}),P.t(F,n)),2),C=x[0],_=x[1],S=_.data,G=_.loading,B=_.error,N=_.fetchMore,U=(0,ef.F)(),O=U.setActiveTheme,M=U.isSaving,W=U.error,H=U.theme;(0,V.useEffect)(function(){var e,t=null==g?void 0:null===(e=g.currentUser)||void 0===e?void 0:e.authoredThemes;(null==t?void 0:t.__typename)!=="CustomThemeConnection"||t.pageInfo.hasNextPage||C()},[g,C]);var z=((null==S?void 0:null===(i=S.currentUser)||void 0===i?void 0:null===(r=i.installedThemes)||void 0===r?void 0:r.__typename)==="InstalledThemeConnection"?S.currentUser.installedThemes.items:[]).map(function(e){return e.customTheme}),j=(null==g?void 0:null===(l=g.currentUser)||void 0===l?void 0:null===(o=l.authoredThemes)||void 0===o?void 0:o.__typename)==="CustomThemeConnection"?g.currentUser.authoredThemes.items:[];(0,V.useEffect)(function(){W&&m(W.message)},[W,m]);var q=ey({authoredThemesData:g,installedThemesData:S,fetchMoreAuthored:Z,fetchMoreInstalled:N}),Y=(null==g?void 0:null===(c=g.currentUser)||void 0===c?void 0:c.authoredThemes.__typename)==="CustomThemeConnection"&&g.currentUser.authoredThemes.pageInfo.hasNextPage,$=(null==S?void 0:null===(s=S.currentUser)||void 0===s?void 0:s.installedThemes.__typename)==="InstalledThemeConnection"&&S.currentUser.installedThemes.pageInfo.hasNextPage;if(b||B)return(0,a.tZ)(u.G,{children:(0,a.tZ)(w.E,{colorway:"negative",text:"Something went wrong loading your themes"})});var J={official:ep.T,authored:j,installed:z};return(0,a.tZ)(u.G,{children:(0,a.tZ)(ed,(0,E._)({css:[[M?D.p.backgroundPulse(eh.TV.accentPrimaryDefault,eh.TV.accentPrimaryDimmest):{}],d.l0.backgroundColor.backgroundDefault,{":not([disabled]):hover":{background:eh.TV.backgroundHigher}}],id:p,dataCy:"preferences-theme-dropdown",sections:J,disabled:M,paginationOptions:{loadMore:q,authoredHasNextPage:Y,installedHasNextPage:$,loading:y||G},selectedItem:(0,I.iG)(H)?H.customTheme:ep.T.find(function(e){return e.id===H.id}),onChange:function(e){O(e.id),"number"==typeof e.id&&(0,em.B4)({themeId:e.id,colorScheme:e.colorScheme,isAlreadyInstalled:!0,isAuthor:e.isCurrentUserThemeAuthor,context:f})}},h))})},eZ=n(81662),ew=n(1498),ex=n(18836),eC=n(32377),e_=n(35034),eS=n(18330);function eE(e){return e.slice().sort(function(e,t){return e-t})}var ek=(0,J.X)({ruler:[d.l0.py(4),d.l0.px(8),d.l0.rowWithGap(4),d.l0.align.center,d.l0.borderRadius(8)],remove:[d.l0.borderRadius(4)],title:[d.l0.pr(8),d.l0.overflow("visible"),d.l0.flex.shrink(0)],body:[d.l0.flex.row,d.l0.flex.wrapReverse,d.l0.align.start,d.l0.justify.end,d.l0.flex.growAndShrink(1),{gap:d.TV.space4}],list:[d.l0.flex.row,d.l0.flex.wrap,d.l0.flex.growAndShrink(1),d.l0.align.end,d.l0.justify.end,{gap:d.TV.space4}],add:[d.l0.rowWithGap(4),d.l0.align.center]});function eT(e){var t=e.pos,n=e.onRemove;return(0,a.BX)(x.Tg,{css:ek.ruler,elevated:!0,children:[(0,a.tZ)(s.xv,{multiline:!1,children:t}),(0,a.tZ)(b.hU,{css:ek.remove,alt:"Remove ruler",onClick:n,children:(0,a.tZ)(e_.Z,{})})]})}function eR(){var e=(0,T._)((0,V.useState)(!1),2),t=e[0],n=e[1],r=(0,T._)((0,V.useState)(80),2),i=r[0],o=r[1],l=(0,V.useRef)(null),c=(0,V.useRef)(null),d=-1===i,p=i>=0&&i<=1e3,m=(0,h.Gn)("rulers"),v=m.preferences,g=m.update,y=eE(v.rulers);return(0,a.tZ)(eS.$,{id:"rulers",title:(0,a.tZ)(s.xv,{css:ek.title,multiline:!1,children:"Rulers"}),children:(0,a.BX)(u.G,{css:ek.body,children:[(0,a.tZ)(u.G,{css:ek.list,children:y.map(function(e,t){return(0,a.tZ)(eT,{pos:e,onRemove:function(){g({rulers:y.filter(function(e,n){return n!==t})})}},t)})}),t?(0,a.BX)(u.G,{css:ek.add,children:[(0,a.tZ)(ex.II,{ref:l,type:"number",style:{width:d?"6ch":i.toString().length+5.5+"ch"},value:i>=0?i.toString():"",onChange:function(e){if(""===e.target.value)o(-1);else{var t=parseInt(e.target.value,10);isNaN(t)||o(t)}},onKeyDown:function(e){"Escape"===e.key?(o(80),n(!1)):"Enter"===e.key&&p&&(g({rulers:eE((0,f._)(y).concat([i]))}),n(!1),o(80))},onBlur:function(e){e.relatedTarget!==c.current&&(n(!1),o(80))},onFocus:function(e){e.target.select()},autoFocus:!0}),(0,a.tZ)(ew.zx,{ref:c,text:"Accept",colorway:"primary",iconLeft:(0,a.tZ)(eC.Z,{}),disabled:!p,onClick:function(){p&&(g({rulers:eE((0,f._)(y).concat([i]))}),n(!1),o(80))},onBlur:function(e){e.relatedTarget!==l.current&&(n(!1),o(80))}})]}):(0,a.tZ)(a.HY,{children:y.length>=10?null:(0,a.tZ)(ew.zx,{text:"Add Ruler",iconLeft:(0,a.tZ)(en.Z,{}),onClick:function(){return n(!0)}})})]})})}var eD=(0,J.X)({container:[d.l0.flex.row,d.l0.justify.spaceBetween,d.l0.align.start],title:[d.l0.flex.growAndShrink(1)],body:[d.l0.colWithGap(12)],switch:[d.l0.rowWithGap(8),d.l0.align.center,d.l0.justify.end]});function eI(){var e=(0,h.Gn)("showLeadingWhitespace","showTrailingWhitespace","showEnclosedWhitespace","showSelectedWhitespace"),t=e.preferences,n=e.update;return(0,a.BX)(u.G,{css:eD.container,children:[(0,a.BX)(u.G,{css:eD.title,children:[(0,a.tZ)(s.xv,{children:"Show whitespace"}),(0,a.tZ)(s.xv,{multiline:!0,variant:"small",css:[d.l0.color.foregroundDimmest],children:"Make whitespace characters visible, such as tabs and spaces."})]}),(0,a.BX)(u.G,{css:eD.body,children:[(0,a.BX)(u.G,{css:eD.switch,tag:"label",children:[(0,a.tZ)(s.xv,{variant:"small",children:"Leading"}),(0,a.tZ)(C.r,{"aria-label":"Show leading whitespace",isSelected:t.showLeadingWhitespace,onChange:function(e){n({showLeadingWhitespace:e})}})]}),(0,a.BX)(u.G,{css:eD.switch,tag:"label",children:[(0,a.tZ)(s.xv,{variant:"small",children:"Enclosed"}),(0,a.tZ)(C.r,{css:[d.l0.flex.rowReverse],"aria-label":"Show enclosed whitespace",isSelected:t.showEnclosedWhitespace,onChange:function(e){n({showEnclosedWhitespace:e})}})]}),(0,a.BX)(u.G,{css:eD.switch,tag:"label",children:[(0,a.tZ)(s.xv,{variant:"small",children:"Trailing"}),(0,a.tZ)(C.r,{"aria-label":"Show trailing whitespace",isSelected:t.showTrailingWhitespace,onChange:function(e){n({showTrailingWhitespace:e})}})]}),(0,a.BX)(u.G,{css:eD.switch,tag:"label",children:[(0,a.tZ)(s.xv,{variant:"small",children:"Selected"}),(0,a.tZ)(C.r,{"aria-label":"Show selected whitespace",isSelected:t.showSelectedWhitespace,onChange:function(e){n({showSelectedWhitespace:e})}})]})]})]})}var eG=n(60442),eB=n(47611),eA=n(42516),eP=n(75129),eN=n(30983),eU=n(75875),eO=n(78228),eL=n(99708),eM=Array.from(n(45434).ce,function(e){return{title:e,value:e}}),eX=Array.from((0,f._)(Object.entries(eO.fT)).concat([["custom",""]]),function(e){return{title:e[0],value:e[1]}});function eF(){var e,t,n,r=(0,p.P5)({controlName:"flag-ghostwriter-chat-engine-override",logFlagToAnalytics:!1}),i=(0,eL.yz)().data,o=(null==i?void 0:null===(e=i.currentUser)||void 0===e?void 0:e.isStaff)||!1,l=(0,h.Gn)("chatEngine","ghostwriterChatServiceEnvironment","ghostwriterUseAdvancedModel"),c=l.preferences,m=l.update,g=(0,eP.v)(),w={value:null,title:"default"},x=(0,eO.Th)(),_=(0,T._)((0,V.useState)(!Object.values(eO.fT).includes(x)),2),E=_[0],k=_[1],R=(0,T._)((0,V.useState)(""),2),D=R[0],I=R[1],G=function(e,t){m((0,eA._)({},e,t)),(0,v.j)(v.U3.SETTINGS_TOGGLED,{settingChanged:e,updatedValue:t})};return(0,a.BX)(a.HY,{children:[r?(0,a.BX)(a.HY,{children:[(0,a.tZ)(y.R,{}),(0,a.tZ)(eS.$,{id:"ghostwriterChatEngine",title:(0,a.BX)(a.HY,{children:[(0,a.BX)(u.G,{css:[d.l0.flex.row,d.l0.rowWithGap(8),d.l0.center,d.l0.justify.start],children:[(0,a.BX)(s.xv,{multiline:!1,children:["AI"," chat engine"]}),(0,a.tZ)(eN.u,{tooltip:'You are seeing this functionality because you have special permissions. If set, this preference overrides "Use Advanced model" preference.',children:(0,a.tZ)(eU.Z,{})})]}),(0,a.BX)(s.xv,{variant:"small",css:[d.l0.color.foregroundDimmest],children:["Current applied engine: ",g]})]}),children:(0,a.tZ)(a.HY,{children:(0,a.tZ)(Z.P,{css:[d.l0.minWidth(184)],initialSelectedItem:null!==(t=eM.find(function(e){return e.value===c.chatEngine}))&&void 0!==t?t:w,onChange:function(e){return G("chatEngine",null==e?void 0:e.value)},items:[w].concat((0,f._)(eM))})})})]}):null,(0,a.BX)(a.HY,{children:[(0,a.tZ)(y.R,{}),(0,a.tZ)(eS.$,{id:"ghostwriterChatUseAdvancedModel",title:(0,a.BX)(a.HY,{children:[(0,a.tZ)(u.G,{css:[d.l0.flex.row,d.l0.rowWithGap(8),d.l0.center,d.l0.justify.start],children:(0,a.BX)(s.xv,{multiline:!1,children:["AI"," advanced model"]})}),(0,a.tZ)(s.xv,{variant:"small",css:[d.l0.color.foregroundDimmest],children:"Advanced models require a lot of power and have usage limits. They're most useful for tasks that are ambiguous or require creativity."})]}),children:(0,a.tZ)(a.HY,{children:(0,a.tZ)(C.r,{"aria-label":"Use Advanced model",isSelected:c.ghostwriterUseAdvancedModel,onChange:function(e){(0,v.j)(v.U3.GHOSTWRITER_CHAT_MODEL_CHANGED,{source:"settingsPane",model:e?"advanced":"default"}),G("ghostwriterUseAdvancedModel",e)}})})})]}),o?(0,a.BX)(a.HY,{children:[(0,a.tZ)(y.R,{}),(0,a.tZ)(eS.$,{id:"ghostwriterChatService",title:(0,a.BX)(a.HY,{children:[(0,a.tZ)(u.G,{css:[d.l0.flex.row,d.l0.rowWithGap(8),d.l0.center,d.l0.justify.start],children:(0,a.tZ)(s.xv,{multiline:!1,children:"Ghostwriter Chat Service V2 "})}),(0,a.BX)(s.xv,{variant:"small",css:[d.l0.color.foregroundDimmest],children:["Current endpoint: ",x]})]}),children:(0,a.BX)(u.G,{css:d.l0.colWithGap(12),children:[(0,a.tZ)(Z.P,{css:[d.l0.minWidth(184)],initialSelectedItem:null!==(n=eX.find(function(e){return e.value===c.ghostwriterChatServiceEnvironment}))&&void 0!==n?n:c.ghostwriterChatServiceEnvironment?eX[eX.length-1]:eX[0],onChange:function(e){(null==e?void 0:e.title)!=="custom"?(G("ghostwriterChatServiceEnvironment",null==e?void 0:e.value),k(!1)):k(!0)},items:eX}),E?(0,a.BX)(u.G,{css:d.l0.rowWithGap(4),children:[(0,a.tZ)(ex.II,{value:D,onChange:function(e){I(e.target.value)},onKeyDown:function(e){"Enter"===e.key&&G("ghostwriterChatServiceEnvironment",D)}}),(0,a.tZ)(b.hU,{alt:"Update custom url",onClick:function(){return G("ghostwriterChatServiceEnvironment",D)},children:c.ghostwriterChatServiceEnvironment!==D?(0,a.tZ)(S.Z,{}):(0,a.tZ)(eC.Z,{})})]}):null]})})]}):null]})}var eW=n(78272);function eH(e){var t=e.context,n=e.text,r=(0,T._)((0,V.useState)(!1),2),i=r[0],o=r[1];return(0,a.BX)(a.HY,{children:[(0,a.tZ)(ew.zx,{text:void 0===n?"Activate":n,colorway:"primary",onClick:function(){return o(!0)}}),(0,a.tZ)(eW.Z,{isOpen:i,onClose:function(){return o(!1)},type:"purchase",analyticsContext:{upgrade:{context:t}}})]})}var eV=n(75582),ez=n(18597);(r=i||(i={})).None="None",r.Activate="Activate",r.Activated="Activated",r.TrialOngoing="TrialOngoing",r.TrialExpired="TrialExpired";var ej=(o={},(0,eA._)(o,eV.e4.Activate,"Activate"),(0,eA._)(o,eV.e4.Activated,"Activated"),(0,eA._)(o,eV.e4.TrialOngoing,"TrialOngoing"),(0,eA._)(o,eV.e4.TrialExpired,"TrialExpired"),o),eq=n(79490),eY=n(40028),e$=n(20916),eJ=n(85172),eK=n(75452),eQ=n(87001);function e0(){var e=(0,G._)(["\n  query CodeSuggestionPreferences {\n    currentUser {\n      id\n      userSubscriptionType\n      userPowerUpsByType {\n        __typename\n        ... on UnauthorizedError {\n          message\n        }\n        ... on UserPowerUpsTypes {\n          ghostwriter {\n            active\n          }\n        }\n      }\n    }\n  }\n"]);return e0=function(){return e},e}var e1={},e2=(0,B.Ps)(e0()),e8=Array.from(eK.vw,function(e){return{title:e,value:e}}),e4={titleContainer:[d.l0.rowWithGap(8),d.l0.align.center],upgradeRow:[d.l0.rowWithGap(8),d.l0.align.center,d.l0.justify.spaceBetween]};function e3(){var e,t,n,r=(0,p.P5)({controlName:"flag-code-suggestion-engine",logFlagToAnalytics:!1}),i=(e=(0,E._)({},e1,void 0),A.a(e2,e)).data,o=(null==i?void 0:null===(t=i.currentUser)||void 0===t?void 0:t.userSubscriptionType)===eV.HP.HackerPro,l=(0,eJ.v)().isTeamWithAiDisabled,c=(0,h.Gn)("codeSuggestion","completeCodeEngine"),m=c.preferences,g=c.update,b=(0,e$.Z)().engine,w={value:null,title:"default"},x=function(e,t){g((0,eA._)({},e,t)),(0,v.j)(v.U3.SETTINGS_TOGGLED,{settingChanged:e,updatedValue:t})};return l?null:(0,a.BX)(u.G,{css:d.l0.colWithGap(12),children:[(0,a.tZ)(eS.$,{id:"codeSuggestionToggle",title:(0,a.BX)(a.HY,{children:[(0,a.tZ)(u.G,{css:e4.titleContainer,children:(0,a.tZ)(s.xv,{multiline:!1,children:"AI code completion"})}),(0,a.BX)(s.xv,{variant:"small",css:[d.l0.color.foregroundDimmest],children:["Code completion provides inline ghost text suggestions while you code.",(0,a.tZ)("br",{}),"Press tab or swipe right on your mobile device to accept."]})]}),children:(0,a.tZ)(a.HY,{children:(0,a.tZ)(C.r,{"aria-label":"Code complete",isSelected:m.codeSuggestion,onChange:function(e){x("codeSuggestion",e)}})})}),o?null:(0,a.BX)(u.G,{css:e4.upgradeRow,children:[(0,a.tZ)(s.xv,{children:"Upgrade for full access to Replit AI"}),(0,a.tZ)(eH,{text:"Upgrade to Replit ".concat(eQ.we),context:"workspace_settings_pane"})]}),r?(0,a.BX)(a.HY,{children:[(0,a.tZ)(y.R,{}),(0,a.tZ)(eS.$,{id:"completeCodeEngine",title:(0,a.BX)(a.HY,{children:[(0,a.BX)(u.G,{css:[d.l0.flex.row,d.l0.rowWithGap(8),d.l0.center,d.l0.justify.start],children:[(0,a.tZ)(s.xv,{multiline:!1,children:"AI code completion engine"}),(0,a.tZ)(eN.u,{tooltip:"You are seeing this functionality because you have special permissions.",children:(0,a.tZ)(eU.Z,{})})]}),(0,a.BX)(s.xv,{variant:"small",css:[d.l0.color.foregroundDimmest],children:["Current applied engine: ",b]})]}),children:(0,a.tZ)(a.HY,{children:(0,a.tZ)(Z.P,{css:[d.l0.minWidth(184)],initialSelectedItem:null!==(n=e8.find(function(e){return e.value===m.completeCodeEngine}))&&void 0!==n?n:w,onChange:function(e){return x("completeCodeEngine",null==e?void 0:e.value)},items:[w].concat((0,f._)(e8))})})})]}):null]})}var e5={titleContainer:[d.l0.rowWithGap(8),d.l0.align.center],surface:[d.l0.p(8),d.l0.colWithGap(8),d.l0.borderRadius(8),d.l0.align.start]};function e6(){var e=function(){var e,t,n=(0,ez.JC)(),r=n.data;if(n.loading)return{loading:!0};if((null==r?void 0:null===(e=r.currentUser)||void 0===e?void 0:e.userPowerUpsByType.__typename)==="UnauthorizedError");else if((null==r?void 0:null===(t=r.currentUser)||void 0===t?void 0:t.userPowerUpsByType.__typename)==="UserPowerUpsTypes"){var i=r.currentUser.userPowerUpsByType.ghostwriter,o=i.CTA,a=i.timeTrialExpiry;if(null!=o){var l=ej[o];if(("TrialOngoing"===l||"TrialExpired"===l)&&a)return{cta:l,trialExpiryDate:new Date(a),loading:!1};if("Activate"===l||"Activated"===l)return{cta:l,loading:!1}}}return{cta:"None",loading:!1}}(),t=e.cta,n=e.loading,r=(0,l.rv)();if(n)return(0,a.tZ)(eS.$,{id:"ghostwriter",title:"Ghostwriter",children:(0,a.tZ)(_.Z,{})});if(!r)return(0,a.tZ)(e3,{});switch(t){case i.None:return null;case i.Activated:case i.TrialOngoing:return(0,a.tZ)(e3,{});case i.TrialExpired:case i.Activate:if(r)return null;return(0,a.tZ)(eS.$,{id:"ghostwriter",title:(0,a.BX)(a.HY,{children:[(0,a.BX)(u.G,{css:e5.titleContainer,children:[(0,a.tZ)(s.xv,{multiline:!1,children:"Ghostwriter"}),(0,a.tZ)(eq.Z,{context:"workspace_settings_pane",powerUp:"ghostwriter"})]}),(0,a.tZ)(s.xv,{variant:"small",css:[d.l0.color.foregroundDimmest],multiline:!1,children:"Replit's AI pair programmer can complete, generate, explain, and edit code."})]}),children:(0,a.tZ)(eH,{context:"workspace_settings_pane"})});default:(0,eY.Z)(t)}}function e9(e){var t=e.onBeforePreferencesUpdate,n=e.hideLayoutControl,r=e.className,i=e.resetLayout,o=(0,h.Gn)("isLayoutStacked","fontSize","minimapDisplay","wrapping","keyboardHandler","multiselectModifierKey","showFileTreeGitStatus","codeIntelligence","accessibleTerminal","shellBellAudio","webviewAutoOpenOnPortOpened","chatAudioNotification"),c=o.preferences,E=o.update,k=(0,l.Vg)((0,eB.useRouter)()),T=(0,l.T3)(),R=(0,eG.cR)(),D=(0,g.NJ)(),I=(0,p.P5)({controlName:"flag-editor-visible-whitespace",logFlagToAnalytics:!1}),G=(0,p.P5)({controlName:"flag-chat-audio-notification"}),B=(0,p.P5)({controlName:"flag-filetree-git-status",logFlagToAnalytics:!1}),A=function(e){t&&t(e),Object.keys(e).forEach(function(t){var n=e[t];(0,v.j)(v.U3.SETTINGS_TOGGLED,{settingChanged:t,updatedValue:n})}),E(e)};if(!c)return null;var P=[{value:"side-by-side",title:"side-by-side"},{value:"stacked",title:"stacked"}],N=[{value:10,title:"tiny"},{value:12,title:"small"},{value:14,title:"normal"},{value:18,title:"large"},{value:24,title:"huge"}],U=[{value:"default",title:"default"},{value:"emacs",title:"emacs"},{value:"vim",title:"vim"}],O=[{value:"none",title:"none"},{value:"soft",title:"soft wrap"}],L=[{value:"none",title:"none"},{value:"blocks",title:"blocks"},{value:"characters",title:"characters"}],M=["cmdOrCtrlKey","altKey"].map(function(e){return{value:e,title:(0,m.hp)("cmdOrCtrlKey"===e?m.LH.CMD_OR_CTRL_KEY:m.LH.ALT_KEY,D)}});return(0,a.BX)(x.Tg,{className:r,background:"default",css:[d.l0.p(16),d.l0.colWithGap(12)],children:[n?null:(0,a.BX)(a.HY,{children:[(0,a.tZ)(eS.$,{id:"layout",title:"Default layout",children:(0,a.BX)(u.G,{css:[d.l0.align.center,d.l0.rowWithGap(8)],children:[i?(0,a.tZ)(b.hU,{alt:"Reset layout",onClick:function(){i.reset()},children:i.reseting?(0,a.tZ)(_.Z,{}):(0,a.tZ)(S.Z,{})}):null,(0,a.tZ)(Z.P,{initialSelectedItem:P.find(function(e){return c.isLayoutStacked?"stacked"===e.value:"side-by-side"===e.value}),onChange:function(e){A({isLayoutStacked:(null==e?void 0:e.value)==="stacked"})},items:(0,f._)(P)})]})}),(0,a.tZ)(y.R,{})]}),(0,a.tZ)(eS.$,{id:"fontSize",title:"Font size",children:(0,a.tZ)(Z.P,{initialSelectedItem:N.find(function(e){return e.value===c.fontSize}),onChange:function(e){A({fontSize:"number"==typeof(null==e?void 0:e.value)?e.value:14})},items:(0,f._)(N)})}),(0,a.tZ)(y.R,{}),(0,a.tZ)(eZ.ZP,{}),(0,a.tZ)(y.R,{}),(0,a.tZ)(eS.$,{id:"wrapping",title:"Wrapping",children:(0,a.tZ)(Z.P,{initialSelectedItem:O.find(function(e){return e.value===(c.wrapping?"soft":"none")}),onChange:function(e){A({wrapping:(null==e?void 0:e.value)==="soft"})},items:(0,f._)(O)})}),(0,a.tZ)(y.R,{}),T?null:(0,a.BX)(a.HY,{children:[(0,a.tZ)(eS.$,{id:"minimap",title:"Minimap",children:(0,a.tZ)(Z.P,{initialSelectedItem:L.find(function(e){return e.value===c.minimapDisplay}),onChange:function(e){A({minimapDisplay:e.value})},items:(0,f._)(L)})}),(0,a.tZ)(y.R,{})]}),(0,a.tZ)(eR,{}),(0,a.tZ)(y.R,{}),(0,a.tZ)(eS.$,{id:"keybinds",title:"Keybinds",children:(0,a.tZ)(Z.P,{initialSelectedItem:U.find(function(e){return["vim","emacs"].includes(e.value)?e.value===c.keyboardHandler:"default"===e.value&&!c.keyboardHandler}),onChange:function(e){A({keyboardHandler:["vim","emacs"].includes(e.value)?e.value:null})},items:(0,f._)(U),dataCy:"keybinds"})}),(0,a.tZ)(y.R,{}),(0,a.tZ)(eS.$,{id:"multiselectModifier",title:(0,a.BX)(a.HY,{children:[(0,a.tZ)(s.xv,{multiline:!1,children:"Multiselect modifier key"}),(0,a.tZ)(s.xv,{variant:"small",css:[d.l0.color.foregroundDimmest],children:"Modifier key for selecting multiple items in the filetree."})]}),children:(0,a.tZ)(Z.P,{initialSelectedItem:M.find(function(e){return e.value===c.multiselectModifierKey}),onChange:function(e){A({multiselectModifierKey:e.value})},items:(0,f._)(M)})}),(0,a.tZ)(y.R,{}),B?(0,a.BX)(a.HY,{children:[(0,a.tZ)(eS.$,{id:"showFileTreeGitStatus",title:(0,a.BX)(a.HY,{children:[(0,a.tZ)(s.xv,{multiline:!1,children:"File tree Git status"}),(0,a.tZ)(s.xv,{variant:"small",css:[d.l0.color.foregroundDimmest],children:"Show the Git status of files in the file tree."})]}),children:(0,a.tZ)(C.r,{"aria-label":"File tree Git status",isSelected:c.showFileTreeGitStatus,onChange:function(e){A({showFileTreeGitStatus:e})}})}),(0,a.tZ)(y.R,{})]}):null,(0,a.tZ)(e6,{}),(0,a.tZ)(eF,{}),(0,a.tZ)(y.R,{}),(0,a.tZ)(eS.$,{id:"codeIntelligence",title:(0,a.BX)(a.HY,{children:[(0,a.tZ)(s.xv,{multiline:!1,children:"Code intelligence"}),(0,a.tZ)(s.xv,{variant:"small",css:[d.l0.color.foregroundDimmest],children:"Code intelligence gives you autocomplete, as well as hints as you type."})]}),children:(0,a.tZ)(C.r,{"aria-label":"Code Intelligence",isSelected:c.codeIntelligence,onChange:function(e){A({codeIntelligence:e})}})}),(0,a.tZ)(y.R,{}),I?(0,a.BX)(a.HY,{children:[(0,a.tZ)(eI,{}),(0,a.tZ)(y.R,{})]}):null,(0,a.tZ)(eS.$,{id:"accessibleTerminal",title:(0,a.BX)(a.HY,{children:[(0,a.tZ)(s.xv,{multiline:!1,children:"Accessible terminal output"}),(0,a.tZ)(s.xv,{variant:"small",css:[d.l0.color.foregroundDimmest],children:"Enable this setting to use a screen reader. Warning: this can affect performance."})]}),children:(0,a.tZ)(C.r,{"aria-label":"Accessible terminal output",isSelected:c.accessibleTerminal,onChange:function(e){A({accessibleTerminal:e})}})}),(0,a.tZ)(y.R,{}),(0,a.tZ)(eS.$,{id:"shellBellAudio",title:(0,a.BX)(a.HY,{children:[(0,a.tZ)(s.xv,{multiline:!1,children:"Shell bell audible indicator"}),(0,a.tZ)(s.xv,{variant:"small",css:[d.l0.color.foregroundDimmest],children:"Should the Shell play sounds when there is an issue like a failed tab completion?"})]}),children:(0,a.tZ)(C.r,{"aria-label":"Shell bell audible indicator",isSelected:c.shellBellAudio,onChange:function(e){A({shellBellAudio:e})}})}),(0,a.tZ)(y.R,{}),(0,a.tZ)(eS.$,{id:"webviewAutoOpenOnPortOpened",title:(0,a.BX)(a.HY,{children:[(0,a.tZ)(s.xv,{multiline:!1,children:R?"Automatic webview (unavailable in this Repl)":"Automatic webview"}),(0,a.tZ)(s.xv,{variant:"small",css:[d.l0.color.foregroundDimmest],multiline:!1,children:"Open a webview automatically when a port is open"}),R?(0,a.tZ)(u.G,{css:[d.l0.pt(8),d.l0.maxWidth("calc(100% - 12px)")],children:(0,a.tZ)(w.E,{colorway:"orange",text:'This preference is unavailable in Extension Repls. To view custom tools in dev mode, click the "Preview" button in Extension Devtools instead.'})}):null]}),children:(0,a.tZ)(C.r,{"aria-label":"Automatic Webview",isSelected:c.webviewAutoOpenOnPortOpened,isDisabled:R,onChange:function(e){A({webviewAutoOpenOnPortOpened:e})}})}),k?null:(0,a.BX)(a.HY,{children:[(0,a.tZ)(y.R,{}),(0,a.tZ)(eS.$,{id:"theme",title:"Theme",children:(0,a.tZ)(eb,{css:[d.l0.minWidth(184),d.l0.backgroundColor.backgroundHigher],context:em.HY.WorkspacePreferencesPane})})]}),G?(0,a.BX)(a.HY,{children:[(0,a.tZ)(y.R,{}),(0,a.tZ)(eS.$,{id:"chat-audio",title:(0,a.BX)(a.HY,{children:[(0,a.tZ)(s.xv,{multiline:!1,children:"Chat Audio Notifications"}),(0,a.tZ)(s.xv,{variant:"small",css:[d.l0.color.foregroundDimmest],children:"Enables playing a sound when you receive a new chat message."})]}),children:(0,a.tZ)(C.r,{"aria-label":"Chat Audio Notifications",isSelected:c.chatAudioNotification,onChange:function(e){A({chatAudioNotification:e})}})})]}):null]})}var e7=n(10981),te=n(43312),tt=n(69119),tn=n(22487),tr=n(50199),ti=n(43208),to=n(20399),ta=n(1128),tl=n(52924),tc=n(89788),ts=n(13900),tu=n(20573),td=n(46053),tf=n(25961),th=n(27308),tp=n(96003);function tm(e){var t=(0,V.useRef)(null),n=(0,V.useRef)([]);function r(){t.current&&clearTimeout(t.current),n.current=[]}function i(t){e({type:"success",shortcut:t.length>1?[t[0],t[1]]:t[0]}),r()}return{onKeyDown:function(r){var o=t.current,a=n.current;r.preventDefault(),r.stopPropagation(),o&&clearTimeout(o);var l=(0,th.lc)(r);if(l){if((0,th.ZG)(l)){e({type:"update",recorded:a.length?[a[0],l]:[l]});return}if(a.length>0&&"Enter"===l){i(a);return}a.push(l),e({type:"update",recorded:a});var c=2===a.length?0:600;t.current=setTimeout(function(){return i(a)},c)}},startRecording:function(){r(),e({type:"start"})},stopRecording:function(){r(),e({type:"stop"})}}}var tv=(0,J.X)({root:[d.l0.colWithGap(8)],row:[d.l0.rowWithGap(8),d.l0.align.center,d.l0.minHeight(28)],left:[d.l0.colWithGap(2),d.l0.flex.grow(0),d.l0.flex.shrink(1)],right:[d.l0.rowWithGap(4),d.l0.align.center,d.l0.justify.end,d.l0.position.relative,d.l0.flex.grow(1),d.l0.flex.shrink(0)],recordingRow:[d.l0.flex.column,d.l0.align.center,d.l0.justify.end],recordingRowInner:[d.l0.rowWithGap(8),d.l0.align.center],recordingRowKeys:[d.l0.position.relative],recordingRowHint:[d.l0.position.absolute,d.l0.top(20),d.l0.right(0),{fontStyle:"italic"}],recordingRowPlaceholder:[d.l0.display.flex,d.l0.align.baseline,d.l0.rowWithGap(4),{fontStyle:"italic"}],keys:[d.l0.display.inlineFlex,d.l0.rowWithGap(12)],secondaryText:[d.l0.display.flex,d.l0.flex.row,d.l0.align.center,d.l0.rowWithGap(4)],secondaryTextId:[d.l0.flex.grow(1),d.l0.flex.shrink(0)],secondaryTextDescription:[d.l0.flex.grow(0),d.l0.flex.shrink(1),d.l0.color.foregroundDimmest],buttons:[d.l0.pl(8),d.l0.display.flex,d.l0.flex.row]}),tg=[d.l0.reset.button,$.gU.listItem,d.l0.height(24),d.l0.width(24),d.l0.p(2)],ty=(0,J.X)({root:[d.l0.rowWithGap(8),d.l0.align.center],recordingRow:[d.l0.rowWithGap(4),d.l0.align.center]});function tb(e){var t,n,r,i,o=e.command,l=e.filter,c=(0,tp.r3)(),d=(0,tp.wU)(),f=(0,tp.V_)(o.id),h=(0,T._)((0,V.useState)(null),2),p=h[0],m=h[1],v=(0,T._)((0,V.useState)(null),2),g=v[0],y=v[1],Z=tm(function(e){switch(e.type){case"start":y({recorded:[]}),m(null);return;case"stop":y(null),m(null);return;case"update":y({recorded:e.recorded}),m(null);return;case"success":var t=(0,th.SG)(e.shortcut);if(!t){y(null),m(null);return}var n=c(o.id,t);if(n){y(null),m('This shortcut conflicts with "'.concat(n.conflict.name,'"'));return}y(null);return;case"error":y(function(t){var n;return{error:e.message,recorded:null!==(n=null==t?void 0:t.recorded)&&void 0!==n?n:[]}});return}}),x=Z.stopRecording,C=Z.startRecording,_=Z.onKeyDown,S=(0,tn.Z)(function(){return x()},[]),E=!!g;t_(E);var k=null!==(i=null==g?void 0:g.recorded)&&void 0!==i?i:[],R=null==g?void 0:g.error,D=l.length>0,I=null===(t=ti.Z.match(l,o.name))||void 0===t?void 0:t.ranges,G=null===(n=ti.Z.match(l,o.id))||void 0===n?void 0:n.ranges,B=(null==o?void 0:o.description)?null===(r=ti.Z.match(l,o.description))||void 0===r?void 0:r.ranges:void 0,A=(0,tr.Z)(function(){return l.replaceAll('"',"").split("-").map(function(e){return e.toLowerCase()})},[l]),P=[{label:"Remove",key:"remove"}];f&&f!==o.shortcut&&P.push({label:"Reset",key:"reset"});var N=(0,tr.Z)(function(){return function(e){switch(e){case"remove":d(o.id);break;case"reset":var t=c(o.id,f);t&&m("".concat(f,' conflicts with "').concat(t.conflict.name,'"'))}}},[o.id,f,c,d]);return(0,a.BX)(u.G,{css:tv.root,children:[(0,a.BX)(u.G,{css:tv.row,children:[(0,a.BX)(u.G,{css:tv.left,children:[(0,a.tZ)(tt.x,{text:o.name,highlight:I,dimmed:D}),(0,a.BX)(s.xv,{variant:"small",css:tv.secondaryText,multiline:!1,children:[D?(0,a.tZ)(tt.x,{css:tv.secondaryTextId,text:o.id,highlight:G,dimmed:D}):null,o.description?(0,a.BX)(a.HY,{children:[D?(0,a.tZ)(s.xv,{color:"dimmest",multiline:!1,children:""}):null,(0,a.tZ)(tt.x,{css:tv.secondaryTextDescription,text:o.description,highlight:B,dimmed:D})]}):null]})]}),(0,a.BX)(u.G,{innerRef:E?S:void 0,css:tv.right,children:[E?(0,a.tZ)(td.MT,{autoFocus:!0,restoreFocus:!0,children:(0,a.tZ)("input",{onKeyDown:_,css:{opacity:0,width:1}})}):null,o.shortcut&&!E?(0,a.tZ)(tf.bM,{small:!0,keyCombo:o.shortcut,match:A}):null,o.shortcut||E?null:(0,a.tZ)(ew.zx,{size:"small",variant:"outlined",iconLeft:(0,a.tZ)(en.Z,{}),text:"Add shortcut",onClick:function(){return C()}}),E?(0,a.tZ)(u.G,{css:tv.recordingRow,children:(0,a.BX)(u.G,{css:tv.recordingRowInner,children:[(0,a.tZ)(u.G,{css:tv.recordingRowKeys,children:k.length>0?(0,a.tZ)(u.G,{css:[tv.keys],children:k.map(function(e,t){return(0,a.tZ)(tf.bM,{small:!0,keyCombo:e},"".concat(e,"-").concat(t))})}):(0,a.tZ)(s.xv,{multiline:!1,color:"dimmest",css:tv.recordingRowPlaceholder,children:"Recording..."})}),(0,a.tZ)(b.hU,{alt:"Stop",onClick:function(){return x()},children:(0,a.tZ)(tk,{})})]})}):null,o.shortcut&&!E?(0,a.BX)(u.G,{css:tv.buttons,children:[(0,a.tZ)(b.hU,{alt:"Change",onClick:function(){return C()},children:(0,a.tZ)(tl.Z,{})}),(0,a.tZ)(to.ZE,{"aria-label":"More",cssProps:tg,items:P,icon:(0,a.tZ)(ts.Z,{size:12}),placement:"bottom-end",onAction:N,children:P.map(function(e){return(0,a.tZ)(to.ck,{textValue:e.label,children:(0,a.tZ)(s.xv,{multiline:!1,children:e.label})},e.key)})})]}):null]})]}),R?(0,a.tZ)(w.E,{icon:(0,a.tZ)(tu.Z,{}),colorway:"warning",text:R,closable:!0,closeAction:function(){return y(function(e){var t;return{recorded:null!==(t=null==e?void 0:e.recorded)&&void 0!==t?t:[]}})}}):null,p?(0,a.tZ)(w.E,{icon:(0,a.tZ)(tu.Z,{}),colorway:"warning",text:p,closable:!0,closeAction:function(){return m(null)}}):null]})}function tZ(e){var t=e.flat();return t.length>1?t.map(function(e){return tZ([e])}).join(" "):(0,th.QR)(t[0]).map(function(e){return'"'.concat(e,'"')}).join("-").replaceAll(" ","space")}var tw=(0,J.X)({root:[d.l0.colWithGap(8),d.l0.p(0)],surface:[d.l0.pt(8),d.l0.borderRadius(8),d.l0.colWithGap(12)]});function tx(e){var t=(0,T._)((0,V.useState)(""),2),n=t[0],r=t[1];function i(t){r(t),V.startTransition(function(){return e.onSearch(t)})}var o=(0,V.useRef)(null),l=(0,T._)((0,V.useState)(!1),2),c=l[0],d=l[1];t_(c);var f=tm(function(e){var t,n,r;switch(e.type){case"start":d(!0),i(""),null==o||null===(t=o.current)||void 0===t||t.focus();return;case"stop":case"error":d(!1),null==o||null===(n=o.current)||void 0===n||n.focus(),null==o||null===(r=o.current)||void 0===r||r.select();return;case"success":i(tZ([e.shortcut]));return;case"update":i(tZ(e.recorded));return}}),h=f.stopRecording,p=f.startRecording,m=f.onKeyDown;return(0,a.BX)(u.G,{css:ty.root,children:[(0,a.tZ)(td.MT,{children:(0,a.tZ)(ex.II,{ref:o,placeholder:c?"Recording keys. Press Escape to exit":"Type to search keyboard shortcuts",onBlur:c?h:void 0,onChange:function(e){i(e.currentTarget.value)},onKeyDown:c?function(e){"Escape"===e.key?h():m(e)}:void 0,value:n})}),(0,a.tZ)(u.G,{css:ty.recordingRow,children:c?(0,a.BX)(a.HY,{children:[(0,a.tZ)(s.xv,{color:"dimmest",css:[{fontStyle:"italic"}],multiline:!1,children:"Recording..."}),(0,a.tZ)(b.hU,{alt:"Stop Recording",onClick:h,children:(0,a.tZ)(tk,{})})]}):(0,a.tZ)(b.hU,{alt:"Record Keys",onClick:p,children:(0,a.tZ)(tc.Z,{})})}),(0,a.tZ)(b.hU,{alt:"Clear Input",disabled:0===n.length,onClick:function(){var e;i(""),null==o||null===(e=o.current)||void 0===e||e.focus()},children:(0,a.tZ)(e_.Z,{})})]})}function tC(){var e=(0,T._)((0,V.useState)(""),2),t=e[0],n=e[1],r=(0,tp.xF)(),i=(0,tr.Z)(function(){return(0,f._)(r.values())},[r]),o=(0,V.useMemo)(function(){return ti.Z.filter(t,i,{extract:function(e){var t="".concat(e.name," ").concat(e.id);return e.description&&(t+=" ".concat(e.description)),e.shortcut&&(t+=" ".concat(tZ([e.shortcut]))),t}})},[t,i]);return(0,a.BX)(u.G,{css:tw.root,children:[(0,a.tZ)(tx,{onSearch:n}),o.length>0?(0,a.tZ)(x.Tg,{css:tw.surface,children:o.map(function(e,n){return(0,a.BX)(V.Fragment,{children:[n>0?(0,a.tZ)(x.Tg,{elevated:!0,style:{height:1}}):null,(0,a.tZ)(tb,{command:e.original,filter:t})]},e.original.id)})}):null]})}function t_(e){var t="You have unsaved changes";(0,V.useEffect)(function(){var n=function(e){return e.preventDefault(),e.returnValue=t,t};if(e)return window.addEventListener("beforeunload",n),function(){window.removeEventListener("beforeunload",n)}},[e])}var tS=(0,te.F4)("0%{transform:scale(1);}40%{transform:scale(1.3);}100%{transform:scale(1);}"),tE=(0,J.X)({background:[{animationName:tS,animation:"".concat(tS," 2s cubic-bezier(0.4, 0, 0.6, 1) infinite"),boxShadow:"0 0 10px ".concat(d.TV.redStronger)},d.l0.height(11),d.l0.width(11),d.l0.borderRadius("full"),d.l0.position.absolute],container:[d.l0.position.relative,d.l0.align.center,d.l0.justify.center],icon:[{zIndex:1}]});function tk(){return(0,a.BX)(u.G,{css:tE.container,children:[(0,a.tZ)(ta.Z,{css:tE.icon,color:d.TV.redStronger}),(0,a.tZ)(u.G,{css:tE.background})]})}function tT(){var e=(0,e7.U)()("keyboard_shortcuts");return(0,a.BX)(x.Tg,{background:"default",css:[d.l0.px(16),d.l0.pb(16),d.l0.colWithGap(12)],children:[(0,a.tZ)(u.G,{tag:"label",htmlFor:e}),(0,a.tZ)(tC,{})]})}function tR(e){var t=e.hideLayoutControl,n=e.resetLayout,r=(0,l.T3)();return(0,a.BX)(a.HY,{children:[(0,a.BX)(u.G,{css:[d.l0.flex.column,d.l0.justify.center,d.l0.px(16),d.l0.py(8)],children:[(0,a.tZ)(s.h4,{variant:"subheadBig",level:3,children:"User Settings"}),(0,a.tZ)(s.xv,{variant:"small",css:[{fontStyle:"italic"},d.l0.color.foregroundDimmer],children:"The following settings apply to your account and will be used across all your Repls."})]}),r?(0,a.tZ)(e9,{hideLayoutControl:t,resetLayout:n}):(0,a.tZ)(u.G,{children:(0,a.BX)(c.mQ,{css:[{width:"100%"}],children:[(0,a.BX)(c.td,{withDividers:!1,css:[{"[aria-selected=true]":[d.l0.fontWeight.medium]}],children:[(0,a.tZ)(c.OK,{css:[d.l0.py(8),d.l0.px(16)],children:"Editor preferences"}),(0,a.tZ)(c.OK,{css:[d.l0.py(8),d.l0.px(16)],children:"Keyboard shortcuts"})]}),(0,a.BX)(c.nP,{children:[(0,a.tZ)(c.x4,{children:(0,a.tZ)(e9,{resetLayout:n})}),(0,a.tZ)(c.x4,{children:(0,a.tZ)(tT,{})})]})]})})]})}},5344:function(e,t,n){n.d(t,{BZ:function(){return _},HX:function(){return x},WM:function(){return k},ap:function(){return A},gF:function(){return D},l9:function(){return T},vi:function(){return G},zu:function(){return E}});var r=n(41733),i=n(21262),o=n(71440),a=n(78747),l=n(11707),c=n(83436),s=n(63204),u=n(51780),d=n(56353),f=n(58995),h=n(99165);function p(){var e=(0,i._)(["\n  fragment WorkspaceHeaderReplInfoRepl on Repl {\n    id\n    title\n    rawTemplateLabel: templateLabel(disableFallbackToTitle: true)\n    description\n    isPrivate\n    isRenamed\n    url\n    slug\n    workspaceCta\n    lastPublishedAt\n    publishedAs\n    owner {\n      ... on Team {\n        id\n      }\n      ... on User {\n        id\n      }\n    }\n    currentUserPermissions {\n      containerAttach\n      changeIconUrl\n      changeTemplateLabel\n      changeTitle\n      changeDescription\n      changePrivacy\n      delete\n      changeAlwaysOn\n      publish\n      fork\n    }\n    hostingDeployment {\n      ... on HostingDeployment {\n        id\n        currentBuild {\n          id\n        }\n      }\n    }\n    hostingDeploymentPermissions {\n      canDeploy\n    }\n    user {\n      id\n      image\n      ...UserLinkUser\n    }\n    ...WorkspaceHeaderReplMetadataRepl\n    ...ReplEnvironmentWebviewRepl\n    ...PublishReleaseFormRepl\n    ...BulkDeleteConfirmationModalRepl\n  }\n  ","\n  ","\n  ","\n  ","\n  ","\n"]);return p=function(){return e},e}function m(){var e=(0,i._)(["\n  query WorkspaceHeaderReplInfo($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        ...WorkspaceHeaderReplInfoRepl\n      }\n    }\n  }\n  ","\n"]);return m=function(){return e},e}function v(){var e=(0,i._)(["\n  query CurrentUserStates {\n    currentUser {\n      __typename\n      ... on CurrentUser {\n        id\n      }\n    }\n  }\n"]);return v=function(){return e},e}function g(){var e=(0,i._)(["\n  query ReplPowerUpStatus {\n    currentUser {\n      __typename\n      ... on CurrentUser {\n        id\n        userPowerUpsByType {\n          ... on UserPowerUpsTypes {\n            privateRepls {\n              active\n              cost {\n                cycles\n                explanation\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n"]);return g=function(){return e},e}function y(){var e=(0,i._)(["\n  mutation WorkspaceHeaderReplInfoUnpublishTemplate(\n    $input: DeleteReplDeploymentInput!\n  ) {\n    deleteReplDeployment(input: $input) {\n      ... on Repl {\n        id\n        ...PublishReplData\n      }\n    }\n  }\n  ","\n"]);return y=function(){return e},e}function b(){var e=(0,i._)(["\n  mutation WorkspaceHeaderReplInfoUpdateRepl($input: UpdateReplInput!) {\n    updateRepl(input: $input) {\n      repl {\n        id\n        ...WorkspaceHeaderReplInfoRepl\n      }\n    }\n  }\n  ","\n"]);return b=function(){return e},e}function Z(){var e=(0,i._)(["\n  mutation WorkspaceHeaderReplInfoDeleteRepl($id: String!) {\n    deleteRepl(id: $id) {\n      id\n    }\n  }\n"]);return Z=function(){return e},e}var w={},x=(0,o.Ps)(p(),a._,l.s,c.sY,s.wd,u.d),C=(0,o.Ps)(m(),x);function _(e){var t=(0,r._)({},w,e);return f.a(C,t)}var S=(0,o.Ps)(v());function E(e){var t=(0,r._)({},w,e);return f.a(S,t)}var k=(0,o.Ps)(g());function T(e){var t=(0,r._)({},w,e);return f.a(k,t)}var R=(0,o.Ps)(y(),d.FW);function D(e){var t=(0,r._)({},w,e);return h.D(R,t)}var I=(0,o.Ps)(b(),x);function G(e){var t=(0,r._)({},w,e);return h.D(I,t)}var B=(0,o.Ps)(Z());function A(e){var t=(0,r._)({},w,e);return h.D(B,t)}},32604:function(e,t,n){n.d(t,{Z:function(){return e3}});var r=n(41733),i=n(30509),o=n(66626),a=n(74985),l=n(76999),c=n.n(l),s=n(43182),u=n(50959),d=n(14819),f=n(38889),h=n(46835),p=n(60427),m=n(56337),v=n(68399),g=n(7444),y=n(55534),b=n(50782),Z=n(6189),w=n(22004),x=n(59868),C=n(73614),_=n(4895),S=n(27387),E=n(42516),k=n(96583),T=n(72310),R=n(21262),D=n(71440),I=n(58995);function G(){var e=(0,R._)(["\n  query PendingChanges($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        deployment {\n          id\n          activeRelease {\n            id\n            pendingChanges {\n              fileName\n              changeType\n            }\n          }\n        }\n      }\n    }\n  }\n"]);return G=function(){return e},e}var B={},A=(0,D.Ps)(G()),P=n(1498),N=n(60769),U=n(18836),O=n(57468),L=n(37951),M=n(74833),X=n(30983),F=n(56596),W=n(88936),H=n(81799),V=n(20573),z=n(29287),j=n(10981),q=n(56412),Y=n(75582),$=n(73524),J=n(19659),K=n(63204),Q=n(48459),ee=n(66555),et=n(99165);function en(){var e=(0,R._)(["\n  mutation RevertTemplateRelease($input: RevertReplReleaseInput!) {\n    revertReplRelease(input: $input) {\n      ... on Repl {\n        id\n      }\n      ... on UserError {\n        message\n      }\n      ... on NotFoundError {\n        message\n      }\n      ... on UnauthorizedError {\n        message\n      }\n    }\n  }\n"]);return en=function(){return e},e}var er={},ei=(0,D.Ps)(en()),eo=F.K.form;function ea(e){if(0===e.length)return{message:"You cannot leave this empty."}}function el(e){var t,n,r=e.changeType;return r===Y.J5.NewFile?(t=z.TV.accentPositiveStronger,n="Added"):r===Y.J5.DeletedFile?(t=z.TV.accentNegativeStronger,n="Deleted"):(t=z.TV.foregroundDefault,n="Changed"),(0,a.tZ)(M.xv,{variant:"small",css:[{color:t}],multiline:!1,children:n})}function ec(e){var t=e.pendingChangesState,n=e.isReplitTemplate;if(t.loading)return(0,a.tZ)(F.G,{css:[z.l0.center],children:(0,a.tZ)(W.Z,{})});if(t.error)return(0,a.tZ)(L.E,{icon:(0,a.tZ)(V.Z,{}),text:t.error.message||"Could not load modified files - please try again.",colorway:"negative"});if(!t.pendingChanges||0===t.pendingChanges.length)return n?null:(0,a.tZ)(M.xv,{children:"No changes to publish. Come back when you have made changes to your Repl."});var r=t.pendingChanges,i=r.slice(0,15);return(0,a.BX)(F.G,{css:[{display:"grid",gridTemplateColumns:"1fr 1fr",gap:z.TV.space8}],children:[i.map(function(e){return(0,a.BX)(u.Fragment,{children:[(0,a.BX)(F.G,{css:[z.l0.rowWithGap(4),z.l0.align.center],children:[(0,a.tZ)(O.Z,{size:12,path:e.fileName}),(0,a.tZ)(M.xv,{multiline:!1,children:e.fileName})]},e.fileName),(0,a.tZ)(el,{changeType:e.changeType})]},e.fileName)}),r.length>i.length&&(0,a.BX)(M.xv,{multiline:!1,children:["And ",r.length-i.length," other files..."]})]})}function es(e){var t,n=e.repl,i=function(){var e,t=(0,o._)((e=(0,r._)({},er,{refetchQueries:["ReplEnvironmentHeader"]}),et.D(ei,e)),2),n=t[0];function i(){return(i=(0,S._)(function(e){var t;return(0,k.Jh)(this,function(r){switch(r.label){case 0:return[4,n({variables:{input:e.input}})];case 1:return[2,{data:(t=r.sent()).data,error:function(e){if(!e.data)return null;var t=e.data;if("revertReplRelease"in t){if("NotFoundError"===t.revertReplRelease.__typename||"UnauthorizedError"===t.revertReplRelease.__typename||"UserError"===t.revertReplRelease.__typename)return t.revertReplRelease.message;if("Repl"!==t.revertReplRelease.__typename)return"Something went wrong reverting your Template"}}(t)}]}})})).apply(this,arguments)}return{revertTemplateRelease:function(e){return i.apply(this,arguments)},state:t[1]}}(),l=(t=(0,S._)(function(e){return(0,k.Jh)(this,function(t){switch(t.label){case 0:return[4,i.revertTemplateRelease({input:{replId:n.id,releaseId:e}})];case 1:return t.sent(),[2]}})}),function(e){return t.apply(this,arguments)});return(0,a.BX)(F.G,{children:[(0,a.tZ)(M.h4,{level:1,variant:"subheadBig",css:[z.l0.mb(16)],children:"Existing Releases"}),(0,a.tZ)(F.G,{css:[{display:"grid",gridTemplateColumns:"2fr 3fr 1fr",gap:z.TV.space8}],children:n.releases.items.map(function(e){var t,r;return(0,a.BX)(u.Fragment,{children:[(0,a.tZ)("span",{children:(0,q.Z)(new Date(e.timeCreated),"do MMM, hh:mm a")}),(0,a.tZ)("span",{children:e.description}),(0,a.tZ)("span",{style:{justifySelf:"end"},children:e.id===(null===(r=n.deployment)||void 0===r?void 0:null===(t=r.activeRelease)||void 0===t?void 0:t.id)?(0,a.tZ)("span",{css:[z.l0.p(4),{display:"flex"}],children:"(active)"}):(0,a.tZ)(P.zx,{text:"revert",colorway:"primary",size:"small",onClick:function(){l(e.id)}})})]},e.id)})})]})}function eu(e){var t=e.children;return(0,a.tZ)(F.G,{css:[z.l0.rowWithGap(8),z.l0.py(2)],children:t})}function ed(e){var t,n,l,c,s,d,f,h,p,m=e.repl,v=(0,j.U)(),g=(0,o._)((0,u.useState)(!1),2),y=g[0],b=g[1],Z=(0,o._)((0,u.useState)(!1),2),w=Z[0],x=Z[1],C=(t=function(e){var t,n,i,o,a=(i={variables:{replId:e.replId},fetchPolicy:"cache-and-network",ssr:!1},o=(0,r._)({},B,i),I.a(A,o)),l=a.data,c=a.loading,s=a.error;if(c)return{loading:c,pendingChanges:null,error:null};if(s)return{loading:!1,pendingChanges:null,error:s};var u=(null==l?void 0:l.repl.__typename)==="Repl"?l.repl:null;return u?{loading:!1,pendingChanges:(null===(n=u.deployment)||void 0===n?void 0:null===(t=n.activeRelease)||void 0===t?void 0:t.pendingChanges)||[],error:s}:{loading:!1,pendingChanges:null,error:Error("Repl not found")}}({replId:{replId:m.id}.replId}),n=(0,u.useMemo)(function(){return t.pendingChanges?t.pendingChanges.slice().sort(function(e,t){return e.fileName.localeCompare(t.fileName)}).map(function(e){return{file:e,pathDepth:(0,J.U$)(e.fileName)}}).sort(function(e,t){return e.pathDepth-t.pathDepth}).map(function(e){return e.file}):[]},[t.pendingChanges]),(0,i._)((0,r._)({},t),{pendingChanges:n})),_=(0,ee.r)(),R=(0,T.Y)("",ea),D=(null===(c=C.pendingChanges)||void 0===c?void 0:c.length)!==0,G=(null===(s=m.user)||void 0===s?void 0:s.username)===$.IU||(null===(d=m.user)||void 0===d?void 0:d.username)==="templates",N=(0,o._)((0,u.useState)({ran:!1,tested:!1}),2),O=N[0],W=N[1];(0,u.useEffect)(function(){W({ran:!1,tested:!1})},[W]);var q=!!(R.error||!G&&!D||_.loading||G&&(!O.ran||!O.tested)),Y=G&&(null===(h=m.releases)||void 0===h?void 0:null===(f=h.items)||void 0===f?void 0:f.length)>1,K="";return(R.error?K="Please fill out the form":G||D||(K="No changes to publish in this release"),y)?(0,a.tZ)(Q.q,{repl:m,isUpdate:!0}):w?(0,a.tZ)(F.G,{css:[z.l0.p(16),z.l0.colWithGap(16)],children:(0,a.tZ)(es,{repl:m})}):(0,a.BX)(eo,{onSubmit:(l=(0,S._)(function(e){return(0,k.Jh)(this,function(t){switch(t.label){case 0:if(e.preventDefault(),q||R.validate())return[2];return[4,_.createRelease({input:{replId:m.id,description:R.value}})];case 1:if(t.sent().error)return[2];return b(!0),[2]}})}),function(e){return l.apply(this,arguments)}),css:[z.l0.colWithGap(24),z.l0.p(16)],children:[(0,a.tZ)(M.h4,{level:1,variant:"headerDefault",children:"Publish a new release"}),(0,a.BX)(F.G,{css:[z.l0.colWithGap(8)],children:[(0,a.tZ)(M.h4,{level:2,variant:"subheadDefault",children:"Modified files"}),(0,a.tZ)(ec,{pendingChangesState:C,isReplitTemplate:G})]}),G||D?(0,a.BX)(F.G,{css:[z.l0.colWithGap(4)],children:[(0,a.tZ)("label",{htmlFor:v("description"),css:[z.l0.color.foregroundDimmer,{fontSize:z.TV.fontSizeSmall,lineHeight:z.TV.lineHeightSmall}],children:"Description"}),(0,a.tZ)(U.B,{id:v("description"),"aria-label":"Description",onChange:function(e){return R.setValue(e.target.value)},css:[z.l0.width("100%"),z.l0.minHeight(64),z.l0.maxHeight(128),{resize:"vertical"}],placeholder:"Explain what has changed about your template"}),R.error?(0,a.tZ)(L.E,{icon:(0,a.tZ)(V.Z,{}),text:null===(p=R.error)||void 0===p?void 0:p.message,colorway:"negative"}):null]}):null,G?(0,a.tZ)(ef,{repl:m,state:O,onChange:function(e,t){return W(function(n){return(0,i._)((0,r._)({},n),(0,E._)({},e,t))})}}):null,(0,a.tZ)(F.G,{children:_.error?(0,a.tZ)(L.E,{icon:(0,a.tZ)(V.Z,{}),text:_.error,colorway:"negative"}):null}),(0,a.BX)(F.G,{css:[z.l0.rowWithGap(12),z.l0.justify.end],children:[Y?(0,a.tZ)(P.zx,{text:"Revert to older",colorway:"negative",onClick:function(){return x(!0)}}):null,(0,a.tZ)(X.u,{tooltip:K,placement:"bottom",isDisabled:!K,children:(0,a.tZ)(P.zx,{text:"Publish release",type:"submit",colorway:"primary",iconLeft:(0,a.tZ)(H.Z,{}),disabled:q})})]})]})}function ef(e){var t,n,r,i=e.repl,o=e.state,l=e.onChange,c=(0,j.U)(),s=(0,K.e9)(),u=s.data,d=s.loading,f=null==u?void 0:null===(t=u.currentUser)||void 0===t?void 0:t.username;return(0,a.BX)(F.G,{css:[z.l0.colWithGap(12)],children:[(0,a.tZ)(M.h4,{level:2,children:"Official Replit Template publishing checklist"}),(0,a.BX)(F.G,{children:[(0,a.BX)(eu,{children:[(0,a.tZ)(N.X,{id:c("ran"),checked:o.ran,onChange:function(e){return l("ran",e.target.checked)}}),(0,a.tZ)("label",{htmlFor:c("ran"),children:"Ran Repl:"}),(0,a.BX)("span",{children:["I ran the Repl to generate and cache package guesser result into"," ",(0,a.tZ)("code",{children:".upm"}),"."]})]}),(0,a.BX)(eu,{children:[(0,a.tZ)(N.X,{id:c("tested"),checked:o.tested,onChange:function(e){return l("tested",e.target.checked)}}),(0,a.tZ)("label",{htmlFor:c("tested"),children:"Ran tests:"}),(0,a.BX)("span",{children:['I ran "Test working copy" for @',null===(n=i.user)||void 0===n?void 0:n.username,"/",i.slug," in"," ",(0,a.tZ)("a",{href:"https://template-tester.replit.app/",target:"_blank",children:"template tester"}),". ",(0,a.tZ)("br",{}),"If there are no tests, consider adding one."]})]})]}),d||(null===(r=i.user)||void 0===r?void 0:r.username)!==f?null:(0,a.tZ)(L.E,{text:"You can't publish an update while impersonating. Add yourself as a member of the 'replit' team using CLUI tool 'add-remove-team-member', then open this Repl from your account.",colorway:"negative"})]})}var eh=n(25061),ep=n(5693),em=n(5315),ev=n(15053),eg=n(59639),ey=n(49344),eb=n(38080),eZ=n(29479),ew=n(7877),ex=n(39390),eC=n(97411),e_=n(78272),eS=n(47611),eE=n(40028),ek=n(5344),eT=n(78066),eR=n(85805),eD=n(43973),eI=n(52924),eG=n(6620),eB=n(35972),eA=n(88205);function eP(e){var t=(0,u.useRef)(null),n=(0,o._)((0,u.useState)(e.value),2),r=n[0],i=n[1],l=(0,o._)((0,u.useState)(null),2),s=l[0],d=l[1],f=(0,eR.Z)({onUpload:function(t){var n=t.url;e.onChange(n)},onUploadPreview:function(e){i(e.dataUrl)},onError:function(e){d(e.message)}});(0,u.useEffect)(function(){i(e.value)},[e.value]);var h=null==r?void 0:r.startsWith("data:");return(0,a.BX)(eB.gC,{spacing:"var(--space-4)",children:[(0,a.BX)("div",{onClick:function(){var e;null===(e=t.current)||void 0===e||e.click()},"aria-label":r?"Change icon":"Upload an icon","data-microtip-position":"right",role:"tooltip",className:c().dynamic([["649b73688aef77e0",[32,32]]])+" "+((r?"update-icon":"add-icon")||""),children:[r?(0,a.BX)(a.HY,{children:[(0,a.tZ)(eT.Z,{iconUrl:r,size:32,alt:"icon"}),h?(0,a.tZ)("div",{className:c().dynamic([["649b73688aef77e0",[32,32]]])+" loading-state",children:(0,a.tZ)("div",{className:c().dynamic([["649b73688aef77e0",[32,32]]])+" loading-icon",children:(0,a.tZ)(W.Z,{})})}):(0,a.tZ)("div",{className:c().dynamic([["649b73688aef77e0",[32,32]]])+" hover-state",children:(0,a.tZ)(eI.Z,{})})]}):(0,a.tZ)(eG.Z,{}),(0,a.tZ)("input",{ref:t,accept:eD.W9.join(","),type:"file",onChange:function(e){var t=e.target,n=t.validity,r=t.files;n.valid&&(null==r?void 0:r.length)&&(d(null),f.uploadImage(r[0],eA.N.TemplateIcon))},className:c().dynamic([["649b73688aef77e0",[32,32]]])})]}),s?(0,a.tZ)("div",{className:c().dynamic([["649b73688aef77e0",[32,32]]])+" error",children:s}):null,(0,a.tZ)(c(),{id:"649b73688aef77e0",dynamic:[32,32],children:".add-icon.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;border:1px dashed var(--foreground-dimmest);background-color:var(--background-root);width:".concat(32,"px;height:").concat(32,"px}.add-icon.__jsx-style-dynamic-selector:hover{color:var(--accent-primary-default);border-color:var(--accent-primary-default)}.add-icon.__jsx-style-dynamic-selector,.update-icon.__jsx-style-dynamic-selector{position:relative;cursor:pointer;background-color:var(--background-higher);-webkit-border-radius:var(--border-radius-4);-moz-border-radius:var(--border-radius-4);border-radius:var(--border-radius-4);padding:2px}.update-icon.__jsx-style-dynamic-selector:hover .hover-state.__jsx-style-dynamic-selector{opacity:.8}.hover-state.__jsx-style-dynamic-selector{opacity:0}.loading-state.__jsx-style-dynamic-selector{opacity:.8}.loading-icon.__jsx-style-dynamic-selector{-webkit-animation:rotate 1s linear infinite;-moz-animation:rotate 1s linear infinite;-o-animation:rotate 1s linear infinite;animation:rotate 1s linear infinite;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center}@-webkit-keyframes rotate{from{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-moz-keyframes rotate{from{-moz-transform:rotate(0deg);transform:rotate(0deg)}to{-moz-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes rotate{from{-o-transform:rotate(0deg);transform:rotate(0deg)}to{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes rotate{from{-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-o-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}.hover-state.__jsx-style-dynamic-selector,.loading-state.__jsx-style-dynamic-selector{color:var(--accent-primary-default);position:absolute;top:0;left:0;width:100%;height:100%;-webkit-border-radius:var(--border-radius-4);-moz-border-radius:var(--border-radius-4);border-radius:var(--border-radius-4);background-color:var(--background-root);overflow:hidden;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center}input.__jsx-style-dynamic-selector{opacity:0;position:absolute;top:0;left:0;width:100%;height:100%;z-index:-1}.error.__jsx-style-dynamic-selector{font-size:var(--font-size-default);color:var(--accent-negative-default)}")})]})}var eN=n(25770),eU=n(79378),eO=n(70002),eL=n(15146),eM=n(5542),eX=n(74883),eF=n(58719),eW=n(80339),eH=n(98859),eV=n(8271),ez=n(52682),ej=n(48528),eq=n(89106),eY=n(20399),e$=n(93918),eJ=n(8017),eK=n(13900),eQ=n(31811),e0=n(92611),e1=(0,e$.X)({destructiveMenuItem:[z.l0.color.accentNegativeStronger]});function e2(e){var t=e.repl,n=(0,m.Z)(),o=(0,u.useMemo)(function(){return t.user?{text:t.user.username,css:[{"&, & span":z.l0.flex.shrink(1)}],iconLeft:(0,a.tZ)(eU.q,{src:t.user.image,username:t.user.username})}:{text:""}},[t]);if(!t.user)return null;var l=(0,eM.Ru)(t.user);return n?(0,a.tZ)(P.zx,(0,i._)((0,r._)({},o),{onClick:function(){eq.X.openExternalUrl(l.as)}})):(0,a.tZ)(eO.Z,(0,i._)((0,r._)({},o,l),{prefetch:!1}))}function e8(e){var t=e.setActiveDialog,n=e.repl,o=e.isTemplate,l=e.updateIconUrl,c=e.showCloseButton,s=e.setIsEditing,u=e.updateReplInfo,d=(0,eQ.Z)(),h=!!n.publishedAs,p=n.currentUserPermissions.publish,v=(0,m.Z)(),g=!(null==n?void 0:n.publishedAs)&&!v,y=(null==n?void 0:n.publishedAs)===Y.O2.RegularRepl,b=(0,f.g)().fork,Z=[];n.currentUserPermissions.fork&&Z.push({value:e0.$.Fork,label:"Fork",icon:(0,a.tZ)(eV.Z,{})}),n.publishedAs===Y.O2.RegularRepl&&p&&!v&&Z.push({value:e0.$.Unpublish,label:"Unpublish",icon:(0,a.tZ)(eH.Z,{})}),o&&p&&!v&&Z.push({value:e0.$.UnpublishTemplate,label:"Unpublish template",icon:(0,a.tZ)(eH.Z,{})}),h&&p&&!v&&Z.push({value:e0.$.EditPublishSettings,label:"Edit Publish Settings",icon:(0,a.tZ)(eI.Z,{})}),n.currentUserPermissions.delete&&Z.push({isDestructive:!0,value:e0.$.Delete,label:"Delete",icon:(0,a.tZ)(ez.Z,{})});var w=(null==n?void 0:n.isPrivate)||!(null==n?void 0:n.isRenamed),x="";return(null==n?void 0:n.isPrivate)?x="This Repl is private. You need to make it public in order to publish it!":(null==n?void 0:n.isRenamed)||(x="You need to give this Repl a name before publishing it."),(0,a.BX)(F.G,{css:[z.l0.colWithGap(8),z.l0.p(8)],children:[(0,a.BX)(F.G,{css:[z.l0.rowWithGap(8),z.l0.align.center,z.l0.justify.spaceBetween,(0,E._)({},z.BC.max("mobileMax"),[z.l0.flex.columnReverse,z.l0.align.start,{gap:z.TV.space8}])],children:[(0,a.BX)(F.G,{css:[z.l0.rowWithGap(8),z.l0.center,z.l0.flex.shrink(1)],children:[(0,a.tZ)(e2,{repl:n}),n.currentUserPermissions.changeIconUrl&&o?(0,a.tZ)(eP,{value:n.iconUrl,onChange:l}):null]}),(0,a.BX)(F.G,{css:[z.l0.align.center,z.l0.rowWithGap(8),(0,E._)({},z.BC.max("mobileMax"),{width:"100%",">*:not(div)":{flex:1}})],children:[v?null:(0,a.tZ)(eO.Z,(0,i._)((0,r._)({prefetch:!1},(0,eN.j3)(n)),{iconLeft:(0,a.tZ)(eW.Z,{}),colorway:"primary",text:"Cover page",target:"_blank"})),p&&g&&!d?(0,a.tZ)(X.u,{tooltip:x,isDisabled:!w,children:(0,a.tZ)(P.zx,{type:"button",iconLeft:(0,a.tZ)(eG.Z,{}),onClick:function(){t(e0.x.Publish)},dataCy:"ws-publish-button",text:"Publish",disabled:w})}):null,o&&!v?(0,a.tZ)(P.zx,{type:"button",iconLeft:(0,a.tZ)(eG.Z,{}),onClick:function(){return t(e0.x.UpdatePublishedTemplate)},text:"Update"}):null,y&&!v?(0,a.tZ)(P.zx,{type:"button",iconLeft:(0,a.tZ)(eX.Z,{}),onClick:function(){return t(e0.x.UpdatePublishedRepl)},text:"Update"}):null,v?(0,a.tZ)(ej.j,{textToCopy:window.location.href,alt:"Copy Repl URL",tooltip:"Copied!",tooltipPlacement:"bottom-end",timeout:2e3,children:(0,a.tZ)(eJ.Z,{})}):null,Z.length>0&&(0,a.tZ)(eY.ZE,{icon:(0,a.tZ)(eK.Z,{size:16}),"aria-label":o?"Template Actions":"Repl Actions",cssProps:[z.l0.backgroundColor.backgroundDefault],placement:"bottom-end",onAction:function(e){switch(e){case e0.$.Fork:b();return;case e0.$.Unpublish:t(e0.x.Unpublish);return;case e0.$.UnpublishTemplate:t(e0.x.UnpublishTemplate);return;case e0.$.Delete:t(e0.x.DeleteRepl);return;case e0.$.EditPublishSettings:t(e0.x.EditPublishSettings)}},children:Z.map(function(e){return(0,a.tZ)(eY.ck,{children:(0,a.BX)(F.G,{css:[z.l0.rowWithGap(8),e.isDestructive&&e1.destructiveMenuItem],children:[e.icon,(0,a.tZ)(F.G,{children:e.label})]})},e.value)})}),c?(0,a.tZ)(eL.hU,{alt:"Close",tooltipHidden:!0,onClick:function(){u(),s(!1)},children:(0,a.tZ)(eF.Z,{})}):null]})]}),n.lastPublishedAt&&p?(0,a.BX)(M.xv,{variant:"small",color:"dimmest",multiline:!1,children:["Last published on"," ",new Date(n.lastPublishedAt).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})]}):null]})}var e4={query:v.s8};function e3(e){var t=e.setIsEditing,n=e.showCloseButton,r=e.onDeployClick,i=(0,b.Z)(),o=(0,ek.BZ)({variables:{replId:i}}),l=o.data,c=o.refetch,s=(null==l?void 0:l.repl.__typename)==="Repl"?l.repl:null;return s?(0,a.tZ)(e5,{setIsEditing:t,showCloseButton:n,repl:s,refetch:c,onDeployClick:r}):(0,a.tZ)(F.G,{css:[z.l0.center,z.l0.p(16)],children:(0,a.tZ)(W.Z,{})})}function e5(e){var t,n,l,v=e.repl,b=e.showCloseButton,S=e.setIsEditing,E=e.onDeployClick,k=(0,eS.useRouter)(),T=(0,m.Z)(),R=(0,o._)((0,u.useState)(null),2),D=R[0],I=R[1],G=(0,o._)((0,u.useState)(v.isRenamed?v.title:""),2),B=G[0],A=G[1],N=(0,o._)((0,u.useState)(v.description||""),2),O=N[0],X=N[1],W=(0,o._)((0,u.useState)(v.rawTemplateLabel),2),H=W[0],V=W[1],q=(0,ek.zu)().data,$=(0,y.Z)().showError,J=v.publishedAs===Y.O2.Template;(0,u.useEffect)(function(){X(v.description||"")},[v.description]);var K=(0,C.Z)(),Q=(0,u.useRef)(v),ee=(0,o._)((0,ek.ap)({variables:{id:v.id},onCompleted:function(){if(T){k.push("/desktopApp/home");return}k.push("/home","/~")},update:function(e,t){var n;(null===(n=t.data)||void 0===n?void 0:n.deleteRepl)&&(e.evict({id:e.identify(t.data.deleteRepl)}),e.gc())},onError:function(e){return $((0,Z.Z)(e.message))}}),2),et=ee[0],en=ee[1].loading,er=(0,o._)((0,ek.vi)({onError:function(e){return $((0,Z.Z)(e.message))},onCompleted:function(e){var t=e.updateRepl.repl,n=Q.current,r={};n.description!==t.description&&(r.description=t.description),n.title!==t.title&&(r.title=t.title),n.url!==t.url&&(r.url=t.url,k.push({pathname:K,query:{replUrl:t.url}},t.url+window.location.search+window.location.hash)),n.isRenamed!==t.isRenamed&&(r.isRenamed=!!t.isRenamed),Q.current=v,Object.keys(r).length>0&&S(!1)}}),2),ei=er[0],eo=er[1].loading,ea=(0,o._)((0,ek.gF)({variables:{input:{replId:v.id}},onError:function(e){s.Tb(e),$((0,Z.Z)(e.message))}}),2),el=ea[0],ec=ea[1],es=(0,ek.l9)({fetchPolicy:"cache-and-network",ssr:!1}),eu=es.data,ef=es.loading,eT=es.error,eR=(0,u.useMemo)(function(){return!!B&&B!==v.title||H!==v.rawTemplateLabel||(""!==O||!!v.description)&&O!==v.description},[v,B,O,H]),eD=(0,g.Z)(eR),eI=(0,u.useCallback)(function(){eR&&ei({variables:{input:{id:v.id,title:B.trim()||v.title,description:O,templateLabel:v.currentUserPermissions.changeTemplateLabel?H:void 0}}})},[eR,ei,v,B,O,H]),eG=(0,g.Z)(eI);(0,u.useLayoutEffect)(function(){return function(){eD.current&&eG.current()}},[eG,eD]);var eB=(0,u.useCallback)(function(e){switch(e){case"private":var t,n,r;return(null==eu?void 0:null===(t=eu.currentUser)||void 0===t?void 0:t.userPowerUpsByType.__typename)==="UserPowerUpsTypes"?null===(r=eu.currentUser.userPowerUpsByType)||void 0===r?void 0:null===(n=r.privateRepls.cost)||void 0===n?void 0:n.explanation:null;case"always-on":case"gpu":return null;default:(0,eE.Z)(e)}},[eu]),eA=function(){ei({variables:{input:{id:v.id,isPrivate:!v.isPrivate}},optimisticResponse:{__typename:"RootMutationType",updateRepl:{__typename:"UpdateReplPayload",repl:(0,i._)((0,r._)({},v),{isPrivate:!v.isPrivate})}},refetchQueries:[{query:ek.WM,variables:{replId:v.id}},e4]}),(0,x.j)(x.U3.PRIVATE_TOGGLED,{enabled:!v.isPrivate,source:"workspace_info_modal"})},eP=v.isRenamed?"Name your Repl":"Default name: ".concat(v.title),eN=[Y.Sy.Submit,Y.Sy.PublishTemplate,Y.Sy.EditTemplate].includes(v.workspaceCta),eU=(0,j.U)(),eO=(null===(t=v.owner)||void 0===t?void 0:t.__typename)==="Team",eL=v.hostingDeploymentPermissions.canDeploy&&"function"==typeof E,eM="/replEnvironmentDesktop"===K&&eL,eX=(0,p.gg)(),eF=eX.isDeployableRepl,eW=eX.reason,eH=(null===(n=v.hostingDeployment)||void 0===n?void 0:n.__typename)==="HostingDeployment"&&v.hostingDeployment.currentBuild;return(0,a.BX)("div",{css:{overflow:"auto",maxHeight:"80vh"},className:c().dynamic([["e8f7dc262f842124",[v.currentUserPermissions.changeDescription?"auto":"not-allowed",eZ.j.mobileMax]]]),children:[(0,a.tZ)(f.b,{forkParams:{trackingData:{forkSource:"editReplPopoverMenuItem"}},repl:v,teamContext:null===(l=v.user)||void 0===l?void 0:l.username,children:(0,a.tZ)(e8,{repl:v,isTemplate:J,showCloseButton:b,setActiveDialog:I,setIsEditing:S,updateIconUrl:function(e){return ei({variables:{input:{id:v.id,iconUrl:e}},optimisticResponse:{__typename:"RootMutationType",updateRepl:{__typename:"UpdateReplPayload",repl:(0,i._)((0,r._)({},v),{iconUrl:e})}}})},updateReplInfo:eI})}),(0,a.tZ)("form",{onSubmit:function(e){e.preventDefault(),eI()},className:c().dynamic([["e8f7dc262f842124",[v.currentUserPermissions.changeDescription?"auto":"not-allowed",eZ.j.mobileMax]]]),children:(0,a.BX)(F.G,{css:[z.l0.align.stretch,z.l0.colWithGap(16)],children:[(0,a.BX)(eb.Tg,{background:"default",css:[z.l0.colWithGap(16)],children:[(0,a.tZ)(F.G,{css:[z.l0.flex.column],children:(0,a.BX)(F.G,{css:[z.l0.colWithGap(4)],children:[(0,a.BX)(F.G,{css:[z.l0.flex.row,z.l0.justify.spaceBetween,z.l0.align.end],children:[(0,a.tZ)("label",{htmlFor:eU("name"),className:c().dynamic([["e8f7dc262f842124",[v.currentUserPermissions.changeDescription?"auto":"not-allowed",eZ.j.mobileMax]]]),children:(0,a.tZ)(M.xv,{variant:"small",color:"dimmer",multiline:!1,children:"Name"})}),(0,a.tZ)(h.Z,{maxLength:60,value:B,hideLabel:!0})]}),(0,a.tZ)(U.II,{style:{cursor:v.currentUserPermissions.changeTitle?"auto":"not-allowed"},disabled:!v.currentUserPermissions.changeTitle,maxLength:60,placeholder:eP,value:B,onChange:function(e){return A(e.target.value)},spellCheck:!1,id:eU("name"),dataCy:"ws-repl-info-title-input"})]})}),(0,a.tZ)(F.G,{css:[z.l0.flex.column],children:(0,a.BX)(F.G,{css:[z.l0.colWithGap(4)],children:[(0,a.BX)(F.G,{css:[z.l0.flex.row,z.l0.justify.spaceBetween,z.l0.align.end],children:[(0,a.tZ)("label",{htmlFor:eU("description"),className:c().dynamic([["e8f7dc262f842124",[v.currentUserPermissions.changeDescription?"auto":"not-allowed",eZ.j.mobileMax]]]),children:(0,a.tZ)(M.xv,{variant:"small",color:"dimmer",multiline:!1,children:"Description"})}),(0,a.tZ)(h.Z,{maxLength:em.p,value:O,hideLabel:!0})]}),(0,a.tZ)(U.B,{onKeyDown:function(e){13===e.keyCode&&(e.ctrlKey||e.metaKey)},disabled:!v.currentUserPermissions.changeDescription,maxLength:em.p,value:O,onChange:function(e){return X(e.target.value)},placeholder:"What does this Repl do?",css:[z.l0.minHeight(96),z.l0.maxHeight(256),{resize:"vertical"}],id:eU("description")})]})})]}),J&&v.currentUserPermissions.changeTemplateLabel?(0,a.tZ)(eb.Tg,{background:"default",css:[z.l0.colWithGap(4)],children:(0,a.BX)(F.G,{css:[z.l0.colWithGap(4)],children:[(0,a.tZ)("label",{htmlFor:eU("template"),className:c().dynamic([["e8f7dc262f842124",[v.currentUserPermissions.changeDescription?"auto":"not-allowed",eZ.j.mobileMax]]]),children:(0,a.tZ)(M.xv,{color:"dimmer",variant:"small",multiline:!1,children:"Template label"})}),(0,a.tZ)(U.II,{value:H,maxLength:60,placeholder:"Template label",spellCheck:!1,onChange:function(e){return V(e.target.value)},id:eU("template")})]})}):null]})}),eN?null:(0,a.BX)(F.G,{css:[z.l0.colWithGap(24),z.l0.p(8),z.l0.pt(0)],children:[v.currentUserPermissions.changePrivacy===Y.HA.Allowed&&(0,a.BX)(F.G,{css:[z.l0.colWithGap(8)],children:[(0,a.BX)(eg.hE,{tag:"fieldset",name:eU("privacy"),value:v.isPrivate.toString(),onChange:function(){if(!eo){if(v.isPrivate||v.currentUserPermissions.changePrivacy===Y.HA.Allowed&&(null===(e=v.user)||void 0===e?void 0:e.id)!=null&&(null==q?void 0:null===(t=q.currentUser)||void 0===t?void 0:t.id)!=null&&v.user.id!==q.currentUser.id){eA();return}var e,t,n,r,i=(null==eu?void 0:null===(n=eu.currentUser)||void 0===n?void 0:n.userPowerUpsByType.__typename)==="UserPowerUpsTypes"&&(null===(r=eu.currentUser.userPowerUpsByType)||void 0===r?void 0:r.privateRepls.active),o=eB("private");if(null==o||ef){$("You're too fast for us! Please try again in a moment.");return}if(eT){$("This action is currently unavailable. Please refresh and try again.");return}if((0,x.j)(x.U3.POWER_UP_TOGGLE_REQUESTED,{powerUp:"private",setting:!v.isPrivate,source:"workspace_info_modal",costExplanation:o}),i){eA();return}I(e0.x.PowerUp)}},row:!0,primary:!0,stretch:!0,children:[(0,a.tZ)(eg.rK,{id:eU("false"),value:"false",text:"Public",icon:(0,a.tZ)(ex.Z,{})}),(0,a.tZ)(eg.rK,{id:eU("true"),value:"true",text:"Private",icon:(0,a.tZ)(eC.Z,{})})]}),(0,a.tZ)(M.xv,{variant:"small",color:"dimmest",children:(0,w.Z)(v.isPrivate,eO)})]}),eM?(0,a.BX)(F.G,{css:z.l0.colWithGap(8),children:[(0,a.tZ)(P.zx,{text:eH?"Redeploy your project":"Deploy your project",iconLeft:(0,a.tZ)(ew.Z,{}),colorway:eH?void 0:"primary",onClick:function(){E(),eH||(0,x.j)(x.U3.DEPLOY_PROJECT_SELECTED,{source:"workspace_info_modal"})},disabled:!eF}),eF?null:(0,a.tZ)(L.E,{text:eW})]}):null]}),(0,a.tZ)(ev.Z,{isOpen:D===e0.x.DeleteRepl,onClose:function(){return I(null)},selectedRepls:[v],onDelete:function(){et()},deleting:en}),(0,a.tZ)(e_.Z,{isOpen:D===e0.x.PowerUp,onClose:function(){return I(null)},type:"purchase",analyticsContext:{upgrade:{context:"workspace_info_modal"}}}),(0,a.tZ)(ey.u,{isOpen:D===e0.x.Unpublish,onRequestClose:function(){return I(null)},children:(0,a.tZ)(ep.Z,{repl:v,source:"replEnvironment",onDone:function(){I(null)}})}),(0,a.tZ)(ey.u,{isOpen:D===e0.x.UnpublishTemplate,onRequestClose:function(){return I(null)},children:(0,a.tZ)(d.Z,{confirmLabel:"Yes, unpublish this Template",isDestructive:!0,title:"Unpublish Template",onCancel:function(){return I(null)},onConfirm:function(){ec.loading||(el(),I(null))},children:"Your Repl will no longer be discoverable on Templates. You can republish again at any time, and all of your comments or reactions will stick around."})}),(0,a.tZ)(ey.u,{isOpen:D===e0.x.EditPublishSettings,onRequestClose:function(){return I(null)},noPadding:!0,maxWidth:872,fitContent:!0,children:(0,a.tZ)(_.Z,{source:"replEnvironment",replId:v.id})}),(0,a.tZ)(ey.u,{isOpen:D===e0.x.Publish,onRequestClose:function(){return I(null)},noPadding:!0,maxWidth:872,fitContent:!0,children:(0,a.tZ)(_.Z,{source:"replEnvironment",replId:v.id})}),(0,a.tZ)(ey.u,{isOpen:D===e0.x.UpdatePublishedTemplate,onRequestClose:function(){return I(null)},noPadding:!0,children:(0,a.tZ)(ed,{repl:v})}),(0,a.tZ)(ey.u,{isOpen:D===e0.x.UpdatePublishedRepl,onRequestClose:function(){return I(null)},children:(0,a.tZ)(eh.Z,{repl:v,onDone:function(){return I(null)},source:"replEnvironment"})}),(0,a.tZ)(c(),{id:"e8f7dc262f842124",dynamic:[v.currentUserPermissions.changeDescription?"auto":"not-allowed",eZ.j.mobileMax],children:"form.__jsx-style-dynamic-selector{padding:var(--space-8)}textarea.__jsx-style-dynamic-selector{min-height:42px;height:200px;resize:none;cursor:".concat(v.currentUserPermissions.changeDescription?"auto":"not-allowed",";font-size:var(--font-size-default);font-family:var(--font-family-default);padding:var(--space-8);display:block;width:100%;-webkit-border-radius:var(--border-radius-4);-moz-border-radius:var(--border-radius-4);border-radius:var(--border-radius-4);border:1px solid var(--outline-dimmest);-webkit-transition:.2s border-color;-moz-transition:.2s border-color;-o-transition:.2s border-color;transition:.2s border-color;background-color:transparent;color:var(--foreground-default)}textarea.__jsx-style-dynamic-selector:hover{border-color:var(--accent-primary-dimmer)}textarea.__jsx-style-dynamic-selector:active,textarea.__jsx-style-dynamic-selector:focus{border-color:var(--accent-primary-default)}textarea.__jsx-style-dynamic-selector:disabled{opacity:.5}textarea.__jsx-style-dynamic-selector:focus,textarea.__jsx-style-dynamic-selector:active{outline:none;border-color:var(--accent-primary-default)}.edit-repl-actions.__jsx-style-dynamic-selector{padding:0 var(--space-16)}.menu-item.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;color:var(--foreground-default)}.delete-menu-item.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;color:var(--accent-negative-default)}.icon-container.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;padding:0 var(--space-4)}.menu-text.__jsx-style-dynamic-selector{padding:0 var(--space-4)}@media screen and (max-width:").concat(eZ.j.mobileMax,"px){.edit-repl.__jsx-style-dynamic-selector{width:80vw}}")})]})}},11707:function(e,t,n){n.d(t,{s:function(){return l}});var r=n(21262),i=n(71440),o=n(78747);function a(){var e=(0,r._)(["\n  fragment WorkspaceHeaderReplMetadataRepl on Repl {\n    id\n    title\n    iconUrl\n    user {\n      id\n      ...UserLinkUser\n    }\n  }\n  ","\n"]);return a=function(){return e},e}var l=(0,i.Ps)(a(),o._)},38168:function(e,t,n){n.d(t,{Z:function(){return d}});var r=n(42516),i=n(74985),o=n(2161),a=n(74833),l=n(56596),c=n(93918),s=n(29287),u=(0,c.X)({metadata:[s.l0.rowWithGap(6),s.l0.align.center,s.l0.flex.growAndShrink(1)],username:[s.l0.maxWidth(160),s.l0.truncate,s.l0.flex.shrink(1)],title:[s.l0.flex.shrink(1),s.l0.truncate]});function d(e){var t=e.repl;return(0,i.BX)(l.G,{css:u.metadata,children:[(0,i.tZ)(l.G,{css:[s.l0.display.none,(0,r._)({},s.BC.min("tabletMax"),[s.l0.display.flex])],children:(0,i.tZ)(o.ZP,{iconUrl:t.iconUrl,size:20,alt:""})}),(0,i.tZ)(a.xv,{multiline:!1,css:u.title,"data-cy":"header-repl-title",children:t.title})]})}},92611:function(e,t,n){var r,i,o,a;n.d(t,{$:function(){return i},x:function(){return r}}),(o=r||(r={})).DeleteRepl="DeleteRepl",o.PowerUp="PowerUp",o.BuyCycles="BuyCycles",o.Unpublish="Unpublish",o.UnpublishTemplate="UnpublishTemplate",o.EditPublishSettings="EditPublishSettings",o.Publish="Publish",o.UpdatePublishedTemplate="UpdatePublishedTemplate",o.UpdatePublishedRepl="UpdatePublishedRepl",(a=i||(i={})).Fork="Fork",a.Delete="Delete",a.Unpublish="Unpublish",a.UnpublishTemplate="UnpublishTemplate",a.EditPublishSettings="EditPublishSettings"},61673:function(e,t,n){n.d(t,{ZP:function(){return Q},L7:function(){return K}});var r,i,o,a=n(27387),l=n(42516),c=n(41733),s=n(30509),u=n(66626),d=n(96583),f=n(74985),h=n(43312),p=n(43182),m=n(25632),v=n(60561),g=n(71999),y=n(15859),b=n(21262),Z=n(71440),w=n(58995);function x(){var e=(0,b._)(["\n  query CelebrateReplRunCurrentUser {\n    currentUser {\n      id\n      timeCreated\n    }\n  }\n"]);return x=function(){return e},e}var C={},_=(0,Z.Ps)(x()),S=new Date("2022-07-08"),E=(0,y.O4)("useCelebrateFirstReplPlay",!1),k=n(55534),T=n(50782),R=n(2689),D=n(93049),I=n(59868),G=n(74833),B=n(30983),A=n(56596),P=n(29479),N=n(88936),U=n(27187),O=n(25753),L=n(29287),M=n(18107),X=n(49996),F=n(74652),W=n(50959);function H(){var e=(0,b._)(["\n  query WorkspaceRunButton($id: String!) {\n    repl(id: $id) {\n      ... on Repl {\n        id\n        language\n        title\n        rootOriginReplUrl\n        source {\n          release {\n            id\n            repl {\n              id\n              title\n              owner {\n                ... on User {\n                  id\n                  username\n                }\n                ... on Team {\n                  id\n                  username\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n    currentUser {\n      id\n    }\n  }\n"]);return H=function(){return e},e}var V={},z=(0,Z.Ps)(H());function j(e){var t=e.runState,n=e.size,r=void 0===n?16:n;switch(t){case M.Ah.IDLE:return(0,f.tZ)(U.Z,{size:r});case M.Ah.RUNNING:return(0,f.tZ)(O.Z,{size:r});default:return(0,f.tZ)(N.Z,{size:r})}}var q=(r={},(0,l._)(r,M.Ah.IDLE,"Run"),(0,l._)(r,M.Ah.RUNNING,"Stop"),(0,l._)(r,M.Ah.STOPPING,"Stopping"),(0,l._)(r,M.Ah.OFFLINE,"Working"),(0,l._)(r,M.Ah.BEFORE_RUN,"Working"),r),Y=(i={small:48,large:100},(0,l._)(i,M.Ah.IDLE,68),(0,l._)(i,M.Ah.RUNNING,72),(0,l._)(i,M.Ah.STOPPING,92),(0,l._)(i,M.Ah.OFFLINE,86),(0,l._)(i,M.Ah.BEFORE_RUN,86),i),$=(0,h.iv)([L.l0.py(12),L.l0.width(Y.small),L.l0.flex.row,L.l0.center,L.l0.borderRadius(6),L.l0.backgroundColor.accentPositiveDimmest,L.l0.color.accentPositiveStrongest,L.l0.cursor.pointer,L.l0.focusRing,(o={transition:"color 0.2s ease 0s, background-color 0.2s ease 0s",border:"1px solid",borderColor:"transparent",lineHeight:1,outline:"0 none","&:hover":[{color:"white"},L.l0.backgroundColor.accentPositiveDefault],"&:active":[{borderColor:L.TV.accentPositiveStrongest}]},(0,l._)(o,(0,X.et)("tabletMax"),[L.l0.width(Y.large)]),(0,l._)(o,":focus-visible",{outlineColor:"".concat(L.TV.accentPositiveStrongest)}),o)]),J=(0,h.iv)([L.l0.color.foregroundDimmer,L.l0.backgroundColor.backgroundHigher,{borderColor:"transparent","&:hover":[{color:"white"},L.l0.backgroundColor.backgroundHighest],"&:active":[{borderColor:L.TV.accentPrimaryDefault}]}]);function K(e){var t=(0,u._)((0,W.useState)(e.getRunState()),2),n=t[0],r=t[1];return(0,W.useEffect)(function(){return r(e.getRunState()),e.onStateChanged(function(e){r(e)})},[e]),n}var Q=W.forwardRef(function(e,t){var n,r,i,o,h,y,b,Z,x,N,U,O,H,Q=e.runner,ee=e.runConfig,et=e.onRunInitiated,en=e.style,er=void 0===en?"default":en,ei=e.disableTooltip,eo=e.shortcut,ea=(0,T.Z)(),el=K(Q),ec=(n=(0,c._)({},V,{variables:{id:ea}}),w.a(z,n)).data,es=(null==ec?void 0:ec.repl.__typename)==="Repl"?ec.repl:null,eu=(r=(0,c._)({},C,void 0),h=w.a(_,r),y=(0,m.Gn)("extraDelight").preferences.extraDelight,b=(0,v.$0)().fireCircularBurstFrom,x=(Z=(0,u._)((0,g.KO)(E),2))[0],N=Z[1],U=null!==(o=null===(i=h.data)||void 0===i?void 0:i.currentUser)&&void 0!==o?o:null,O=!x&&U&&new Date(U.timeCreated)>=S,{hasCelebrated:x,celebrate:function(e){if(!e){p.Tb(Error("Cannot find element for celebrate Repl run confetti"));return}(y||O)&&b({element:e}),O&&N(!0)}}).celebrate,ed=el!==M.Ah.IDLE&&el!==M.Ah.RUNNING,ef=(0,k.Z)().showError,eh=(0,W.useRef)(null),ep=(H=(0,a._)(function(){var e,t,n,r,i,o,a,l;return(0,d.Jh)(this,function(c){switch(c.label){case 0:if(c.trys.push([0,3,,4]),el!==M.Ah.IDLE)return[3,2];return et&&et(),eh.current&&eu(eh.current),[4,Q.run(ee)];case 1:return c.sent(),es&&(0,I.j)(I.U3.PROJECT_RAN,{placement:"primary_btn",language:es.language,replId:es.id,replTitle:es.title,rootOriginReplUrl:es.rootOriginReplUrl,templateTitle:null===(n=es.source)||void 0===n?void 0:null===(t=n.release)||void 0===t?void 0:null===(e=t.repl)||void 0===e?void 0:e.title,templateOwner:null===(a=es.source)||void 0===a?void 0:null===(o=a.release)||void 0===o?void 0:null===(i=o.repl)||void 0===i?void 0:null===(r=i.owner)||void 0===r?void 0:r.username}),[2];case 2:if(el===M.Ah.RUNNING)return[2,Q.stopRun()];return[3,4];case 3:if(ef((l=c.sent()).toString()),R.kg.error("run button error",{errorMessage:l.message}),el===M.Ah.RUNNING)return[2,Q.stopRun()];return[3,4];case 4:return[2]}})}),function(){return H.apply(this,arguments)});if("floating"===er)return(0,f.tZ)(A.G,{tag:"button",disabled:ed,css:[{position:"fixed",right:24,bottom:72,zIndex:1},L.l0.center,{height:"50px",width:"50px",opacity:"0.5",cursor:"pointer",borderRadius:"100%",border:"solid 2px var(--accent-positive-dimmer)",backgroundColor:L.TV.accentPositiveDimmest}],onClick:ep,innerRef:eh,children:(0,f.tZ)(j,{runState:el})});var em=el===M.Ah.IDLE;return"inline-small"===er?(0,f.BX)("button",{"data-cy":"ws-run-btn",onClick:ep,ref:eh,disabled:ed,css:[L.l0.p(12),L.l0.flex.row,L.l0.center,L.l0.borderRadius(8),em?L.l0.backgroundColor.accentPositiveDimmest:L.l0.backgroundColor.backgroundHigher,em?L.l0.color.accentPositiveStronger:L.l0.color.foregroundDimmer,{border:"1px solid",borderColor:em?L.TV.accentPositiveDimmest:L.TV.backgroundHigher},L.l0.width("100%"),L.l0.height("100%")],children:[(0,f.tZ)(j,{runState:el}),(0,f.tZ)(G.xv,{variant:"subheadDefault",css:[L.l0.pl(8)],multiline:!1,children:q[el]})]}):(0,f.tZ)(B.u,{placement:"bottom",isDisabled:ei||!eo,tooltip:eo?(0,f.tZ)(A.G,{css:{margin:-4},children:(0,f.tZ)(F.bM,{keyCombo:eo,small:!0})}):null,children:function(e,n){return(0,f.BX)("button",(0,s._)((0,c._)({},e),{onClick:ep,ref:(0,D.l)(eh,n,t),css:[$,!em&&J,L.l0.height(32),(0,l._)({transition:"width 80ms ease-out"},(0,X.et)("tabletMax"),L.l0.width(Y[el]))],children:[(0,f.tZ)(j,{runState:el,size:12}),(0,f.tZ)(G.xv,{multiline:!1,css:[L.l0.pl(6),L.l0.display.none,L.l0.fontWeight.medium,(0,l._)({lineHeight:1,overflow:"visible"},"@media (min-width: ".concat(P.j.tabletMax,"px)"),[L.l0.display.block])],children:q[el]})]}))}})})},68681:function(e,t,n){n.d(t,{Z:function(){return d}});var r=n(41733),i=n(30509),o=n(98924),a=n(74985),l=n(15146),c=n(93918),s=n(29287),u=(0,c.X)({checked:[s.l0.width(32),s.l0.height(32),s.l0.backgroundColor.backgroundHigher],unchecked:[s.l0.width(32),s.l0.height(32),s.l0.color.foregroundDimmest]});function d(e){var t=e.alt,n=e.icon,c=e.checked,s=e.onClick,d=(0,o._)(e,["alt","icon","checked","onClick"]);return(0,a.tZ)(l.hU,(0,i._)((0,r._)({},d),{css:c?u.checked:u.unchecked,alt:"".concat(c?"Disable":"Enable"," ").concat(t),onClick:s,children:n}))}},71984:function(e,t,n){n.d(t,{Z:function(){return d}});var r,i=n(42516),o=n(74985),a=n(43312),l=n(30983),c=n(52682),s=n(29287),u=(0,a.iv)([s.l0.focusRing,s.l0.display.flex,s.l0.center,s.l0.borderRadius(4),s.l0.backgroundColor.backgroundRoot,s.l0.color.foregroundDefault,s.l0.cursor.pointer,s.l0.p(4),(r={transition:"background-color 0.2s",border:"none"},(0,i._)(r,s.wl.hover,[s.l0.backgroundColor.backgroundHigher]),(0,i._)(r,":focus",{outline:"none"}),r)]),d=function(e){var t=e.onClick;return(0,o.tZ)(l.u,{tooltip:"Clear",placement:"bottom-start",children:(0,o.tZ)("button",{"aria-label":"Clear",onClick:t,css:u,children:(0,o.tZ)(c.Z,{size:16})})})}},24837:function(e,t,n){n.d(t,{Z:function(){return W}});var r=n(66626),i=n(74985),o=n(23291),a=n(37951),l=n(74833),c=n(30983),s=n(54254),u=n(56596),d=n(29287),f=n(50959),h=n(31900),p=n(15542),m=n(25425),v=n(55534),g=n(44680),y=n(32377),b=n(52682),Z=n(33988),w=n.n(Z),x=n(41733),C=n(21262),_=n(71440),S=n(55846),E=n(99165);function k(){var e=(0,C._)(["\n  mutation DeleteThreadMessage($id: String!) {\n    deleteThreadMessage(messageId: $id) {\n      ... on AnnotationAnchor {\n        id\n        ...AnnotationsUIAnchor\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return k=function(){return e},e}var T={},R=(0,_.Ps)(k(),S.j7),D=n(68333),I=n(25632),G=n(53326),B=n(33195),A=n(3927),P=n(42173),N=n(71253),U=n(66164),O=n(25462),L=n(43312),M=["a","pre","code","em","strong","p","ul","ol","li","img","del","h1","h2","h3","h4","h5","h6","sup","sub","br","hr","blockquote","span","div"],X=(0,f.memo)(function(e){var t=e.content,n=(0,I.Gn)("fontSize").preferences.fontSize,r=(0,f.useCallback)(function(e){return(0,i.tZ)(G.Z,(0,x._)({},e))},[]);return(0,i.tZ)("div",{css:[{"& ol":{paddingInlineStart:"20px"},"& ul":{paddingInlineStart:"20px",listStyle:"initial"}}],children:(0,i.tZ)(A.D,{css:(0,L.iv)({wordBreak:"break-word",boxSizing:"border-box",whiteSpace:"normal",lineHeight:1.5,color:d.TV.foregroundDefault,fontFamily:"".concat(d.TV.fontFamilyDefault," !important"),fontSize:n,textSizeAdjust:"100%","h1, h2, h3, h4, h5, h6":{color:d.TV.foregroundDefault,fontWeight:d.TV.fontWeightMedium,marginBottom:d.TV.space16,lineHeight:1.25,wordWrap:"break-word"},"h1, h2":{paddingBottom:d.TV.space8,borderBottom:"1px solid ".concat(d.TV.backgroundHigher),marginTop:d.TV.space32},h1:{fontSize:"2em"},h2:{fontSize:"1.5em"},h3:{fontSize:"1.25em",marginTop:d.TV.space24},h4:{fontSize:"1em",marginTop:d.TV.space16},h5:{fontSize:"0.875em"},h6:{color:d.TV.foregroundDimmer,fontSize:"0.85em"},".anchor":{float:"left",lineHeight:1,marginLeft:"calc(-1 * ".concat(d.TV.space16,")"),paddingRight:d.TV.space4},".anchor:focus":{outline:"none"},p:{marginBottom:d.TV.space16,fontSize:n,fontFamily:"".concat(d.TV.fontFamilyDefault," !important")},"p:last-child":{marginBottom:0},table:{borderSpacing:0,borderCollapse:"collapse",display:"block",width:"100%",overflow:"auto",marginBottom:d.TV.space16,wordBreak:"normal",th:{fontWeight:d.TV.fontWeightMedium},"td, th":{padding:"".concat(d.TV.space8," ").concat(d.TV.space12),border:"1px solid ".concat(d.TV.backgroundHighest),minWidth:"16ch"},tr:{backgroundColor:d.TV.backgroundDefault,borderTop:"1px solid ".concat(d.TV.backgroundHighest)},"tr:nth-of-type(2n)":{backgroundColor:d.TV.backgroundRoot}},"hr:after":{clear:"both"},"li > p":{marginBottom:0},li:{marginTop:d.TV.space4},dd:{marginLeft:0},"ol, ul":{paddingLeft:d.TV.space16,marginTop:0,marginBottom:0},ul:{listStyle:"initial",listStyleType:"disc",marginBottom:d.TV.space16},ol:{listStyle:"decimal",marginBottom:d.TV.space16},"ol ol, ol ul, ul ol, ul ul":{paddingLeft:d.TV.space16,marginTop:0,marginBottom:0,paddingBottom:0},"ul ul":{listStyleType:"circle"},"ul ul ul":{listStyleType:"square"},"ol ol, ul ol":{listStyleType:"lower-roman"},"ol ol ol, ol ul ol, ul ol ol, ul ul ol":{listStyleType:"lower-alpha"},pre:{fontFamily:"".concat(d.TV.fontFamilyCode," !important"),margin:"".concat(d.TV.space16," 0"),borderRadius:4,wordBreak:"break-all",wordWrap:"break-word",whiteSpace:"pre-wrap",color:d.TV.foregroundDefault},"pre:last-child":{marginBottom:"0 !important"},blockquote:{padding:"0 1em",marginBottom:d.TV.space16,borderLeft:"".concat(d.TV.space2," solid ").concat(d.TV.backgroundHighest),paddingLeft:d.TV.space16},"blockquote > *":{color:"".concat(d.TV.foregroundDimmer," !important")},"blockquote > :last-child":{marginBottom:"0 !important",borderBottom:"none !important"},"blockquote > :first-child":{marginTop:"0 !important"},kbd:{display:"inline-block",padding:"3px 5px",font:"11px ".concat(d.TV.fontFamilyCode),color:d.TV.foregroundDimmer,verticalAlign:"middle",backgroundColor:d.TV.backgroundHigher,border:"none",borderRadius:3,boxShadow:"inset 0 -1px 0 ".concat(d.TV.backgroundHighest)},a:{color:d.TV.accentPrimaryStronger,backgroundColor:"initial"},"> :first-child":{marginTop:"0 !important",paddingTop:"0 !important"},"> :last-child":{borderBottom:"none !important",marginBottom:"0 !important",paddingBottom:"0 !important"},'[type="checkbox"]':{boxSizing:"border-box",marginRight:d.TV.space8,padding:0},details:{marginBottom:d.TV.space16,display:"block",background:d.TV.backgroundHigher,borderRadius:d.TV.borderRadius4,padding:d.TV.space16},summary:{display:"list-item",userSelect:"none",cursor:"pointer",fontWeight:d.TV.fontWeightBold},"details[open] > summary":{borderBottom:"1px solid ".concat(d.TV.backgroundHighest),marginBottom:d.TV.space16,paddingBottom:d.TV.space16},hr:{height:1,backgroundColor:d.TV.backgroundHigher,margin:"".concat(d.TV.space24," 0"),border:0}}),allowedElements:M,remarkPlugins:[D.Ic,U.Z,O.Z,N.Z],linkTarget:"_blank",rehypePlugins:[P.Z],components:{code:r,img:B.Z},children:t})})}),F=n(61657),W=(0,f.memo)(function(e){var t,n=e.thread,Z=e.message,C=(0,p.d)(),_=(0,v.Z)().showError,S=(0,r._)((t=(0,x._)({},T,{onError:function(e){_(e.message)},onCompleted:function(e){var t;(null===(t=e.deleteThreadMessage)||void 0===t?void 0:t.__typename)==="UserError"&&_(e.deleteThreadMessage.message)}}),E.D(R,t)),2),k=S[0],D=S[1].loading,I=(0,m.P5)({controlName:"flag-threads-dropdown-menu",default:!1,type:"boolean",logFlagToAnalytics:!1}),G=!!(n&&n.indexStart===n.indexEnd),B={statusBanner:{resolved:"Thread resolved. Re-open it any time in the inbox.",unresolved:"Thread re-opened"},outdated:"Outdated",outdatedTooltip:"The code has changed since the comment was left"},A=(0,f.useMemo)(function(){return{diff:(0,F.Y)(Z.timeCreated),full:(0,F.u)(Z.timeCreated)}},[Z]);if(!Z.user)return null;var P=C===Z.user.id?[{label:"Delete",icon:(0,i.tZ)(b.Z,{}),isDestructive:!0}]:[];return(0,i.BX)(u.G,{children:[(0,i.BX)(u.G,{css:[d.l0.flex.row,d.l0.justify.spaceBetween,d.l0.pb(4)],children:[(0,i.BX)(u.G,{css:[d.l0.flex.row,d.l0.align.center,d.l0.rowWithGap(8)],children:[(0,i.tZ)(w(),{legacyBehavior:!0,passHref:!0,href:"/@".concat(Z.user.username),children:(0,i.tZ)("a",{children:(0,i.tZ)(s.n,{small:!0,src:Z.user.image,username:Z.user.username})})}),(0,i.tZ)("p",{children:(0,i.tZ)(c.u,{tooltip:A.full,placement:"top",children:(0,i.tZ)(l.xv,{variant:"small",color:"dimmer",multiline:!1,children:A.diff})})}),P.length>0&&I?(0,i.tZ)(h.Z,{items:P,onItemClick:function(e){"Delete"!==e.label||D||k({variables:{id:Z.id}})},label:"More"}):null]}),G?(0,i.tZ)(c.u,{tooltip:B.outdatedTooltip,children:(0,i.tZ)(o.D,{colorway:"negative",text:B.outdated})}):null]}),"StatusMessageContentType"===Z.content.__typename&&"resolved"===Z.content.status?(0,i.tZ)(a.E,{colorway:"positive",icon:(0,i.tZ)(y.Z,{}),text:B.statusBanner.resolved}):null,"StatusMessageContentType"===Z.content.__typename&&"unresolved"===Z.content.status?(0,i.tZ)(a.E,{colorway:"primary",icon:(0,i.tZ)(g.Z,{}),text:B.statusBanner.unresolved}):null,"TextMessageContentType"===Z.content.__typename&&(0,i.tZ)(X,{content:Z.content.text})]})})},61657:function(e,t,n){n.d(t,{Y:function(){return o},u:function(){return a}});var r=n(57526),i=n(20597),o=function(e){var t=new Date(e),n=new Date;return 60>(0,i.Z)(n,t)?"just now":(0,r.F)(t,!0)+" ago"},a=function(e){return new Date(e).toLocaleString()}},31105:function(e,t,n){n.d(t,{Z:function(){return eT}});var r=n(66626),i=n(74985),o=n(50782),a=n(15146),l=n(74833),c=n(56596),s=n(88936),u=n(99656),d=n(29287),f=n(9617),h=n(50959),p=n(46689),m=n(41733),v=n(30509),g=n(76999),y=n.n(g),b=n(73722),Z=n(50831),w=function(e){var t=e.onClick,n=e.hasTests,r=n?{"aria-label":"Delete all tests to switch test type","data-microtip-position":"bottom","data-microtip-size":"medium",role:"tooltip"}:{};return(0,i.BX)("div",(0,v._)((0,m._)({},r),{className:"jsx-44786ca38dd3aa42 "+(r&&null!=r.className&&r.className||"back-button"),children:[(0,i.tZ)(Z.Z,{filled:!1,border:!1,size:"small",Icon:b.Z,onClick:t,disabled:n,children:"Switch test type"}),(0,i.tZ)(y(),{id:"44786ca38dd3aa42",children:".back-button.jsx-44786ca38dd3aa42{width:100%;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center}"})]}))},x=n(55534),C=n(59868),_=n(1498),S=n(70002),E=n(49344),k=n(44680),T=n(32377),R=n(79217),D=n(58003),I=n(51051),G=n(80979),B=n(20142),A=n(81013),P=I.q6.define();function N(e){var t=e.editorRef,n=e.onChange,r=e.placeholder,o=e.skeleton,a=e.language,l=e.skeletonClosingBracket,c=e.indentSize,s=(0,A.Z)(),u=s.ref,d=s.view,f=(0,h.useRef)(o?"".concat(o,"\n"):""),p=l?"\n".concat(l):"",m=" ".repeat(void 0===c?2:c);return(0,h.useEffect)(function(){if(d&&d.state.doc.length){var e=f.current;f.current=o?"".concat(o,"\n"):"",d.dispatch({changes:{from:0,to:e.length-1,insert:o},annotations:[I.YW.addToHistory.of(!1),P.of(!0)]})}},[d,o]),(0,h.useEffect)(function(){if(d){var e=I.yy.changeFilter.of(function(e){return!!e.annotation(P)||[-1,f.current.length,e.startState.doc.length-p.length,e.startState.doc.length+1]}),i=G.tk.updateListener.of(function(e){var t=e.state.doc.slice(f.current.length,e.state.doc.toString().length-p.length).toString();if(t!=="".concat(m).concat(r,"\n").concat(m)?n(t):n(""),e.docChanged&&e.state.doc.length===f.current.length+p.length){var i="\n"+m;d.dispatch({changes:{from:f.current.length-1,insert:"\n"+m},selection:{anchor:f.current.length+i.length-1},annotations:[P.of(!0)]})}}),o="".concat(f.current).concat(m).concat(r,"\n").concat(p);d.dispatch({changes:{from:0,to:d.state.doc.length,insert:o},effects:I.Py.appendConfig.of([e,i]),selection:{anchor:o.length},annotations:I.YW.addToHistory.of(!1)}),t({setValue:function(e){if(e){var t=d.state.doc.toString().length;d.dispatch({changes:{from:f.current.length,to:t-p.length,insert:e},annotations:I.YW.addToHistory.of(!1)})}},focus:function(){return d.focus()}})}},[n,a,d,p,t,r,m]),(0,i.BX)("div",{className:"jsx-c0a72647b9c20ef editor",children:[(0,i.tZ)(B.ZP,{ref:u,language:a,indentSize:2,fontSize:14,indentIsSpaces:!0}),(0,i.tZ)(y(),{id:"c0a72647b9c20ef",children:".editor.jsx-c0a72647b9c20ef{overflow:auto;position:absolute;width:100%;height:100%}.loader.jsx-c0a72647b9c20ef{height:100%;width:100%;z-index:5}"})]})}var U=n(68809),O=n(79962);function L(e){var t,n,a,s,u=e.isOpen,f=e.meta,p=e.language,g=e.hasMetadata,y=e.onClose,b=(0,o.Z)(),Z=(0,x.Z)().showConfirm,w=(0,r._)((0,h.useState)(null),2),S=w[0],k=w[1],D=(0,r._)((0,h.useState)(!0),2),I=D[0],G=D[1],B=(0,r._)((0,h.useState)((null==f?void 0:f.initialization)||""),2),A=B[0],P=B[1],N=(0,r._)((0,h.useState)((null==f?void 0:f.imports)||""),2),L=N[0],H=N[1],V=(0,r._)((0,h.useState)((null==f?void 0:f.setup)||""),2),z=V[0],j=V[1],q=(0,r._)((0,h.useState)((null==f?void 0:f.tearDown)||""),2),Y=q[0],$=q[1],J=(0,r._)((0,O.rU)({onError:function(e){return k(e.message)},update:function(e,t){var n,r=null===(n=t.data)||void 0===n?void 0:n.createReplUnitTestMeta;r&&("UserError"===r.__typename?k(r.message):"ReplUnitTestMeta"===r.__typename&&(e.modify({id:e.identify({__typename:"Repl",id:b}),fields:{unitTests:function(t){var n=e.writeFragment({data:r,fragment:O.aA});return t?(0,v._)((0,m._)({},t),{meta:(0,m._)({},n)}):{__typename:"ReplUnitTestsWithMeta",meta:n,tests:[]}}}}),Z("Setup saved!"),y()))}}),2),K=J[0],Q=J[1],ee=(0,r._)((0,O.AF)({onError:function(e){return k(e.message)},onCompleted:function(e){var t=e.updateReplUnitTestMeta;t&&("UserError"===t.__typename?k(t.message):"ReplUnitTestMeta"===t.__typename&&(Z("Imports updated!"),y()))}}),2),et=ee[0],en=ee[1],er=(0,U.x)(p),ei=L!==(null==f?void 0:f.imports)||A!==(null==f?void 0:f.initialization)||z!==(null==f?void 0:f.setup)||Y!==(null==f?void 0:f.tearDown),eo=Q.loading||en.loading;return(0,i.tZ)(E.u,{isOpen:u,onRequestClose:y,maxWidth:872,children:(0,i.BX)(c.G,{css:[d.l0.colWithGap(24)],children:[(0,i.tZ)(l.h4,{level:1,variant:"headerDefault",children:"Setup"}),(0,i.tZ)(M,{unitTestsLib:er,onChange:H,language:p,initialValue:null!==(t=null==f?void 0:f.imports)&&void 0!==t?t:""}),(0,i.tZ)(c.G,{onClick:function(){return G(!I)},css:{cursor:"pointer"},children:(0,i.BX)(c.G,{css:[d.l0.rowWithGap(8),d.l0.align.center],children:[(0,i.tZ)(l.h4,{level:2,variant:"headerDefault",children:"Advanced"}),(0,i.tZ)(R.Z,{color:"var(--foreground-default)",size:20,rotate:I?270:0})]})}),I?null:(0,i.BX)(c.G,{css:[d.l0.colWithGap(8)],children:[(0,i.tZ)(X,{unitTestsLib:er,onChange:P,language:p,initialValue:null!==(n=null==f?void 0:f.initialization)&&void 0!==n?n:""}),(0,i.tZ)(F,{unitTestsLib:er,onChange:j,language:p,initialValue:null!==(a=null==f?void 0:f.setup)&&void 0!==a?a:""}),(0,i.tZ)(W,{unitTestsLib:er,onChange:$,language:p,initialValue:null!==(s=null==f?void 0:f.tearDown)&&void 0!==s?s:""})]}),(0,i.BX)(c.G,{css:[d.l0.flex.row,d.l0.justify.spaceBetween],children:[(0,i.tZ)(l.xv,{css:[d.l0.color.accentNegativeStronger],children:S}),(0,i.BX)(c.G,{css:[d.l0.rowWithGap(12)],children:[(0,i.tZ)(_.zx,{disabled:eo,onClick:y,text:"Cancel"}),(0,i.tZ)(_.zx,{colorway:"primary",disabled:!ei||eo,onClick:function(){(0,C.j)(C.U3.REPL_UNIT_TEST_USED,{action:"modifiedSetup"}),g?et({variables:{input:{initialization:A,imports:L,setup:z,tearDown:Y,replId:b}}}):K({variables:{input:{initialization:A,imports:L,setup:z,tearDown:Y,replId:b}}})},iconLeft:(0,i.tZ)(T.Z,{}),text:"".concat(eo?"Saving...":"Save")})]})]})]})})}function M(e){var t=e.unitTestsLib,n=e.onChange,o=e.language,a=e.initialValue,s=(0,r._)((0,h.useState)(null),2),u=s[0],f=s[1];(0,h.useEffect)(function(){u&&(u.setValue(a),u.focus())},[u,a]);var p=t.defaultImports().trim();return(0,i.BX)(c.G,{css:[d.l0.colWithGap(8)],children:[(0,i.BX)(c.G,{css:[d.l0.flex.row,d.l0.justify.spaceBetween,d.l0.align.center],children:[(0,i.tZ)(l.h4,{level:2,variant:"subheadDefault",children:"Imports"}),(0,i.tZ)(S.Z,{iconLeft:(0,i.tZ)(k.Z,{}),text:"Docs",href:"https://docs.replit.com/teams-edu/unit-testing",target:"_blank",variant:"outlined"})]}),(0,i.tZ)(c.G,{css:[d.l0.backgroundColor.backgroundDefault,d.l0.borderRadius(8),{border:"1px solid var(--background-highest)"}],children:(0,i.tZ)(c.G,{css:[d.l0.borderRadius(8),d.l0.height(200),d.l0.position.relative],children:(0,i.tZ)(N,{onChange:n,placeholder:"".concat(t.getCommentChar()," Add imports here"),editorRef:f,language:o,skeleton:p,skeletonClosingBracket:"",indentSize:0})})})]})}function X(e){var t=e.unitTestsLib,n=e.onChange,o=e.language,a=e.initialValue,s=(0,r._)((0,h.useState)(null),2),u=s[0],f=s[1];(0,h.useEffect)(function(){u&&u.setValue(a)},[u,a]);var p=t.classConstructorName();return(0,i.BX)(c.G,{css:[d.l0.colWithGap(8)],children:[(0,i.BX)(c.G,{css:[d.l0.flex.row,d.l0.justify.spaceBetween,d.l0.align.center],children:[(0,i.tZ)(l.h4,{level:2,variant:"subheadDefault",children:"Initialization"}),(0,i.tZ)(S.Z,{iconLeft:(0,i.tZ)(k.Z,{}),text:"Docs",href:"https://docs.replit.com/teams-edu/unit-testing",target:"_blank",variant:"outlined"})]}),p?(0,i.BX)(l.xv,{children:["Hint: constructor name is ",(0,i.tZ)("code",{children:p}),"."]}):null,(0,i.tZ)(c.G,{css:[d.l0.backgroundColor.backgroundDefault,d.l0.borderRadius(8),{border:"1px solid var(--background-highest)"}],children:(0,i.tZ)(c.G,{css:[d.l0.borderRadius(8),d.l0.height(200),d.l0.position.relative],children:(0,i.tZ)(N,{onChange:n,placeholder:"".concat(t.getCommentChar()," Add initialization code here"),editorRef:f,language:o,skeleton:"",skeletonClosingBracket:"",indentSize:0})})})]})}function F(e){var t=e.unitTestsLib,n=e.onChange,o=e.language,a=e.initialValue,s=(0,r._)((0,h.useState)(null),2),u=s[0],f=s[1];(0,h.useEffect)(function(){u&&u.setValue(a)},[u,a]);var p=t.setupIntro().trim();return(0,i.BX)(c.G,{css:[d.l0.colWithGap(8)],children:[(0,i.BX)(c.G,{css:[d.l0.flex.row,d.l0.justify.spaceBetween,d.l0.align.center],children:[(0,i.tZ)(l.h4,{level:2,variant:"subheadDefault",children:"Setup"}),(0,i.tZ)(S.Z,{iconLeft:(0,i.tZ)(k.Z,{}),text:"Docs",href:"https://docs.replit.com/teams-edu/unit-testing",target:"_blank",variant:"outlined"})]}),(0,i.tZ)(c.G,{css:[d.l0.backgroundColor.backgroundDefault,d.l0.borderRadius(8),{border:"1px solid var(--background-highest)"}],children:(0,i.tZ)(c.G,{css:[d.l0.borderRadius(8),d.l0.height(200),d.l0.position.relative],children:(0,i.tZ)(N,{onChange:n,placeholder:"".concat(t.getCommentChar()," Add setup code here"),editorRef:f,language:o,skeleton:p,skeletonClosingBracket:t.hasClosingBrackets()?t.getClosingBrackets():""})})})]})}function W(e){var t=e.unitTestsLib,n=e.onChange,o=e.language,a=e.initialValue,s=(0,r._)((0,h.useState)(null),2),u=s[0],f=s[1];(0,h.useEffect)(function(){u&&u.setValue(a)},[u,a]);var p=t.tearDownIntro().trim();return(0,i.BX)(c.G,{css:[d.l0.colWithGap(8)],children:[(0,i.BX)(c.G,{css:[d.l0.flex.row,d.l0.justify.spaceBetween,d.l0.align.center],children:[(0,i.tZ)(l.h4,{level:2,variant:"subheadDefault",children:"Teardown"}),(0,i.tZ)(S.Z,{iconLeft:(0,i.tZ)(k.Z,{}),text:"Docs",href:"https://docs.replit.com/teams-edu/unit-testing",target:"_blank",variant:"outlined"})]}),(0,i.tZ)(c.G,{css:[d.l0.backgroundColor.backgroundDefault,d.l0.borderRadius(8),{border:"1px solid var(--background-highest)"}],children:(0,i.tZ)(c.G,{css:[d.l0.borderRadius(8),d.l0.height(200),d.l0.position.relative],children:(0,i.tZ)(N,{onChange:n,placeholder:"".concat(t.getCommentChar()," Add teardown code here"),editorRef:f,language:o,skeleton:p,skeletonClosingBracket:t.hasClosingBrackets()?t.getClosingBrackets():""})})})]})}var H=function(e){var t=e.language,n=e.meta,o=(0,r._)((0,h.useState)(!1),2),a=o[0],l=o[1];return(0,i.BX)(i.HY,{children:[(0,i.tZ)(_.zx,{iconLeft:(0,i.tZ)(D.Z,{}),onClick:function(){return l(!0)},text:"Setup"}),(0,i.tZ)(L,{language:t,isOpen:a,onClose:function(){return l(!1)},hasMetadata:!!(null==n?void 0:n.id),meta:n})]})},V=n(63257),z=n(95891),j=n(72310),q=n(18836),Y=n(85508),$=n(58719),J=n(2158),K=n(52924),Q=n(52682),ee=n(98924),et=n(43312),en=n(15006),er=n(20573),ei=n(10981),eo={success:(0,et.iv)({":not([disabled])":{borderColor:d.TV.accentPositiveStrongest}}),error:(0,et.iv)({":not([disabled])":{borderColor:d.TV.accentNegativeStrongest}}),warning:(0,et.iv)({":not([disabled])":{borderColor:d.TV.yellowStrongest}}),default:void 0,loading:void 0},ea={success:(0,et.iv)([{color:d.TV.accentPositiveStrongest}]),error:(0,et.iv)([{color:d.TV.accentNegativeStrongest}]),warning:(0,et.iv)([{color:d.TV.yellowStrongest}]),default:void 0,loading:void 0},el={success:(0,i.tZ)(T.Z,{}),error:(0,i.tZ)(en.Z,{}),warning:(0,i.tZ)(er.Z,{}),default:void 0,loading:(0,i.tZ)(s.Z,{})},ec=function(e){var t=el[e.state];return(0,i.BX)(c.G,{css:[ea[e.state],d.l0.rowWithGap(4)],children:[h.isValidElement(t)?h.cloneElement(t,{size:12}):null,(0,i.tZ)(l.xv,{variant:"small",multiline:!1,children:e.message})]})},es=(0,et.iv)("display:grid;grid-gap:",d.TV.space8,";grid-template-areas:'label . status'\n    'input input input'\n    'validation validation validation'\n    'details details details';> .label{grid-area:label;}> .status{grid-area:status;}> .input{grid-area:input;}> .details{grid-area:details;}> .validation{grid-area:validation;}"),eu=function(e){var t,n=e.id,r=e.label,o=e.status,a=e.description,c=e["aria-describedby"],s=e.error,u=e.isValid,f=e.touched,h=e.value,p=e.warning,g=e.successText,y=(0,ee._)(e,["id","label","status","description","aria-describedby","error","isValid","touched","value","warning","successText"]),b=(0,ei.U)(),Z=n||b("input"),w=o&&b("status"),x=a?b("description"):void 0,C=[w,x,c].filter(Boolean).join(" "),_=!(t={description:a,error:s,isValid:u,touched:f,value:h,warning:p,successText:g}).touched&&t.description?{state:"default",message:t.description}:t.error?{message:t.error.message,state:"error"}:t.warning?{message:t.warning.message,state:"warning"}:t.isValid?{message:t.successText||"",state:"success"}:t.touched?{message:"",state:"loading"}:void 0;return(0,i.BX)("div",{css:es,children:[(0,i.tZ)("label",{htmlFor:Z,className:"label",children:(0,i.tZ)(l.xv,{variant:"small",color:"dimmer",multiline:!1,children:r})}),o?(0,i.tZ)(l.xv,{multiline:!1,variant:"small",color:"dimmer",css:[d.l0.textAlign.right],className:"status",children:o}):null,(0,i.tZ)(q.II,(0,v._)((0,m._)({id:Z,className:"input",value:h,css:[eo[(null==_?void 0:_.state)||"default"]]},y),{"aria-describedby":C,"aria-invalid":(null==_?void 0:_.state)==="error"})),(0,i.tZ)("div",{id:x,className:"validation",css:[ea[(null==_?void 0:_.state)||"default"]],"aria-live":(null==_?void 0:_.state)!=="default"?"polite":void 0,children:_?(0,i.tZ)(ec,(0,m._)({},_)):null})]})},ed=n(75582),ef=n(27387),eh=n(96583),ep=n(43182),em=n(15250),ev=n(18107),eg=n(54916),ey=n(59109),eb="\x1b[0;31m",eZ="\x1b[0m",ew=["","","","","","","","","","","","","","","",""];function ex(e){var t=e.name,n=e.failureMessage,r=e.stack;return"	".concat(eb).concat(t).concat(eZ,"\r").concat(n?"\nMessage: ".concat(n,"\r"):"","\nStack Trace:\r\n").concat(r.replace(/\n/g,"\r\n"),"\n\r\n\r\n")}var eC=function(e){var t,n,o=e.language,a=e.unitTests,l=e.onResult,s=e.trackingContext,u=e.getRunnerOutput,d=(0,r._)((0,h.useState)(!1),2),f=d[0],p=d[1],v=(0,eg.Z)(),g=v.container,y=v.packager,b=v.fs,Z=null,w=u(),x=w&&void 0!==w.startBlock&&void 0!==w.endBlock&&void 0!==w.writeOutputToBlock&&void 0!==w.writeErrorToBlock,S=function(){p(!1),(0,ey.WT)(b),Z&&(Z.stopLogSpinner(),Z.finish(),Z=null)},E=(t=(0,ef._)(function(){var e,t,n,r,i,c,u,d,h,v,_,E,k,T,R,D,I,G,B,A,P,N,O,L;return(0,eh.Jh)(this,function(M){switch(M.label){case 0:if(f)return[2];if(t=null,Z={startLogSpinner:function(e){if(t)throw Error("A spinner is already active! call stopSpinner first or use the update callback to update the active spinner's message.");var n=e,r=0;return t=setInterval(function(){var e=ew[++r%ew.length];if(!Z)throw Error("Expected logger");Z.clearLine(),Z.logMessage(e+" "+n)},100),function(e){n=e}},stopLogSpinner:function(){t&&clearInterval(t),t=null},finish:function(){if(x&&e){var t;null==w||null===(t=w.endBlock)||void 0===t||t.call(w,e)}},logMessage:function(t){var n,r;if(x&&e){null==w||null===(r=w.writeOutputToBlock)||void 0===r||r.call(w,e,t);return}null==w||null===(n=w.write)||void 0===n||n.call(w,t)},logError:function(t){if(x&&e){var n;null==w||null===(n=w.writeErrorToBlock)||void 0===n||n.call(w,e,t)}},clearLogs:function(){var e;x||(null==w||null===(e=w.clear)||void 0===e||e.call(w),null==Z||Z.logMessage("\r\n"))},clearLine:function(){if(!Z)throw Error("Expected logger");Z.logMessage("\x1b[1K\r")}},!a)throw Error("Run button should not be active if there are no tests");return p(!0),(0,C.j)(C.U3.REPL_UNIT_TEST_USED,{trackingData:{context:s},action:"ranTests"}),Z.clearLogs(),x&&(e=null==w?void 0:null===(n=w.startBlock)||void 0===n?void 0:n.call(w,ev.kH.UNIT_TEST).id),[4,(r=(0,U.x)(o)).buildAndRunTests((0,m._)({container:g,fs:b,packager:y,logger:Z},a))];case 1:if(i=M.sent(),Z.stopLogSpinner(),Z.clearLine(),Z.clearLogs(),null!==i.error)return Z.logMessage("".concat(eb).concat(i.error).concat(eZ,"\r\n")),S(),a.tests.map(function(e){return{testId:e.id,didPass:!1}}),[2];if(c=i.result.passed?[]:i.result.failures.map(function(e){return r.parseTestResultName(e.name)}),u=[],d=a.tests.map(function(e){return r.getProperTestName(e.name)}),(h=c.filter(function(e){return!d.includes(e)})).length)_=h[0],E=i.result.failures[0].stack,Z.logMessage(ex({name:_,failureMessage:"The following error occurred but was not related to a single unit test",stack:E})),Z.logError("Testing failed"),(v=u).push.apply(v,(0,V._)(a.tests.map(function(e){return{testId:e.id,didPass:!1}})));else{k=!0,T=!1,R=void 0;try{for(D=a.tests[Symbol.iterator]();!(k=(I=D.next()).done);k=!0){if(G=I.value,B=r.getProperTestName(G.name),A=c.indexOf(B),P=-1===A,u.push({testId:G.id,didPass:P}),P){Z.logMessage("	".concat("\x1b[0;32m").concat(B).concat(eZ,"\r\n\r\n"));continue}N=i.result.failures[A].stack,Z.logMessage(ex({name:B,failureMessage:G.failureMessage,stack:N})),Z.logError('Test "'.concat(B,'" failed'))}}catch(e){T=!0,R=e}finally{try{k||null==D.return||D.return()}finally{if(T)throw R}}}if(l(u),O=a.tests.length,i.result.passed)return Z.logMessage("".concat("\x1b[48;5;22m","  All tests have passed ").concat(O,"/").concat(O,"  ").concat(eZ,"\r\n")),S(),[2];return L=O-i.result.failures.length,Z.logMessage("".concat("\x1b[48;5;88m","  ").concat(L,"/").concat(O," passed, see errors above  ").concat(eZ)),S(),[2]}})}),function(){return t.apply(this,arguments)}),k=(n=(0,ef._)(function(){return(0,eh.Jh)(this,function(e){try{E()}catch(e){ep.$e(function(t){t.setTag("unittestsrun","true"),ep.Tb(e)}),Z&&(Z.logMessage("\r\n".concat(eb," Sorry, we have failed to run your tests. Please try again or contact support. ").concat(eZ,"\r\n")),Z.logError("Running tests failed")),S()}return[2]})}),function(){return n.apply(this,arguments)});return a&&a.tests.length>0?(0,i.tZ)(c.G,{children:(0,i.tZ)(_.zx,{disabled:f,colorway:"primary",iconLeft:(0,i.tZ)(em.Z,{}),onClick:k,text:f?"Running tests...":"Run tests"})}):null};function e_(e){var t=e.isOpen,n=e.test,a=e.language,s=e.onClose,f=e.trackingContext,p=(0,o.Z)(),g=(0,x.Z)().showConfirm,y=(0,r._)((0,h.useState)(null),2),b=y[0],Z=y[1],w=(0,r._)((0,h.useState)(""),2),k=w[0],R=w[1],D=(0,r._)((0,h.useState)(""),2),I=D[0],G=D[1],B=(0,r._)((0,h.useState)(""),2),A=B[0],P=B[1],L=(0,r._)((0,O.Hd)({onError:function(e){return P(e.message)},update:function(e,t){var n,r=null===(n=t.data)||void 0===n?void 0:n.createReplUnitTest;r&&("UserError"===r.__typename?P(r.message):"ReplUnitTest"===r.__typename&&(e.modify({id:e.identify({__typename:"Repl",id:p}),fields:{unitTests:function(t){var n=e.writeFragment({data:r,fragment:O.Rb});return t?(0,v._)((0,m._)({},t),{tests:(0,V._)(t.tests).concat([n])}):{__typename:"ReplUnitTestsWithMeta",meta:null,tests:[n]}}}}),g("Test created!"),s()))}}),2),M=L[0],X=L[1],F=(0,r._)((0,O.kO)({onError:function(e){return P(e.message)},onCompleted:function(e){var t=e.updateReplUnitTest;t&&("UserError"===t.__typename?P(t.message):"ReplUnitTest"===t.__typename&&(g("Test updated!"),s()))}}),2),W=F[0],H=F[1],K=(0,j.Y)("",function(e){return e.length<=0?{message:"Must include test name"}:e.trim().split(" ").length>1?{message:"Test name must only be one word"}:void 0});(0,h.useEffect)(function(){K.setValue((null==n?void 0:n.name)||"",{preventTouch:!0}),G((null==n?void 0:n.failureMessage)||""),R((null==n?void 0:n.code)||""),b&&b.setValue((null==n?void 0:n.code)||"")},[n,b]),(0,h.useEffect)(function(){P("")},[k,P]);var Q=(0,U.x)(a),ee="".concat(Q.getCommentChar()," Enter code here"),et=!n||n.name!==K.value||n.code!==k||n.failureMessage!==I,en=X.loading||H.loading,er=Q.testIntro(K.value||""),ei=Q.hasClosingBrackets()?Q.getClosingBrackets():"",eo=(0,r._)((0,h.useState)(!1),2),ea=eo[0],el=eo[1],ec=function(){b&&(b.setValue("  "+Q.exampleTest.code),b.focus()),R(Q.exampleTest.code)};return(0,i.tZ)(E.u,{isOpen:t,onRequestClose:s,maxWidth:872,children:(0,i.BX)(c.G,{css:[d.l0.colWithGap(24)],children:[(0,i.tZ)(l.h4,{level:1,variant:"headerDefault",children:"New unit test"}),(0,i.BX)(c.G,{css:[d.l0.colWithGap(8)],children:[(0,i.tZ)("label",{htmlFor:"name",children:(0,i.tZ)(l.h4,{level:2,variant:"subheadDefault",children:"Name"})}),(0,i.tZ)(eu,{id:"name",label:"Test name",status:null,autoFocus:!0,required:!0,value:K.value,isValid:K.isValid,error:K.error,warning:K.warning,touched:K.touched,onChange:function(e){K.setValue(e.target.value)},placeholder:"Enter test name here"})]}),(0,i.BX)(c.G,{css:[d.l0.colWithGap(8)],children:[(0,i.BX)(c.G,{css:[d.l0.flex.row,d.l0.align.center,d.l0.justify.spaceBetween],children:[(0,i.tZ)(l.h4,{level:2,variant:"subheadDefault",children:"Code"}),(0,i.BX)(c.G,{css:[d.l0.rowWithGap(4)],children:[(0,i.BX)(z.Z,{isOpen:ea,onClickOutside:function(){return el(!1)},placement:"bottom-end",children:[(0,i.tZ)(_.zx,{iconLeft:(0,i.tZ)(J.Z,{}),size:"small",variant:"outlined",text:"View an example",onClick:function(){if([ee,Q.exampleTest.code].includes(k.trim())){ec();return}el(!0)}}),(0,i.BX)(c.G,{children:["This will overwrite your current test. Are you sure?",(0,i.BX)(c.G,{css:[d.l0.rowWithGap(4),d.l0.pt(8)],children:[" ",(0,i.tZ)(_.zx,{text:"No, go back",size:"small",iconLeft:(0,i.tZ)($.Z,{}),onClick:function(){el(!1)}}),(0,i.tZ)(_.zx,{text:"Yes, delete test",colorway:"negative",size:"small",iconLeft:(0,i.tZ)(T.Z,{}),onClick:function(){ec(),el(!1)}})]})]})]}),(0,i.tZ)(S.Z,{iconLeft:(0,i.tZ)(Y.Z,{}),size:"small",variant:"outlined",text:"View docs",target:"_blank",href:"https://docs.replit.com/teams-edu/unit-testing"})]})]}),(0,i.tZ)(c.G,{css:[d.l0.backgroundColor.backgroundDefault,d.l0.borderRadius(8),{border:"1px solid var(--background-highest)"}],children:(0,i.tZ)(c.G,{css:[d.l0.borderRadius(8),d.l0.height(200),d.l0.position.relative],children:(0,i.tZ)(N,{skeleton:er,skeletonClosingBracket:ei,language:a,editorRef:Z,onChange:R,placeholder:ee})})})]}),(0,i.BX)(c.G,{css:[d.l0.colWithGap(8)],children:[(0,i.tZ)(l.h4,{level:2,variant:"subheadDefault",children:"Failure message"}),(0,i.tZ)(q.II,{value:I,onChange:function(e){return G(e.target.value)},placeholder:"This will be displayed on test failure"})]}),(0,i.BX)(c.G,{css:[d.l0.flex.row,d.l0.align.center,d.l0.justify.spaceBetween],children:[(0,i.tZ)(l.xv,{css:[d.l0.color.accentNegativeStronger],multiline:!1,children:A}),(0,i.BX)(c.G,{css:[d.l0.rowWithGap(12)],children:[(0,i.tZ)(_.zx,{text:"Cancel",onClick:s}),(0,i.tZ)(_.zx,{text:"".concat(en?"Creating test...":"Create test"),iconLeft:(0,i.tZ)(u.Z,{}),colorway:"primary",disabled:!et||en,onClick:function(){if(!K.validate()){if(k.length<=0){P("Test cannot be empty");return}n?(W({variables:{input:{name:K.value,code:k,failureMessage:I,testId:n.id}}}),(0,C.j)(C.U3.REPL_UNIT_TEST_USED,{trackingData:{context:f},action:"modifiedTest"})):(M({variables:{input:{name:K.value,code:k,failureMessage:I,replId:p}}}),(0,C.j)(C.U3.REPL_UNIT_TEST_USED,{trackingData:{context:f},action:"addedTest"}))}}})]})]})]})})}function eS(e){var t=e.testId,n=e.onClose,a=(0,x.Z)().showConfirm,s=(0,o.Z)(),u=(0,r._)((0,O.IV)({onError:function(e){return b(e.message)},update:function(e,r){var i,o=null===(i=r.data)||void 0===i?void 0:i.deleteReplUnitTest;o&&("UserError"===o.__typename?b(o.message):"ReplUnitTest"===o.__typename&&t&&(e.modify({id:e.identify({__typename:"Repl",id:s}),fields:{unitTests:function(e,n){var r=n.readField,i=e.tests.filter(function(e){return r("id",e)!==t});return(0,v._)((0,m._)({},e),{tests:(0,V._)(i)})}}}),(0,C.j)(C.U3.REPL_UNIT_TEST_USED,{action:"removedTest"}),a("Test deleted!"),n()))}}),2),f=u[0],p=u[1],g=(0,r._)((0,h.useState)(""),2),y=g[0],b=g[1];return(0,i.tZ)(E.u,{isOpen:!!t,onRequestClose:n,children:(0,i.BX)(c.G,{css:[d.l0.colWithGap(24)],children:[(0,i.tZ)(l.h4,{level:1,variant:"headerDefault",children:"Delete test?"}),(0,i.tZ)(l.xv,{children:"Are you sure you want to delete this test? This cannot be undone."}),(0,i.BX)(c.G,{css:[d.l0.flex.row,d.l0.justify.spaceBetween,d.l0.align.center],children:[(0,i.tZ)(l.xv,{css:[d.l0.color.accentNegativeStronger],children:y}),(0,i.BX)(c.G,{css:[d.l0.rowWithGap(12),d.l0.justify.end],children:[(0,i.tZ)(_.zx,{text:"Cancel",disabled:p.loading,onClick:n}),(0,i.tZ)(_.zx,{text:"Yes, delete this test",colorway:"negative",iconLeft:(0,i.tZ)(Q.Z,{}),disabled:p.loading,onClick:function(){if(!t)throw Error("Expected a testId");f({variables:{testId:t}})}})]})]})]})})}var eE=function(e){var t=e.unitTests,n=e.isAddingTest,s=e.onClose,f=e.language,p=e.canWrite,m=e.trackingContext,v=void 0===m?"default":m,g=e.getRunnerOutput,b=(0,r._)((0,h.useState)(n),2),Z=b[0],w=b[1],x=(0,r._)((0,h.useState)(null),2),C=x[0],S=x[1],E=(0,r._)((0,h.useState)(null),2),k=E[0],T=E[1],R=(0,o.Z)(),D=(0,r._)((0,O.lQ)(),1)[0],I=(null==t?void 0:t.tests)||[];return(0,i.BX)(c.G,{css:[d.l0.colWithGap(16)],children:[(0,i.tZ)(eC,{language:f,unitTests:t,onResult:function(e){D({variables:{input:{replId:R,results:e},replId:R}})},getRunnerOutput:g,trackingContext:v}),I.length>0?(0,i.tZ)(c.G,{css:[d.l0.colWithGap(8),d.l0.align.center],children:I.map(function(e){var t,n;return(null===(t=e.lastRun)||void 0===t?void 0:t.__typename)==="ReplUnitTestLastRun"&&(e.lastRun.status===ed.$I.Passed?n="passed-test":e.lastRun.status===ed.$I.Failed&&(n="failed-test")),(0,i.tZ)(c.G,{className:"test ".concat(n),css:{width:"100%"},children:(0,i.BX)(c.G,{css:[d.l0.flex.row,d.l0.justify.spaceBetween,d.l0.align.center,d.l0.p(8),d.l0.borderRadius(8),{border:"1px solid var(--background-highest);"}],children:[(0,i.tZ)(l.xv,{multiline:!1,children:e.name}),p?(0,i.BX)(c.G,{css:[d.l0.rowWithGap(8)],children:[(0,i.tZ)(a.hU,{onClick:function(){S(e)},alt:"Edit",children:(0,i.tZ)(K.Z,{})}),(0,i.tZ)(a.hU,{onClick:function(){T(e.id)},alt:"Delete",children:(0,i.tZ)(Q.Z,{})})]}):null]})},e.id)})}):(0,i.BX)(c.G,{css:[d.l0.colWithGap(8),d.l0.align.center],children:[(0,i.tZ)(l.xv,{css:[d.l0.textAlign.center],children:"Looks like you dont have any tests yet!"}),p?(0,i.tZ)(_.zx,{text:"Add test",onClick:function(){return w(!0)},iconLeft:(0,i.tZ)(u.Z,{})}):null]}),(0,i.tZ)(e_,{isOpen:Z||!!C||n,test:C,language:f,onClose:function(){S(null),w(!1),s&&s()},trackingContext:v}),(0,i.tZ)(eS,{testId:k,onClose:function(){return T(null)}}),(0,i.tZ)(y(),{id:"a2df1ed8108a6cad",children:".tests-wrapper.jsx-a2df1ed8108a6cad{-webkit-border-radius:var(--border-radius-4);-moz-border-radius:var(--border-radius-4);border-radius:var(--border-radius-4);padding:var(--space-16)0;width:100%}.test.jsx-a2df1ed8108a6cad{padding:var(--space-8)var(--space-8);border:1px solid var(--outline-dimmest);-webkit-border-radius:var(--border-radius-4);-moz-border-radius:var(--border-radius-4);border-radius:var(--border-radius-4)}.passed-test.jsx-a2df1ed8108a6cad{border-color:var(--accent-positive-default);background:var(--accent-positive-dimmer)}.failed-test.jsx-a2df1ed8108a6cad{border-color:var(--accent-negative-default);background:var(--accent-negative-dimmer)}"})]})},ek=n(31593),eT=function(e){var t,n,m,v,g=e.onBack,y=e.getRunnerOutput,b=(0,o.Z)(),Z=(0,r._)((0,h.useState)(!1),2),x=Z[0],C=Z[1],_=(0,ek.Z)(),S=_.language,E=_.isLoading,k=(0,p.CH)({variables:{replId:b}}),T=null===(t=k.data)||void 0===t?void 0:t.repl;if(k.loading||E)return(0,i.tZ)(c.G,{css:[d.l0.backgroundColor.backgroundDefault,d.l0.flex.row,d.l0.align.center,d.l0.justify.center,d.l0.p(16)],children:(0,i.tZ)(s.Z,{})});if(!T||"Repl"!==T.__typename)return(0,i.tZ)(c.G,{css:[d.l0.p(16)],children:(0,i.tZ)(l.xv,{css:{textAlign:"center"},children:"Unable to fetch tests, please try again."})});if(!S)return(0,i.tZ)(c.G,{css:[d.l0.p(16)],children:(0,i.tZ)(l.xv,{css:{textAlign:"center"},children:"Unit tests are currently only supported in Java, Python, and Node.js Repls."})});var R="default";(null==T?void 0:T.isProject)?R="project_repl":(null==T?void 0:T.isProjectFork)&&(R="submission_repl");var D=!!((null===(n=T.unitTests)||void 0===n?void 0:n.tests)&&T.unitTests.tests.length>0);return(null==T?void 0:null===(m=T.currentUserPermissions)||void 0===m?void 0:m.writeTests)?(0,i.BX)(c.G,{css:[d.l0.colWithGap(16),d.l0.align.center],children:[(0,i.BX)(c.G,{css:[d.l0.flex.row,d.l0.justify.spaceBetween,d.l0.align.center,{width:"100%"}],children:[(0,i.tZ)(f.Z,{truncate:!0,level:4,children:"Unit tests"}),(0,i.tZ)(a.hU,{alt:"Add test",size:32,onClick:function(){return C(!0)},children:(0,i.tZ)(u.Z,{})})]}),(0,i.BX)(c.G,{css:[d.l0.colWithGap(8),d.l0.maxWidth(256),{width:"80%"}],children:[(0,i.tZ)(H,{language:S,meta:(null===(v=T.unitTests)||void 0===v?void 0:v.meta)||null}),(0,i.tZ)(eE,{isAddingTest:x,unitTests:(null==T?void 0:T.unitTests)||null,onClose:function(){return C(!1)},language:S,canWrite:!0,trackingContext:R,getRunnerOutput:y}),g?(0,i.tZ)(w,{hasTests:D,onClick:g}):null]})]}):(0,i.BX)(c.G,{css:[d.l0.colWithGap(16)],children:[(0,i.tZ)(l.h4,{level:1,variant:"headerDefault",children:"Unit tests"}),(0,i.tZ)(c.G,{css:{width:"100%",overflowY:"auto"},children:(0,i.tZ)(eE,{unitTests:(null==T?void 0:T.unitTests)||null,language:S,isAddingTest:!1,canWrite:!1,trackingContext:R,getRunnerOutput:y})})]})}},68809:function(e,t,n){n.d(t,{x:function(){return k},y:function(){return E}});var r=n(27387),i=n(63257),o=n(96583),a=n(51305),l=n(43182),c=n(59868),s=n(12285),u=function(){"use strict";function e(t){(0,s._)(this,e),this.code="",this.currentIndent=0,this.lib=t}var t=e.prototype;return t.indent=function(){this.currentIndent+=1},t.dedent=function(){if(0===this.currentIndent)throw Error("indent at zero");this.currentIndent-=1},t.addIndents=function(){for(var e=0;e<this.currentIndent;e++)this.code+="  "},t.push=function(e){var t=e.split("\n"),n=!0,r=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value;this.addIndents(),this.code+=l,this.newLine()}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}},t.newLine=function(){this.code+="\n"},t.closeCurly=function(){this.addIndents(),this.code+=this.lib.getClosingBrackets()},t.toString=function(){return this.code},e}(),d=n(59109),f={testRunnerName:function(){return"TestRunner"},testSuiteName:function(){return"TestSuite"},defaultImports:function(){return"import org.junit.Before;\nimport org.junit.After;\nimport org.junit.Test;\nimport static org.junit.Assert.*;"},classIntro:function(){return"public class ".concat((0,d.Og)(f.testSuiteName())," {")},classConstructorName:function(){return(0,d.Og)(f.testSuiteName())},setupIntro:function(){return"@Before\npublic void setUp() {"},tearDownIntro:function(){return"@After\npublic void tearDown() {"},testIntro:function(e){return"".concat(f.testIntroPreName()).concat(e).concat(f.testIntroPostName())},testIntroPreName:function(){return"@Test\npublic void "},testIntroPostName:function(){return"() {"},getProperTestName:function(e){return e},parseTestResultName:function(e){return e.replace("(".concat((0,d.Og)(f.testSuiteName()),")"),"")},buildSuite:function(e){var t=e.tests,n=e.meta,r=new u(f);r.push(f.defaultImports()),n&&n.imports&&r.push(n.imports),r.newLine(),r.push(f.classIntro()),r.newLine(),r.indent(),n&&(n.initialization&&(r.push(n.initialization),r.newLine()),n.setup&&(r.push(f.setupIntro()),r.indent(),r.push(n.setup),r.dedent(),r.closeCurly(),r.newLine(),r.newLine()),n.tearDown&&(r.push(f.tearDownIntro()),r.indent(),r.push(n.tearDown),r.dedent(),r.closeCurly(),r.newLine(),r.newLine()));var i=!0,o=!1,a=void 0;try{for(var l,c=t[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var s=l.value;s.code&&(r.push(f.testIntro(s.name)),r.indent(),r.push(s.code),r.dedent(),r.closeCurly(),r.newLine(),r.newLine())}}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}return r.dedent(),r.closeCurly(),r.toString()},runSuite:function(e){return v.apply(this,arguments)},buildAndRunTests:function(e){var t=e.container,n=e.fs,r=e.packager,i=e.logger,o=e.tests,a=e.meta,l=f.buildSuite({tests:o,meta:a});return f.runSuite({container:t,fs:n,packager:r,logger:i,suiteCode:l})},hasClosingBrackets:function(){return!0},getClosingBrackets:function(){return"}"},hasSemicolon:function(){return!0},getCommentChar:function(){return"//"},getHelpText:function(){return"no react in this bitch either"},captureSetupError:function(e){var t=e.tag,n=e.raw;l.$e(function(e){e.setTag("unitTestLib","true"),e.setExtra("raw",n),e.setExtra("language","java10"),l.Tb(t)})},exampleTest:{id:-1,failureMessage:"An Adder class should have an add method that adds two ints and returns the result",name:"add",code:"Adder adder = new Adder();\nint result = adder.add(1, 2);\nassertEquals(3, result);\n"}},h="__UNIT_TEST_RESULT_START__",p="__UNIT_TEST_RESULT_END__",m="import org.json.simple.JSONArray;\nimport org.json.simple.JSONObject;\nimport org.junit.runner.JUnitCore;\nimport org.junit.runner.Result;\nimport org.junit.runner.notification.Failure;\n\npublic class ".concat((0,d.Og)(f.testRunnerName())," {\n    public static void main(String[] args) {\n      Result result = JUnitCore.runClasses(").concat((0,d.Og)(f.testSuiteName()),'.class);\n      JSONArray failures = new JSONArray();\n\n        for (Failure failure : result.getFailures()) {\n            JSONObject obj = new JSONObject();\n            obj.put("name", failure.getTestHeader());\n            obj.put("stack", failure.getTrace());\n            failures.add(obj);\n        }\n        JSONObject out = new JSONObject();\n        out.put("passed", result.wasSuccessful());\n        out.put("failures", failures);\n        System.out.println();\n        System.out.println("').concat(h,'");\n        System.out.println(out);\n        System.out.println("').concat(p,'");\n    }\n}');function v(){return(v=(0,r._)(function(e){var t,n,r,l,s,u,v,g,y,b,Z,w,x,C,_,S,E,k,T,R,D;return(0,o.Jh)(this,function(o){switch(o.label){case 0:return t=e.container,n=e.fs,r=e.packager,l=e.logger,s=e.suiteCode,v=l.startLogSpinner("Setting up the environment"),[4,(0,d.WT)(n)];case 1:return o.sent(),v("Creating your test files 1/2"),[4,(0,d.e3)({fs:n,code:s,filename:"".concat(f.testSuiteName(),".java")})];case 2:if(g=o.sent().error)return f.captureSetupError({tag:"Failed to create suite code file",raw:g}),[2,{error:"There was an error creating a test file, if this happens again, please contact support."}];return v("Creating your test files 2/2"),[4,(0,d.e3)({fs:n,code:m,filename:"".concat(f.testRunnerName(),".java")})];case 3:if(y=o.sent().error)return f.captureSetupError({tag:"Failed to create test runner file",raw:y}),[2,{error:"There was an error creating a test file, if this happens again, please contact support."}];return l.stopLogSpinner(),l.clearLine(),l.logMessage("Installing imported packages\r\n"),[4,r.addPackages([{name:"junit:junit",version:"4.12"},{name:"com.googlecode.json-simple:json-simple",version:"1.1.1"},{name:"org.hamcrest:hamcrest-core",version:"1.3"}])];case 4:return o.sent(),[4,r.installPackages(a.D.active())];case 5:if(o.sent().error)return[2,{error:"Failed to install packages\r\n"}];return l.clearLogs(),v=l.startLogSpinner("Compiling your files"),[4,t.exec("find",".","-type","f","-name","*.java","-print0")];case 6:if(Z=(b=o.sent()).output,w=b.error)return x="Failed to fetch working directory java files",f.captureSetupError({tag:x,raw:w}),[2,{error:"".concat(x,"\r\n\r\n")+(null==Z?void 0:Z.replace(/\n/g,"\n\r"))+"\r\n\r\n"+w}];if("string"!=typeof Z)throw Error("expected working directory files to be a string");return C=Z.slice(0,-1).split("\x00"),_=".:./target/dependency/*",[4,(u=t).exec.apply(u,["javac","-classpath",_,"-d","."].concat((0,i._)(C)))];case 7:if(E=(S=o.sent()).output,k=S.error)return[2,{error:"".concat("Failed to compile test runner file","\r\n\r\n")+(null==E?void 0:E.replace(/\n/g,"\n\r"))+"\r\n\r\n"+k}];return v("Running your tests"),[4,t.exec("java","-classpath",_,(0,d.Og)(f.testRunnerName()))];case 8:if(R=(T=o.sent()).output,D=T.error)return(0,c.j)(c.U3.REPL_UNIT_TEST_CONSTRUCTION_ERROR_INTERNAL),[2,{error:"Running tests failed\r\n\r\n"+(null==R?void 0:R.replace(/\n/g,"\n\r"))+"\r\n\r\n"+D}];if("string"!=typeof R)throw Error("expected runOutput to be a string");return[2,{result:JSON.parse(R.slice(R.indexOf(h)+h.length,R.lastIndexOf(p))),error:null}]}})})).apply(this,arguments)}var g=function(e){return!!e&&e.trim().length>0&&e.split("\n").some(function(e){return!(e.trim().startsWith("#")||""===e.trim())})},y={testRunnerName:function(){return"test_runner"},testSuiteName:function(){return"test_suite"},defaultImports:function(){return"import unittest\nfrom main import *\n"},classIntro:function(){return"class UnitTests(unittest.TestCase):"},classConstructorName:function(){return"__init__"},setupIntro:function(){return"def setUp(self):"},tearDownIntro:function(){return"def tearDown(self):"},testIntro:function(e){return y.testIntroPreName()+e+y.testIntroPostName()},testIntroPreName:function(){return"def test_"},testIntroPostName:function(){return"(self):"},getProperTestName:function(e){return"test_".concat(e)},parseTestResultName:function(e){return e},buildSuite:function(e){var t=e.tests,n=e.meta,r=new u(y);r.push(y.defaultImports()),n&&n.imports&&r.push(n.imports),r.newLine(),r.push(y.classIntro()),r.newLine(),r.indent(),n&&(n.initialization&&(r.push(n.initialization),r.newLine()),g(n.setup)&&(r.push(y.setupIntro()),r.indent(),r.push(n.setup),r.dedent(),r.newLine()),g(n.tearDown)&&(r.push(y.tearDownIntro()),r.indent(),r.push(n.tearDown),r.dedent(),r.newLine()));var i=!0,o=!1,a=void 0;try{for(var l,c=t[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var s=l.value;r.push(y.testIntro(s.name)),r.indent(),r.push(s.code||"pass"),r.dedent(),r.newLine()}}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}return r.toString()},runSuite:function(e){return x.apply(this,arguments)},buildAndRunTests:function(e){var t=e.container,n=e.fs,r=e.packager,i=e.logger,o=e.tests,a=e.meta,l=y.buildSuite({tests:o,meta:a});return y.runSuite({container:t,fs:n,packager:r,logger:i,suiteCode:l})},hasClosingBrackets:function(){return!1},getClosingBrackets:function(){throw Error("This language does not have closing brackets, check `hasClosingBrackets` first")},hasSemicolon:function(){return!1},getCommentChar:function(){return"#"},getHelpText:function(){return"no react in this bitch"},captureSetupError:function(e){var t=e.tag,n=e.raw;l.$e(function(e){e.setTag("unitTestLib","true"),e.setExtra("raw",n),e.setExtra("language","python3"),l.Tb(t)})},exampleTest:{id:-1,failureMessage:"In main.py you should have an add functions that adds two numbers and returns the result",name:"add",code:"self.assertEquals(add(1, 2), 3)"}},b="__UNIT_TEST_RESULT_START__",Z="__UNIT_TEST_RESULT_END__",w="import unittest\nimport ".concat((0,d.Og)(y.testSuiteName()),"\nimport os\nimport json\nfrom time import sleep\n\nsuite = unittest.TestLoader().loadTestsFromTestCase(\n  ").concat((0,d.Og)(y.testSuiteName()),'.UnitTests)\nf = open(os.devnull,"w")\ntest_res = unittest.TextTestRunner(stream=f).run(suite)\n\n# Merge errors and failures and normalize to {name, stack}\nfailures = [\n    {\n        "name": r[0]._testMethodName,\n        "stack": r[1],\n    } for r in test_res.errors + test_res.failures\n]\nprint()\nprint(\'').concat(b,'\')\nsleep(1)\nprint(json.dumps({\n    "passed": test_res.wasSuccessful(),\n    "failures": failures,\n}))\nprint()\nprint(\'').concat(Z,"');");function x(){return(x=(0,r._)(function(e){var t,n,r,i,l,s,u,f,h,p,m;return(0,o.Jh)(this,function(o){switch(o.label){case 0:return t=e.container,n=e.fs,r=e.packager,i=e.logger,l=e.suiteCode,s=i.startLogSpinner("Setting up the environment"),[4,(0,d.WT)(n)];case 1:return o.sent(),s("Creating your test files 1/2"),[4,(0,d.e3)({fs:n,code:l,filename:"".concat(y.testSuiteName(),".py")})];case 2:if(u=o.sent().error)return y.captureSetupError({tag:"Failed to create suite code file",raw:u}),[2,{error:"There was an error creating a test file, if this happens again, please contact support."}];return s("Creating your test files 2/2"),[4,(0,d.e3)({fs:n,code:w,filename:"".concat(y.testRunnerName(),".py")})];case 3:if(f=o.sent().error)return y.captureSetupError({tag:"Failed to create test runner file",raw:f}),[2,{error:"There was an error creating a test file, if this happens again, please contact support."}];return i.stopLogSpinner(),i.clearLine(),i.logMessage("Installing imported packages\r\n"),[4,r.installPackages(a.D.active())];case 4:if(o.sent().error)return[2,{error:"Failed to install packages\r\n"}];return i.clearLogs(),i.startLogSpinner("Running your tests"),[4,t.exec("python","-B",(0,d.Og)("".concat(y.testRunnerName(),".py")))];case 5:if(p=(h=o.sent()).output,m=h.error)return(0,c.j)(c.U3.REPL_UNIT_TEST_CONSTRUCTION_ERROR_INTERNAL),[2,{error:"Running tests failed\r\n\r\n"+(null==p?void 0:p.replace(/\n/g,"\n\r"))+"\r\n"+m}];if("string"!=typeof p)throw Error("expected runoutput to be a string");return[2,{result:JSON.parse(p.slice(p.indexOf(b)+b.length,p.lastIndexOf(Z))),error:null}]}})})).apply(this,arguments)}var C={testRunnerName:function(){throw Error("Node test runner uses jest directly")},testSuiteName:function(){return"test_suite"},defaultImports:function(){return"const index = require('./index.js');"},classIntro:function(){return'describe("UnitTests", function() {'},classConstructorName:function(){return null},setupIntro:function(){return"beforeAll(async function() {"},tearDownIntro:function(){return"afterAll(async function() {"},testIntro:function(e){return C.testIntroPreName()+e+C.testIntroPostName()},testIntroPreName:function(){return'test("'},testIntroPostName:function(){return'", async function() {'},getProperTestName:function(e){return e},parseTestResultName:function(e){return e},buildSuite:function(e){var t=e.tests,n=e.meta,r=new u(C);r.push(C.defaultImports()),n&&n.imports&&r.push(n.imports),r.newLine(),r.push(C.classIntro()),r.newLine(),r.indent(),n&&(n.initialization&&(r.push(n.initialization),r.newLine()),n.setup&&(r.push(C.setupIntro()),r.indent(),r.push(n.setup),r.dedent(),r.closeCurly(),r.newLine(),r.newLine()),n.tearDown&&(r.push(C.tearDownIntro()),r.indent(),r.push(n.tearDown),r.dedent(),r.closeCurly(),r.newLine(),r.newLine()));var i=!0,o=!1,a=void 0;try{for(var l,c=t[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var s=l.value;s.code&&(r.push(C.testIntro(s.name)),r.indent(),r.push(s.code),r.dedent(),r.closeCurly(),r.newLine(),r.newLine())}}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}return r.dedent(),r.closeCurly(),r.toString()},runSuite:function(e){return _.apply(this,arguments)},buildAndRunTests:function(e){var t=e.container,n=e.fs,r=e.packager,i=e.logger,o=e.tests,a=e.meta,l=C.buildSuite({tests:o,meta:a});return C.runSuite({container:t,fs:n,packager:r,logger:i,suiteCode:l})},hasClosingBrackets:function(){return!0},getClosingBrackets:function(){return"});"},hasSemicolon:function(){return!0},getCommentChar:function(){return"//"},getHelpText:function(){return"no react yet"},captureSetupError:function(e){var t=e.tag,n=e.raw;l.$e(function(e){e.setTag("unitTestLib","true"),e.setExtra("raw",n),e.setExtra("language","nodejs"),l.Tb(t)})},exampleTest:{id:-1,failureMessage:"",name:"add",code:"expect(index.add(1, 2)).toBe(3);"}};function _(){return(_=(0,r._)(function(e){var t,n,r,i,l,s,u,f,h,p,m,v,g,y,b,Z,w,x,_;return(0,o.Jh)(this,function(o){switch(o.label){case 0:return t=e.container,n=e.fs,r=e.packager,i=e.logger,l=e.suiteCode,s=i.startLogSpinner("Setting up the environment"),[4,(0,d.WT)(n)];case 1:return o.sent(),s("Creating your test files 1/2"),[4,(0,d.e3)({fs:n,code:l,filename:"".concat(C.testSuiteName(),".js")})];case 2:if(u=o.sent().error)return C.captureSetupError({tag:"Failed to create suite code file",raw:u}),[2,{error:"There was an error creating a test file, if this happens again, please contact support."}];return s("Creating your test files 2/2"),f=69,h="jest.config.json",p={testRegex:(0,d.Og)("".concat(C.testSuiteName(),".js")),testEnvironment:"node",testFailureExitCode:f},[4,(0,d.e3)({fs:n,code:JSON.stringify(p),filename:h})];case 3:if(m=o.sent().error)return C.captureSetupError({tag:"Failed to create config file",raw:m}),[2,{error:"There was an error creating a test file, if this happens again, please contact support."}];return i.stopLogSpinner(),i.clearLine(),i.logMessage("Installing imported packages\r\n"),[4,r.installPackages(a.D.active())];case 4:if(o.sent().error)return[2,{error:"Failed to install packages\r\n"}];return i.clearLogs(),s=i.startLogSpinner("Running your tests"),v=(0,d.Og)("output.json"),[4,t.exec("jest","--json","--outputFile",v,"--config",(0,d.Og)(h),"--forceExit","--passWithNoTests")];case 5:if(y=(g=o.sent()).output,(b=g.error)&&!b.endsWith(f.toString()))return(0,c.j)(c.U3.REPL_UNIT_TEST_CONSTRUCTION_ERROR_INTERNAL),[2,{error:"Running tests failed\r\n\r\n"+(null==y?void 0:y.replace(/\n/g,"\n\r"))+"\r\n"+b}];return s("Parsing your test results"),[4,n.readFile(v)];case 6:if((Z=o.sent()).error)return C.captureSetupError({tag:"Error reading test results",raw:Z.error}),[2,{error:"There was an error getting test results, if this happens please contact support."}];if((w=JSON.parse(Z.content.toString())).success)return[2,{error:null,result:{passed:!0,failures:[]}}];if(!(_=(x=w.testResults[0]).assertionResults.filter(function(e){return"passed"!==e.status}).map(function(e){return{name:e.title,stack:e.failureMessages[0]}})).length)return[2,{error:x.message.replace(/\n/g,"\r\n")}];return[2,{error:null,result:{passed:!1,failures:_}}]}})})).apply(this,arguments)}var S={java10:f,java10_beta:f,java:f,python3:y,python3_beta:y,python:y,nodejs:C,javascript:C,nodejs_beta:C};function E(e){return e in S}function k(e){if(!E(e))throw Error("".concat(e," is not a supported unit testing language, it has to be one of ").concat(Object.keys(S)));return S[e]}},59109:function(e,t,n){n.d(t,{Og:function(){return u},WT:function(){return h},e3:function(){return d}});var r=n(27387),i=n(96583),o=n(43182),a=n(41500),l=n(39756),c=n(30084),s="_test_runner";function u(e){return s+e}function d(e){return f.apply(this,arguments)}function f(){return(f=(0,r._)(function(e){var t,n,r,o;return(0,i.Jh)(this,function(i){return t=e.fs,n=e.code,r=s+e.filename,o=a.Z.from(n,"utf8"),[2,t.writeFile(r,o)]})})).apply(this,arguments)}function h(e){return p.apply(this,arguments)}function p(){return(p=(0,r._)(function(e){var t,n;return(0,i.Jh)(this,function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),[4,e.readDir(l.Ql)];case 1:if((t=r.sent()).error)return[2];return[4,Promise.all(t.children.map(function(t){return t.filename.startsWith(s)?t.type===c.Tv.File?e.deleteFile(t.filename):e.deleteDir(t.filename):Promise.resolve(null)}))];case 2:return r.sent(),[3,4];case 3:return n=r.sent(),o.$e(function(e){e.setTag("unitTestLib","true"),o.Tb(n)}),[3,4];case 4:return[2]}})})).apply(this,arguments)}},79962:function(e,t,n){n.d(t,{AF:function(){return w},Hd:function(){return C},IV:function(){return k},Rb:function(){return g},aA:function(){return v},kO:function(){return S},lQ:function(){return R},rU:function(){return b}});var r=n(41733),i=n(21262),o=n(71440),a=n(99165);function l(){var e=(0,i._)(["\n  fragment UnitTestsReplUnitTestMeta on ReplUnitTestMeta {\n    id\n    imports\n    initialization\n    setup\n    tearDown\n  }\n"]);return l=function(){return e},e}function c(){var e=(0,i._)(["\n  fragment UnitTestsReplUnitTest on ReplUnitTest {\n    id\n    name\n    code\n    failureMessage\n  }\n"]);return c=function(){return e},e}function s(){var e=(0,i._)(["\n  mutation createUnitTestMeta($input: CreateReplUnitTestMetaInput!) {\n    createReplUnitTestMeta(input: $input) {\n      ... on ReplUnitTestMeta {\n        id\n        ...UnitTestsReplUnitTestMeta\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return s=function(){return e},e}function u(){var e=(0,i._)(["\n  mutation updateUnitTestMeta($input: UpdateReplUnitTestMetaInput!) {\n    updateReplUnitTestMeta(input: $input) {\n      ... on ReplUnitTestMeta {\n        id\n        ...UnitTestsReplUnitTestMeta\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return u=function(){return e},e}function d(){var e=(0,i._)(["\n  mutation createUnitTest($input: CreateReplUnitTestInput!) {\n    createReplUnitTest(input: $input) {\n      ... on ReplUnitTest {\n        id\n        ...UnitTestsReplUnitTest\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return d=function(){return e},e}function f(){var e=(0,i._)(["\n  mutation updateUnitTest($input: UpdateReplUnitTestInput!) {\n    updateReplUnitTest(input: $input) {\n      ... on ReplUnitTest {\n        id\n        ...UnitTestsReplUnitTest\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return f=function(){return e},e}function h(){var e=(0,i._)(["\n  mutation deleteUnitTest($testId: Int!) {\n    deleteReplUnitTest(testId: $testId) {\n      ... on ReplUnitTest {\n        id\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n"]);return h=function(){return e},e}function p(){var e=(0,i._)(["\n  mutation updateReplUnitTestLastRun(\n    $input: UpdateReplUnitTestLastRunInput!\n    $replId: String!\n  ) {\n    updateReplUnitTestLastRun(input: $input) {\n      ... on UpdateReplUnitTestLastRunUpdatedTests {\n        __typename\n        updatedTests {\n          ... on ReplUnitTest {\n            id\n            __typename\n            lastRun(replId: $replId) {\n              ... on ReplUnitTestLastRun {\n                __typename\n                status\n              }\n              ... on UserError {\n                __typename\n                message\n              }\n            }\n          }\n          ... on UserError {\n            __typename\n            message\n          }\n        }\n      }\n      ... on UserError {\n        __typename\n        message\n      }\n    }\n  }\n"]);return p=function(){return e},e}var m={},v=(0,o.Ps)(l()),g=(0,o.Ps)(c()),y=(0,o.Ps)(s(),v);function b(e){var t=(0,r._)({},m,e);return a.D(y,t)}var Z=(0,o.Ps)(u(),v);function w(e){var t=(0,r._)({},m,e);return a.D(Z,t)}var x=(0,o.Ps)(d(),g);function C(e){var t=(0,r._)({},m,e);return a.D(x,t)}var _=(0,o.Ps)(f(),g);function S(e){var t=(0,r._)({},m,e);return a.D(_,t)}var E=(0,o.Ps)(h());function k(e){var t=(0,r._)({},m,e);return a.D(E,t)}var T=(0,o.Ps)(p());function R(e){var t=(0,r._)({},m,e);return a.D(T,t)}},31593:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(66626),i=n(66349),o=n(54916),a=n(50959),l=n(59808),c=n(68809);function s(){var e=(0,i.Z)(),t=(0,o.Z)().dotReplit,n=null==e?void 0:e.language,s=(0,r._)((0,a.useState)(null),2),u=s[0],d=s[1],f=(0,r._)((0,a.useState)(!0),2),h=f[0],p=f[1];return(0,a.useEffect)(function(){if(n){if((0,c.y)(n)){d(n),p(!1);return}var e=!1,r=t.watch(function(t){if(e||(e=!0,p(!1)),t.error){t.error===l.Yt.NotFound&&d(null);return}var n,r,i=null===(r=t.config.unitTest)||void 0===r?void 0:null===(n=r.language)||void 0===n?void 0:n.toLowerCase();i&&(0,c.y)(i)?d(i):d(null)});return function(){r()}}},[n,t]),{language:u,isLoading:h}}},39783:function(e,t,n){n.d(t,{Q:function(){return o}});var r=n(74985),i=n(50959);function o(e){var t=e.uploadFiles,n=e.fileUploadInputRef,o=e.dirUploadInputRef,a=(0,i.useRef)(Math.random().toString(36));return(0,r.BX)(r.HY,{children:[(0,r.tZ)("input",{style:{display:"none"},ref:n,id:"file-upload-input-".concat(a.current),type:"file",onChange:function(e){var n=e.target.files;n&&t({files:Array.from(n)})},onClick:function(e){e.currentTarget.value=""},multiple:!0,accept:"*"}),(0,r.tZ)("input",{style:{display:"none"},ref:o,id:"dir-upload-input-".concat(a.current),type:"file",onChange:function(e){var n=e.target.files;n&&t({files:Array.from(n)})},onClick:function(e){e.currentTarget.value=""},webkitdirectory:"true",mozdirectory:"true",msdirectory:"true",odirectory:"true",directory:"true",accept:"*"})]})}},81810:function(e,t,n){n.d(t,{ZP:function(){return eD},wK:function(){return e_}});var r,i,o=n(12285),a=n(42516),l=n(41733),c=n(66626),s=n(74985),u=n(43312),d=n(56337),f=n(22487),h=n(25425),p=n(7444),m=n(50199),v=n(10041),g=n(73157),y=n(1498),b=n(70002),Z=n(15146),w=n(18836),x=n(49344),C=n(85195),_=n(38080),S=n(74833),E=n(30983),k=n(56596),T=n(93918),R=n(40102),D=n(12874),I=n(41859),G=n(52924),B=n(44620),A=n(88936),P=n(57122),N=n(58003),U=n(67337),O=n(20573),L=n(29287),M=n(10981),X=n(66985),F=n(52234),W=n(74652),H=n(33988),V=n.n(H),z=n(50959),j=n(98924),q=n(76999),Y=n.n(q),$=n(21262),J=n(71440),K=n(58995),Q=n(99165);function ee(){var e=(0,$._)(["\n  fragment EditDomainRepl on Repl {\n    id\n    hostedUrl\n    apexProxy\n    domains {\n      hosting_deployment_id\n      domain\n      state\n    }\n  }\n"]);return ee=function(){return e},e}function et(){var e=(0,$._)(["\n  query EditDomain($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        ...EditDomainRepl\n      }\n      ... on ReplRedirect {\n        replUrl\n      }\n      ... on SubscriptionExpiredError {\n        replId\n      }\n    }\n  }\n  ","\n"]);return et=function(){return e},e}function en(){var e=(0,$._)(["\n  query EditDomainCheckDomain2($replId: String!, $domain: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        checkDomain2(domain: $domain) {\n          ... on DomainStatus2 {\n            verified\n            retry\n            status\n            records {\n              A\n              TXT\n              CNAME\n            }\n          }\n          ... on NotFoundError {\n            message\n          }\n          ... on ServiceUnavailable {\n            message\n          }\n        }\n      }\n    }\n  }\n"]);return en=function(){return e},e}function er(){var e=(0,$._)(["\n  mutation EditDomainLinkReplDomain2(\n    $replId: String!\n    $domain: String!\n    $deploymentId: String\n  ) {\n    linkReplDomain2(\n      replId: $replId\n      domain: $domain\n      deploymentId: $deploymentId\n    ) {\n      __typename\n      ... on Repl {\n        id\n        ...EditDomainRepl\n      }\n      ... on UnauthorizedError {\n        message\n      }\n      ... on NotFoundError {\n        message\n      }\n      ... on ServiceUnavailable {\n        message\n      }\n    }\n  }\n  ","\n"]);return er=function(){return e},e}function ei(){var e=(0,$._)(["\n  mutation EditDomainUpdateRepl($input: UpdateReplInput!) {\n    updateRepl(input: $input) {\n      repl {\n        id\n        ...EditDomainRepl\n      }\n    }\n  }\n  ","\n"]);return ei=function(){return e},e}var eo={},ea=(0,J.Ps)(ee()),el=(0,J.Ps)(et(),ea),ec=(0,J.Ps)(en()),es=(0,J.Ps)(er(),ea),eu=(0,J.Ps)(ei(),ea),ed=n(43182),ef=n(32377),eh=n(58719),ep=n(8017),em=n(99656),ev=n(52682),eg=n(32508),ey=n.n(eg);function eb(e){switch(e.status){case"verified":return(0,s.tZ)(ef.Z,{color:L.TV.accentPositiveDefault});case"failed":return(0,s.tZ)(eh.Z,{color:L.TV.accentNegativeDefault});case"verifying":return(0,s.tZ)(A.Z,{color:L.TV.accentPrimaryDefault});default:return null}}function eZ(e){var t,n=e.replId,r=e.hostedUrl,i=e.desiredARecord,o=e.existingDomain,a=e.onLink,u=e.onGoBack,d=e.onLinkStarted,f=e.onStateChanged,h=(0,c._)((0,z.useState)(o?"loading":null),2),p=h[0],m=h[1],g=(0,c._)((0,z.useState)(!1),2),b=g[0],Z=g[1],x=(0,c._)((0,z.useState)(null),2),C=x[0],_=x[1],E=(0,c._)((0,z.useState)(!1),2),T=E[0],R=E[1],D=(0,c._)((t=(0,l._)({},eo,void 0),Q.D(es,t)),2),I=D[0],G=D[1],B=(0,z.useRef)(null),A=(0,z.useRef)(null),P=(0,z.useRef)(null),N=function(e){(null==e?void 0:e.current)&&e.current.select()},U=function(e){var t;(null==e?void 0:null===(t=e.current)||void 0===t?void 0:t.value)&&(0,v.Z)(e.current.value).catch(function(e){ed.$e(function(t){t.setTag("domain-link",!0),t.setExtra("type","copy"),ed.Tb(e)})})},O=(0,c._)((0,z.useState)(o||""),2),X=O[0],F=O[1];(0,z.useEffect)(function(){G.data&&"Repl"===G.data.linkReplDomain2.__typename&&a()},[G.data,a]);var W=function(){try{var e=new URL("/",X);F(e.hostname)}catch(e){}},H=function(e){m(e),f()},V=ey()(X,{require_valid_protocol:!1})&&X.split(".").length>=2,j=V&&2===X.split(".").length,q=r.replace(/^https:\/\//,""),Y="replit-verify=".concat(n),$=(0,M.U)();return(0,s.BX)(k.G,{css:[L.l0.colWithGap(16)],children:[(0,s.BX)(k.G,{css:[L.l0.colWithGap(8)],children:[(0,s.tZ)(S.h4,{level:2,variant:"subheadDefault",children:"New Domain Link"}),(0,s.BX)(S.xv,{children:["Learn more"," ",(0,s.tZ)("a",{href:"https://docs.replit.com/hosting/hosting-web-pages#custom-domains",target:"_blank",children:"here"}),"."]})]}),(0,s.BX)(k.G,{css:[L.l0.colWithGap(4)],children:[(0,s.tZ)("label",{htmlFor:$("domain"),children:(0,s.tZ)(S.xv,{color:"dimmer",variant:"small",multiline:!1,children:"Step 1: Enter your domain"})}),(0,s.tZ)(w.II,{className:"cname-url",readOnly:"loading"===p,value:X,onChange:function(e){F(e.target.value)},onBlur:function(){W()},placeholder:"example.com",id:$("domain")})]}),j&&!T?(0,s.BX)(k.G,{css:[L.l0.colWithGap(8)],children:[(0,s.BX)(k.G,{css:[L.l0.colWithGap(4)],children:[(0,s.tZ)("label",{htmlFor:$("record"),children:(0,s.BX)(S.xv,{color:"dimmer",variant:"small",multiline:!1,children:["Step 2: Add an ",(0,s.tZ)("code",{children:"A"})," Record"]})}),(0,s.BX)(k.G,{css:[L.l0.rowWithGap(8),L.l0.align.center],children:[(0,s.tZ)(S.xv,{multiline:!1,css:{fontFamily:L.TV.fontFamilyCode,maxWidth:"40%"},children:X}),(0,s.tZ)(S.xv,{multiline:!1,css:{fontFamily:L.TV.fontFamilyCode},children:"A"}),(0,s.tZ)(w.II,{readOnly:!0,ref:B,onChange:function(){return null},value:i,onFocus:function(){return N(B)},id:$("record")}),(0,s.tZ)(y.zx,{onClick:function(){return U(B)},text:"Copy"})]})]}),(0,s.tZ)(k.G,{css:[L.l0.flex.row,L.l0.align.stretch],children:(0,s.tZ)(y.zx,{variant:"outlined",onClick:function(){return R(!0)},text:"Use CNAME record instead."})})]}):null,V&&(T||!j)?(0,s.BX)(k.G,{css:[L.l0.colWithGap(4)],children:[(0,s.tZ)("label",{htmlFor:$("CNAMERecord"),children:(0,s.BX)(S.xv,{color:"dimmer",variant:"small",multiline:!1,children:["Step 2: Add a ",(0,s.tZ)("code",{children:"CNAME"})," Record"]})}),(0,s.BX)(k.G,{css:[L.l0.rowWithGap(8),L.l0.align.center],children:[(0,s.tZ)(S.xv,{multiline:!1,css:{fontFamily:L.TV.fontFamilyCode,maxWidth:"40%"},children:X}),(0,s.tZ)(S.xv,{multiline:!1,css:{fontFamily:L.TV.fontFamilyCode},children:"CNAME"}),(0,s.tZ)(w.II,{readOnly:!0,ref:P,onChange:function(){return null},value:q,onFocus:function(){return N(P)},id:$("CNAMERecord")}),(0,s.tZ)(y.zx,{onClick:function(){return U(P)},text:"Copy"})]}),j?(0,s.BX)(k.G,{css:[L.l0.colWithGap(8)],children:[(0,s.tZ)(S.xv,{variant:"small",children:'Note: this CNAME record requires that your DNS provider supports CNAMEs for apex domains - for example Cloudflare with "CNAME Flattening".'}),(0,s.tZ)(k.G,{css:[L.l0.flex.row,L.l0.align.stretch],children:(0,s.tZ)(y.zx,{onClick:function(){return R(!1)},text:"Use A record instead",variant:"outlined"})})]}):null]}):null,V?(0,s.BX)(k.G,{css:[L.l0.colWithGap(4)],children:[j?(0,s.tZ)("label",{htmlFor:$("txtRecord"),children:(0,s.BX)(S.xv,{color:"dimmer",variant:"small",multiline:!1,children:["This domain also requires a ",(0,s.tZ)("code",{children:"TXT"})," Record"]})}):(0,s.BX)("label",{children:['If you are using a service like Cloudflare (with "orange cloud") that rewrites domain records, you can add a ',(0,s.tZ)("code",{children:"TXT"})," ","Record for verification purposes."]}),(0,s.BX)(k.G,{css:[L.l0.rowWithGap(8),L.l0.align.center],children:[(0,s.tZ)(S.xv,{multiline:!1,css:{fontFamily:L.TV.fontFamilyCode,maxWidth:"40%"},children:X}),(0,s.tZ)(S.xv,{multiline:!1,css:{fontFamily:L.TV.fontFamilyCode},children:"TXT"}),(0,s.tZ)(w.II,{readOnly:!0,ref:A,onChange:function(){return null},value:Y,onClick:function(){return N(A)},id:$("txtRecord")}),(0,s.tZ)(y.zx,{onClick:function(){return U(A)},text:"Copy"})]})]}):null,"loading"===p?(0,s.tZ)(k.G,{css:[L.l0.colWithGap(12),L.l0.pt(16)],children:(0,s.tZ)(ew,{replId:n,domain:X,onVerified:function(){return H("verified")},onError:function(){return H("error")}})}):null,"verified"===p?(0,s.tZ)(k.G,{css:[L.l0.colWithGap(12),L.l0.pt(16)],children:(0,s.tZ)(S.xv,{multiline:!1,children:"Your domain has been verified."})}):null,"error"===p||C?(0,s.tZ)(k.G,{css:[L.l0.colWithGap(12),L.l0.pt(16)],children:(0,s.BX)(S.xv,{multiline:!1,children:["Creating the domain link failed",C?": "+C:"","."]})}):null,(0,s.BX)(k.G,{css:[L.l0.rowWithGap(12),L.l0.justify.end],children:[(0,s.tZ)(y.zx,{onClick:u,text:"Close"}),V&&null===p?(0,s.tZ)(y.zx,{disabled:b,onClick:function(){Z(!0),_(null),I({variables:{replId:n,domain:X}}).then(function(e){var t,n=(null===(t=e.data)||void 0===t?void 0:t.linkReplDomain2)||null;(null==n?void 0:n.__typename)==="Repl"?(_(null),H("loading")):(((null==n?void 0:n.__typename)==="ServiceUnavailable"||(null==n?void 0:n.__typename)==="NotFoundError"||(null==n?void 0:n.__typename)==="UnauthorizedError")&&_(null==n?void 0:n.message),H("error")),Z(!1),d()}).catch(function(e){Z(!1),_(e.message)})},text:"".concat(b?"Linking domain...":"Link domain"),iconLeft:(0,s.tZ)(ep.Z,{}),colorway:"primary"}):null]})]})}function ew(e){var t=e.domain,n=e.replId,r=e.onVerified,i=e.onError,o=(d=(0,l._)({},eo,{variables:{replId:n,domain:t},pollInterval:1e3}),K.a(ec,d)),a=o.data,u=o.stopPolling;if((0,z.useEffect)(function(){if(a&&"Repl"===a.repl.__typename){var e,t,n=a.repl;if((null===(e=n.checkDomain2)||void 0===e?void 0:e.__typename)==="NotFoundError"){i();return}if((null===(t=n.checkDomain2)||void 0===t?void 0:t.__typename)==="DomainStatus2"){var o=n.checkDomain2,l=o.retry,c=o.verified;if(!c&&!l){i();return}(c||!l)&&u(),c&&r()}}},[a,u,r,i]),(null==a?void 0:a.repl.__typename)==="Repl"&&a.repl.checkDomain2){var d,f,h,p,m,v,g="DomainStatus2"===a.repl.checkDomain2.__typename?a.repl.checkDomain2:null,y=null;if(null==g?void 0:g.records){var b=g.records;b.__typename,y=(0,j._)(b,["__typename"])}var Z=null;return(null==g?void 0:g.status)||((null===(v=a.repl.checkDomain2)||void 0===v?void 0:v.__typename)==="ServiceUnavailable"&&(Z=a.repl.checkDomain2.message),Z||(Z="DNS updates can take up to 48 hours to fully synchronize. Feel free to check back later.")),(0,s.BX)(k.G,{css:[L.l0.colWithGap(16),L.l0.justify.spaceBetween],children:[(0,s.BX)(k.G,{css:[L.l0.rowWithGap(16),L.l0.align.center],children:[(0,s.tZ)("div",{css:[L.l0.width("20px"),L.l0.height("20px"),{aspectRatio:"1 / 1"},{borderRadius:"100%"},{borderRadius:"100%"},{borderStyle:"solid"},{borderWidth:"3px"},{borderColor:L.TV.accentPrimaryDimmer},{borderTopColor:L.TV.accentPrimaryDefault},{transform:"rotate(0deg)"},{animation:"linear domain-loading 1s infinite"}],className:"jsx-4e6cc6caecb799c9"}),(0,s.tZ)("div",{className:"jsx-4e6cc6caecb799c9",children:Z})]}),y||(null===(h=a.repl.checkDomain2)||void 0===h?void 0:h.__typename)==="DomainStatus2"&&(null===(p=a.repl.checkDomain2)||void 0===p?void 0:p.retry)||(null===(m=a.repl.checkDomain2)||void 0===m?void 0:m.__typename)==="ServiceUnavailable"?(0,s.BX)(k.G,{children:[(0,s.tZ)("br",{className:"jsx-4e6cc6caecb799c9"}),y?(0,s.BX)(k.G,{children:["Currently, your domains records show:",(0,s.tZ)("pre",{css:[L.l0.overflow("scroll")],className:"jsx-4e6cc6caecb799c9",children:Object.entries(y).map(function(e){var n=(0,c._)(e,2),r=n[0],i=n[1];return null==i?void 0:i.map(function(e){return(0,s.BX)("div",{className:"jsx-4e6cc6caecb799c9",children:[t," ",r," ",e]},"{domain}-{dnsType}")})})})]}):(0,s.tZ)(S.xv,{children:"Currently, your domain is either not returning any records, or something is getting in the way of our verification process."})]}):null,(0,s.tZ)(Y(),{id:"4e6cc6caecb799c9",children:"@-webkit-keyframes domain-loading{from{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-moz-keyframes domain-loading{from{-moz-transform:rotate(0deg);transform:rotate(0deg)}to{-moz-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes domain-loading{from{-o-transform:rotate(0deg);transform:rotate(0deg)}to{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes domain-loading{from{-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-o-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}"})]})}return(null==a?void 0:a.repl.__typename)==="Repl"&&(null===(f=a.repl.checkDomain2)||void 0===f?void 0:f.__typename)==="NotFoundError"?(0,s.tZ)(s.HY,{children:"We ran into an internal error while checking the domain. Please try again later."}):null}function ex(e){var t,n=e.replId,r=e.domain,i=e.onUnlink,o=e.onGoBack,a=(0,c._)((t=(0,l._)({},eo,{variables:{input:{id:n,removeDomain:r}}}),Q.D(eu,t)),2),u=a[0],d=a[1];return(0,z.useEffect)(function(){d.data&&d.data.updateRepl.repl&&i()},[d.data,i]),(0,s.BX)(k.G,{css:[L.l0.colWithGap(16)],children:[(0,s.BX)(k.G,{css:[L.l0.colWithGap(8)],children:[(0,s.tZ)(S.h4,{level:3,variant:"subheadDefault",children:"Domain Unlinking"}),(0,s.BX)(S.xv,{children:["Are you sure you want to unlink"," ",(0,s.tZ)("a",{target:"_blank",rel:"noopener",href:"https://"+r,children:r}),"?"]})]}),(0,s.BX)(k.G,{css:[L.l0.rowWithGap(12),L.l0.justify.end],children:[(0,s.tZ)(y.zx,{onClick:o,text:"Cancel"}),(0,s.tZ)(y.zx,{onClick:function(){d.loading||u()},text:d.loading?"Unlinking domain...":"Yes, unlink this domain",colorway:"negative",iconLeft:(0,s.tZ)(ev.Z,{}),disabled:d.loading})]})]})}function eC(e){var t=e.replId,n=e.hostedUrl,r=e.apexProxy,i=e.onUnlink,o=e.onLink,a=e.domains,l=e.refetch,u=(0,c._)((0,z.useState)("listing"),2),d=u[0],f=u[1],h=(0,c._)((0,z.useState)(null),2),p=h[0],m=h[1],v=null;return"listing"===d?v=(0,s.BX)(k.G,{css:[L.l0.colWithGap(16)],children:[(0,s.BX)(k.G,{children:[(0,s.tZ)(S.h4,{level:3,variant:"subheadDefault",children:"Currently Linked Domains"}),(0,s.tZ)(k.G,{css:[L.l0.colWithGap(16)],children:a.map(function(e){return e?(0,s.tZ)(k.G,{children:(0,s.BX)(k.G,{css:[L.l0.colWithGap(4),L.l0.justify.spaceBetween,L.l0.align.center],children:[(0,s.BX)(k.G,{css:[L.l0.rowWithGap(8),L.l0.align.center,L.l0.justify.spaceBetween,L.l0.width("100%")],children:[(0,s.tZ)(k.G,{css:[L.l0.flex.shrink(1)],children:(0,s.tZ)(E.u,{tooltip:e.domain,children:(0,s.tZ)(S.xv,{multiline:!1,children:e.domain})})}),(0,s.tZ)(k.G,{children:(0,s.tZ)(E.u,{tooltip:(0,s.tZ)(S.xv,{css:{textTransform:"capitalize"},multiline:!1,children:e.state}),children:(0,s.tZ)(eb,{status:e.state})})})]}),(0,s.BX)(k.G,{css:[L.l0.rowWithGap(12),L.l0.justify.end,L.l0.align.center,L.l0.width("100%"),"verified"!==e.state&&L.l0.pl(12)],children:[(0,s.tZ)(y.zx,{text:"Unlink",css:L.l0.width("verified"!==e.state?"50%":"100%"),onClick:function(){m(e.domain),f("unlinking")}}),"verified"!==e.state?(0,s.tZ)(y.zx,{text:"Check status",css:L.l0.width("50%"),onClick:function(){m(e.domain),f("linking")}}):null]})]})},e.domain):null})})]}),(0,s.tZ)(y.zx,{text:"Create domain link",onClick:function(){return f("linking")},iconLeft:(0,s.tZ)(em.Z,{})})]}):"linking"===d?v=(0,s.tZ)(eZ,{replId:t,desiredARecord:r,hostedUrl:n,existingDomain:p,onLink:o,onGoBack:function(){f("listing"),m(null)},onLinkStarted:l,onStateChanged:l}):"unlinking"===d&&null!==p&&(v=(0,s.tZ)(ex,{replId:t,domain:p,onUnlink:function(){l(),f("listing"),i()},onGoBack:function(){f("listing"),m(null)}})),(0,s.BX)(k.G,{css:[L.l0.colWithGap(16)],children:[(0,s.tZ)(S.h4,{level:1,variant:"subheadDefault",children:"Domain Linking"}),(0,s.BX)(S.xv,{css:{fontStyle:"italic"},children:["Domain linking to the development preview is deprecated, please consider switching to"," ",(0,s.tZ)("a",{href:"https://docs.replit.com/hosting/deployments/about-deployments",target:"_blank",children:"deployments"})," ","as a more scalable solution."]}),v]})}(r=i||(i={})).Verified="verified",r.Verifying="verifying",r.Failed="failed";var e_="flag-ocean-easy",eS=(0,u.iv)([L.l0.borderRadius(6),L.l0.color.foregroundDimmer,L.l0.height(24),L.l0.m(4)]),eE=[L.l0.reset.button,w.u3,L.l0.rowWithGap(0),L.l0.flex.grow(0),L.l0.color.accentPositiveStronger,L.l0.fontSize("small"),L.l0.focusRing,{"&:hover":[L.l0.cursor.pointer,L.l0.color.accentPositiveStrongest]},{borderTopRightRadius:0,borderBottomRightRadius:0,borderRight:0},L.l0.align.center,L.l0.py(0),L.l0.px(4)],ek=(0,T.X)({root:[L.l0.flex.row,L.l0.align.center,L.l0.justify.spaceBetween,L.l0.border({color:L.TV.outlineDimmest,direction:"bottom"}),L.l0.p(2),L.l0.container("root"),L.l0.zIndex(1)],navControls:[L.l0.align.center,L.l0.rowWithGap(4),L.l0.flex.grow(1)],urlWrapper:[L.l0.position.relative,L.l0.flex.row,L.l0.flex.grow(1)],urlOptionsRoot:[L.l0.rowWithGap(0),L.l0.flex.growAndShrink(1)],urlOptions:[L.l0.position.absolute,L.l0.width("100%"),L.l0.backgroundColor.backgroundHigher,L.l0.p(8),L.l0.colWithGap(6),L.l0.border(),L.l0.borderRadius(0,0,12,12),{top:"100%",borderTop:0}],urlOptionsSection:[L.l0.colWithGap(4),L.l0.pb(8),L.l0.border({direction:"bottom"}),{":last-child":{borderBottom:0}}],urlOptionsTitle:[L.l0.rowWithGap(0),L.l0.justify.spaceBetween,L.l0.flex.grow(1)],portRadioGroup:[L.l0.colWithGap(8)],portOption:[L.l0.rowWithGap(8),L.l0.color.foregroundDimmer],portOptionSelected:[L.l0.rowWithGap(8),L.l0.color.foregroundDefault],portOptionLabel:[{"&:hover":[L.l0.cursor.pointer,L.l0.color.foregroundDefault]}],temporaryDevLinkWrapper:[L.l0.rowWithGap(4)],temporaryDevLinkText:{flex:"0 1 auto"},temporaryDevLink:[L.l0.display.block,L.l0.color.accentPositiveStronger,L.l0.fontSize("small"),L.l0.focusRing,{wordBreak:"break-all","&:hover":[L.l0.cursor.pointer,L.l0.color.accentPositiveStrongest]}],url:eE,urlSelected:[eE,L.l0.backgroundColor.backgroundHighest,{borderBottomLeftRadius:0}],urlPath:[L.l0.py(0),L.l0.fontSize(12),L.l0.flex.grow(1)],urlPath2:[L.l0.py(0),L.l0.fontSize(12),L.l0.flex.grow(1),{borderTopLeftRadius:0,borderBottomLeftRadius:0}],urlDots:[L.l0.backgroundColor.greenDimmer,L.l0.borderRadius(4),L.l0.p(2),{lineHeight:1,"&:hover":[L.l0.cursor.pointer,L.l0.backgroundColor.greenDefault]}],goButton:[L.l0.position.absolute,L.l0.right(4),L.l0.top("50%"),{transform:"translateY(-50%)"}],text:[L.l0.ml(8),L.l0.mr(4),L.l0.color.foregroundDimmest],buttons:[L.l0.flex.row,L.l0.align.center,(0,a._)({},L.nC.max("mobileMax","root"),{span:{fontSize:0},svg:{marginRight:0}})],navButton:[L.l0.p(6),L.l0.borderRadius(4),L.l0.flex.shrink(0),{border:"none"}],fakeUrl:[L.l0.fontSize(12),L.l0.border(),{boxSizing:"content-box"},L.l0.borderRadius(6),L.l0.px(8),L.l0.py(2),L.l0.flex.grow(1),L.l0.rowWithGap(4),L.l0.align.center],devtoolsErrorsBadge:[L.l0.position.absolute,L.l0.center,L.l0.textAlign.center,L.l0.backgroundColor.accentNegativeStronger,L.l0.color.accentNegativeDimmest,L.l0.right(0),L.l0.top(-2),L.l0.p(2),L.l0.minWidth(14),L.l0.height(14),L.l0.borderRadius(16),L.l0.fontSize(10)]}),eT=function e(t,n,r,i){"use strict";var a=this;(0,o._)(this,e),this.history=[],this.historyIndex=-1,this.init=function(e,t){a.history.push({relativeUrl:e,port:t}),a.historyIndex=a.history.length-1,a.notifyChanges()},this.notifyChanges=function(){a.onChange(a.canGoBack(),a.canGoForward(),a.getCurrentRelativeUrl(),a.getCurrentPort())},this.canGoBack=function(){return a.historyIndex>0},this.canGoForward=function(){return a.historyIndex<a.history.length-1},this.getCurrentRelativeUrl=function(){return a.history[a.historyIndex].relativeUrl},this.getCurrentPort=function(){return a.history[a.historyIndex].port},this.push=function(e,t){(e!==a.getCurrentRelativeUrl()||t!==a.getCurrentPort())&&(a.history=a.history.slice(0,a.historyIndex+1),a.history.push({relativeUrl:e,port:t}),a.historyIndex=a.history.length-1),a.notifyChanges()},this.relativeUrlUpdate=function(e){if(a.pendingNavigations>0){a.pendingNavigations-=1;return}a.push(e,a.getCurrentPort())},this.back=function(){(0,F.xn)(),a.canGoBack()&&(a.historyIndex-=1,a.navigate(a.getCurrentRelativeUrl(),a.getCurrentPort()))},this.forward=function(){(0,F.Yl)(),a.canGoForward()&&(a.historyIndex+=1,a.navigate(a.getCurrentRelativeUrl(),a.getCurrentPort()))},this.navigate=function(e,t){var n=null!=t?t:a.getCurrentPort();a.requestIframeNavigateTo(e,n),a.push(e,n),a.pendingNavigations+=1},this.refresh=function(){var e,t;(0,F.rJ)(),a.requestIframeNavigateTo(null!==(e=a.getCurrentRelativeUrl())&&void 0!==e?e:"/",null!==(t=a.getCurrentPort())&&void 0!==t?t:80)},this.setPort=function(e){var t=a.getCurrentRelativeUrl();a.navigate(t,e)},this.onChange=r,this.pendingNavigations=0,this.requestIframeNavigateTo=i,this.init(t,n)};function eR(e){var t=e.children;return(0,s.tZ)(E.u,{tooltip:"Dev URLs are only active when someone is in the workspace. The dev URL is also subject to change. For production hosting, use Deployments.",children:t})}function eD(e){var t,n,r,i,o,a,u,f,h,v,g,Z,w,C,E,T,R,D,I,A,P,N,O=e.canEditDomain,M=e.onToggleDevtools,X=e.navigationState,W=e.replId,H=e.url,V=e.requestIframeNavigateTo,j=e.initialPort,q=e.initialPath,Y=e.forwardedPorts,$=e.onOpenPortSettings,J=e.devtoolsErrorCount,Q=e.setRefreshCb,ee=(0,d.Z)(),et=(n=(t={initialPort:j,initialPath:q,navigationState:X,requestIframeNavigateTo:V}).initialPort,r=t.initialPath,i=t.navigationState,o=t.requestIframeNavigateTo,u=(a=(0,c._)((0,z.useState)(!1),2))[0],f=a[1],v=(h=(0,c._)((0,z.useState)(!1),2))[0],g=h[1],w=(Z=(0,c._)((0,z.useState)("Loading..."),2))[0],C=Z[1],T=(E=(0,c._)((0,z.useState)(80),2))[0],R=E[1],D=(0,z.useCallback)(function(e,t,n,r){f(e),g(t),C(n),R(r)},[]),I=(0,p.Z)(o),A=(0,p.Z)(n),P=(0,p.Z)(r),N=(0,m.Z)(function(){return new eT(P.current,A.current,D,I.current)},[P,A,D,I]),(0,z.useEffect)(function(){"active"===i.state&&N.relativeUrlUpdate(i.relativeUrl)},[i.state,i.relativeUrl,N]),{canNavigateBack:u,canNavigateForward:v,navigateBack:N.back,navigateForward:N.forward,canNavigateToInputRelativeUrl:w!==i.relativeUrl,navigateToInputRelativeUrl:function(){(0,F.Fq)(w),N.navigate(w)},inputRelativeUrl:w,setInputRelativeUrl:C,refresh:N.refresh,setPort:N.setPort,selectedPort:T}),en=et.canNavigateForward,er=et.navigateForward,ei=et.canNavigateBack,ea=et.navigateBack,ec=et.canNavigateToInputRelativeUrl,es=et.navigateToInputRelativeUrl,eu=et.inputRelativeUrl,ed=et.setInputRelativeUrl,ef=et.refresh,eh=et.setPort,ep=et.selectedPort;(0,z.useEffect)(function(){Q(function(){return ef})},[ef,Q]);var em=function(e){var t,n,r,i=(t=(0,l._)({},eo,{variables:{replId:e}}),K.a(el,t)),o=i.data,a=i.refetch,s=(0,c._)((0,z.useState)(!1),2),u=s[0],d=s[1],f=(0,z.useRef)(!1);if(!o||"Repl"!==o.repl.__typename)return{showEditReplcoDomainButton:!1};var h=null!==(r=null===(n=o.repl.domains)||void 0===n?void 0:n.filter(Boolean).filter(function(e){return!(null==e?void 0:e.hosting_deployment_id)}).map(function(e){return{domain:e.domain,state:e.state}}))&&void 0!==r?r:[];return h.length||f.current?(f.current=!0,{showEditReplcoDomainButton:!0,setIsEditingDomain:d,isEditingDomain:u,editDomainProps:{domains:h,refetch:a,replId:e,apexProxy:o.repl.apexProxy,hostedUrl:o.repl.hostedUrl,onUnlink:function(){a(),d(!1)},onLink:function(){a(),d(!1)}}}):{showEditReplcoDomainButton:!1}}(W),ev=(0,s.tZ)(eP,{});return"external-page"===X.state?ev=(0,s.tZ)(eA,{backToLocal:function(){return ef()}}):"active"===X.state&&(ev=(0,s.tZ)(eB,{canNavigateForward:en,navigateForward:er,canNavigateBack:ei,navigateBack:ea,canNavigateToInputRelativeUrl:ec,navigateToInputRelativeUrl:es,inputRelativeUrl:eu,setInputRelativeUrl:ed,refresh:ef,forwardedPorts:Y,setPort:eh,selectedPort:ep,url:H,onOpenPortSettings:$})),(0,s.BX)(_.Tg,{css:ek.root,children:[ev,(0,s.tZ)(k.G,{css:L.l0.flex.row,children:(0,s.BX)(k.G,{css:ek.buttons,children:[O&&em.showEditReplcoDomainButton?(0,s.BX)(s.HY,{children:[(0,s.tZ)(y.zx,{variant:"outlined",size:"small",text:"Edit custom domain",onClick:function(){return em.setIsEditingDomain(!em.isEditingDomain)},iconLeft:(0,s.tZ)(G.Z,{size:16})}),(0,s.tZ)(x.u,{isOpen:em.isEditingDomain,onRequestClose:function(){return em.setIsEditingDomain(!1)},children:(0,s.tZ)(eC,(0,l._)({},em.editDomainProps))})]}):null,"active"===X.state?(0,s.BX)(k.G,{css:L.l0.position.relative,children:[(0,s.tZ)(y.zx,{size:"small",variant:"outlined",onClick:M,css:eS,text:"Devtools",iconLeft:(0,s.tZ)(U.Z,{})}),J>0?(0,s.tZ)(k.G,{css:ek.devtoolsErrorsBadge,children:(0,s.tZ)(S.xv,{variant:"small",multiline:!1,children:J>99?"99+":J.toString()})}):null]}):null,(0,s.tZ)(eR,{children:(0,s.tZ)(b.Z,{size:"small",variant:"outlined",css:eS,href:H+X.relativeUrl,target:"_blank",iconLeft:(0,s.tZ)(B.Z,{}),text:ee?"Open in the browser":"New tab",onClick:function(){(0,F.Ji)()}})})]})})]})}function eI(e){var t=e.url,n=(0,c._)((0,z.useState)(!1),2),r=n[0],i=n[1],o=(0,z.useRef)(null),a=function(){i(!0),o.current=setTimeout(function(){i(!1)},1500)};return(0,z.useEffect)(function(){return function(){o.current&&clearTimeout(o.current)}},[]),(0,s.tZ)(E.u,{isOpen:r,placement:"bottom",tooltip:r?"Copied!":"Copy link",delay:"none",children:(0,s.tZ)(Z.hU,{alt:"Copy link",size:18,tooltipHidden:!1,onClick:function(){(0,v.Z)(t),a()},children:(0,s.tZ)(I.Z,{})})})}function eG(e){var t=e.canNavigateToInputRelativeUrl,n=e.navigateToInputRelativeUrl,r=e.inputRelativeUrl,i=e.setInputRelativeUrl,o=e.forwardedPorts,a=e.setPort,l=e.selectedPort,u=e.url,d=e.onOpenPortSettings,h=(0,c._)((0,z.useState)(!1),2),p=h[0],m=h[1],v=(0,M.U)(),y=v("radioGroup"),b=(0,f.Z)(function(){m(!1)},[]);return(0,s.BX)(k.G,{css:ek.urlOptionsRoot,innerRef:b,children:[p?(0,s.BX)(_.Tg,{css:ek.urlOptions,elevated:!0,children:[(0,s.BX)(k.G,{css:ek.urlOptionsSection,children:[(0,s.BX)(k.G,{css:ek.urlOptionsTitle,children:[(0,s.BX)(S.xv,{children:["Listening on ",(0,g.Z)("port",o.length),":"]}),(0,s.tZ)(Z.hU,{alt:"Networking tool",onClick:d,children:(0,s.tZ)(N.Z,{})})]}),(0,s.tZ)(C.E,{tag:"fieldset",css:ek.portRadioGroup,name:y,value:l.toString(),onChange:function(e){a(parseInt(e.target.value,10)),m(!1)},children:o.map(function(e,t){return(0,s.BX)(k.G,{css:l===e.configuration.externalPort?ek.portOptionSelected:ek.portOption,children:[(0,s.tZ)(C.Y,{id:v(e.configuration.externalPort),value:e.configuration.externalPort.toString()}),(0,s.tZ)("label",{htmlFor:v(e.configuration.externalPort),css:ek.portOptionLabel,children:":".concat(e.configuration.localPort,"  :").concat(e.configuration.externalPort)})]},"".concat(t,"-").concat(e.configuration.externalPort,":").concat(e.configuration.localPort))})})]}),(0,s.BX)(k.G,{css:ek.urlOptionsSection,children:[(0,s.tZ)(S.xv,{children:"Dev URL:"}),(0,s.BX)(k.G,{css:ek.temporaryDevLinkWrapper,children:[(0,s.tZ)(S.xv,{css:ek.temporaryDevLinkText,maxLines:1,children:(0,s.tZ)(V(),{legacyBehavior:!0,href:u,passHref:!0,children:(0,s.tZ)("a",{css:ek.temporaryDevLink,target:"_blank",children:u})})}),(0,s.tZ)(eI,{url:u})]}),(0,s.tZ)(S.xv,{color:"dimmer",variant:"small",children:"Dev URLs are temporary and will sleep after you leave the workspace."})]})]}):null,(0,s.BX)("button",{css:p?ek.urlSelected:ek.url,onClick:function(){return m(!p)},children:[(0,s.tZ)(eR,{children:(0,s.tZ)(k.G,{css:ek.urlDots,children:"{...}"})}),".".concat(u.includes("replit.dev")?"replit.dev":"repl.co").concat((0,X.O2)(l)?"":":"+l)]}),(0,s.tZ)(w.II,{css:ek.urlPath2,style:p?{borderBottomRightRadius:0}:{},value:r,onKeyDown:function(e){"Enter"===e.key&&t&&n()},onChange:function(e){if(""===e.currentTarget.value){i("/");return}i(e.target.value)}})]})}function eB(e){var t=e.canNavigateForward,n=e.navigateForward,r=e.canNavigateBack,i=e.navigateBack,o=e.canNavigateToInputRelativeUrl,a=e.navigateToInputRelativeUrl,l=e.inputRelativeUrl,c=e.setInputRelativeUrl,u=e.refresh,d=e.forwardedPorts,f=e.setPort,p=e.selectedPort,m=e.url,v=e.onOpenPortSettings,g=(0,h.P5)({controlName:e_,logFlagToAnalytics:!0}),y=(0,W.gf)("webviewpane.reload");return(0,s.BX)(k.G,{css:ek.navControls,children:[(0,s.tZ)(Z.hU,{alt:"Back",tooltipDelay:"long",onClick:i,disabled:!r,css:ek.navButton,children:(0,s.tZ)(R.Z,{})}),(0,s.tZ)(Z.hU,{alt:"Forward",tooltipDelay:"long",onClick:n,disabled:!t,css:ek.navButton,children:(0,s.tZ)(D.Z,{})}),(0,s.tZ)(Z.hU,{alt:"Refresh".concat(y?" (".concat((0,W.Ih)(y),")"):""),tooltipDelay:"long",onClick:u,css:ek.navButton,children:(0,s.tZ)(P.Z,{})}),(0,s.BX)(k.G,{css:ek.urlWrapper,children:[g?(0,s.tZ)(eG,{canNavigateToInputRelativeUrl:o,navigateToInputRelativeUrl:a,inputRelativeUrl:l,setInputRelativeUrl:c,forwardedPorts:d,setPort:f,selectedPort:p,url:m,onOpenPortSettings:v}):(0,s.tZ)(w.II,{css:ek.urlPath,value:l,onKeyDown:function(e){"Enter"===e.key&&o&&a()},onChange:function(e){if(""===e.currentTarget.value){c("/");return}c(e.target.value)}}),(0,s.tZ)(_.Tg,{elevated:!0,css:ek.goButton,children:(0,s.tZ)(Z.hU,{alt:"Go to URL",disabled:!o,onClick:a,size:18,tooltipContents:(0,s.tZ)(W.bM,{keyCombo:"Enter"}),children:(0,s.tZ)(D.Z,{})})})]})]})}function eA(e){var t=e.backToLocal,n=(0,c._)((0,z.useState)(!1),2),r=n[0],i=n[1];return(0,s.BX)(k.G,{css:ek.navControls,children:[(0,s.tZ)(y.zx,{size:"small",variant:"outlined",onClick:function(){t(),i(!0)},loading:r,css:eS,text:"Back to my page",iconLeft:r?(0,s.tZ)(A.Z,{}):(0,s.tZ)(R.Z,{})}),(0,s.BX)(_.Tg,{elevated:!0,css:ek.fakeUrl,children:[(0,s.tZ)(E.u,{tooltip:"The URL bar is not supported when navigating to external pages. You can open in a new tab to use your browser instead.",delay:"none",placement:"auto",children:(0,s.tZ)(O.Z,{})}),(0,s.tZ)(S.xv,{variant:"small",color:"dimmer",children:"External page"})]})]})}function eP(){return(0,s.tZ)(k.G,{css:ek.navControls,children:(0,s.BX)(_.Tg,{elevated:!0,css:ek.fakeUrl,children:[(0,s.tZ)(E.u,{tooltip:"Page is loading, please wait.",delay:"none",placement:"auto",children:(0,s.tZ)(A.Z,{})}),(0,s.tZ)(S.xv,{variant:"small",color:"dimmer",children:"Loading your page"})]})})}},83436:function(e,t,n){n.d(t,{I5:function(){return p},sY:function(){return f}});var r=n(41733),i=n(21262),o=n(71440),a=n(58995);function l(){var e=(0,i._)(["\n  fragment ReplEnvironmentWebviewDeployBanner on Repl {\n    hostingDeployment {\n      ... on HostingDeployment {\n        id\n        currentBuild {\n          id\n        }\n      }\n      ... on NotFoundError {\n        message\n      }\n      ... on UnauthorizedError {\n        message\n      }\n    }\n    hostingDeploymentPermissions {\n      canDeploy\n    }\n    config {\n      isVnc\n    }\n  }\n"]);return l=function(){return e},e}function c(){var e=(0,i._)(["\n  fragment ReplEnvironmentWebviewRepl on Repl {\n    id\n    prodUrl: hostedUrl(dotty: true)\n    devUrl: hostedUrl(dev: true)\n    currentUserPermissions {\n      linkDomain\n    }\n    lang {\n      id\n    }\n  }\n"]);return c=function(){return e},e}function s(){var e=(0,i._)(["\n  query ReplEnvironmentWebview($id: String!) {\n    repl(id: $id) {\n      ... on Repl {\n        id\n        ...ReplEnvironmentWebviewRepl\n        ...ReplEnvironmentWebviewDeployBanner\n      }\n    }\n  }\n  ","\n  ","\n"]);return s=function(){return e},e}var u={},d=(0,o.Ps)(l()),f=(0,o.Ps)(c()),h=(0,o.Ps)(s(),f,d);function p(e){var t=(0,r._)({},u,e);return a.a(h,t)}},51533:function(e,t,n){n.d(t,{Z:function(){return Y},J:function(){return q}});var r=n(41733),i=n(30509),o=n(66626),a=n(74985),l=n(43182),c=n(76999),s=n.n(c),u=n(59868),d=n(9617),f=n(35972),h=n(63461),p=n(50959);function m(){return(0,p.useEffect)(function(){(0,u.j)(u.U3.WS_REPLCO_UNREACHABLE)},[]),(0,a.BX)("div",{className:"jsx-88c49dc4f1cb807b unreachable",children:[(0,a.BX)(f.gC,{align:"center",spacing:4,children:[(0,a.BX)(f.gC,{align:"center",children:[(0,a.tZ)(d.Z,{level:1,children:"\uD83D\uDE48"}),(0,a.tZ)(d.Z,{level:4,children:"This Repl link isnt broken!"}),(0,a.tZ)(d.Z,{level:4,foreground:2,children:"Its just blocked."})]}),(0,a.BX)(f.gC,{spacing:2,className:"why",children:[(0,a.tZ)(h.Z,{foreground:2,children:"Why this might be happening:"}),(0,a.tZ)(h.Z,{foreground:2,children:(0,a.BX)("ul",{className:"jsx-88c49dc4f1cb807b",children:[(0,a.BX)("li",{className:"jsx-88c49dc4f1cb807b",children:["Repl URLs could be"," ",(0,a.tZ)(h.Z,{fontWeight:"medium",foreground:1,children:"blocked by a firewall,"})," ","so contact your IT administrator"]}),(0,a.BX)("li",{className:"jsx-88c49dc4f1cb807b",children:["Repl URLs could be"," ",(0,a.tZ)(h.Z,{fontWeight:"medium",foreground:1,children:"blocked by your ISP,"})," ","so try getting in touch with them"]})]})})]}),(0,a.BX)(h.Z,{foreground:2,align:"center",children:["If you have any other questions, please check out"," ",(0,a.tZ)("a",{href:"https://docs.replit.com/teams-edu/it-administrators-toolkit",target:"_blank",rel:"noopener noreferrer",className:"jsx-88c49dc4f1cb807b",children:"our IT docs"})," ","or"," ",(0,a.tZ)("a",{href:"https://replit.com/support",target:"_blank",rel:"noopener noreferrer",className:"jsx-88c49dc4f1cb807b",children:"contact support"}),"."]})]}),(0,a.tZ)(s(),{id:"88c49dc4f1cb807b",children:".unreachable.jsx-88c49dc4f1cb807b{padding:var(--space-32)}.unreachable.jsx-88c49dc4f1cb807b ul.jsx-88c49dc4f1cb807b{list-style-position:inside}.unreachable.jsx-88c49dc4f1cb807b li.jsx-88c49dc4f1cb807b{padding-bottom:var(--space-16)}"})]})}var v=(0,p.createContext)(!1),g=n(74833),y=n(56596),b=n(29287),Z=(0,n(93918).X)({styles0:[b.l0.align.center,b.l0.p(64)],styles1:[b.l0.align.center],styles2:[b.l0.textAlign.center,b.l0.pb(8)],styles3:[b.l0.textAlign.center],styles4:[b.l0.p(16)],styles5:[b.l0.color.foregroundDimmer,b.l0.textAlign.center,b.l0.pb(16)]});function w(){return(0,a.BX)(y.G,{css:Z.styles0,children:[(0,a.BX)(y.G,{css:Z.styles1,children:[(0,a.tZ)(d.Z,{level:1,children:"\uD83D\uDE48"}),(0,a.tZ)(g.xv,{css:Z.styles2,variant:"headerDefault",children:"We've detected a crash loop"}),(0,a.tZ)(g.xv,{css:Z.styles3,variant:"subheadDefault",color:"dimmer",children:"Preview is disabled until you click the run button again."})]}),(0,a.tZ)(y.G,{css:Z.styles4,children:(0,a.tZ)(g.xv,{css:Z.styles5,children:"There may be errors in the code that are causing your application to repeatedly crash."})})]})}var x=n(56337),C=n(50782),_=n(23394),S=n(62582),E=n(86612),k=n(37463),T=n(18107),R=n(54916),D=n(60427),I=n(42549),G=n(1498),B=n(7877),A=n(40664),P=n(49932);function N(e){var t=e.onCompleted,n=e.startTimeInSeconds,r=(0,o._)((0,p.useState)(n),2),i=r[0],l=r[1];return(0,p.useEffect)(function(){var e=setInterval(function(){return l(function(t){return 0===t?(clearInterval(e),0):t-1})},1e3);return function(){return clearInterval(e)}},[]),(0,p.useEffect)(function(){i>0||t()},[i]),(0,a.tZ)(y.G,{css:{width:24,height:24},children:(0,a.BX)(y.G,{css:[b.l0.flex.row,b.l0.align.center,b.l0.justify.center,{width:"100%",height:"100%",strokeDasharray:62.400000000000006,strokeDashoffset:62.400000000000006,strokeLinecap:"butt",strokeWidth:2,stroke:P.TV.accentPrimaryDefault,fill:"none"}],children:[(0,a.tZ)("svg",{width:"100%",height:"100%",className:s().dynamic([["1e155c6e775ef991",[62.400000000000006]]]),children:(0,a.tZ)("circle",{r:10,cx:12,cy:12,style:{animationName:"countdown-animation",animationDuration:"".concat(n,"s"),animationDelay:"0s",animationTimingFunction:"linear"},className:s().dynamic([["1e155c6e775ef991",[62.400000000000006]]])})}),(0,a.tZ)(s(),{id:"1e155c6e775ef991",dynamic:[62.400000000000006],children:"@-webkit-keyframes countdown-animation{from{stroke-dashoffset:0px}to{stroke-dashoffset:".concat(62.400000000000006,"px}}@-moz-keyframes countdown-animation{from{stroke-dashoffset:0px}to{stroke-dashoffset:").concat(62.400000000000006,"px}}@-o-keyframes countdown-animation{from{stroke-dashoffset:0px}to{stroke-dashoffset:").concat(62.400000000000006,"px}}@keyframes countdown-animation{from{stroke-dashoffset:0px}to{stroke-dashoffset:").concat(62.400000000000006,"px}}")}),(0,a.tZ)(g.xv,{css:[b.l0.position.absolute],variant:"small",multiline:!1,children:i})]})})}function U(e){var t=e.onCompleted,n=[b.l0.rowWithGap(4),b.l0.align.center,b.l0.justify.spaceBetween,b.l0.p(6),b.l0.pl(8),b.l0.flex.growAndShrink(1),{borderWidth:1,borderStyle:"solid",background:P.TV.accentPrimaryDimmest,borderColor:P.TV.accentPrimaryDimmer,color:P.TV.accentPrimaryStrongest}];return(0,a.BX)(y.G,{css:n,children:[(0,a.BX)(y.G,{css:[b.l0.rowWithGap(4),b.l0.align.center],children:[(0,a.tZ)(g.xv,{variant:"small",children:"When you're ready, you can deploy from the"}),(0,a.tZ)(G.zx,{iconLeft:(0,a.tZ)(B.Z,{}),text:"Deploy",disabled:!0,size:"small"}),(0,a.tZ)(g.xv,{variant:"small",children:"menu!"})]}),(0,a.tZ)(N,{startTimeInSeconds:3,onCompleted:t})]})}function O(e){var t,n=e.repl,r=e.onClick,i=(0,o._)((0,p.useState)(!1),2),l=i[0],c=i[1],s=(0,D.gg)().isDeployableRepl,d=(0,A.Z)("workspace","workspace-deployments-webview-banner"),f=d.shouldDisplay,h=d.register,m=d.dismiss;(0,p.useEffect)(function(){h()},[h]);var v=n.hostingDeploymentPermissions.canDeploy&&s,g=(null===(t=n.hostingDeployment)||void 0===t?void 0:t.__typename)==="HostingDeployment"&&n.hostingDeployment.currentBuild;return v&&!g&&f?(0,a.tZ)(y.G,{children:l?(0,a.tZ)(U,{onCompleted:function(){m()}}):(0,a.tZ)(I.U,{onClick:function(){(0,u.j)(u.U3.DEPLOY_PROJECT_SELECTED,{source:"workspace_webview_deploy_banner"}),m(),r()},onDismiss:function(){c(!0)},rounded:!1})}):null}var L=n(43312),M=n(76588),X={container:(0,L.iv)(b.l0.p(16),b.l0.height("100%"),b.l0.align.center),imageContainer:(0,L.iv)(b.l0.height("100%"),b.l0.colWithGap(16),b.l0.align.center,b.l0.justify.center,b.l0.width(300)),image:(0,L.iv)(b.l0.width(200))};function F(e){var t=e.hasForwardedPorts,n=e.showWebview;return(0,a.tZ)(y.G,{css:X.container,children:(0,a.BX)(y.G,{css:X.imageContainer,children:[(0,a.tZ)("div",{css:X.image,children:(0,a.tZ)(M.Z,{src:"/public/images/run_pointer.svg",alt:"A play button with a mouse pointer",height:250,width:400})}),t?(0,a.BX)(a.HY,{children:[(0,a.tZ)(g.h4,{level:3,variant:"subheadDefault",children:"Looks like you have a server running."}),(0,a.tZ)(G.zx,{text:"Show web content",colorway:"primary",onClick:n})]}):(0,a.tZ)(g.h4,{level:3,variant:"subheadDefault",children:"Start a server to see the hosted output."})]})})}var W=n(66985),H=n(52234),V=n(81810),z=n(83436),j=n(30686);function q(e){var t,n,r,i=(0,x.Z)(),o=!(n=(0,k.bg)()).length||n.some(function(e){return 80===e.configuration.externalPort})?80:null!==(t=n[0].configuration.externalPort)&&void 0!==t?t:80,a=(0,R.Z)().container,l=(0,E.Z)(a),c=(0,z.I5)({variables:{id:e}}).data,s=(0,_.Z)();if(!o&&"html"!==s||!((null==c?void 0:c.repl.__typename)==="Repl"?c.repl:null)||!l)return null;var u=(0,W.hw)(l,o).toString(),d=(0,W.hw)(l+"/__replco/devtools_wrapper.html",o).toString();return{iframeSrc:i?(r=new URL(u)).hostname.endsWith(".localhost")?u:(r.protocol="https:",r.toString()):d,presentationUrl:u}}function Y(e){var t,n,c,s,d,f,h,g,Z,_,E,D,I,G,B,A,P,N=e.initialPort,U=void 0===N?80:N,L=e.initialPath,M=void 0===L?"/":L,X=e.openPane,Y=e.containerRef,$=e.openNetworkingTool,J=e.setRefreshCb,K=(0,p.useId)(),Q=(0,C.Z)(),ee=(0,z.I5)({variables:{id:Q}}).data,et=(null==ee?void 0:ee.repl.__typename)==="Repl"?ee.repl:null,en=(0,p.useContext)(v),er=(0,j.S)().isCircuitBroken,ei=(0,p.useRef)(null),eo=(0,o._)((0,p.useState)(!1),2),ea=eo[0],el=eo[1],ec=(t=(0,R.Z)().runner,c=(n=(0,o._)((0,p.useState)(t.getRunState()),2))[0],s=n[1],f=(d=(0,o._)((0,p.useState)(!1),2))[0],h=d[1],(0,p.useEffect)(function(){return t.onStateChanged(s)},[t]),{shouldHide:(c===T.Ah.OFFLINE||c===T.Ah.STOPPING||c===T.Ah.IDLE&&"html"!==t.mode)&&!f,forceShow:function(){return h(!0)}}),es=ec.shouldHide,eu=ec.forceShow,ed=(0,o._)((0,p.useState)(0),2),ef=ed[0],eh=ed[1],ep=q(Q),em=(0,k.bg)(),ev=(null==et?void 0:et.lang.id)==="html"||(null==et?void 0:et.lang.id)==="html_beta",eg=(0,x.Z)(),ey=!1,eb=null;ep?en?eb=(0,a.tZ)(m,{}):er?eb=(0,a.tZ)(w,{}):es?eb=(0,a.tZ)(F,{hasForwardedPorts:em.length>0,showWebview:eu}):eg?(ey=!0,eb=(0,a.tZ)("webview",(0,r._)({"data-cy":"ws-webview",ref:ei,src:(0,W.Gz)({url:ep.iframeSrc,port:U,path:M,id:K}).toString(),onLoad:function(){return el(!0)},css:[b.l0.flex.growAndShrink(1),{border:"none",backgroundColor:b.TV.white}]},S.Z))):(ey=!0,eb=(0,a.tZ)("iframe",(0,r._)({title:"webview","data-cy":"ws-webview",ref:ei,src:(0,W.Gz)({url:ep.iframeSrc,port:U,path:M,id:K}).toString(),onLoad:function(){return el(!0)},css:[b.l0.flex.growAndShrink(1),{border:"none",display:"block",backgroundColor:b.TV.white}]},S.Z))):eb=null;var eZ=(Z=(g={webviewId:K,isWebviewVisible:ey,iframeOrWebviewRef:ei,iframeSrc:null==ep?void 0:ep.iframeSrc}).webviewId,_=g.isWebviewVisible,E=g.iframeOrWebviewRef,D=g.iframeSrc,G=(I=(0,o._)((0,p.useState)({state:"loading",relativeUrl:null}),2))[0],B=I[1],A=(0,x.Z)(),(0,p.useEffect)(function(){if(A&&_&&D){if(!E.current)throw Error("Expected iframe to be defined when isWebviewRendered");var e=E.current,t=new URL(D);return e.addEventListener("did-navigate",n),e.addEventListener("did-navigate-in-page",n),function(){e.removeEventListener("did-navigate",n),e.removeEventListener("did-navigate-in-page",n)}}function n(e){var n=new URL(e.url),r=n.pathname+n.search+n.hash;if(n.hostname!==t.hostname){B(function(e){return"external-page"===e.state?e:{state:"external-page",relativeUrl:null}});return}B(function(e){return"active"===e.state&&e.relativeUrl===r?e:{state:"active",relativeUrl:r}})}},[_,A,D,E]),(0,p.useEffect)(function(){if(!A&&D){var e=new URL(D);return window.addEventListener("message",t),function(){window.removeEventListener("message",t)}}function t(t){if(t.origin&&"null"!==t.origin&&new URL(t.origin).hostname===e.hostname&&"object"==typeof t.data&&(null===(n=t.data)||void 0===n?void 0:n.type)){var n,r=E.current,i=t.data;if((null==i||!i.id||i.id===Z)&&((null==i?void 0:i.id)===Z&&t.source!==(null==r?void 0:r.contentWindow)&&l.Tb(Error("Expected event source to match iframe content window")),"page-navigation"===i.type)){if(i.payload.isExternal){B(function(e){return"external-page"===e.state?e:{state:"external-page",relativeUrl:null}});return}var o=i.payload.path;B(function(e){return"active"===e.state&&e.relativeUrl===o?e:{state:"active",relativeUrl:o}})}}}},[Z,A,D,E]),G);return((0,p.useEffect)(function(){var e=function(e){if(e.origin&&"null"!==e.origin&&new URL(e.origin).hostname===t&&"object"==typeof e.data&&(null===(n=e.data)||void 0===n?void 0:n.type)){var n,o,a,c=e.data;if(null==c||!c.id||c.id===K)switch(c.type){case"event":var s=e.data,d=s.event,f=s.payload;"error"===d?l.Tb(f):(0,u.j)(d,(0,i._)((0,r._)({},f),{replId:Q,isHTML:ev}));return;case"show-badge":eh(e.data.count);return;case"ready":e.data.wasShown&&(null===(a=ei.current)||void 0===a||null===(o=a.contentWindow)||void 0===o||o.postMessage({type:"toggleDevtools",source:"automatic"},"*"));return}}};if(null==ep?void 0:ep.iframeSrc){var t=new URL(ep.iframeSrc).hostname;return window.addEventListener("message",e),function(){window.removeEventListener("message",e)}}},[K,Q,ev,null==ep?void 0:ep.iframeSrc]),et&&ep)?(P=ey?(0,a.tZ)(V.ZP,{navigationState:eZ,canEditDomain:et.currentUserPermissions.linkDomain,url:ep.presentationUrl,initialPort:U,initialPath:M,forwardedPorts:em,replId:Q,requestIframeNavigateTo:function(e,t){if(eh(0),ei.current){if(eg){var n,r=ei.current,i=new URL(e,ep.iframeSrc);t&&(i=(0,W.hw)(i.toString(),t)),r.loadURL(i.toString());return}if(null===(n=ei.current)||void 0===n?void 0:n.contentWindow){var o=(0,W.hw)(ep.iframeSrc,t);o.searchParams.set("initialPath",e),o.searchParams.set("id",K),ei.current.src=o.href}}},onToggleDevtools:function(){if((0,H.t1)(),eh(0),!eg){var e,t;null===(t=ei.current)||void 0===t||null===(e=t.contentWindow)||void 0===e||e.postMessage({type:"toggleDevtools",source:"manual"},"*");return}var n=ei.current;n&&(n.isDevToolsOpened()?n.closeDevTools():n.openDevTools())},onOpenPortSettings:$,devtoolsErrorCount:ef,setRefreshCb:J}):null,(0,a.BX)(y.G,{css:[b.l0.backgroundColor.backgroundDefault,b.l0.height("100%"),b.l0.borderRadius(4),{overflow:"hidden"}],innerRef:Y,children:[P,ea?(0,a.tZ)(O,{repl:et,onClick:function(){return X({type:"deployments"})}}):null,eb]})):null}},52234:function(e,t,n){n.d(t,{Fq:function(){return u},Ji:function(){return f},Yl:function(){return c},rJ:function(){return l},t1:function(){return d},xn:function(){return s}});var r=n(41733),i=n(98924),o=n(59868);function a(e){var t=e.actionType,n=(0,i._)(e,["actionType"]);(0,o.j)(o.U3.WS_WEBVIEW_USED,(0,r._)({type:t},n))}function l(){a({actionType:"refresh"})}function c(){a({actionType:"history_forward"})}function s(){a({actionType:"history_back"})}function u(e){a({actionType:"navigated_to",path:e})}function d(){a({actionType:"devtools_opened"})}function f(){a({actionType:"open_new_window"})}},86793:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(18107),i=n(50959);function o(e){var t=e.container,n=e.runner,o=e.refreshWebView;(0,i.useEffect)(function(){var e,i=[];return"outputs"===n.mode&&i.push(n.onBlockChanged(function(t){t.type===r.kH.EXECUTION&&1===t.data.exitCode&&(e=Date.now())})),i.push(t.onPortOpened(function(t){var n=t.isVnc;if(t.isForwarded&&!n){var r=Date.now();void 0!==e&&r-e<1e3||o()}})),function(){return i.forEach(function(e){return e()})}},[t,o,n])}},45495:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(18107),i=n(50959);function o(e){var t=e.runner,n=e.refreshWebView;(0,i.useEffect)(function(){if("html"===t.mode)return t.onStateChanged(function(e){e===r.Ah.RUNNING&&n()})},[t,n])}},30686:function(e,t,n){n.d(t,{S:function(){return f},e:function(){return d}});var r=n(66626),i=n(2689),o=n(18107),a=n(54916),l=n(90234),c=n(71999),s=n(50959),u=(0,l.cn)(!1),d=function(){return(0,c.KO)(u)};function f(){var e=(0,a.Z)().runner,t=(0,r._)(d(),2),n=t[0],l=t[1];return(0,s.useEffect)(function(){if("outputs"===e.mode){var t,n=[],r=Date.now(),a=Array(6),c=0;return n.push(e.onLocalRun(function(){r=Date.now(),l(!1)})),n.push(e.onStateChanged(function(e){if(!(t===o.Ah.RUNNING&&e===o.Ah.IDLE)){t=e;return}var n=c%6,s=Date.now();a[n]=s;var u=a[n>0?n-1:5];void 0!==u&&s-u<6e4&&null!=r&&r<u&&(l(!0),i.kg.info("webview circuit broken",{lastRunnerStops:JSON.stringify(a),runnerStopCount:c,lastLocalRunTimestamp:r})),c++,t=e})),function(){l(!1),n.forEach(function(e){return e()})}}},[e,l]),{isCircuitBroken:n}}},67774:function(e,t,n){n.d(t,{C:function(){return function e(t,n){if(!["context","action"].includes(t.data.type))throw Error("Command type not supported: "+t.data.type);if("action"===t.data.type)return{match:u.pl,data:{label:t.data.label,description:t.data.description,icon:t.data.iconPath?(0,a.tZ)(s.Z,{src:(0,f.Vh)(t.extension.baseUrl,t.data.iconPath),layout:"fill",alt:""}):(0,a.tZ)(a.HY,{children:" "}),type:"action",run:(0,r._)(function(){var e;return(0,o.Jh)(this,function(n){switch(n.label){case 0:if(!(e=t.run))throw Error("Action command must have run");return[4,e()];case 1:return[2,n.sent()]}})})}};var l,c=t.commands;if(!c)throw Error("Context command must have commands");return{match:u.pl,data:{label:t.data.label,description:t.data.description,icon:t.data.iconPath?(0,a.tZ)(s.Z,{src:(0,f.Vh)(t.extension.baseUrl,t.data.iconPath),layout:"fill",alt:""}):(0,a.tZ)(a.HY,{}),type:t.data.type},commands:(l=(0,r._)(function(r){var a;return(0,o.Jh)(this,function(o){switch(o.label){case 0:return[4,c({active:r.active,search:r.search,path:a=(0,i._)(n.path).concat([{data:t.data}])})];case 1:return[2,o.sent().map(function(t){return e(t,{path:a})})]}})}),function(e){return l.apply(this,arguments)})}}},V:function(){return p}});var r=n(27387),i=n(63257),o=n(96583),a=n(74985),l=n(74044),c=n(99149),s=n(76588),u=n(80259),d=n(19724),f=n(13090),h=l.Dy.Object({id:l.Dy.Optional(l.Dy.String()),icon:l.Dy.Optional(l.Dy.String()),type:l.Dy.Union([l.Dy.Literal("action"),l.Dy.Literal("context")]),label:l.Dy.String(),description:l.Dy.String(),contributions:l.Dy.Optional(l.Dy.Array(l.Dy.Enum(d.Y)))});function p(e,t){return m.apply(this,arguments)}function m(){return(m=(0,r._)(function(e,t){var n,i,a;return(0,o.Jh)(this,function(l){switch(l.label){case 0:return[4,e.data];case 1:if(n=l.sent(),!c.B4.Check(h,n))throw Error("Invalid command");if(i=null,"string"==typeof n.icon){if(""===n.icon)throw Error("Command icon cannot be empty. Omit it if you do not want an icon.");i=n.icon}if(a={data:{label:n.label,description:n.description,type:n.type,iconPath:i,id:n.id?n.id:void 0},extension:t.extension},n.contributions&&(a.data.contributions=n.contributions,t.logger.warn("Command ".concat(n.label," uses deprecated contributions field"))),"context"===n.type){var s;a.commands=(s=(0,r._)(function(n){var r,i,a,l,c,s,u,d,f;return(0,o.Jh)(this,function(o){switch(o.label){case 0:r=n.active,i=n.search,a=n.path,l=null,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,e.commands({active:r,search:i,path:a})];case 2:return l=o.sent(),[3,4];case 3:return c=o.sent(),t.logger.error(c.message,{commandError:c,api:"command"}),[2,[]];case 4:return[4,l.length];case 5:s=o.sent(),u=[],d=0,o.label=6;case 6:if(!(d<s))return[3,9];return f=u.push,[4,p(l[d],t)];case 7:f.apply(u,[o.sent()]),o.label=8;case 8:return d++,[3,6];case 9:return[2,u]}})}),function(e){return s.apply(this,arguments)})}else a.run=(0,r._)(function(){var n;return(0,o.Jh)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,e.run()];case 1:return r.sent(),[2,void 0];case 2:return n=r.sent(),t.logger.error(n.message,{runError:n,api:"command"}),[2,{type:"error",message:n.message}];case 3:return[2]}})});return[2,a]}})})).apply(this,arguments)}},60442:function(e,t,n){n.d(t,{oo:function(){return E},cR:function(){return x},nP:function(){return C},gI:function(){return _},Sp:function(){return S}});var r=n(66626),i=n(50782),o=n(66349),a=n(54916),l=n(22894),c=n(41733),s=n(21262),u=n(71440),d=n(58995),f=n(99165);function h(){var e=(0,s._)(["\n  query ReplConfigIsExtension($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        config {\n          isExtension\n        }\n      }\n    }\n  }\n"]);return h=function(){return e},e}function p(){var e=(0,s._)(["\n  mutation UpdateReplConfigIsExtension(\n    $replId: String!\n    $isExtension: Boolean!\n  ) {\n    updateRepl(input: { id: $replId, isExtension: $isExtension }) {\n      repl {\n        id\n        config {\n          isExtension\n        }\n      }\n    }\n  }\n"]);return p=function(){return e},e}function m(){var e=(0,s._)(["\n  query ReplExtensionHostedReplCoUrl($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        title\n        hostedUrl\n        user {\n          username\n          id\n        }\n      }\n    }\n  }\n"]);return m=function(){return e},e}var v={},g=(0,u.Ps)(h()),y=(0,u.Ps)(p()),b=(0,u.Ps)(m()),Z=n(50959),w=n(46565);function x(){var e,t=(0,Z.useContext)(l.Z),n=(0,r._)((0,Z.useState)(null!==(e=null==t?void 0:t.replConfigIsExtension)&&void 0!==e&&e),2),i=n[0],o=n[1],c=(0,a.Z)().dotReplit;return(0,Z.useEffect)(function(){return c.watch(function(e){var t,n,r;o(null!==(r=null===(n=e.config)||void 0===n?void 0:null===(t=n.extension)||void 0===t?void 0:t.isExtension)&&void 0!==r&&r)})},[c]),i}function C(){var e=(0,r._)((0,Z.useState)(null),2),t=e[0],n=e[1],i=(0,a.Z)().dotReplit;return(0,Z.useEffect)(function(){return i.watch(function(e){var t,r,i=null===(r=e.config)||void 0===r?void 0:null===(t=r.extension)||void 0===t?void 0:t.extensionID;i?n((0,w.T8)(i)):n(null)})},[i]),t}var _=function(){var e=(0,a.Z)().dotReplit,t=(0,r._)((0,Z.useState)(null),2),n=t[0],i=t[1];return(0,Z.useEffect)(function(){return e.watch(function(e){var t,n,r=null===(n=e.config)||void 0===n?void 0:null===(t=n.extension)||void 0===t?void 0:t.staticDirectory;r?i({path:r,relativePath:r.replace(/^\.\//,"")}):i(null)})},[e]),n};function S(){var e,t,n,o,l=(0,i.Z)(),s=(e=(0,c._)({},v,{variables:{replId:l}}),d.a(g,e)),u=s.data,h=s.loading,p=s.error,m=(0,r._)((t=(0,c._)({},v,void 0),f.D(y,t)),1)[0],b=!h&&!p&&!!(null==u?void 0:u.repl)&&"Repl"===u.repl.__typename&&null!==(o=null===(n=u.repl.config)||void 0===n?void 0:n.isExtension)&&void 0!==o&&o,w=(0,r._)((0,Z.useState)(!1),2),x=w[0],C=w[1],_=(0,a.Z)().dotReplit;(0,Z.useEffect)(function(){return _.watch(function(e){var t,n,r;C(null!==(r=null===(n=e.config)||void 0===n?void 0:null===(t=n.extension)||void 0===t?void 0:t.isExtension)&&void 0!==r&&r)})},[_]),(0,Z.useEffect)(function(){h||p||x===b||m({variables:{replId:l,isExtension:x},optimisticResponse:{__typename:"RootMutationType",updateRepl:{__typename:"UpdateReplPayload",repl:{id:l,__typename:"Repl",config:{__typename:"ReplConfig",isExtension:x}}}}})},[h,p,l,b,x,m])}var E=function(){var e,t,n,r,i,a=(0,o.Z)(),l=(e={variables:{replId:(null==a?void 0:a.id)||""},skip:!(null==a?void 0:a.id)},t=(0,c._)({},v,e),d.a(b,t)),s=l.data;if(l.error||!s||"Repl"!==s.repl.__typename)throw Error("Encountered an unknown error. Please contact support.");var u=null==s?void 0:null===(n=s.repl)||void 0===n?void 0:n.title,f=null==s?void 0:null===(i=s.repl)||void 0===i?void 0:null===(r=i.user)||void 0===r?void 0:r.username;if(!u||!f)throw Error("Encountered an unknown error. Please contact support.");return"https://".concat(u.replace(/[_\s]+/g,"-").replace(/[^a-zA-Z0-9-]/g,"").toLowerCase(),".").concat(f,".repl.co")}},70504:function(e,t,n){n.d(t,{LM:function(){return r.LM},Mu:function(){return i.Mu},WF:function(){return r.WF},WG:function(){return i.WG},jx:function(){return i.jx},ot:function(){return r.ot},r9:function(){return i.r9}});var r=n(1831),i=n(18440)},1831:function(e,t,n){n.d(t,{EO:function(){return R},I1:function(){return G},Kf:function(){return I},LM:function(){return T},WF:function(){return k},bN:function(){return S},dI:function(){return D},ot:function(){return E},zm:function(){return B}});var r=n(27387),i=n(41733),o=n(30509),a=n(66626),l=n(96583),c=n(59868),s=n(86612),u=n(54916),d=n(70226),f=n(90234),h=n(19334),p=n.n(h),m=n(50959),v=n(13090),g=n(16385),y=n(46565),b=n(34471),Z=n(85234),w=n.n(Z),x=n(67887),C=n(18440),_=n(19418);function S(){var e,t=(0,_.E4)(C.We);return(0,m.useCallback)((e=(0,r._)(function(e){return(0,l.Jh)(this,function(n){return t({installationId:e}),[2]})}),function(t){return e.apply(this,arguments)}),[t])}function E(){var e,t=N(),n=t.throwSystemError,a=t.throwExtensionError,c=(0,_.E4)(C.nk),s=(0,_.ZC)(C.Ol),u=(0,_.Ld)();return(0,m.useCallback)((e=(0,r._)(function(e){var t,r,d,f,h,m,Z,w,_,S,E,k,T,R,D,I,G,B,A,P;return(0,l.Jh)(this,function(l){switch(l.label){case 0:return t=e.installationId,d=void 0===(r=e.forceRefetch)||r,[4,(0,x.Al)()];case 1:if(!(f=l.sent())||f.error)return n({friendlyMessage:"Failed to load user context",error:f.error}),[2];if(h=f.result.userHasInternalApiEnabled,!(m=u.get(C.Lq).find(function(e){return e.installationId===t})))return[3,3];return[4,(0,x.V9)(m.baseUrl)];case 2:if(Z=l.sent(),w=s.createLogger({extensionId:m.extensionId,installationId:m.installationId,local:!0}),Z.error)return _=(0,o._)((0,i._)({},m),{manifest:(0,v.fF)(),enableExperimentalApi:!1,enableInternalApi:!1,logger:w.createLogger({extensionName:"Unnamed Extension"}),isLocal:!0}),s.info("Adding extension: ".concat(_.manifest.name),{extensionArgs:p()(_,["extensionId","installationId","baseUrl","manifest","enableExperimentalApi","enableInternalApi","isLocal"]),local:_.isLocal,error:!0}),c(_),S="Failed to load extension manifest",Z.error instanceof b.Jg&&(S=Z.error.message),a({extensionId:m.extensionId,installationId:m.installationId,extensionError:{error:Z.error,friendlyMessage:S}}),[2];return E=(0,g.MU)(Z.result,"experimental-api"),k=(0,o._)((0,i._)({},m),{manifest:Z.result,enableExperimentalApi:E,enableInternalApi:h,logger:w.createLogger({extensionName:Z.result.name}),isLocal:!0}),s.info("Adding extension: ".concat(k.manifest.name),{extensionArgs:p()(k,["extensionId","installationId","baseUrl","manifest","enableExperimentalApi","enableInternalApi","isLocal"]),local:!0}),c(k),[3,5];case 3:return[4,(0,x.mr)(t,d)];case 4:if((T=l.sent()).error)return n({friendlyMessage:"Something went wrong while downloading an extension",error:T.error}),[2];if(!(R=T.result))return n({friendlyMessage:"Extension failed to install",error:Error("Expected installation to be defined")}),[2];if(!(D=R.extension))return n({friendlyMessage:"Extension failed to install",error:Error("Expected extension to be defined")}),[2];if(!D.manifest)return a({extensionId:(0,y.T8)(D.id),installationId:(0,y.Ad)(R.id),extensionError:{friendlyMessage:"Extension failed to install",error:Error("Expected extension manifest to be defined")}}),[2];if("ExtensionManifestError"===D.manifest.__typename)return a({extensionId:(0,y.T8)(D.id),installationId:(0,y.Ad)(R.id),extensionError:{friendlyMessage:"An error occurred while loading the extension manifest: ".concat(D.manifest.message),error:Error(D.manifest.message)}}),[2];if(!D.manifest||"ExtensionManifest"!==D.manifest.__typename)return a({extensionId:(0,y.T8)(D.id),installationId:(0,y.Ad)(R.id),extensionError:{friendlyMessage:"An error occurred while loading the extension manifest",error:Error("Expected extension manifest to be defined")}}),[2];return I=(0,v.tr)(D.manifest),G=(0,g.MU)(I,"experimental-api"),B=(0,y.T8)(D.id),A=D.enableInternalApi,P={extensionId:B,installationId:t,manifest:I,baseUrl:(0,v.BY)(D.url),enableExperimentalApi:G,enableInternalApi:h||A,logger:s.createLogger({extensionId:B,installationId:t,extensionName:I.name,local:!1}),isLocal:!1},s.info("Adding extension: ".concat(P.manifest.name),{extensionArgs:p()(P,["extensionId","installationId","baseUrl","manifest","enableExperimentalApi","enableInternalApi","isLocal"]),local:!1}),c(P),[2,R];case 5:return[2]}})}),function(t){return e.apply(this,arguments)}),[c,a,n,u,s])}function k(){var e,t=E(),n=N().throwSystemError;return(0,m.useCallback)((e=(0,r._)(function(e){var r,i,o,a,s;return(0,l.Jh)(this,function(l){switch(l.label){case 0:return r=e.extensionId,i=e.replId,[4,(0,x.Wc)({extensionId:r,replId:i})];case 1:if((s=l.sent()).error)return n({error:s.error,friendlyMessage:"Something went wrong while installing an extension"}),[2];return(0,c.j)(c.U3.EXTENSION_INSTALLED,{name:null===(a=s.result)||void 0===a?void 0:null===(o=a.extension)||void 0===o?void 0:o.name,extensionId:r}),[4,t({installationId:(0,y.Ad)(s.result.id)})];case 2:return l.sent(),[2,s.result]}})}),function(t){return e.apply(this,arguments)}),[t,n])}function T(){var e,t=S(),n=(0,_.Ld)(),i=N().throwSystemError;return(0,m.useCallback)((e=(0,r._)(function(e){var r,o,a;return(0,l.Jh)(this,function(l){switch(l.label){case 0:if(r=e.installationId,o=e.replId,!(a=n.get(C._t).find(function(e){return e.installationId===r})))return i({friendlyMessage:"Extension appears to be already uninstalled",error:Error("Expected extension to be defined")}),[2];if(!a.installationId||!a.extensionId)return i({friendlyMessage:"Failed to uninstall extension",error:Error("Expected installationId to be defined")}),[2];return(0,c.j)(c.U3.EXTENSION_UNINSTALLED,{name:a.manifest.name,extensionId:a.extensionId}),[4,(0,x.Y4)({installationId:a.installationId,replId:o})];case 1:return l.sent(),[4,t(a.installationId)];case 2:return l.sent(),[2]}})}),function(t){return e.apply(this,arguments)}),[t,n,i])}function R(){var e,t=S(),n=E();return(0,m.useCallback)((e=(0,r._)(function(e){return(0,l.Jh)(this,function(r){switch(r.label){case 0:return[4,t(e)];case 1:return r.sent(),[4,n({installationId:e,forceRefetch:!0})];case 2:return r.sent(),[2]}})}),function(t){return e.apply(this,arguments)}),[t,n])}function D(){var e,t,n,i,o=(e=E(),t=(0,_.ZC)(C.Ol),n=N().throwSystemError,(0,m.useCallback)((i=(0,r._)(function(r){var i,o,a,c,s,u,d,f,h,p;return(0,l.Jh)(this,function(l){switch(l.label){case 0:return[4,(0,x.Zw)(r)];case 1:if((i=l.sent()).error)return n({friendlyMessage:"Failed to load installed extensions",error:i.error}),[2];o=!0,a=!1,c=void 0,l.label=2;case 2:l.trys.push([2,9,10,11]),s=i.result[Symbol.iterator](),l.label=3;case 3:if(o=(u=s.next()).done)return[3,8];if(null===(f=(d=u.value).extension)||void 0===f?void 0:f.isDisabled)return t.info("Skipping disabled extension: ".concat(d.extension.name),{extension:!0,extensionId:d.extension.id,installationId:d.id}),[3,7];l.label=4;case 4:return l.trys.push([4,6,,7]),[4,e({installationId:(0,y.Ad)(d.id),forceRefetch:!0})];case 5:return l.sent(),[3,7];case 6:return h=l.sent(),t.error("Extension Loading error: ".concat(h.message),{extension:!0,errors:h.message}),[3,7];case 7:return o=!0,[3,3];case 8:return[3,11];case 9:return p=l.sent(),a=!0,c=p,[3,11];case 10:try{o||null==s.return||s.return()}finally{if(a)throw c}return[7];case 11:return[2]}})}),function(e){return i.apply(this,arguments)}),[e,n,t])),c=(0,_.E4)(C.Ol),s=(0,_.E4)(C.zk),u=(0,a._)((0,m.useState)(!1),2),f=u[0],h=u[1],p=(0,a._)((0,m.useState)(null),2),v=p[0],g=p[1],b=(0,a._)((0,m.useState)(null),2),Z=b[0],w=b[1];return(0,m.useEffect)(function(){if(v&&Z&&!f){var e=v.replId;h(!0),o(e)}},[v,Z,o,f]),(0,m.useCallback)(function(e){var t=e.replId,n=e.userId;if(!f){g({replId:t,userId:n});var r=(0,d.Z)({extension:!0,isInitialized:!0,replId:t,userId:n},{onLog:function(e){s(e)}});w(r),c(r)}},[c,f,s])}function I(){var e,t=E(),n=(0,C.qr)(),i=(0,C.Mu)(),o=(0,_.E4)(C.ot);return(0,m.useCallback)((e=(0,r._)(function(e){var r,a;return(0,l.Jh)(this,function(l){return r=(0,v.BY)(e),(a=n.find(function(e){return e.baseUrl===r}))||o(a={extensionId:(0,y.T8)(w()()),installationId:(0,y.Ad)(w()()),baseUrl:r}),i.find(function(e){return e.extensionId===(null==a?void 0:a.extensionId)})||t({installationId:a.installationId}),[2]})}),function(t){return e.apply(this,arguments)}),[n,i,o,t])}function G(){var e=(0,u.Z)().container,t=(0,s.Z)(e),n=(0,_.E4)(C.M1),i=(0,_.Ld)(),o=E();return(0,m.useCallback)((0,r._)(function(){var e;return(0,l.Jh)(this,function(r){switch(r.label){case 0:if(!t)return[2];return[4,o({installationId:(e=n(t)).installationId,forceRefetch:!0})];case 1:return r.sent(),[2,i.get(C._t).find(function(t){return t.installationId===e.installationId})]}})}),[t,n,o,i])}function B(){var e=(0,u.Z)().container,t=(0,s.Z)(e),n=(0,_.E4)(C.M1),r=(0,C.Mu)();return(0,m.useMemo)(function(){if(t){var e=n(t);return r.find(function(t){return e.installationId===t.installationId})}},[t,r,n])}var A=(0,f.cn)(null,function(e,t,n){var r=e(C.Ol);t(C.wQ,n),r.error("Extension System Error: ".concat(n.error.message),{extensionSystem:!0,originalError:n.error.message,friendlyMessage:n.friendlyMessage})}),P=(0,f.cn)(null,function(e,t,n){var r=e(C._t),i=e(C.Ol),o=r.find(function(e){return e.extensionId===n.extensionId});if(i.error("Extension Error: ".concat(n.extensionError.friendlyMessage),{extension:!0,extensionId:n.extensionId,originalError:n.extensionError.error.message,friendlyMessage:n.extensionError.friendlyMessage}),!o){t(C.nk,{extensionId:n.extensionId,installationId:n.installationId,manifest:(0,v.fF)({name:n.extensionId}),baseUrl:"",enableExperimentalApi:!1,enableInternalApi:!1,logger:i.createLogger({extensionId:n.extensionId,extensionName:n.extensionId,installationId:n.installationId,local:void 0}),isLocal:null}),t(C.f4,{extensionId:n.extensionId,extensionError:n.extensionError});return}t(C.f4,{extensionId:n.extensionId,extensionError:n.extensionError})});function N(){return{throwSystemError:(0,_.E4)(A),throwExtensionError:(0,_.E4)(P)}}},67887:function(e,t,n){n.d(t,{Al:function(){return b},V9:function(){return g},Wc:function(){return s},Y4:function(){return d},Zw:function(){return m},mr:function(){return h}});var r=n(27387),i=n(96583),o=n(3720),a=n(68216),l=n(13090),c=n(65169);function s(e){return u.apply(this,arguments)}function u(){return(u=(0,r._)(function(e){var t,n,r,a,l;return(0,i.Jh)(this,function(i){switch(i.label){case 0:if(t=e.extensionId,n=e.replId,!o.l)return[2,{error:Error("expected apolloClient to be initialized"),result:null}];return[4,o.l.mutate({mutation:c.aq,variables:{extensionId:t,replId:n}})];case 1:if((a=i.sent()).errors&&a.errors.length>0)return[2,{error:Error("Error when installing extension: "+a.errors.map(function(e){return e.message}).join(", ")),result:null}];if(!(l=null===(r=a.data)||void 0===r?void 0:r.installExtension))return[2,{error:Error("Error when installing extension: expected result"),result:null}];if((null==l?void 0:l.__typename)==="UnauthorizedError"||(null==l?void 0:l.__typename)==="UserError")return[2,{error:Error("Error when installing extension: "+l.message),result:null}];if(!l.extension)return[2,{error:Error("Error when installing extension: expected extension to be set"),result:null}];if(!l.extension.url)return[2,{error:Error("Error when installing extension: Extension does not have a URL and cannot be installed"),result:null}];return[2,{result:l,error:null}]}})})).apply(this,arguments)}function d(e){return f.apply(this,arguments)}function f(){return(f=(0,r._)(function(e){var t,n,r,a,l;return(0,i.Jh)(this,function(i){switch(i.label){case 0:if(t=e.installationId,n=e.replId,!o.l)return[2,{error:Error("expected apolloClient to be initialized"),result:null}];return[4,o.l.mutate({mutation:c.jF,variables:{installationId:t,replId:n}})];case 1:if((a=i.sent()).errors&&a.errors.length>0)return[2,{error:Error("Error when uninstalling extension: "+a.errors.map(function(e){return e.message}).join(", ")),result:null}];if(!(l=null===(r=a.data)||void 0===r?void 0:r.uninstallExtension))return[2,{error:Error("Error when uninstalling extension: expected result"),result:null}];if((null==l?void 0:l.__typename)==="NotFoundError"||(null==l?void 0:l.__typename)==="UserError")return[2,{error:Error("Error when uninstalling extension: "+l.message),result:null}];return[2,{result:l,error:null}]}})})).apply(this,arguments)}function h(e){return p.apply(this,arguments)}function p(){return(p=(0,r._)(function(e){var t,n,r=arguments;return(0,i.Jh)(this,function(i){switch(i.label){case 0:if(t=r.length>1&&void 0!==r[1]&&r[1],!o.l)return[2,{error:Error("expected apolloClient to be initialized"),result:null}];return[4,o.l.query({query:c.AR,variables:{installationId:e},fetchPolicy:t?"network-only":"cache-first"})];case 1:if("ExtensionInstallation"!==(n=i.sent().data.extensionInstallationById).__typename)return[2,{error:Error("Expected to find extension installation"),result:null}];if(!n.extension)return[2,{error:Error("Expected installation.extension"),result:null}];return[2,{result:n,error:null}]}})})).apply(this,arguments)}function m(e){return v.apply(this,arguments)}function v(){return(v=(0,r._)(function(e){var t;return(0,i.Jh)(this,function(n){switch(n.label){case 0:if(!o.l)return[2,{error:Error("expected apolloClient to be initialized"),result:null}];return[4,o.l.query({query:c.Ve,variables:{replId:e}})];case 1:if("ExtensionInstallationList"!==(t=n.sent().data.extensionInstallations).__typename)return[2,{error:Error("Expected to find ExtensionInstallationList"),result:null}];return[2,{result:t.installations,error:null}]}})})).apply(this,arguments)}function g(e){return y.apply(this,arguments)}function y(){return(y=(0,r._)(function(e){var t,n,r,o,c;return(0,i.Jh)(this,function(i){switch(i.label){case 0:t=(0,l.BP)(e),i.label=1;case 1:return i.trys.push([1,4,,5]),[4,fetch(t)];case 2:return[4,i.sent().text()];case 3:if(n=i.sent(),r=a.ku(n),(o=(0,l.U4)(r)).error)return[2,{error:o.error,result:null}];return[2,{result:o.manifest,error:null}];case 4:if("SyntaxError"===(c=i.sent()).name)return[2,{error:Error("Error when fetching manifest: invalid JSON"),result:null}];return[2,{error:Error("Error when fetching manifest: "+c.message),result:null}];case 5:return[2]}})})).apply(this,arguments)}function b(){return Z.apply(this,arguments)}function Z(){return(Z=(0,r._)(function(){var e;return(0,i.Jh)(this,function(t){switch(t.label){case 0:if(!o.l)return[2,{error:Error("expected apolloClient to be initialized"),result:null}];return[4,o.l.query({query:c.LF,fetchPolicy:"cache-first"})];case 1:if(!(e=t.sent().data.currentUser)||"CurrentUser"!==e.__typename)return[2,{error:Error("Expected to find CurrentUser"),result:null}];return[2,{result:{userHasInternalApiEnabled:e.isAdmin||e.isStaff},error:null}]}})})).apply(this,arguments)}},18440:function(e,t,n){n.d(t,{Lq:function(){return C},M1:function(){return B},Mu:function(){return M},Ol:function(){return S},UB:function(){return T},UT:function(){return R},WG:function(){return H},We:function(){return A},_K:function(){return N},_t:function(){return x},c_:function(){return W},ep:function(){return D},f4:function(){return P},jx:function(){return X},nk:function(){return I},ot:function(){return G},qr:function(){return z},r9:function(){return F},s6:function(){return V},wQ:function(){return _},zk:function(){return k}});var r,i,o,a=n(27387),l=n(41733),c=n(30509),s=n(66626),u=n(63257),d=n(96583),f=n(50199),h=n(70226),p=n(64461),m=n(90234),v=n(35554),g=n.n(v),y=n(46565),b=n(85234),Z=n.n(b),w=n(19418),x=(0,m.cn)([]),C=(0,m.cn)([]),_=(0,m.cn)(null),S=(0,m.cn)((0,h.Z)({extension:!0,isInitialized:!1},{onLog:function(){throw Error("Logged before extension system was initialized.")}})),E=(0,m.cn)([]),k=(0,m.cn)(null,function(e,t,n){var r=e(E);t(E,(0,p.Uy)(r,function(e){e.push((0,p.Uy)(n,function(t){t.index=e.length})),e.length>1e3&&e.splice(0,e.length-1e3)}))}),T=(0,m.cn)(null,function(e,t){t(E,[])}),R=(0,m.cn)("local:true"),D=(0,m.cn)(function(e){var t=e(E),n=e(R);if(!n)return t;var r=n.split(" ").map(function(e){var t=(0,s._)(e.split(":"),2),n=t[0],r=t[1];return n&&void 0===r?function(e){return e.message.toLowerCase().includes(n.toLowerCase())}:n&&""===r?function(e){return void 0!==g()(e,n)}:n&&r?function(e){try{return String(g()(e,n))===r}catch(e){return!1}}:null}).filter(function(e){return null!==e});return t.filter(function(e){return r.every(function(t){return t(e)})})}),I=(0,m.cn)(null,(r=(0,a._)(function(e,t,n){return(0,d.Jh)(this,function(r){if(e(x).find(function(e){return e.extensionId===n.extensionId}))throw Error("Extension already loaded");return t(x,function(e){return(0,p.Uy)(e,function(e){var t,r,i,o,a,l,c,s,u=(r=n.baseUrl,i=n.extensionId,o=n.installationId,a=n.manifest,l=n.enableExperimentalApi,c=n.enableInternalApi,s=n.logger,{baseUrl:r,extensionId:i,installationId:o,manifest:a,isLocal:n.isLocal,stateAtom:(0,m.cn)({error:null,panes:[],scopes:new Set(null===(t=a.scopes)||void 0===t?void 0:t.map(function(e){return e.name})),enableExperimentalApi:l,enableInternalApi:c,commands:new Map}),logger:s});e.push(u)})}),[2]})}),function(e,t,n){return r.apply(this,arguments)})),G=(0,m.cn)(null,(i=(0,a._)(function(e,t,n){return(0,d.Jh)(this,function(r){if(e(C).find(function(e){return e.extensionId===n.extensionId||e.installationId===n.installationId||e.baseUrl===n.baseUrl}))throw Error("Extension already loaded");return t(C,function(e){return(0,p.Uy)(e,function(e){e.push(n)})}),[2]})}),function(e,t,n){return i.apply(this,arguments)})),B=(0,m.cn)(null,function(e,t,n){var r=e(C).find(function(e){return e.baseUrl===n});if(r)return r;var i={baseUrl:n,extensionId:(0,y.T8)(Z()()),installationId:(0,y.Ad)(Z()())};return t(C,function(e){return(0,p.Uy)(e,function(e){e.push(i)})}),i}),A=(0,m.cn)(null,(o=(0,a._)(function(e,t,n){return(0,d.Jh)(this,function(e){return t(x,function(e){return(0,p.Uy)(e,function(e){var t=e.findIndex(function(e){return"extensionId"in n?e.extensionId===n.extensionId:e.installationId===n.installationId});-1!==t&&e.splice(t,1)})}),[2]})}),function(e,t,n){return o.apply(this,arguments)})),P=(0,m.cn)(null,function(e,t,n){var r=e(x).find(function(e){return e.extensionId===n.extensionId});if(!r)throw Error("Extension not found");t(r.stateAtom,function(e){return(0,p.Uy)(e,function(e){e.error=n.extensionError})})}),N=(0,m.cn)(null,function(e,t,n){var r=n.createCommand.id;t(n.extensionStateAtom,function(e){return(0,p.Uy)(e,function(e){e.commands.set(r,n.createCommand)})})}),U=(0,m.cn)(function(e){return e(x).flatMap(function(t){return(0,u._)(e(t.stateAtom).commands.values())})}),O=(0,m.cn)(function(e){return e(x).map(function(e){var t;return null===(t=e.manifest.fileHandlers)||void 0===t?void 0:t.map(function(t){return(0,c._)((0,l._)({},t),{extension:e})})}).flat().filter(function(e){return!!e})}),L=(0,m.cn)(function(e){return e(x).map(function(e){var t;return null===(t=e.manifest.tools)||void 0===t?void 0:t.map(function(t){return(0,c._)((0,l._)({},t),{extension:e})})}).flat().filter(function(e){return!!e})});function M(){return(0,w.ZC)(x)}function X(e){return M().find(function(t){return t.installationId===e})}function F(e){var t=X(e);return t&&e?t.stateAtom:null}function W(){return(0,w.ZC)(O)}function H(){return(0,w.ZC)(L)}function V(e){var t=(0,w.ZC)(U);return(0,f.Z)(function(){return t.filter(function(t){return t.contributions.includes(e)})},[t,e])}function z(){return(0,w.ZC)(C)}},19418:function(e,t,n){n.d(t,{E4:function(){return f},Ld:function(){return s},OA:function(){return u},Wv:function(){return h},ZC:function(){return d}});var r=n(66626),i=n(74985),o=n(90234),a=n(71999),l=n(50959),c=(0,l.createContext)(null);function s(){return function(){var e=(0,l.useContext)(c);if(!e)throw Error("Expected extensions context");return e}().store}var u=function(e){var t=s();return(0,a.KO)(e,{store:t})};function d(e){var t=s();return(0,a.Dv)(e,{store:t})}var f=function(e){var t=s();return(0,a.b9)(e,{store:t})};function h(e){var t=e.children,n=(0,r._)((0,l.useState)(function(){return(0,o.MT)()}),1)[0];return(0,i.tZ)(c.Provider,{value:{store:n},children:t})}},19724:function(e,t,n){var r,i;n.d(t,{Y:function(){return r}}),(i=r||(r={})).CommandBar="commandbar",i.FiletreeContextMenu="filetree-context-menu",i.SidebarSearch="sidebar-search",i.EditorContextMenu="editor-context-menu"},70226:function(e,t,n){n.d(t,{Z:function(){return function e(t,n){var r=function(e){var r,i,l,s,f=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{logLevel:"debug"},h=null!==(r=(i={},(0,o._)(i,"debug",c.kg.debug),(0,o._)(i,"warn",c.kg.warn),(0,o._)(i,"info",c.kg.info),(0,o._)(i,"error",c.kg.error),i)[f.logLevel])&&void 0!==r?r:c.kg.debug;(null!==(l=(s={},(0,o._)(s,"debug",d.debug),(0,o._)(s,"warn",d.warn),(0,o._)(s,"info",d.info),(0,o._)(s,"error",d.error),s)[f.logLevel])&&void 0!==l?l:d.debug)(e,f),h(e,u()((0,a._)({},f,t),["replId","logLevel"])),n.onLog((0,a._)({message:e},f,t))};return{context:t,info:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r(e,(0,l._)((0,a._)({},t),{logLevel:"info"}))},warn:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r(e,(0,l._)((0,a._)({},t),{logLevel:"warn"}))},error:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r(e,(0,l._)((0,a._)({},t),{logLevel:"error"}))},createLogger:function(r){return e((0,a._)({},t,r),n)}}}},i:function(){return i}});var r,i,o=n(42516),a=n(41733),l=n(30509),c=n(2689),s=n(59245),u=n.n(s),d=n(49500);(r=i||(i={})).debug="debug",r.info="info",r.warn="warn",r.error="error"},3574:function(e,t,n){n.d(t,{Cl:function(){return a},VD:function(){return d},uN:function(){return u}});var r=n(90234),i=n(71999),o=n(50959),a=(0,o.createContext)(null),l=(0,r.cn)(null),c=(0,r.cn)(null,function(e,t,n){t(l,n)});function s(){var e=(0,o.useContext)(a);if(!e)throw Error("Expected store in context");return e}function u(){return(0,i.Dv)(l,{store:s()})}function d(e){var t=(0,i.Dv)(l,{store:s()}),n=(0,i.b9)(c,{store:s()});(0,o.useEffect)(function(){t!==e&&n(e)},[e,t,n])}},88883:function(e,t,n){n.d(t,{Z:function(){return a}});var r=n(54916),i=n(50959),o=n(19659);function a(e){var t=(0,r.Z)().fs,n=(0,i.useCallback)(function(n,r){var i=n.code,a=n.insertAt,l=n.newLine,c=void 0===l||l;if(!e||(0,o.T3)(e)||(0,o.sL)(e)||(0,o.IQ)(e)||(0,o.hj)(e))throw Error("Invalid file, this should never happen");if(0!==i.length)var s=t.watchTextFile(e,{onReady:function(e){var n=e.initialContent,o=e.writeChange,l=n.toString(),u="end"===a?l.length:a,d=i;c&&(0!==u&&u!==l.length&&-1===(u=l.indexOf("\n",u))&&(u=l.length),0!==u&&"\n"!==l[u-1]&&(d="\n"+d),"\n"!==l[u]&&(d+="\n")),o({from:u,insert:d},r),t.flush().finally(function(){s()})}})},[e,t]);return!e||(0,o.T3)(e)||(0,o.sL)(e)||(0,o.IQ)(e)||(0,o.hj)(e)?null:n}},51279:function(e,t,n){n.d(t,{Z:function(){return y}});var r=n(27387),i=n(66626),o=n(63257),a=n(96583),l=n(58626),c=n(59868),s=n(17789),u=n(54916),d=n(26851),f=n(58091),h=n(50959),p=n(19659),m=n(30084),v=n(63009),g=n(86790);function y(e){var t,n,y,b=e.moveOrDeleteFile,Z=(0,u.Z)().fs,w=(0,d.K)(),x=(0,h.useRef)(new Map),C=(0,f.ex)(),_=(0,i._)((0,h.useState)(!1),2),S=_[0],E=_[1],k=(0,i._)((0,h.useState)(!1),2),T=k[0],R=k[1],D=(0,i._)((0,h.useState)([]),2),I=D[0],G=D[1],B=(0,g.k)(),A=(0,v.uV)(),P=I.map(function(e){return e.path}).map(function(e){return{title:e,path:e}}),N=(0,i._)((0,h.useState)(),2),U=N[0],O=N[1],L=(0,f.Gg)();(0,h.useEffect)(function(){if(!(!C||x.current.has(C))&&C!==s.w){var e=function(e){var t=e.node.path;L(e.eventType===m.kS.Move?{path:t,type:"move",to:e.to}:{path:t,type:"delete"}),b&&b(e),x.current.delete(C),G(function(e){return e.filter(function(e){return e.path!==C})})};(0,p.Mb)(C)?Z.watchTextFile(C,{onMoveOrDelete:e,onError:function(e,t){e.code||(Z.flush(),Z.persist({skipDebounce:!0}),A({error:e,extras:t,tags:{ot:!0},origin:"useContentsDiverged: fs.watchTextFile"}))},onReconnectFail:function(e,t){G(function(n){return(0,o._)(n.filter(function(e){return e.path!==C})||[]).concat([{path:C,prompt:t,cb:e}])}),w("user:ot:diverged",{path:C,divergence:t}),E(!0),U||O(C)}}):Z.watchFile(C,{onChange:function(){},onMoveOrDelete:e}),x.current.set(C,!0)}},[C,Z,A,b,U,w,L]);var M=(t=(0,r._)(function(e){return(0,a.Jh)(this,function(t){switch(t.label){case 0:return(0,c.j)(c.U3.FILE_RECONNECT_FALLBACK_CHOSEN,{choice:e}),(0,c.j)(c.U3.CONTENTS_DIVERGED_ACTION,{action:"local"===e?"client":"server"}),R(!0),[4,Promise.all(I.map(function(t){return G(function(e){var n=e.filter(function(e){return e.path!==t.path});return 0===n.length?E(!1):O(n[0].path),n}),t.cb(e)}))];case 1:return t.sent(),R(!1),[2]}})}),function(e){return t.apply(this,arguments)}),X=U?I.find(function(e){return e.path===U}):null,F=null==X?void 0:X.prompt,W=(0,l.J)({left:{code:null!==(n=null==F?void 0:F.localContent)&&void 0!==n?n:"",filePath:U},right:{code:null!==(y=null==F?void 0:F.remoteContent)&&void 0!==y?y:"",filePath:U}});return{isConverging:T,didContentsDiverge:S,showMoreDetail:B,failedFiles:I,failedFilesOptions:P,selectedFile:U,setSelectedFile:O,reviewingPrompt:F,onChoice:M,local:W.left,remote:W.right}}},78392:function(e,t,n){n.d(t,{F:function(){return eo}});var r,i,o,a,l,c,s=n(27387),u=n(41733),d=n(30509),f=n(66626),h=n(96583),p=n(59121),m=n(55534),v=n(50782),g=n(2689),y=n(52296),b=n.n(y),Z=function(e){var t=b()(e,{baseUrl:!1}).pathname.replace(/\.git$/,"");if(t){var n=(0,f._)(t.split("/").reverse(),2),r=n[0],i=n[1];if(i&&r)return{username:i,repository:r}}},w=n(81106),x=n(54916);(r=a||(a={}))[r.NONE=0]="NONE",r[r.PUSH=1]="PUSH",r[r.CLONE=2]="CLONE",r[r.FETCH=3]="FETCH",r[r.GITHUB_CREATE=4]="GITHUB_CREATE",r[r.GITHUB_GET_INFO=5]="GITHUB_GET_INFO",(i=l||(l={})).None="NONE",i.NoMergeBase="NO_MERGE_BASE",i.AuthFetchError="AUTH_FETCH_ERROR",i.IndexFilesCorrupted="INDEX_FILES_CORRUPTED",(o=c||(c={}))[o.UNTRACKED=0]="UNTRACKED",o[o.MODIFIED=1]="MODIFIED",o[o.MOVED=2]="MOVED",o[o.DELETED=3]="DELETED";var C="git log -0 2>/dev/null && ".concat("git symbolic-ref HEAD --short"," || echo 'HEAD'");function _(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return["bash","-c",t.join("&&")]}var S={format:function(e,t){return _('[ ! -d ".git" ]',"git init","git checkout -b main",'git config user.name "'.concat(t.username||"Replit user",'"'),'git config user.email "<>"',"touch .git/branches/.keep","touch .git/info/.keep","touch .git/objects/.keep","touch .git/refs/.keep")}},E={format:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=null!==(t=e.remote)&&void 0!==t?t:"";return n?_("git fetch ".concat(r," --progress --deepen=10")):_("git fetch ".concat(e.remote," +refs/heads/*:refs/remotes/origin/* --progress --depth=10"))},parse:function(e,t){return null!==new RegExp(/(^|\n)fatal: Authentication failed/g).exec(t)||null!==new RegExp(/(^|\n)fatal: unable to access/g).exec(t)||null!==new RegExp(/(^|\n)fatal: repository.*not found/g).exec(t)||null!==new RegExp(/(^|\n)fatal: could not read Username/g).exec(t)||null!==new RegExp(/(^|\n)fatal: Could not read from remote repository/g).exec(t)?(0,d._)((0,u._)({},e),{authError:a.FETCH}):e}},k={format:function(e){return["git","remote","get-url","origin"]},parse:function(e,t){return t.includes("No such remote")||t.startsWith("fatal")?(0,d._)((0,u._)({},e),{remote:""}):(0,d._)((0,u._)({},e),{remote:t.trim()})}},T={format:function(e,t){return e.remote?_("git remote remove origin; git remote add origin ".concat(t)):_("git remote add origin ".concat(t))}},R={format:function(e){var t;return _("git remote show ".concat(null!==(t=e.remote)&&void 0!==t?t:""," | grep 'HEAD branch'"))},parse:function(e,t){var n=(0,f._)(t.split(":"),2),r=(n[0],n[1]).trim();return(0,d._)((0,u._)({},e),{defaultBranch:r})}},D={format:function(e){return _("git checkout -f ".concat(e.defaultBranch))}},I={format:function(e){return _("if ! (( $(busybox ps -o comm | grep git) )) ; then rm -rf .git/index.lock; fi ; ".concat("git reset $(".concat(C,") --")))}},G=n(45123),B=n(33859),A=n.n(B),P=n(50959),N=n(21262),U=n(71440),O=n(78711);function L(){var e=(0,N._)(["\n  query WorkspacePatchDotReplitRepl($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        rootOriginReplUrl\n      }\n    }\n  }\n"]);return L=function(){return e},e}var M={},X=(0,U.Ps)(L()),F=function(e,t){return{op:"add",path:e,value:JSON.stringify(t)}},W=new Map([["hintsList","hints"]]);function H(){return(H=(0,s._)(function(e){var t,n,r,i,o,a,l,c,d,p,m,v,g,y,b;function Z(){return w.apply(this,arguments)}function w(){return(w=(0,s._)(function(){var e,n,o;return(0,h.Jh)(this,function(a){switch(a.label){case 0:if(!(e="object"==typeof r.env?r.env:null)||0===Object.keys(e).length)return[2];return o=(n="object"==typeof i.env?i.env:null)?(0,u._)({},e,n):e,[4,t.updateDotReplit([F("env",o)])];case 1:return a.sent(),[2]}})})).apply(this,arguments)}function x(){return C.apply(this,arguments)}function C(){return(C=(0,s._)(function(){var e,o,a,l;return(0,h.Jh)(this,function(c){switch(c.label){case 0:if(null===(e=i.nix)||void 0===e?void 0:e.channel)return[2];if(null==r?void 0:null===(o=r.nix)||void 0===o?void 0:o.channel)return[3,2];return[4,n.getLatestStableChannel()];case 1:if(!(l=c.sent()).channel)return[2];return a=l.channel,[3,3];case 2:a=r.nix.channel,c.label=3;case 3:return[4,t.updateDotReplit([F("nix/channel",a)])];case 4:return c.sent(),[2]}})})).apply(this,arguments)}function _(){return(_=(0,s._)(function(e){var n,o,a,l,c;return(0,h.Jh)(this,function(s){switch(s.label){case 0:if(o=!!(n=i[e]),Array.isArray(n)?o=n.length>0:n&&"object"==typeof n&&(o=Object.keys(n).length>0),l=null!==(a=W.get(e))&&void 0!==a?a:e,o||!r[l])return[2];return c=F(l,r[l]),[4,t.updateDotReplit([c])];case 1:return s.sent(),[2]}})})).apply(this,arguments)}return(0,h.Jh)(this,function(s){switch(s.label){case 0:t=e.dotReplit,n=e.nixService,r=e.templateConfig,i=e.config,o=[],a={entrypoint:"entrypoint config",hidden:"hidden files config",audio:"audio config",run:"run command",refreshWebViewOnFileChange:"webview refresh config",language:"language config",onBoot:"onBoot command",languages:"languages config",compile:"compile command",debugger:"debugger config",packager:"packager config",interpreter:"interpreter config",unitTest:"unit test config",nix:x,env:Z,hosting:"hosting config",gitHubImport:"GitHub import config",auth:"Repl Auth config",hintsList:"Hints config",ports:"Ports config",deployment:"deployment config",orderedEnv:null,modules:"nix modules config",extension:"extension config",rules:"rules config",suggestions:"suggestions config",objectStorage:"object storage config"},l=[],c=!0,d=!1,p=void 0;try{for(m=Object.entries(a)[Symbol.iterator]();!(c=(v=m.next()).done);c=!0)y=(g=(0,f._)(v.value,2))[0],b=g[1],null!==b&&("function"==typeof b?l.push(b()):l.push(function(e){return _.apply(this,arguments)}(y)))}catch(e){d=!0,p=e}finally{try{c||null==m.return||m.return()}finally{if(d)throw p}}return[4,Promise.all(l)];case 1:return s.sent(),[2,o]}})})).apply(this,arguments)}var V=n(71042),z=n(50682),j=n(24418),q=n(37229),Y=n(39756),$=n(30084),J=n(99165);function K(){var e=(0,N._)(["\n  query WorkspaceDoGitHubImportFlow($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        config {\n          gitRemoteUrl\n          doClone\n        }\n      }\n    }\n    currentUser {\n      id\n      gitHubInfo {\n        accessToken\n      }\n      username\n    }\n  }\n"]);return K=function(){return e},e}function Q(){var e=(0,N._)(["\n  mutation WorkspaceDoGitHubImportFlowFinishClone($input: UpdateReplInput!) {\n    updateRepl(input: $input) {\n      repl {\n        id\n        config {\n          doClone\n        }\n      }\n    }\n  }\n"]);return Q=function(){return e},e}function ee(){var e=(0,N._)(["\n  query GitHubImportRootOriginReplUrl($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        rootOriginReplUrl\n      }\n    }\n  }\n"]);return ee=function(){return e},e}var et={},en=(0,U.Ps)(K()),er=(0,U.Ps)(Q());ee();var ei=n(91620).lW;function eo(e){var t,n,r,i,o,c,y,b,C,_,B,N,U,L,F,W,K,Q,ee,eo,ea,el,ec,es,eu,ed,ef,eh,ep=e.insertConfigPlugin,em=e.setConfigScreenLockIsOpen,ev=e.openFile,eg=(0,v.Z)(),ey=(0,f._)((t=(0,u._)({},et,void 0),J.D(er,t)),2),eb=ey[0],eZ=ey[1],ew=(0,f._)((0,P.useState)(null),2),ex=ew[0],eC=ew[1],e_=(0,x.Z)(),eS=e_.container,eE=e_.fs,ek=e_.runner,eT=e_.dotReplit,eR=(0,w.Z)(eS),eD=(0,m.Z)(),eI=eD.showError,eG=eD.showConfirm,eB=(r=(n=(0,x.Z)()).dotReplit,i=n.nixService,o=(0,v.Z)(),y=(0,f._)((c=(0,u._)({},M,void 0),O.t(X,c)),1)[0],C=(b=(0,m.Z)()).showWarning,_=b.showError,(0,P.useCallback)((B=(0,s._)(function(e){var t,n,a,l,c,s,u,d,f,p,m;return(0,h.Jh)(this,function(h){switch(h.label){case 0:return[4,r.getConfig()];case 1:if(!(t=h.sent().config))return[2];return[4,y({variables:{replId:o}})];case 2:if(!(null==(a=(null==(n=h.sent().data)?void 0:n.repl.__typename)==="Repl"?n.repl:null)?void 0:a.rootOriginReplUrl))return[2];try{l=A().parse(e.toString())}catch(e){return _("Failed to parse template .replit file"),g.kg.error("GitHub Import: Failed to parse template .replit file"),[2]}if(!l)return[2];return[4,function(e){return H.apply(this,arguments)}({nixService:i,dotReplit:r,config:t,templateConfig:l})];case 3:c=h.sent(),s=!0,u=!1,d=void 0;try{for(f=c[Symbol.iterator]();!(s=(p=f.next()).done);s=!0)m=p.value,C(m,1e3)}catch(e){u=!0,d=e}finally{try{s||null==f.return||f.return()}finally{if(u)throw d}}return[2]}})}),function(e){return B.apply(this,arguments)}),[o,C,_,r,i,y]));(0,P.useEffect)(function(){eZ.error&&eI("Failed to finish cloning Repl - "+eZ.error)},[eZ.error,eI]),(0,P.useEffect)(function(){ex&&eI("Failed to finish cloning Repl - "+ex)},[ex,eI]),(0,P.useEffect)(function(){eZ.data&&eG("Finished cloning Repl")},[eZ.data,eG]),(0,P.useEffect)(function(){eA()},[]);var eA=(0,f._)((U={variables:{replId:eg},fetchPolicy:"no-cache",onCompleted:(N=(0,s._)(function(e){var t,n,r,i,o,a;return(0,h.Jh)(this,function(l){switch(l.label){case 0:if(t=e.repl,n=e.currentUser,"Repl"!==t.__typename||!n||"CurrentUser"!==n.__typename||!t.config.gitRemoteUrl||!t.config.doClone)return[2];l.label=1;case 1:return l.trys.push([1,3,4,5]),em(!0),[4,e$({remote:null!==(i=t.config.gitRemoteUrl)&&void 0!==i?i:"",accessToken:null!==(o=null===(r=n.gitHubInfo)||void 0===r?void 0:r.accessToken)&&void 0!==o?o:null,username:n.username})];case 2:return l.sent(),[3,5];case 3:return a=l.sent(),g.kg.error("GitHub Import: Failed to do GitHub import flow",{originalError:String(a)}),eC(String(a)),[3,5];case 4:return em(!1),[7];case 5:return[2]}})}),function(e){return N.apply(this,arguments)})},L=(0,u._)({},et,U),O.t(en,L)),1)[0],eP={isInitialized:!1,hasConflictsWithFetchedRemote:!1,hasMergeBaseWithFetchedRemote:!0,authError:a.NONE,badState:l.None,remote:"",repoId:null,branch:"",defaultBranch:"main",branches:[],installations:[],changedFiles:[],commits:[],commitsAhead:null,commitsBehind:null,remoteToken:null,gitHubName:null,ownerId:null,gitHubAvatarUrl:null,gitHubEmail:null},eN=(F=(0,s._)(function(e){return(0,h.Jh)(this,function(t){switch(t.label){case 0:return[4,eR({args:S.format(eP,null!=e?e:"")})];case 1:return t.sent(),[2]}})}),function(e){return F.apply(this,arguments)}),eU=(W=(0,s._)(function(e){return(0,h.Jh)(this,function(t){switch(t.label){case 0:return[4,eR({args:T.format(eP,e)})];case 1:return t.sent(),[2]}})}),function(e){return W.apply(this,arguments)}),eO=(K=(0,s._)(function(){var e;return(0,h.Jh)(this,function(t){switch(t.label){case 0:return[4,eR({args:k.format(eP)})];case 1:if(e=t.sent(),!k.parse)return[2];return[2,k.parse(eP,null===e.error?e.output:"").remote]}})}),function(){return K.apply(this,arguments)}),eL=(Q=(0,s._)(function(e){var t,n,r;return(0,h.Jh)(this,function(i){switch(i.label){case 0:return t=e.remote,n=e.remoteToken,[4,eR({args:R.format((0,d._)((0,u._)({},eP),{remote:t,remoteToken:n}))})];case 1:if(r=i.sent(),!R.parse)return[2];return[2,R.parse(eP,null===r.error?r.output:"HEAD branch: main").defaultBranch]}})}),function(e){return Q.apply(this,arguments)}),eM=(ee=(0,s._)(function(e){return(0,h.Jh)(this,function(t){switch(t.label){case 0:return[4,eR({args:D.format((0,d._)((0,u._)({},eP),{defaultBranch:e}))})];case 1:return t.sent(),[2]}})}),function(e){return ee.apply(this,arguments)}),eX=(eo=(0,s._)(function(e){var t,n;return(0,h.Jh)(this,function(r){switch(r.label){case 0:return t=e.remote,n=e.remoteToken,[4,eF()];case 1:return r.sent(),[4,eO()];case 2:return r.sent(),[4,eW({deepen:!0,remote:t,remoteToken:n})];case 3:return r.sent(),[2]}})}),function(e){return eo.apply(this,arguments)}),eF=(ea=(0,s._)(function(){return(0,h.Jh)(this,function(e){switch(e.label){case 0:return[4,eR({args:I.format(eP)})];case 1:return e.sent(),[2]}})}),function(){return ea.apply(this,arguments)}),eW=(el=(0,s._)(function(e){var t,n,r,i;return(0,h.Jh)(this,function(o){switch(o.label){case 0:if(n=void 0!==(t=e.deepen)&&t,r=e.remote,i=e.remoteToken,!r.startsWith("https://api.glitch.com"))return[3,2];return[4,eR({args:["git","fetch",r,"+refs/heads/*:refs/remotes/origin/*"]})];case 1:case 3:return o.sent(),[2];case 2:return[4,eR({args:E.format((0,d._)((0,u._)({},eP),{remote:r,remoteToken:i}),n)})]}})}),function(e){return el.apply(this,arguments)}),eH=(ec=(0,s._)(function(){var e,t,n,r,i,o;return(0,h.Jh)(this,function(a){switch(a.label){case 0:return[4,eE.readDir(Y.Ql)];case 1:if((r=a.sent()).error)return[2];return[4,eT.getConfig()];case 2:if(!(null===(t=(i=a.sent()).config)||void 0===t?void 0:null===(e=t.gitHubImport)||void 0===e?void 0:e.requiredFiles))return[3,4];return o=i.config.gitHubImport.requiredFiles.map(function(e){return new RegExp(e)}),[4,Promise.all(r.children.filter(function(e){return!o.some(function(t){return null!=e.filename.match(t)})}).map(function(e){return e.type===$.Tv.Directory?eE.deleteDir(e.filename):eE.deleteFile(e.filename)}))];case 3:return a.sent(),[3,6];case 4:if(!(null===(n=i.config)||void 0===n?void 0:n.entrypoint))return[3,6];return[4,eE.deleteFile(i.config.entrypoint)];case 5:a.sent(),a.label=6;case 6:return[2]}})}),function(){return ec.apply(this,arguments)}),eV=(es=(0,s._)(function(e,t,n){var r;return(0,h.Jh)(this,function(i){switch(i.label){case 0:return[4,eN(n)];case 1:return i.sent(),[4,eU(e)];case 2:return i.sent(),[4,eO()];case 3:return i.sent(),[4,eW({deepen:!1,remote:e,remoteToken:t})];case 4:return i.sent(),[4,eL({remote:e,remoteToken:t})];case 5:return[4,eM(null!=(r=i.sent())?r:"")];case 6:return i.sent(),[4,eX({remote:e,remoteToken:t})];case 7:if(i.sent(),"html"!==ek.mode)return[3,10];return[4,(0,V.r)(eS,Y.Ql)];case 8:return i.sent(),[4,ek.run()];case 9:i.sent(),i.label=10;case 10:return[2]}})}),function(e,t,n){return es.apply(this,arguments)}),ez=(eu=(0,s._)(function(){var e;return(0,h.Jh)(this,function(t){switch(t.label){case 0:return[4,(0,G.W)({dotReplit:eT,fs:eE})];case 1:return(e=t.sent().entrypoint)&&ev({path:e}),[2]}})}),function(){return eu.apply(this,arguments)}),ej=(ed=(0,s._)(function(e,t){var n;return(0,h.Jh)(this,function(r){switch(r.label){case 0:return[4,(0,z.J9)({repoNameWithOwner:e,accessToken:t})];case 1:if("error"in(n=r.sent()))return[2,{hasDotReplit:!1,hasProcfile:!1}];return[2,{hasDotReplit:n.some(function(e){return e.path===j.l}),hasProcfile:n.some(function(e){return e.path===p.E})}]}})}),function(e,t){return ed.apply(this,arguments)}),eq=(ef=(0,s._)(function(e,t){var n,r,i,o,a,l,c,s;return(0,h.Jh)(this,function(u){switch(u.label){case 0:return[4,(0,z.LK)({repoNameWithOwner:e,filePath:p.E,accessToken:t})];case 1:if("error"in(n=u.sent())||(r=ei.from(n.content,"base64").toString(),!(i=(0,p.c)(r))||!(a=null!==(o=i.web)&&void 0!==o?o:i.worker)))return[2,{showConfigPanel:!0}];return l=a.command+" "+a.options.join(" "),[4,eT.updateDotReplit([(0,q.KQ)(l),(0,q.xz)("interpreter")])];case 2:if(c=u.sent(),s=i.web&&!i.worker||!i.web&&i.worker,c.error||!s)return[2,{showConfigPanel:!0}];return[2,{showConfigPanel:!1}]}})}),function(e,t){return ef.apply(this,arguments)});function eY(){return eE.readFile(j.l)}var e$=(eh=(0,s._)(function(e){var t,n,r,i,o,a,l,c,s,u,d;return(0,h.Jh)(this,function(f){switch(f.label){case 0:return t=e.remote,n=e.accessToken,r=e.username,g.kg.info("GitHub Import: Starting client-side GitHub import flow"),[4,eY()];case 1:return i=f.sent(),[4,eH()];case 2:return f.sent(),g.kg.info("GitHub Import: Removed template boilerplate"),[4,eV(t,n,r)];case 3:if(f.sent(),g.kg.info("GitHub Import: Cloned repo into Repl"),"content"in i)return[3,4];return g.kg.error("GitHub Import: Skipping patching dotReplit because templateDotReplit was an error",{readError:String(i.error)}),[3,7];case 4:return[4,eY()];case 5:return"content"in(o=f.sent())&&o.content.toString()!==i.content.toString()&&g.kg.info("GitHub Import: Repo has .replit",{githubURL:t}),[4,eB(i.content)];case 6:f.sent(),f.label=7;case 7:return g.kg.info("GitHub Import: Patched dotreplit"),[4,eb({variables:{input:{id:eg,doClone:!1}}})];case 8:return f.sent(),g.kg.info("GitHub Import: Disabled doClone on Repl. Done."),[4,ez()];case 9:if(f.sent(),a=Z(t),l=!1,!a)return[3,13];return c=a.username,s=a.repository,[4,ej("".concat(c,"/").concat(s),n)];case 10:if(d=(u=f.sent()).hasDotReplit,!(u.hasProcfile&&!d))return[3,12];return[4,eq("".concat(c,"/").concat(s),n)];case 11:return l=!f.sent().showConfigPanel,[3,13];case 12:l=d,f.label=13;case 13:if("html"===ek.mode||l)return[2];return ep(),[2]}})}),function(e){return eh.apply(this,arguments)})}},5218:function(e,t,n){n.d(t,{T:function(){return d}});var r=n(50782),i=n(41733),o=n(21262),a=n(71440),l=n(58995);function c(){var e=(0,o._)(["\n  query WorkspaceEduPaneEnabled($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        isModelSolution\n        isProject\n        isProjectFork\n        owner {\n          __typename\n          ... on Team {\n            id\n            isAdmin\n          }\n          ... on User {\n            id\n          }\n        }\n      }\n    }\n  }\n"]);return c=function(){return e},e}var s={},u=(0,a.Ps)(c());function d(){var e,t,n,o=(t={variables:{replId:(0,r.Z)()}},n=(0,i._)({},s,t),l.a(u,n)).data,a=(null==o?void 0:null===(e=o.repl)||void 0===e?void 0:e.__typename)==="Repl"?null==o?void 0:o.repl:null;if(!a)return!1;var c=a.owner;return!!c&&a.isProjectFork&&!a.isModelSolution&&"Team"===c.__typename&&c.isAdmin}},73858:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(66626),i=n(47001),o=n(17867),a=n(54916),l=n(50959),c=n(30084);function s(){var e=(0,a.Z)(),t=e.fs,n=e.container,s=(0,r._)((0,l.useState)(!1),2),u=s[0],d=s[1],f=(0,o.Z)(n),h=(0,r._)((0,l.useState)(!1),2),p=h[0],m=h[1];return((0,l.useEffect)(function(){f===i.em.CONNECTED&&m(!0)},[f]),(0,l.useEffect)(function(){return d(t.getStatus()===c.kO.Syncing),t.onStatusChange(function(e,t){var n=t.hasUserChanged;d(e===c.kO.Syncing&&n)})},[t]),p)?{isSaving:u,isOffline:f!==i.em.CONNECTED}:{isSaving:!1,isOffline:!1}}},13779:function(e,t,n){n.d(t,{O:function(){return s}});var r=n(27387),i=n(96583),o=n(25632),a=n(25425),l=n(57369),c=n(19858);function s(){var e,t,n,s=(0,a.P5)({controlName:"flag-filetree-git-status",logFlagToAnalytics:!1}),u=(0,o.Gn)("showFileTreeGitStatus").preferences.showFileTreeGitStatus&&s,d=(0,c.Z)((e=(0,r._)(function(e){var t,n;return(0,i.Jh)(this,function(r){switch(r.label){case 0:if(!u)return[2,{status:null,error:null}];return[4,e.getRepositoryState()];case 1:if((t=r.sent()).error)return[2,t];if(t.type!==l.y5.NORMAL)return[2,{status:null,error:null}];return[4,e.status()];case 2:if((n=r.sent()).error)return[2,n];return[2,{status:n,error:null}]}})}),function(t){return e.apply(this,arguments)}),[u]);return d&&!d.error&&(null===(t=d.status)||void 0===t?void 0:t.changes)?function(e){var t=new Map,n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value;t.set(l.path,{index:l.type.index,worktree:l.type.worktree})}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return t}(null===(n=d.status)||void 0===n?void 0:n.changes):null}},71881:function(e,t,n){n.d(t,{Z:function(){return d}});var r=n(25425),i=n(50782),o=n(23394),a=n(11516),l=n(54916),c=n(50959),s=n(39756),u="persistmirrored";function d(){var e=(0,o.T)(),t=(0,i.Z)(),n=(0,r.P5)({controlName:"flag-persist-mirror-html",default:!0,logFlagToAnalytics:!1}),d=(0,l.Z)().container;(0,c.useEffect)(function(){if(!(!e||!n||(null!==(r=a.Z.get(u,"array"))&&void 0!==r?r:[]).includes(t))){var r,i=d.openChannel({service:"gcsfiles",skip:function(e){return!e.repl.currentUserPermissions.containerWrite}},function(e){return e.channel.request({persistMirror:{path:s.Ql}}).then(function(e){if(e.ok){var n,r;r=null!==(n=a.Z.get(u,"array"))&&void 0!==n?n:[],a.Z.set(u,r.concat(t)),i()}}),function(){}});return i}},[d,e,n,t])}},51359:function(e,t,n){n.d(t,{Z:function(){return a}});var r=n(47001),i=n(54916),o=n(50959);function a(){var e=(0,i.Z)().container;(0,o.useEffect)(function(){var t=function(){e.getConnectionState()===r.em.CONNECTED&&e.focus()};return window.addEventListener("focus",t),function(){window.removeEventListener("focus",t)}},[e])}},6309:function(e,t,n){n.d(t,{Z:function(){return v}});var r=n(74985),i=n(25425),o=n(55534),a=n(74833),l=n(56596),c=n(93918),s=n(20573),u=n(29287),d=n(54916),f=n(50959),h=n(81810),p=(0,c.X)({noticeContainer:[u.l0.rowWithGap(8),u.l0.align.center],noticeText:[u.l0.colWithGap(0)]}),m=new Set([3e3,3001,3002,3003,4200,5e3,5173,6e3,6800,8e3,8008,8080,8081,8888,9e3,1e4,25565,25577]);function v(){var e=(0,d.Z)().container,t=(0,o.Z)().showNotice,n=(0,i.P5)({controlName:h.wK,logFlagToAnalytics:!0});(0,f.useEffect)(function(){if(!n)return e.onPortOpened(function(e){var n=e.port,i=e.address;if(!e.isForwarded&&m.has(n)){var o="Port ".concat(n," opened on host ").concat(i,".");t((0,r.BX)(l.G,{css:p.noticeContainer,children:[(0,r.tZ)(s.Z,{}),(0,r.BX)(l.G,{css:p.noticeText,children:[(0,r.tZ)(a.xv,{multiline:!1,children:o}),(0,r.tZ)(a.xv,{variant:"small",multiline:!1,children:"Use the host 0.0.0.0 to open the port to web traffic."})]})]}),1e4)}})},[t,e,n])}},68348:function(e,t,n){n.d(t,{V:function(){return c},Z:function(){return s}});var r=n(66626),i=n(50959),o=n(54916),a=n(39756),l=n(30084),c=".tutorial";function s(){var e=(0,o.Z)().fs,t=(0,r._)((0,i.useState)({isLoading:!0,isTutorial:!1}),2),n=t[0],s=t[1];return(0,i.useEffect)(function(){e.watchDir(a.Ql,{onChange:function(e){s({isLoading:!1,isTutorial:e.some(function(e){return e.type===l.Tv.Directory&&e.filename===c})})},onMoveOrDelete:function(){s({isLoading:!1,isTutorial:!1})},onError:function(){s({isLoading:!1,isTutorial:!1})}})},[e]),n}},61364:function(e,t,n){n.d(t,{ZP:function(){return R},Ln:function(){return T}});var r=n(27387),i=n(96583),o=n(43182),a=n(50782),l=n(47001),c=n(84800),s=n(30173),u=n(33829),d=n(54916),f=n(90234),h=n(71999),p=n(50959),m=n(3042),v=n(97474),g=n(30084),y=n(41733),b=n(21262),Z=n(71440),w=n(80428),x=n(58995);function C(){var e=(0,b._)(["\n  query ReplEnvironmentDesktopLoadCurriculum($id: String!) {\n    currentUser {\n      id\n      isTeacher: hasRole(role: TEACHER)\n      ...CrosisContextCurrentUser\n    }\n    repl(id: $id) {\n      ... on Repl {\n        id\n        isProject\n        isProjectFork\n        isModelSolution\n        isModelSolutionFork\n        owner {\n          ... on Team {\n            id\n          }\n          ... on User {\n            id\n          }\n        }\n        language\n        origin {\n          id\n          ...CrosisContextRepl\n          origin {\n            id\n            ...CrosisContextRepl\n          }\n        }\n      }\n    }\n  }\n  ","\n  ","\n"]);return C=function(){return e},e}var _={},S=(0,Z.Ps)(C(),w.D,w.C),E=n(49500),k=(0,f.cn)(!1);function T(){return(0,h.Dv)(k)}function R(){var e,t,n,f=(0,a.Z)(),b=(0,d.Z)().fs,Z=(e=(0,y._)({},_,{variables:{id:f}}),x.a(S,e)).data,w=(0,h.b9)(k);(0,p.useEffect)(function(){return function(){w(!1)}},[w]);var C=(null==Z?void 0:Z.repl.__typename)==="Repl"?Z.repl:null,T=(null==Z?void 0:null===(t=Z.currentUser)||void 0===t?void 0:t.__typename)==="CurrentUser"?Z.currentUser:null,R=(null==Z?void 0:Z.repl.__typename)==="Repl"&&Z.repl.isModelSolutionFork,D=R?C&&(null===(n=C.origin)||void 0===n?void 0:n.origin):C&&C.origin||null,I=(0,c.b)((null==D?void 0:D.__typename)==="Repl"?{repl:D,currentUser:T||void 0}:null),G=(0,s.S)();(0,p.useEffect)(function(){C&&T&&C.isProject&&b.stat(".lesson").then(function(e){e.exists||b.createDir(".lesson")})},[b,T,C]),(0,p.useEffect)(function(){if(C&&(C.isProjectFork||R)&&D&&I){var e,t=(0,l.ZP)({onUnrecoverableError:function(e){E.error(e),o.$e(function(t){t.setTag("curriculum-authoring",!0),t.setExtra("originId",D.id),o.Tb(e)})}}),n=(0,u.Z)({container:t});t.connect({context:I,getMinimumRetryDelayMs:G,fetchConnectionMetadata:function(){return(0,m.Z)({url:"/data/repls/".concat(C.id,"/get_repl_origin_guest_connection_metadata")})}});var a=t.onConnectionStateChanged((e=(0,r._)(function(e){var r,l;return(0,i.Jh)(this,function(i){switch(i.label){case 0:if(e!==v.e.CONNECTED)return[3,8];a(),i.label=1;case 1:return i.trys.push([1,6,7,8]),[4,b.copyDirFromRemote(".lesson",".lesson",n)];case 2:if(!((r=i.sent()).error&&r.error!==g.Df.NotFound))return[3,3];return o.$e(function(e){e.setTag("curriculum-authoring",!0),e.setExtra("originId",D.id),o.Tb(Error("Error copying lesson: ".concat(r.error)))}),[3,5];case 3:return[4,b.stat(".lesson/instructions.md")];case 4:i.sent().exists&&w(!0),i.label=5;case 5:return[3,8];case 6:return l=i.sent(),o.$e(function(e){e.setTag("curriculum-authoring",!0),o.Tb(l)}),[3,8];case 7:return t.destroy(),[7];case 8:return[2]}})}),function(t){return e.apply(this,arguments)}));return function(){return t.destroy()}}},[b,I,C,D,R,w])}},21488:function(e,t,n){n.d(t,{T:function(){return y}});var r=n(50782),i=n(23394),o=n(43891),a=n(54916),l=n(58091),c=n(50959),s=n(72190),u=n(37685),d=n(41733),f=n(21262),h=n(71440),p=n(58995);function m(){var e=(0,f._)(["\n  query ShouldHideFileInWorkspace($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        isProjectFork\n        isModelSolution\n        isModelSolutionFork\n      }\n    }\n  }\n"]);return m=function(){return e},e}var v={},g=(0,h.Ps)(m()),y=function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=(0,r.Z)(),f=(0,i.Z)(),h=(0,a.Z)().dotReplit,m=(e=(0,d._)({},v,{variables:{replId:n}}),p.a(g,e)),y=m.data,b=m.loading,Z=(null==y?void 0:y.repl.__typename)==="Repl"&&(y.repl.isProjectFork||y.repl.isModelSolution||y.repl.isModelSolutionFork),w=(0,o.P)(h),x=(0,l.t9)();return(0,c.useCallback)(function(e){return!!((Z||b)&&(0,u.TI)(e)||(0,u.MF)(e))||!x&&(t&&(0,u.uC)(e)||(0,s.Ci)(e)||(0,s.cJ)(e)||(0,u.yb)(e,f)||(0,u.lv)(e,w))},[Z,b,f,x,w,t])}},86790:function(e,t,n){n.d(t,{k:function(){return d}});var r=n(47611),i=n(41733),o=n(21262),a=n(71440),l=n(58995);function c(){var e=(0,o._)(["\n  query WorkspaceShowAdmin {\n    currentUser {\n      id\n      isAdmin: hasRole(role: ADMIN)\n    }\n  }\n"]);return c=function(){return e},e}var s={},u=(0,a.Ps)(c());function d(){var e,t,n=(e=(0,i._)({},s,void 0),l.a(u,e)).data,o=(0,r.useRouter)();return(null==n?void 0:null===(t=n.currentUser)||void 0===t?void 0:t.isAdmin)||!!o.query.debug}},92796:function(e,t,n){n.d(t,{B:function(){return D}});var r=n(66626),i=n(25425),o=n(50782),a=n(50199),l=n(2038),c=n(16278),s=n(31593),u=n(81810),d=n(60442),f=n(5218),h=n(68348),p=n(61364),m=n(3947),v=n(75582),g=n(47611),y=n(70504),b=n(41733),Z=n(21262),w=n(71440),x=n(58995);function C(){var e=(0,Z._)(["\n  fragment WorkspaceToolPanesRepl on Repl {\n    isProjectFork\n    isModelSolution\n    isProject\n    isProjectFork\n    workspaceCta\n    currentUserPermissions {\n      containerWrite\n      editMultiplayers\n    }\n    hostingDeploymentPermissions {\n      canDeploy\n    }\n    lang {\n      id\n      key\n      engine\n      supportsGit\n      hasLibSearch\n      supportsPackager3\n      hasDAP\n    }\n    config {\n      isServer\n      isVnc\n    }\n  }\n"]);return C=function(){return e},e}function _(){var e=(0,Z._)(["\n  query WorkspaceToolPanes($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        ...WorkspaceToolPanesRepl\n      }\n    }\n    currentUser {\n      id\n      isAdmin: hasRole(role: ADMIN)\n      isPrivacyLimitedAccess: hasRole(role: PRIVACY_LIMITED_ACCESS)\n      userPowerUpsByType {\n        __typename\n        ... on UserPowerUpsTypes {\n          ghostwriter {\n            active\n          }\n        }\n      }\n    }\n  }\n  ","\n"]);return _=function(){return e},e}var S={},E=(0,w.Ps)(C()),k=(0,w.Ps)(_(),E),T=["shell","git","diff","packager","envEditor","deployments","database","neon","ghostwriterChat","unitTests","submitEduRepl","preferences","docs","multiplayer","adminPanel","sshConfigurator","webview","problems","systemDependencies"],R=["ghostwriterChat","deployments"];function D(){var e,t,n,Z,w,C=(w=(null==(Z=(t={variables:{replId:(0,o.Z)()}},n=(0,b._)({},S,t),x.a(k,n)).data)?void 0:null===(e=Z.repl)||void 0===e?void 0:e.__typename)==="Repl"?null==Z?void 0:Z.repl:null)?{repl:w,currentUser:(null==Z?void 0:Z.currentUser)||null}:{repl:null,currentUser:null},_=C.repl,E=C.currentUser,D=(0,g.useRouter)(),I=(0,l.T3)(),G=(0,l.rv)(),B=(0,i.P5)({controlName:"flag-neon-databases",logFlagToAnalytics:!1}),A=(0,i.P5)({controlName:"flag-postgres-db-god-mode",logFlagToAnalytics:!1}),P=!!((0,i.P5)({controlName:"flag-deployments",logFlagToAnalytics:!1})&&(null==_?void 0:_.hostingDeploymentPermissions.canDeploy)),N=(0,i.P5)({controlName:"flag-repl-auth-sidebar",logFlagToAnalytics:!1}),U=(0,i.P5)({controlName:"flag-nix-modules-tool",logFlagToAnalytics:!1}),O=(0,i.P5)({controlName:"flag-problems-pane",logFlagToAnalytics:!1}),L=(0,i.P5)({controlName:"flag-mb-ai4all",logFlagToAnalytics:!1}),M=(0,i.P5)({controlName:u.wK,logFlagToAnalytics:!1}),X=(0,i.P5)({controlName:"flag-object-storage-pane"}),F=(0,d.cR)(),W=(0,s.Z)().language,H=(0,f.T)(),V=(0,p.Ln)(),z=(0,h.Z)().isTutorial,j=(0,c.I)().some(function(e){return"nix"!==e.id}),q=(0,y.WG)(),Y=(null==E?void 0:E.isAdmin)||!!D.query.debug,$=(0,m.Se)();return(0,a.Z)(function(){var e=I&&(null==_?void 0:_.currentUserPermissions.editMultiplayers),t=(null==E?void 0:null===(g=E.userPowerUpsByType)||void 0===g?void 0:g.__typename)==="UserPowerUpsTypes"&&(null==E?void 0:E.userPowerUpsByType.ghostwriter)&&(null==E?void 0:E.userPowerUpsByType.ghostwriter.active)||L,n=!G||t,i=e?[{type:"multiplayer"}]:[];if(!_||!E)return i;var o=!!_.config.isVnc,a=_.lang.supportsGit,l=_.lang.key.startsWith("html"),c="nix"===_.lang.key,s=_.isProject||_.isProjectFork,u=!s&&null!==W,d=[[{type:"shell"},!0],[{type:"instructions"},V],[{type:"threadInbox"},!0],[{type:"chat"},!0],[{type:"docs",data:{url:null}},!0],[{type:"webview"},!0],[{type:"vnc"},o],[{type:"runnerOutput"},!l],[{type:"git"},a],[{type:"packager"},!0],[{type:"systemDependencies"},!0],[{type:"envEditor"},!l],[{type:"debugger"},!0],[{type:"tutorial"},z],[{type:"database"},!l],[{type:"neon"},A||c&&B],[{type:"replAuth"},!!(N&&j)],[{type:"autograder"},s],[{type:"unitTests"},u],[{type:"education"},!!H],[{type:"preferences"},!0],[{type:"adminPanel"},Y],[{type:"deployments"},P],[{type:"sshConfigurator"},!0],[{type:"ghostwriterChat"},n],[{type:"searchReplace"},!0],[{type:"extensionStore",data:{page:"store"}},!0],[{type:"modules"},U],[{type:"extensionDevtools"},F],[{type:"problems"},O],[{type:"networking"},M],[{type:"objectStorage"},X]];if(I){var f=_.workspaceCta===v.Sy.Submit||_.workspaceCta===v.Sy.Resubmit;d.push([{type:"submitEduRepl"},f])}var h=!0,p=!1,m=void 0;try{for(var g,y,b=q[Symbol.iterator]();!(h=(y=b.next()).done);h=!0){var Z=y.value;d.push([{type:"extension",data:{extensionId:Z.extension.extensionId,installationId:Z.extension.installationId,name:Z.name||Z.extension.manifest.name,icon:Z.icon||Z.extension.manifest.icon,baseUrl:Z.extension.baseUrl,path:Z.handler}},!0])}}catch(e){p=!0,m=e}finally{try{h||null==b.return||b.return()}finally{if(p)throw m}}var w=!0,x=!1,C=void 0;try{for(var S,k=d[Symbol.iterator]();!(w=(S=k.next()).done);w=!0){var D=(0,r._)(S.value,2),J=D[0];D[1]&&(!I||T.includes(J.type))&&i.push(J)}}catch(e){x=!0,C=e}finally{try{w||null==k.return||k.return()}finally{if(x)throw C}}return i.map(function(e){return{title:$.getTitle(e),pane:e}}).sort(function(e,t){return R.includes(e.pane.type)?-1:R.includes(t.pane.type)?1:e.title.localeCompare(t.title)}).map(function(e){return e.pane})},[I,_,E,N,j,W,A,B,V,z,H,Y,P,U,F,O,q,$,L,G,M,X])}},72875:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(2689),i=n(50959);function o(){(0,i.useEffect)(function(){var e=null;return!function t(){if(window.performance.memory){var n=window.performance.memory,i=n.jsHeapSizeLimit,o=n.totalJSHeapSize,a=n.usedJSHeapSize,l=window.performance.now();r.kg.info("perf:browser_memory",{jsHeapSizeLimit:i,totalJSHeapSize:o,usedJSHeapSize:a,timeElapsed:l}),e=setTimeout(t,-(3e5*Math.log(Math.random())))}}(),function(){e&&clearTimeout(e)}},[])}},87716:function(e,t,n){n.d(t,{L:function(){return c}});var r=n(41733),i=n(50782),o=n(87584),a=n(84707),l=n(50959);function c(){var e=(0,i.Z)(),t=(0,o.Z)("fileTree").trackTimeToLoadFileStart;return(0,l.useCallback)(function(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t(n);var o={action:"select",source:"filetree"};i.newTab?o={action:"newTab",source:"filetree"}:i.newPane&&(o={action:"newPane",source:"filetree"}),(0,a.Z)((0,r._)({replId:e},o))},[e,t])}},28470:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(25632),i=n(50782),o=n(59868),a=n(54916),l=n(50959),c=new Set([3e3,3001,3002,3003,3306,4e3,4200,5e3,5432,5173,6e3,6800,7e3,7001,8e3,8008,8080,8081,8888,9e3,9001,1e4,25565,25577,8887,27017,27018]);function s(){var e=(0,a.Z)().container,t=(0,r.Gn)("webviewAutoOpenOnPortOpened").preferences.webviewAutoOpenOnPortOpened,n=(0,i.Z)();(0,l.useEffect)(function(){return e.onPortOpened(function(e){var r=e.port,i=e.address,a=e.isForwarded,l=e.isVnc,s=e.externalPort;if(a){(0,o.j)(o.U3.WS_PORT_OPENED,{type:l?"vnc":"webview",replId:n,port:r,externalPort:s,address:i,webviewAutoOpenOnPortOpened:t});return}(0,o.j)(o.U3.WS_UNFORWARDED_PORT_OPENED,{port:r,isCommon:c.has(r),address:i,type:l?"vnc":"webview",replId:n,externalPort:s})})},[e,n,t])}},93702:function(e,t,n){n.d(t,{Z:function(){return h}});var r=n(47726),i=n(25425),o=n(50782),a=n(2689),l=n(58130),c=n(54916),s=n(50959),u=n(34523),d=n(59808),f=new Set;function h(e){var t=e.workspaceType,n=(0,o.Z)(),h=(0,c.Z)(),p=h.dotReplit,m=h.container,v=(0,i.P5)({controlName:"flag-channel-request-priority",logFlagToAnalytics:!1});(0,s.useEffect)(function(){if(!f.has(n)){f.add(n);var e=p.watch(function(n){if(!n.error||n.error!==d.Yt.Disconnected){try{var i=m.getConnectionMetadata();if(!i||!i.token)throw Error("Expected token in measure call.");!function(e){var t=e.workspaceType,n=e.parsedToken,i=e.flagChannelRequestPriority,o=!!window.performance.getEntriesByName(u.Iy.pageNavStart,"mark").length,l={ssr:!o,workspaceType:t,tokenCluster:n.cluster,flagChannelRequestPriority:i},c="time to code";window.performance.measure(c,o?u.Iy.pageNavStart:void 0);var s=window.performance.getEntriesByName(c,"measure")[0];if(!s){a.kg.info("Could not obtain measure for time to code",l);return}var d="page invisible fetch connection metadata",f=s.duration;window.performance.getEntriesByName(u.Iy.fetchConnectionMetadataPageInvisibleStart,"mark").length&&(window.performance.measure(d,u.Iy.fetchConnectionMetadataPageInvisibleStart,u.Iy.fetchConnectionMetadataPageInvisibleEnd),f-=window.performance.getEntriesByName(d,"measure")[0].duration,window.performance.clearMeasures(d),window.performance.clearMarks(u.Iy.fetchConnectionMetadataPageInvisibleStart),window.performance.clearMarks(u.Iy.fetchConnectionMetadataPageInvisibleEnd)),a.kg.time("time to code minus page invisible",f,l),a.kg.time("time to code with page invisible",s.duration,l),window.performance.clearMeasures(c),r.v.addTiming("time_to_code_minus_page_invisible",f),r.v.addTiming("time_to_code_with_page_invisible",s.duration)}({workspaceType:t,parsedToken:(0,l.he)(i.token),flagChannelRequestPriority:v})}catch(e){a.kg.info("Could not measure time to code",{workspaceType:t,e:e,dotReplitResult:n.error?n.error:"success"})}e()}});return e}},[n,t,p,m,v])}},87584:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(2689),i=n(56684),o=n(19659),a=new Map,l=function(e,t){if((0,o.Mb)(e)){var n=window.performance.now();a.set(e,{start:n,source:t})}},c=function(e){var t=a.get(e);if(void 0!==t){var n=t.start,o=t.source,l=window.performance.now(),c=(0,i.V)(e);r.kg.time("time to load file",l-n,{from:o,fileViewerType:c}),a.delete(e)}};function s(e){return{trackTimeToLoadFileStart:function(t){return l(t,e)},trackTimeToLoadFileEnd:c}}},75722:function(e,t,n){n.d(t,{_:function(){return y},O:function(){return g}});var r=n(27387),i=n(66626),o=n(96583),a=n(50199),l=n(82278),c=n(27308),s=n(5805),u=n(41733),d=n(21262),f=n(71440),h=n(99165);function p(){var e=(0,d._)(["\n  mutation SetUserKeybindings($input: SetUserKeybindingsInput!) {\n    setUserKeybindings(input: $input) {\n      ... on Keybindings {\n        keybindings\n      }\n    }\n  }\n"]);return p=function(){return e},e}var m={},v=(0,f.Ps)(p());function g(){var e,t=(0,l.O)(),n=(0,i._)((e=(0,u._)({},m,void 0),h.D(v,e)),1)[0];return(0,a.Z)(function(){var e;return e=(0,r._)(function(e){var r,a,l,c,u,d,f,h,p;return(0,o.Jh)(this,function(o){switch(o.label){case 0:r=[],a=!0,l=!1,c=void 0;try{for(u=e[Symbol.iterator]();!(a=(d=u.next()).done);a=!0)h=(f=(0,i._)(d.value,2))[0],p=f[1],r.push({commandId:h,keyCombo:p})}catch(e){l=!0,c=e}finally{try{a||null==u.return||u.return()}finally{if(l)throw c}}return[4,n({variables:{input:{environment:t,platform:(0,s.X)(),keybindings:r}}})];case 1:return o.sent(),[2]}})}),function(t){return e.apply(this,arguments)}},[t,n])}function y(e){var t=new Map;if(!Array.isArray(e))return t;var n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value,s=function(e){if(e&&"object"==typeof e&&"commandId"in e&&"string"==typeof e.commandId&&"keyCombo"in e){if(Array.isArray(e.keyCombo)){var t=(0,c.uv)(e.keyCombo);return{commandId:e.commandId,keyCombo:t}}if("string"==typeof e.keyCombo){var n=(0,c.gD)(e.keyCombo);return{commandId:e.commandId,keyCombo:n}}return{commandId:e.commandId,keyCombo:null}}}(l);s&&t.set(s.commandId,s.keyCombo)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return t}},5805:function(e,t,n){n.d(t,{X:function(){return o}});var r=n(21557),i=n(34396);function o(){return r.V5||r.gn?i.K5.Mac:r.ED?i.K5.Windows:i.K5.Linux}},46866:function(e,t,n){n.d(t,{R:function(){return s}});var r=n(27387),i=n(96583),o=n(3720),a=n(21262);function l(){var e=(0,a._)(["\n  query FiletreeDownloadZip($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        url\n      }\n    }\n  }\n"]);return l=function(){return e},e}var c=(0,n(71440).Ps)(l());function s(e){return u.apply(this,arguments)}function u(){return(u=(0,r._)(function(e){var t,n,r;return(0,i.Jh)(this,function(i){switch(i.label){case 0:return[4,null===o.l||void 0===o.l?void 0:o.l.query({query:c,variables:{replId:e}})];case 1:return r=(null==(n=i.sent())?void 0:null===(t=n.data)||void 0===t?void 0:t.repl.__typename)==="Repl"?n.data.repl.url:window.location.pathname,window.open(r+".zip","_blank"),[2]}})})).apply(this,arguments)}},31232:function(e,t,n){n.d(t,{mn:function(){return u}});var r=n(66626),i=n(63257),o=n(19659),a=n(30084),l=["json","md","draw","txt"],c=[".gitignore",".replit"];function s(e,t){var n=new Map,a=!0,l=!1,c=void 0;try{for(var s,u=e[Symbol.iterator]();!(a=(s=u.next()).done);a=!0){var d,f=s.value,h=(0,o.r6)(f);if(h&&(!t||h.startsWith(t))){var p=null!==(d=n.get(h))&&void 0!==d?d:0;n.set(h,p+1)}}}catch(e){l=!0,c=e}finally{try{a||null==u.return||u.return()}finally{if(l)throw c}}return(0,i._)(n.entries()).sort(function(e,t){var n=(0,r._)(e,2)[1];return(0,r._)(t,2)[1]-n}).map(function(e){return(0,r._)(e,1)[0]})}function u(e,t){if(e.fileType===a.Tv.Directory||!e.input)return[];if("."===e.input)return c.map(function(e){return{value:e,highlight:[{from:1,to:e.length}]}});if(e.input.startsWith("."))return c.filter(function(t){return t.startsWith(e.input)}).map(function(t){return{value:t,highlight:[{from:t.length-e.input.length,to:t.length}]}});var n=(0,o.r6)(e.input),r=s(e.siblings.map(function(e){return e.filename}),n);if(r.length<3&&r.push.apply(r,(0,i._)(s(t(),n))),r.length<3){var u=n?l.filter(function(e){return e.startsWith(n)}):l;r.push.apply(r,(0,i._)(u))}return(0,i._)(new Set(r)).slice(0,3).map(function(t){var r=e.input;r.endsWith(".")?r=r.slice(0,-1):n&&(r=r.slice(0,-(n.length+1)));var i=r+"."+t;return{value:i,highlight:[{from:e.input.length,to:i.length}]}})}},23090:function(e,t,n){n.d(t,{B:function(){return o}});var r=n(30084),i=function(e){if(1===e.length)return e[0].type===r.Tv.File?"file":"folder";if(e.length>1){var t=e.filter(function(e){return e.type===r.Tv.File}).length,n=e.filter(function(e){return e.type===r.Tv.Directory}).length,i=t>1?"files":"file",o=n>1?"folders":"folder",a="file";return t>0&&n>0?a="".concat(i," and ").concat(o):t>0?a="".concat(i):n>0&&(a="".concat(o)),"".concat(a)}return""};function o(e){var t=i(e),n=1===e.length?t:"".concat(e.length," ").concat(t),r=e.slice(0,5).map(function(e){return e.path}).join(", ");return{name:n,description:e.length>5?"".concat(r," and ").concat(e.length-5," more ").concat(i(e.slice(5))):r,confirmDescription:n}}},71042:function(e,t,n){n.d(t,{r:function(){return r}});function r(e,t){return new Promise(function(n){var r=e.openChannel({service:"gcsfiles"},function(e){return e.channel.request({persistMirror:{path:t}}).then(function(e){e.ok,r(),n()}),function(e){e.willReconnect&&r()}})})}},19924:function(e,t,n){n.d(t,{e:function(){return _},Z:function(){return C}});var r=n(41733),i=n(66626),o=n(85234),a=n.n(o),l=n(2689),c=n(27387),s=n(98924),u=n(63257),d=n(96583),f=n(43182),h=n(14131),p=n(42371),m=n(52527),v="exit status 1";function g(){return(g=(0,c._)(function(e){var t,n,r,i,o,a,l;return(0,d.Jh)(this,function(c){switch(c.label){case 0:if(n=e.container,0===(r=(0,s._)(e,["container"])).query.trim().length)return[2,y(m.f.EMPTY_QUERY)];if(n.getConnectionState()===h.em.DISCONNECTED)return[2,y(m.f.CONTAINER_DISCONNECTED)];if(n.getConnectionState()===h.em.CONNECTING)return[2,y(m.f.CONTAINER_CONNECTING)];return[4,(t=n).exec.apply(t,(0,u._)((0,p.PR)(r)))];case 1:if(o=(i=c.sent()).output,a=i.error)switch(a){case v:return[2,y(m.f.EMPTY_RESULTS)];case"signal: broken pipe":return[2,y(m.f.PARTIAL_RESULTS)];case"Channel closed":return[2,y(m.f.CHANNEL_CLOSED)];default:return f.Tb(Error("Ripgrep search command failed with error: ".concat(a))),[2,{error:a,data:null}]}if(!(null==o?void 0:o.trim())||!(l=(0,p.Tq)()(o))||0===l.filesMap.size)return[2,y(m.f.EMPTY_RESULTS)];return[2,y(l.error,l.filesMap)]}})})).apply(this,arguments)}function y(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return{error:e,data:t}}var b=n(86763),Z=n.n(b),w=n(1660),x="File Search Used";function C(e){var t=e.container,n=e.onError,i=e.onUpdate,o=e.onLoadingStateChange,c=e.isStreaming,u=e.trackLatency,d=void 0!==u&&u,h=(0,w.Z)({container:t}),g=[],y=a()(),b=Date.now(),C=function(e){i(g=e)};return Z()(function(e){var t=a()();y=t,b=Date.now(),n(null),o(!0);var i=!0;if(""===e.query){C([]),o(!1);return}!function(e){var t=e.execer,n=e.onComplete,r=e.onError,i=e.onParse,o=(0,s._)(e,["execer","onComplete","onError","onParse"]);if(0===o.query.length){n("abort");return}var a=new TextEncoder,l=(0,p.Tq)(),c=0,u=0,d=function(){},h=function(e){r(e),n("error")},g=function(e){if(0===c&&"finished"===e){h(m.f.EMPTY_RESULTS);return}"finished"===e?n(e,{bytes:u}):n(e),d()},y=t.onOutput(function(e){var t=a.encode(e).length;u+=t;var n=l(e);if(n){var r=n.error,o=n.filesMap,s=n.filesMapChanges;r&&h(r),c=o.size,s.forEach(function(e){var t=o.get(e);t&&o.set(e,(0,p.Vd)(t))}),i(o,s)}}),b=t.onStderr(function(e){if(e.trim()===v)return h(m.f.EMPTY_RESULTS);h(m.f.INVALID_COMMAND)});d=function(){y(),b()};var Z=(0,p.PR)(o);t.request({args:Z}).then(function(e){if(e.error)return e.error.trim()===v?h(m.f.EMPTY_RESULTS):h(m.f.INVALID_COMMAND);g("finished")}).catch(function(e){return f.Tb(Error("Ripgrep search command failed with error: ".concat(e))),h(m.f.INVALID_COMMAND)})}((0,r._)({execer:h,onComplete:function(r,i){if(y===t){o(!1);var a,c,s,u,f="finished"===r&&i&&i.bytes===p.Ak;f&&n(m.f.PARTIAL_RESULTS),d&&l.kg.time("".concat(x," - complete"),Date.now()-b,{query:e.query,isRegex:e.isRegex,isCaseSensitive:e.isCaseSensitive,hasIncludes:(null!==(s=null==e?void 0:null===(a=e.includeGlobs)||void 0===a?void 0:a.length)&&void 0!==s?s:0)>0,hasExcludes:(null!==(u=null==e?void 0:null===(c=e.excludeGlobs)||void 0===c?void 0:c.length)&&void 0!==u?u:0)>0,latency:Date.now()-b,isPartialResults:f})}},onError:function(e){y===t&&n(e)},onParse:function(n,r){if(y===t){if(i){if(d){var a,s,u,f;l.kg.time("".concat(x," - first_chunk"),Date.now()-b,{query:e.query,isRegex:e.isRegex,isCaseSensitive:e.isCaseSensitive,hasIncludes:(null!==(u=null==e?void 0:null===(a=e.includeGlobs)||void 0===a?void 0:a.length)&&void 0!==u?u:0)>0,hasExcludes:(null!==(f=null==e?void 0:null===(s=e.excludeGlobs)||void 0===s?void 0:s.length)&&void 0!==f?f:0)>0})}C((0,p.Md)([],n,r)),i=!1}else C((0,p.Md)(g,n,r));c&&o(!1)}},mode:"json",context:0},e))},200)}function _(e){var t=e.container,n=Z()(function(e,n,o){(function(e){return g.apply(this,arguments)})((0,r._)({container:t,mode:"json",context:1,isCaseSensitive:!1},e)).then(function(e){var t=e.data?function(e){var t={},n=!0,r=!1,o=void 0;try{for(var a,l=e.entries()[Symbol.iterator]();!(n=(a=l.next()).done);n=!0){var c=(0,i._)(a.value,2),s=c[0],u=c[1];t[s]=u.lines.map(function(e){return{content:e.content,lineNumber:e.lineNumber,matches:e.matches.map(function(e){return{column:e.start,length:e.length}})}}).filter(function(e){return e.matches.length>0})}}catch(e){r=!0,o=e}finally{try{n||null==l.return||l.return()}finally{if(r)throw o}}return t}(e.data):{},r=e.error===m.f.PARTIAL_RESULTS;if(r);else if(e.error)return n({error:e.error,results:null,isPartialResult:r});return n({error:null,results:t,isPartialResult:r})}).catch(o)},200);return function(e){return new Promise(function(t,r){return n(e,t,r)})}}},12763:function(e,t,n){n.d(t,{Eu:function(){return d},m6:function(){return l}});var r,i,o,a=n(63257);function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=[],r=function(e){return e.forEach(function(e){return e&&n.push("-g",e)})},i=[],o=[],l=!0,u=!1,f=void 0;try{for(var h,p=e[Symbol.iterator]();!(l=(h=p.next()).done);l=!0){var m=h.value,v=s(m);v.startsWith("**")?i.push(v):o.push(v)}}catch(e){u=!0,f=e}finally{try{l||null==p.return||p.return()}finally{if(u)throw f}}return o.length>0&&(r(["!*"]),new Set(o).forEach(function(e){r((function(e){var t=function(e){Array.isArray(r[e])||(r[e]=[]);var t,i=n[e],o=i.startsWith("{")&&i.endsWith("}")?d(i.substring(1,i.length-1),","):[i];(t=r[e]).push.apply(t,(0,a._)(o.map(function(t){var n=r[e-1];return n&&n.length>0?n.map(function(e){return"".concat(e,"/").concat(t)}):t}).flat(2)))},n=d(e,"/").filter(function(e){return e.length>0});"**"!==n[n.length-1]&&n.push("**");for(var r={},i=0;i<n.length;i++)t(i);return Object.values(r).flat(2)})(e).map(c))})),r(i),r(t.map(function(e){return"!".concat(c(s(e)))})),n}function c(e){return e.startsWith("**")||e.startsWith("/")?e:"/".concat(e)}function s(e){return e.replaceAll(/\*/g,function(e,t,n){return t>0&&("*"===n[t-1]||"\\"===n[t-1])||t<n.length-1&&"*"===n[t+1]?e:"**"})}var u=(r={},i={},(o=function(e,t){r[e]=t,i[t]=e})("{","}"),o("(",")"),o("[","]"),{hasKey:function(e){return e in r},getKey:function(e){return r[e]},hasValue:function(e){return e in i},getValue:function(e){return i[e]}});function d(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:",";if(0===e.length)return[];var n=[],r=[],i="",o=!0,a=!1,l=void 0;try{for(var c,s=e[Symbol.iterator]();!(o=(c=s.next()).done);o=!0){var d=c.value;if(d===t){if(0===r.length){n.push(i),i="";continue}}else if(u.hasKey(d))r.push(d);else if(u.hasValue(d)&&r.pop()!==u.getValue(d))return[e];i+=d}}catch(e){a=!0,l=e}finally{try{o||null==s.return||s.return()}finally{if(a)throw l}}return 0!==r.length?[e]:(i.length>0&&n.push(i),n)}},42371:function(e,t,n){n.d(t,{Ak:function(){return d},Tq:function(){return f},PR:function(){return v},Vd:function(){return p},Md:function(){return m}});var r=n(41733),i=n(30509),o=n(63257),a=n(2689);function l(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.map(function(e){return e.match(/["\s]/)&&!e.match(/'/)?"'".concat(e.replace(/(['\\])/g,"\\$1"),"'"):e.match(/["'\s]/)?'"'.concat(e.replace(/(["\\$`!])/g,"\\$1"),'"'):e.replace(/[#!"$&'()*,:;<=>?@[\\\]^`{|}]/g,"\\$&")}).join(" ")}var c=n(12763),s=n(52527),u=n(91620).lW,d=524288;function f(){var e="",t=new Map;return function(n){var o=new Set,l=!1;if(n.trim().startsWith("error"))return{error:s.f.INVALID_COMMAND,filesMap:t,filesMapChanges:o};var c=n.indexOf("\n"),u=0,d=e+n;if(c>=0)c+=e.length;else{e=d;return}for(;c>=0;){var f=d.substring(u,c).trim();if(0!==f.length){var p=function(e){try{return JSON.parse(e)}catch(e){return null}}(f);p&&!function(e,t,n){switch(e.type){case"begin":var o=h(e.data.path);if(!o)return!1;t.set(o,{path:o,lines:[],dedentBy:0}),n.add(o);break;case"end":break;case"match":case"context":var l=h(e.data.path);if(!l)return!1;n.add(l);var c=t.get(l);if(!c)return!1;var s=function(e,t){var n,o,a=h(e.data.lines);if(!a)return null;var l=a.trimEnd().split(/\r?\n/),c=[];(null===(n=l[0])||void 0===n?void 0:n.trim())===""&&l.shift(),(null===(o=l[l.length-1])||void 0===o?void 0:o.trim())===""&&l.pop();var s=0,u=0,d=e.data.submatches;return l.forEach(function(t,n){var r=e.data.line_number+n,i=u;u+=t.length+1;for(var o=[];s<d.length;){var a=d[s];if(a.start>=u)break;var l=a.start-i,f=void 0;if(f=a.end<u?a.end-a.start:a.end===u?a.end-a.start-1:t.length-l,l<t.length&&o.push({start:l,length:f}),a.end>u){a.start=u;break}s++}c.push({lineNumber:r,content:t,matches:o})}),(0,i._)((0,r._)({},t),{lines:t.lines.concat(c)})}(e,c);s&&t.set(l,s);break;case"error":return a.kg.error("Invalid Search Line",{line:JSON.stringify(e)}),!1}return!0}(p,t,o)&&(l=!0)}u=c+1,c=d.indexOf("\n",u)}return e=d.substring(u),{error:l?s.f.INVALID_LINE:null,filesMap:t,filesMapChanges:o}}}function h(e){return e?"bytes"in e?u.from(e.bytes,"base64").toString():e.text:null}function p(e){var t,n=e.lines.length>0?(t=Math).min.apply(t,(0,o._)(e.lines.map(function(e){return e.content.match(/^[\t ]+/)}).flat().map(function(e){return(null==e?void 0:e.length)||0}))):0;return(0,i._)((0,r._)({},e),{dedentBy:n})}function m(e,t,n){for(var r=(0,o._)(e),i=new Set,a=0;a<r.length;a++){var l=r[a].path,c=t.get(l);n.has(l)&&c&&(r[a]=c,i.add(l))}var s=!0,u=!1,d=void 0;try{for(var f,h=n[Symbol.iterator]();!(s=(f=h.next()).done);s=!0){var p=f.value,m=t.get(p);!i.has(p)&&m&&r.push(m)}}catch(e){u=!0,d=e}finally{try{s||null==h.return||h.return()}finally{if(u)throw d}}return r}function v(e){var t=e.mode,n=e.query,r=e.context,i=e.isRegex,a=e.isCaseSensitive,s=e.isMatchingWholeWords,u=e.includeGlobs,f=e.excludeGlobs,h=["rg"];switch(t){case"json":h.push("--json");break;case"files":h.push("--files-with-matches")}return null!==r&&h.push("--context","".concat(r)),n.includes("\n")&&h.push("--multiline"),i||h.push("--fixed-strings"),h.push("--max-count","100"),h.push("--max-filesize","4M"),h.push("--max-depth","24"),h.push("--max-columns","512"),h.push("--max-columns-preview"),h.push(a?"--case-sensitive":"--ignore-case"),s&&h.push("--word-regexp"),h.push.apply(h,(0,o._)((0,c.m6)(u,f))),h.push("--",n),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d;return["sh","-c","".concat(l.apply(void 0,(0,o._)(e))," | head -c ").concat(t)]}(h)}},52527:function(e,t,n){var r,i;n.d(t,{f:function(){return r}}),(i=r||(r={})).PARTIAL_RESULTS="Displaying partial results, try being more specific with your search.",i.EMPTY_RESULTS="Nothing came up searching your Repl's content.",i.EMPTY_QUERY="No search query was provided.",i.INVALID_LINE="We encountered an invalid line while parsing your search results.",i.INVALID_COMMAND="Ripgrep returned an invalid response.",i.CONTAINER_DISCONNECTED="Disconnected from the container.",i.CONTAINER_CONNECTING="Connecting to the container.",i.CHANNEL_CLOSED="Channel was closed."},84707:function(e,t,n){n.d(t,{Z:function(){return i}});var r=n(59868);function i(e){(0,r.j)(r.U3.FILETREE_USED,e)}},66959:function(e,t,n){n.d(t,{YI:function(){return P},kW:function(){return A}});var r,i,o=n(41733),a=n(30509),l=n(74985),c=n(76999),s=n.n(c),u=n(63461);n(50959),(r=i||(i={})).TEXT="TEXT",r.MENTION="MENTION",r.LINK="LINK",r.REPL_LINK="REPL_LINK",r.DEEP_LINK="DEEP_LINK",r.CODE="CODE",r.BOLD="BOLD",r.ITALICS="ITALICS",r.STRIKETHROUGH="STRIKETHROUGH",r.QUOTE="QUOTE";var d=function(e){var t=e.fragment,n=e.onClick;return(0,l.tZ)(u.Z,{size:"small",onClick:n,children:t.content})},f=function(e){var t=e.fragment,n=e.onClick;return(0,l.tZ)(u.Z,{size:"small",fontWeight:"medium",onClick:n,children:t.content})},h=function(e){var t=e.fragment,n=e.onClick;return(0,l.tZ)("a",{href:t.url,onClick:n,rel:"noreferrer noopener nofollow",target:"_blank",children:t.content})},p=function(e){var t=e.fragment,n=e.onClick;return(0,l.tZ)("a",{href:t.url,onClick:n,target:"_blank",children:t.content})},m=function(e){var t=e.fragment,n=e.onClick;return(0,l.tZ)("a",{href:t.url,onClick:n,children:t.content})},v=function(e){var t=e.fragment,n=e.onClick,r=e.style;return(0,l.tZ)("code",{onClick:n,style:r,children:t.content})},g=function(e){var t=e.fragment,n=e.onClick;return(0,l.tZ)("b",{onClick:n,children:t.content})},y=function(e){var t=e.fragment,n=e.onClick;return(0,l.tZ)("i",{onClick:n,children:t.content})},b=function(e){var t=e.fragment,n=e.onClick;return(0,l.BX)("span",{onClick:n,className:"jsx-e2f6e2707e7599fa",children:[t.content,(0,l.tZ)(s(),{id:"e2f6e2707e7599fa",children:"span.jsx-e2f6e2707e7599fa{text-decoration:line-through}"})]})},Z=function(e){var t=e.fragment,n=e.onClick;return(0,l.BX)("blockquote",{onClick:n,className:"jsx-8741a91fadaf26be",children:[t.content,(0,l.tZ)(s(),{id:"8741a91fadaf26be",children:"blockquote.jsx-8741a91fadaf26be{border-left:2px solid var(--foreground-dimmest);padding-left:6px;color:var(--foreground-dimmest)}"})]})},w=/(@[0-9a-zA-Z_]+)/,x=/(#[-a-zA-Z0-9@:%._+~#=/]+)/,C=/(https?:\/\/[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-zA-Z0-9()]{2,6}\b(?:[-a-zA-Z0-9()@:%_+.~#?&//=]*))/,_=/(`.+?`)/,S=/(\*\*.+?\*\*)/,E=/(_.+?_)/,k=/(\*.+?\*)/,T=/(~~.+?~~)/,R=/(^>.+?$\n?)/m,D=/\/@([0-9a-zA-Z_]+)\/(.+)/;function I(e){var t=e.url;return{type:"LINK",url:t,content:t}}function G(e){var t=e.hash;return{type:"DEEP_LINK",url:t,content:t}}var B=RegExp([_.source,S.source,E.source,k.source,T.source,C.source,w.source,x.source,R.source].join("|"),"m");function A(e,t){var n=e.split(B),r=[],i=[],o=!0,a=!1,l=void 0;try{for(var c,s=n[Symbol.iterator]();!(o=(c=s.next()).done);o=!0){var u=c.value;if(u){var d=function(e,t){if(C.test(e)){var n={};try{n=new window.URL(e)}catch(t){return{content:e,type:"TEXT"}}return["repl.it","replit.com","firewalledreplit.com",document.location.host].includes(n.host)?n.pathname===t.replUrl?G({hash:n.hash}):D.test(n.pathname)?function(e){var t=e.url,n=D.exec(t.pathname);if(!n)throw Error("Not a Repl URL");return{type:"REPL_LINK",url:t.href,content:"@".concat(n[1],"/").concat(n[2]).concat(t.hash)}}({url:n}):I({url:e}):I({url:e})}if(x.test(e))return G({hash:e});if(R.test(e))return{type:"QUOTE",content:({text:e.slice(1).trim()}).text};if(_.test(e))return{type:"CODE",content:({code:e.slice(1,-1)}).code};if(S.test(e))return{type:"BOLD",content:({text:e.slice(2,-2)}).text};if(E.test(e)||k.test(e))return{type:"ITALICS",content:({text:e.slice(1,-1)}).text};if(T.test(e))return{type:"STRIKETHROUGH",content:({text:e.slice(2,-2)}).text};if(w.test(e)){var r=e.slice(1);if(!t.users||t.users.includes(r))return{type:"MENTION",username:r,content:"@".concat(r)}}return{content:e,type:"TEXT"}}(u,t);if(d){if("MENTION"===d.type){if(!d.username)continue;r.push(d.username)}i.push(d)}}}}catch(e){a=!0,l=e}finally{try{o||null==s.return||s.return()}finally{if(a)throw l}}return{tokens:i,mentions:r}}function P(e){var t=e.message,n=e.onMentionClick,r=void 0===n?function(){}:n,i=e.codeStyles,c=void 0===i?{}:i;return(0,l.tZ)(l.HY,{children:t.tokens.map(function(e,t){var n={fragment:e,key:t};return"MENTION"===e.type?(0,l.tZ)(f,(0,a._)((0,o._)({},n),{onClick:function(){return r(e)}})):"LINK"===e.type?(0,l.tZ)(h,(0,o._)({},n)):"REPL_LINK"===e.type?(0,l.tZ)(p,(0,o._)({},n)):"DEEP_LINK"===e.type?(0,l.tZ)(m,(0,o._)({},n)):"CODE"===e.type?(0,l.tZ)(v,(0,a._)((0,o._)({},n),{style:c})):"BOLD"===e.type?(0,l.tZ)(g,(0,o._)({},n)):"ITALICS"===e.type?(0,l.tZ)(y,(0,o._)({},n)):"STRIKETHROUGH"===e.type?(0,l.tZ)(b,(0,o._)({},n)):"QUOTE"===e.type?(0,l.tZ)(Z,(0,o._)({},n)):(0,l.tZ)(d,(0,o._)({},n))})})}},21533:function(e,t,n){n.d(t,{D:function(){return c3}});var r,i,o,a,l,c,s,u,d,f,h,p,m,v,g,y=n(41733),b=n(30509),Z=n(66626),w=n(63257),x=n(74985),C=n(90367),_=n(13747),S=n(74044),E=n(99149),k=n(8622),T=n(9135),R=n(14044),D=n(49920),I=n(45086),G=n(25632),B=n(50199),A=n(2038),P=n(57468),N=n(36577),U=n(9331),O=n(80339),L=n(98859),M=n(81),X=n(80711),F=n(33914),W=n(88936),H=n(3844),V=n(47611),z=n.n(V),j=n(76568),q=n(90234),Y=n(50959),$=n(19659),J=n(76999),K=n.n(J),Q=n(10693),ee=n(62340),et=n(64457),en=n(56596),er=n(39179),ei=n(86262),eo=n(29287),ea=n(86763),el=n.n(ea),ec=n(21557),es=n(3574),eu=function(e){var t=e.buttons,n=e.onClick,r=e.onUndo,i=e.onRedo;return(0,x.BX)("nav",{className:"jsx-43582faf24448cbd",children:[t.map(function(e){return(0,x.tZ)("button",{onClick:function(t){t.stopPropagation(),t.preventDefault(),n(e)},className:"jsx-43582faf24448cbd",children:void 0!==e.label?e.label:e.value},e.value)}),(0,x.tZ)("button",{onClick:function(e){e.stopPropagation(),e.preventDefault(),r()},className:"jsx-43582faf24448cbd",children:(0,x.tZ)(er.Z,{})}),(0,x.tZ)("button",{onClick:function(e){e.stopPropagation(),e.preventDefault(),i()},className:"jsx-43582faf24448cbd",children:(0,x.tZ)(ei.Z,{})}),(0,x.tZ)(K(),{id:"43582faf24448cbd",children:'nav.jsx-43582faf24448cbd{font-family:Monaco,Menlo,"Ubuntu Mono",Consolas,source-code-pro,monospace;height:48px;background-color:var(--background-root);display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:stretch;-webkit-align-items:stretch;-moz-box-align:stretch;-ms-flex-align:stretch;align-items:stretch}button.jsx-43582faf24448cbd{color:var(--foreground-default);padding:10px;font-family:inherit;font-size:16px;background-color:transparent;border:0 none;-webkit-box-flex:1;-webkit-flex:1 1 auto;-moz-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto}'})]})},ed=[{value:"{}",cursorOffset:1},{value:"()",cursorOffset:1},{value:'""',cursorOffset:1}],ef=function(e){var t=e.path,n=(0,w._)(ed).concat([{value:"= ",cursorOffset:2}]);return t.endsWith(".html")&&(n.unshift({value:"<>",cursorOffset:1}),n.unshift({label:"div",value:"<div></div>",cursorOffset:5})),n},eh="visualViewport"in window;function ep(e){var t=e.filePath,n=e.isLoading,r=(0,es.uN)(),i=(0,ee.d)({tablet:!1}),o=(0,et.Z)();(0,Y.useEffect)(function(){o&&r&&r.requestMeasure({read:function(){return{cursor:r.coordsAtPos(r.state.selection.main.head),scroller:r.scrollDOM.getBoundingClientRect()}},write:function(e){var t=e.cursor,n=e.scroller;if(t){var i=(t.top+t.bottom)/2,o=(n.top+n.bottom)/2;Math.abs(i-o)>5&&(r.scrollDOM.scrollTop+=i-o+(ec.gn?50:0))}}})},[o,r]);var a=(0,Z._)((0,Y.useState)(0),2),l=a[0],c=a[1];if((0,Y.useEffect)(function(){if(ec.gn){var e=window.visualViewport;if(eh&&e){var t=el()(function(){c(window.innerHeight-e.height-e.offsetTop)},100);return e.addEventListener("scroll",t),e.addEventListener("resize",t),function(){e.removeEventListener("scroll",t),e.removeEventListener("resize",t)}}}},[]),!o||n||!i)return null;var s=(0,x.tZ)(eu,{onUndo:function(){r&&((0,Q.Yw)(r),r.focus())},onRedo:function(){r&&((0,Q.KX)(r),r.focus())},onClick:function(e){if(r){var t,n=null!==(t=r.state.selection.ranges[0].from)&&void 0!==t?t:0;r.dispatch({changes:{from:n,insert:e.value},selection:{anchor:n+e.cursorOffset}}),r.focus()}},buttons:ef({path:t})});return!ec.gn||eh?(0,x.tZ)(en.G,{css:[eo.l0.position.fixed,eo.l0.width("100%"),eo.l0.zIndex(100),eo.l0.bottom(l),eo.l0.left(0)],children:s}):s}var em=n(62789),ev=n(917),eg=n(1518),ey=n(41084),eb=n(24549),eZ=n(84900),ew=[{img:"/public/images/kaboomdraw/rect.png",code:"\ndrawRect({\n	pos: vec2(80, 80),\n	width: 120,\n	height: 80,\n	color: rgb(250, 242, 164),\n})\n    ".trim()},{img:"/public/images/kaboomdraw/triangle.png",code:"\ndrawTriangle({\n	pos: vec2(100, 100),\n	p1: vec2(0, -48),\n	p2: vec2(-60, 48),\n	p3: vec2(60, 48),\n	color: rgb(164, 250, 204),\n})\n  ".trim()},{img:"/public/images/kaboomdraw/circle.png",code:"\ndrawCircle({\n	pos: vec2(100, 100),\n	radius: 48,\n	color: rgb(181, 164, 250),\n})\n    ".trim()},{img:"/public/images/kaboomdraw/ellipse.png",code:"\ndrawEllipse({\n	pos: vec2(120, 100),\n	radiusX: 64,\n	radiusY: 40,\n	color: rgb(164, 209, 250),\n})\n    ".trim()},{img:"/public/images/kaboomdraw/polygon.png",code:"\ndrawPolygon({\n	pos: vec2(100, 100),\n	pts: [\n		vec2(0, -48),\n		vec2(-64, 0),\n		vec2(-32, 64),\n		vec2(32, 64),\n		vec2(64, 0),\n	],\n	color: rgb(250, 164, 226),\n})\n    ".trim()},{img:"/public/images/kaboomdraw/text.png",code:'\ndrawText({\n	text: "hi",\n	pos: vec2(60, 60),\n})\n    '.trim()}],ex=function(e){var t=e.img,n=e.code,r=(0,Z._)((0,eZ.c)({item:{type:eb.z.Code,code:n},type:eb.z.Code}),2)[1];return(0,x.tZ)("img",{alt:"kaboom shape",ref:r,src:t,css:[eo.l0.p(12),{userDrag:"none",height:"100%",cursor:"pointer",transition:"0.1s transform",":hover":{transform:"scale(1.2)"}}]})},eC=function(){return(0,x.tZ)(en.G,{css:[eo.l0.flex.row,eo.l0.justify.spaceEvenly,eo.l0.backgroundColor.backgroundHigher,eo.l0.borderRadius(8),eo.l0.width("calc(100% - 32px)"),eo.l0.height("64px"),eo.l0.position.absolute,eo.l0.overflowY("hidden"),{zIndex:5,left:16,bottom:16,border:"solid 1px var(--outline-dimmest)"}],children:ew.map(function(e){return(0,x.tZ)(ex,(0,y._)({},e),e.img)})})},e_=n(51051),eS=n(27387),eE=n(12285),ek=n(96583),eT=n(80979),eR=n(92631),eD=n(40497),eI=n(59510),eG=n.n(eI),eB=n(25202),eA=n(89798),eP=n(74106),eN=n(7612);function eU(e){var t,n;return null!==(n=null===(t=e.facet(eR.N))||void 0===t?void 0:t.isDocumentSymbolSupported)&&void 0!==n&&n}var eO=e_.Py.define(),eL=e_.QQ.define({create:function(){return null},update:function(e,t){var n=e;return(0,eD.j)(t,eO,function(e){n=e.value}),n}});function eM(){return(eM=(0,eS._)(function(e,t,n){var r,i,o,a,l,c,s,u,d;return(0,ek.Jh)(this,function(f){switch(f.label){case 0:return[4,e.request.documentSymbol(t,{signal:n})];case 1:if(!(r=f.sent())||r.cancelled||!(i="result"in r&&!r.cancelled?r.result:null))return[2,null];o=[],a=!0,l=!1,c=void 0;try{for(s=i[Symbol.iterator]();!(a=(u=s.next()).done);a=!0)(d=u.value)&&"range"in d&&o.push(d)}catch(e){l=!0,c=e}finally{try{a||null==s.return||s.return()}finally{if(l)throw c}}return[2,o.length?o:null]}})})).apply(this,arguments)}function eX(e){if("Debounced function cancelled"!==e.message)throw e}var eF=e_.QQ.define({create:function(){return[]},update:function(e,t){if(!(0,eN.a)(t,eL,"selection"))return e;var n=t.state.field(eL);return n?function e(t,n,r){var i=r.find(function(e){var r=e.range;return(0,eP.RL)(t,r.end)>=n&&(0,eP.RL)(t,r.start)<=n});return null==i?[]:i.children?[i].concat(e(t,n,i.children)):[i]}(t.state.doc,t.state.selection.main.head,n):[]},compare:eG()}),eW=n(12915),eH=n(51828),eV=n(21158),ez=n(52686),ej=n(71104),eq=n(93646),eY=n(84271),e$=n(71064),eJ=n(18514),eK=n(31270),eQ=n(67337),e0=n(39810),e1=n(19012),e2=n(7225),e8=function(e){var t=new Set(e1.Z),n=new Map,r=!0,i=!1,o=void 0;try{for(var a,l=e[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var c=(0,Z._)(a.value,3),s=c[0],u=c[1],d=c[2];if(!t.has(s))throw Error("Symbol not supported by LSP client. Please add to the supported symbol icons array");if("string"==typeof u){var f=eH.s.get(u);if(!f)throw Error("Couldn't find matching icon for ".concat(u));u=f}n.set(s,[u,null!=d?d:eo.TV.foregroundDefault])}}catch(e){i=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}([[e2.SymbolKind.Array,eJ.Z],[e2.SymbolKind.Boolean,H.Z],[e2.SymbolKind.Class,"class",eo.TV.yellowDefault],[e2.SymbolKind.Constant,"constant",eo.TV.blueStronger],[e2.SymbolKind.Constructor,"method",eo.TV.blurpleDefault],[e2.SymbolKind.Enum,ej.Z,eo.TV.orangeDefault],[e2.SymbolKind.EnumMember,e0.Z,eo.TV.blueStronger],[e2.SymbolKind.Event,eV.Z],[e2.SymbolKind.Field,eQ.Z],[e2.SymbolKind.File,eq.Z],[e2.SymbolKind.Function,"function",eo.TV.blurpleStronger],[e2.SymbolKind.Interface,eY.Z,eo.TV.blueStronger],[e2.SymbolKind.Key,e$.Z],[e2.SymbolKind.Method,"method",eo.TV.blurpleDefault],[e2.SymbolKind.Module,eK.Z,eo.TV.purpleDefault],[e2.SymbolKind.Namespace,ez.Z],[e2.SymbolKind.Object,H.Z,eo.TV.blueDimmer],[e2.SymbolKind.Operator,H.Z],[e2.SymbolKind.Package,eK.Z,eo.TV.purpleDefault],[e2.SymbolKind.Property,eQ.Z],[e2.SymbolKind.String,F.Z],[e2.SymbolKind.Struct,ez.Z],[e2.SymbolKind.TypeParameter,e0.Z],[e2.SymbolKind.Variable,e0.Z,eo.TV.blueStronger]]);function e4(e){var t,n=e.kind,r=(0,Z._)(null!==(t=e8.get(n))&&void 0!==t?t:[H.Z,eo.TV.foregroundDefault],2),i=r[0],o=r[1];return(0,x.tZ)(i,{color:o,size:16})}var e3=n(59868),e5=n(20399),e6=n(43312),e9=n(93496),e7=n(26890),te=n(66302),tt=n(13729),tn=(0,e6.iv)([e9.gU.nofill,{transitionProperty:"background-color, box-shadow, opacity",opacity:.8,":focus":{zIndex:1,opacity:1}}]),tr={button:(0,e6.iv)([eo.l0.reset.button,eo.l0.p(2),eo.l0.rowWithGap(4),eo.l0.align.center,tn]),text:(0,e6.iv)({fontSize:eo.TV.fontSizeSmall})},ti={opacity:1};function to(e){var t=e.icon,n=e.text,r=e.innerRef,i=e.ariaProps,o=e.active,a=(0,e7.U)(i,r).buttonProps,l=(0,te.XI)({}),c=l.hoverProps,s=l.isHovered;return(0,x.BX)(en.G,(0,b._)((0,y._)({tag:"button",css:tr.button,style:s||o?ti:void 0,innerRef:r},(0,tt.dG)(a,c)),{children:[t?(0,Y.cloneElement)(t,{size:16}):null,(0,x.tZ)(en.G,{css:tr.text,children:n})]}))}var ta={root:(0,e6.iv)([eo.l0.p(4),eo.l0.rowWithGap(4),eo.l0.align.center]),text:(0,e6.iv)([eo.l0.truncate,eo.l0.flex.growAndShrink(1),{fontSize:eo.TV.fontSizeDefault}])};function tl(e){return(0,x.BX)(en.G,{css:[ta.root],children:[e.icon?(0,Y.cloneElement)(e.icon,{size:16}):null,(0,x.tZ)(en.G,{css:ta.text,children:e.text})]})}var tc=n(88298),ts=n(62347),tu=(0,e6.iv)([eo.l0.p(4)]);function td(e){var t=e.items,n=e.children,r=e.menuProps,i=e.selectedKeys,o=e.onAction,a=(0,tc.D)({items:t,children:n,selectedKeys:i,selectionMode:"single"}),l=(0,Y.useRef)(null),c=(0,ts.H9)((0,y._)({items:t,onAction:o},r),a,l);return(0,x.tZ)(en.G,(0,b._)((0,y._)({},c.menuProps),{innerRef:l,css:tu,children:(0,w._)(a.collection).map(function(e){return(0,x.tZ)(tp,{item:e,state:a},e.key)})}))}var tf={root:(0,e6.iv)([eo.l0.flex.row,eo.l0.align.center,eo.l0.position.relative,tn]),selected:(0,e6.iv)([{opacity:1,backgroundColor:e9.vb.interactiveBackground}])},th={opacity:1};function tp(e){var t=e.item,n=e.state,r=(0,Y.useRef)(null),i=(0,ts.iX)({key:t.key},n,r),o=i.menuItemProps,a=i.isSelected,l=(0,te.XI)({}),c=l.hoverProps,s=l.isHovered;return(0,x.tZ)(en.G,(0,b._)((0,y._)({innerRef:r,css:[tf.root,a&&tf.selected],style:s||a?th:void 0},(0,tt.dG)(o,c)),{children:t.rendered}))}var tm=n(10910),tv=n(38080),tg=n(49786),ty={underlay:(0,e6.iv)([eo.l0.coverContainer,eo.l0.position.fixed]),surface:(0,e6.iv)([eo.l0.borderRadius(8),{boxShadow:eo.TV.shadow2,border:"1px solid",borderColor:eo.TV.backgroundHighest}])};function tb(e){var t=e.state,n=e.triggerRef,r=e.placement,i=e.children,o=(0,Z._)((0,tm.Z)(),2),a=o[0],l=o[1],c=(0,tg.Sv)({placement:r,triggerRef:n,popoverRef:a,offset:8},t),s=c.popoverProps,u=c.underlayProps;return(0,x.BX)(tg.aV,{children:[(0,x.tZ)(en.G,(0,b._)((0,y._)({},u),{css:ty.underlay})),(0,x.BX)(tv.Tg,(0,b._)((0,y._)({elevated:!0,css:ty.surface,innerRef:l},s),{children:[(0,x.tZ)(tg.U4,{onDismiss:t.close}),i,(0,x.tZ)(tg.U4,{onDismiss:t.close})]}))]})}function tZ(e){return CSS.escape(e.name)}function tw(e){var t=e.selectedSymbol,n=e.symbols,r=e.moveCursor,i=e.icon,o=e.text,a=(0,eW.W)({onOpenChange:function(e){e&&(0,e3.j)(e3.U3.CODE_NAVIGATION_USED,{action:"opened"})}}),l=(0,Y.useRef)(null),c=(0,ts.u4)({},a,l),s=c.menuTriggerProps,u=c.menuProps,d=t?new Set([t.name]):void 0;return(0,x.BX)(x.HY,{children:[(0,x.tZ)(to,{text:o,icon:i,innerRef:l,ariaProps:s,active:a.isOpen}),a.isOpen?(0,x.tZ)(tb,{triggerRef:l,state:a,placement:"bottom left",children:(0,x.tZ)(td,{menuProps:u,items:n,selectedKeys:d,onAction:function(e){var t=n.find(function(t){return tZ(t)===e});t&&(r(t.selectionRange.start),(0,e3.j)(e3.U3.CODE_NAVIGATION_USED,{action:"jumped"}))},children:function(e){return(0,x.tZ)(e5.ck,{children:(0,x.tZ)(tl,{icon:(0,x.tZ)(e4,{kind:e.kind}),text:e.name})},tZ(e))}})}):null]})}var tx=Y.memo(function(e){var t=e.symbols,n=e.symbolsPath,r=e.moveCursor,i=n.length?n[n.length-1]:null,o=i?i.children:t;return(0,x.BX)(x.HY,{children:[n.map(function(e,i){var o=0===i?t:n[i-1].children;return o?(0,x.BX)(Y.Fragment,{children:[(0,x.tZ)(U.Z,{size:12}),(0,x.tZ)(tw,{symbols:o,icon:(0,x.tZ)(e4,{kind:e.kind}),text:e.name,selectedSymbol:e,moveCursor:r})]},tZ(e)):null}),(null==o?void 0:o.length)?(0,x.BX)(x.HY,{children:[(0,x.tZ)(U.Z,{size:12}),(0,x.tZ)(tw,{symbols:o,text:"...",moveCursor:r})]}):null]})}),tC=(0,Y.memo)(function(e){var t,n=e.view,r=(0,Y.useCallback)(function(e){null==n||n.dispatch({scrollIntoView:!0,selection:e_.jT.cursor((0,eP.RL)(n.state.doc,e))}),null==n||n.focus()},[n]),i=(0,Y.useDeferredValue)({symbols:(0,I.IK)(n,eL),symbolsPath:(0,I.IK)(n,eF)});return(null===(t=i.symbols)||void 0===t?void 0:t.length)?(0,x.tZ)(tx,{symbols:i.symbols,symbolsPath:i.symbolsPath||[],moveCursor:r}):null}),t_=n(12506),tS=n(66995);function tE(e){var t=e.path,n=e.performPaneOperation,r=(0,es.uN)(),i=(0,Y.useCallback)(function(e){n({operation:"open",pane:(0,t_.$E)(e)})},[n]);return(0,x.tZ)(t_.h4,{children:(0,x.tZ)(t_.Qc,{children:(0,x.tZ)(tS.tr,{path:t,onFileClick:i,children:(0,x.tZ)(tC,{view:r})})})})}var tk=n(75023),tT=n(16643),tR=n(66349),tD=n(54916),tI=n(91039),tG=n(57111),tB=new tk.j(function(e,t,n,r){return(0,tG.Rr)(e,t?(0,tI.ZF)("/home/runner/".concat(t.slug,"/").concat(n)):null,r)}),tA=n(16783),tP=n.n(tA),tN="".concat('url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"><circle cx="10" cy="10" r="10" fill="black" /></svg>\')',", linear-gradient(transparent, transparent)"),tU="".concat('url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"><path stroke="black" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" fill="none" d="M2.5 10H15.5M15.5 10L9.5 5M15.5 10L9.5 15M18 4V16"/></svg>\')',", linear-gradient(transparent, transparent)"),tO=eT.tk.theme({".cm-vws-space":{backgroundColor:eo.TV.foregroundDimmest,maskImage:tN,maskSize:"0.375ch",maskPosition:"center",maskRepeat:"no-repeat","-webkit-mask-image":tN,"-webkit-mask-size":"0.375ch","-webkit-mask-position":"center","-webkit-mask-repeat":"no-repeat","&.cm-vws-leading":{opacity:.325},"&.cm-vws-enclosed":{opacity:.5},"&.cm-vws-trailing":{opacity:.5},"&.cm-vws-selected":{opacity:.75}},".cm-vws-tab":{backgroundColor:eo.TV.foregroundDimmest,maskImage:tU,maskSize:"1.75ch 1.75ch",maskPosition:"center",maskRepeat:"no-repeat","-webkit-mask-image":tU,"-webkit-mask-size":"1.75ch 1.75ch","-webkit-mask-position":"center","-webkit-mask-repeat":"no-repeat","&.cm-vws-leading":{opacity:.325,maskPosition:"left min(95%, 0.25ch) top 50%","-webkit-mask-position":"left min(95%, 0.25ch) top 50%"},"&.cm-vws-enclosed, &.cm-vws-trailing":{opacity:.5,maskPosition:"calc(50% - 0.25ch) 50%","-webkit-mask-position":"calc(50% - 0.25ch) 50%"},"&.cm-vws-selected":{opacity:.75}}}),tL=tP()(function(e,t,n){var r="cm-vws-".concat(" "===e?"space":"tab"," cm-vws-").concat(t).concat(n?" cm-vws-selected":"");return eT.p.mark({class:r})},function(e,t,n){return"".concat(e,"-").concat(t,"-").concat(n)});function tM(e,t,n){var r=e.facet(tW);if(!r.leading&&!r.enclosed&&!r.trailing&&!r.selected)return[];for(var i=[],o=e.doc.lineAt(t),a=e.doc.lineAt(n),l=o.number;l<=a.number;l++)!function(o){var a=e.doc.line(o),l=a.text.length;if(0!==l){var c=0===a.text.trim().length,s=!!r.selected&&e.selection.ranges.some(function(e){return!e.empty&&e.from<a.to&&e.to>=a.from});if(r.leading||r.enclosed||r.trailing||s){if(c){if(r.leading||r.trailing||s)for(var u=0;u<l;u++)!function(o){var l=a.text[o],c=a.from+o;if(!(c<t)&&!(c>=n)&&(" "===l||"	"===l)){var u=s&&e.selection.ranges.some(function(e){return e.from<=c&&e.to>c});(r.leading||r.trailing||u)&&i.push(tL(l,"trailing",u).range(c,c+1))}}(u);return}for(var d=l-a.text.trimStart().length,f=a.text.trim().length,h=0;h<l;h++)!function(o){var l=a.text[o],c=a.from+o;if(!(c<t)&&!(c>=n)&&(" "===l||"	"===l)){var u=void 0;u=o>=d+f?"trailing":o>d?"enclosed":"leading";var h=s&&e.selection.ranges.some(function(e){return e.from<=c&&e.to>c});(r[u]||h)&&i.push(tL(l,u,h).range(c,c+1))}}(h)}}}(l);return i}var tX=function(){"use strict";function e(t){(0,eE._)(this,e),this.decorations=eT.p.set(tM(t.state,0,t.state.doc.length))}return e.prototype.update=function(e){if((0,eN.a)(e,tW)){this.decorations=eT.p.set(tM(e.state,0,e.state.doc.length));return}var t=e.state.facet(tW);if(e.docChanged||e.selectionSet&&t.selected){var n=this.decorations,r=null,i=null;if(e.selectionSet&&t.selected){var o=e.startState.selection.ranges.filter(function(e){return!e.empty}),a=(0,w._)(e.state.selection.ranges).concat((0,w._)(e.startState.selection.map(e.changes).ranges)).filter(function(e){return!e.empty});o.length&&(r=e_.jT.create(o)),a.length&&(i=e_.jT.create(a))}if(e.docChanged&&e.changes.iterChangedRanges(function(t,n,o,a){var l=e_.jT.range(e.startState.doc.lineAt(t).from,e.startState.doc.lineAt(n).to);r=r?r.addRange(l):e_.jT.create([l]);var c=e_.jT.range(e.state.doc.lineAt(o).from,e.state.doc.lineAt(a).to);i=i?i.addRange(c):e_.jT.create([c])}),r){var l=r.ranges;n=n.update({filter:function(e,t){return!l.some(function(n){return n.from<=e&&n.to>=t})},filterFrom:l[0].from,filterTo:l[l.length-1].to})}e.docChanged&&(n=n.map(e.changes)),i&&(n=n.update({add:i.ranges.map(function(t){return tM(e.state,t.from,t.to)}).flat()})),this.decorations=n}},e}(),tF=eT.lg.fromClass(tX,{decorations:function(e){return e.decorations}}),tW=e_.r$.define({combine:function(e){var t;return null!==(t=e[0])&&void 0!==t?t:{}},enables:[tO,e_.Wl.highest(tF)]}),tH=new tk.j(function(e,t,n,r){return e||t||n||r?tW.of({leading:e,enclosed:t,trailing:n,selected:r}):null}),tV=n(39426),tz=n(55534),tj=n(23394),tq=n(72067),tY=n(41500),t$=new tk.j(function(e,t,n,r,i){if(!t||!n)return[];var o,a=T.Lf.of({deprecated:!0,format:(o=(0,eS._)(function(n){var r;return(0,ek.Jh)(this,function(i){return 0===n.length?[2,{result:n.toString()}]:(r=tY.Z.from(n.toString()).toBuffer(),[2,t.request({file:{path:e,content:r}}).then(function(e){return e.error||!e.file?{error:!0}:{result:tY.Z.from(e.file.content).toString()}})])})}),function(e){return o.apply(this,arguments)}),supportsRangeFormatting:!1,identifier:"formatter_service",onError:function(){r("Sorry, formatting ".concat(e," failed"),1500)},onSuccess:function(){i("Formatted ".concat(e," successfully"),1500)}});return e_.Wl.lowest(a)}),tJ=n(42256),tK=n(9069),tQ=n(23896),t0=n(21084),t1=n(69926),t2=n(56729),t8=n(15482),t4=n(1660),t3=new tk.j(function(e,t,n,r,i,o,a,l,c,s){return e?e.formatters.map(function(e){var u,d,f;return 2===(d=e.id.split("/")).length&&d[1].includes("languageServer")&&(null==n?void 0:n.isSupportedFile(l))?n&&n.isSupportedFile(l)&&r&&r.isFormatSupported&&a?tK.Lf.of({format:(f=(0,eS._)(function(e,t){return(0,ek.Jh)(this,function(r){return[2,(t?n.request.formatRange(l,(0,eP.Ih)(e,t),{insertSpaces:i,tabSize:o}):n.request.format(l,{insertSpaces:i,tabSize:o})).then(function(t){return"error"in t||t.cancelled?{error:!0}:t.result?{result:(0,t0.Z)(t.result,e.toString())}:{result:e_.as.empty(e.length)}})]})}),function(e,t){return f.apply(this,arguments)}),supportsRangeFormatting:r.isFormatRangeSupported,identifier:n.clientId,name:n.clientName,onError:function(){s("Sorry, formatting ".concat(l," failed"),1500)},onSuccess:function(){c("Formatted ".concat(l," successfully"),1500)}}):[]:(0,t8.F)(l,e)?tK.Lf.of({format:(u=(0,eS._)(function(n,r){var i,o,a,c,s;return(0,ek.Jh)(this,function(u){switch(u.label){case 0:if(!e.startCommand)throw Error("Expected formatter command");return i=(0,t4.Z)({container:t}),o=e.startCommand.args.map(function(e){return"$file"===e?l:e}),r&&e.id.includes("prettier")&&o.push("--range-start",String(r.main.from),"--range-end",String(r.main.to)),a="",c="",s=[i.onOutput(function(e){return a+=e}),i.onStderr(function(e){return c+=e}),i.dispose],[4,i.request((0,b._)((0,y._)({},e.startCommand),{args:o,lifecycle:tJ.api.Exec.Lifecycle.STDIN,stdin:n.toString()})).then(function(e){var t=e.error;return s.forEach(function(e){return e()}),t?{error:!0,message:c}:{result:a}})];case 1:return[2,u.sent()]}})}),function(e,t){return u.apply(this,arguments)}),supportsRangeFormatting:e.id.includes("prettier"),identifier:e.id,name:e.name,onSuccess:c,onError:s}):null}).filter(Boolean):null}),t5=n(578),t6=n(97050),t9=n(4955),t7=n(9670),ne=function(e){"use strict";(0,t9._)(n,e);var t=(0,t7._)(n);function n(e){var r;return(0,eE._)(this,n),(r=t.call(this)).type=e,r}return n.from=function(e){switch(e){case"yours":return this.yours;case"base":return this.base;case"middle":return this.middle;case"theirs":return this.theirs}},n.range=function(e,t,n){return this.from(e).range(t,n)},n}(e_.uU);function nt(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:7,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length,i=[],o=n;o<=r;){var a=e.lineAt(o),l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:7;if(e.text.length<t)return null;var n=e.text[0],r=function(e){switch(e){case"<":return"yours";case"|":return"base";case"=":return"middle";case">":return"theirs";default:return null}}(n);if(!r)return null;var i=n.repeat(t);return e.text.slice(0,t)!==i||e.text.length>t&&" "!==e.text[t]?null:r}(a,t);l&&i.push(ne.range(l,a.from,a.to)),o=a.to+1}return i}ne.yours=new ne("yours"),ne.base=new ne("base"),ne.middle=new ne("middle"),ne.theirs=new ne("theirs");var nn=["yours","base","middle","theirs"];function nr(e){Array.isArray(e)&&(e=e_.Xs.of(e));var t=[],n=[];if(0===e.size)return{hunks:t,hanging:n};for(var r=e.iter();null!==r.value;){var i,o,a,l={},c={},s=[],u=!0,d=!1,f=void 0;try{for(var h,p=nn[Symbol.iterator]();!(u=(h=p.next()).done);u=!0){var m=h.value,v=r.value,g=r.from,y=r.to;if("base"!==m||v.type===m){if(v.type===m)l[m]={from:g,to:y},s.push({from:g,to:y,type:v.type});else if("yours"!==v.type)s.push({from:g,to:y,type:v.type});else break;if(r.next(),null===r.value)break}}}catch(e){d=!0,f=e}finally{try{u||null==p.return||p.return()}finally{if(d)throw f}}if(!l.yours||!l.middle||!l.theirs){n.push.apply(n,(0,w._)(s));continue}null!==(i=l.base)&&void 0!==i||(l.base=null),null!==(o=c.base)&&void 0!==o||(c.base=null);var b=null!==(a=l.base)&&void 0!==a?a:l.middle,Z=l.yours.to+1,x=b.from-1;if(c.yours=Z<x?{from:Z,to:x}:null,l.base){var C=l.base.to+1,_=l.middle.from-1;c.base=C<_?{from:C,to:_}:null}var S=l.middle.to+1,E=l.theirs.from-1;c.theirs=S<E?{from:S,to:E}:null;var k={from:l.yours.from,to:l.theirs.to,markers:l,content:c};t.push(k)}return{hunks:t,hanging:n}}var ni=e_.r$.define({combine:function(e){return e.length?e[0]:7}}),no=e_.QQ.define({create:function(e){var t=e.doc,n=e.facet(ni),r=e_.Xs.of(nt(t,n)),i=nr(r);return{markers:r,hunks:i.hunks,hanging:i.hanging}},update:function(e,t){var n=t.newDoc,r=t.startState.facet(ni),i=t.state.facet(ni);if(r!==i){var o=e_.Xs.of(nt(n,i)),a=nr(o);return{markers:o,hunks:a.hunks,hanging:a.hanging}}if(!t.docChanged)return e;var l=null,c=null,s=null,u=null;t.changes.iterChangedRanges(function(e,t,n,r){l=null===l?e:Math.min(l,e),c=null===c?t:Math.max(c,t),s=null===s?n:Math.min(s,n),u=null===u?r:Math.max(u,r)});var d=e.markers;if(null!==l&&null!==c){var f=t.startState.doc.lineAt(l).from,h=t.startState.doc.lineAt(c).to;d=d.update({filter:function(){return!1},filterFrom:f,filterTo:h})}d=d.map(t.changes),null!==s&&null!==u&&(d=d.update({add:nt(n,i,s,u)}));var p=nr(d);return{markers:d,hunks:p.hunks,hanging:p.hanging}}}),na=eT.tk.atomicRanges.from(no,function(e){return function(){return e.markers}}),nl=e_.yy.changeFilter.of(function(e){var t=e.startState.field(no);if(!e.docChanged||0===t.markers.size)return!0;var n=e.startState.doc,r=[];return e.changes.iterChanges(function(e,i,o,a,l){var c=l.length,s=Math.max(n.lineAt(e).from-1,0),u=Math.min(n.lineAt(i).to+1,n.length);t.markers.between(s,u,function(t,s){e<=t&&i>=s||0!==c&&(e===s&&"\n"===l.sliceString(0,1)||i===t&&"\n"===l.sliceString(c-1,c))||o===a&&(i===s+1&&0===n.lineAt(i).length||e===t-1&&0===n.lineAt(e).length)||r.push(t-1,s+1)})}),!(r.length>0)||r}),nc=e_.yy.transactionFilter.of(function(e){var t=e.docChanged?e.state.field(no):e.startState.field(no);if(0===t.markers.size)return e;var n=e.newSelection,r=!1,i=!1;do{i=!1;for(var o=0;o<n.ranges.length&&"break"!==function(e){var o=n.ranges[e],a=o.from,l=o.to,c=a,s=l;if(t.markers.between(a,l,function(e,t){var n=(e+t)/2;a>e&&a<t&&(c=a<n?e:t),l>e&&l<t&&(s=l<n?e:t)}),c!==a||s!==l){var u,d=o.anchor<o.head?c:s,f=o.anchor<o.head?s:c,h=o.goalColumn,p=null!==(u=o.bidiLevel)&&void 0!==u?u:void 0,m=e_.jT.range(d,f,h,p);return n=n.replaceRange(m,e),i=!0,r=!0,"break"}}(o);o++);}while(i);return r?[e,{selection:n,sequential:!0}]:e}),ns=n(42516),nu="cm-git-conflict-marker-yours",nd="cm-git-conflict-marker-base",nf="cm-git-conflict-marker-middle",nh="cm-git-conflict-marker-theirs",np="cm-git-conflict-marker-hanging",nm="cm-git-conflict-content-yours",nv="cm-git-conflict-content-base",ng="cm-git-conflict-content-theirs";function ny(e){var t=e.background,n=e.color,r=e.noBorder,i={color:n,backgroundColor:t,backgroundClip:"padding-box",paddingTop:eo.TV.space4,paddingBottom:eo.TV.space4,fontWeight:eo.TV.fontWeightBold};return void 0!==r&&r||(i.borderLeft="4px solid rgba(0, 150, 255, 0.1)",i.paddingLeft="2px"),i}function nb(e){return{backgroundColor:e.background,backgroundClip:"padding-box",borderLeft:"4px solid rgba(0, 150, 255, 0.1)",paddingLeft:"2px"}}var nZ=eT.tk.theme((d={},(0,ns._)(d,".".concat(nu),ny({background:"rgba(0, 150, 255, 0.1)",color:eo.TV.blueStrongest,noBorder:!0})),(0,ns._)(d,".".concat(nf),ny({background:"rgba(255, 0, 0, 0.1)",color:eo.TV.redStrongest})),(0,ns._)(d,".".concat(nd),ny({background:"rgba(255, 165, 0, 0.1)",color:eo.TV.orangeStrongest})),(0,ns._)(d,".".concat(nh),ny({background:"rgba(0, 150, 255, 0.1)",color:eo.TV.blueStrongest,noBorder:!0})),(0,ns._)(d,".".concat(np),ny({background:"rgba(100, 150, 255, 0.1)",color:eo.TV.blueStrongest,noBorder:!0})),(0,ns._)(d,".".concat(nm),nb({background:"rgba(0, 255, 0, 0.1)"})),(0,ns._)(d,".".concat(ng),nb({background:"rgba(255, 0, 0, 0.1)"})),(0,ns._)(d,".".concat(nv),nb({background:"rgba(255, 165, 0, 0.1)"})),d)),nw={yours:{marker:eT.p.line({class:nu}),content:eT.p.line({class:nm})},base:{marker:eT.p.line({class:nd}),content:eT.p.line({class:nv})},middle:{marker:eT.p.line({class:nf})},theirs:{marker:eT.p.line({class:nh}),content:eT.p.line({class:ng})},hanging:{marker:eT.p.line({class:np})}},nx=function(){"use strict";function e(t){(0,eE._)(this,e),this.builder=new e_.f_,this.doc=t}var t=e.prototype;return t.add=function(e,t){var n=this.doc.lineAt(e.from);if(n.to>=e.to){this.builder.add(n.from,n.from,t);return}for(var r=n.from;r<=e.to;)this.builder.add(r,r,t),r=this.doc.lineAt(r).to+1},t.finish=function(){return this.builder.finish()},e}(),nC=eT.tk.decorations.from(no,function(e){return function(t){var n=new nx(t.state.doc),r=!0,i=!1,o=void 0;try{for(var a,l=e.hunks[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var c=a.value;t.viewport.from>c.to||t.viewport.to<c.from||(n.add(c.markers.yours,nw.yours.marker),c.content.yours&&n.add(c.content.yours,nw.yours.content),c.markers.base&&n.add(c.markers.base,nw.base.marker),c.content.base&&n.add(c.content.base,nw.base.content),n.add(c.markers.middle,nw.middle.marker),c.content.theirs&&n.add(c.content.theirs,nw.theirs.content),n.add(c.markers.theirs,nw.theirs.marker))}}catch(e){i=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n.finish()}}),n_=eT.tk.decorations.from(no,function(e){return function(){var t=new e_.f_,n=!0,r=!1,i=void 0;try{for(var o,a=e.hanging[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value;t.add(l.from,l.from,nw.hanging.marker)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return t.finish()}}),nS=[no,[na,nl,nc],[e_.Wl.lowest(nZ),nC,n_]],nE=n(31157),nk=function(){"use strict";function e(t,n,r,i,o,a){(0,eE._)(this,e),this.original=t,this.current=n,this.chunks=r,this.desc=i,this.pending=o,this.ranges=a}var t=e.prototype;return t.hasChanges=function(){return this.ranges.length>0},t.update=function(t,n){var r,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=this.original,a=this.chunks,l=this.desc,c=this.pending,s=this.ranges;if(Math.abs((this.pending?this.pending.length:this.current.length)-t.length)>=250||i){var u=(0,nE.Gj)(l,c,n).pending;a=(0,nE.U_)(o,t,{chunks:a,changesB:u}),l=(0,nE.fu)(a,o.length),c=null,s=(0,nE.Hu)(l)}else c=(r=(0,nE.Gj)(l,c,n)).pending,l=r.desc,s=(0,nE.Hu)(l);return c&&t.eq(o)&&(a=[],l=e_.as.empty(o.length),c=null,s=[]),new e(o,t,a,l,c,s)},t.isAccurate=function(){return null===this.pending},t.getLineChangeType=function(e){var t=this.current.line(e);return 0===this.original.length&&this.current.length>0?nE.dQ.COVERED:(0,nE.dx)(t,nE.MF.B,this.ranges)},t.iterRanges=function(){return(0,ek.Jh)(this,function(e){switch(e.label){case 0:return[5,(0,ek.XA)(this.ranges)];case 1:return e.sent(),[2]}})},e.create=function(t,n){var r=(0,nE.U_)(t,n),i=(0,nE.fu)(r,t.length),o=(0,nE.Hu)(i);return new e(t,n,r,i,null,o)},e}(),nT=e_.r$.define({combine:function(e){var t;return null!==(t=e.filter(Boolean)[0])&&void 0!==t?t:null}}),nR=e_.QQ.define({create:function(){return null},update:function(e,t){var n=t.state.facet(nT);return!n||Math.max(n.lines,t.newDoc.lines)>5e3?null:(e&&e.original.eq(n)?t.docChanged&&(e=e.update(t.newDoc,t.changes,!(t.isUserEvent("input.type")||t.isUserEvent("delete.forward")||t.isUserEvent("delete.backward")))):e=nk.create(n,t.newDoc),e)}}),nD=n(92708),nI=(0,eT.v5)({class:nD.Tr,renderEmptyElements:!0,lineMarker:function(e,t){var n=e.state.field(nR,!1);if(!n||!n.hasChanges())return null;if(0===n.original.length)return nD.Vt;var r=e.state.doc.lineAt(t.from);switch(n.getLineChangeType(r.number)){case nE.dQ.COVERED:return nD.vP;case nE.dQ.MODIFIED:return nD.wp;default:return null}},initialSpacer:function(e){return e.state.field(nR,!1)?nD.Vt:nD.Do},updateSpacer:function(e,t){var n=t.state.field(nR,!1)?nD.Vt:nD.Do;return e===n?e:n}}),nG=e_.r$.define({enables:function(e){return[nT.computeN([e],function(t){return t.facet(e)}),nD.Lw,nR,e_.Wl.highest(nI)]}}),nB=n(10814);(o=f||(f={})).GUTTER_DIFF="GUTTER_DIFF",o.INLINE_DIFF="INLINE_DIFF";var nA=e_.Py.define(),nP=e_.Py.define(),nN=e_.QQ.define({create:function(){return{head:null,mode:"GUTTER_DIFF"}},update:function(e,t){var n=e.head,r=e.mode,i=!0,o=!1,a=void 0;try{for(var l,c=t.effects[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var s=l.value;s.is(nA)?n=s.value:s.is(nP)&&(r=s.value)}}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}return n!==e.head||r!==e.mode?{head:n,mode:r}:e},provide:function(e){return[nG.from(e,function(e){return"GUTTER_DIFF"===e.mode?e.head:null}),nB.p.from(e,function(e){return"INLINE_DIFF"===e.mode?e.head:null})]}}),nU=function(){"use strict";function e(t,n,r){var i=this;(0,eE._)(this,e),this.view=t,this.git=n,this.path=r,this.disposed=!1,this.dispose=n.onRefresh(function(){return i.fetchThenUpdateState()}),this.fetchThenUpdateState()}var t=e.prototype;return t.fetchThenUpdateState=function(){var e=this;return(0,eS._)(function(){var t,n,r,i,o;return(0,ek.Jh)(this,function(a){switch(a.label){case 0:return[4,e.git.getFileContents({path:e.path,revision:"HEAD"})];case 1:if(t=a.sent(),e.disposed||!(n=e.view.state.field(nN,!1)))return[2];return(!(o=null===(i=t.error?null:null!==(r=t.content)&&void 0!==r?r:"")?null:e.view.state.toText(i))!=!n.head||o&&n.head&&!o.eq(n.head))&&e.view.dispatch({effects:nA.of(o)}),[2]}})})()},t.destroy=function(){this.dispose(),this.disposed=!0},e}(),nO=n(25425),nL=new tk.j(function(e,t,n,r){var i=[];return n||i.push(t?[nN,eT.lg.define(function(n){return new nU(n,e,t)})]:[]),(r||i.push(nS),0===i.length)?null:i}),nM=n(12569),nX=function(e){"use strict";(0,t9._)(n,e);var t=(0,t7._)(n);function n(e,r){var i;return(0,eE._)(this,n),(i=t.call(this)).src=e,i.pos=r,i}var r=n.prototype;return r.eq=function(e){return this.src===e.src&&this.pos===e.pos},r.toDOM=function(){var e=document.createElement("img");return e.src=this.src,e.dataset.pos=this.pos.toString(),e.style.maxHeight="64px",e.style.maxWidth="256px",e},r.ignoreEvent=function(){return!1},n}(eT.l9),nF=/"data:image\/\w+;base64,[^"\s]+"/g,nW=Number.MAX_VALUE,nH=new tk.j(function(e){return e?eT.lg.define(function(e){var t=new eT.Y1({regexp:nF,decoration:function(e,t,n){if(void 0===e[0])throw Error("Failed to match image");var r=e[0].substring(1,e[0].length-1);return eT.p.replace({widget:new nX(r,n)})},maxLength:nW});return{matcher:t,deco:t.createDeco(e),update:function(e){e.docChanged&&(this.deco=t.updateDeco(e,this.deco))}}},{decorations:function(e){return e.deco},provide:function(e){return eT.tk.atomicRanges.of(function(t){var n=t.plugin(e);return n?n.deco:eT.p.none})}}):null}),nV=n(8131),nz=n(29457),nj=n(69521),nq=n(56557),nY=n(69543),n$=n(11669),nJ=n(54472),nK=n(89835),nQ=n(74833),n0=n(93918),n1=n(73030),n2=n(96132),n8="cm-ghostwriter-hint-tooltip",n4=eT.tk.theme((0,ns._)({".cm-ghostwriter-hint":{display:"none",width:"100%",backgroundColor:eo.TV.backgroundHigher,borderTop:"solid 1px ".concat(eo.TV.outlineDefault)}},".cm-tooltip-autocomplete.".concat(n8," .cm-ghostwriter-hint"),{display:"block"})),n3=(0,n0.X)({hint:[eo.l0.p(4),eo.l0.rowWithGap(8),eo.l0.align.center,eo.l0.font.default,{opacity:.6}],prompt:[eo.l0.rowWithGap(4),eo.l0.align.center]});function n5(){return(0,x.BX)(en.G,{css:n3.hint,children:[(0,x.tZ)(n1.Z,{width:8,height:8}),(0,x.BX)(en.G,{css:n3.prompt,children:[(0,x.tZ)(n2.ZP,{size:"small",dimmed:!1,shortcut:{key:"tab"}}),(0,x.tZ)(nQ.xv,{variant:"small",multiline:!1,children:"to use AI suggestion."})]})]})}var n6=eT.lg.define(function(e){var t=function(){var t,n,r;return(0,w._)(e.dom.children).concat((0,w._)(null!==(r=null===(n=nK.yb.get(e))||void 0===n?void 0:null===(t=n.children[0])||void 0===t?void 0:t.children)&&void 0!==r?r:[])).filter(function(e){return e.classList.contains("cm-tooltip-autocomplete")})},n=function(e){return Array.from(e.children).filter(function(e){return e.classList.contains("cm-ghostwriter-hint")})},r=!1;return{update:function(){null!==(0,nq.LR)(e.state)&&Promise.resolve().then(function(){if(!r){var e=!0,i=!1,o=void 0;try{for(var a,l=t()[Symbol.iterator]();!(e=(a=l.next()).done);e=!0){var c=a.value,s=n(c);if(0===s.length){var u=(0,nJ.VV)((0,x.tZ)(n5,{}));u.className="cm-ghostwriter-hint",c.appendChild(u)}}}catch(e){i=!0,o=e}finally{try{e||null==l.return||l.return()}finally{if(i)throw o}}}})},destroy:function(){var e=!0,i=!1,o=void 0;try{for(var a,l=t()[Symbol.iterator]();!(e=(a=l.next()).done);e=!0){var c=a.value,s=!0,u=!1,d=void 0;try{for(var f,h=n(c)[Symbol.iterator]();!(s=(f=h.next()).done);s=!0){var p=f.value;c.removeChild(p)}}catch(e){u=!0,d=e}finally{try{s||null==h.return||h.return()}finally{if(u)throw d}}}}catch(e){i=!0,o=e}finally{try{e||null==l.return||l.return()}finally{if(i)throw o}}r=!0}}}),n9=e_.Py.define(),n7=e_.QQ.define({create:function(){return null},update:function(e,t){null!==(0,nq.LR)(t.state)?e&&(e=(0,b._)((0,y._)({},e),{missed:e.missed.compose(t.changes)})):e=null;var n=!0,r=!1,i=void 0;try{for(var o,a=t.effects[Symbol.iterator]();!(n=(o=a.next()).done);n=!0)o.value.is(n9)&&(e={original:t.state.doc,missed:e_.as.empty(t.state.doc.length)})}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return e}});function re(e,t){var n=e.field(n7,!1);if(n){var r=(0,eP.RL)(n.original,t);return n.missed.mapPos(r)}return(0,eP.RL)(e.doc,t)}var rt=n(34791),rn=n(2689),rr=n(45400),ri=n(44478),ro=n(74207),ra=n(68333),rl=n(53326),rc=(0,n0.X)({styles0:[{p:{whiteSpace:"pre-wrap"}}]}),rs={p:{padding:"".concat(eo.TV.space2," ").concat(eo.TV.space8),lineHeight:1.4,marginBottom:"".concat(eo.TV.space8," !important")},"p:first-of-type":{marginTop:"".concat(eo.TV.space4," !important")},"p:last-of-type":{marginBottom:"".concat(eo.TV.space4," !important")},pre:{margin:"".concat(eo.TV.space2," ").concat(eo.TV.space8)},"pre + p":{borderTop:"1px solid ".concat(eo.TV.outlineDimmest),paddingTop:eo.TV.space4},"h1, h2, h3":{margin:"".concat(eo.TV.space8," !important"),marginTop:"".concat(eo.TV.space12," !important"),padding:"0 !important",paddingBottom:"".concat(eo.TV.space4," !important"),fontSize:"100% !important",borderBottom:"1px solid ".concat(eo.TV.backgroundHighest," !important"),lineHeight:1},"h1:first-of-type, h2:first-of-type, h3:first-of-type":{marginTop:"".concat(eo.TV.space4," !important")},hr:{margin:"".concat(eo.TV.space8," !important"),borderTop:"2px solid ".concat(eo.TV.backgroundHighest," !important")},li:{margin:"".concat(eo.TV.space2," ").concat(eo.TV.space8)},".lsp-completion-detail":{borderBottom:"1px solid ".concat(eo.TV.backgroundHighest),marginBottom:eo.TV.space4},".cm-line":{paddingLeft:eo.TV.space4,paddingRight:eo.TV.space4},".cm-content":{paddingLeft:eo.TV.space4,paddingRight:eo.TV.space4}},ru=(0,Y.memo)(function(e){var t=e.content,n=e.className;return(0,x.tZ)(en.G,{css:rs,children:(0,x.tZ)(ra.ZP,{className:n,components:{code:function(e){return(0,x.tZ)(rl.Z,(0,y._)({minimal:!0,disableCopy:!0},e))}},children:t})})});function rd(e){var t=e.content,n=e.className;return"string"==typeof t?(0,x.tZ)(ru,{css:rc.styles0,className:n,content:t}):t.kind===e2.MarkupKind.PlainText?(0,x.tZ)(en.G,{children:(0,x.tZ)(nQ.xv,{className:n,children:t.value})}):(0,x.tZ)(ru,{className:n,content:t.value})}var rf=n(98924),rh=n(4384),rp=n(83176),rm=n(25490);(a=h||(h={}))[a.Dollar=0]="Dollar",a[a.Colon=1]="Colon",a[a.Comma=2]="Comma",a[a.CurlyOpen=3]="CurlyOpen",a[a.CurlyClose=4]="CurlyClose",a[a.Backslash=5]="Backslash",a[a.Forwardslash=6]="Forwardslash",a[a.Pipe=7]="Pipe",a[a.Int=8]="Int",a[a.VariableName=9]="VariableName",a[a.Format=10]="Format",a[a.Plus=11]="Plus",a[a.Dash=12]="Dash",a[a.QuestionMark=13]="QuestionMark",a[a.EOF=14]="EOF";var rv=function(){"use strict";function e(){(0,eE._)(this,e),this.value="",this.pos=0}var t=e.prototype;return t.text=function(e){this.value=e,this.pos=0},t.tokenText=function(e){return this.value.substr(e.pos,e.len)},t.next=function(){if(this.pos>=this.value.length)return{type:14,pos:this.pos,len:0};var t,n=this.pos,r=0,i=this.value.charCodeAt(n);if("number"==typeof(t=e._table[i]))return this.pos+=1,{type:t,pos:n,len:1};if(e.isDigitCharacter(i)){t=8;do r+=1,i=this.value.charCodeAt(n+r);while(e.isDigitCharacter(i));return this.pos+=r,{type:t,pos:n,len:r}}if(e.isVariableCharacter(i)){t=9;do i=this.value.charCodeAt(n+ ++r);while(e.isVariableCharacter(i)||e.isDigitCharacter(i));return this.pos+=r,{type:t,pos:n,len:r}}t=10;do r+=1,i=this.value.charCodeAt(n+r);while(!isNaN(i)&&void 0===e._table[i]&&!e.isDigitCharacter(i)&&!e.isVariableCharacter(i));return this.pos+=r,{type:t,pos:n,len:r}},e.isDigitCharacter=function(e){return e>=48&&e<=57},e.isVariableCharacter=function(e){return 95===e||e>=97&&e<=122||e>=65&&e<=90},e}();rv._table=(p={},(0,ns._)(p,36,0),(0,ns._)(p,58,1),(0,ns._)(p,44,2),(0,ns._)(p,123,3),(0,ns._)(p,125,4),(0,ns._)(p,92,5),(0,ns._)(p,47,6),(0,ns._)(p,124,7),(0,ns._)(p,43,11),(0,ns._)(p,45,12),(0,ns._)(p,63,13),p);var rg=function(){"use strict";function e(){(0,eE._)(this,e),this._children=[],function(e,t){t.forEach(function(t){Object.defineProperty(e,t,{enumerable:!1,writable:!0})})}(this,["parent"])}var t=e.prototype;return t.appendChild=function(e){return e instanceof ry&&this._children[this._children.length-1]instanceof ry?this._children[this._children.length-1].value+=e.value:(e.parent=this,this._children.push(e)),this},t.replace=function(e,t){var n=e.parent,r=n.children.indexOf(e),i=n.children.slice(0);i.splice.apply(i,[r,1].concat((0,w._)(t))),n._children=i,function e(t,n){var r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var c=a.value;c.parent=n,e(c.children,c)}}catch(e){i=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}}(t,n)},t.toString=function(){return this.children.reduce(function(e,t){return e+t.toString()},"")},t.len=function(){return 0},t.match=function(e){var t=!0,n=!1,r=void 0;try{for(var i,o=Object.entries(rT)[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=(0,Z._)(i.value,2),l=a[0],c=a[1];if(this instanceof c&&l in e)return e[l](this)}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}},(0,rh._)(e,[{key:"children",get:function(){return this._children}},{key:"rightMostDescendant",get:function(){return this._children.length>0?this._children[this._children.length-1].rightMostDescendant:this}},{key:"snippet",get:function(){for(var e=this;;){if(!e)return;if(e instanceof rE)return e;e=e.parent}}}]),e}(),ry=function(e){"use strict";(0,t9._)(n,e);var t=(0,t7._)(n);function n(e){var r;return(0,eE._)(this,n),(r=t.call(this)).value=e,r}var r=n.prototype;return r.toString=function(){return this.value},r.toTextmateString=function(){return n.escape(this.value)},r.len=function(){return this.value.length},r.clone=function(){return new n(this.value)},n.escape=function(e){return e.replace(/\$|}|\\/g,"\\$&")},n}(rg),rb=function(e){"use strict";(0,t9._)(n,e);var t=(0,t7._)(n);function n(){return(0,eE._)(this,n),t.apply(this,arguments)}return n}(rg),rZ=function(e){"use strict";(0,t9._)(n,e);var t=(0,t7._)(n);function n(e){var r;return(0,eE._)(this,n),(r=t.call(this)).index=e,r}var r=n.prototype;return r.toTextmateString=function(){var e="";return(this.transform&&(e=this.transform.toTextmateString()),0!==this.children.length||this.transform)?0===this.children.length?"${".concat(this.index).concat(e,"}"):this.choice?"${".concat(this.index,"|").concat(this.choice.toTextmateString(),"|").concat(e,"}"):"${".concat(this.index,":").concat(this.children.map(function(e){return e.toTextmateString()}).join("")).concat(e,"}"):"$".concat(this.index)},r.clone=function(){var e=new n(this.index);return this.transform&&(e.transform=this.transform.clone()),e._children=this.children.map(function(e){return e.clone()}),e},n.compareByIndex=function(e,t){return e.index===t.index?0:e.isFinalTabstop?1:t.isFinalTabstop||e.index<t.index?-1:e.index>t.index?1:0},(0,rh._)(n,[{key:"isFinalTabstop",get:function(){return 0===this.index}},{key:"choice",get:function(){return 1===this._children.length&&this._children[0]instanceof rw?this._children[0]:void 0}}]),n}(rb),rw=function(e){"use strict";(0,t9._)(n,e);var t=(0,t7._)(n);function n(){var e;return(0,eE._)(this,n),e=t.apply(this,arguments),e.options=[],e}var r=n.prototype;return r.appendChild=function(e){return e instanceof ry&&(e.parent=this,this.options.push(e)),this},r.toString=function(){return this.options[0].value},r.toTextmateString=function(){return this.options.map(function(e){return e.value.replace(/\||,|\\/g,"\\$&")}).join(",")},r.len=function(){return this.options[0].len()},r.clone=function(){var e=new n;return this.options.forEach(e.appendChild,e),e},n}(rg),rx=function(e){"use strict";(0,t9._)(n,e);var t=(0,t7._)(n);function n(){var e;return(0,eE._)(this,n),e=t.apply(this,arguments),e.regexp=RegExp(""),e}var r=n.prototype;return r.resolve=function(e){var t=this,n=!1,r=e.replace(this.regexp,function(){for(var e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];return n=!0,t._replace(r.slice(0,-2))});return!n&&this._children.some(function(e){return e instanceof rC&&!!e.elseValue})&&(r=this._replace([])),r},r._replace=function(e){var t="",n=!0,r=!1,i=void 0;try{for(var o,a=this._children[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value;if(l instanceof rC){var c=e[l.index]||"";c=l.resolve(c),t+=c}else t+=l.toString()}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return t},r.toString=function(){return""},r.toTextmateString=function(){return"/".concat(this.regexp.source,"/").concat(this.children.map(function(e){return e.toTextmateString()}),"/").concat((this.regexp.ignoreCase?"i":"")+(this.regexp.global?"g":""))},r.clone=function(){var e=new n;return e.regexp=new RegExp(this.regexp.source,(this.regexp.ignoreCase?"i":"")+(this.regexp.global?"g":"")),e._children=this.children.map(function(e){return e.clone()}),e},n}(rg),rC=function(e){"use strict";(0,t9._)(n,e);var t=(0,t7._)(n);function n(e,r,i,o){var a;return(0,eE._)(this,n),(a=t.call(this)).index=e,a.shorthandName=r,a.ifValue=i,a.elseValue=o,a}var r=n.prototype;return r.resolve=function(e){if("upcase"===this.shorthandName)return e?e.toLocaleUpperCase():"";if("downcase"===this.shorthandName)return e?e.toLocaleLowerCase():"";if("capitalize"===this.shorthandName)return e?e[0].toLocaleUpperCase()+e.substr(1):"";if("pascalcase"===this.shorthandName)return e?this._toPascalCase(e):"";if("camelcase"===this.shorthandName)return e?this._toCamelCase(e):"";if(e&&"string"==typeof this.ifValue)return this.ifValue;if(!e&&"string"==typeof this.elseValue)return this.elseValue;else return e||""},r._toPascalCase=function(e){var t=e.match(/[a-z0-9]+/gi);return t?t.map(function(e){return e.charAt(0).toUpperCase()+e.substr(1)}).join(""):e},r._toCamelCase=function(e){var t=e.match(/[a-z0-9]+/gi);return t?t.map(function(e,t){return 0===t?e.charAt(0).toLowerCase()+e.substr(1):e.charAt(0).toUpperCase()+e.substr(1)}).join(""):e},r.toTextmateString=function(){var e="${";return e+=this.index,this.shorthandName?e+=":/".concat(this.shorthandName):this.ifValue&&this.elseValue?e+=":?".concat(this.ifValue,":").concat(this.elseValue):this.ifValue?e+=":+".concat(this.ifValue):this.elseValue&&(e+=":-".concat(this.elseValue)),e+="}"},r.clone=function(){return new n(this.index,this.shorthandName,this.ifValue,this.elseValue)},n}(rg),r_=function(e){"use strict";(0,t9._)(n,e);var t=(0,t7._)(n);function n(e){var r;return(0,eE._)(this,n),(r=t.call(this)).name=e,r}var r=n.prototype;return r.resolve=function(e){var t=e.resolve(this);return this.transform&&(t=this.transform.resolve(t||"")),void 0!==t&&(this._children=[new ry(t)],!0)},r.toTextmateString=function(){var e="";return(this.transform&&(e=this.transform.toTextmateString()),0===this.children.length)?"${".concat(this.name).concat(e,"}"):"${".concat(this.name,":").concat(this.children.map(function(e){return e.toTextmateString()}).join("")).concat(e,"}")},r.clone=function(){var e=new n(this.name);return this.transform&&(e.transform=this.transform.clone()),e._children=this.children.map(function(e){return e.clone()}),e},n}(rb);function rS(e,t){for(var n=(0,w._)(e);n.length>0;){var r=n.shift();if(!t(r))break;n.unshift.apply(n,(0,w._)(r.children))}}var rE=function(e){"use strict";(0,t9._)(n,e);var t=(0,t7._)(n);function n(){return(0,eE._)(this,n),t.apply(this,arguments)}var r=n.prototype;return r.offset=function(e){var t=0,n=!1;return(this.walk(function(r){return r===e?(n=!0,!1):(t+=r.len(),!0)}),n)?t:-1},r.fullLen=function(e){var t=0;return rS([e],function(e){return t+=e.len(),!0}),t},r.enclosingPlaceholders=function(e){for(var t=[],n=e.parent;n;)n instanceof rZ&&t.push(n),n=n.parent;return t},r.resolveVariables=function(e){var t=this;return this.walk(function(n){return n instanceof r_&&n.resolve(e)&&delete t._placeholders,!0}),this},r.appendChild=function(e){return delete this._placeholders,(0,rp._)((0,rm._)(n.prototype),"appendChild",this).call(this,e)},r.replace=function(e,t){return delete this._placeholders,(0,rp._)((0,rm._)(n.prototype),"replace",this).call(this,e,t)},r.toTextmateString=function(){return this.children.reduce(function(e,t){return e+t.toTextmateString()},"")},r.clone=function(){var e=new n;return this._children=this.children.map(function(e){return e.clone()}),e},r.walk=function(e){rS(this.children,e)},(0,rh._)(n,[{key:"placeholderInfo",get:function(){if(!this._placeholders){var e,t=[];this.walk(function(n){return n instanceof rZ&&(t.push(n),e=!e||e.index<n.index?n:e),!0}),this._placeholders={all:t,last:e}}return this._placeholders}},{key:"placeholders",get:function(){return this.placeholderInfo.all}}]),n}(rg),rk=function(){"use strict";function e(){(0,eE._)(this,e),this._scanner=new rv,this._token={type:14,pos:0,len:0}}var t=e.prototype;return t.text=function(e){return this.parse(e).toString()},t.parse=function(e,t,n){var r=new rE;return this.parseFragment(e,r),this.ensureFinalTabstop(r,null!=n&&n,null!=t&&t),r},t.parseFragment=function(e,t){var n=t.children.length;for(this._scanner.text(e),this._token=this._scanner.next();this._parse(t););var r=new Map,i=[];t.walk(function(e){return e instanceof rZ&&(e.isFinalTabstop?r.set(0,void 0):!r.has(e.index)&&e.children.length>0?r.set(e.index,e.children):i.push(e)),!0});var o=function(e,n){var i=r.get(e.index);if(i){var a=new rZ(e.index);a.transform=e.transform;var l=!0,c=!1,s=void 0;try{for(var u,d=i[Symbol.iterator]();!(l=(u=d.next()).done);l=!0){var f=u.value.clone();a.appendChild(f),f instanceof rZ&&r.has(f.index)&&!n.has(f.index)&&(n.add(f.index),o(f,n),n.delete(f.index))}}catch(e){c=!0,s=e}finally{try{l||null==d.return||d.return()}finally{if(c)throw s}}t.replace(e,[a])}},a=new Set,l=!0,c=!1,s=void 0;try{for(var u,d=i[Symbol.iterator]();!(l=(u=d.next()).done);l=!0){var f=u.value;o(f,a)}}catch(e){c=!0,s=e}finally{try{l||null==d.return||d.return()}finally{if(c)throw s}}return t.children.slice(n)},t.ensureFinalTabstop=function(e,t,n){(t||n&&e.placeholders.length>0)&&!e.placeholders.find(function(e){return 0===e.index})&&e.appendChild(new rZ(0))},t._accept=function(e,t){if(void 0===e||this._token.type===e){var n=!t||this._scanner.tokenText(this._token);return this._token=this._scanner.next(),n}return!1},t._backTo=function(e){return this._scanner.pos=e.pos+e.len,this._token=e,!1},t._until=function(e){for(var t=this._token;this._token.type!==e;){if(14===this._token.type)return!1;if(5===this._token.type){var n=this._scanner.next();if(0!==n.type&&4!==n.type&&5!==n.type)return!1}this._token=this._scanner.next()}var r=this._scanner.value.substring(t.pos,this._token.pos).replace(/\\(\$|}|\\)/g,"$1");return this._token=this._scanner.next(),r},t._parse=function(e){return this._parseEscaped(e)||this._parseTabstopOrVariableName(e)||this._parseComplexPlaceholder(e)||this._parseComplexVariable(e)||this._parseAnything(e)},t._parseEscaped=function(e){var t;return!!(t=this._accept(5,!0))&&(t=this._accept(0,!0)||this._accept(4,!0)||this._accept(5,!0)||t,e.appendChild(new ry(t)),!0)},t._parseTabstopOrVariableName=function(e){var t,n=this._token;return this._accept(0)&&(t=this._accept(9,!0)||this._accept(8,!0))?(e.appendChild(/^\d+$/.test(t)?new rZ(Number(t)):new r_(t)),!0):this._backTo(n)},t._parseComplexPlaceholder=function(e){var t,n=this._token;if(!(this._accept(0)&&this._accept(3)&&(t=this._accept(8,!0))))return this._backTo(n);var r=new rZ(Number(t));if(this._accept(1))for(;;){if(this._accept(4))return e.appendChild(r),!0;if(!this._parse(r))return e.appendChild(new ry("${"+t+":")),r.children.forEach(e.appendChild,e),!0}else if(r.index>0&&this._accept(7))for(var i=new rw;;){if(this._parseChoiceElement(i)){if(this._accept(2))continue;if(this._accept(7)&&(r.appendChild(i),this._accept(4)))return e.appendChild(r),!0}return this._backTo(n),!1}else if(this._accept(6))return this._parseTransform(r)?(e.appendChild(r),!0):(this._backTo(n),!1);else if(this._accept(4))return e.appendChild(r),!0;else return this._backTo(n)},t._parseChoiceElement=function(e){for(var t=this._token,n=[];2!==this._token.type&&7!==this._token.type;){var r=void 0;if(!(r=(r=this._accept(5,!0))?this._accept(2,!0)||this._accept(7,!0)||this._accept(5,!0)||r:this._accept(void 0,!0)))return this._backTo(t),!1;n.push(r)}return 0===n.length?(this._backTo(t),!1):(e.appendChild(new ry(n.join(""))),!0)},t._parseComplexVariable=function(e){var t,n=this._token;if(!(this._accept(0)&&this._accept(3)&&(t=this._accept(9,!0))))return this._backTo(n);var r=new r_(t);if(this._accept(1))for(;;){if(this._accept(4))return e.appendChild(r),!0;if(!this._parse(r))return e.appendChild(new ry("${"+t+":")),r.children.forEach(e.appendChild,e),!0}else if(this._accept(6))return this._parseTransform(r)?(e.appendChild(r),!0):(this._backTo(n),!1);else if(this._accept(4))return e.appendChild(r),!0;else return this._backTo(n)},t._parseTransform=function(e){for(var t=new rx,n="",r="";!this._accept(6);){var i=void 0;if(i=this._accept(5,!0)){n+=i=this._accept(6,!0)||i;continue}if(14!==this._token.type){n+=this._accept(void 0,!0);continue}return!1}for(;!this._accept(6);){var o=void 0;if(o=this._accept(5,!0)){o=this._accept(5,!0)||this._accept(6,!0)||o,t.appendChild(new ry(o));continue}if(!(this._parseFormatString(t)||this._parseAnything(t)))return!1}for(;!this._accept(4);){if(14!==this._token.type){r+=this._accept(void 0,!0);continue}return!1}try{t.regexp=new RegExp(n,r)}catch(e){return!1}return e.transform=t,!0},t._parseFormatString=function(e){var t=this._token;if(!this._accept(0))return!1;var n=!1;this._accept(3)&&(n=!0);var r=this._accept(8,!0);if(!r)return this._backTo(t),!1;if(!n||this._accept(4))return e.appendChild(new rC(Number(r))),!0;if(!this._accept(1))return this._backTo(t),!1;if(this._accept(6)){var i=this._accept(9,!0);return i&&this._accept(4)?(e.appendChild(new rC(Number(r),i)),!0):(this._backTo(t),!1)}if(this._accept(11)){var o=this._until(4);if(o)return e.appendChild(new rC(Number(r),void 0,o,void 0)),!0}else if(this._accept(12)){var a=this._until(4);if(a)return e.appendChild(new rC(Number(r),void 0,void 0,a)),!0}else if(this._accept(13)){var l=this._until(1);if(l){var c=this._until(4);if(c)return e.appendChild(new rC(Number(r),void 0,l,c)),!0}}else{var s=this._until(4);if(s)return e.appendChild(new rC(Number(r),void 0,void 0,s)),!0}return this._backTo(t),!1},t._parseAnything=function(e){return 14!==this._token.type&&(e.appendChild(new ry(this._scanner.tokenText(this._token))),this._accept(void 0),!0)},e.escape=function(e){return e.replace(/\$|}|\\/g,"\\$&")},e.asInsertText=function(t){return new e().parse(t).toString()},e.guessNeedsClipboard=function(e){return/\${?CLIPBOARD/.test(e)},e}(),rT={Text:ry,Placeholder:rZ,Variable:r_,FormatString:rC,Choice:rw},rR=function(){"use strict";function e(t){(0,eE._)(this,e),this.lines=t.split(/\r\n?|\n/).map(function(e){return new rk().parse(e).children})}return e.prototype.apply=function(t){var n=t.view,r=t.from,i=t.to,o=e.instantiate(this.lines,t),a=o.text,l=o.ranges,c={from:r,to:i,insert:e_.xv.of(a)},s={changes:c,scrollIntoView:!0,annotations:nq.Jv.of(t.completion)};if(l.length&&(s.selection=rN(l,0)),l.length>1){var u=new rG(l,0),d=s.effects=[rB.of(u)];void 0===n.state.field(rP,!1)&&d.push(e_.Py.appendConfig.of([rP,rO,rL]))}if(r===i&&!l.length){var f=e_.as.of(c,n.state.doc.length),h=n.state.selection.ranges.map(function(e){return e.map(f,0)});s.selection=e_.jT.create(h,n.state.selection.mainIndex)}return s},e.resolveVariable=function(e,t){var n=t.view,r=t.from,i=t.path;switch(e){case"TM_FILENAME":return(0,rr.basename)(i);case"TM_FILENAME_BASE":return(0,rr.basename)(i,(0,rr.extname)(i));case"TM_DIRECTORY":return(0,rr.dirname)(i);case"TM_FILEPATH":return i;case"TM_LINE_INDEX":return(n.state.doc.lineAt(r).number-1).toString();case"TM_LINE_NUMBER":return n.state.doc.lineAt(r).number.toString();default:return e}},e.instantiate=function(t,n){var r=n.view,i=n.from,o=r.state,a=[],l=[],c=o.doc.lineAt(i),s=/^\s*/.exec(c.text)[0],u=o.facet(C.c),d=!0,f=!1,h=void 0;try{for(var p,m,v=t[Symbol.iterator]();!(d=(m=v.next()).done);d=!0)!function(){var t=m.value,r=0,o="",c=function(e){var t=0,n=r;if(0===r&&(t=/^\t*/.exec(e)[0].length)){var i=s+u.repeat(t);e=i+e.slice(t),n+=i.length}return o+=e,r+=e.length,{line:a.length,from:n,to:r}},d=function(t){var o=!0,s=!1,u=void 0;try{for(var f,h=t[Symbol.iterator]();!(o=(f=h.next()).done);o=!0)f.value.match({Text:function(e){c(e.value)},Variable:function(t){var r=t.name,i=t.transform,o=e.resolveVariable(r,n);i&&(o=o.replace(i.regexp,function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.children.map(function(e){return e.match({Text:function(e){return e.value},FormatString:function(e){return e.resolve(t[e.index])}})}).filter(Boolean).join("")})),c(o)},Choice:function(e){c(e.options[0].value)},Placeholder:function(e){var t,n=a.length?i+a.map(function(e){return e.length}).reduce(function(e,t){return e+t}):i;if(null===(t=e.children)||void 0===t?void 0:t.length){var o={field:e.index,from:n+r,to:null};l.push(o),d(e.children),o.to=n+r}else{c("");var s=n+r;l.push({field:e.index,from:s,to:s})}}})}catch(e){s=!0,u=e}finally{try{o||null==h.return||h.return()}finally{if(s)throw u}}};d(t),a.push(o)}()}catch(e){f=!0,h=e}finally{try{d||null==v.return||v.return()}finally{if(f)throw h}}var g=(p=Math).max.apply(p,(0,w._)(l.map(function(e){return e.field})));return{text:a,ranges:l.map(function(e){var t=e.field,n=(0,rf._)(e,["field"]);return(0,b._)((0,y._)({},n),{field:0===t?g:t-1})})}},e}(),rD=eT.p.widget({widget:new(function(e){"use strict";(0,t9._)(n,e);var t=(0,t7._)(n);function n(){return(0,eE._)(this,n),t.apply(this,arguments)}var r=n.prototype;return r.toDOM=function(){var e=document.createElement("span");return e.className="cm-snippetFieldPosition",e},r.ignoreEvent=function(){return!1},n}(eT.l9))}),rI=eT.p.mark({class:"cm-snippetField"}),rG=function(){"use strict";function e(t,n){(0,eE._)(this,e),this.ranges=t,this.active=n,this.deco=eT.p.set(t.map(function(e){return(e.from===e.to?rD:rI).range(e.from,e.to)}))}var t=e.prototype;return t.map=function(t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=this.ranges[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var c=a.value,s=function(e,t){var n=t.mapPos(e.from,-1,e_.gc.TrackDel),r=t.mapPos(e.to,1,e_.gc.TrackDel);return null==n||null==r?null:{field:e.field,from:n,to:r}}(c,t);if(!s)return null;n.push(s)}}catch(e){i=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return new e(n,this.active)},t.isSelectionInsideField=function(e){var t=this;return e.ranges.every(function(e){return t.ranges.some(function(n){return n.field===t.active&&n.from<=e.from&&n.to>=e.to})})},e}(),rB=e_.Py.define({map:function(e,t){return null==e?void 0:e.map(t)}}),rA=e_.Py.define(),rP=e_.QQ.define({create:function(){return null},update:function(e,t){var n=!0,r=!1,i=void 0;try{for(var o,a=t.effects[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value;if(l.is(rB))return l.value;if(l.is(rA)&&e)return new rG(e.ranges,l.value)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return e&&t.docChanged&&(e=e.map(t.changes)),e&&t.selection&&!e.isSelectionInsideField(t.selection)&&(e=null),e},provide:function(e){return eT.tk.decorations.from(e,function(e){return e?e.deco:eT.p.none})}});function rN(e,t){var n=e.filter(function(e){return e.field===t}).map(function(e){return e_.jT.range(e.from,e.to)});if(0!==n.length)return e_.jT.create(n)}function rU(e){return function(t){var n,r=t.state,i=t.dispatch,o=r.field(rP,!1);if(!o||e<0&&0===o.active)return!1;var a=o.active+e,l=(n=Math).max.apply(n,(0,w._)(o.ranges.map(function(e){return e.field}))),c=e>0&&o.active>=l;return i(r.update({selection:rN(o.ranges,a),effects:rB.of(c?null:new rG(o.ranges,a))})),!0}}var rO=e_.Wl.highest(eT.$f.of([{key:"Tab",run:rU(1),shift:rU(-1)},{key:"Escape",run:function(e){var t=e.state,n=e.dispatch;return!!t.field(rP,!1)&&(n(t.update({effects:rB.of(null)})),!0)}}])),rL=eT.tk.domEventHandlers({mousedown:function(e,t){var n,r=t.state.field(rP,!1);if(!r||null==(n=t.posAtCoords({x:e.clientX,y:e.clientY})))return!1;var i=r.ranges.find(function(e){return e.from<=n&&e.to>=n});return!!i&&i.field!==r.active&&(t.dispatch({selection:rN(r.ranges,i.field),effects:rB.of(r.ranges.some(function(e){return e.field>i.field})?new rG(r.ranges,i.field):null)}),!0)}});function rM(e){var t=Object.keys(e).join(""),n=/\w/.test(t);return n&&(t=t.replace(/\w/g,"")),"[".concat(n?"\\w":"").concat(t.replace(".","").replace(/[^\w\s]/g,"\\$&"),"]")}var rX=Object.entries(e2.CompletionItemKind).reduce(function(e,t){var n=(0,Z._)(t,2),r=n[0],i=n[1];return(0,y._)((0,ns._)({},i,r.toLowerCase()),e)},{});function rF(e,t){return{from:re(e,t.start),to:re(e,t.end)}}function rW(e,t){var n=rF(e.state,t.range),r=n.from,i=n.to;if(null!==r&&null!==i)return{from:r,to:i,insert:t.newText}}var rH=eT.tk.baseTheme({".lsp-completion-keyboard-shortcuts":{display:"none"},'[aria-selected="true"] .lsp-completion-keyboard-shortcuts':{float:"right",display:"inline-block"}}),rV=n(30609);function rz(e){var t=e.content,n=e.className,r=e.showHoveredVariable,i=(0,G.Gn)("fontSize").preferences;if("string"!=typeof t&&"kind"in t)return(0,x.tZ)(rd,{content:t});var o=(Array.isArray(t)?t:[t]).map(function(e){return"string"==typeof e?e:"```"+e.language+"\n"+e.value+"\n```"}).join("\n");return(0,x.tZ)(ra.ZP,{css:[{p:{fontSize:i.fontSize}},r?[eo.l0.maxHeight(rj),eo.l0.overflowY("auto")]:void 0],className:n,components:{code:function(e){return(0,x.tZ)(rl.Z,(0,y._)({minimal:!0,disableCopy:!0},e))}},children:o})}var rj=100;function rq(e){var t=e.className,n=e.content,r=e.textHovered,i=(0,nO.P5)({controlName:"flag-debugger-hover-variable",logFlagToAnalytics:!1}),o=(0,tD.Z)().debuggest,a=(0,tT.Z)(o.mainClient),l=a&&("running"===a.state.current||"paused"===a.state.current),c=(0,Z._)((0,Y.useState)(!1),2),s=c[0],u=c[1],d=(0,Z._)((0,Y.useState)(void 0),2),f=d[0],h=d[1],p=i&&l&&f;return(0,Y.useEffect)(function(){function e(){return(e=(0,eS._)(function(){var e,t;return(0,ek.Jh)(this,function(n){switch(n.label){case 0:if(!(i&&l))return[3,4];u(!0),n.label=1;case 1:return n.trys.push([1,,3,4]),[4,a.evaluate({expression:r,context:"hover"})];case 2:return(null===(e=(t=n.sent()).body)||void 0===e?void 0:e.result)&&h((0,y._)({name:r,value:t.body.result},t.body)),[3,4];case 3:return u(!1),[7];case 4:return[2]}})})).apply(this,arguments)}!function(){e.apply(this,arguments)}()},[i,a,l,r]),(0,x.BX)(en.G,{css:[rs,p?eo.l0.maxHeight(rj+190):eo.l0.maxHeight(190),eo.l0.minHeight(30),eo.l0.overflowY("auto"),eo.l0.borderRadius(4),eo.l0.backgroundColor.backgroundHigher],children:[s?void 0:(0,x.tZ)(rz,{content:n,className:t,showHoveredVariable:!!p}),p?(0,x.tZ)(en.G,{css:[eo.l0.maxHeight(190),eo.l0.overflowY("auto")],children:(0,x.tZ)(rV._,{depth:0,client:a,variable:f})}):void 0]})}var rY=n(22031),r$=n(82200),rJ=n(22421),rK=n(23758),rQ=n(59620),r0=n(81031),r1=n(95032),r2=n(22487),r8=n(58719),r4=n(50831),r3=(0,n0.X)({styles0:[eo.l0.pl(8),eo.l0.py(8)],styles1:[eo.l0.p(4)],styles2:[eo.l0.minWidth("375px"),eo.l0.maxWidth("500px"),eo.l0.pt(4),eo.l0.maxHeight("100%"),{overflowY:"scroll"}],styles3:[eo.l0.p(4)],styles4:[eo.l0.flex.row,eo.l0.justify.spaceBetween,eo.l0.align.center,eo.l0.pr(4)],styles5:[eo.l0.p(4),eo.l0.pl(8)],styles6:[eo.l0.p(4)],styles7:[eo.l0.p(4),eo.l0.pl(8)]});function r5(e){var t=e.matchesMap,n=e.fileToContents,r=e.type,i=e.onClose,o=e.jumpToPosition,a=Object.keys(t);return 0===a.length?(0,x.tZ)(nQ.xv,{color:"dimmer",css:r3.styles0,multiline:!1,children:"REFERENCES"===r?"No references found":"No definitions found"}):(0,x.tZ)(en.G,{children:a.map(function(e){var r=t[e],l=n[e],c=(0,r1.Z)(r,l);return(0,x.tZ)(en.G,{css:r3.styles1,children:(0,x.tZ)(r0.V,{path:e,extensions:[c],doc:l,numMatches:r.length,initiallyExpanded:1===a.length,onNavigateToCode:function(t){if(null!==t)o({path:e,line:t.line+1,col:t.character});else{var n=(0,Z._)(r,1)[0],a=l.lineAt(n.from),c=n.from-a.from;o({path:e,line:a.number,col:c})}i()}})},e)})})}function r6(e){var t=e.files,n=e.onClose,r=e.references,i=e.definitions,o=e.currentFile,a=e.currentFileContents,l=e.jumpToPosition,c=(0,tD.Z)().fs,s=(0,t1.Z)(o),u=(0,r2.Z)(n,[]),d=(0,Z._)((0,Y.useState)((0,ns._)({},o,e_.xv.of(a.split("\n")))),2),f=d[0],h=d[1];(0,Y.useEffect)(function(){if(t.length){var e=!1;return!function(){n.apply(this,arguments)}(),function(){e=!0}}function n(){return(n=(0,eS._)(function(){var n;return(0,ek.Jh)(this,function(r){switch(r.label){case 0:var i;return n={},[4,Promise.all(t.map((i=(0,eS._)(function(e){var t;return(0,ek.Jh)(this,function(r){switch(r.label){case 0:return[4,c.readFile(e)];case 1:if((t=r.sent()).error)throw Error("Something went wrong reading file with path ".concat(e,". Received error: ").concat(t.error));return n[e]=e_.xv.of(t.content.toString().split("\n")),[2]}})}),function(e){return i.apply(this,arguments)})))];case 1:if(r.sent(),e)return[2];return h(function(e){return(0,y._)({},e,n)}),[2]}})})).apply(this,arguments)}},[c,t]);var p=(0,w._)(r).concat((0,w._)(i));if(!s||p.some(function(e){return!(s.documentUriToPath(e.uri) in f)}))return(0,x.tZ)(en.G,{style:{width:eo.TV.space128,height:eo.TV.space128,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,x.tZ)(W.Z,{size:32})});var m={},v={};function g(e,t){if(!s)throw Error("Expected LSP Client");var n=s.documentUriToPath(e.uri),r=e.range,i=r.start,o=r.end;n in t||(t[n]=[]);var a=f[n],l=a.line(i.line+1),c=a.line(o.line+1);t[n].push({from:l.from+i.character,to:c.from+o.character})}return r.forEach(function(e){g(e,m)}),i.forEach(function(e){g(e,v)}),(0,x.BX)(en.G,{innerRef:u,css:r3.styles2,children:[(0,x.tZ)(en.G,{css:{borderBottom:"1px solid var(--background-highest)"},children:(0,x.BX)(en.G,{css:r3.styles3,children:[(0,x.BX)(en.G,{css:r3.styles4,children:[(0,x.tZ)(nQ.h4,{level:2,variant:"subheadDefault",css:r3.styles5,children:"Definitions"}),(0,x.tZ)(r4.Z,{filled:!1,border:!1,onClick:n,children:(0,x.tZ)(r8.Z,{})})]}),(0,x.tZ)(r5,{matchesMap:v,fileToContents:f,type:"DEFINITION",onClose:n,currentFile:o,jumpToPosition:l})]})}),(0,x.tZ)(en.G,{children:(0,x.BX)(en.G,{css:r3.styles6,children:[(0,x.tZ)(nQ.h4,{level:2,variant:"subheadDefault",css:r3.styles7,children:"References"}),(0,x.tZ)(r5,{matchesMap:m,fileToContents:f,type:"REFERENCES",onClose:n,currentFile:o,jumpToPosition:l})]})})]})}(l=m||(m={})).DEFINITION="DEFINITION",l.REFERENCES="REFERENCES";var r9=n(13358),r7=(0,n(62609).B)(),ie=e_.Py.define(),it=e_.QQ.define({create:function(){return null},update:function(e,t){if(t.isUserEvent("select")||t.isUserEvent("undo")||t.isUserEvent("redo"))return null;if(!t.isUserEvent("input.type")||t.changes.empty)return e;var n="";return t.changes.iterChanges(function(e,t,r,i,o){n=o.sliceString(0,1)}),n||null}}),ir=new nJ.Jf(function(e){var t,n,r=e.help,i=e.index,o="1px solid ".concat(eo.TV.outlineDimmer),a="min(425px, 80vw)",l=r.signatures[i],c=r.signatures.length>1;if(!l)return null;var s=l.documentation,u=null!=r.activeParameter&&(null===(n=l.parameters)||void 0===n?void 0:null===(t=n[r.activeParameter])||void 0===t?void 0:t.documentation);return(0,x.BX)(en.G,{css:[eo.l0.flex.row,eo.l0.backgroundColor.backgroundHigher,{width:"max-content"}],children:[c?(0,x.tZ)(en.G,{css:[eo.l0.flex.row,eo.l0.pl(4),{borderRight:o,paddingBottom:5}],children:(0,x.BX)("span",{css:[{alignSelf:"flex-end"},eo.l0.p(4)],children:[i+1,"/",r.signatures.length]})}):null,(0,x.BX)(en.G,{children:[(0,x.tZ)(en.G,{css:[eo.l0.py(4),eo.l0.pl(c?4:8),eo.l0.pr(8),eo.l0.maxHeight(100),eo.l0.overflowY("scroll"),eo.l0.font.code,{lineHeight:eo.TV.lineHeightSmall,maxWidth:a}],children:(0,x.tZ)(ii,{signature:l,activeParameter:r.activeParameter})}),!!(s||u)&&(0,x.BX)(en.G,{css:[eo.l0.px(c?4:8),eo.l0.py(2),eo.l0.maxHeight(200),eo.l0.overflow("scroll"),{borderTop:o,maxWidth:a}],children:[u?(0,x.tZ)(rd,{content:u}):null,s?(0,x.tZ)(rd,{content:s}):null]})]})]})});function ii(e){var t,n=e.signature,r=n.label,i=n.parameters,o=e.activeParameter;if(null==o||!i)return(0,x.tZ)("span",{children:r});var a=null===(t=i[o])||void 0===t?void 0:t.label;if(!a)return(0,x.tZ)("span",{children:r});var l=(0,Z._)("string"==typeof a?[r.indexOf(a),r.indexOf(a)+a.length]:a,2),c=l[0],s=l[1];return(0,x.BX)("div",{children:[(0,x.tZ)("span",{children:r.slice(0,c)}),(0,x.tZ)("strong",{children:a}),(0,x.tZ)("span",{children:r.slice(s)})]})}function io(){return(io=(0,eS._)(function(e,t,n,r,i){var o,a;return(0,ek.Jh)(this,function(l){switch(l.label){case 0:return i.current&&n.notify.cancelRequest(i.current),o=n.generateId(),i.current=o,[4,n.request.signatureHelp(r,(0,eP.sg)(e.doc,t),{id:o})];case 1:if(a=l.sent(),i.current=null,"error"in a)return[2,null];return[2,a.result]}})})).apply(this,arguments)}var ia=n(8701),il=n(92674),ic=n.n(il),is=new Map,iu=n(445),id=n(22488),ih=n(57731),ip=n(49932),im=eT.tk.theme({"& .cm-gutters.cm-minimap-gutter":{backgroundColor:ip.TV.backgroundDefault,borderLeft:"1px solid ".concat(ip.TV.backgroundHigher)},"& .cm-minimap-box-shadow":{boxShadow:"unset"}}),iv=e_.QQ.define({create:function(e){return 0===e.doc.length||e.doc.lines>1e3},update:function(e,t){return t.docChanged?0===t.state.doc.length||t.state.doc.lines>1e3:e}}),ig=new tk.j(function(e,t,n){var r=function(){return{dom:document.createElement("div")}};return e?null:[im,iv,ih.a.compute([nR,iv],function(e){if(e.field(iv,!1)||"blocks"!==t&&"characters"!==t)return null;var i=e.field(nR,!1),o={};if(i)for(var a=1;a<=e.doc.lines;a++)switch(i.getLineChangeType(a)){case nE.dQ.COVERED:o[a]=n.values.global.greenDefault;break;case nE.dQ.MODIFIED:o[a]=n.values.global.blueDefault}return{create:r,displayText:t,gutters:[o]}})]}),iy=n(48652),ib=n(85234),iZ=n.n(ib),iw=n(17542),ix="cm-multiplayer-selection-green",iC="cm-multiplayer-selection-red",i_="cm-multiplayer-selection-blue",iS="cm-multiplayer-selection-gold",iE="cm-multiplayer-selection-purple",ik="cm-multiplayer-selection-teal",iT="cm-multiplayer-selection-pink",iR=eT.tk.theme((v={},(0,ns._)(v,".".concat(ix),{background:"rgba(27, 196, 125, 0.2)"}),(0,ns._)(v,".".concat(iC),{background:"rgba(239, 85, 51, 0.2)"}),(0,ns._)(v,".".concat(i_),{background:"rgba(24, 160, 251, 0.2)"}),(0,ns._)(v,".".concat(iS),{background:"rgba(255, 199, 0, 1)"}),(0,ns._)(v,".".concat(iE),{background:"rgba(144, 124, 255, 0.2)"}),(0,ns._)(v,".".concat(ik),{background:"rgba(0, 181, 206, 0.2)"}),(0,ns._)(v,".".concat(iT),{background:"rgba(238, 70, 211, 0.2)"}),v)),iD={"#1BC47D":ix,"#EF5533":iC,"#18A0FB":i_,"#FFC700":iS,"#907CFF":iE,"#00B5CE":ik,"#EE46D3":iT},iI=e_.Py.define(),iG=e_.Py.define(),iB=e_.Py.define(),iA=e_.QQ.define({create:function(){return{}},update:function(e,t){if(!t.changes.empty){var n=function(e){return t.changes.mapPos(Math.min(t.changes.length,e))},r={},i=!0,o=!1,a=void 0;try{for(var l,c=Object.values(e)[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var s=l.value;r[s.id]=(0,b._)((0,y._)({},s),{position:n(s.position),selectionStart:n(s.selectionStart),selectionEnd:n(s.selectionEnd)})}}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}e=r}var u=!0,d=!1,f=void 0;try{for(var h,p=t.effects[Symbol.iterator]();!(u=(h=p.next()).done);u=!0){var m=h.value;if(m.is(iw.R)&&(e=(0,y._)({},e)),m.is(iI)&&m.value.position<=t.newDoc.length&&((e=(0,y._)({},e))[m.value.id]=(0,y._)({},m.value)),m.is(iG)&&(e=(0,y._)({},e),m.is(iG)&&delete e[m.value]),m.is(iB)){e=(0,y._)({},e);var v=!0,g=!1,w=void 0;try{for(var x,C=Object.entries(e)[Symbol.iterator]();!(v=(x=C.next()).done);v=!0){var _=(0,Z._)(x.value,2),S=_[0];_[1].username===m.value&&delete e[S]}}catch(e){g=!0,w=e}finally{try{v||null==C.return||C.return()}finally{if(g)throw w}}}}}catch(e){d=!0,f=e}finally{try{u||null==p.return||p.return()}finally{if(d)throw f}}return e},provide:function(e){return[iR,e_.Wl.high((0,eT.EY)({above:!1,class:"cm-multiplayer-cursor-layer",update:function(t){return(0,eN.a)(t,e)},markers:function(t){var n=t.state.field(e,!1);if(!n)return[];var r=[],i=!0,o=!1,a=void 0;try{for(var l,c=Object.values(n)[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var s=l.value,u=s.selectionStart,d=s.selectionEnd,f=s.color.selection;if(u!==d){var h=e_.jT.range(u,d);r.push.apply(r,(0,w._)(eT.dc.forRange(t,f,h)))}}}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}return r}}))]}}),iP=eT.tk.theme({".multiplayer-cursor":{width:"2px",left:"0",top:"0"},".multiplayer-cursor .multiplayer-label":{boxShadow:eo.TV.shadow1,borderRadius:eo.TV.borderRadius4,padding:"1px",position:"absolute",left:"0px",animation:"fadeOut 2s ease-in forwards",color:"white",display:"inline-block",whiteSpace:"nowrap"},".multiplayer-cursor:hover .multiplayer-label":{animation:"auto"}});function iN(e){e.style.transform="translate(-10000px, -10000px)"}function iU(e){var t=document.createElement("div");t.textContent=e.username,t.style.backgroundColor=e.color.cursor,t.classList.add("multiplayer-label");var n=document.createElement("div");return n.classList.add("multiplayer-cursor"),n.style.backgroundColor=e.color.cursor,n.style.position=ec.gn?"absolute":"fixed",n.appendChild(t),{dom:n,label:t}}var iO=new Map,iL=[iP,eT.lg.define(function(e){var t=e.state.field(iA,!1),n=new Map((t?Object.values(t):[]).map(function(e){return[e.id,{view:iU(e),cursor:e}]})),r=!0,i=0,o="function"==typeof IntersectionObserver?new IntersectionObserver(function(e){Date.now()>i-50&&e.length>0&&e[e.length-1].intersectionRatio<1&&s()},{threshold:[1]}):null;function a(){o&&(o.disconnect(),n.forEach(function(e){o.observe(e.view.dom)}))}function l(){t&&0!==Object.values(t).length&&(e.inView&&e.requestMeasure(u),r!==e.inView)&&!(r=e.inView)&&n.forEach(function(e){iN(e.view.dom)})}a();var c=null;function s(){null===c&&(c=setTimeout(function(){c=null,l()},50))}window.addEventListener("resize",s);var u={read:function(){return{editorRect:e.scrollDOM.getBoundingClientRect(),dimensions:new Map((t?Object.values(t):[]).map(function(t){var r=n.get(t.id),i=r?function(e,t){var n=iO.get(e);if(n)return n;var r=t.getBoundingClientRect().width;return iO.set(e,r),r}(t.username,r.view.label):null;return[t.id,{position:e.coordsAtPos(t.position),labelWidth:i}]}))}},write:function(e){n.forEach(function(t,n){var r=e.dimensions.get(n);!function(e){var t=e.cursorView,n=e.position,r=e.labelWidth,i=e.editorRect,o=t.dom,a=t.label;if(!n||!r){iN(o);return}var l=n.bottom-n.top;if(n.bottom<=i.top+l||n.top+l>=i.bottom||n.right<i.left-.1||n.left>i.right+.1){iN(o);return}var c=n.left+r-i.right,s="0px";c>0?(s="-".concat(c,"px"),a.style.borderBottomLeftRadius="4px"):a.style.borderBottomLeftRadius="0px",a.style.pointerEvents="none",a.style.transform="translate(".concat(s,", -100%)");var u=ec.gn?{x:n.left-i.left+"px",y:n.top-i.top+"px"}:{x:"calc(".concat(n.left,"px + var(--fixed-position-offset-x))"),y:"calc(".concat(n.top,"px + var(--fixed-position-offset-y))")},d=u.x,f=u.y;o.style.transform="translate(".concat(d,", ").concat(f,")"),o.style.height=l+"px"}({cursorView:t.view,position:(null==r?void 0:r.position)||null,labelWidth:(null==r?void 0:r.labelWidth)||null,editorRect:e.editorRect})})},key:"multiplayer-cursors-plugin-".concat(iZ()())};return{update:function(r){r.transactions.length&&(i=Date.now());var o=r.state.field(iA,!1);if(!(o!==r.startState.field(iA,!1))){r.geometryChanged&&l();return}var c=new Map,s=new Set;if(o){var u=new Map((0,w._)(n.values()).map(function(e){return[e.cursor.id,e.view]}));Object.values(o).forEach(function(t){var n=u.get(t.id);if(n)s.add(n),c.set(t.id,{view:n,cursor:t});else{var r=iU(t);c.set(t.id,{view:r,cursor:t}),e.dom.appendChild(r.dom)}})}n.forEach(function(e){s.has(e.view)||e.view.dom.remove()}),n=c,t=o,a(),l()},destroy:function(){window.removeEventListener("resize",s),n.forEach(function(e){e.view.dom.remove()}),t=void 0,n=new Map,null==o||o.disconnect(),c&&clearTimeout(c)},maybeMeasure:l}},{eventHandlers:{scroll:function(){this.maybeMeasure()}}})],iM=function(){"use strict";function e(t,n,r,i){var o=this;(0,eE._)(this,e),this.view=t,this.destroyed=!1,this.colors=this.getColorMapFromUsers(i.getActiveUsers()),this.disposes=[],this.updateSelections=null,this.disposes.push(i.onUserLeave(function(e){o.destroyed||o.view.dispatch({effects:iB.of(e.username)})}),i.onActiveUsersChange(function(e){o.destroyed||(o.colors=o.getColorMapFromUsers(e))}),r.watchTextFile(n,{onReady:function(e){var t=e.updateSelections;o.destroyed||(o.updateSelections=t)},onCursor:function(e){if(!o.destroyed){var t=function(e){var t,n=e.cursor,r=e.usernameColorsMap,i=null===(t=n.user)||void 0===t?void 0:t.name;if(i){var o=n.id,a=n.position,l=n.selectionStart,c=n.selectionEnd,s=r[i];if(s&&o&&"number"==typeof a&&"number"==typeof l&&"number"==typeof c)return iI.of({id:o,username:i,position:a,color:{cursor:s,selection:iD[s]||""},selectionStart:l,selectionEnd:c})}}({cursor:e,usernameColorsMap:o.colors});t&&o.view.dispatch({effects:t})}},onRemoveCursor:function(e){o.destroyed||o.view.dispatch({effects:iG.of(e)})},onError:function(){o.updateSelections=null},onMoveOrDelete:function(){o.updateSelections=null}}))}var t=e.prototype;return t.getColorMapFromUsers=function(e){return e.reduce(function(e,t){return t.username&&t.color?(0,b._)((0,y._)({},e),(0,ns._)({},t.username,t.color)):e},{})},t.postUpdate=function(e){if(!(!e.selectionSet||e.transactions.every(function(e){return e.annotation(e_.YW.remote)}))&&this.updateSelections){var t=e.state.selection.ranges.map(function(e){return{position:e.head,selectionStart:e.from,selectionEnd:e.to}});this.updateSelections(t)}},t.destroy=function(){this.destroyed=!0,this.disposes.forEach(function(e){return e()})},e}(),iX=new tk.j(function(e,t,n){return[iL,iA,eT.lg.define(function(r){return new iM(r,e,t,n)},{provide:function(e){return eT.tk.updateListener.of(function(t){var n;return null===(n=t.view.plugin(e))||void 0===n?void 0:n.postUpdate(t)})}})]}),iF=function(){"use strict";function e(t,n){var r=this;(0,eE._)(this,e),this.view=t,this.presence=n,this.destroyed=!1,this.followed=null,this.dispose=n.onFollowedUserChanged(function(e){return r.onFollowedUserChanged(e)}),Promise.resolve().then(function(){r.onFollowedUserChanged(n.getFollowedUser())})}var t=e.prototype;return t.onFollowedUserChanged=function(e){var t=this;if(!this.destroyed&&(this.followed=e,this.followed)){var n=this.view.state.field(iA,!1);if(n){var r=Object.values(n).find(function(e){var n;return e.username===(null===(n=t.followed)||void 0===n?void 0:n.username)});r&&this.jumpToPosition(r.position)}}},t.jumpToPosition=function(e){this.view.dispatch({effects:[eT.tk.scrollIntoView(e_.jT.cursor(e),{x:"center",y:"center"})]})},t.unfollow=function(){this.presence.getFollowedUser()&&this.presence.unfollowUser()},t.postUpdate=function(e){if(this.followed){var t=void 0,n=!0,r=!1,i=void 0;try{for(var o,a=e.transactions[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value,c=!0,s=!1,u=void 0;try{for(var d,f=l.effects[Symbol.iterator]();!(c=(d=f.next()).done);c=!0){var h=d.value;h.is(iI)&&h.value.username===this.followed.username&&(t=h)}}catch(e){s=!0,u=e}finally{try{c||null==f.return||f.return()}finally{if(s)throw u}}}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}t&&this.jumpToPosition(t.value.position)}},t.destroy=function(){this.destroyed=!0,this.dispose()},e}(),iW=new tk.j(function(e){return eT.lg.define(function(t){return new iF(t,e)},{provide:function(e){return eT.tk.updateListener.of(function(t){var n;return null===(n=t.view.plugin(e))||void 0===n?void 0:n.postUpdate(t)})},eventHandlers:{click:function(){this.unfollow()},wheel:function(){this.unfollow()},keydown:function(e){"Control"!==e.key&&"Meta"!==e.key&&this.unfollow()}}})}),iH=n(54450),iV=n(13474),iz=n(63009),ij=n(87584),iq=n(30084),iY=e_.q6.define(),i$=e_.Py.define(),iJ=e_.QQ.define({create:function(){return!0},update:function(e,t){return!(0,eN.a)(t,i$)&&e},provide:function(e){return iy.o.from(e)}}),iK=function(){"use strict";function e(t,n,r,i){var o=this;(0,eE._)(this,e),this.view=t,this.path=n,this.fs=r,this.writeChange=null,this.destroyed=!1,this.debug=(0,b._)((0,y._)({},i),{latestReceivedVersion:0,openVersion:0,initiatedChanges:0,previousInitiatedChanges:null}),this.dispose=r.watchTextFile(n,{onReady:function(e){var n=e.initialContent,r=e.writeChange,i=e.version;o.destroyed||(o.debug.latestReceivedVersion=i,o.debug.openVersion=i,o.debug.setBsodFilePathVersion({filePath:o.path,version:i}),o.debug.trackTimeToLoadFileEnd(o.path),o.writeChange=r,t.dispatch({changes:{from:0,to:t.state.doc.length,insert:n},effects:i$.of(null),annotations:[e_.YW.addToHistory.of(!1),e_.YW.remote.of(!0),iY.of(!0)]}))},onChange:function(e){var n=e.changes,r=e.changeSource,i=e.version;if(!o.destroyed){o.debug.latestReceivedVersion=i,o.debug.setBsodFilePathVersion({filePath:o.path,version:i});try{t.dispatch({changes:n,annotations:[e_.YW.remote.of(r===iq.Fl.Container),e_.YW.addToHistory.of(r===iq.Fl.Local),iY.of(!0)]})}catch(e){o.debugThrowSyncRemoteOpError(n,r,e)}}},onError:function(){o.destroyed||(o.dispose=null,o.writeChange=null)},onMoveOrDelete:function(){o.destroyed||(o.dispose=null,o.writeChange=null)}})}var t=e.prototype;return t.postUpdate=function(e){if(e.docChanged&&this.writeChange){var t=!0,n=!1,r=void 0;try{for(var i,o=e.transactions[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;if(!(a.annotation(e_.YW.remote)||a.annotation(iY))){this.debug.initiatedChanges++;var l=a.annotation(iH.Z)?{author:"ghostwriter"}:{};try{this.writeChange(a.changes,l),this.debug.previousInitiatedChanges=a.changes}catch(t){this.debugThrowWriteChangeError(e,a,t);break}}}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}}},t.destroy=function(){var e;this.destroyed=!0,null===(e=this.dispose)||void 0===e||e.call(this),this.dispose=null,this.writeChange=null,this.debug.deleteBsodFilePathVersion({filePath:this.path})},t.debugThrowSyncRemoteOpError=function(e,t,n){var r=this;this.fs.readFile(this.path,{fromDisk:!1}).then(function(i){var o="replitReadError: "+i.error;i.error||(o=i.content.toString());var a=r.view.contentDOM.innerText;r.debug.throwBsod({origin:"Codemirror: ot/syncRemoteOp",error:n,tags:{ot:!0},extras:{filePath:r.path,previousChanges:JSON.stringify(r.debug.previousInitiatedChanges),changes:JSON.stringify(e),changeSource:t,otClientDoc:o,domText:a,cmDoc:r.view.state.doc.sliceString(0),openVersion:r.debug.openVersion,version:r.debug.latestReceivedVersion,initiatedChanges:r.debug.initiatedChanges}}),(0,eT.OO)(r.view.state,n)})},t.debugThrowWriteChangeError=function(e,t,n){var r=this;this.fs.readFile(this.path,{fromDisk:!1}).then(function(i){var o="replitReadError: "+i.error;i.error||(o=i.content.toString());var a=e.view.contentDOM.innerText,l=e.view.plugin(iV.k),c=null==l?void 0:l.logs();null==l||l.flush(),r.debug.throwBsod({origin:"Codemirror: ot/writeChange",error:n,tags:{ot:!0},extras:{filePath:r.path,previousChanges:JSON.stringify(r.debug.previousInitiatedChanges),transactionChanges:JSON.stringify(t.changes),otherTransactionChanges:JSON.stringify(e.transactions.filter(function(e){return e!==t}).map(function(e){return e.changes})),transactionDoc:t.newDoc.sliceString(0),updateDoc:e.state.doc.sliceString(0),otClientDoc:o,domText:a,openVersion:r.debug.openVersion,latestReceivedVersion:r.debug.latestReceivedVersion,keystrokes:JSON.stringify(c)}})}),(0,eT.OO)(e.state,n)},e}(),iQ=new tk.j(function(e,t,n){return eT.lg.define(function(r){return new iK(r,e,t,n)},{provide:function(e){return[iJ,eT.tk.updateListener.of(function(t){var n;return null===(n=t.view.plugin(e))||void 0===n?void 0:n.postUpdate(t)})]}})}),i0=n(61018),i1=n(35895),i2=n(45077),i8=n(60417),i4=n(28009),i3=n(75595),i5=n(1498),i6=n(15146),i9=n(18836),i7=n(49344),oe=n(46053),ot=(0,n0.X)({buttons:[eo.l0.display.flex,eo.l0.rowWithGap(4),eo.l0.justify.end],input:[eo.l0.colWithGap(4),eo.l0.flex.grow(1)],gap:[eo.l0.colWithGap(16)],label:[eo.l0.color.foregroundDimmer,eo.l0.fontSize(12),eo.l0.height(24),eo.l0.justify.center],flexRow:[eo.l0.display.flex,eo.l0.rowWithGap(8),eo.l0.align.center]}),on={fontFamily:"text-security-disc"},or=en.K.label;function oi(e){var t=(0,tD.Z)().secrets,n=(0,Y.useId)(),r=(0,Y.useId)(),i=(0,Z._)((0,Y.useState)(""),2),o=i[0],a=i[1],l=(0,Z._)((0,Y.useState)(e.initialValue),2),c=l[0],s=l[1],u=(0,Z._)((0,Y.useState)(!1),2),d=u[0],f=u[1],h=(0,Y.useRef)(null);return(0,Y.useEffect)(function(){if(e.isOpen){var t;null===(t=h.current)||void 0===t||t.focus(),(0,e3.j)(e3.U3.PASTE_SCANNER_USED,{action:"modal_opened",provider:null==e?void 0:e.provider})}},[e.isOpen,null==e?void 0:e.provider]),(0,x.tZ)(oe.MT,{contain:!0,children:(0,x.tZ)(i7.u,{isOpen:e.isOpen,onRequestClose:e.onCancel,children:(0,x.BX)(en.G,{css:ot.gap,children:[(0,x.tZ)(nQ.xv,{variant:"subheadBig",multiline:!1,children:"Add a key name for your secret value"}),(0,x.BX)(en.G,{css:ot.flexRow,children:[(0,x.BX)(en.G,{css:ot.input,children:[(0,x.tZ)(or,{css:ot.label,htmlFor:n,children:"Key"}),(0,x.tZ)(i9.II,{id:n,ref:h,value:o,onChange:function(e){return a(e.target.value)}})]}),(0,x.BX)(en.G,{css:ot.input,children:[(0,x.BX)(en.G,{css:ot.flexRow,children:[(0,x.tZ)(or,{css:ot.label,htmlFor:r,children:"Value"}),(0,x.tZ)(i6.hU,{alt:"Toggle Secret",onClick:function(){return f(function(e){return!e})},tooltipPlacement:"top",children:d?(0,x.tZ)(L.Z,{}):(0,x.tZ)(O.Z,{})})]}),(0,x.tZ)(i9.II,{id:r,value:c,onChange:function(e){return s(e.target.value)},style:d?void 0:on})]})]}),(0,x.BX)(en.G,{css:ot.buttons,children:[(0,x.tZ)(i5.zx,{text:"Cancel",onClick:e.onCancel}),(0,x.tZ)(i5.zx,{colorway:"primary",text:"Save Secret",disabled:0===o.length||0===c.length,onClick:(0,eS._)(function(){return(0,ek.Jh)(this,function(n){switch(n.label){case 0:return[4,t.writeSecret({key:o,value:c})];case 1:return n.sent(),e.onSaveSecret(o,c),(0,e3.j)(e3.U3.PASTE_SCANNER_USED,{action:"secret_created",provider:null==e?void 0:e.provider}),[2]}})})})]})]})})})}var oo=n(97411),oa=n(20573),ol=n(74652),oc=(0,n0.X)({hint:[eo.l0.align.center,eo.l0.border({color:eo.TV.outlineDimmer,direction:"top"}),eo.l0.color.foregroundDimmest,eo.l0.display.flex,eo.l0.flex.row,eo.l0.px(8),eo.l0.py(4),eo.l0.rowWithGap(8)],info:[eo.l0.p(8)],key:[eo.l0.px(4)],wrapper:[eo.l0.backgroundColor.backgroundHigher,eo.l0.borderRadius(4),eo.l0.cursor.default,eo.l0.font.default],mobileButtons:[eo.l0.flex.grow(1)],mobileHint:[eo.l0.justify.center]}),os={borderTop:"1px solid ".concat(eo.TV.outlineDimmer),borderBottom:"1px solid ".concat(eo.TV.outlineDimmer),borderRadius:0};function ou(e){return(0,x.BX)(en.G,{css:oc.wrapper,style:e.onMobile?os:void 0,children:[(0,x.BX)(en.G,{css:oc.info,style:{textAlign:e.onMobile?"center":"inherit"},children:[(0,x.tZ)(en.G,{children:"The value you pasted looks like a secret."}),(0,x.tZ)(en.G,{children:e.supportsSecrets?"Store it securely using our Secrets feature.":"Anyone will be able to see this."})]}),e.onMobile?(0,x.tZ)(of,(0,y._)({},e)):(0,x.tZ)(od,(0,y._)({},e))]})}function od(e){return(0,x.BX)(x.HY,{children:[e.supportsSecrets?(0,x.BX)(en.G,{css:oc.hint,onClick:e.onClickUseSecrets,children:[(0,x.tZ)(oo.Z,{}),"Press",(0,x.tZ)(en.G,{css:oc.key,children:(0,x.tZ)(ol.bM,{keyCombo:"Tab",small:!0})}),"to use Secrets"]}):null,(0,x.BX)(en.G,{css:oc.hint,onClick:e.onClickPasteAnyway,children:[(0,x.tZ)(oa.Z,{}),"Press",(0,x.tZ)(en.G,{css:oc.key,children:(0,x.tZ)(ol.bM,{keyCombo:"Enter",small:!0})}),"to paste anyway"]}),e.supportsSecrets?null:(0,x.BX)(en.G,{css:oc.hint,onClick:e.onClickUndo,children:[(0,x.tZ)(oa.Z,{}),"Press",(0,x.tZ)(en.G,{css:oc.key,children:(0,x.tZ)(ol.bM,{keyCombo:"Escape",small:!0})}),"to undo"]})]})}function of(e){return(0,x.BX)(en.G,{css:[oc.hint,oc.mobileHint],children:[e.supportsSecrets?(0,x.tZ)(i5.zx,{css:oc.mobileButtons,iconLeft:(0,x.tZ)(oo.Z,{}),text:"Use Secrets",onClick:e.onClickUseSecrets,colorway:"primary"}):null,(0,x.tZ)(i5.zx,{css:oc.mobileButtons,iconLeft:(0,x.tZ)(oa.Z,{}),text:"Paste Anyway",onClick:e.onClickPasteAnyway}),e.supportsSecrets?null:(0,x.tZ)(i5.zx,{css:oc.mobileButtons,iconLeft:(0,x.tZ)(oo.Z,{}),text:"Undo",onClick:e.onClickUndo})]})}var oh=n(68004),op=n(30249),om=(0,n0.X)({border:[eo.l0.border({color:ip.TV.accentPrimaryDefault,direction:"y",width:1})],title:[eo.l0.display.flex,eo.l0.rowWithGap(8),eo.l0.align.center,eo.l0.justify.spaceBetween,eo.l0.px(8),eo.l0.pt(4),eo.l0.font.default],wrapper:[eo.l0.backgroundColor.backgroundRoot,eo.l0.py(0),eo.l0.position.relative,eo.l0.zIndex(200)]});function ov(e){return(0,oh.Z)(e.onClose),(0,x.tZ)(oe.MT,{autoFocus:!0,contain:!0,children:(0,x.tZ)(en.G,{css:om.wrapper,children:(0,x.BX)(en.G,{css:om.border,children:[(0,x.BX)(en.G,{css:om.title,children:[(0,x.BX)(nQ.xv,{multiline:!1,children:["Access the secret ",(0,x.tZ)("strong",{children:e.keyName}),":"]}),(0,x.tZ)(i6.hU,{alt:"Close",onClick:e.onClose,children:(0,x.tZ)(r8.Z,{})})]}),(0,x.tZ)(tv.Tg,{background:"root",children:(0,x.tZ)(op.Z,{keyName:e.keyName,filePath:e.filePath,onInsert:e.onInsert})})]})})})}var og=i8.V.compute([i1.xg],function(e){var t=e.field(i1.xg).iter();if(null===t.value)return null;for(var n=[];null!==t.value;){var r=t.from,i=t.to,o=t.value;n.push({from:r,to:i,insert:o.result.secret}),t.next()}return n}),oy=function(e){"use strict";(0,t9._)(n,e);var t=(0,t7._)(n);function n(e,r){var i;return(0,eE._)(this,n),(i=t.call(this)).secret=e,i.as=r,i}var r=n.prototype;return r.toDOM=function(e){var t=this,n=(0,nJ.VV)((0,x.tZ)(ou,{supportsSecrets:e.state.facet(i1.$X),onMobile:"pocket"===this.as,onClickUseSecrets:function(){e.dispatch({effects:i1.Lo.of(t.secret)})},onClickPasteAnyway:function(){(0,i1.Pz)(e),e.focus()},onClickUndo:function(){e.dispatch({effects:i1.uh.of(t.secret.id)}),e.focus()}}));return"pocket"===this.as&&(n.style.zIndex="200",n.style.position="relative",this.adjustForGutter(n,e)),n},r.updateDOM=function(e,t){return this.adjustForGutter(e,t),!0},r.adjustForGutter=function(e,t){var n=t.dom.querySelector(".cm-gutters");e.style.marginLeft=n?"-".concat(n.clientWidth,"px"):"inherit"},n}(eT.l9),ob=i3.t.compute([i1.xv],function(e){var t=e.facet(eA.Yp),n=e.field(i1.xv);return n&&t?{key:"pasteScannerModal",node:function(e){var t;return(0,x.tZ)(oi,{isOpen:!0,initialValue:n.result.secret,provider:n.result.provider,onSaveSecret:(t=(0,eS._)(function(t){var r,i,o,a,l;return(0,ek.Jh)(this,function(c){for(r=e.state.field(i1.xg).iter(),i=[];r.value;)o=r.from,a=r.to,(l=r.value).id===n.id&&(i.push(i1.uh.of(l.id)),i.push(i1.Yt.of({secret:t,from:o,to:a}))),r.next();return e.dispatch({effects:(0,w._)(i).concat([i1.ZB.of(null)])}),[2]})}),function(e){return t.apply(this,arguments)}),onCancel:function(){return e.dispatch({effects:i1.ZB.of(null)})}})}}:null}),oZ=eT.tk.decorations.compute([i1.Do],function(e){var t=e.field(i1.Do).iter(),n=t.from,r=t.to,i=t.value,o=e.facet(eA.Yp);return i&&o?eT.p.set(eT.p.widget({widget:new ow(i.key,o),side:1,block:!0}).range(n,r)):eT.p.none}),ow=function(e){"use strict";(0,t9._)(n,e);var t=(0,t7._)(n);function n(e,r){var i;return(0,eE._)(this,n),(i=t.call(this)).key=e,i.filePath=r,i}var r=n.prototype;return r.toDOM=function(e){var t=(0,nJ.VV)((0,x.tZ)(ov,{keyName:this.key,filePath:this.filePath,onClose:function(){return e.dispatch({effects:i1.qs.of(null)})},onInsert:function(t){e.dispatch(e.state.changeByRange(function(e){return{range:e_.jT.cursor(e.from+t.length),changes:{from:e.from,to:e.to,insert:t}}})),e.focus(),(0,e3.j)(e3.U3.PASTE_SCANNER_USED,{action:"secret_key_inserted"})}}));return this.adjustForGutter(t,e),t},r.updateDOM=function(e,t){return this.adjustForGutter(e,t),!0},r.adjustForGutter=function(e,t){var n=t.dom.querySelector(".cm-gutters");e.style.marginLeft=n?"-".concat(n.clientWidth,"px"):"inherit"},n}(eT.l9),ox=[og,(c=[i1.xv,i1.xg],s=function(e){return null!=e.field(i1.xv,!1)?null:e.field(i1.xg,!1)||null},[eT.hJ.compute(c,function(e){var t=s(e);if(!t||e.facet(i4.h))return null;for(var n=t.iter();n.value;){var r=function(){var e=new oy(n.value,"tooltip");return{v:{arrow:!0,pos:n.to,create:function(t){return{dom:e.toDOM(t)}}}}}();if("object"===(0,i2._)(r))return r.v}return null}),eT.tk.decorations.compute(c,function(e){var t=s(e);if(!t||!e.facet(i4.h))return eT.p.none;for(var n=t.iter();n.value;){var r=new oy(n.value,"pocket");return eT.p.set(eT.p.widget({widget:r,side:1,block:!0}).range(n.to,n.to))}return eT.p.none})]),ob,oZ],oC=new tk.j(function(e){return[i1.$X.of(!e),i1.Do,i1.xg,i1.xv,ox,i1.Gv]});function o_(e,t){var n=performance.now();rn.kg.time(e,n-t)}var oS=new tk.j(function(e){var t=e?.01:.001;return e_.Wl.highest(eT.tk.domEventHandlers({keydown:function(e){if(Math.random()<t){var n=e.timeStamp;requestAnimationFrame(function(){o_("editor input latency",n),"undefined"!=typeof requestIdleCallback?requestIdleCallback(function(){o_("editor input latency after layout",n)}):setTimeout(function(){o_("editor input latency after layout",n)})})}}}))}),oE=n(20142),ok=n(5652),oT=function(e){var t=parseInt(e.substring(1),16);return[t>>16&255,t>>8&255,255&t]},oR=n(32508),oD=n.n(oR);function oI(e){var t=RegExp("".concat(e,"\\(-?\\b\\d+\\.?\\d*\\b\\s*(,\\s*-?\\b\\d+\\.?\\d*\\b)?"),"g"),n=new RegExp("".concat(e,"\\((?<x>-?\\b\\d+\\.?\\d*\\b)\\s*(,\\s*(?<y>-?\\b\\d+\\.?\\d*\\b))?"));return{regexp:t,cursor:"move",onDrag:function(t,r,i){var o,a,l=n.exec(t),c=Number(null==l?void 0:null===(o=l.groups)||void 0===o?void 0:o.x),s=Number(null==l?void 0:null===(a=l.groups)||void 0===a?void 0:a.y);isNaN(c)||(isNaN(s)&&(s=c),r("".concat(e,"(").concat(c+i.movementX,", ").concat(s+i.movementY)))}}}var oG=oI("vec2");function oB(e){var t=RegExp("".concat(e,"\\(.*\\)"),"g"),n=new RegExp("".concat(e,"\\((?<r>\\d+)\\s*,\\s*(?<g>\\d+)\\s*,\\s*(?<b>\\d+)\\)"));return{regexp:t,cursor:"pointer",onClick:function(t,r){var i,o,a,l=n.exec(t),c=Number(null==l?void 0:null===(i=l.groups)||void 0===i?void 0:i.r),s=Number(null==l?void 0:null===(o=l.groups)||void 0===o?void 0:o.g),u=Number(null==l?void 0:null===(a=l.groups)||void 0===a?void 0:a.b),d=document.createElement("input");d.type="color",isNaN(c+s+u)||(d.value="#"+c.toString(16)+s.toString(16)+u.toString(16)),d.addEventListener("input",function(t){var n=t.target;if(n.value){var i=(0,Z._)(oT(n.value),3),o=i[0],a=i[1],l=i[2];r("".concat(e,"(").concat(o,", ").concat(a,", ").concat(l,")"))}}),d.click()}}}oI("ellipse"),oI("circle"),oI("point"),oI("rect"),oI("square"),oI("vertex");var oA=oB("rgb");oB("background"),oB("fill"),oB("stroke");var oP={regexp:/https?:\/\/[^\s)"']+/g,cursor:"pointer",onClick:function(e){oD()(e)&&window.open(e,"_blank")}},oN=[{regexp:/-?\b\d+\.?\d*\b/g,cursor:"ew-resize",onDrag:function(e,t,n){var r=Number(e)+n.movementX;isNaN(r)||t(r.toString())}},{regexp:/true|false/g,cursor:"pointer",onClick:function(e,t){switch(e){case"true":return t("false");case"false":return t("true")}}},oG,oA,oP],oU=[oP],oO=new tk.j(function(e,t){return t?null:(0,ok.ZP)({key:"mod",rules:e?oN:oU})}),oL=n(30826),oM=n.n(oL),oX=new Set,oF=oM()(function(){var e=!0,t=!1,n=void 0;try{for(var r,i=oX[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value;(0,e3.j)(e3.U3.WS_TYPED,{fileExt:o})}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}oX.clear()},18e4),oW=eT.tk.updateListener.of(function(e){if(e.docChanged){var t=e.state.facet(eA.Yp);if(t){var n=(0,$.r6)(t)||(0,$.UO)(t);!e.transactions.some(function(e){return e.annotation(e_.YW.remote)})&&(oX.has(n)||(oX.add(n),oF()))}}}),oH=n(81013),oV=eT.tk.theme({".cm-ruler-element":{backgroundColor:eo.TV.backgroundHigher}}),oz=e_.QQ.define({create:function(e){return 0===e.doc.length},update:function(e,t){return t.docChanged?0===t.state.doc.length:e}}),oj=(0,eT.EY)({above:!1,class:"cm-ruler-layer",update:function(e){return(0,eN.a)(e,oq,oz,iw.R)},markers:function(e){if(e.state.field(oz,!1))return[];var t=e.state.facet(oq);if(0===t.length)return[];var n=[],r=e.dom.getBoundingClientRect(),i=e.contentDOM.getBoundingClientRect().left-r.left,o=r.width-2,a=Math.max(r.height,e.contentHeight),l=!0,c=!1,s=void 0;try{for(var u,d=t[Symbol.iterator]();!(l=(u=d.next()).done);l=!0){var f=u.value,h=i+e.defaultCharacterWidth*f;h<o&&n.push(new eT.dc("cm-ruler-element",h,0,2,a))}}catch(e){c=!0,s=e}finally{try{l||null==d.return||d.return()}finally{if(c)throw s}}return n}}),oq=e_.r$.define({enables:[oz,oj,oV]}),oY=new tk.j(function(e){return e.map(function(e){return oq.of(e)})}),o$=n(87280),oJ=n(7444),oK=n(26508),oQ=n(95571),o0=n(50626),o1=n(6303),o2=n(94655),o8=n(68681);function o4(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;if(!e.valid)return[];for(var r=[],i=e.getCursor(t),o=i.next();!o.done&&r.length<n;)r.push(o.value),o=i.next();return r}function o3(e){return e>420?"large":"small"}var o5=en.K.div,o6=(0,n0.X)({root:[eo.l0.rowWithGap(4),eo.l0.px(4),eo.l0.py(6),{borderBottom:"1px solid",borderColor:eo.TV.outlineDimmest}],panelButtonWrapper:[eo.l0.center,eo.l0.height(32)],content:[eo.l0.display.grid,eo.l0.flex.growAndShrink(1),{gridTemplateAreas:'"search search-controls"',gridTemplateRows:"1fr",gridTemplateColumns:"1fr max-content",gap:eo.TV.space8}],contentExpanded:[{gridTemplateAreas:'"search search-controls" "replace replace-controls"',gridTemplateRows:"1fr 1fr",gridTemplateColumns:"1fr max-content"}],contentExpandedSmall:[{gridTemplateAreas:'"search" "search-controls" "replace" "replace-controls"',gridTemplateRows:"1fr max-content 1fr max-content",gridTemplateColumns:"1fr"}],contentSmall:[{gridTemplateAreas:'"search" "search-controls"',gridTemplateRows:"1fr max-content",gridTemplateColumns:"1fr"}],matchLabel:[eo.l0.position.absolute,eo.l0.top(0),eo.l0.right(0),eo.l0.height("100%"),eo.l0.center,eo.l0.pr(4)],inputControlsSmall:[eo.l0.colWithGap(8),eo.l0.flex.growAndShrink(1)],searchInputWrapper:[eo.l0.position.relative,{gridArea:"search"}],searchControls:[eo.l0.display.flex,eo.l0.align.center,eo.l0.rowWithGap(8),eo.l0.flex.wrap,{gridArea:"search-controls"}],replaceInputWrapper:[{gridArea:"replace"}],replaceControls:[eo.l0.display.flex,eo.l0.align.center,eo.l0.rowWithGap(8),eo.l0.flex.wrap,{gridArea:"replace-controls"}],searchSettings:eo.l0.flex.row,jumpIconButton:[eo.l0.height(32),eo.l0.width(32)]}),o9=new nJ.Jf(Y.forwardRef(function(e,t){var n=e.view,r=e.query,i=e.updateQuery,o=(0,Z._)((0,Y.useState)(!1),2),a=o[0],l=o[1],c=(0,Z._)((0,Y.useState)([]),2),s=c[0],u=c[1],d=(0,Z._)((0,Y.useState)(null),2),f=d[0],h=d[1],p=s.length,m=(0,oJ.Z)(r),v=(0,oJ.Z)(s);function g(){(0,o$.g)(n);var e=n.state.selection.main;n.dispatch({effects:eT.tk.scrollIntoView(e.from,{y:"center",x:"center"})}),p<=1||h(function(t){if(null===t){var n=s.findIndex(function(t){return t.from===e.from&&t.to===e.to});return -1===n?1:n+1}return t>=p?1:t+1})}function y(){(0,o$.a7)(n);var e=n.state.selection.main;n.dispatch({effects:eT.tk.scrollIntoView(e.from,{y:"center",x:"center"})}),p<=1||h(function(t){if(null===t){var n=s.findIndex(function(t){return t.from===e.from&&t.to===e.to});return -1===n?1:n+1}return t<=1?p||1:t-1})}(0,Y.useImperativeHandle)(t,function(){return{onSelectionSet:function(){var e=n.state.selection.main,t=v.current.findIndex(function(t){return t.from<=e.anchor&&t.to>=e.anchor});h(-1!==t?t+1:null)},onDocChanged:function(){u(o4(m.current,n.state.doc)),h(null)},onExpandRequested:function(){l(!0)}}},[n,m,v]),(0,Y.useEffect)(function(){var e=o4(r,n.state.doc);u(e);var t=n.state.selection.main,i=e.findIndex(function(e){return e.from<=t.anchor&&e.to>=t.anchor});h(-1!==i?i+1:null)},[n,r]);var b=(0,Z._)((0,Y.useState)(o3(0)),2),w=b[0],C=b[1],_=(0,oK.Z)(function(e){e.width&&C(o3(e.width))});function S(e){return(0,eT.$1)(n,e,"search-panel")}var E=p>0,k=r.search.length>0?"0 / 0":null,T=E?"".concat(f||1," / ").concat(p):k,R=T?8*T.length:null,D=(0,x.BX)(en.G,{css:o6.searchSettings,children:[(0,x.tZ)(o8.Z,{alt:"case sensitive",icon:(0,x.tZ)(o0.Z,{}),checked:r.caseSensitive,onClick:function(){i({caseSensitive:!r.caseSensitive})}}),(0,x.tZ)(o8.Z,{alt:"regular expressions",icon:(0,x.tZ)(o1.Z,{}),checked:r.regexp,onClick:function(){i({regexp:!r.regexp})}})]}),I=[o6.content];return"small"!==w&&a?I.push(o6.contentExpanded):"small"===w&&a?I.push(o6.contentExpandedSmall):"small"!==w||a||I.push(o6.contentSmall),(0,x.tZ)(o5,{ref:_,onKeyDown:function(e){S(e)&&e.preventDefault()},children:(0,x.BX)(tv.Tg,{elevated:!0,css:o6.root,children:[(0,x.tZ)(en.G,{css:o6.panelButtonWrapper,children:(0,x.tZ)(i6.hU,{alt:a?"Close replace panel":"Show replace panel",css:o6.jumpIconButton,onClick:function(){l(function(e){return!e})},children:(0,x.tZ)(U.Z,{rotate:a?90:0,style:{transition:"200ms ease"}})})}),(0,x.BX)(en.G,{css:I,children:[(0,x.BX)(en.G,{css:o6.searchInputWrapper,children:[(0,x.tZ)(o2.h,{style:{padding:4,paddingRight:null!=R?R:void 0},placeholder:"Search",value:r.search,name:"search","main-field":"true",onKeyDown:function(e){if((0,oQ.jh)(e)&&"f"===e.key){e.currentTarget.select();return}if(!("enter"!==e.key.toLowerCase()||S(e))){if(e.preventDefault(),e.shiftKey){y();return}g()}},onChange:function(e){i({search:e})}}),T?(0,x.tZ)(en.G,{css:o6.matchLabel,children:(0,x.tZ)(nQ.xv,{variant:"small",color:"dimmest",multiline:!1,children:T})}):null]}),(0,x.BX)(en.G,{css:o6.searchControls,children:[(0,x.BX)(en.G,{css:eo.l0.flex.row,children:[(0,x.tZ)(i6.hU,{css:o6.jumpIconButton,alt:"Previous",onClick:function(){y()},children:(0,x.tZ)(U.Z,{rotate:-90})}),(0,x.tZ)(i6.hU,{css:o6.jumpIconButton,alt:"Next",onClick:function(){g()},children:(0,x.tZ)(U.Z,{rotate:90})})]}),(0,x.tZ)(i5.zx,{text:"Select all",onClick:function(){(0,o$.i3)(n),n.focus()}}),D]}),a?(0,x.BX)(x.HY,{children:[(0,x.tZ)(en.G,{css:o6.replaceInputWrapper,children:(0,x.tZ)(i9.II,{style:{padding:4},placeholder:"Replacement",name:"replace",value:r.replace,onKeyDown:function(e){"enter"!==e.key.toLowerCase()||S(e)||(e.preventDefault(),(0,o$.K9)(n))},onChange:function(e){i({replace:e.target.value})}})}),(0,x.BX)(en.G,{css:o6.replaceControls,children:[(0,x.tZ)(i5.zx,{text:"Replace",onClick:function(){(0,o$.K9)(n)}}),(0,x.tZ)(i5.zx,{text:"Replace all",onClick:function(){(0,o$.ko)(n)}})]})]}):null]}),(0,x.tZ)(en.G,{css:o6.panelButtonWrapper,children:(0,x.tZ)(i6.hU,{alt:"Close Search Panel",tooltipHidden:!0,onClick:function(){(0,o$.N$)(n)},children:(0,x.tZ)(r8.Z,{})})})]})})})),o7=e_.Py.define(),ae=[(0,o$.yC)({createPanel:function(e){var t=!1,n=!1,r=!1,i=!1,o=!1,a=function(t){var n,r,i,o,a,l,c=(0,o$.uP)(e.state),s=new o$.Jb({search:null!==(n=t.search)&&void 0!==n?n:c.search,caseSensitive:null!==(r=t.caseSensitive)&&void 0!==r?r:c.caseSensitive,literal:null!==(i=t.literal)&&void 0!==i?i:c.literal,regexp:null!==(o=t.regexp)&&void 0!==o?o:c.regexp,replace:null!==(a=t.replace)&&void 0!==a?a:c.replace,wholeWord:null!==(l=t.wholeWord)&&void 0!==l?l:c.wholeWord});s.eq(c)||e.dispatch({effects:o$.ql.of(s)})},l=o9.create({view:e,query:(0,o$.uP)(e.state),updateQuery:a});return{dom:l,top:!0,update:function(t){(0,eN.a)(t,o$.ql)&&o9.set(l,{view:e,query:(0,o$.uP)(t.state),updateQuery:a}),t.selectionSet&&!i&&(i=!0,requestAnimationFrame(function(){if(!n){var e;i=!1,null===(e=o9.ref(l))||void 0===e||e.onSelectionSet()}})),t.docChanged&&!r&&(r=!0,requestAnimationFrame(function(){if(!n){var e;r=!1,null===(e=o9.ref(l))||void 0===e||e.onDocChanged()}})),(0,eN.a)(t,o7)&&!o&&(o=!0,requestAnimationFrame(function(){if(!n){var e;o=!1,null===(e=o9.ref(l))||void 0===e||e.onExpandRequested()}}))},mount:function(){t||(t=!0,requestAnimationFrame(function(){if(!n){t=!1;var e=l.querySelector("[main-field]");e&&(e.focus(),e.select())}}))},destroy:function(){return n=!0}}}}),eT.$f.of([{win:"Ctrl-h",linux:"Ctrl-h",preventDefault:!0,run:function(e){return!!((0,o$.Ep)(e.state)||(0,o$.nx)(e))&&(e.dispatch({effects:o7.of(null)}),!0)}}])],at=n(50782),an=n(11516),ar=n(92994),ai=n(11570),ao=eT.tk.theme({"&":{contain:"size"},"& > .cm-scroller":{contain:"strict"}}),aa=n(8482),al=n(17491);function ac(e,t,n,r){var i=(0,tz.Z)().showError,o=(0,at.Z)(),a=(0,al.eR)({variables:{replId:o,path:e},onError:function(e){i(e.message)},skip:!r||t});return(0,Y.useMemo)(function(){var r;return t||a.loading||a.error||!a.data||(null===(r=a.data.threadsByFile)||void 0===r?void 0:r.__typename)!=="ThreadsByFileResult"?{}:a.data.threadsByFile.threads.filter(function(t){return t.path===e&&(!n||!t.isResolved)}).reduce(function(e,t){return(0,b._)((0,y._)({},e),(0,ns._)({},t.id,t))},{})},[a.loading,a.data,a.error,e,t,n])}var as=n(23291),au=n(66610),ad=n(96179),af=n(77615),ah=n(41831),ap=n(32377),am=n(39511),av=function(e){var t=e.caretSize,n=void 0===t?[8,12]:t,r=(0,rf._)(e,["caretSize"]);return(0,x.BX)("svg",(0,b._)((0,y._)({width:n[0],height:n[1],viewBox:"0 0 12 8",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r),{children:[(0,x.tZ)("mask",{id:"outline",fill:"white",children:(0,x.tZ)("path",{d:"M0 8L5.2 1.06667C5.6 0.533333 6.40033 0.533776 6.80033 1.06711C8.67223 3.56297 9.93719 5.24959 12 8H0Z"})}),(0,x.tZ)("path",{d:"M0 8L5.2 1.06667C5.6 0.533333 6.40033 0.533776 6.80033 1.06711C8.67223 3.56297 9.93719 5.24959 12 8H0Z",fill:"url(#gradient-fill)"}),(0,x.tZ)("path",{d:"M0 8L-0.8 7.4L-2 9H0V8ZM12 8V9H14L12.8 7.4L12 8ZM5.2 1.06667L4.4 0.466667L5.2 1.06667ZM6.80033 1.06711L6.00033 1.66711L6.80033 1.06711ZM12 7H0V9H12V7ZM0.8 8.6L6 1.66667L4.4 0.466667L-0.8 7.4L0.8 8.6ZM6.00033 1.66711C7.87223 4.16297 9.13719 5.84959 11.2 8.6L12.8 7.4C10.7372 4.64959 9.47223 2.96297 7.60033 0.467109L6.00033 1.66711ZM6 1.66667L6.00033 1.66711L7.60033 0.467109C6.80082 -0.598902 5.20049 -0.600655 4.4 0.466667L6 1.66667Z",fill:"#0079F2",mask:"url(#outline)"}),(0,x.tZ)("defs",{children:(0,x.BX)("linearGradient",{id:"gradient-fill",x1:"5.07692",y1:"0",x2:"5.07692",y2:"21.3333",gradientUnits:"userSpaceOnUse",children:[(0,x.tZ)("stop",{stopColor:"#57ABFF"}),(0,x.tZ)("stop",{offset:"1",stopColor:"#0079F2"})]})})]}))},ag=n(24837),ay=n(39327),ab=n(59725),aZ=n(30456),aw=n(46056),ax=n(43704),aC=n(15542),a_=n(12435),aS=n(93049),aE=n(87599),ak=n(82104),aT=n(35972),aR=n(21371),aD=n(67795),aI=n(50220),aG=function(e){var t,n,r=e.isCreating,i=e.threadId,o=e.filePath,a=e.isResolved,l=e.isLoading,c=e.isPlaceholder,s=e.caretPosition,u=e.onRequestClose,d=e.onResolveThread,f=e.openThreadsInbox,h={viewAll:"Inbox",next:"Next thread",previous:"Previous thread",dismiss:"Collapse"},p=ac(null===o?"":o,l,!0,!0),m=(0,G.Gn)("fontSize").preferences.fontSize,v=[12,8];switch(m){case 10:v=[8,6];break;case 14:v=[10,6];break;case 18:v=[12,8];break;case 24:v=[14,10]}var g=(0,Y.useMemo)(function(){return Object.values(p).sort(function(e,t){return e.indexStart-t.indexStart})},[p]),y=(0,Y.useMemo)(function(){return g.findIndex(function(e){return e.id===i})},[g,i]),b=(0,ay.a9)(),Z=(t=(0,eS._)(function(){return(0,ek.Jh)(this,function(e){return b(y===g.length-1?g[0].id:g[y+1].id),[2]})}),function(){return t.apply(this,arguments)}),w=(n=(0,eS._)(function(){return(0,ek.Jh)(this,function(e){return b(0===y?g[g.length-1].id:g[y-1].id),[2]})}),function(){return n.apply(this,arguments)});return(0,x.BX)(tv.Tg,{background:"root",css:[eo.l0.flex.row,eo.l0.align.center,eo.l0.justify.spaceBetween,eo.l0.position.relative,eo.l0.px(12),eo.l0.py(8),{borderBottomWidth:eo.TV.borderWidthDefault,borderBottomStyle:"solid",borderBottomColor:eo.TV.outlineDimmest}],children:[null!==s&&(0,x.tZ)("span",{css:[eo.l0.position.absolute,eo.l0.top(-v[1]),eo.l0.left(s),eo.l0.height("fit-content"),eo.l0.display.flex,eo.l0.flex.row,eo.l0.align.center],children:(0,x.tZ)(av,{caretSize:v})}),(0,x.tZ)(i5.zx,{iconLeft:(0,x.tZ)(ak.Z,{}),onClick:function(){f()},text:h.viewAll,size:"small"}),g.length>1?(0,x.BX)(en.G,{css:[eo.l0.flex.row,eo.l0.align.center,eo.l0.rowWithGap(4)],children:[(0,x.tZ)(i6.hU,{alt:h.previous,onClick:w,children:(0,x.tZ)(ah.Z,{})}),(0,x.BX)(nQ.xv,{color:"dimmest",variant:"small",multiline:!1,children:[y+1,"/",g.length]}),(0,x.tZ)(i6.hU,{alt:h.next,onClick:Z,children:(0,x.tZ)(af.Z,{})})]}):null,(0,x.BX)(en.G,{css:[eo.l0.flex.row,eo.l0.align.center,eo.l0.rowWithGap(4)],children:[r||a||c?null:(0,x.tZ)(i5.zx,{onClick:void 0===d?function(){}:d,text:"Resolve",size:"small",iconLeft:(0,x.tZ)(ap.Z,{})}),!r&&a?(0,x.tZ)(as.D,{text:"Resolved",colorway:"positive"}):null,(0,x.tZ)(i5.zx,{onClick:void 0===u?function(){}:u,text:h.dismiss,size:"small",iconLeft:(0,x.tZ)(aE.Z,{})})]})]})},aB=function(e){var t,n,r=e.threadId,i=e.isResolved,o=e.onMessageChange,a=e.onMessageSubmit,l=e.isPlaceholder,c=e.onRequestClose,s=void 0===c?function(){}:c,u=(0,Z._)((0,Y.useState)(""),2),d=u[0],f=u[1],h=(0,Z._)((0,Y.useState)(ic().v4()),2),p=h[0],m=h[1],v=(0,ax.Z)(),g=v.ref,w=v.update,C=(0,Y.useRef)(null),_={input:{placeholder:function(){return l?"Start a new thread (Markdown is supported)":i?"Reply to re-open thread":"Reply (Markdown is supported)"}},submit:"Post reply",cancel:"Cancel"},S=function(){var e=d.trim();0!==e.length&&(a({message:e,messageId:p}),f(""),m(ic().v4()))},E=(0,aC.d)(),k=(0,aZ.Z)(),T=(0,Z._)((0,a_.Z)({"@":(t=(0,eS._)(function(e){var t,n;return(0,ek.Jh)(this,function(r){return t=k.filter(function(e){return e.id!==E}),e&&(n=e.toLowerCase(),t=t.filter(function(e){return e.username.toLowerCase().startsWith(n)})),[2,t.slice(0,5).map(function(e){return{icon:(0,x.tZ)(aw.Z,{username:e.username,fullName:e.fullName,url:e.image,style:{height:"24px",width:"24px",minWidth:"24px",minHeight:"24px"}}),value:e.username}})]})}),function(e){return t.apply(this,arguments)})}),2),R=T[0].suggestions,D=T[1],I=(0,aR.Kb)({items:(null==R?void 0:R.results)||[],defaultHighlightedIndex:0,isOpen:(null!==(n=null==R?void 0:R.results.length)&&void 0!==n?n:0)>0,onSelectedItemChange:function(e){var t=e.selectedItem;if(R&&t){var n=R.applySuggestion({targetValue:d,suggestionValue:t.value}),r=n.fullValue,i=n.cursorIndex;f(r),setTimeout(function(){C.current&&(C.current.setSelectionRange(i,i),C.current.focus(),w())})}}}),G=I.isOpen,B=I.getInputProps,A=I.getMenuProps,P=I.getItemProps,N=I.highlightedIndex,U=I.getComboboxProps;return(0,Y.useEffect)(function(){var e="threads/drafts/".concat(r),t=an.Z.get(e,"string");t&&f(t);var n=C.current;return function(){if(n){var t=n.value;if(0===t.length){an.Z.remove(e);return}an.Z.set(e,t)}}},[r]),(0,x.BX)(tv.Tg,{background:"root",css:[eo.l0.px(12),eo.l0.pb(8),eo.l0.pt(8),{borderTop:"1px solid ".concat(eo.TV.outlineDimmest)}],className:"inline-thread-input",children:[(0,x.BX)("div",(0,b._)((0,y._)({css:[eo.l0.flex.row,eo.l0.align.start,eo.l0.rowWithGap(8),eo.l0.width("full")]},U()),{className:"jsx-45ff32690e481e34",children:[l?(0,x.tZ)(i5.zx,{text:_.cancel,onClick:s}):null,(0,x.BX)("div",{css:[{width:"100%"}],className:"jsx-45ff32690e481e34",children:[(0,x.tZ)(i9.B,(0,y._)({},B({ref:function(e){C.current=e,g(e),D(e)},value:d,onChange:function(e){var t=e.target.value;f(t),o({message:t,messageId:p})},onKeyDown:function(e){!G&&(e.preventDownshiftDefault=!0,"Enter"!==e.key||e.shiftKey||(e.stopPropagation(),e.preventDefault(),S(),requestAnimationFrame(function(){w()})))},onKeyUp:function(e){"Escape"===e.key&&(e.stopPropagation(),e.preventDefault(),s())},placeholder:_.input.placeholder(),css:[eo.l0.height(32),eo.l0.align.start,{resize:"vertical",width:"100%",flexGrow:1}],autoFocus:!0}))),(0,x.tZ)("div",{css:{position:"relative"},className:"jsx-45ff32690e481e34",children:(0,x.tZ)("div",(0,b._)((0,y._)({},A({css:[{position:"absolute",top:eo.TV.space2,overflow:"hidden"},eo.l0.borderRadius(16),eo.l0.shadow(1),eo.l0.backgroundColor.backgroundDefault]})),{className:"jsx-45ff32690e481e34",children:null==R?void 0:R.results.map(function(e,t){return(0,e6.az)("div",(0,b._)((0,y._)({},P({item:e,index:t})),{key:e.value,className:"jsx-45ff32690e481e34"}),(0,x.BX)(aT.Ug,{spacing:2,css:[N===t?eo.l0.backgroundColor.backgroundHighest:null,eo.l0.p(8)],children:[e.icon,(0,x.tZ)("div",{className:"jsx-45ff32690e481e34",children:e.value})]}))})}))})]}),(0,x.tZ)(en.G,{css:[eo.l0.pt(4)],children:(0,x.tZ)(i6.hU,{alt:_.submit,tooltipDelay:"long",onClick:S,children:(0,x.tZ)(am.Z,{})})})]})),(0,x.tZ)(K(),{id:"45ff32690e481e34",children:".inline-thread-input .popover-control-container{-webkit-box-flex:1;-webkit-flex-grow:1;-moz-box-flex:1;-ms-flex-positive:1;flex-grow:1}"})]})},aA=function(e){var t,n,r=e.threadId,i=e.isCreating,o=e.isResolved,a=void 0!==o&&o,l=e.view,c=e.filePath,s=e.openThreadsInbox,u=(0,au.Z)(r,l,c),d=u.thread,f=u.loading,h=u.isPlaceholder,p=u.getLatestAnchor,m=u.updateThread,v=u.changeThreadMessage,g=u.finalizeThreadMessage,y=function(){null==l||l.dispatch({effects:[aI.YM.of(null)]})},b=(0,G.Gn)("fontSize").preferences.fontSize,Z=(0,Y.useRef)(null);(0,ab.Z)(d);var C=p(),_=l&&!f&&"number"==typeof(null==C?void 0:C.indexEnd)&&C.indexEnd<=l.state.doc.length?null===(n=l.coordsAtPos(C.indexEnd))||void 0===n?void 0:n.left:null,S=(null==l?void 0:l.dom.getBoundingClientRect().left)||null,E=b;switch(b){case 10:E=13;break;case 14:E=19;break;case 18:E=25;break;case 24:E=34}var k=(0,tz.Z)().showConfirm,T=(0,at.Z)(),R=(0,Y.useRef)(null),D=function(){R.current&&(R.current.scrollTop=R.current.scrollHeight)};(0,Y.useEffect)(function(){setTimeout(function(){D()},0)},[null==d?void 0:d.messages]);var I=(0,Y.useMemo)(function(){return(null==d?void 0:d.messages)?(0,w._)(d.messages).sort(function(e,t){return Date.parse(e.timeCreated)-Date.parse(t.timeCreated)}):[]},[null==d?void 0:d.messages]),B=(t=(0,Y.useRef)(0),(0,oK.Z)(function(e){var n=e.height;n!==t.current&&(null==l||l.requestMeasure()),t.current=n}));return(0,x.tZ)("div",{css:[eo.l0.width("100%"),eo.l0.backgroundColor.backgroundRoot],children:(0,x.BX)(en.G,{innerRef:(0,aS.l)(Z,B),css:[eo.l0.font.default,{borderTopWidth:eo.TV.borderWidthDefault,borderBottomWidth:eo.TV.borderWidthDefault,borderStyle:"solid",borderColor:eo.TV.accentPrimaryDefault}],children:[h||f?null:(0,x.tZ)(aG,{isCreating:i,isResolved:a,isLoading:f,threadId:r,filePath:c,caretPosition:_&&S?_-S-6:null,isPlaceholder:h,onRequestClose:y,onResolveThread:function(){m({changes:{isResolved:!0}}),k("Thread resolved. You can reopen it from the inbox.")},openThreadsInbox:s}),f&&!h?(0,x.tZ)(en.G,{css:[eo.l0.height(E)],children:(0,x.tZ)(ad.Z,{viewBox:"0 0 400 21",backgroundColor:eo.TV.accentPrimaryDimmest,backgroundOpacity:0,foregroundColor:eo.TV.accentPrimaryDimmest,foregroundOpacity:.2,speed:1,children:(0,x.tZ)("rect",{x:"0",y:"0",width:"100%",height:"100%"})})}):(0,x.BX)(x.HY,{children:[!i&&I.length>0?(0,x.tZ)("div",{css:[eo.l0.px(12),eo.l0.py(12),eo.l0.maxHeight(300),eo.l0.overflowY("auto"),eo.l0.colWithGap(16),eo.l0.fontSize(b)],ref:R,children:I.map(function(e){return(0,x.tZ)(ag.Z,{thread:d,message:e},e.id)})}):null,(0,x.tZ)(aB,{threadId:r,isPlaceholder:h,isResolved:a,onRequestClose:y,onMessageChange:v,onMessageSubmit:function(e){g(e),(0,e3.j)(aD.U3.MESSAGE_SENT,{replId:T,source:"threads",newThread:h})}})]})]})})},aP=function(e){"use strict";(0,t9._)(n,e);var t=(0,t7._)(n);function n(){return(0,eE._)(this,n),t.apply(this,arguments)}var r=n.prototype;return r.compare=function(e){return this==e||this.constructor==e.constructor&&this.eq(e)},r.eq=function(e){return!1},r.destroy=function(e){},n}(e_.uU);aP.prototype.elementClass="",aP.prototype.toDOM=void 0,aP.prototype.mapMode=e_.gc.TrackBefore,aP.prototype.startSide=aP.prototype.endSide=-1,aP.prototype.point=!0;var aN=e_.r$.define(),aU=e_.r$.define(),aO=e_.r$.define({combine:function(e){return e.some(function(e){return e})}}),aL=eT.lg.fromClass(function(){"use strict";function e(t){(0,eE._)(this,e),this.view=t,this.prevViewport=t.viewport,this.dom=document.createElement("div"),this.dom.className="cm-right-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.width="0px",this.dom.style.minHeight=this.view.contentHeight+"px",this.gutters=t.state.facet(aU).map(function(e){return new aW(t,e)});var n=!0,r=!1,i=void 0;try{for(var o,a=this.gutters[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value;this.dom.appendChild(l.dom)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}this.fixed=!t.state.facet(aO),this.fixed&&(this.dom.style.position="sticky",this.dom.style.right="0"),this.syncGutters(!1),t.scrollDOM.insertBefore(this.dom,t.contentDOM.nextSibling)}var t=e.prototype;return t.update=function(e){if(e.viewportChanged){var t=this.view.contentDOM.nextElementSibling;t&&t!==this.dom&&t.classList.contains("cm-minimap-gutter")&&e.view.scrollDOM.insertBefore(this.dom,e.view.contentDOM.nextSibling)}if(this.updateGutters(e)){var n=this.prevViewport,r=e.view.viewport,i=Math.min(n.to,r.to)-Math.max(n.from,r.from);this.syncGutters(i<(r.to-r.from)*.8)}e.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight+"px"),this.view.state.facet(aO)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=e.view.viewport},t.syncGutters=function(e){var t=this,n=this.dom.nextSibling;e&&this.dom.remove();var r=e_.Xs.iter(this.view.state.facet(aN),this.view.viewport.from),i=[],o=this.gutters.map(function(e){return new aF(e,t.view.viewport,-t.view.documentPadding.top)}),a=!0,l=!1,c=void 0;try{for(var s,u=this.view.viewportLineBlocks[Symbol.iterator]();!(a=(s=u.next()).done);a=!0){var d=s.value,f=void 0;if(Array.isArray(d.type)){var h=!0,p=!1,m=void 0;try{for(var v,g=d.type[Symbol.iterator]();!(h=(v=g.next()).done);h=!0){var y=v.value;if(y.type==eT.kH.Text){f=y;break}}}catch(e){p=!0,m=e}finally{try{h||null==g.return||g.return()}finally{if(p)throw m}}}else f=d.type==eT.kH.Text?d:void 0;if(f){i.length&&(i=[]),aX(r,i,d.from);var b=!0,Z=!1,w=void 0;try{for(var x,C=o[Symbol.iterator]();!(b=(x=C.next()).done);b=!0)x.value.line(this.view,f,i)}catch(e){Z=!0,w=e}finally{try{b||null==C.return||C.return()}finally{if(Z)throw w}}}}}catch(e){l=!0,c=e}finally{try{a||null==u.return||u.return()}finally{if(l)throw c}}var _=!0,S=!1,E=void 0;try{for(var k,T=o[Symbol.iterator]();!(_=(k=T.next()).done);_=!0)k.value.finish()}catch(e){S=!0,E=e}finally{try{_||null==T.return||T.return()}finally{if(S)throw E}}e&&this.view.scrollDOM.insertBefore(this.dom,n)},t.updateGutters=function(e){var t=e.startState.facet(aU),n=e.state.facet(aU),r=e.docChanged||e.heightChanged||e.viewportChanged||!e_.Xs.eq(e.startState.facet(aN),e.state.facet(aN),e.view.viewport.from,e.view.viewport.to);if(t==n){var i=!0,o=!1,a=void 0;try{for(var l,c=this.gutters[Symbol.iterator]();!(i=(l=c.next()).done);i=!0)l.value.update(e)&&(r=!0)}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}}else{r=!0;var s=[],u=!0,d=!1,f=void 0;try{for(var h,p=n[Symbol.iterator]();!(u=(h=p.next()).done);u=!0){var m=h.value,v=t.indexOf(m);v<0?s.push(new aW(this.view,m)):(this.gutters[v].update(e),s.push(this.gutters[v]))}}catch(e){d=!0,f=e}finally{try{u||null==p.return||p.return()}finally{if(d)throw f}}var g=!0,y=!1,b=void 0;try{for(var Z,w=this.gutters[Symbol.iterator]();!(g=(Z=w.next()).done);g=!0){var x=Z.value;x.dom.remove(),0>s.indexOf(x)&&x.destroy()}}catch(e){y=!0,b=e}finally{try{g||null==w.return||w.return()}finally{if(y)throw b}}var C=!0,_=!1,S=void 0;try{for(var E,k=s[Symbol.iterator]();!(C=(E=k.next()).done);C=!0){var T=E.value;this.dom.appendChild(T.dom)}}catch(e){_=!0,S=e}finally{try{C||null==k.return||k.return()}finally{if(_)throw S}}this.gutters=s}return r},t.destroy=function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this.gutters[Symbol.iterator]();!(e=(r=i.next()).done);e=!0)r.value.destroy()}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}this.dom.remove()},e}(),{provide:function(e){return eT.tk.scrollMargins.of(function(t){var n=t.plugin(e);return n&&0!=n.gutters.length&&n.fixed?t.textDirection==eT.Nm.LTR?{left:n.dom.offsetWidth}:{right:n.dom.offsetWidth}:null})}});function aM(e){return Array.isArray(e)?e:[e]}function aX(e,t,n){for(;e.value&&e.from<=n;)e.from==n&&t.push(e.value),e.next()}var aF=function(){"use strict";function e(t,n,r){(0,eE._)(this,e),this.gutter=t,this.height=r,this.localMarkers=[],this.i=0,this.cursor=e_.Xs.iter(t.markers,n.from)}var t=e.prototype;return t.line=function(e,t,n){this.localMarkers.length&&(this.localMarkers=[]),aX(this.cursor,this.localMarkers,t.from);var r=n.length?this.localMarkers.concat(n):this.localMarkers,i=this.gutter.config.lineMarker(e,t,r);i&&r.unshift(i);var o=this.gutter;if(0!=r.length||o.config.renderEmptyElements){var a=t.top-this.height;if(this.i==o.elements.length){var l=new aH(e,t.height,a,r);o.elements.push(l),o.dom.appendChild(l.dom)}else o.elements[this.i].update(e,t.height,a,r);this.height=t.bottom,this.i++}},t.finish=function(){for(var e=this.gutter;e.elements.length>this.i;){var t=e.elements.pop();e.dom.removeChild(t.dom),t.destroy()}},e}(),aW=function(){"use strict";function e(t,n){var r=this,i=function(e){r.dom.addEventListener(e,function(r){var i=t.lineBlockAtHeight(r.clientY-t.documentTop);n.domEventHandlers[e](t,i,r)&&r.preventDefault()})};for(var o in(0,eE._)(this,e),this.view=t,this.config=n,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:""),n.domEventHandlers)i(o);this.markers=aM(n.markers(t)),n.initialSpacer&&(this.spacer=new aH(t,0,0,[n.initialSpacer(t)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}var t=e.prototype;return t.update=function(e){var t=this.markers;if(this.markers=aM(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){var n=this.config.updateSpacer(this.spacer.markers[0],e);n!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[n])}var r=e.view.viewport;return!e_.Xs.eq(this.markers,t,r.from,r.to)||!!this.config.lineMarkerChange&&this.config.lineMarkerChange(e)},t.destroy=function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this.elements[Symbol.iterator]();!(e=(r=i.next()).done);e=!0)r.value.destroy()}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}},e}(),aH=function(){"use strict";function e(t,n,r,i){(0,eE._)(this,e),this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(t,n,r,i)}var t=e.prototype;return t.update=function(e,t,n,r){this.height!=t&&(this.dom.style.height=(this.height=t)+"px"),this.above!=n&&(this.dom.style.marginTop=(this.above=n)?n+"px":""),!function(e,t){if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(!e[n].compare(t[n]))return!1;return!0}(this.markers,r)&&this.setMarkers(e,r)},t.setMarkers=function(e,t){for(var n="cm-gutterElement",r=this.dom.firstChild,i=0,o=0;;){var a=o,l=i<t.length?t[i++]:null,c=!1;if(l){var s=l.elementClass;s&&(n+=" "+s);for(var u=o;u<this.markers.length;u++)if(this.markers[u].compare(l)){a=u,c=!0;break}}else a=this.markers.length;for(;o<a;){var d=this.markers[o++];if(d.toDOM){d.destroy(r);var f=r.nextSibling;r.remove(),r=f}}if(!l)break;l.toDOM&&(c?r=r.nextSibling:this.dom.insertBefore(l.toDOM(e),r)),c&&o++}this.dom.className=n,this.markers=t},t.destroy=function(){this.setMarkers(null,[])},e}(),aV=e_.r$.define(),az=e_.r$.define({combine:function(e){return(0,e_.BO)(e,{formatNumber:String,domEventHandlers:{}},{domEventHandlers:function(e,t){var n=Object.assign({},e);for(var r in t)!function(e){var r=n[e],i=t[e];n[e]=r?function(e,t,n){return r(e,t,n)||i(e,t,n)}:i}(r);return n}})}}),aj=function(e){"use strict";(0,t9._)(n,e);var t=(0,t7._)(n);function n(e){var r;return(0,eE._)(this,n),(r=t.call(this)).number=e,r}var r=n.prototype;return r.eq=function(e){return this.number==e.number},r.toDOM=function(){return document.createTextNode(this.number)},n}(aP);function aq(e,t){return e.state.facet(az).formatNumber(t,e.state)}function aY(e){for(var t=9;t<e;)t=10*t+9;return t}aU.compute([az],function(e){return{class:"cm-lineNumbers",renderEmptyElements:!1,markers:function(e){return e.state.facet(aV)},lineMarker:function(e,t,n){return n.some(function(e){return e.toDOM})?null:new aj(aq(e,e.state.doc.lineAt(t.from).number))},lineMarkerChange:function(e){return e.startState.facet(az)!=e.state.facet(az)},initialSpacer:function(e){return new aj(aq(e,aY(e.state.doc.lines)))},updateSpacer:function(e,t){var n=aq(t.view,aY(t.view.state.doc.lines));return n==e.number?e:new aj(n)},domEventHandlers:e.facet(az).domEventHandlers}});var a$=new(function(e){"use strict";(0,t9._)(n,e);var t=(0,t7._)(n);function n(){var e;return(0,eE._)(this,n),e=t.apply(this,arguments),e.elementClass="cm-activeLineGutter",e}return n}(aP));aN.compute(["selection"],function(e){var t=[],n=-1,r=!0,i=!1,o=void 0;try{for(var a,l=e.selection.ranges[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var c=a.value;if(c.empty){var s=e.doc.lineAt(c.head).from;s>n&&(n=s,t.push(a$.range(s)))}}}catch(e){i=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return e_.Xs.of(t)});var aJ=n(11134),aK=n(91433),aQ=function(e){var t=e.isOpen,n=e.threadId,r=(0,Z._)((0,Y.useState)(!1),2),i=r[0],o=r[1],a=(0,aK.GD)({variables:{id:n},skip:"initial-spacer"===n});(0,Y.useEffect)(function(){if(a&&!a.error){var e,t=null===(e=a.data)||void 0===e?void 0:e.thread;t&&o((null==t?void 0:t.__typename)==="AnnotationAnchor"&&(null==t?void 0:t.messages.some(function(e){return!e.seen})))}},[a]);var l={button:{alt:{default:"View threads",close:"Dismiss thread"}}};return(0,x.tZ)(i6.hU,{alt:t?l.button.alt.close:l.button.alt.default,size:24,className:"thread-indicator",css:[eo.l0.width(20),eo.l0.height(20),eo.l0.transition.snappy,eo.l0.cursor.pointer,eo.l0.display.flex,eo.l0.borderRadius(8),eo.l0.position.relative,eo.l0.overflow("visible"),t?eo.l0.color.accentPrimaryStrongest:eo.l0.color.foregroundDimmest,{borderWidth:eo.TV.borderWidthDefault,borderStyle:"solid",borderColor:t?eo.TV.accentPrimaryDefault:"transparent",backgroundColor:t?eo.TV.accentPrimaryDimmer:eo.TV.backgroundHigher,outline:0},{":hover":{borderColor:t?eo.TV.accentPrimaryStronger:eo.TV.outlineDimmer,color:t?eo.TV.accentPrimaryStrongest:eo.TV.foregroundDimmer,background:t?eo.TV.accentPrimaryDefault+" !important":eo.TV.backgroundHighest},svg:{width:12,height:12}}],children:(0,x.BX)(x.HY,{children:[i?(0,x.tZ)("div",{css:[eo.l0.width(8),eo.l0.height(8),eo.l0.backgroundColor.redStronger,eo.l0.position.absolute,eo.l0.top(-1),eo.l0.left(-1),eo.l0.borderRadius("full")]}):null,(0,x.tZ)(aJ.Z,{})]})})};function a0(e,t,n){var r=t.clientWidth,i=n.clientWidth;e.style.maxWidth="".concat(r,"px"),e.style.position="sticky",e.style.zIndex="201",e.style.marginLeft="-".concat(i,"px")}var a1=function(e){"use strict";(0,t9._)(n,e);var t=(0,t7._)(n);function n(e,r,i){var o;return(0,eE._)(this,n),(o=t.call(this)).id=e,o.filePath=r,o.openThreadsInbox=i,o}var r=n.prototype;return r.eq=function(e){return e.id===this.id},r.toDOM=function(e){var t=(0,nJ.VV)((0,x.tZ)(aA,{threadId:this.id,view:e,filePath:this.filePath,openThreadsInbox:this.openThreadsInbox}));t.className="cm-thread-portal-widget";var n=e.dom.querySelector(".cm-scroller"),r=e.dom.querySelector(".cm-gutters");return n&&r&&a0(t,n,r),t},r.ignoreEvent=function(){return!0},n}(eT.l9),a2=function(e){"use strict";(0,t9._)(n,e);var t=(0,t7._)(n);function n(e,r){var i;return(0,eE._)(this,n),(i=t.call(this)).id=e,i.active=r,i}var r=n.prototype;return r.toDOM=function(e){var t=this,n=(0,nJ.VV)((0,x.tZ)(aQ,{isOpen:this.active,threadId:this.id}));return n.className="cm-thread-indicator",n.style.display="inline",n.style.cursor="pointer",n.setAttribute("aria-hidden","true"),n.onclick=function(n){n.stopPropagation(),n.preventDefault(),e.dispatch({effects:[aI.YM.of(e.state.field(aI.PQ)===t.id?null:t.id)]})},n},r.eq=function(e){return e.id===this.id&&e.active===this.active},n}(aP),a8=[(i=[aL],r&&!1===r.fixed&&i.push(aO.of(!0)),i),aU.of((0,y._)({},{class:"",renderEmptyElements:!1,elementStyle:"",markers:function(){return e_.Xs.empty},lineMarker:function(){return null},lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},{class:"cm-thread-indicator-gutter",markers:function(e){var t=e.state.field(aI.OQ),n=e.state.field(aI.PQ);return e_.Xs.of(Object.values(t).filter(function(e){return e.indexEnd!==e.indexStart}).map(function(t){var r=e.state.doc.lineAt(Math.min(t.indexStart,t.indexEnd)).from;return new a2(t.id,t.id===n).range(r)}),!0)},initialSpacer:function(){return new a2("initial-spacer",!1)}}))],a4=n(70671),a3=function(e,t,n,r,i){if(t===n)return null;var o=(0,Z._)(r,2),a=o[0],l=o[1];return eT.p.mark({class:"replit-thread-highlight cm-thread-".concat(e),attributes:{style:"background-color: ".concat(i?l:a)},id:e}).range(t,n)},a5=new tk.j(function(e,t,n){return e&&n?[e_.Wl.highest(a8),aI.cR,aI.OQ,aI.ZS,aI.PQ,eT.tk.decorations.compute([aI.OQ,aI.ZS,aI.PQ],function(e){var n=e.field(aI.OQ),r=e.field(aI.ZS),i=e.field(aI.PQ),o=r||Object.values(n).find(function(e){return e.id===i});return eT.p.set((0,w._)(Object.values(n)).map(function(e){var n=o&&e.id===o.id;return a3(e.id,e.indexStart,e.indexEnd,t,n)}).filter(function(t){return null!==t&&t.from!==t.to&&t.from<=e.doc.length&&t.to<=e.doc.length}),!0)}),eT.tk.decorations.compute([aI.OQ,aI.ZS,aI.PQ,eA.Yp],function(e){var t=e.field(aI.OQ),r=e.field(aI.ZS),i=e.field(aI.PQ),o=e.facet(eA.Yp);if(void 0===o)return eT.p.none;var a=(0,w._)(Object.values(t)).concat((0,w._)(r?[r]:[])).filter(Boolean).find(function(e){return e.id===i});return a?eT.p.set([eT.p.widget({widget:new a1(a.id,o,n),block:!0,side:1}).range(a.indexEnd)],!0):eT.p.none}),eT.tk.updateListener.of(function(e){(0,eD.j)(e,iw.R,function(){var t=(0,w._)(e.view.dom.querySelectorAll(".cm-thread-portal-widget")),n=e.view.dom.querySelector(".cm-scroller"),r=e.view.dom.querySelector(".cm-gutters");if(t.length&&n&&r){var i=!0,o=!1,a=void 0;try{for(var l,c=t[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var s=l.value;a0(s,n,r)}}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}}})}),eT.tk.updateListener.of(function(e){(0,eD.j)(e,aI.eR,function(t){var n=t.value,r=e.state.field(aI.OQ)[n];r&&e.view.dispatch({selection:{anchor:r.indexStart,head:r.indexStart},effects:[eT.tk.scrollIntoView(r.indexStart,{x:"center",y:"center"})]})})})]:null}),a6=n(18059),a9=n(40028),a7=n(77589),le=n(77858),lt=n(9669);function ln(e){return{filePath:e,text:"",selections:[],hasFocus:!1}}function lr(e,t){var n;return null==t?ln(e):{filePath:e,text:null!==(n=t.state.doc.toString())&&void 0!==n?n:"",selections:t.state.selection.ranges.map(function(e){var t=e.from;return{location:t,length:e.to-t}}),hasFocus:t.hasFocus}}function li(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:iZ()(),i=lr(e,t),o={messageType:lt.cF.TEXT_EDITOR_STATE,filePath:e,text:i.text,selections:i.selections,hasFocus:i.hasFocus,hasGhostwriterSuggestion:n.hasGhostwriterSuggestion,revisionId:n.revisionId};(0,a7.bG)(o,r)}function lo(e,t,n,r,i){return r===e&&r===n.textEditorState.filePath&&t===n.textEditorState.filePath&&i===n.revisionId}function la(e){var t=e.map(function(e){return e_.jT.range(e.location,e.location+e.length)});return e_.jT.create(t)}function ll(e,t,n,r,i){var o=i.payload;if((0,lt.Se)(o))return function(e,t,n,r,i){if(!lo(e,t,r,i.filePath,i.revisionId))return!1;var o=la(i.selections);return n.dispatch({selection:o,scrollIntoView:!0}),!0}(e,t,n,r,o);if((0,lt.m7)(o))return function(e,t,n,r,i){if(!lo(e,t,r,i.filePath,i.revisionId))return!1;var o=lr(e,n),a=la(i.selections);return n.dispatch({changes:{from:0,to:o.text.length,insert:i.text},selection:a,scrollIntoView:!0}),!0}(e,t,n,r,o);if((0,lt.ac)(o))return function(e,t,n,r,i){if(!lo(e,t,r,i.filePath,i.revisionId))return!1;var o=i.insertionRange,a=la(i.selections);return n.dispatch({changes:{from:o.location,to:o.location+o.length,insert:i.text},selection:a,scrollIntoView:!0}),!0}(e,t,n,r,o);if((0,lt.fz)(o))return!!lo(e,t,r,o.filePath,o.revisionId)&&(n.dispatch(n.state.replaceSelection(o.text)),!0);if((0,lt.T$)(o))lo(e,t,r,o.filePath,o.revisionId)&&(0,i0.l)({filePath:e,view:n,clipboardText:o.text});else if((0,lt.aB)(o))switch(o.action){case lt.b9.REQUEST_BLUR:return function(e,t,n,r,i,o){if(!lo(e,t,r,i,o))return!1;n.contentDOM.blur()}(e,t,n,r,o.filePath,o.revisionId);case lt.b9.REQUEST_UNDO:return!!lo(e,t,r,o.filePath,o.revisionId)&&((0,Q.Yw)(n),!0);case lt.b9.REQUEST_REDO:return!!lo(e,t,r,o.filePath,o.revisionId)&&((0,Q.KX)(n),!0);case lt.b9.REQUEST_INDENT_SELECTION:return!!lo(e,t,r,o.filePath,o.revisionId)&&(Q.at(n),!0);case lt.b9.REQUEST_DEDENT_SELECTION:return!!lo(e,t,r,o.filePath,o.revisionId)&&(Q.xi(n),!0);case lt.b9.REQUEST_TOGGLE_COMMENT:return!!lo(e,t,r,o.filePath,o.revisionId)&&(Q.O8(n),!0);case lt.b9.REQUEST_ACCEPT_GHOSTWRITER_SUGGESTION:return!!lo(e,t,r,o.filePath,o.revisionId)&&(0,le.o)(n);case lt.b9.REQUEST_FOCUS:return n.focus(),!0;default:throw Error("Unknown BridgeTextEditorAction.")}else throw Error("Invalid payload.")}var lc=n(26851),ls=new tk.j(function(e){var t=eT.tk.domEventHandlers({scroll:el()(function(t,n){var r=0,i=0,o=!0,a=!1,l=void 0;try{for(var c,s=n.visibleRanges[Symbol.iterator]();!(o=(c=s.next()).done);o=!0){var u=c.value;r=Math.min(r,u.from),i=Math.max(r,u.to)}}catch(e){a=!0,l=e}finally{try{o||null==s.return||s.return()}finally{if(a)throw l}}e("user:scroll",{visibleLines:{from:n.state.doc.lineAt(r).number,to:n.state.doc.lineAt(i).number}})},250)}),n=el()(function(t,n,r){e("user:selection",{inputMethod:r,from:t,to:n})},250);return[t,eT.tk.updateListener.of(function(t){var r=t.transactions,i=!0,o=!1,a=void 0;try{for(var l,c=r[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var s=l.value;s.isUserEvent("input.paste")&&e("user:paste",{}),s.isUserEvent("input.drop")&&e("user:new-drop",{}),s.isUserEvent("move.drop")&&e("user:move-drop",{}),s.isUserEvent("delete.cut")&&e("user:cut",{}),s.isUserEvent("input.complete")&&e("user:complete",{}),s.isUserEvent("select")&&n(s.newSelection.main.from,s.newSelection.main.to,s.isUserEvent("select.pointer")?"pointer":"keyboard"),s.isUserEvent("undo")&&e("user:undo",{}),s.isUserEvent("redo")&&e("user:redo",{})}}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}})]}),lu=n(1323),ld=n(52590),lf=n(67696);function lh(e){var t=e.selection.main.head,n=e.doc.lineAt(t);return{offset:t,line:n.number,column:t-n.from+1}}var lp=new tk.j(function(e){return eT.tk.focusChangeEffect.of(function(t,n){var r=t.facet(eA.Yp);return r&&e(r,n?{type:"focus",position:lh(t)}:{type:"blur"}),null})}),lm=new tk.j(function(e){return eT.tk.updateListener.of(function(t){if(t.selectionSet){var n=t.state.facet(eA.Yp);n&&e(n,{type:"update",hasFocus:t.view.hasFocus,position:lh(t.state)})}})}),lv=n(58091),lg=n(68956),ly=n(62808),lb=n(31384),lZ=n(83898),lw=n(17428),lx=n(37054),lC=n(89446),l_=n(32148),lS=n(6191),lE=n(38041),lk=n(45549),lT=n(50586),lR=n(11398),lD=n(5018),lI=new tk.j(function(){return(0,eT.CT)()});function lG(e){var t,n,r,i,o,a,l,c,s,u,d,f,h,p,m,v,g,_,S,E,k,P,N,U,O,L,M,X,F,W,H,j,q,J,K,ee,et,en,er,ei,eo,ea,ec,eu,ed,ef,eh,ep,ev,eg,ey,eZ,ew,ex,eC,eI,eG,eW,eH,eV,ez,ej,eq,eY,e$,eJ,eK,eQ,e0,e1,e8,e4,e5,e6,e9,e7,te,tt,tn,tr,ti,to,ta,tl,tc,ts,tu,td,tf,th,tp,tm,tv,tg,ty,tb,tZ,tw,tx,tC,t_,tS,tE,tk,tI,tG,tA,tP,tN,tU,tO,tL=e.filePath,tM=e.autoFocus,tX=e.isHidden,tF=e.deeplink,tW=e.onDeeplinkUpdated,tY=e.openFile,tJ=e.openThreadsInbox,tK=e.openPane,t0=e.performPaneOperation,t8=(0,tD.Z)(),t4=t8.fs,t9=t8.debuggest,t7=t8.presence,ne=t8.runner,nt=(0,G.Gn)("rulers","minimapDisplay","showLeadingWhitespace","showEnclosedWhitespace","showTrailingWhitespace","showSelectedWhitespace").preferences,nn=(0,oH.Z)(),nr=nn.ref,ni=nn.view;(0,es.VD)(ni),(0,ld.g)(ni);var no=(0,iz.uV)(),na=(0,a6.FS)(),nl=iV.M.use(!!(null==na?void 0:na.match(/Chrome/i))&&!!(null==na?void 0:na.match(/Android/i))),nc=(0,nO.P5)({controlName:"flag-ultra-hardcore",logFlagToAnalytics:!1}),ns="/replEnvironmentDesktop"===z().pathname,nu=(0,Y.useContext)(lg.B3),nd=(0,iz.jT)(),nf=(n=(t={path:tL,isHidden:tX}).path,r=t.isHidden,i=(0,lf.NH)(),o=lp.use(i),a=lm.use(i),(0,Y.useEffect)(function(){i(n,{type:r?"hidden":"unhidden"})},[r,i,n]),(0,Y.useEffect)(function(){return function(){i(n,{type:"unmount"})}},[i,n]),(0,Y.useMemo)(function(){return[o,a]},[o,a])),nh=(s=(l={view:ni,presence:t7,fs:t4,filePath:tL}).view,u=l.presence,d=l.fs,f=l.filePath,h=iX.use(f,d,u),p=iW.use(u),m=(0,ij.Z)().trackTimeToLoadFileEnd,v=(0,iz.uV)(),g=(0,iz.Id)(),_=(0,iz.I7)(),S=(0,Y.useMemo)(function(){return{trackTimeToLoadFileEnd:m,throwBsod:v,setBsodFilePathVersion:g,deleteBsodFilePathVersion:_}},[_,g,v,m]),E=iQ.use(f,d,S),k=null===(c=(0,I.IK)(s,iy.o))||void 0===c||c,P=(0,Y.useMemo)(function(){return[E,h,p]},[E,h,p]),(0,Y.useMemo)(function(){return{isLoading:k,extensions:P}},[k,P])),np=nh.isLoading,nm=nh.extensions;U=(N={view:ni,autoFocus:tM,isLoading:np}).view,O=N.isLoading,L=N.autoFocus,(0,Y.useEffect)(function(){L&&U&&!O&&U.focus()},[U,O,L]),X=(M={view:ni,filePath:tL,isLoading:np}).view,F=M.filePath,W=M.isLoading,H=(0,at.Z)(),j=function(){var e=(0,Y.useContext)(ai.ZP);if(!e)throw Error("Expected codemirror state to be in codemirror state context");return e}(),q=(0,ar.Z)({view:X}),(0,Y.useEffect)(function(){var e,t=function(e){var t,r=j.current.fileMap.get(n),i=null!==(t=null==r?void 0:r.scrollPos)&&void 0!==t?t:0;j.current.fileMap.set(n,{scrollPos:i,editorState:e}),a()};if(X&&!W){var n="".concat(H,":").concat(F),r=j.current.fileMap.get(n);if(r&&X.state.doc.eq(r.editorState.doc)){if(X.state.field(Q.cE,!1))throw Error("History was preconfigured on this view, if you want to use state cache, please make sure history is not already configured for this view");var i=[];(0,C.q2)(r.editorState).between(0,X.state.doc.length,function(e,t){i.push(C.SW.of({from:e,to:t}))}),X.dispatch({effects:(0,w._)(i).concat([eT.tk.scrollIntoView(r.scrollPos,{y:"start"})]),selection:r.editorState.selection}),e=[Q.cE.init(function(){return r.editorState.field(Q.cE)}),(0,Q.m8)()]}else e=(0,Q.m8)();var o=!1,a=el()(function(){var e;(null!==(e=globalThis.requestIdleCallback)&&void 0!==e?e:globalThis.requestAnimationFrame)(function(){an.Z.set("stateCache",(0,ai.oZ)(j.current))})},500),l={read:function(e){if(!o){var t=j.current.fileMap.get(n);if(t){var r=function(e){var t=e.scrollDOM.getBoundingClientRect();if(0===t.top&&0===t.bottom)return null;var n=t.top+e.defaultLineHeight;return e.posAtCoords({x:0,y:n},!1)}(e);null===r||r>t.editorState.doc.length||(j.current.fileMap.set(n,(0,b._)((0,y._)({},t),{scrollPos:r})),a())}}}},c=!1;return X.dispatch({effects:q.reconfigure([e,eT.tk.updateListener.of(function(e){!o&&(t(e.state),c||(c=!0,e.view.requestMeasure(l),setTimeout(function(){return c=!1},500)))})])}),function(){o=!0,X.dispatch({effects:q.reconfigure([])})}}},[X,F,j,W,q]),(0,ly.Y)({view:ni});var nv=(0,lZ.ql)(),ng=(K=(J={filePath:tL,isLoading:np,openFile:tY,askGhostwriter:(0,Y.useCallback)(function(e){tK({type:"ghostwriterChat"}),nv({chatMessage:e})},[nv,tK])}).filePath,ee=J.isLoading,et=J.openFile,en=J.askGhostwriter,er=(0,tD.Z)().fs,ei=(0,t1.Z)(K),eo=(0,G.Gn)("codeIntelligence").preferences,ea=ee||!eo.codeIntelligence||!(null==ei?void 0:ei.isSupportedFile(K)),ec=(0,Y.useMemo)(function(){return new nz.R(ea?[]:function(e,t,n,r,i){if(!t)return[];var o,a,l,c,s,u=[(a=(o={lspClient:t,path:n}).lspClient,l=o.path,eT.lg.define(function(e){var t,n,r,i,o,c,s,u;return n=(t={lspClient:a,path:l,view:e}).lspClient,r=t.path,i=t.view,o=ic().v4(),c=function(){var e;return(null!==(e=is.get(r))&&void 0!==e?e:[])[0]===o},u=null!==(s=is.get(r))&&void 0!==s?s:[],is.set(r,(0,w._)(u).concat([o])),n.notify.didOpen(r,i.state.doc.toString()),{id:o,destroy:function(){var e,t=(null!==(e=is.get(r))&&void 0!==e?e:[]).filter(function(e){return e!==o});n.getServerState()===ia.a.INITIALIZED&&n.isOpen(r)&&n.notify.didClose(r),0===t.length?is.delete(r):is.set(r,t)},update:function(e){if(c()&&e.docChanged){var t,i=null===(t=n.getServerCapabilities())||void 0===t?void 0:t.textDocumentSync;if(i!==ro.TextDocumentSyncKind.None&&n.isOpen(r)){if(i===ro.TextDocumentSyncKind.Full){var o,a,l,s,u=e.view.state.doc.toString();n.notify.didChange(r,[{text:u}]);return}n.notify.didChange(r,(o=e.changes,a=e.startState.doc,l=[],s=a,o.iterChanges(function(e,t,n,r,i){var o=i.sliceString(0),a=t-e,c=a+n;l.push({range:{start:(0,eP.sg)(s,n),end:(0,eP.sg)(s,c)},rangeLength:a,text:o}),s=s.replace(n,c,i)}),l))}}}}})),(0,D.Fq)({lspClient:t,path:n,askGhostwriter:i}),eT.lg.fromClass(function(){"use strict";function n(e){(0,eE._)(this,n),this.dispose=this.listen(e.state.facet(eA.Yp))}var r=n.prototype;return r.update=function(e){(0,eN.a)(e,eA.Yp)&&(this.dispose=this.listen(e.state.facet(eA.Yp)))},r.destroy=function(){this.dispose&&this.dispose()},r.listen=function(n){if(this.dispose&&this.dispose(),n&&(0,nj.Z)(t).isTextDocumentSyncSupported)return e.watchTextFile(n,{onFlush:function(){t.isOpen(n)&&t.notify.didSave(n)}})},n}()),[eL,eF,eT.lg.fromClass(function(){"use strict";function e(n){(0,eE._)(this,e),this.abortController=null;var r=this;this.getSymbolMap=(0,eB.Z)((0,eS._)(function(){var e,i;return(0,ek.Jh)(this,function(o){switch(o.label){case 0:if(!(e=n.state.facet(eA.Yp)))return[2];return r.abortController=new AbortController,[4,function(e,t,n){return eM.apply(this,arguments)}(t,e,r.abortController.signal)];case 1:return i=o.sent(),n.dispatch({effects:eO.of(i)}),[2]}})}),{wait:200}),eU(n.state)&&this.getSymbolMap().catch(eX)}var n=e.prototype;return n.update=function(e){var t;e.docChanged&&eU(e.state)&&(null===(t=this.abortController)||void 0===t||t.abort(),this.getSymbolMap().catch(eX))},n.destroy=function(){var e;null===(e=this.abortController)||void 0===e||e.abort(),this.getSymbolMap.isScheduled()&&this.getSymbolMap.cancel()},e}())]];return(0,id.isMobile)()||u.push(new nz.R(function(e){return function(e){var t=e.lspClient,n=e.view,r=n.state.facet(eA.Yp),i=.01>Math.random(),o=0,a=function(e,n){if(i&&r){var o=t.getLanguageId(r);return rn.kg.info("lsp:autocomplete:".concat(e),(0,y._)({languageId:o},n)),(0,e3.j)(e3.U3.LSP_COMPLETION_USED,(0,y._)({type:e,sampleRate:.01},n))}};function l(){return(l=(0,eS._)(function(e){var i,l,c,s,u;return(0,ek.Jh)(this,function(d){switch(d.label){case 0:if(!(l=t.getServerCapabilities())||!(null==l?void 0:l.completionProvider)||!(c=function(e,t){var n=e.state,r=e.pos;if(e.explicit)return{triggerKind:ro.CompletionTriggerKind.Invoked};var i=n.doc.lineAt(r),o=i.text[r-i.from-1],a=i.text.substring(0,r-i.from);return(null==t?void 0:t.includes(o))?{triggerKind:ro.CompletionTriggerKind.TriggerCharacter,triggerCharacter:o}:a.match(/\w$/)?{triggerKind:ro.CompletionTriggerKind.Invoked}:null}(e,(null==l?void 0:null===(i=l.completionProvider)||void 0===i?void 0:i.triggerCharacters)||[])))return[2,null];if(o&&t.notify.cancelRequest(o),!r)throw Error("path not found");return o=t.generateId(),n.dispatch({effects:[n9.of(null)]}),[4,t.request.completion(r,(0,eP.sg)(e.state.doc,e.pos),c,{id:o})];case 1:if("error"in(s=d.sent())||(u=s.result,e.aborted||!u))return[2,null];return[2,function(e){for(var t=e.context,n=e.items,r=e.client,i=e.path,o=e.trackCompletion,a=0,l=null!==(B=(0,n$.Z)(t.state))&&void 0!==B?B:"unknown",c=(T=n.filter(function(e){return!!e.label}),R=["label","kind"],D=new Set,T.filter(function(e){var t=R.map(function(t){return e[t]}).join("");return!D.has(t)&&(D.add(t),!0)})).map(function(e){var t=e.additionalTextEdits,n={label:e.label,detail:e.detail,apply:function(n,r,a,c){if(e.insertTextFormat===e2.InsertTextFormat.Snippet){var s=[];t&&s.push({changes:t.map(function(e){return rW(n,e)})});var u=new rR(null!==(h=null!==(f=null===(d=e.textEdit)||void 0===d?void 0:d.newText)&&void 0!==f?f:e.insertText)&&void 0!==h?h:e.label);if(e.textEdit&&("range"in e.textEdit)){var d,f,h,p,m=c;a=(p=rF(n.state,e.textEdit.range)).from,c=Math.max(c=p.to,m)}var v=u.apply({view:n,from:a,to:c,path:i,completion:r});n.dispatch.apply(n,(0,w._)(s).concat([v])),o("completion-accepted",{language:l,completionKind:e.kind,insertTextFormat:e.insertTextFormat});return}var g=function(e){var t,n=e.view,r=e.item,i=e.from,o=e.to,a=n.state,l=a.doc,c=a.selection,s=[];if(r.textEdit){if(!("range"in r.textEdit))return;var u=rW(n,r.textEdit);if(!u)return;u.to=Math.max(u.to,c.main.to),s.push(u)}else{var d=r.insertText||r.label,f=n.state.wordAt(o);f&&f.to>o&&d.includes(n.state.doc.sliceString(o,f.to))&&(o=f.to),s.push({from:i,to:o,insert:d})}var h=(0,Z._)(s,1)[0],p="";null===(t=r.additionalTextEdits)||void 0===t||t.forEach(function(e){var t=rW(n,e);t&&(("from"in h)&&t.from===h.from&&(p=t.insert),s.push(t))});var m=o-i;c.ranges.forEach(function(e){if(e!==c.main){if(!("insert"in h)||!h.insert)throw Error("Expected insert in mainChange");var t=e.from-m,n=p+h.insert;s.push({from:t,to:e.to,insert:n})}});var v=s.map(function(e){return("from"in e)&&void 0!==e.to?(0,b._)((0,y._)({},e),{from:Math.min(e.from,e.to),to:Math.max(e.from,e.to)}):e}),g=e_.as.of(v,l.length),w=c.ranges.map(function(e){return e.map(g,0)});return{changes:g,selection:e_.jT.create(w,c.mainIndex)}}({view:n,item:(0,b._)((0,y._)({},e),{additionalTextEdits:t}),to:c,from:a});g&&(o("completion-accepted",{language:l,completionKind:e.kind,insertTextFormat:e.insertTextFormat}),n.dispatch({changes:g.changes,selection:g.selection,annotations:nq.Jv.of(r)}))},type:e.kind&&rX[e.kind],filterText:(e.filterText||e.label).toLowerCase(),sortText:(e.sortText||e.label).toLowerCase()};return r&&(0,nj.Z)(r).isCompletionItemResolveSupported?n.info=(0,eS._)(function(){var n,c,s,u,d;return(0,ek.Jh)(this,function(f){switch(f.label){case 0:return[4,r.request.resolveCompletionItem(e)];case 1:if(c=("cancelled"in(n=f.sent()))&&n.cancelled,s=("result"in n)?n.result:null,c||!s||(s.additionalTextEdits&&(t=s.additionalTextEdits),a++,u=[],s.detail&&s.detail!==e.detail&&s.detail!==e.label&&(d=["```"+(0,rr.extname)(i).slice(1),s.detail,"```"].join("\n"),u.push((0,x.tZ)(rd,{className:"lsp-completion-detail",content:{value:d,kind:"markdown"}},"".concat(a,"-detail")))),s.documentation&&u.push((0,x.tZ)(rd,{content:s.documentation},"".concat(a,"-documentation"))),0===u.length))return[2,null];return o("resolution-presented",{language:l,resolutionSource:"request",completionKind:e.kind}),[2,(0,nJ.VV)((0,x.tZ)("div",{children:u}))]}})}):e.documentation&&(n.info=function(){return e.documentation?(o("resolution-presented",{language:l,resolutionSource:"documentation",completionKind:e.kind}),(0,nJ.VV)((0,x.tZ)("div",{children:(0,x.tZ)(rd,{content:e.documentation})}))):null}),n}),s=((c=c.sort(function(e,t){return e.sortText<t.sortText?-1:e.sortText>t.sortText?1:0})).length%2?c.length-1:c.length)/2,u=0;u<=s;u++){if(0===u&&c[s]){c[s].boost=0;continue}var d=c[s-u];if(d){var f=c[s-u+1],h=f.sortText,p=f.boost,m=void 0===p?0:p;d.boost=d.sortText===h?m:m+1}var v=c[s+u];if(v){var g=c[s+u-1],C=g.sortText,_=g.boost,S=void 0===_?0:_;v.boost=v.sortText===C?S:S-1}}var E=null!==(A=null===(I=c[0])||void 0===I?void 0:I.boost)&&void 0!==A?A:0,k=null!==(P=null===(G=c[c.length-1])||void 0===G?void 0:G.boost)&&void 0!==P?P:0;if(E>99||k<-99)for(var T,R,D,I,G,B,A,P,N,U=99/Math.max(Math.abs(E),Math.abs(k)),O=0;O<c.length;O++)c[O].boost=(null!==(N=c[O].boost)&&void 0!==N?N:0)*U;var L=(0,Z._)(function(e){var t=Object.create(null),n=Object.create(null),r=!0,i=!1,o=void 0;try{for(var a,l=e[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var c=a.value.filterText;t[c[0]]=!0;for(var s=1;s<c.length;s++)n[c[s]]=!0}}catch(e){i=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}var u=rM(t)+rM(n)+"*$";return[RegExp("^"+u),new RegExp(u)]}(c),2),M=L[0],X=L[1],F=t.matchBefore(X),W=t.pos;return F&&(W=F.from),c.length&&o("completion-options-presented",{language:l}),{from:W,options:c,validFor:M}}({context:e,items:Array.isArray(u)?u:u.items,client:t,path:r,trackCompletion:a})]}})})).apply(this,arguments)}return[n4,n6,n7,(0,nq.ys)({defaultKeymap:!1,closeOnBlur:!1,tooltipClass:function(e){return(0,nY.o)(e)?n8:""},addToOptions:[{render:function(e,t){if(!(0,nY.o)(t))return null;var n=document.createElement("div");return n.className="lsp-completion-keyboard-shortcuts",(0,ri.createRoot)(n).render((0,x.tZ)(rt.C,{children:(0,x.tZ)(n2.ZP,{size:"inherit",shortcut:{key:""}})})),n},position:200}],override:[(0,nq.eC)(["LineComment","BlockComment"],function(e){return l.apply(this,arguments)})]}),rH]}({lspClient:t,view:e})}),function(e){var t=e.lspClient,n=e.path,r={current:null};function i(){return(i=(0,eS._)(function(e,i){var a,l,c,s,u,d,f;return(0,ek.Jh)(this,function(h){switch(h.label){case 0:if(s=(null===(l=t.getServerCapabilities())||void 0===l?void 0:null===(a=l.signatureHelpProvider)||void 0===a?void 0:a.triggerCharacters)||[],u=e.field(o,!1),d=e.field(it,!1),!u&&(null==d||!s.includes(d)))return[2,null];return[4,function(e,t,n,r,i){return io.apply(this,arguments)}(e,i,t,n,r)];case 1:if(!(null==(f=h.sent())?void 0:null===(c=f.signatures)||void 0===c?void 0:c.length))return[2,null];return[2,f]}})})).apply(this,arguments)}var o=e_.QQ.define({create:function(){return null},update:function(e,t){return t.isUserEvent("select.pointer")?null:(e&&t.newSelection.main.from!==e.pos&&(e=(0,b._)((0,y._)({},e),{pos:t.newSelection.main.from})),(0,eD.j)(t,r7.effect,function(n){var r=n.value;e=r?{pos:t.newSelection.main.from,help:r,index:0}:null}),(0,eD.j)(t,ie,function(t){var n=t.value;if(e){var r=e.help.signatures.length,i=(r+e.index+n)%r;e=i>=e.help.signatures.length||i<0?null:(0,b._)((0,y._)({},e),{index:i})}}),e)},provide:function(e){var t=function(t){var n=t.state.field(e);if(!n)throw Error("expected nonnull field");var r=ir.create({help:n.help,index:n.index});return{dom:r,update:function(t){ir.update(r,function(r){var i=t.state.field(e);return i&&i!==n?{help:i.help,index:i.index}:r})}}};return eT.hJ.compute([e],function(n){var r=n.field(e);return r?{pos:r.pos,create:t,above:!0}:null})}}),a=eT.lg.define(function(){var e,t=el()((e=(0,eS._)(function(e){var t,n,r;return(0,ek.Jh)(this,function(o){switch(o.label){case 0:if(!(t=e.state.selection.main).empty)return[3,2];return n=e.state.field(r7.state,!1),[4,function(e,t){return i.apply(this,arguments)}(e.state,t.from)];case 1:(r=o.sent())&&!n&&(0,nq._B)(e),e.dispatch({effects:r7.effect.of(r)}),o.label=2;case 2:return[2]}})}),function(t){return e.apply(this,arguments)}),0);return{update:function(e){var n,r;null!==(r=null===(n=e.state.facet(eR.N))||void 0===n?void 0:n.isSignatureHelpSupported)&&void 0!==r&&r&&e.transactions.some(function(e){return e.selection})&&e.state.selection.main.empty&&t(e.view)}}});function l(e,t){var n=e.state.field(r7.state,!1);return"active"!==(0,nq.LR)(e.state)&&null!=n&&("navigate"!==t||n.signatures.length>1)}var c=function(e){return function(t){return!!l(t,"navigate")&&(t.dispatch({effects:ie.of(e)}),!0)}},s=[{key:"ArrowDown",run:c(1)},{key:"ArrowUp",run:c(-1)},{key:"Escape",run:function(e){return!!l(e,"dismiss")&&(e.dispatch({effects:r7.effect.of(null)}),!0)}}];return[o,r7.state,it,a,e_.Wl.high(eT.$f.of(s))]}({lspClient:t,path:n}),(c=null,[(0,eT.bF)((s=(0,eS._)(function(e,n){var r,i,o,a,l,s;return(0,ek.Jh)(this,function(u){switch(u.label){case 0:var d,f;if(!(null!==(f=null===(d=e.state.facet(eR.N))||void 0===d?void 0:d.isHoverSupported)&&void 0!==f&&f)||!(r=e.state.facet(eA.Yp)))return[2,null];i=(0,eP.sg)(e.state.doc,n);try{o=e.state.wordAt(n)}catch(e){return[2,null]}if(c){if(c.from===(null==o?void 0:o.from)&&c.to===(null==o?void 0:o.to))return[2,null];t.notify.cancelRequest(c.id)}return c={id:a=t.generateId(),from:null==o?void 0:o.from,to:null==o?void 0:o.to},[4,t.request.hover(r,i,{id:a})];case 1:if(l=u.sent(),c=null,"error"in l||null===(s=l.result))return[2,null];return[2,function(e){var t,n,r=e.hover,i=e.state,o=e.offset;if((Array.isArray(r.contents)||"string"==typeof r.contents)&&0===r.contents.length)return null;var a="",l=i.doc;if(r.range)t=(0,eP.RL)(l,r.range.start),n=(0,eP.RL)(l,r.range.end),a=l.sliceString(t,n);else if(n=void 0,(t=o)<=i.doc.length){var c=i.wordAt(t);c?(a=l.sliceString(c.from,c.to),t=Math.min(t,c.from),n=c.to):a=l.sliceString(t,t+1)}return{pos:t,end:n,create:function(e){var t=(0,nJ.VV)((0,x.tZ)(rq,{content:r.contents,textHovered:a})),n=function(){e.dispatch({effects:eT.E8})};return t.classList.add("hover-tooltip"),t.style.padding="0",t.addEventListener("mouseleave",n),{dom:t,mount:function(){!function(e,t){t.forEach(function(t){return setTimeout(e,t)})}(function(){(0,eT.E2)(e)},[0,50,200,1e3])},destroy:function(){t.removeEventListener("mouseleave",n)}}},above:!0}}({hover:s,offset:n,state:e.state})]}})}),function(e,t){return s.apply(this,arguments)}),{hideOn:function(e){return!e.annotation(e_.YW.remote)&&!!(e.isUserEvent("input")||e.isUserEvent("delete")||e.isUserEvent("select"))},hoverTime:0}),eT.tk.domEventObservers({mousedown:function(e,t){!(e.target instanceof HTMLElement&&e.target.matches(".cm-tooltip *"))&&(0,eT.Dm)(t.state)&&t.dispatch({effects:eT.E8})},scroll:function(e,t){(0,eT.Dm)(t.state)&&t.dispatch({effects:eT.E8})}})]),(0,iu.D)(t,e),(0,rY.jd)({lspClient:t,openFile:r}),function(e){var t,n=e.lspClient,r=e.path,i=e.openFile;if(!i)return[];var o=e_.Py.define(),a=e_.Py.define();return[eT.tk.updateListener.of((t=(0,eS._)(function(e){var t,i,l,c,s,u,d,f,h,p,m,v,g,y,b,x,C,_,S,E,k,T,R,D,I,G,B,A,P,N,U,O;return(0,ek.Jh)(this,function(L){switch(L.label){case 0:if(!(t=(0,nj.Z)(n)).isFindReferencesSupported&&!t.isFindDefinitionSupported)return[2];i=null,l=!0,c=!1,s=void 0;try{for(u=e.transactions[Symbol.iterator]();!(l=(d=u.next()).done);l=!0){f=d.value,h=!0,p=!1,m=void 0;try{for(v=f.effects[Symbol.iterator]();!(h=(g=v.next()).done);h=!0)(y=g.value).is(rJ.h)&&(i=y.value)}catch(e){p=!0,m=e}finally{try{h||null==v.return||v.return()}finally{if(p)throw m}}}}catch(e){c=!0,s=e}finally{try{l||null==u.return||u.return()}finally{if(c)throw s}}if(!i)return[2];return b=e.state.doc,x=(0,eP.sg)(b,i),C=Promise.all([t.isFindReferencesSupported?n.request.findReferences(r,x,{includeDeclaration:!1}):{result:null},t.isFindDefinitionSupported?n.request.findDefinitions(r,x):{result:null}]),(0,r$.SC)(e.view,C),[4,C];case 1:if(S=(_=Z._.apply(void 0,[L.sent(),2]))[0],E=_[1],"error"in S)throw Error("Something went wrong fetching references: ".concat(S.error.message));if("error"in E)throw Error("Something went wrong fetching definition: ".concat(E.error.message));if(k=S.result,T=E.result,R=(0,rQ.g)(T),D=k&&k.length>0,I=R&&R.length>0,!D&&!I)return(0,rK.J)(e.view,{message:"No references found",offset:i}),e.view.dispatch({effects:a.of(null)}),[2];return G=[],B=[],k&&k.length>0&&(A=G).push.apply(A,(0,w._)(k)),R&&R.length>0&&(P=B).push.apply(P,(0,w._)(R)),N=(0,w._)(G).concat((0,w._)(B)).map(function(e){return n.documentUriToPath(e.uri)}).filter(function(e){return e!==r}),U=(0,w._)(new Set(N)),O=b.toJSON().join("\n"),e.view.dispatch({effects:o.of({references:G,definitions:B,currentFile:r,currentFileContents:O,files:U})}),[2]}})}),function(e){return t.apply(this,arguments)})),e_.QQ.define({create:function(){return null},update:function(e,t){var n=e,r=!0,i=!1,l=void 0;try{for(var c,s=t.effects[Symbol.iterator]();!(r=(c=s.next()).done);r=!0){var u=c.value;u.is(o)&&(n=u.value),u.is(a)&&(n=null)}}catch(e){i=!0,l=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw l}}return n},provide:function(e){return eT.hJ.compute([e],function(t){var n=t.field(e);if(!n)return null;var o=t.selection.asSingle().main;return{pos:o.from,end:o.to,create:function(e){var t=(0,nJ.VV)((0,x.tZ)("div",{children:(0,x.tZ)(r6,(0,b._)((0,y._)({},n),{onClose:function(){e.dispatch({effects:a.of(null)})},jumpToPosition:function(t){if(i){if(t.path!==r){i(t);return}var n=t.line,o=t.col;(0,nM.S)({view:e,line:n,col:o}),e.focus()}}}))}));return t.classList.add("cm-lsp-tooltip"),t.classList.add("replit-tooltip"),t.style.padding="0",{dom:t}}}})}})]}({lspClient:t,path:n,openFile:r}),(0,r9.f)(e,t)),u}(er,ei,K,et,en))},[en,ei,K,er,et,ea]),eu=(0,Y.useMemo)(function(){return new nz.R(function(){return ei?eR.T.of((0,nj.Z)(ei)):null})},[ei]),(0,Y.useEffect)(function(){return!ei||ea?ec.set(null):ei.onServerCapabilitiesChange(function(){eu.set(eR.T.of((0,nj.Z)(ei)))})},[eu,ei,ec,ea]),[eu.extension,ec.extension,(0,D.wB)(ei,eo.codeIntelligence)]),ny=(ef=(ed={debuggest:t9,filePath:tL}).debuggest,eh=ed.filePath,ep=(0,tD.Z)().fs,ev=(0,tR.Z)(),eg=(0,tT.Z)(ef.mainClient),tB.use(eg,ev,eh,ep));(0,nM.Z)({filePath:tL,view:ni,isLoading:np,deeplink:tF,onDeeplinkUpdated:tW});var nb=nH.use((0,em.f6)()),nZ=(ew=(ey={view:ni,filePath:tL}).view,ex=ey.filePath,eC=(0,tD.Z)().fs,eI=(0,em.xZ)(null!==(eZ=null==ew?void 0:ew.state.facet(eA.Yp))&&void 0!==eZ?eZ:null),(0,Z._)((0,l_.L)({accept:[eb.z.Code,lS.FILE],drop:function(e,t){if(ew){var n=t.getClientOffset(),r=n?ew.posAtCoords(n):null;if(null!==r){var i=function(e){ew.focus(),ew.dispatch({changes:{from:r,insert:e},selection:{anchor:r,head:r+e.length}})};if(e.type===eb.z.Code)i(e.code);else{var o=!0,a=!1,l=void 0;try{for(var c,s=e.files[Symbol.iterator]();!(o=(c=s.next()).done);o=!0){var u=c.value;eI?(0,lC.L0)(u).then(function(e){return i('"'+e+'"')}):ex&&(0,$.gK)(ex)&&(0,lE.r)(u,eC,ex).then(i)}}catch(e){a=!0,l=e}finally{try{o||null==s.return||s.return()}finally{if(a)throw l}}}}}}}),2)[1]),nw=(0,t5.Z)({filePath:tL}),nx=(eW=(eG={view:ni,filePath:tL,isLoading:np,enable:ns,openThreadsInbox:tJ}).view,eH=eG.filePath,eV=eG.isLoading,ez=eG.enable,ej=eG.openThreadsInbox,eq=(0,ay.kM)(),(0,Y.useEffect)(function(){eW&&eq&&eW.dispatch({effects:[aI.YM.of(eq),aI.eR.of(eq)]})},[eW,eq]),eY=(0,a4.F)().theme,eJ=(e$=(0,Z._)((0,Y.useState)([ip.TV.accentPrimaryDimmest,ip.TV.accentPrimaryDimmer]),2))[0],eK=e$[1],(0,Y.useEffect)(function(){var e=oT(eY.values.global.accentPrimaryDimmest);eK(["rgba(".concat(e.join(","),", 0.5)"),ip.TV.accentPrimaryDimmer])},[eY]),eQ=ac(eH,eV,!0,ez),e0=(0,tD.Z)().fs,e8=(e1=(0,aa.kL)(eH)).contentRef,e4=e1.loadedFile,e5=e1.transformSelectionRef,(0,Y.useEffect)(function(){var e=!1,t=e5.current,n=e8.current;if(e4&&t&&n&&!eV&&eW){var r=Object.values(eQ);if(0===r.length){eW.dispatch({effects:aI.qi.of({})});return}Promise.all(r.map(function(e){return(0,aa.Ft)({anchor:e,version:e0.getOTVersion(eH),transformSelection:t,content:n})})).then(function(t){if(!e){var n=t.filter(function(e){return!!e}).map(function(e){if(!e)throw Error("expected resolved anchor");return(0,y._)({},e.anchor,null==e?void 0:e.newSelection)});return eW.dispatch({effects:aI.qi.of(n.reduce(function(e,t){return e[t.id]=t,e},{}))}),function(){e=!0,eW&&eW.dispatch({effects:aI.qi.of({})})}}})}},[eQ,eW,e4,e0,e5,e8,eH,eV]),a5.use(ez,eJ,ej));e9=(e6={view:ni,filePath:tL}).view,e7=e6.filePath,te=(0,V.useRouter)(),tt=(0,A.Vg)(te),tn=(0,Y.useRef)({revisionId:iZ()(),textEditorState:ln(e7),hasGhostwriterSuggestion:!1}),tr=(0,Y.useRef)(e7),ti=(0,ar.Z)({view:e9}),(0,Y.useEffect)(function(){if(e9&&tt){var e=lr(e7,e9);tn.current={revisionId:iZ()(),textEditorState:e,hasGhostwriterSuggestion:tn.current.hasGhostwriterSuggestion},li(e7,e9,tn.current);var t=function(t){var n,r=(0,nY.o)(e9.state),i=(null===(n=tn.current)||void 0===n?void 0:n.hasGhostwriterSuggestion)!==r;t.docChanged?(tn.current={revisionId:iZ()(),textEditorState:e,hasGhostwriterSuggestion:r},li(e7,e9,tn.current)):(t.selectionSet||t.focusChanged||i)&&(tn.current={revisionId:tn.current.revisionId,textEditorState:e,hasGhostwriterSuggestion:r},li(e7,e9,tn.current))};return e9.dispatch({effects:ti.reconfigure(eT.tk.updateListener.of(function(e){t(e)}))}),function(){e9.dispatch({effects:ti.reconfigure([])})}}},[e9,e7,ti,tt]),(0,Y.useEffect)(function(){if(e9&&tt){var e=function(e){li(e7,e9,tn.current,e.messageId)},t=function(t){ll(e7,tr.current,e9,tn.current,t)?e(t):(0,a7.pl)(t.messageId)},n=function(t){ll(e7,tr.current,e9,tn.current,t)?e(t):(0,a7.pl)(t.messageId)},r=function(r){try{var i=r.data;if(!(0,lt.CF)(i)||i.protocolVersion!==lt.Wj)return;var o=i.payload;i.messageDirection===lt.s1.TO_NATIVE&&(0,lt.H7)(o)&&(tr.current=o.activePaneFilePath),(0,a7.fp)(r,function(r){var o=r.type;switch(o){case lt.cF.TEXT_EDITOR_STATE_REQUEST:e(i);break;case lt.cF.REQUEST_SET_SELECTION:case lt.cF.REQUEST_REPLACE_SELECTION:case lt.cF.REQUEST_SET_TEXT:case lt.cF.REQUEST_INSERT_TEXT:case lt.cF.REQUEST_PASTE_TEXT:t(i);break;case lt.cF.TEXT_EDITOR_REQUEST_ACTION:n(i);break;default:(0,a9.Z)(o)}})}catch(e){throw Error("Invalid message: ".concat(e))}};return window.addEventListener("message",r),li(e7,e9,tn.current),function(){(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:iZ()(),n={messageType:lt.cF.TEXT_EDITOR_CLOSED,filePath:e};(0,a7.bG)(n,t)})(e7),window.removeEventListener("message",r)}}},[e9,e7,tt]);var nC=(to=(0,lc.K)((0,B.Z)(function(){return{path:tL}},[tL])),ls.use(to)),n_=(tl=(ta={filePath:tL}).filePath,ts=void 0!==(tc=ta.disableDiff)&&tc,td=void 0!==(tu=ta.disableConflicts)&&tu,tf=(0,nO.P5)({controlName:"flag-git-gud",logFlagToAnalytics:!1}),th=(0,nO.P5)({controlName:"flag-git-gud-gutter",logFlagToAnalytics:!1}),tp=(0,nO.P5)({controlName:"flag-editor-git-conflict-markers",logFlagToAnalytics:!1}),tm=(0,tD.Z)().git,ts=!tf||!th||ts,td=!tf||!tp||td,nL.use(tm,void 0===tl?null:tl,ts,td)),nS=(0,A.T3)(),nE=(0,em.xZ)(null!==(tO=null==ni?void 0:ni.state.facet(eA.Yp))&&void 0!==tO?tO:null),nk=oO.use(nE,nS),nT=i0.hx.use(nE,t4),nR=oS.use(nS),nD=oY.use(nt.rulers),nI=(0,a4.F)(),nG=ig.use(nS,nt.minimapDisplay,nI),nB=T.NS.use(ne),nA=(tv={filePath:tL},tg=(0,tD.Z)().container,tb=(ty=(0,tz.Z)()).showError,tZ=ty.showConfirm,tw=(0,tQ.T)(),tx=(0,G.Gn)("indentSize","indentIsSpaces","codeIntelligence").preferences,tC=(0,t1.Z)(tv.filePath),t_=(0,t2.Z)(tC),t3.use(tw,tg,tC,t_,tx.indentIsSpaces,tx.indentSize,tx.codeIntelligence,tv.filePath,function(){return tZ("Formatted ".concat(tv.filePath," successfully"),1500)},function(){return tb("Sorry, formatting ".concat(tv.filePath," failed"),1500)})),nP=(tS=(0,tj.Z)(),tE=(0,tD.Z)().container,tI=(tk=(0,tz.Z)()).showError,tG=tk.showConfirm,tA=tV.ZP.supportsFormatting(tS),tP=(0,tq.Z)({container:tE,service:"format",skip:!tA}).channel,tN=t$.use(tL,tP,tA,tI,tG),(0,Y.useMemo)(function(){return tN},[tN])),nN=(0,nO.P5)({controlName:"flag-editor-visible-whitespace",logFlagToAnalytics:!1}),nU=tH.use(!!nN&&nt.showLeadingWhitespace,!!nN&&nt.showEnclosedWhitespace,!!nN&&nt.showTrailingWhitespace,!!nN&&nt.showSelectedWhitespace),nX=(0,lx.Ls)({path:tL}),nF=(0,lx.fD)({path:tL}),nW=(0,lx.jg)({path:tL}),nK=(0,Y.useCallback)(function(){ni&&nX(ni)},[ni,nX]),nQ=(0,Y.useCallback)(function(){ni&&nW(ni)},[ni,nW]),n0=(0,lk.u)({isMobile:nS,generateCode:nX,filePath:tL,openPane:tK}),n1=(0,Y.useCallback)(function(){tK({type:"ghostwriterChat"})},[tK]),n3=(0,Y.useCallback)(function(e){tK({type:"searchReplace",data:{initialQuery:e}})},[tK]),n5=(0,t6.W)({onEditCode:nQ,onGenerateCode:nK,onReplyInChat:n1}),re=(0,lb.av)(),ra=re.onContextMenu,rl=re.closeContextMenu,rc=re.openContextMenu,rs=(0,Y.useCallback)(function(e){ni&&(0,eT.$1)(ni,e,"context-menu")&&(rl(),e.stopPropagation(),e.preventDefault())},[rl,ni]),ru=(0,lx.aT)({openFile:tY,openSearchAndReplace:n3,path:tL,view:ni,onCommand:function(e){if(ni){var t=ni.state.selection.main.head;if(t){var n=ni.coordsAtPos(t);n&&rc({target:{x:n.left,y:n.top},command:[ru(),e],width:275,onKeyDownHandler:rs})}}}}),rf=(0,Y.useCallback)(function(e){ra(e,{command:ru(),width:275,onKeyDownHandler:rs})},[ru,ra,rs]),rh=(0,Y.useCallback)(function(e,t){rc({target:e,command:[ru(),t],width:275,onKeyDownHandler:rs})},[ru,rs,rc]),rp=lx.pZ.use(nS,rf),rm=lw.t.use(rh),rv=(0,Y.useCallback)(function(e){rc({target:{x:e.right-275,y:e.top},width:275,command:ru(),onKeyDownHandler:rs})},[ru,rs,rc]),rg=(0,lT.W)({editCode:nW,explainCode:nF,generateCode:nX,onMoreClick:rv}),ry=(tU=(0,tj.T)(),oC.use(tU)),rb=(0,nO.P5)({controlName:"flag-problems-pane"}),rZ=nV.y.use(rb),rw=lI.use(),rx=(0,lD.Fs)(t0);return(0,x.tZ)("div",{css:lR.ac,"data-cy":np?"workspace-cm-editor-loading":"workspace-cm-editor-".concat(tL),children:(0,x.tZ)(oE.ZP,{ref:nr,elementRef:nZ,css:lR.Mp,filePath:tL,hideTooltips:tX,extensions:[rp,rm,nm,ny,ng,n0,rw,nk,nl,nR,n_,nG,i0.sy,nT,iV.k,n5,ry,ao,nD,nU,nB,nA,nP,R.er,nC,nw,nx,ae,oW,nb,nS?[]:rg,nf,rZ,rx],onException:function(e){var t,n={filePath:tL,cursorPosition:JSON.stringify(null==nu?void 0:null===(t=nu.get(lv._s))||void 0===t?void 0:t.position),fileVersion:nd({filePath:tL})};if(ni){var r=ni.plugin(iV.k),i=null==r?void 0:r.logs();null==r||r.flush(),n.domText=ni.contentDOM.innerText,n.keystrokes=JSON.stringify(i),n.selection=JSON.stringify(ni.state.selection.main.toJSON()),n.updateDoc=ni.state.doc.sliceString(0)}if(nc){no({error:e,tags:{codemirror:!0},extras:n,origin:"CodemirrorEditor: useEditor/onException"});return}(0,lu.O)(e,{tags:{origin:"CodemirrorEditor: useEditor/onException",codemirror:!0},extras:n})},noHistory:!0})})}var lB=n(21012),lA=n(87959),lP=n(57369),lN=n(19858),lU=(0,n0.X)({base:[eo.l0.backgroundColor.backgroundDefault,eo.l0.color.foregroundDimmer,eo.l0.borderRadius(0),eo.l0.height("auto"),eo.l0.py(8),eo.l0.px(6),{"> div":eo.l0.rowWithGap(4)}]}),lO=function(e){var t=e.css,n=e.innerRef,r=(0,rf._)(e,["css","innerRef"]);return(0,x.tZ)(tv.Tg,{background:"root",children:(0,x.tZ)(i5.zx,(0,y._)({size:"small",css:[lU.base,t],ref:n},r))})};function lL(e){var t,n=e.performPaneOperation,r=(0,lN.Z)((t=(0,eS._)(function(e){var t,n,r,i;return(0,ek.Jh)(this,function(o){switch(o.label){case 0:return[4,e.getRepositoryState()];case 1:if((t=o.sent()).error)return[2,t];if(n=t.type,r=null,!(n!==lP.y5.INITIALIZING))return[3,3];return[4,e.status()];case 2:if((i=o.sent()).error)return[2,i];r=i,o.label=3;case 3:return[2,{branchName:null==r?void 0:r.branch,error:null}]}})}),function(e){return t.apply(this,arguments)})),i=!r||r.error?null:r.branchName;return i?(0,x.tZ)(lO,{onClick:function(){return null==n?void 0:n({operation:"open",pane:{type:"git"}})},text:i,iconLeft:(0,x.tZ)(lA.Z,{color:ip.TV.foregroundDimmer,size:12})}):null}var lM=n(27879),lX=n(63185),lF=n(70408),lW=n(60769),lH=n(40227),lV=n(30983),lz=n(67914),lj=n(50494),lq=n(75582),lY=n(71999),l$="StatusBar",lJ=(0,n0.X)({root:[eo.l0.display.none,(0,ns._)({},eo.nC.max(550,l$),[eo.l0.display.flex])]});function lK(e){var t=e.children;return(0,x.tZ)(en.G,{css:lJ.root,children:t})}var lQ=(0,n0.X)({base:[eo.l0.backgroundColor.backgroundDefault,eo.l0.color.foregroundDimmer,eo.l0.borderRadius(0),eo.l0.height("100%"),eo.l0.py(8),eo.l0.px(12),{"> div":eo.l0.rowWithGap(4)}]}),l0=function(e){var t=e.css,n=e.size,r=(0,rf._)(e,["css","size"]);return(0,x.tZ)(tv.Tg,{background:"default",children:(0,x.tZ)(i6.hU,(0,b._)((0,y._)({css:[lQ.base,t]},r),{size:void 0===n?12:n}))})},l1=(0,n0.X)({root:[eo.l0.display.flex,(0,ns._)({},eo.nC.max(550,l$),[eo.l0.display.none])]});function l2(e){var t=e.children;return(0,x.tZ)(en.G,{css:l1.root,children:t})}var l8=n(21262),l4=n(71440),l3=n(58995);function l5(){var e=(0,l8._)(["\n  query StatusBarGhostwriterCompleteCodeStatus {\n    currentUser {\n      id\n      userSubscriptionType\n    }\n  }\n"]);return l5=function(){return e},e}var l6={},l9=(0,l4.Ps)(l5()),l7=(0,n0.X)({roundedContainer:[{borderBottomLeftRadius:eo.TV.space6}],featureHeader:[eo.l0.rowWithGap(8),eo.l0.align.center],popover:[eo.l0.p(8),eo.l0.borderRadius(8),eo.l0.maxWidth(260),eo.l0.colWithGap(8)],featureTitle:[eo.l0.rowWithGap(4),eo.l0.align.center,eo.l0.flex.growAndShrink(1),eo.l0.fontWeight.medium],enableAutocomplete:[eo.l0.rowWithGap(4),eo.l0.align.center],text:[eo.l0.colWithGap(8)],hint:[eo.l0.rowWithGap(4),eo.l0.align.center]});function ce(e){var t=(0,Y.useId)();return(0,x.BX)(tv.Tg,{css:l7.popover,children:[(0,x.BX)(en.G,{css:l7.featureHeader,children:[(0,x.BX)(en.G,{css:l7.featureTitle,children:[(0,x.tZ)(lz.Z,{color:eo.TV.blurpleDefault}),(0,x.tZ)(nQ.xv,{children:"AI Autocomplete"})]}),(0,x.BX)(en.G,{css:l7.enableAutocomplete,children:[(0,x.tZ)(en.G,{tag:"label",htmlFor:t,children:(0,x.tZ)(nQ.xv,{color:"dimmer",variant:"small",children:"Enable"})}),(0,x.tZ)(lW.X,{id:t,checked:e.checked,onChange:e.onChange})]})]}),(0,x.BX)(en.G,{css:l7.text,children:[(0,x.tZ)(nQ.xv,{color:"dimmer",variant:"small",children:"Suggest lines of code as you type based on existing context."}),(0,x.BX)(en.G,{css:l7.hint,children:[(0,x.tZ)(nQ.xv,{color:"dimmer",variant:"small",children:"Press"}),(0,x.tZ)(ol.bM,{small:!0,keyCombo:"Tab"}),(0,x.tZ)(nQ.xv,{color:"dimmer",variant:"small",children:"to accept result"})]})]})]})}var ct=function(e){var t,n,r,i,o,a,l=e.rounded,c=void 0===l||l,s=(0,G.Gn)("codeSuggestion"),u=s.preferences.codeSuggestion,d=s.update,f=(0,Z._)((0,lY.KO)(lF.t),1)[0],h=(0,Y.useRef)(!0),p=(0,lj.o)("ai-code-completion"),m=(t=(0,y._)({},l6,void 0),l3.a(l9,t)),v=m.data,g=m.loading,b=null==v?void 0:v.currentUser,w=(null==b?void 0:b.userSubscriptionType)===lq.HP.HackerPro,C=(0,Y.useRef)(null),_=!p.isDone&&!w,S=(0,Y.useRef)(!1),E=(0,lM.d)({onOpenChange:function(e){if(e){S.current=!0;return}setTimeout(function(){S.current=!1}),_&&p.setAsDone()}}),k=(0,es.uN)();r=(n={view:k,effect:lX.OK,skip:!_}).view,i=n.skip,o=n.effect,a=(0,oJ.Z)(function(e,t){var n=t.startState.field(lX.WF),r=t.state.field(lX.WF);!n.presented&&r.presented&&(h.current=!1,E.open())}),(0,Y.useEffect)(function(){if(r&&!i){var e=new e_.F6,t=eT.tk.updateListener.of(function(e){(0,eD.j)(e,o,function(t){return a.current(t,e)})});return r.dispatch({effects:e_.Py.appendConfig.of(e.of(t))}),function(){r.dispatch({effects:e.reconfigure([])})}}},[r,i,a,o]);var T=(0,oJ.Z)(E);(0,Y.useEffect)(function(){f.tooltipOpen&&(null==k?void 0:k.hasFocus)&&(h.current=!1,T.current.open())},[f.tooltipOpen,k,T]);var R=(0,x.tZ)(n1.Z,{color:u?eo.TV.blurpleDefault:void 0});return g||p.isLoading?(0,x.BX)(x.HY,{children:[(0,x.tZ)(l2,{children:(0,x.tZ)(lO,{disabled:!0,text:"AI",iconLeft:R,css:c&&l7.roundedContainer})}),(0,x.tZ)(lK,{children:(0,x.tZ)(l0,{disabled:!0,alt:"AI",css:c&&l7.roundedContainer,children:R})})]}):(0,x.BX)(x.HY,{children:[(0,x.BX)(en.G,{innerRef:C,children:[(0,x.tZ)(l2,{children:(0,x.tZ)(lO,{text:"AI",iconLeft:R,css:c&&l7.roundedContainer,onClick:function(){S.current||E.open()}})}),(0,x.tZ)(lK,{children:(0,x.tZ)(lV.u,{tooltip:"AI",placement:"top-start",children:(0,x.tZ)(l0,{alt:"AI",css:c&&l7.roundedContainer,onClick:function(){S.current||E.open()},children:R})})})]}),E.isOpen?(0,x.tZ)(lH.Bf,{placement:"top left",background:"default",triggerRef:C,onOpenChange:E.setOpen,isOpen:E.isOpen,children:(0,x.tZ)(lH.Vq,{role:"dialog","aria-label":"AI Autocomplete",children:(0,x.tZ)(ce,{onChange:function(){d({codeSuggestion:!u}),(0,e3.j)(e3.U3.CODE_SUGGESTION_TOGGLED,{enabled:!u,source:"editor_footer"})},checked:u})})}):null]})},cn=n(10044),cr=n(27783);function ci(e,t,n){var r=[],i=0,o=!0,a=!1,l=void 0;try{for(var c,s=e.iterLines()[Symbol.iterator]();!(o=(c=s.next()).done);o=!0){var u=c.value,d=i;if(i=i+u.length+1,0!==u.length){var f=(0,cr.L)(u,t),h=u.trimStart(),p=d+(u.length-h.length);if(0!==f&&d!==p){var m="";if(n===cn.Q.TABS){var v=Math.floor(f/t),g=f%t;m="	".repeat(v)+" ".repeat(g)}else n===cn.Q.SPACES&&(m=" ".repeat(f));m+h!==u&&r.push({from:d,to:p,insert:m})}}}}catch(e){a=!0,l=e}finally{try{o||null==s.return||s.return()}finally{if(a)throw l}}return e_.as.of(r,e.length)}var co=n(17907),ca=n(68514),cl=n(48272),cc=n(37951),cs=n(26),cu=n(73722),cd=n(58003),cf=n(2532),ch=n(81662),cp=(0,n0.X)({surface:[eo.l0.height("100%")],cursorOverlay:{cursor:"pointer"},menu:[eo.l0.p(8),eo.l0.colWithGap(8),eo.l0.maxWidth(410)],close:[eo.l0.position.absolute,eo.l0.top(4),eo.l0.right(4)],file:[eo.l0.pl(4),eo.l0.display.inlineFlex,eo.l0.rowWithGap(4),eo.l0.align.center,{verticalAlign:"top"}],space:[eo.l0.width(2),eo.l0.color.foregroundDimmer,eo.l0.textAlign.center],section:[eo.l0.rowWithGap(8),eo.l0.align.center,eo.l0.justify.spaceBetween],header:[eo.l0.colWithGap(2),eo.l0.flex.shrink(1)],selects:[eo.l0.rowWithGap(4)],sizeInput:{border:"none"},buttonsGroup:[eo.l0.rowWithGap(8),eo.l0.align.center,eo.l0.justify.spaceBetween],saveButtons:[eo.l0.rowWithGap(4)]});function cm(e){var t,n=e.path,r=e.openSettings,i=(0,G.Gn)("indentDetection","indentSize").preferences,o=(0,es.uN)(),a=(0,I.IK)(o,iy.o),l=null!==a&&!!i.indentDetection&&a,c=(0,I.IK)(o,co.K_),s=(0,I.IK)(o,co.E2),u=(0,I.IK)(o,co.vO),d=null!==(t=(0,I.IK)(o,e_.yy.tabSize))&&void 0!==t?t:i.indentSize,f="	"===(0,I.IK)(o,C.c)?cn.Q.TABS:cn.Q.SPACES,h=(0,Z._)((0,Y.useState)(!1),2),p=h[0],m=h[1],v=(0,Z._)((0,Y.useState)(f),2),g=v[0],_=v[1],S=(0,Z._)((0,Y.useState)(d),2),E=S[0],k=S[1],T=(0,Z._)((0,Y.useState)(!1),2),R=T[0],D=T[1],B=(0,Z._)((0,Y.useState)(!1),2),A=B[0],N=B[1],U=(0,Z._)((0,Y.useState)(!1),2),O=U[0],L=U[1],M=(0,Z._)((0,Y.useState)(!1),2),X=M[0],F=M[1];(0,Y.useEffect)(function(){R||(_(f),k(d))},[f,d,R]),(0,Y.useEffect)(function(){p||(_(f),k(d),D(!1))},[p,f,d]),(0,Y.useEffect)(function(){g===f&&E===d&&D(!1)},[g,E,f,d]),(0,Y.useEffect)(function(){if(A||O||X){var e=setTimeout(function(){N(!1),L(!1),F(!1)},1e3);return function(){return clearTimeout(e)}}},[A,O,X]),l&&p&&m(!1);var W=(0,Y.useCallback)(function(){if(o){var e=ci(o.state.doc,d,f);o.dispatch({changes:e,effects:co.Fm.of(!0)}),L(!0)}},[o,f,d]),H=(0,Y.useCallback)(function(){o&&(o.dispatch({effects:co.Fm.of(!0)}),o.state.field(co.E2)&&o.dispatch({effects:co.O4.of({type:void 0,size:void 0})}),F(!0))},[o]),V=(0,Y.useCallback)(function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(o){var t=void 0,n=[co.O4.of({type:g,size:E})];if(e){if(g!==f&&(t=ci(o.state.doc,d,g)),g===cn.Q.SPACES&&E!==d){var r=function(e,t,n,r){if(t===cn.Q.TABS)return e_.as.empty(e.length);var i=" ".repeat(r),o=[],a=0,l=!0,c=!1,s=void 0;try{for(var u,d=e.iterLines()[Symbol.iterator]();!(l=(u=d.next()).done);l=!0){var f=u.value,h=a;if(a=a+f.length+1,0!==f.length){var p=(0,cr.L)(f,n),m=f.trimStart(),v=h+(f.length-m.length);if(0!==p&&h!==v){var g=Math.floor(p/n),y=p%n,b=i.repeat(g)+" ".repeat(y);b+m!==f&&o.push({from:h,to:v,insert:b})}}}}catch(e){c=!0,s=e}finally{try{l||null==d.return||d.return()}finally{if(c)throw s}}return e_.as.of(o,e.length)}(t?t.apply(o.state.doc):o.state.doc,g,d,E);t=t?t.compose(r):r}t&&n.push(co.Fm.of(!0))}o.dispatch({changes:t,effects:n}),D(!1),N(!0)}},[o,f,d,g,E]),z=(0,Y.useCallback)(function(){m(!1),r()},[r]),j=(0,Y.useMemo)(function(){if(s){var e=s.size,t=s.type===cn.Q.SPACES?"spaces":"tabs";return"This file appears to use a unit of ".concat(e," ").concat(t,".")}return u?"Indentation detection hasn't been run on this file yet.":"This file is too small for indentation detection."},[s,u]),q=(0,Y.useMemo)(function(){var e=[eo.l0.p(4),eo.l0.rowWithGap(4),eo.l0.align.center,eo.l0.borderRadius(0)];return p?(e.push({pointerEvents:"none"}),e.unshift(e9.gU.filled)):e.unshift(e9.gU.nofill),(0,e6.iv)(e)},[p]);return(0,x.BX)(lH.xo,{label:"File indentation",placement:"top",isOpen:p,onOpenChange:m,children:[function(e){return(0,x.tZ)(lV.u,{tooltip:"File indentation",isDisabled:p,children:(0,x.tZ)("div",{css:cp.cursorOverlay,children:(0,x.BX)(en.K.button,(0,b._)((0,y._)({},e),{ref:e.ref,css:q,children:[(0,x.tZ)(cg,{type:f,loading:l}),(0,x.tZ)(cy,{type:f,size:d,loading:l})]}))})})},(0,x.BX)(en.G,{css:cp.menu,children:[(0,x.tZ)(en.G,{css:cp.close,children:(0,x.tZ)(i6.hU,{alt:"Close",onClick:function(){return m(!1)},children:(0,x.tZ)(r8.Z,{})})}),(0,x.BX)(nQ.h4,{level:1,children:["Indentation for",(0,x.BX)("span",{css:cp.file,children:[(0,x.tZ)(P.Z,{path:n,size:16})," ",(0,x.tZ)("span",{children:(0,$.UO)(n)})]})]}),c?(0,x.tZ)(cc.E,{colorway:"warning",icon:(0,x.tZ)(oa.Z,{}),text:"This file type requires that ".concat(c===cn.Q.SPACES?"spaces":"tabs"," be used for indentation.")}):null,(0,x.tZ)(ca.R,{}),(0,x.BX)(en.G,{css:cp.section,children:[(0,x.BX)(en.G,{css:cp.header,children:[(0,x.tZ)(nQ.xv,{multiline:!1,children:"Indentation unit"}),(0,x.tZ)(nQ.xv,{variant:"small",color:"dimmer",children:"The size and character to use when indenting lines."})]}),(0,x.BX)(en.G,{css:cp.selects,children:[(0,x.tZ)(ch.qm,{css:cp.sizeInput,size:E,onChange:function(e){e!==E&&(k(e),D(!0))}}),(0,x.tZ)(cl.P,{items:(0,w._)(ch.Ly),selectedItem:ch.Ly.find(function(e){return e.value===(g===cn.Q.SPACES?"spaces":"tabs")}),onChange:function(e){var t=(null==e?void 0:e.value)==="spaces"?cn.Q.SPACES:cn.Q.TABS;t!==g&&(_(t),D(!0))}})]})]}),(0,x.tZ)(ca.R,{}),i.indentDetection?(0,x.BX)(x.HY,{children:[(0,x.BX)(en.G,{css:cp.section,children:[(0,x.BX)(en.G,{css:cp.header,children:[(0,x.tZ)(nQ.xv,{multiline:!1,children:"Detected indentation unit"}),(0,x.tZ)(nQ.xv,{variant:"small",color:"dimmer",children:j})]}),X?(0,x.tZ)(i5.zx,{colorway:"positive",text:"Detected!",iconLeft:(0,x.tZ)(ap.Z,{}),onClick:H}):(0,x.tZ)(i5.zx,{text:s?"Re-detect":"Detect",iconLeft:(0,x.tZ)(cu.Z,{}),disabled:!u&&!s,onClick:H})]}),(0,x.tZ)(ca.R,{})]}):null,(0,x.BX)(en.G,{css:cp.buttonsGroup,children:[(0,x.tZ)(i5.zx,{text:"Global settings",iconLeft:(0,x.tZ)(cd.Z,{}),onClick:z}),(0,x.tZ)(en.G,{css:cp.saveButtons,children:A||O?(0,x.tZ)(x.HY,{children:A?(0,x.tZ)(i5.zx,{text:"Saved!",colorway:"positive",iconLeft:(0,x.tZ)(ap.Z,{}),onClick:function(){return V(!1)}}):(0,x.tZ)(i5.zx,{text:"Re-indented!",colorway:"positive",iconLeft:(0,x.tZ)(ap.Z,{}),onClick:W})}):(0,x.tZ)(x.HY,{children:R?(0,x.BX)(x.HY,{children:[(0,x.tZ)(i5.zx,{text:"Save and re-indent",colorway:"primary",iconLeft:(0,x.tZ)(cf.Z,{}),onClick:function(){return V(!0)}}),(0,x.tZ)(i5.zx,{text:"Save",iconLeft:(0,x.tZ)(ap.Z,{}),onClick:function(){return V(!1)}})]}):(0,x.tZ)(i5.zx,{text:"Re-indent file",iconLeft:(0,x.tZ)(cf.Z,{}),onClick:W})})})]})]})]})}function cv(e){var t=e.size,n=void 0===t?16:t,r=(0,rf._)(e,["size"]);return(0,x.tZ)(cs.Z,(0,b._)((0,y._)({size:n},r),{children:(0,x.tZ)("circle",{cx:n,cy:n,r:n/2,fillRule:"evenodd"})}))}function cg(e){var t=e.type;return e.loading?(0,x.tZ)(W.Z,{size:12}):t===cn.Q.SPACES?(0,x.tZ)(cv,{color:eo.TV.foregroundDimmer,size:12}):(0,x.tZ)(cf.Z,{color:eo.TV.foregroundDimmer,size:12})}function cy(e){var t=e.type,n=e.size;if(e.loading)return(0,x.tZ)(nQ.xv,{variant:"small",color:"dimmest",children:"Detecting..."});var r=t===cn.Q.SPACES?"Spaces":"Tabs";return(0,x.BX)(nQ.xv,{variant:"small",color:"dimmer",children:[r,": ",n]})}var cb=n(31405),cZ=(0,n0.X)({iconButtonToggled:[eo.l0.backgroundColor.accentPrimaryDimmer,{"&&:hover":[eo.l0.backgroundColor.accentPrimaryDefault]}]});function cw(){var e=(0,es.uN)(),t=(0,I.IK)(e,nN);if(!e||!t||null===t.head)return null;var n=t.mode===f.INLINE_DIFF,r=function(){e.dispatch({effects:nP.of(n?f.GUTTER_DIFF:f.INLINE_DIFF)})};return(0,x.BX)(x.HY,{children:[(0,x.tZ)(l2,{children:(0,x.tZ)(lO,{text:n?"Diffing":"Diff",colorway:n?"primary":void 0,iconLeft:(0,x.tZ)(cb.Z,{}),onClick:r})}),(0,x.tZ)(lK,{children:(0,x.tZ)(lV.u,{tooltip:"Toggle Diff",placement:"top-start",children:(0,x.tZ)(l0,{css:n&&cZ.iconButtonToggled,alt:"Toggle Diff",onClick:r,colorway:n?"primary":void 0,children:(0,x.tZ)(cb.Z,{color:n?ip.TV.foregroundDefault:void 0})})})})]})}var cx=n(73164),cC=n(11718),c_=n(49615),cS=n(11470),cE=n(90648),ck=n(99071),cT=n(44471),cR=(0,n0.X)({surface:[eo.l0.height("100%")],cursorOverlay:{cursor:"pointer"},menu:[eo.l0.p(8),eo.l0.colWithGap(8),eo.l0.maxWidth(390),eo.l0.minWidth(390)],close:[eo.l0.position.absolute,eo.l0.top(4),eo.l0.right(4)],file:[eo.l0.pl(4),eo.l0.display.inlineFlex,eo.l0.rowWithGap(4),eo.l0.align.center,{verticalAlign:"top"}],space:[eo.l0.width(2),eo.l0.color.foregroundDimmer,eo.l0.textAlign.center],section:[eo.l0.rowWithGap(8),eo.l0.align.center,eo.l0.justify.spaceBetween],header:[eo.l0.colWithGap(2),eo.l0.flex.shrink(1)],selects:[eo.l0.rowWithGap(4)],sizeInput:{border:"none"},buttonsGroup:[eo.l0.rowWithGap(8),eo.l0.align.center,eo.l0.justify.spaceBetween],saveButtons:[eo.l0.rowWithGap(4)],red:[eo.l0.color.redDefault],row:[eo.l0.rowWithGap(8),eo.l0.align.center],staticWidth:[eo.l0.flex.grow(0),eo.l0.flex.shrink(1)],variableWidth:[eo.l0.flex.grow(1),eo.l0.flex.shrink(0),{flexBasis:0}],flexEnd:[eo.l0.align.end]});function cD(e){var t,n=(0,es.uN)(),r=null==n?void 0:null===(t=n.state)||void 0===t?void 0:t.facet(eA.Yp);return r?(0,x.tZ)(cI,{fileName:r,openSettings:e.openSettings}):null}function cI(e){var t=e.fileName,n=e.openSettings,r=(0,tD.Z)(),i=r.dotReplit,o=r.lspnix,a=(0,G.Gn)("codeIntelligence").preferences.codeIntelligence,l=(0,es.uN)(),c=(0,Z._)((0,Y.useState)(!1),2),s=c[0],u=c[1],d=(0,t1.Z)(t),f=(0,Z._)((0,Y.useState)(null==d?void 0:d.getServerState()),2),h=f[0],p=f[1],m=(0,Z._)((0,Y.useState)(null==d?void 0:d.getServerHealth()),2),v=m[0],g=m[1],w=(0,Z._)((0,Y.useState)(!1),2),C=w[0],_=w[1],S=(0,Y.useMemo)(function(){var e=[eo.l0.p(4),eo.l0.borderRadius(0),eo.l0.align.center,eo.l0.rowWithGap(4)];return s?(e.unshift(e9.gU.filled),e.push({pointerEvents:"none"})):e.unshift(e9.gU.nofill),(0,e6.iv)(e)},[s]),E=(0,I.IK)(l,eA.Q$),k=(0,Y.useMemo)(function(){var e,n,r,i;return(r=null===(e=cx.$R.from(t))||void 0===e?void 0:e.name)?r:(r=null==E?void 0:null===(n=E.language)||void 0===n?void 0:n.name)&&r.length>0?(i=r).slice(0,1).toUpperCase()+i.slice(1).toLowerCase():(r=(0,$.r6)(t),E)?r:"Plain Text"},[t,E]),R=(0,Y.useMemo)(function(){if(!a)return 6;if(null!==d&&v===ia.N.STALLED)return 3;var e=null!=d&&v===ia.N.READY;return C||h===ia.a.INITIALIZING||h===ia.a.INITIALIZED&&!e?0:e?1:h===ia.a.EXITED?2:null!==E?4:5},[d,C,E,v,h,a]),D=(0,Y.useCallback)(function(){a&&(o.disable(),o.enable(),_(!0))},[o,a]);(0,Y.useEffect)(function(){if(d)return _(!1),p(d.getServerState()),g(d.getServerHealth()),(0,ck.uf)([d.onServerStateChange(function(e){p(e)}),d.onServerHealthChange(function(e){g(e)})])},[d]);var B=(0,I.IK)(l,tK.i5),A=(0,I.IK)(l,tK.dt),N=(0,Z._)((0,Y.useState)(B?{title:B.name,value:B.id}:void 0),2),U=N[0],O=N[1],L=(0,Y.useRef)(!1),M=(0,Y.useMemo)(function(){var e;return null!==(e=null==A?void 0:A.map(function(e){return{title:e.name,value:e.id,icon:void 0}}))&&void 0!==e?e:[]},[A]);(0,Y.useEffect)(function(){L.current||(null==U?void 0:U.value)===(null==B?void 0:B.id)||O(B?{title:B.name,value:B.id}:void 0)},[U,B]);var X=(0,Z._)((0,Y.useState)(!1),2),F=X[0],H=X[1],V=(0,lj.e)("prettier-formatter");return(0,Y.useEffect)(function(){var e,t=null!==(e=null==l?void 0:l.plugin(I.pE))&&void 0!==e?e:null;if(l&&t&&!t.destroyed){var n=null,r=t.bind({changed:function(e){return(0,eN.a)(e,T.pm)},callback:function(e){V.isDone||(n&&"Prettier"===n.name&&(H(!0),u(!0),V.setAsDone()),n=e.state.facet(T.pm))}});return function(){return r()}}},[V,l]),(0,x.BX)(lH.xo,{label:"Language support",placement:"top",isOpen:s,onOpenChange:function(e){u(e),F&&H(!1)},children:[function(e){return(0,x.tZ)(lV.u,{tooltip:"Language support",isDisabled:s,children:(0,x.tZ)("div",{css:cR.cursorOverlay,children:(0,x.BX)(en.K.button,(0,b._)((0,y._)({},e),{css:S,children:[(0,x.tZ)(cP,{state:R}),(0,x.tZ)(cG,{text:k,color:"dimmer",variant:"small"})]}))})})},(0,x.BX)(en.G,{css:cR.menu,children:[(0,x.tZ)(en.G,{css:cR.close,children:(0,x.tZ)(i6.hU,{alt:"Close",onClick:function(){return u(!1)},children:(0,x.tZ)(r8.Z,{})})}),(0,x.BX)(nQ.h4,{level:1,children:["Language support for ",(0,x.BX)("span",{css:cR.file,children:[(0,x.tZ)(P.Z,{path:t,size:16})," ",(0,x.tZ)("span",{children:(0,$.UO)(t)})]})]}),(0,x.tZ)(ca.R,{}),(0,x.tZ)(cA,{client:d,restart:D,state:R,openSettings:n,filePath:t}),A&&U?(0,x.BX)(x.HY,{children:[(0,x.tZ)(ca.R,{}),(0,x.BX)(en.G,{css:cR.section,children:[(0,x.tZ)(en.G,{css:[cR.header,cR.staticWidth],children:(0,x.tZ)(nQ.xv,{multiline:!1,children:"Code Formatter"})}),1===A.length?(0,x.tZ)(en.G,{css:[cR.header,cR.variableWidth,cR.flexEnd],children:(0,x.tZ)(nQ.xv,{multiline:!1,children:U.title})}):(0,x.tZ)(en.G,{css:cR.selects,children:(0,x.tZ)(cl.P,{placement:"top",items:M,selectedItem:(0,b._)((0,y._)({},U),{icon:L.current?(0,x.tZ)(W.Z,{size:12}):void 0}),disabled:L.current,onChange:function(e){e.value!==U.value&&(L.current=!0,O(e),(function(e,t){return cN.apply(this,arguments)})(i,{path:t,formatterId:e.value}).finally(function(){return L.current=!1}))}})})]}),F?(0,x.tZ)(en.G,{css:cR.section,children:(0,x.tZ)(cc.E,{text:"".concat(U.title," was used to format this file. ").concat(A.length>1?"You can change your code formatter with the dropdown above.":""),closable:!0,closeAction:function(){return H(!1)}})}):null]}):null]})]})}function cG(e){var t=e.text,n=(0,rf._)(e,["text"]);return(0,x.tZ)(nQ.xv,(0,b._)((0,y._)({},n),{children:t}))}function cB(e){var t=(0,x.tZ)("a",{tabIndex:0,role:"button",onClick:e.restart,onKeyDown:function(t){"Enter"===t.key&&e.restart()},children:"Restart"});switch(e.state){case 0:return(0,x.tZ)(nQ.xv,{multiline:!1,color:"dimmer",children:"Loading"});case 1:return(0,x.tZ)(nQ.xv,{multiline:!1,color:"dimmer",children:"Active"});case 3:return(0,x.BX)(en.G,{css:cR.row,children:[(0,x.tZ)(nQ.xv,{css:cR.red,multiline:!1,children:"Stalled"})," ",t]});case 2:return(0,x.BX)(en.G,{css:cR.row,children:[(0,x.tZ)(nQ.xv,{css:cR.red,multiline:!1,children:"Stopped"})," ",t]});default:return null}}function cA(e){var t=function(){switch(e.state){case 0:case 1:case 2:case 3:return(0,x.BX)(x.HY,{children:[(0,x.tZ)(en.G,{css:[cR.header,cR.variableWidth],children:(0,x.tZ)(nQ.xv,{multiline:!1,children:e.client?e.client.clientName:"Language Server for ".concat(e.filePath)})}),(0,x.tZ)(en.G,{css:[cR.header,cR.staticWidth],children:(0,x.tZ)(cB,{restart:e.restart,state:e.state})})]});case 5:case 4:return(0,x.tZ)(en.G,{css:cR.header,children:(0,x.tZ)(nQ.xv,{color:"dimmer",children:"Limited language support because the language server is not available."})});case 6:return(0,x.tZ)(en.G,{css:cR.header,children:(0,x.BX)(nQ.xv,{multiline:!0,color:"dimmer",children:["Code intelligence is disabled. Enable it in settings.",(0,x.tZ)("br",{}),(0,x.tZ)("a",{tabIndex:0,role:"button",onClick:e.openSettings,onKeyDown:function(t){"Enter"===t.key&&e.openSettings()},children:"Open settings"})]})});default:return null}}();return t?(0,x.BX)(en.G,{css:cR.section,children:[" ",t," "]}):null}function cP(e){switch(e.state){case 3:case 6:case 4:return(0,x.tZ)(cE.Z,{size:16});case 0:return(0,x.tZ)(W.Z,{size:16,color:eo.TV.blueStronger});case 1:return(0,x.tZ)(en.G,{dataCy:"ws-code-intelligence-active",children:(0,x.tZ)(c_.Z,{size:16})});case 2:return(0,x.tZ)(cS.Z,{size:16});case 5:return(0,x.tZ)(cC.Z,{size:16})}}function cN(){return(cN=(0,eS._)(function(e,t){var n,r;return(0,ek.Jh)(this,function(i){return(n=".".concat((0,cT.mD)(t.path)),r="rules/formatter/fileExtensions/".concat(n,"/id"),t.formatterId)?[2,e.updateDotReplit([{path:"rules/formatter/fileExtensions",op:"add",value:JSON.stringify((0,ns._)({},"".concat(n),{id:t.formatterId}))}])]:[2,e.updateDotReplit([{path:r,op:"remove"}])]})})).apply(this,arguments)}function cU(e){if(e.facet(iy.o))return"";var t=e.selection,n="",r=0;if(t.ranges.length>1){r=t.ranges.reduce(function(e,t){return e+(t.to-t.from)},0);var i=t.ranges.length;n="".concat(i," selections")}else{var o=t.ranges[0],a=e.doc.lineAt(o.head),l=o.head-a.from;r=o.to-o.from,n="Ln ".concat(a.number,", Col ").concat(l+1)}return r>0&&(n+=" (".concat(r," chars)")),n}function cO(){var e,t=(0,Y.useRef)(null),n=(0,es.uN)();return(0,Y.useEffect)(function(){var e,r=t.current,i=null!==(e=null==n?void 0:n.plugin(I.pE))&&void 0!==e?e:null;if(r&&n&&i&&!i.destroyed){var o=null,a=n.state;r.textContent=cU(a);var l=i.bind({changed:function(e){return(0,eN.a)(e,"selection",iy.o)},callback:function(e){a=e.state,null===o&&(o=requestAnimationFrame(function(){o=null,r.textContent=a?cU(a):""}))}});return function(){l(),null!==o&&cancelAnimationFrame(o),r.textContent=""}}},[n]),!n&&(null===(e=t.current)||void 0===e?void 0:e.textContent)&&(t.current.textContent=""),(0,Y.useMemo)(function(){return(0,x.tZ)(lO,{text:(0,x.tZ)("span",{ref:t,"data-cy":"current-position"}),css:[eo.l0.color.foregroundDimmest],onClick:n?function(){return(0,o$.zo)(n)}:void 0})},[n])}(u=g||(g={}))[u.Loading=0]="Loading",u[u.Ready=1]="Ready",u[u.Exited=2]="Exited",u[u.Stalled=3]="Stalled",u[u.Partial=4]="Partial",u[u.Missing=5]="Missing",u[u.Disabled=6]="Disabled";var cL=n(99418),cM=(0,n0.X)({rounded:[{borderBottomRightRadius:ip.TV.space6}]});function cX(e){var t=e.onOpen,n=e.rounded;return(0,x.tZ)(lO,{text:"History",iconRight:(0,x.tZ)(X.Z,{size:12}),onClick:function(){(0,cL.p)("historyOpened"),t()},css:(void 0===n||n)&&cM.rounded})}var cF=n(73157),cW=n(70210),cH=n(34581),cV=(0,n0.X)({group:[eo.l0.align.center,eo.l0.rowWithGap(4)],row:[eo.l0.align.center,eo.l0.rowWithGap(8)]});function cz(){var e,t=(0,es.uN)(),n=null==t?void 0:null===(e=t.state)||void 0===e?void 0:e.facet(eA.Yp);return n?(0,x.tZ)(cj,{fileName:n}):null}function cj(e){var t,n,r,i,o,a,l=e.fileName,c=(0,es.uN)(),s=(n=(t=(0,Z._)((0,Y.useState)(null),2))[0],r=t[1],i=(0,t1.Z)(l),o=(0,cH.nC)(),a=(0,j.dr)(),(0,Y.useEffect)(function(){if(i){var e=function(e){var t,n=o().find(function(e){var t=(0,Z._)(e,2);return"problems"===(t[0],t[1]).type});if(n){var r=a(n[0]);r&&"problems"===r.type&&(null===(t=r.updateProblems)||void 0===t||t.call(r,l,e))}};if(i.isOpen(l)){var t=i.getDiagnostics(l);r(t),e(t)}var n=i.onDiagnostics(function(t){t.path===l&&(r(t.diagnostics),e(t.diagnostics))});return function(){n(),o().some(function(e){var t=(0,Z._)(e,2),n=(t[0],t[1]);return"codeEditor"===n.type&&n.data.path===l})||e([])}}},[i,l,o,a]),n),u=(0,Y.useMemo)(function(){var e;return s?(e=s.reduce(function(e,t){return void 0===t.severity||(e[t.severity]=(e[t.severity]||0)+1),e},{}),s.length>0&&0===Object.keys(e).length&&(e[e2.DiagnosticSeverity.Error]=s.length),e):null},[s]);if(!u)return null;var d=u[e2.DiagnosticSeverity.Error]||0,f=u[e2.DiagnosticSeverity.Warning]||0,h="";return 0===d&&0===f&&(h="No problems"),d>0&&(h+="".concat((0,cF.Z)("Error",d),": ").concat(d)),f>0&&(h.length>0&&(h+=", "),h+="".concat((0,cF.Z)("Warning",f),": ").concat(f)),(0,x.tZ)(lV.u,{tooltip:h,children:(0,x.tZ)(lO,{text:(0,x.BX)(en.G,{css:cV.row,children:[(0,x.BX)(en.G,{css:cV.group,children:[(0,x.tZ)(cW.Z,{severity:e2.DiagnosticSeverity.Error,size:12}),(0,x.tZ)(nQ.xv,{color:"dimmer",variant:"small",multiline:!1,children:String(d)})]}),(0,x.BX)(en.G,{css:cV.group,children:[(0,x.tZ)(cW.Z,{severity:e2.DiagnosticSeverity.Warning,size:12}),(0,x.tZ)(nQ.xv,{color:"dimmer",variant:"small",multiline:!1,children:String(f)})]})]}),disabled:!c,onClick:c?function(){return(0,nV.C)(c)}:void 0})})}var cq=n(85621),cY=(0,n0.X)({text:[{textTransform:"capitalize"}]});function c$(){var e,t,r,i,o=(0,Z._)((0,Y.useState)(null),2),a=o[0],l=o[1],c=(0,Y.useRef)(null),s=(0,es.uN)(),u=(0,G.Gn)("keyboardHandler").preferences,d=(null==u?void 0:u.keyboardHandler)==="vim",f=(0,Y.useCallback)(function(e){if(c.current){var t=null!=e?e:"";if(s&&a&&void 0===e){var n,r,i=a.getCM(s);t=null!==(r=null==i?void 0:null===(n=i.state.vim)||void 0===n?void 0:n.mode)&&void 0!==r?r:"normal"}c.current.innerText!==t&&(c.current.innerText=t||"")}},[s,a]);return(0,Y.useEffect)(function(){d&&!a&&n.e(6689).then(n.bind(n,59290)).then(function(e){l(e),f()})},[d,a,f]),e=[f,d,a],t="ModeStatus",r=(0,Z._)((0,Y.useState)(function(){return new e_.F6}),1)[0],i=(0,oJ.Z)(function(){return d&&a?eT.tk.updateListener.of(function(){setTimeout(function(){f()},0)}):(f(null),null)}),(0,Y.useEffect)(function(){if(s){var e=i.current();if(e){var n=void 0===r.get(s.state)?e_.Py.appendConfig.of(r.of(e)):r.reconfigure(e);try{s.dispatch({effects:n})}catch(e){(0,eT.OO)(s.state,e,t)}return function(){try{s.dispatch({effects:r.reconfigure([])})}catch(e){(0,eT.OO)(s.state,e,t)}}}}},[s,r,i,t].concat((0,w._)(e))),(0,x.tZ)(x.HY,{children:d?(0,x.tZ)(lO,{disabled:!0,iconLeft:(0,x.tZ)(cq.Z,{}),text:(0,x.tZ)("span",{css:cY.text,ref:c})}):null})}var cJ=(0,n0.X)({root:[eo.l0.position.relative,eo.l0.rowWithGap(16),eo.l0.align.center,eo.l0.justify.spaceBetween,eo.l0.backgroundColor.backgroundDefault,eo.l0.container("StatusBar"),{borderTop:"1px solid ".concat(eo.TV.backgroundHigher)},{height:"29px",contain:"strict"}],group:[eo.l0.flex.row,eo.l0.flex.shrink(1),eo.l0.align.center]});function cK(e){var t=e.filePath,n=e.performPaneOperation,r=(0,nO.P5)({controlName:"flag-lsp-diagnostics-in-footer",logFlagToAnalytics:!1}),i=(0,ee.d)(),o=(0,lB.ZP)(),a=(0,nO.P5)({controlName:"flag-status-bar-branch",logFlagToAnalytics:!1}),l=(0,nO.P5)({controlName:"flag-editor-git-inline-diff",logFlagToAnalytics:!1}),c=(0,A.T3)()?void 0:{borderBottomLeftRadius:7,borderBottomRightRadius:7},s=(0,B.Z)(function(){return function(){n({operation:"replace",pane:{type:"history",data:{path:t}}})}},[t,n]),u=(0,B.Z)(function(){return function(){n({operation:"open",pane:{type:"preferences"}})}},[n]);return(0,x.BX)(tv.Tg,{css:cJ.root,style:c,children:[(0,x.BX)(en.G,{css:cJ.group,children:[(0,lB.G_)(o)&&!i?(0,x.tZ)(ct,{}):null,i?null:(0,x.tZ)(cD,{openSettings:u}),!i&&r?(0,x.tZ)(cz,{}):null,a?(0,x.tZ)(lL,{performPaneOperation:n}):null,l?(0,x.tZ)(cw,{}):null,(0,x.tZ)(c$,{})]}),(0,x.BX)(en.G,{css:cJ.group,children:[(0,x.tZ)(cO,{}),(0,x.tZ)(cm,{path:t,openSettings:u}),(0,x.tZ)(cX,{onOpen:s,rounded:!i})]})]})}function cQ(e){var t=(0,eg.Z)(),n=(0,em.xZ)(e.filePath),r=(0,ey.Z)(ev.y.Editor),i=(0,et.Z)(),o=e.performPaneOperation,a=(0,Y.useCallback)(function(e){return o({operation:"open",pane:e,secondary:!0})},[o]);return(0,x.BX)("div",{ref:r,css:{position:"relative",display:"flex",flexDirection:"column",overflowY:"hidden",height:"100%",width:"100%",boxShadow:"".concat(t?"0 3px 0 3px ".concat(t):"0"),borderBottomLeftRadius:"0px",borderBottomRightRadius:"0px"},children:[e.performPaneOperation?(0,x.tZ)(tE,{performPaneOperation:e.performPaneOperation,path:e.filePath}):null,(0,x.BX)("div",{css:lR.ev,children:[(0,x.tZ)(lG,{openPane:a,openFile:e.openFile,openThreadsInbox:e.openThreadsInbox,filePath:e.filePath,autoFocus:e.autoFocus,hideMobileKeyboardToolbar:e.hideMobileKeyboardToolbar,isHidden:e.isHidden,deeplink:e.deeplink,onDeeplinkUpdated:e.onDeeplinkUpdated,performPaneOperation:e.performPaneOperation}),n?(0,x.tZ)(eC,{}):null]}),(0,x.tZ)("div",{css:{display:i?"none":"block"},children:(0,x.tZ)(cK,{filePath:e.filePath,performPaneOperation:e.performPaneOperation})}),e.hideMobileKeyboardToolbar?null:(0,x.tZ)(ep,{filePath:e.filePath,isLoading:!1})]})}var c0=n(80259),c1=(0,n0.X)({root:[eo.l0.coverContainer,eo.l0.center,eo.l0.p(16)]});function c2(e){var t=e.message;return(0,x.tZ)(en.G,{css:c1.root,children:(0,x.tZ)(en.G,{children:(0,x.tZ)(cc.E,{icon:(0,x.tZ)(oa.Z,{}),colorway:"orange",text:t})})})}var c8=n(31171),c4=S.Dy.Object({type:S.Dy.Literal("codeEditor"),data:S.Dy.Object({path:S.Dy.Union([S.Dy.String({minLength:1}),S.Dy.Null()]),line:S.Dy.Optional(S.Dy.Number()),col:S.Dy.Optional(S.Dy.Number())})}),c3={Content:function(e){var t=e.pane,n=e.options;return(0,x.tZ)(c6,(0,b._)((0,y._)({},t.data),{isActive:n.isActive,isHidden:n.isHidden,performPaneOperation:n.performPaneOperation}))},Icon:function(e){var t=e.pane,n=e.size;return(0,x.tZ)(P.Z,{path:t.data.path||"",size:n})},getTitle:function(e){return e.data.path?(0,$.UO)(e.data.path):"No file open"},decode:function(e){return E.B4.Decode(c4,e)}};function c5(e){var t,n,r,i,o,a=e.path,l=e.performPaneOperation,c=(0,es.uN)(),s=(0,B.Z)(function(){return c?{match:c0.pl,data:{type:"action",label:"Toggle all folds",icon:(0,x.tZ)(U.Z,{}),run:function(){0===(0,C.q2)(c.state).size?(0,C.g_)(c):(0,C.jZ)(c)}}}:null},[c]),u=(0,I.IK)(c,k.W),d=(0,I.IK)(c,T.Gz),f=(0,I.IK)(c,T.SD);(0,Y.useEffect)(function(){u&&l({operation:"commit"})},[u,l]);var h=(0,B.Z)(function(){return c&&f?d?{type:"action",icon:(0,x.tZ)(W.Z,{}),label:"Formatting...",run:function(){}}:{dataCy:"ws-format-btn",type:"action",icon:(0,x.tZ)(M.Z,{}),label:"Format "+(0,$.UO)(a),run:function(){(0,T.z1)(c)}}:null},[c,f,d,a]),p=(0,t_.Mp)({path:a,performPaneOperation:l}),m=(t=(0,A.T3)(),r=(n=(0,G.Gn)("minimapDisplay")).preferences.minimapDisplay,i=n.update,(0,B.Z)(function(){return t?null:{match:c0.pl,data:{label:"Minimap",icon:(0,x.tZ)(N.Z,{}),type:"context"},commands:function(e){var t=e.active,n=e.search;return t||n?[{value:"none",label:"Hide",icon:(0,x.tZ)(L.Z,{})},{value:"characters",label:"Characters",icon:(0,x.tZ)(F.Z,{})},{value:"blocks",label:"Blocks",icon:(0,x.tZ)(H.Z,{})}].filter(function(e){return e.value!==r}).map(function(e){return{match:c0.pl,data:{type:"action",label:e.label,icon:e.icon,run:function(){i({minimapDisplay:e.value})}}}}):[]}}},[i,r,t])),v=(o=function(){return l({operation:"replace",pane:{type:"history",data:{path:a}}})},(0,B.Z)(function(){return{match:c0.pl,data:{label:"History",icon:(0,x.tZ)(X.Z,{}),type:"action",run:function(){o()}}}},[o]));return(0,j.L5)(function(){var e,t=function(e){return{label:"Preview",icon:(0,x.tZ)(O.Z,{}),type:"action",run:function(){l({operation:"replace",pane:{type:e,data:{path:a}}})}}};if(c){var n=[];return n.push(v),m&&n.push(m),s&&n.push(s),p&&n.push.apply(n,(0,w._)(p)),h&&(e=[h]),(0,$.B4)(a)&&(e=e&&e.length?[e[0],t("media")]:[t("media")]),(0,$.gK)(a)&&(e=e&&e.length?[e[0],t("markdown")]:[t("markdown")]),{type:"codeEditor",actions:e,commands:n,getEditorView:function(){return c},getCurrentSelectionText:function(){if(!c.state.selection.main.empty)return c.state.sliceDoc(c.state.selection.main.from,c.state.selection.main.to)},insertGhostwriterChatCode:function(e,t){(0,R.el)({view:c,insert:e,overwrite:t})},revertGhostwriterChatCode:function(){(0,R.iG)(c)},fetchProblems:function(){var e;return(0,_.j)(c),null!==(e=c.state.field(D.G0,!1))&&void 0!==e?e:[]}}}},[c,h,s,p,m,v,l,a]),(0,j.Wk)(function(){return c},[c]),null}function c6(e){var t,n,r,i,o=e.path,a=e.line,l=e.col,c=e.isActive,s=e.isHidden,u=e.performPaneOperation,d=(0,Z._)((0,Y.useState)(!s),2),f=d[0],h=d[1];f||s||h(!0);var p=(0,Z._)((0,Y.useState)(function(){return(0,q.MT)()}),1)[0],m=(0,Z._)((0,Y.useState)(function(){return(0,q.MT)()}),1)[0],v=(0,V.useRouter)(),g=!(z().query.embed||z().query.lite)&&!(0,A.Vg)(v)&&c,y=(t=(0,tD.Z)().fs,r=(n=(0,Z._)((0,Y.useState)(null),2))[0],i=n[1],(0,Y.useEffect)(function(){if(o){if(o.startsWith("/"))return i('Cannot open "'.concat(o,'"')),function(){i(null)};var e=t.watchPathStat(o,{onNewStat:function(e){if(!e.exists){i('No file found at "'.concat(o,'", it may have been deleted'));return}if(e.type===iq.Tv.Directory){i('"'.concat(o,'" is a directory'));return}i(null)},onError:function(){i('Unknown error occured while read "'.concat(o,'", try re-opening the editor'))}});return function(){e(),i(null)}}},[t,o]),r),b=(0,B.Z)(function(){return{line:a,col:l}},[a,l]),w=(0,B.Z)(function(){return function(){u({operation:"replace",pane:{type:"codeEditor",data:{path:o}}})}},[u,o]),C=(0,B.Z)(function(){return function(e){u({operation:"commit"}),u({operation:"open",pane:{type:"codeEditor",data:e}})}},[u]),_=(0,Y.useCallback)(function(){u({operation:"open",secondary:!0,pane:{type:"threadInbox"}})},[u]);return o?y?(0,x.tZ)(c2,{message:y}):s&&!f?null:(0,x.tZ)(es.Cl.Provider,{value:p,children:(0,x.BX)(c8.ox.Provider,{value:m,children:[(0,x.tZ)(cQ,{filePath:o,autoFocus:g,isHidden:null!=s&&s,deeplink:b,onDeeplinkUpdated:w,hideMobileKeyboardToolbar:!0,performPaneOperation:u,openFile:C,openThreadsInbox:_},o),(0,x.tZ)(c5,{path:o,isActive:c,performPaneOperation:u})]})}):null}},94255:function(e,t,n){n.d(t,{J:function(){return a}});var r=n(74044),i=n(99149),o=r.Dy.Object({type:r.Dy.Literal("commands"),data:r.Dy.Object({autoFocus:r.Dy.Boolean()})}),a=function(e){return i.B4.Decode(o,e)}},13001:function(e,t,n){n.d(t,{R:function(){return ax}});var r,i,o,a,l,c,s,u,d,f=n(66626),h=n(74985),p=n(74044),m=n(99149),v=n(56596),g=n(88936),y=n(29287),b=n(50959),Z=n(60427),w=n(37996),x=n(27387),C=n(96583),_=n(50782),S=n(37951),E=n(93918),k=n(45087),T=n(7877),R=n(18514),D=n(58003),I=n(20573),G=n(75582),B=n(1498),A=n(93496),P=n(38080),N=n(50494),U=n(14186),O=(0,E.X)({root:[{borderBottom:"1px solid ".concat(y.TV.outlineDimmest)}],inner:[y.l0.position.relative,{"::before":{content:'""',display:"block",position:"absolute",left:0,width:8,height:"100%",background:"linear-gradient(90deg, ".concat(y.TV.backgroundDefault," 0%, rgba(0,0,0,0) 100%);"),zIndex:1},"::after":{content:'""',display:"block",position:"absolute",right:0,width:8,height:"100%",background:"linear-gradient(270deg, ".concat(y.TV.backgroundDefault," 0%, rgba(0,0,0,0) 100%);"),zIndex:1}}],tabs:[y.l0.flex.row,y.l0.align.center,y.l0.overflowX("auto"),y.l0.pl(8)],tab:[A.gU.nofill,y.l0.borderRadius(0),y.l0.px(12),y.l0.position.relative,{transition:"none",height:38,marginRight:1,"::after":{content:'""',display:"block",position:"absolute",right:-2,width:1,height:16,backgroundColor:y.TV.outlineDimmest},"&:last-child":{marginRight:0,"::after":{display:"none"}}}],dot:[y.l0.position.absolute,y.l0.borderRadius(16),y.l0.width(8),y.l0.height(8),y.l0.backgroundColor.accentPrimaryStronger,{top:8,right:8}]}),L=function(e){var t=e.tabs,n=e.activeView,r=e.onClick,i=(0,N.o)("deployment-analytics-dot"),o=i.isLoading,a=i.isDone;return(0,h.tZ)(P.Tg,{css:O.root,children:(0,h.tZ)(v.G,{css:O.inner,children:(0,h.tZ)(v.G,{css:O.tabs,children:t.map(function(e){return(0,h.BX)(v.G,{css:y.l0.position.relative,children:[(0,h.tZ)(B.zx,{style:{borderBottom:"1px solid "+(n===e.view?y.TV.foregroundDefault:"transparent")},css:O.tab,text:e.label,iconLeft:e.icon,onClick:function(){return r(e)}}),e.view!==U.k.Analytics||o||a?null:(0,h.tZ)(v.G,{css:O.dot})]},e.view)})})})})},M=n(41733),X=n(30509),F=n(98924),W=n(92977),H=[y.l0.px(8),y.l0.pt(16)],V=(0,E.X)({root:[H],rootMaxWidth:[H,W.Qw.maxWidth]}),z=function(e){var t=e.children,n=e.maxWidth,r=(0,F._)(e,["children","maxWidth"]);return(0,h.tZ)(v.G,(0,X._)((0,M._)({},r),{css:n?V.rootMaxWidth:V.root,children:t}))},j=n(42516),q=n(26881),Y=n(43312),$=n(70671),J=(0,Y.iv)([y.l0.maxHeight(320),y.l0.minHeight(240),{aspectRatio:"2 / 1"}]);function K(){var e=(0,$.F)().values;return{animation:{duration:0},backgroundColor:e.global.backgroundHigher,borderColor:e.global.outlineDimmer,borderWidth:1,titleFont:{family:"'IBM Plex Sans', sans-serif"},bodyFont:{family:"'IBM Plex Sans', sans-serif"},footerFont:{family:"'IBM Plex Sans', sans-serif"},padding:8,cornerRadius:6}}var Q=n(8279),ee=n(74833),et=n(85289),en=n(21262),er=n(71440),ei=n(58995);function eo(){var e=(0,en._)(["\n  fragment ReplAnalyticsDurationResult on ReplAnalyticsDuration {\n    __typename\n    results {\n      __typename\n      value\n      count\n    }\n  }\n"]);return eo=function(){return e},e}function ea(){var e=(0,en._)(["\n  query ReplAnalyticsDuration(\n    $id: String!\n    $input: ReplAnalyticsDurationInput!\n  ) {\n    repl(id: $id) {\n      ... on Repl {\n        __typename\n        id\n        analyticsDuration(input: $input) {\n          ... on ReplAnalyticsDuration {\n            ...ReplAnalyticsDurationResult\n          }\n          ... on NotFoundError {\n            __typename\n            message\n          }\n          ... on UserError {\n            __typename\n            message\n          }\n        }\n      }\n    }\n  }\n  ","\n"]);return ea=function(){return e},e}var el={},ec=(0,er.Ps)(eo()),es=(0,er.Ps)(ea(),ec),eu=function(e){var t=e.data;q.kL.register(q.ZL);var n=(0,$.F)().values;return(0,h.tZ)(et.$Q,{options:{responsive:!0,maintainAspectRatio:!1,datasets:{bar:{categoryPercentage:1,barPercentage:1}},plugins:{tooltip:K()},scales:{y:{title:{display:!0,text:"# Requests",color:n.global.foregroundDimmer,font:{family:"'IBM Plex Sans', sans-serif"}},ticks:{font:{family:"'IBM Plex Sans', sans-serif"},color:n.global.foregroundDimmer,callback:function(e){if("number"==typeof e&&Math.floor(e)===e)return e}},grid:{color:n.global.outlineDimmest}},x:{title:{font:{family:"'IBM Plex Sans', sans-serif"},display:!0,text:"Duration (ms)",color:n.global.foregroundDimmer},ticks:{autoSkip:!1,maxRotation:20,color:n.global.foregroundDimmer,font:{family:"'IBM Plex Sans', sans-serif"}},grid:{color:n.global.outlineDimmest}}}},data:{labels:t.results.map(function(e){var t=e.value.replace("ms","").split("-"),n=t[t.length-1];return n.includes("s+")?n.replace("s+","000+"):"< "+n}),datasets:[{borderWidth:0,data:t.results.map(function(e){return e.count}),backgroundColor:Array(t.results.length).fill(n.global.tealDefault)}]}})},ed=function(e){var t,n,r,i=e.replId,o=e.start,a=e.hours,l=(0,f._)((0,b.useState)(void 0),2),c=l[0],s=l[1],u=(t=(0,M._)({},el,{variables:{id:i,input:{start:o,hours:a,deployment:!0}},ssr:!1,onCompleted:function(e){if("Repl"===e.repl.__typename)switch(e.repl.analyticsDuration.__typename){case"UserError":case"NotFoundError":s(Error(e.repl.analyticsDuration.message))}}}),ei.a(es,t)),d=u.data,p=u.loading,m=u.error;return m&&s(m),(0,h.BX)(v.G,{css:y.l0.colWithGap(8),children:[(0,h.tZ)(ee.xv,{variant:"subheadDefault",children:"Request Durations (ms)"}),(0,h.BX)(v.G,{children:[p?(0,h.tZ)(v.G,{css:[J,y.l0.borderRadius(8),Q.p.backgroundPulse()]}):null,c?(0,h.tZ)(S.E,{text:c.message,colorway:"negative"}):null,(null==d?void 0:null===(n=d.repl)||void 0===n?void 0:n.__typename)==="Repl"&&(null===(r=d.repl.analyticsDuration)||void 0===r?void 0:r.__typename)==="ReplAnalyticsDuration"?(0,h.tZ)(v.G,{css:J,children:(0,h.tZ)(eu,{data:d.repl.analyticsDuration})}):null]})]})},ef=n(86306),eh=n(56412),ep=n(81995);q.kL.register(q.uw,q.f$,q.od,q.jn,q.u);var em=function(e){var t=e.labels,n=e.datasets,r=e.maintainAspectRatio,i=(0,$.F)().values,o={labels:t.map(function(e){return e.toISOString()}),datasets:n.map(function(e){return(0,X._)((0,M._)({},e),{data:e.data.map(function(e){var t=e.x,n=e.y;return{x:t.toISOString(),y:n}}),pointRadius:.5,tension:.1})})},a=t.length;return(0,h.tZ)(et.x1,{options:{clip:4,interaction:{mode:"nearest",intersect:!1},transitions:{active:{animation:{duration:0}}},elements:{point:{hoverRadius:4},line:{borderWidth:2}},responsive:!0,maintainAspectRatio:void 0===r||r,plugins:{tooltip:(0,X._)((0,M._)({},K()),{callbacks:{title:function(e){var t=new Date(e[0].label);return(0,eh.Z)(t,"MMM d, HH:mm (z)")}}})},scales:{y:{title:{display:!0,text:"# Requests",color:i.global.foregroundDimmer,font:{family:"'IBM Plex Sans', sans-serif"}},grid:{color:i.global.outlineDimmest},ticks:{font:{family:"'IBM Plex Sans', sans-serif"},color:i.global.foregroundDimmer,callback:function(e){if("number"==typeof e&&Math.floor(e)===e)return e}},min:0},x:{title:{display:!0,text:"Time",color:i.global.foregroundDimmer,font:{family:"'IBM Plex Sans', sans-serif"}},grid:{color:i.global.outlineDimmest},ticks:{font:{family:"'IBM Plex Sans', sans-serif"},color:i.global.foregroundDimmer,callback:function(e,n){var r=t[n];if(a<=24){if(r.getHours()%4!=0)return;return(0,eh.Z)(r,"HH:mm")}if(r.toISOString()===(0,ep.Z)(r).toISOString())return(0,eh.Z)(r,"MMM d")}}}}},data:o})};function ev(){var e=(0,en._)(["\n  fragment ReplAnalyticsPageViewDataPoint on ReplAnalyticsPageViewsData {\n    __typename\n    timestamp\n    success\n    failure\n  }\n"]);return ev=function(){return e},e}function eg(){var e=(0,en._)(["\n  fragment ReplAnalyticsPageViews on ReplAnalyticsPageViews {\n    __typename\n    uniques\n    results {\n      ...ReplAnalyticsPageViewDataPoint\n    }\n  }\n  ","\n"]);return eg=function(){return e},e}function ey(){var e=(0,en._)(["\n  query ReplAnalyticsPageViews(\n    $id: String!\n    $input: ReplAnalyticsPageViewsInput!\n  ) {\n    repl(id: $id) {\n      ... on Repl {\n        __typename\n        id\n        analyticsPageViews(input: $input) {\n          ... on ReplAnalyticsPageViews {\n            ...ReplAnalyticsPageViews\n          }\n          ... on NotFoundError {\n            __typename\n            message\n          }\n          ... on UserError {\n            __typename\n            message\n          }\n        }\n      }\n    }\n  }\n  ","\n"]);return ey=function(){return e},e}var eb={},eZ=(0,er.Ps)(ev()),ew=(0,er.Ps)(eg(),eZ),ex=(0,er.Ps)(ey(),ew),eC=function(e){var t=e.data,n=e.start,r=e.hours,i=(0,$.F)().values,o=Array(r).fill(0).map(function(e,t){return(0,ef.Z)(n,t)}),a=t.results.reduce(function(e,t){return e.set(t.timestamp,t),e},new Map),l=[{label:"Connected",data:o.map(function(e){var t;return{y:(null!==(t=a.get(e.toISOString()))&&void 0!==t?t:{success:0}).success,x:e}}),borderColor:i.global.accentPrimaryDefault,backgroundColor:i.global.accentPrimaryDefault},{label:"Failed",data:o.map(function(e){var t;return{y:(null!==(t=a.get(e.toISOString()))&&void 0!==t?t:{failure:0}).failure,x:e}}),borderColor:i.global.accentNegativeDefault,backgroundColor:i.global.accentNegativeDefault}];return(0,h.tZ)(em,{labels:o,datasets:l,maintainAspectRatio:!1})},e_=function(e){var t,n,r,i=e.replId,o=e.start,a=e.hours,l=(0,f._)((0,b.useState)(void 0),2),c=l[0],s=l[1],u=(t=(0,M._)({},eb,{variables:{id:i,input:{start:o,hours:a,deployment:!0}},ssr:!1,onCompleted:function(e){if("Repl"===e.repl.__typename)switch(e.repl.analyticsPageViews.__typename){case"UserError":case"NotFoundError":s(Error(e.repl.analyticsPageViews.message))}}}),ei.a(ex,t)),d=u.data,p=u.loading,m=u.error,g=(null==d?void 0:null===(n=d.repl)||void 0===n?void 0:n.__typename)==="Repl"&&(null===(r=d.repl.analyticsPageViews)||void 0===r?void 0:r.__typename)==="ReplAnalyticsPageViews"?d.repl.analyticsPageViews:void 0,Z=g?g.uniques:void 0;return m&&s(m),(0,h.BX)(v.G,{css:[y.l0.colWithGap(8)],children:[(0,h.BX)(v.G,{css:[y.l0.flex.row,y.l0.align.center,y.l0.justify.spaceBetween],children:[(0,h.tZ)(ee.xv,{variant:"subheadDefault",multiline:!1,children:"Requests"}),Z?(0,h.BX)(ee.xv,{multiline:!1,children:[(0,h.tZ)("strong",{children:Z})," unique visitors"]}):null]}),(0,h.BX)(v.G,{children:[p?(0,h.tZ)(v.G,{css:[y.l0.width("100%"),J,y.l0.borderRadius(8),Q.p.backgroundPulse()]}):null,c?(0,h.tZ)(S.E,{text:c.message,colorway:"negative"}):null,g?(0,h.tZ)(v.G,{css:J,children:(0,h.tZ)(eC,{data:g,start:o,hours:a})}):null]})]})},eS=n(63257);function eE(){var e=(0,en._)(["\n  fragment ReplAnalyticsTimeSeriesDataPoint on ReplAnalyticsTimeSeriesData {\n    __typename\n    timestamp\n    value\n    count\n  }\n"]);return eE=function(){return e},e}function ek(){var e=(0,en._)(["\n  fragment ReplAnalyticsTimeSeries on ReplAnalyticsTimeSeries {\n    __typename\n    results {\n      ...ReplAnalyticsTimeSeriesDataPoint\n    }\n  }\n  ","\n"]);return ek=function(){return e},e}function eT(){var e=(0,en._)(["\n  query ReplAnalyticsTimeSeries(\n    $id: String!\n    $input: ReplAnalyticsTimeSeriesInput!\n  ) {\n    repl(id: $id) {\n      ... on Repl {\n        __typename\n        id\n        analyticsTimeSeries(input: $input) {\n          ... on ReplAnalyticsTimeSeries {\n            ...ReplAnalyticsTimeSeries\n          }\n          ... on NotFoundError {\n            __typename\n            message\n          }\n          ... on UserError {\n            __typename\n            message\n          }\n        }\n      }\n    }\n  }\n  ","\n"]);return eT=function(){return e},e}var eR={},eD=(0,er.Ps)(eE()),eI=(0,er.Ps)(ek(),eD),eG=(0,er.Ps)(eT(),eI),eB=function(e){var t=e.data,n=e.start,r=e.hours,i=e.colorFn,o=Array(r).fill(0).map(function(e,t){return(0,ef.Z)(n,t)}),a=t.results.reduce(function(e,t){var n,r=t.timestamp,i=t.value,o=t.count,a=null!==(n=e.get(i))&&void 0!==n?n:new Map;return a.set(r,o),e.set(i,a),e},new Map),l=(0,eS._)(a.keys()).map(function(e,t){var n=i(e,t),r=a.get(e);return{label:e,data:o.map(function(e){var t,n=null!==(t=null==r?void 0:r.get(e.toISOString()))&&void 0!==t?t:0;return{x:new Date(e),y:n}}),borderColor:n,backgroundColor:n}});return(0,h.tZ)(em,{labels:o,datasets:l,maintainAspectRatio:!1})},eA=function(e){var t,n,r,i=e.replId,o=e.title,a=e.metric,l=e.start,c=e.hours,s=e.colorFn,u=(0,f._)((0,b.useState)(void 0),2),d=u[0],p=u[1],m=(t=(0,M._)({},eR,{variables:{id:i,input:{metric:a,start:l,hours:c,deployment:!0}},ssr:!1,onCompleted:function(e){if("Repl"===e.repl.__typename)switch(e.repl.analyticsTimeSeries.__typename){case"UserError":case"NotFoundError":p(Error(e.repl.analyticsTimeSeries.message))}}}),ei.a(eG,t)),g=m.data,Z=m.loading,w=m.error,x=(null==g?void 0:null===(n=g.repl)||void 0===n?void 0:n.__typename)==="Repl"&&(null===(r=g.repl.analyticsTimeSeries)||void 0===r?void 0:r.__typename)==="ReplAnalyticsTimeSeries"?g.repl.analyticsTimeSeries:void 0;return w&&p(w),(0,h.BX)(v.G,{css:[y.l0.colWithGap(8)],children:[(0,h.tZ)(v.G,{css:[y.l0.flex.row,y.l0.align.center,y.l0.justify.spaceBetween],children:(0,h.tZ)(ee.xv,{variant:"subheadDefault",multiline:!1,children:o})}),(0,h.BX)(v.G,{children:[Z?(0,h.tZ)(v.G,{css:[y.l0.width("100%"),J,y.l0.borderRadius(8),Q.p.backgroundPulse()]}):null,d?(0,h.tZ)(S.E,{text:d.message,colorway:"negative"}):null,x?(0,h.tZ)(v.G,{css:J,children:(0,h.tZ)(eB,{data:x,start:l,hours:c,colorFn:s})}):null]})]})},eP=n(15146),eN=n(87599),eU=n(35908),eO=n(26568),eL=n.n(eO),eM=n(60671);function eX(){var e=(0,en._)(["\n  fragment ReplAnalyticsTopListResult on ReplAnalyticsTopList {\n    __typename\n    results {\n      __typename\n      value\n      count\n    }\n  }\n"]);return eX=function(){return e},e}function eF(){var e=(0,en._)(["\n  query ReplAnalyticsTopList($id: String!, $input: ReplAnalyticsTopInput!) {\n    repl(id: $id) {\n      ... on Repl {\n        __typename\n        id\n        analyticsTopList(input: $input) {\n          ... on ReplAnalyticsTopList {\n            ...ReplAnalyticsTopListResult\n          }\n          ... on NotFoundError {\n            __typename\n            message\n          }\n          ... on UserError {\n            __typename\n            message\n          }\n        }\n      }\n    }\n  }\n  ","\n"]);return eF=function(){return e},e}var eW={},eH=(0,er.Ps)(eX()),eV=(0,er.Ps)(eF(),eH),ez=function(e){var t=e.data,n=e.variant;if(0===t.results.length)return(0,h.tZ)(ee.xv,{multiline:!1,children:"No results"});switch(n){case"map":return(0,h.tZ)(eY,{data:t});case"pie":return(0,h.tZ)(eq,{data:t,devices:!1});case"device-pie":return(0,h.tZ)(eq,{data:t,devices:!0});case"table":return(0,h.tZ)(ej,{data:t})}},ej=function(e){var t=e.data;return q.kL.register(q.qi),(0,h.tZ)(v.G,{children:t.results.map(function(e,t){return(0,h.BX)(v.G,{css:[y.l0.rowWithGap(16),y.l0.py(8),{borderBottom:"1px solid ".concat(y.TV.outlineDimmest)},{"&:last-of-type":{borderBottom:"none"}}],children:[(0,h.tZ)(v.G,{css:[y.l0.flex.grow(1),y.l0.maxWidth("90%")],children:(0,h.tZ)(ee.xv,{title:e.value,multiline:!1,children:e.value})}),(0,h.tZ)(v.G,{children:(0,h.tZ)(ee.xv,{multiline:!1,children:e.count})})]},t)})})},eq=function(e){var t=e.data,n=e.devices,r=(0,$.F)().values,i=[r.global.blueDefault,r.global.blurpleDefault,r.global.greenDefault,r.global.limeDefault,r.global.magentaDefault,r.global.orangeDefault,r.global.pinkDefault,r.global.purpleDefault,r.global.redDefault,r.global.tealDefault,r.global.yellowDefault],o=new Map;return n?t.results.forEach(function(e){var t=e.value,n=e.count,r=t.match(/\(.*\)/);if(r&&r.length){var i=r[0].substring(1,r[0].length-1),a=o.get(i)||0;o.set(i,a+n)}else{var l=o.get("Unknown")||0;o.set("Unknown",l+n)}}):t.results.forEach(function(e){var t=e.value,n=e.count,r=t.replace(/ \(.*\)/,""),i=o.get(r)||0;o.set(r,i+n)}),(0,h.tZ)(v.G,{css:J,children:(0,h.tZ)(et.by,{options:{radius:"90%",maintainAspectRatio:!1,plugins:{tooltip:K()}},data:{labels:(0,eS._)(o.keys()),datasets:[{borderWidth:(0,eS._)(o.keys()).length>1?1:0,borderColor:r.global.outlineDimmest,data:(0,eS._)(o.values()),backgroundColor:Array(o.size).fill(0).map(function(e,t){return i[t%i.length]})}]}})})},eY=function(e){var t=e.data,r=eL()(function(){return Promise.all([n.e(5381),n.e(4096),n.e(8742),n.e(8806)]).then(n.bind(n,8806))},{loadableGenerated:{webpack:function(){return[8806]}},ssr:!1}),i=t.results.map(function(e){return{country:e.value,numHits:e.count}});return(0,h.tZ)(r,{countries:i})},e$=function(e){var t,n,r,i=e.replId,o=e.start,a=e.hours,l=e.metric,c=e.count,s=e.variant,u=void 0===s?"table":s,d=e.expandable,p=(0,eM.CZ)(l),m=(0,f._)((0,b.useState)(void 0),2),g=m[0],Z=m[1],w=(0,f._)((0,b.useState)(!1),2),x=w[0],C=w[1],_=(t=(0,M._)({},eW,{variables:{id:i,input:{metric:l,start:o,hours:a,deployment:!0,count:x?3*c:c}},ssr:!1,onCompleted:function(e){if("Repl"===e.repl.__typename)switch(e.repl.analyticsTopList.__typename){case"UserError":case"NotFoundError":Z(Error(e.repl.analyticsTopList.message))}}}),ei.a(eV,t)),E=_.data,k=_.loading,T=_.error;return T&&Z(T),(0,h.BX)(v.G,{css:y.l0.colWithGap(8),children:[(0,h.BX)(v.G,{css:y.l0.rowWithGap(8),children:[(0,h.tZ)(ee.xv,{variant:"subheadDefault",multiline:!1,children:"device-pie"===u?"Top Devices":"Top ".concat(p)}),void 0!==d&&d?(0,h.tZ)(eP.hU,{alt:x?"Collapse list":"Expand list",onClick:function(){return C(!x)},children:x?(0,h.tZ)(eN.Z,{}):(0,h.tZ)(eU.Z,{})}):null]}),(0,h.BX)(v.G,{children:[k?(0,h.tZ)(v.G,{css:[y.l0.height(80),y.l0.borderRadius(8),Q.p.backgroundPulse()]}):null,g?(0,h.tZ)(S.E,{text:g.message,colorway:"negative"}):null,(null==E?void 0:null===(n=E.repl)||void 0===n?void 0:n.__typename)==="Repl"&&(null===(r=E.repl.analyticsTopList)||void 0===r?void 0:r.__typename)==="ReplAnalyticsTopList"?(0,h.tZ)(ez,{variant:u,data:E.repl.analyticsTopList}):null]})]})},eJ=n(20399),eK=n(99741),eQ=n(6543),e0=n(34017),e1=n(59868),e2=function(e){var t=e.context;(0,e1.j)(e1.U3.DEPLOYMENT_SECTION_VIEWED,{context:t})},e8=[{label:"six hours",key:6},{label:"one day",key:24},{label:"five days",key:120},{label:"one week",key:168},{label:"two weeks",key:336},{label:"thirty days",key:720}],e4={label:"one week",key:168},e3=y.nC.min(600),e5=(0,E.X)({fullWidth:(0,j._)({},e3,{gridColumn:"span 2"})}),e6=(0,E.X)({container:(0,j._)({display:"grid",gap:32},e3,{gridTemplateColumns:"repeat(2, minmax(0, 1fr))"}),fullWidth:e5.fullWidth,map:[e5.fullWidth],pies:[e5.fullWidth,y.l0.flex.column,(0,j._)({gap:32},y.nC.min(480),[y.l0.flex.row,{" > *":{flex:1}}])]}),e9=function(e){var t=e.replId,n=(0,f._)((0,b.useState)(e4),2),r=n[0],i=r.key,o=r.label,a=n[1],l=(0,f._)((0,b.useState)((0,eQ.Z)((0,e0.Z)(new Date),i-1)),2),c=l[0],s=l[1],u=(0,N.o)("deployment-analytics-dot"),d=u.isDone,p=u.setAsDone,m=(0,eQ.Z)((0,e0.Z)(new Date),23),g=(0,$.F)().values,Z=[g.global.redDefault,g.global.redDimmer,g.global.redStronger,g.global.redDimmest],w=[g.global.orangeDefault,g.global.orangeDimmer,g.global.orangeStronger,g.global.orangeDimmest],x=[g.global.blueDefault,g.global.blueDimmer,g.global.blueStronger,g.global.blueDimmest],C=[g.global.greenDefault,g.global.greenDimmer,g.global.greenStronger,g.global.greenDimmest];return(0,b.useEffect)(function(){e2({context:U.k.Analytics})},[]),(0,b.useEffect)(function(){d||p()},[d,p]),(0,h.tZ)(z,{children:(0,h.BX)(v.G,{css:e6.container,children:[(0,h.tZ)(v.G,{css:e6.fullWidth,children:(0,h.tZ)(eJ.ZE,{items:e8,label:"Past ".concat(o),icon:(0,h.tZ)(eK.Z,{}),onAction:function(e){var t,n="string"==typeof e?parseInt(e,10):e;a(null!==(t=e8.find(function(e){return e.key===n}))&&void 0!==t?t:e4),s((0,eQ.Z)((0,e0.Z)(new Date),n-1))},cssProps:[y.l0.width("fit-content")],children:e8.map(function(e){return(0,h.tZ)(eJ.ck,{children:(0,h.tZ)(v.G,{css:[y.l0.rowWithGap(8),y.l0.align.center,y.l0.color.foregroundDefault],children:(0,h.tZ)(ee.xv,{multiline:!1,children:e.label})})},e.key)})})}),(0,h.tZ)(v.G,{css:e6.fullWidth,children:(0,h.tZ)(e_,{replId:t,start:c,hours:i})}),(0,h.tZ)(e$,{replId:t,metric:eM.Pc.Url,start:c,hours:i,count:4,expandable:!0}),(0,h.tZ)(e$,{replId:t,metric:eM.Pc.Referrer,start:c,hours:i,count:4,expandable:!0}),(0,h.tZ)(eA,{replId:t,title:"HTTP Statuses (24h)",metric:eM.RH.Statuses,start:m,hours:24,colorFn:function(e,t){var n=Number(e);return n<300?C[t%C.length]:n<400?x[t%x.length]:n<500?w[t%w.length]:Z[t%Z.length]}}),(0,h.tZ)(ed,{replId:t,start:c,hours:i}),(0,h.BX)(v.G,{css:e6.pies,children:[(0,h.tZ)(e$,{replId:t,metric:eM.Pc.Browser,start:c,hours:i,count:100,variant:"pie"}),(0,h.tZ)(e$,{replId:t,metric:eM.Pc.Browser,start:c,hours:i,count:100,variant:"device-pie"})]}),(0,h.tZ)(v.G,{css:e6.map,children:(0,h.tZ)(e$,{replId:t,metric:eM.Pc.Country,start:c,hours:i,count:100,variant:"map"})})]})})},e7=(0,E.X)({line:{width:1,position:"absolute",left:3},circlePast:{position:"absolute",top:10,left:1,width:5,height:5,borderRadius:"100%",opacity:.5}}),te=(0,E.X)({container:{width:7,position:"relative"},linePast:[e7.line,{backgroundColor:y.TV.outlineDimmest,top:15,bottom:-10}],linePresent:[e7.line,{backgroundImage:"linear-gradient(to top, ".concat(y.TV.outlineDimmest,", ").concat(y.TV.outlineDimmer,")"),top:27,bottom:-10}],lineFuture:[e7.line,{borderRight:"1px dashed "+y.TV.outlineDimmer,top:23,bottom:-20}],lineFutureFailClosed:[e7.line,{backgroundColor:y.TV.outlineDimmest,top:19,bottom:-20}],lineFutureFailOpen:[e7.line,{borderRight:"1px dashed "+y.TV.outlineDimmer,top:22,bottom:-18}],circlePastGreen:[e7.circlePast,y.l0.backgroundColor.accentPositiveDefault],circlePastRed:[e7.circlePast,y.l0.backgroundColor.accentNegativeDefault],circlePastGray:[e7.circlePast,y.l0.backgroundColor.outlineDimmer],circlePresent:[y.l0.backgroundColor.accentPrimaryStronger,{position:"absolute",top:20,left:0,width:7,height:7,borderRadius:"100%"}],circleFuture:{position:"absolute",top:12,left:-1,width:9,height:9},circleFutureFailClosed:[y.l0.backgroundColor.accentNegativeDefault,{position:"absolute",top:14,left:1,width:5,height:5,borderRadius:"100%",opacity:.6}]});function tt(e){var t,n;switch(e.type){case"pastSuccess":t=te.linePast,n=(0,h.tZ)(v.G,{css:te.circlePastGreen});break;case"pastFail":t=te.linePast,n=(0,h.tZ)(v.G,{css:te.circlePastRed});break;case"pastNeutral":t=te.linePast,n=(0,h.tZ)(v.G,{css:te.circlePastGray});break;case"present":t=te.linePresent,n=(0,h.tZ)(v.G,{css:te.circlePresent});break;case"future":t=te.lineFuture,n=(0,h.tZ)("svg",{viewBox:"0 0 9 9",css:te.circleFuture,children:(0,h.tZ)("circle",{cx:4.5,cy:4.5,r:4,fill:"none",stroke:y.TV.outlineStrongest,strokeDasharray:"2 1"})});break;case"futureFailClosed":t=te.lineFutureFailClosed,n=(0,h.tZ)(v.G,{css:te.circleFutureFailClosed});break;case"futureFailOpen":t=te.lineFutureFailOpen,n=null}return(0,h.BX)(v.G,{css:te.container,children:[(0,h.tZ)(v.G,{css:t,"data-timeline-line":!0}),n]})}var tn=n(68514),tr=n(67313),ti=n(80502),to=n(58200),ta=n(16572),tl=n(62340),tc=n(23291),ts=n(32377),tu=n(81764),td=n(49932),tf=function(e){var t=e.stage,n=e.activeStage;return t===e.erroredStage?(0,h.tZ)(I.Z,{alt:"error"}):t<n?(0,h.tZ)(ts.Z,{alt:"success"}):t===n?(0,h.tZ)(g.Z,{alt:"current"}):(0,h.tZ)(tu.Z,{alt:"waiting"})},th=function(e){var t=e.stage,n=e.activeStage,r=e.erroredStage;return n?t===r?"negative":t<n?"positive":t===n?"primary":null:null},tp=function(e){var t,n=e.stage,r=e.totalStagesWithTitle,i=e.activeStage,o=e.text,a=e.erroredStage,l=(0,tl.d)({tablet:!0});return(0,h.tZ)(tc.D,{text:i?o:"",colorway:null!==(t=th({stage:n,activeStage:i,erroredStage:a}))&&void 0!==t?t:void 0,variant:"filled",css:[y.l0.border({color:td.TV.backgroundDefault}),y.l0.overflow("hidden"),i||l?{}:Q.p.foregroundPulse(),(0,j._)({flex:1,height:26,zIndex:r-n,":first-of-type":{paddingLeft:6,paddingRight:6},":not(:first-of-type)":{paddingLeft:24},":not(:last-of-type)":{marginRight:-24}," span":y.l0.display.none},y.nC.min(400),{" span":y.l0.display.flex,":first-of-type":{paddingLeft:16,paddingRight:0}})],iconRight:i?(0,h.tZ)(tf,{stage:n,activeStage:i,erroredStage:a}):void 0})};function tm(){var e=(0,en._)(["\n  query HostingDeployActionHistory(\n    $input: HostingBuildDeployActionHistoryInput!\n  ) {\n    hostingBuildDeployActionHistory(input: $input) {\n      ... on HostingBuildDeployActionHistoryResults {\n        results {\n          ... on HostingBuildDeployLogAction {\n            log\n          }\n          ... on HostingBuildDeployStatusAction {\n            status\n            message\n          }\n        }\n      }\n      ... on NotFoundError {\n        message\n      }\n      ... on UnauthorizedError {\n        message\n      }\n    }\n  }\n"]);return tm=function(){return e},e}var tv={},tg=(0,er.Ps)(tm()),ty=[{id:0,title:"Provision",statusType:G.Fe.Pending},{id:1,title:"Build",statusType:G.Fe.Building},{id:2,title:"Bundle",statusType:G.Fe.Running},{id:3,title:"Promote",statusType:G.Fe.Promoting},{id:4,statusType:G.Fe.Success}],tb=ty.filter(function(e){return"title"in e}),tZ=function(e){return ty.find(function(t){return t.statusType===e})},tw=(0,E.X)({base:{borderRadius:6,paddingLeft:6,paddingRight:6,height:24},disabled:{pointerEvents:"none",color:y.TV.greyDefault}}),tx=[y.l0.borderRadius(8),{border:"1px solid var(--outline-dimmest)"}],tC=(0,E.X)({container:tx,top:[y.l0.colWithGap(12),y.l0.p(16),y.l0.pt(12)],header:[y.l0.rowWithGap(40)],started:[y.l0.rowWithGap(6),y.l0.flex.growAndShrink(1),y.l0.justify.end],cancel:tw.base,canceling:[tw.base,tw.disabled],stages:[y.l0.flex.row,y.l0.flex.grow(1),{zIndex:0}],bottom:[y.l0.borderRadius(0,0,8,8),y.l0.overflow("hidden")],logsOpen:[y.l0.overflow("hidden"),y.l0.height("auto")],logsClosed:[y.l0.overflow("hidden"),y.l0.height(0)],xterm:[y.l0.width("100%"),y.l0.maxWidth("100%"),y.l0.height(340)]}),t_=function(e){return(0,h.BX)(v.G,{css:tC.top,children:[(0,h.BX)(v.G,{css:tC.header,children:[(0,h.BX)(v.G,{css:y.l0.rowWithGap(8),children:[(0,h.tZ)(ee.xv,{variant:"subheadDefault",multiline:!1,children:"Deploying"}),(0,h.tZ)(B.zx,{style:{opacity:e.onCancel?1:0},size:"small",text:"Cancel",css:e.isCanceling?tC.canceling:tC.cancel,onClick:e.onCancel,iconRight:e.isCanceling?(0,h.tZ)(g.Z,{}):void 0})]}),(0,h.BX)(v.G,{css:tC.started,children:[e.timeStarted&&e.userDisplayName?(0,h.BX)(ee.xv,{css:y.l0.color.greyStronger,multiline:!1,children:["Started ".concat((0,ta.Z)(new Date(e.timeStarted),Date.now(),{addSuffix:!0})," by "),(0,h.tZ)("span",{css:y.l0.color.foregroundDefault,children:e.userDisplayName})]}):null,e.onViewBuildLogs?(0,h.tZ)(eP.hU,{onClick:e.onViewBuildLogs,alt:"View deploy logs",children:e.viewBuildLogs?(0,h.tZ)(tr.Z,{}):(0,h.tZ)(eK.Z,{})}):null]})]}),(0,h.tZ)(v.G,{css:tC.stages,children:tb.map(function(t){var n=t.id,r=t.title;return(0,h.tZ)(tp,{stage:n,totalStagesWithTitle:tb.length,text:r,activeStage:e.activeStage,erroredStage:e.erroredStage},n)})})]})},tS=function(e){return(0,Z.kW)()===w.z.Preparing?(0,h.tZ)(v.G,{css:tC.container,children:(0,h.tZ)(t_,{})}):(0,h.tZ)(tE,(0,M._)({},e))},tE=function(e){var t,n,r,i,o,a,l,c,s,u,d,p,m,g=e.initialBuild,w=e.viewBuildLogsOnLoad,_=e.onViewLogs,S=e.onCanceled,E=e.onError,k=e.openFile,T=(0,Z.rm)(),R=(0,Z.pn)(),D=R?{id:R.id,status:R.status,provider:R.provider,timeStarted:R.timeCreated,userDisplayName:R.user.displayName}:void 0,I=(0,b.useRef)(g||D),B=(t={skip:!(null===(i=I.current)||void 0===i?void 0:i.id),variables:{input:{buildId:null!==(m=null===(o=I.current)||void 0===o?void 0:o.id)&&void 0!==m?m:""}},fetchPolicy:"network-only",ssr:!1,onCompleted:function(e){if(null==e?void 0:e.hostingBuildDeployActionHistory)switch(e.hostingBuildDeployActionHistory.__typename){case"NotFoundError":break;case"UnauthorizedError":E(e.hostingBuildDeployActionHistory.message);break;case"HostingBuildDeployActionHistoryResults":var t=e.hostingBuildDeployActionHistory.results;if(t&&t.length>0){var n=[],r=[],i=!0,o=!1,a=void 0;try{for(var l,c=t[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var s=l.value;switch(s.__typename){case"HostingBuildDeployLogAction":n.push(s.log);break;case"HostingBuildDeployStatusAction":r.push(s)}}}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}Q({type:"history",payload:n});var u=!0,d=!1,f=void 0;try{for(var h,p=r[Symbol.iterator]();!(u=(h=p.next()).done);u=!0){var m=h.value;ee(m.status)}}catch(e){d=!0,f=e}finally{try{u||null==p.return||p.return()}finally{if(d)throw f}}}break;default:E("Unexpected typename.")}},onError:function(e){E(e.message)}},n=(0,M._)({},tv,t),ei.a(tg,n)),A=B.loading,P=B.refetch;(0,Z.U)(function(e){switch(e.__typename){case"HostingBuildDeployLogAction":Q({type:"update",payload:e.log});break;case"HostingBuildDeployStatusAction":ee(e.status)}});var N=(0,f._)((0,b.useState)(I.current?null===(a=tZ(I.current.status))||void 0===a?void 0:a.id:void 0),2),U=N[0],O=N[1],L=(0,f._)((0,b.useState)((null===(l=I.current)||void 0===l?void 0:l.status)==="failed"?null===(c=tZ(null===(s=I.current)||void 0===s?void 0:s.status))||void 0===c?void 0:c.id:void 0),2),X=L[0],F=L[1],W=(0,f._)((0,b.useState)(!1),2),H=W[0],V=W[1],z=(0,Z.XZ)(),j=(0,f._)((0,ti.Z)({openFile:k,listFiles:z.listFiles}),2),q=j[0],Y=j[1],$=(0,to.f)(),J=(0,f._)((0,b.useReducer)(function(e,t){switch(t.type){case"history":return q&&q.clear(),(0,eS._)(t.payload).concat((0,eS._)(e));case"update":return[t.payload];case"refetch":return q&&q.clear(),A||P(),[]}},[]),2),K=J[0],Q=J[1],ee=function(e){if(e===G.Fe.Failed)F(U);else{var t=tZ(e);if(!t)return;O(t.id)}},et=(r=(0,x._)(function(){return(0,C.Jh)(this,function(e){switch(e.label){case 0:return V(!0),[4,T()];case 1:return e.sent(),S(),[2]}})}),function(){return r.apply(this,arguments)}),en=(0,f._)((0,b.useState)(w||!1),2),er=en[0],eo=en[1],ea=function(){eo(!er),er||e2({context:"deploy_progress_logs"})};(0,b.useEffect)(function(){e2({context:"deploy_progress"})},[]),(0,b.useEffect)(function(){var e;(null===(e=I.current)||void 0===e?void 0:e.id)&&R&&R.id!==I.current.id&&(I.current={id:R.id,status:R.status,provider:R.provider,timeStarted:R.timeCreated,userDisplayName:R.user.displayName},O(void 0),F(void 0),Q({type:"refetch"}))},[R,null===(u=I.current)||void 0===u?void 0:u.id,P]),(0,b.useEffect)(function(){var e;void 0!==U&&(null===(e=I.current)||void 0===e?void 0:e.status)==="failed"&&F(U)},[U,null===(d=I.current)||void 0===d?void 0:d.status]),(0,b.useEffect)(function(){q&&K.forEach(function(e){return q.write(e)})},[K,q]);var el=null===(p=ty.find(function(e){return e.id===U}))||void 0===p?void 0:p.statusType,ec=el!==G.Fe.Success&&!X;return I.current?(0,h.BX)(v.G,{css:tC.container,children:[(0,h.tZ)(t_,{onCancel:ec?et:void 0,isCanceling:H,onViewBuildLogs:ea,viewBuildLogs:er,timeStarted:I.current.timeStarted,userDisplayName:I.current.userDisplayName,activeStage:U,erroredStage:X}),(0,h.BX)(v.G,{css:tC.bottom,children:[(0,h.BX)(v.G,{css:er?tC.logsOpen:tC.logsClosed,children:[(0,h.tZ)(tn.R,{}),(0,h.tZ)(v.G,{css:[y.l0.display.flex,y.l0.pt(12),y.l0.pl(16),y.l0.overflow("hidden"),{backgroundColor:null==$?void 0:$.background}],children:(0,h.tZ)(v.K.div,{css:tC.xterm,ref:Y})})]}),X&&el?(0,h.BX)(h.HY,{children:[(0,h.tZ)(tn.R,{}),el===G.Fe.Building?(0,h.tZ)(tD,{provider:I.current.provider,logs:K.slice(-3),openFile:k,viewBuildLogs:er,onViewBuildLogs:ea}):null,el===G.Fe.Promoting?(0,h.tZ)(tR,{provider:I.current.provider,logs:K.slice(-3),openFile:k,viewBuildLogs:er,onViewBuildLogs:ea,onViewApplicationLogs:_}):null]}):null]})]}):null},tk=(0,E.X)({errorContainer:[y.l0.p(12),y.l0.colWithGap(12)],warning:[y.l0.colWithGap(8)],warningTitle:[y.l0.rowWithGap(4),y.l0.align.center,y.l0.fontWeight.medium],link:{color:y.TV.foregroundDefault,textDecoration:"underline",":hover":{color:y.TV.accentPrimaryStronger}},xtermContainer:[y.l0.display.flex,y.l0.pt(12),y.l0.pl(16),y.l0.overflow("hidden"),y.l0.borderRadius(8,8,0,0)],xterm:[y.l0.width("100%"),y.l0.maxWidth("100%"),y.l0.height(120)],xtermButton:y.l0.borderRadius(0,0,8,8),list:[{listStyle:"inside"}],listCta:y.l0.display.inlineFlex}),tT=function(e){var t=e.title,n=e.description,r=e.logs,i=e.viewBuildLogs,o=e.onViewBuildLogs,a=e.openFile,l=(0,to.f)(),c=(0,Z.XZ)(),s=(0,f._)((0,ti.Z)({openFile:a,listFiles:c.listFiles}),2),u=s[0],d=s[1],p=(0,b.useRef)(r?r.slice(-3):[]);return(0,b.useEffect)(function(){p.current.length&&p.current.forEach(function(e){null==u||u.write(e)})},[u]),(0,h.BX)(P.Tg,{elevated:!0,css:tk.errorContainer,children:[(0,h.BX)(v.G,{css:tk.warning,children:[(0,h.BX)(v.G,{css:tk.warningTitle,children:[(0,h.tZ)(I.Z,{color:y.TV.accentNegativeStronger}),(0,h.tZ)(ee.xv,{multiline:!1,children:t})]}),(0,h.tZ)(ee.xv,{children:n})]}),void 0===i||i?null:(0,h.BX)(v.G,{children:[(0,h.tZ)(v.G,{css:tk.xtermContainer,style:{backgroundColor:null==l?void 0:l.background},children:(0,h.tZ)(v.K.div,{css:tk.xterm,ref:d})}),(0,h.tZ)(B.zx,{text:"View all",iconLeft:(0,h.tZ)(eU.Z,{}),onClick:o,css:tk.xtermButton})]})]})};function tR(e){var t=(0,Z.am)();return(0,h.tZ)(tT,(0,M._)({title:"Your app failed to promote",description:(0,h.BX)(h.HY,{children:["Common issues for promote stage errors can be an error occurring while trying to run your run command, your application exiting unexpectedly, an error on your app server or a provisioning issue.",(0,h.tZ)("br",{}),(0,h.tZ)("br",{}),"Ways to debug:",(0,h.BX)("ul",{css:tk.list,children:[(null==t?void 0:t.isVnc)?(0,h.tZ)("li",{children:"This promotion may also be failing due to VNC incompatibilities."}):null,(0,h.tZ)("li",{children:"make sure your repl runs in the Workspace"}),(0,h.BX)("li",{children:["view our"," ",(0,h.tZ)("a",{href:"https://docs.replit.com/hosting/deployments/troubleshooting",target:"_blank",css:tk.link,onClick:function(){return e2({context:"troubleshooting_doc"})},children:"troubleshooting tips"})]}),e.provider!==G.r4.Static&&e.onViewApplicationLogs?(0,h.BX)("li",{children:["look for errors in your application's server logs"," ",(0,h.tZ)(B.zx,{text:"Logs",size:"small",iconLeft:(0,h.tZ)(R.Z,{}),onClick:e.onViewApplicationLogs,css:y.l0.display.inlineFlex})," "]}):null,(0,h.tZ)("li",{children:"look for errors in your promote stage logs"})]})]})},e))}function tD(e){var t=(0,Z.am)();return(0,h.tZ)(tT,(0,M._)({title:"Your app failed to build",description:(0,h.BX)(h.HY,{children:["Common issues for build stage errors can be an error occurring while trying to run your build command or an compilation issue with your application code.",(0,h.tZ)("br",{}),(0,h.tZ)("br",{}),"Ways to debug:",(0,h.BX)("ul",{css:tk.list,children:[(null==t?void 0:t.isVnc)?(0,h.tZ)("li",{children:"This promotion may also be failing due to VNC incompatibilities."}):null,(0,h.tZ)("li",{children:"make sure your repl runs in the Workspace"}),(0,h.BX)("li",{children:["view our"," ",(0,h.tZ)("a",{href:"https://docs.replit.com/hosting/deployments/troubleshooting",target:"_blank",css:tk.link,onClick:function(){return e2({context:"troubleshooting_doc"})},children:"troubleshooting tips"})]}),(0,h.tZ)("li",{children:"look for errors in your build stage logs"})]})]})},e))}var tI=n(35597),tG=n(79217),tB=n(95891);(i||(i={})).Current="current";var tA=(0,j._)({},"current",{icon:(0,h.tZ)(function(e){var t=e.color;return(0,h.tZ)(v.G,{css:[y.l0.align.center,y.l0.rowWithGap(8),{textTransform:"capitalize"}],children:(0,h.tZ)(v.G,{tag:"span",css:[y.l0.width("8px"),y.l0.height("8px"),y.l0.borderRadius("full"),{backgroundColor:t,boxShadow:"0 0 12px ".concat(t)}]})})},{color:y.TV.blueStronger}),text:"Current deployment"}),tP=v.K.div,tN=function(e){var t=e.activityLogItem.type,n=(0,f._)((0,b.useState)(!1),2),r=n[0],i=n[1],o=(0,f._)((0,b.useState)(!1),2),a=o[0],l=o[1],c=(0,b.useRef)(!1);(0,b.useEffect)(function(){c.current=!0;var e=setTimeout(function(){l(r)},200);return function(){clearTimeout(e)}},[r]);var s=t in tA&&tA[t];if(!s)return null;var u=s.icon,d=s.text;return(0,h.tZ)(v.G,{css:[y.l0.p(8)],onMouseEnter:function(){return i(!0)},onMouseLeave:function(){return i(!1)},children:(0,h.BX)(tB.Z,{isOpen:a,onClickOutside:function(){return l(!1)},padding:8,children:[(0,h.tZ)(tP,{css:y.l0.cursor.pointer,children:u}),(0,h.tZ)(v.G,{css:[y.l0.maxWidth(240)],children:(0,h.tZ)(ee.xv,{children:d})})]})})};function tU(){var e=(0,en._)(["\n  fragment HostingActivityLogBuild on HostingBuild {\n    id\n    status\n    provider\n    timeCreated\n    user {\n      id\n      displayName\n    }\n  }\n"]);return tU=function(){return e},e}function tO(){var e=(0,en._)(["\n  fragment HostingActivityLogLine2 on HostingActivityLog {\n    id\n    build {\n      ...HostingActivityLogBuild\n    }\n    type\n    user {\n      id\n      displayName\n    }\n    timeCreated\n  }\n  ","\n"]);return tO=function(){return e},e}function tL(){var e=(0,en._)(["\n  query HostingDeploymentActivityLogs2(\n    $replId: String!\n    $after: String\n    $count: Int\n  ) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        hostingDeployment {\n          ... on HostingDeployment {\n            id\n            currentBuild {\n              id\n            }\n            activityLogs(after: $after, count: $count) {\n              items {\n                ...HostingActivityLogLine2\n              }\n              pageInfo {\n                hasNextPage\n                nextCursor\n              }\n            }\n          }\n          ... on NotFoundError {\n            message\n          }\n          ... on UnauthorizedError {\n            message\n          }\n        }\n      }\n    }\n  }\n  ","\n"]);return tL=function(){return e},e}function tM(){var e=(0,en._)(["\n  query HostingActivityLogBuildHistory(\n    $input: HostingBuildDeployActionHistoryInput!\n  ) {\n    hostingBuildDeployActionHistory(input: $input) {\n      ... on HostingBuildDeployActionHistoryResults {\n        results {\n          ... on HostingBuildDeployStatusAction {\n            status\n            message\n          }\n          ... on HostingBuildDeployLogAction {\n            log\n          }\n        }\n      }\n    }\n  }\n"]);return tM=function(){return e},e}var tX={},tF=(0,er.Ps)(tU()),tW=(0,er.Ps)(tO(),tF),tH=(0,er.Ps)(tL(),tW),tV=(0,er.Ps)(tM()),tz=n(40102),tj=n(34396),tq=function(e){var t=e.build,n=t.id.slice(0,8),r=(0,f._)((0,b.useState)(!1),2),i=r[0],o=r[1],a=(0,f._)((0,b.useState)(!1),2),l=a[0],c=a[1],s=(0,b.useRef)(!1);return(0,b.useEffect)(function(){s.current=!0;var e=setTimeout(function(){c(i)},200);return function(){clearTimeout(e)}},[i]),(0,h.tZ)("span",{onMouseEnter:function(){return o(!0)},onMouseLeave:function(){return o(!1)},children:(0,h.BX)(tB.Z,{isOpen:l,onClickOutside:function(){return c(!1)},padding:8,children:[(0,h.tZ)("span",{css:[A.gU.listItem,y.l0.display.inlineBlock,y.l0.px(2),y.l0.py(0),y.l0.borderRadius(4)],children:n}),(0,h.tZ)(v.G,{css:[y.l0.maxWidth(260)],children:(0,h.tZ)(ee.xv,{variant:"small",children:t.id})})]})})},tY=(o={},(0,j._)(o,tj.dD.Deploy,function(e){return(0,h.BX)(h.HY,{children:["deployed ",(0,h.tZ)(tq,{build:e})]})}),(0,j._)(o,tj.dD.Rollback,function(e){return(0,h.BX)(h.HY,{children:["rolled back ",(0,h.tZ)(tq,{build:e})]})}),(0,j._)(o,tj.dD.Fail,function(e){return(0,h.BX)(h.HY,{children:["failed to deploy ",(0,h.tZ)(tq,{build:e})]})}),o),t$=function(e){var t=e.activityLogItem,n=t.type,r=t.build,i=t.user.displayName,o=n in tY&&tY[n](r);return o?(0,h.BX)(ee.xv,{multiline:!1,children:[(0,h.tZ)("span",{css:y.l0.fontWeight.medium,children:i+" "}),o]}):null},tJ=n(63388),tK=n(73157);function tQ(e){var t=e.onViewBuildLogs,n=e.type,r=(0,_.Z)();return(0,h.tZ)(ne,{replId:r,onSelect:t,type:void 0===n?"default":n})}var t0=ty.filter(function(e){return"title"in e}),t1=(0,E.X)({root:[y.l0.flex.row,y.l0.px(8),y.l0.pb(8),{zIndex:0}]});function t2(e){var t=e.activeStage,n=e.erroredStage;return(0,h.tZ)(v.G,{css:t1.root,children:t0.map(function(e){return(0,h.tZ)(tp,{stage:e.id,text:e.title,totalStagesWithTitle:t0.length,activeStage:t,erroredStage:n},e.id)})})}var t8=(0,E.X)({root:[y.l0.colWithGap(8),y.l0.height("100%")],header:[y.l0.pt(8),y.l0.px(8),y.l0.rowWithGap(8),y.l0.align.center],divider:[{marginLeft:8,marginRight:8,borderBottom:"1px solid "+y.TV.outlineDimmest}],name:[y.l0.color.foregroundDefault,y.l0.fontWeight.medium],content:[y.l0.p(8),y.l0.flex.growAndShrink(1),y.l0.position.relative],loading:[y.l0.coverContainer,y.l0.center],error:[y.l0.m(8),y.l0.borderRadius(8),y.l0.overflow("hidden")],xterm:[y.l0.coverContainer,{overflow:"hidden",borderBottomLeftRadius:8,borderBottomRightRadius:8,"& > div":[y.l0.coverContainer,y.l0.p(8)]}]});function t4(e){var t,n,r=e.build,i=e.onBack,o=e.fs,a=e.openFile,l=e.onViewAppLogs,c=(0,f._)((0,ti.Z)({openFile:a,listFiles:o.listFiles}),2),s=c[0],u=c[1],d=(t={variables:{input:{buildId:r.id}},ssr:!1,fetchPolicy:"cache-and-network"},n=(0,M._)({},tX,t),ei.a(tV,n)),p=d.data,m=d.loading,Z=(0,b.useMemo)(function(){if(!p)return null;var e=[],t="HostingBuildDeployActionHistoryResults"===p.hostingBuildDeployActionHistory.__typename?p.hostingBuildDeployActionHistory.results:null;if(t){var n=void 0,r=void 0,i=void 0,o=!0,a=!1,l=void 0;try{for(var c,s,u=t[Symbol.iterator]();!(o=(s=u.next()).done);o=!0)!function(){var t=s.value;if("HostingBuildDeployLogAction"===t.__typename)return e.push(t.log);ty.some(function(e){return e.statusType===t.status})&&(n=t.status),t.status===G.Fe.Failed&&(r=n)}()}catch(e){a=!0,l=e}finally{try{o||null==u.return||u.return()}finally{if(a)throw l}}var d=n?null===(c=tZ(n))||void 0===c?void 0:c.id:void 0;return r&&(i=d),{logs:e,activeStage:d,erroredStage:i,erroredStatus:r}}},[p]);return(0,b.useEffect)(function(){if(s&&Z){var e=!0,t=!1,n=void 0;try{for(var r,i=Z.logs[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value;s.write(o)}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}},[s,Z]),(0,h.BX)(v.G,{css:t8.root,children:[(0,h.BX)(v.G,{css:t8.header,children:[(0,h.tZ)(eP.hU,{alt:"Back to timeline",onClick:function(){return i()},children:(0,h.tZ)(tz.Z,{})}),(0,h.tZ)(v.G,{children:(0,h.BX)(ee.xv,{color:"dimmer",multiline:!1,children:[(0,h.tZ)("span",{css:t8.name,children:r.user.displayName+" "}),(0,tJ.BX)(r.status)]})}),(0,h.tZ)(tq,{build:r})]}),(null==Z?void 0:Z.erroredStatus)?(0,h.BX)(v.G,{css:t8.error,children:[(null==Z?void 0:Z.erroredStatus)===G.Fe.Building?(0,h.tZ)(tD,{provider:r.provider,openFile:a}):null,(null==Z?void 0:Z.erroredStatus)===G.Fe.Promoting?(0,h.tZ)(tR,{provider:r.provider,openFile:a,onViewApplicationLogs:l}):null]}):null,(0,h.tZ)(t2,{activeStage:null==Z?void 0:Z.activeStage,erroredStage:null==Z?void 0:Z.erroredStage}),(0,h.tZ)(v.G,{css:t8.divider}),(0,h.BX)(P.Tg,{css:t8.content,children:[(0,h.tZ)(v.G,{css:t8.xterm,innerRef:u}),m||!s?(0,h.tZ)(v.G,{css:t8.loading,children:(0,h.tZ)(g.Z,{color:y.TV.white,size:24})}):null]})]})}var t3=(0,E.X)({item:y.l0.rowWithGap(12),past:{":last-of-type":{"[data-timeline-line]":{display:"none"}}},future:{":last-of-type":{"[data-timeline-line]":{bottom:-19}}},animate:{animation:(0,W.Gs)(36.4)+" 300ms ease-out forwards"}}),t5=(0,E.X)({root:[y.l0.colWithGap(8)],empty:[y.l0.pb(8),y.l0.center,y.l0.align.stretch],items:[],loadMore:[y.l0.center],item:[y.l0.rowWithGap(8),y.l0.pl(8),y.l0.pr(4),y.l0.pb(12),y.l0.align.center,y.l0.flex.growAndShrink(1),y.l0.color.foregroundDimmest,y.l0.hover(y.l0.color.foregroundDefault)],itemMainText:[y.l0.flex.growAndShrink(1),(0,j._)({},y.nC.min(640),y.l0.flex.growAndShrink(0))],itemLine:[y.l0.display.none,(0,j._)({},y.nC.min(640),[y.l0.display.flex,y.l0.flex.growAndShrink(1),y.l0.border({color:y.TV.outlineDimmest,direction:"top"})])],itemRight:[y.l0.rowWithGap(6),y.l0.justify.end,y.l0.textAlign.right],itemContent:[y.l0.rowWithGap(8),y.l0.flex.growAndShrink(1),y.l0.align.center],itemPast:[t3.item,t3.past],itemPastAnimate:[t3.item,t3.past,t3.animate],itemFuture:[t3.item,t3.future],itemFutureAnimate:[t3.item,t3.future,t3.animate]}),t6=(0,E.X)({button:[y.l0.reset.button,y.l0.cursor.pointer,y.l0.borderRadius(8),y.l0.display.flex,y.l0.rowWithGap(6),y.l0.align.center,y.l0.px(8),y.l0.color.foregroundDimmer,y.l0.height(32),y.l0.hover(y.l0.color.foregroundDefault)]}),t9=(0,E.X)({button:t6.button,buttonHighlight:[t6.button,y.l0.color.accentNegativeStrongest,y.l0.backgroundColor.accentNegativeDimmest,y.l0.border({color:y.TV.accentNegativeDimmer})],buttonOpen:y.l0.flex.growAndShrink(1),buttonClosed:[y.l0.flex.growAndShrink(1),y.l0.pb(12)],buttonContent:[y.l0.flex.growAndShrink(1),y.l0.rowWithGap(8),y.l0.align.center]});function t7(e){var t=e.items,n=e.onClick,r=(0,f._)((0,b.useState)(!1),2),i=r[0],o=r[1],a=(0,Z.pn)(),l=(0,b.useRef)(void 0);(0,b.useEffect)(function(){(null==a?void 0:a.status)!==void 0&&(l.current=null==a?void 0:a.status)},[a,null==a?void 0:a.status]);var c=!a&&l.current!==G.Fe.Building&&l.current!==G.Fe.Success,s=c?y.TV.accentNegativeStronger:y.TV.foregroundDimmer;return 0===t.length?null:(0,h.BX)(v.G,{children:[(0,h.BX)(v.G,{css:y.l0.rowWithGap(12),children:[(0,h.tZ)(tt,{type:i?"futureFailOpen":"futureFailClosed"}),(0,h.tZ)(v.G,{css:i?t9.buttonOpen:t9.buttonClosed,children:(0,h.BX)("button",{onClick:function(){return o(!i)},css:c?t9.buttonHighlight:t9.button,children:[(0,h.BX)(v.G,{css:t9.buttonContent,children:[c?(0,h.tZ)(I.Z,{color:y.TV.accentNegativeStronger}):null,(0,h.BX)(ee.xv,{children:[t.length," ",(0,tK.Z)("build",t.length)," failed"]}),i?null:(0,h.BX)(ee.xv,{children:[t.length>1?"Most recent: ":null,(0,ta.Z)(new Date(t[0].timeCreated),Date.now(),{addSuffix:!0})]})]}),i?(0,h.tZ)(tr.Z,{color:s}):(0,h.tZ)(eK.Z,{color:s})]})})]}),i?(0,h.tZ)(v.G,{css:y.l0.pt(8),children:t.map(function(e){return(0,h.tZ)(nt,{item:e,onClick:function(){return n(e.build)},type:"future"},e.id)})}):null]})}function ne(e){var t,n,r,i=e.replId,o=e.onSelect,a=e.type,l=void 0===a?"default":a,c=(t=(0,M._)({},tX,{variables:{replId:i,count:20},fetchPolicy:"cache-and-network",ssr:!1}),ei.a(tH,t)),s=c.data,u=c.previousData,d=c.loading,f=c.error,p=c.fetchMore,m=null!=s?s:u,y=(null==m?void 0:m.repl.__typename)==="Repl"?m.repl:null,w=(null==y?void 0:null===(r=y.hostingDeployment)||void 0===r?void 0:r.__typename)==="HostingDeployment"?y.hostingDeployment:null,_=(n=(0,x._)(function(){var e;return(0,C.Jh)(this,function(t){switch(t.label){case 0:if(!(e=null==w?void 0:w.activityLogs.pageInfo.nextCursor))return[2];return[4,p({variables:{after:e,count:20}})];case 1:return t.sent(),[2]}})}),function(){return n.apply(this,arguments)}),E=(0,tI.Z)({onLoadMore:_,rootMargin:"0px 0px 300px 0px"}).targetRef,k=(0,b.useRef)(""),T=(0,Z.$y)(),R=(0,Z.pn)(),D=(0,b.useRef)(void 0);if((0,b.useEffect)(function(){(null==R?void 0:R.id)!==void 0&&(D.current=null==R?void 0:R.id)},[null==R?void 0:R.id]),d&&!w)return"failureQueue"===l?null:(0,h.tZ)(nr,{});if(!(null==w?void 0:w.activityLogs))return null;var B=w.activityLogs,A=B.items,P=B.pageInfo;if(0===A.length)return null;if(f)return(0,h.tZ)(v.G,{css:t5.empty,children:(0,h.tZ)(S.E,{colorway:"warning",icon:(0,h.tZ)(I.Z,{}),text:"Something went wrong"})});A.length&&(A[0].build.id===(null==T?void 0:T.id)&&A[1]?k.current=A[1].build.id:k.current=A[0].build.id);var N=function(e,t){var n=[],r=(null==t?void 0:t.timeCreated)?new Date(t.timeCreated):null,i=!0,o=!1,a=void 0;try{for(var l,c=e[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var s=l.value;if(s.type!==G.dD.Fail||r&&r.getTime()>new Date(s.build.timeCreated).getTime()||(null==t?void 0:t.id)===s.build.id)break;n.push(s)}}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}return n}(A,T);return"failureQueue"===l?(0,h.tZ)(W.un,{render:N.length>0,initialHeight:44,children:(0,h.tZ)(t7,{items:N,onClick:o})}):(0,h.BX)(v.G,{css:t5.root,"data-history-timeline-items":A.length-N.length,children:[(0,h.tZ)(v.G,{css:t5.items,children:A.map(function(e,t){return e.build.id===(null==T?void 0:T.id)||t<N.length?null:(0,h.tZ)(nt,{item:e,onClick:function(){return o(e.build)}},e.id)})}),P.nextCursor?(0,h.tZ)(v.G,{css:t5.loadMore,children:(0,h.tZ)(eP.hU,{disabled:d,tooltipHidden:!0,alt:"Show more",onClick:_,ref:E,children:d?(0,h.tZ)(g.Z,{}):(0,h.tZ)(tG.Z,{})})}):null]})}function nt(e){var t=e.item,n=e.onClick,r=e.timeline,i=e.type,o=(0,h.BX)(v.G,{css:t5.item,children:[(0,h.tZ)(v.G,{css:t5.itemMainText,children:(0,h.tZ)(t$,{activityLogItem:t})}),(0,h.tZ)(v.G,{css:t5.itemLine}),(0,h.BX)(v.G,{css:t5.itemRight,children:[(0,h.tZ)(tN,{activityLogItem:t}),(0,h.tZ)(ee.xv,{multiline:!1,children:(0,ta.Z)(new Date(t.timeCreated),Date.now(),{addSuffix:!0})}),(0,h.tZ)(eP.hU,{alt:"View deploy logs",onClick:n,children:(0,h.tZ)(R.Z,{})})]})]});return void 0===r||r?(0,h.BX)(v.G,{css:"past"===(void 0===i?"past":i)?t5.itemPast:t5.itemFuture,children:[(0,h.tZ)(tt,{type:t.type===G.dD.Fail?"pastFail":"pastSuccess"}),o]}):o}var nn=(0,E.X)({loading:[y.l0.rowWithGap(12),{":last-of-type":{"[data-timeline-line]":{display:"none"}}}],loadingItem:[Q.p.backgroundPulse(),y.l0.height(20.4),y.l0.mt(2),y.l0.ml(4),y.l0.flex.growAndShrink(1),y.l0.borderRadius(6),{opacity:.5,marginBottom:14}]});function nr(){return(0,h.tZ)(v.G,{children:[,,,].fill(0).map(function(e,t){return(0,h.BX)(v.G,{css:nn.loading,children:[(0,h.tZ)(tt,{type:"pastNeutral"}),(0,h.tZ)(P.Tg,{elevated:!0,css:nn.loadingItem})]},t)})})}var ni=n(18836),no=n(30983),na=n(97615),nl=(0,E.X)({self:[y.l0.colWithGap(8)],selfGrow:[y.l0.colWithGap(8),y.l0.flex.grow(1)],label:[y.l0.rowWithGap(8),y.l0.align.center],labelText:{},header:[y.l0.display.flex,y.l0.flex.row,y.l0.justify.spaceBetween,y.l0.align.center],actions:[y.l0.rowWithGap(4)],labelLoading:[y.l0.rowWithGap(8),y.l0.align.center,Q.p.foregroundPulse(),y.l0.width(200),y.l0.borderRadius(8)],inputLoading:[Q.p.foregroundPulse(),y.l0.borderRadius(8)]}),nc=function(e){var t=e.id,n=e.title,r=e.information,i=e.optional,o=e.actions,a=e.children,l=e.grow;return(0,h.BX)(v.G,{css:void 0!==l&&l?nl.selfGrow:nl.self,children:[(0,h.BX)(v.G,{css:nl.header,children:[(0,h.BX)(v.G,{tag:"label",htmlFor:t,css:nl.label,children:[(0,h.tZ)(ee.xv,{color:"dimmer",multiline:!1,children:n}),(0,h.tZ)(no.u,{tooltip:r,children:(0,h.tZ)(na.Z,{color:y.TV.foregroundDimmest})}),void 0!==i&&i?(0,h.tZ)(ee.xv,{variant:"small",color:"dimmest",multiline:!1,children:"optional"}):null]}),o?(0,h.tZ)(v.G,{css:nl.actions,children:o}):null]}),a]})},ns=function(){return(0,h.BX)(v.G,{css:nl.self,children:[(0,h.tZ)(v.G,{css:nl.header,children:(0,h.tZ)(v.G,{css:nl.labelLoading,children:(0,h.tZ)(ee.xv,{color:"dimmer",multiline:!1,children:"\xa0"})})}),(0,h.tZ)(v.G,{css:nl.inputLoading,children:(0,h.tZ)(ni.II,{disabled:!0})})]})},nu=function(e){return e.loading?(0,h.tZ)(v.G,{css:[y.l0.p(8),y.l0.center],children:(0,h.tZ)(g.Z,{})}):null},nd=(0,E.X)({error:[y.l0.flex.grow(0),y.l0.mt(0)]}),nf=function(e){var t=e.text;return(0,h.tZ)(z,{css:nd.error,children:(0,h.tZ)(S.E,{colorway:"warning",icon:(0,h.tZ)(I.Z,{}),text:t})})},nh=(0,E.X)({back:[y.l0.flex.row,y.l0.align.center]}),np=function(e){var t=e.onBack;return(0,h.tZ)(v.G,{css:nh.back,children:(0,h.tZ)(eP.hU,{alt:"Back",tooltipHidden:!0,onClick:t,children:(0,h.tZ)(tz.Z,{})})})},nm=n(4927);function nv(){var e=(0,en._)(["\n  query ReservedVMMachineConfigurations {\n    hostingMachineConfigurations(input: { provider: gce }) {\n      __typename\n      ... on HostingMachineConfigurationsResults {\n        results {\n          ...MachineConfiguration\n        }\n      }\n      ... on UnauthorizedError {\n        message\n      }\n    }\n  }\n  ","\n"]);return nv=function(){return e},e}var ng={},ny=(0,er.Ps)(nv(),nm.bN),nb=n(48272),nZ=n(12874),nw=n(73524),nx=n(23211),nC=(0,E.X)({header:[y.l0.colWithGap(4),y.l0.mb(16)],costWrapper:[y.l0.rowWithGap(2),y.l0.align.center,y.l0.flex.shrink(1)],cost:[y.l0.rowWithGap(4),y.l0.align.baseline],selectWrapper:y.l0.rowWithGap(12),selectInner:[y.l0.flex.growAndShrink(1)],select:[y.l0.border({color:td.TV.outlineDefault}),{flex:"1 1 auto"}]}),n_=function(e){var t,n=e.initialMachineConfiguration,r=e.isTeamRepl,i=e.onChange,o=e.onConfirm,a=e.onError,l=e.onBack,c=(0,f._)((0,b.useState)(n?(0,X._)((0,M._)({},n),{maxInstances:1}):void 0),2),s=c[0],u=c[1],d=(0,f._)((0,nx.gr)(null==s?void 0:s.configurationSlug),2),p=d[0],m=d[1],g=(0,f._)((0,b.useState)(!1),2),Z=g[0],w=g[1],x=(t=(0,M._)({},ng,{onCompleted:function(e){"HostingMachineConfigurationsResults"!==e.hostingMachineConfigurations.__typename&&a("Something went wrong")},onError:function(e){return a(e.message)}}),ei.a(ny,t)),C=x.data,_=x.loading,S=(null==C?void 0:C.hostingMachineConfigurations.__typename)==="HostingMachineConfigurationsResults"?C.hostingMachineConfigurations.results:null;(0,b.useEffect)(function(){e2({context:U.k.AutoscaleMachineConfiguration})},[]),(0,b.useEffect)(function(){if(S&&!s){var e=r?S.find(function(e){return"e2-micro"===e.slug}):S.find(function(e){return"e2-small"===e.slug});if(!e){a("An error occurred trying to validate default machine configuration");return}var t={configurationId:e.id,configurationLabel:e.label,configurationSlug:e.slug,maxInstances:1};u(t),"function"==typeof i&&i(t)}},[S,s,r,i,a]);var E=S&&(null==S?void 0:S.length)>0,k=_||r||Z||!E;return(0,h.BX)(h.HY,{children:[(0,h.tZ)(z,{maxWidth:!0,children:(0,h.tZ)(np,{onBack:l})}),(0,h.BX)(z,{maxWidth:!0,children:[(0,h.BX)(v.G,{css:nC.header,children:[(0,h.tZ)(ee.xv,{variant:"subheadBig",children:"Reserved VM configuration"}),(0,h.tZ)(ee.xv,{variant:"small",color:"dimmer",children:"Reserved VM apps are always on and can have a dedicated machine. You are billed for the total number of hours your machines have been running for. The cost per hour changes depending on your machine configuration."})]}),(0,h.tZ)(nc,{id:"machineConfiguration",title:"Machine Configuration",information:"The build command is the command-line statement that compiles your app at build time.",children:s?(0,h.BX)(h.HY,{children:[(0,h.tZ)(v.G,{css:nC.selectWrapper,children:r?(0,h.tZ)(ni.II,{value:s.configurationLabel,disabled:!0}):(0,h.BX)(h.HY,{children:[(0,h.tZ)(v.G,{css:nC.selectInner,children:(0,h.tZ)(nb.P,{css:nC.select,initialSelectedItem:{id:s.configurationId,title:s.configurationLabel},items:E?Object.values(S).map(function(e){var t=e.id;return{title:e.label,id:t}}):[],onChange:function(e){var t=e.id,n=null==S?void 0:S.find(function(e){return e.id===t});if(!n){a("An error occurred trying to validate selected machine configuration");return}var r={configurationId:n.id,configurationLabel:n.label,configurationSlug:n.slug,maxInstances:1};u(r),"function"==typeof i&&i(r)},disabled:k})}),(0,h.tZ)(v.G,{css:nC.costWrapper,children:(0,h.BX)(v.G,{css:nC.cost,children:[(0,h.BX)(ee.xv,{variant:"subheadDefault",multiline:!1,children:["$",m]}),(0,h.tZ)(ee.xv,{color:"dimmer",variant:"small",multiline:!1,children:"per month"}),(0,h.BX)(ee.xv,{color:"dimmer",variant:"small",multiline:!1,children:["($",p,"/hour)"]})]})})]})}),"function"==typeof o?(0,h.BX)(v.G,{css:[y.l0.colWithGap(8),y.l0.pt(8)],children:[(0,h.tZ)(B.zx,{colorway:"primary",text:"Approve and update",iconRight:(0,h.tZ)(nZ.Z,{}),onClick:function(){if(!s){a("An error occurred trying to validate selected machine configuration");return}w(!0),o(s)},loading:_,disabled:k}),(0,h.BX)(ee.xv,{color:"dimmest",children:["Your deployed app will incur charges for any resource usage."," ",(0,h.tZ)("a",{href:nw.TT.ABOUT_USAGE_BASED_BILLING,target:"_blank",rel:"noopener",children:"Learn more"})]})]}):null]}):(0,h.tZ)(v.G,{css:[Q.p.foregroundPulse(),y.l0.borderRadius(8)],children:(0,h.tZ)(ni.II,{disabled:!0})})})]})]})},nS=n(66932),nE=(a={},(0,j._)(a,G.r4.Gce,"Reserved VM"),(0,j._)(a,G.r4.CloudRun,"Autoscale"),(0,j._)(a,G.r4.Static,"Static"),(0,j._)(a,G.r4.Cron,"Scheduled"),a),nk=n(25425),nT=n(33988),nR=n.n(nT),nD=n(44620),nI=n(97411),nG=function(e){var t=e.currentBuild,n=(0,f._)((0,b.useState)([]),2),r=n[0],i=n[1];return(0,b.useEffect)(function(){var e=(null===(r=t.repl.hostingDeployment)||void 0===r?void 0:r.__typename)==="HostingDeployment"&&t.repl.hostingDeployment.id,n=[];switch(t.provider){case G.r4.Goval:n.push({href:"https://".concat(e,".id.repl.co"),private:!0});break;case G.r4.Gce:case G.r4.CloudRun:case G.r4.Static:var r,o,a,l,c,s,u=(null===(o=t.repl.hostingDeployment)||void 0===o?void 0:o.__typename)==="HostingDeployment"?null===(a=t.repl.hostingDeployment)||void 0===a?void 0:a.replitAppSubdomain:void 0;!u&&(null===(l=t.repl.owner)||void 0===l?void 0:l.username)&&(u="".concat(t.repl.slug,"-").concat(t.repl.owner.username)),u&&n.push({href:"https://".concat(u).concat((null===(s=window)||void 0===s?void 0:null===(c=s.location)||void 0===c?void 0:c.hostname)!=="replit.com"?".staging":"",".replit.app"),private:!1})}if(t.repl.domains){var d=t.repl.domains.filter(function(t){return(null==t?void 0:t.hosting_deployment_id)===e}),f=!0,h=!1,p=void 0;try{for(var m,v=d[Symbol.iterator]();!(f=(m=v.next()).done);f=!0){var g=m.value;g&&n.push({href:"https://".concat(g.domain),private:!1,state:"verified"!==g.state?g.state:void 0})}}catch(e){h=!0,p=e}finally{try{f||null==v.return||v.return()}finally{if(h)throw p}}}i(n)},[t]),(0,h.tZ)(v.G,{css:[y.l0.colWithGap(2),y.l0.flex.growAndShrink(1)],children:r.map(function(e,t){return(0,h.BX)(v.G,{css:[y.l0.rowWithGap(8),y.l0.align.center],children:[(0,h.tZ)(ee.xv,{css:[y.l0.flex.shrink(1)],multiline:!1,children:(0,h.tZ)("a",{href:e.href,target:"_blank",css:[y.l0.color.foregroundDefault],children:e.href})}),e.private?(0,h.tZ)(nI.Z,{color:y.TV.foregroundDefault}):null,(0,h.tZ)("a",{href:e.href,target:"_blank",css:[y.l0.display.flex,y.l0.align.center],children:(0,h.tZ)(nD.Z,{color:y.TV.foregroundDefault})}),e.state?(0,h.BX)(ee.xv,{multiline:!1,children:["(",e.state,")"]}):null]},"domains-".concat(t))})})},nB=(0,Y.F4)("\n    50% {\n      background-color: ".concat(y.TV.accentPositiveDimmest,";\n      outline: 1px solid ").concat(y.TV.accentPositiveDimmer,";\n      box-shadow: 0px 0px 32px rgba(0, 145, 24, 0.3);\n    }\n")),nA=(0,E.X)({deploymentInfo:[y.l0.colWithGap(8),y.l0.p(16),y.l0.borderRadius(8),{outline:"1px solid transparent"}]}),nP=(0,E.X)({textButton:[y.l0.cursor.pointer,y.l0.reset.button,y.l0.color.accentPrimaryStronger,y.l0.focusRing,y.l0.hover(y.l0.color.accentPrimaryStrongest),{lineHeight:1.2,":not([disabled])":{cursor:"pointer"}}],textLink:y.l0.hover(y.l0.color.accentPrimaryStrongest),labeledSection:[y.l0.flex.growAndShrink(1),(0,j._)({},y.nC.min(400),[y.l0.flex.row,y.l0.align.baseline])],labeledSectionFullWidth:[y.l0.flex.growAndShrink(1),(0,j._)({},y.nC.min(400),[y.l0.flex.row,y.l0.align.baseline,y.l0.flex.grow(1),y.l0.justify.spaceBetween])],buildStatus:[y.l0.rowWithGap(4),y.l0.align.center],deploymentInfo:nA.deploymentInfo,deploymentInfoAnimate:[nA.deploymentInfo,{animation:"".concat(nB," 700ms ease-out")}],deploymentInfoContent:[y.l0.colWithGap(8),(0,j._)({},y.nC.min(400),y.l0.colWithGap(4))]}),nN=function(e){var t=e.text,n=e.onClick;return(0,h.tZ)("button",{css:nP.textButton,onClick:n,children:t})},nU=function(e){var t=e.name,n=e.sku,r=e.canManage,i=e.usageLink,o=e.onManageClick;return(0,h.BX)(v.G,{css:[y.l0.rowWithGap(6),y.l0.flex.wrap],children:[(0,h.tZ)(ee.xv,{multiline:!1,children:t}),n?(0,h.BX)(ee.xv,{color:"dimmest",multiline:!1,children:["(",n,")"]}):null,r?(0,h.tZ)(nN,{text:"Manage",onClick:o}):null,i?(0,h.tZ)(nR(),{legacyBehavior:!0,href:"/usage",passHref:!0,children:(0,h.tZ)("a",{css:nP.textLink,children:(0,h.tZ)(ee.xv,{children:"See all usage"})})}):null]})},nO=function(e){var t=e.label,n=e.children,r=e.fullWidth;return(0,h.BX)(v.G,{css:r?nP.labeledSectionFullWidth:nP.labeledSection,children:[(0,h.tZ)(v.G,{css:y.l0.minWidth(100),children:(0,h.tZ)(ee.xv,{css:y.l0.color.foregroundDimmer,multiline:!1,children:t})}),n]})},nL=function(e){var t,n,r=e.provider,i=e.machine,o=e.onViewBuildLogs,a=e.onManageClick,l=(0,Z.kW)(),c=(0,Z.Sl)((0,_.Z)()).hostingTier,s=(0,Z.$y)(),u=(0,nk.P5)({controlName:nx.dD,logFlagToAnalytics:!1}),d=void 0!==s,f=r===G.r4.Gce&&d&&!u&&!c,p=r!==G.r4.Static&&d&&null===s.hasImageTag,m=!!((l===w.z.Ready||l===w.z.Suspended)&&!p),g=null,y=null,x=null,C=null,E=(0,Z.pn)(),k=(0,b.useRef)(void 0);(0,b.useEffect)(function(){E&&(k.current=null==E?void 0:E.id)},[E,null==E?void 0:E.id]);var T=(null==s?void 0:s.status)===G.Fe.Success,R=(null==s?void 0:s.id)===k.current,D=(null==s?void 0:s.provider)!==G.r4.Cron;switch(s&&(g=(0,h.BX)(h.HY,{children:[(0,h.tZ)(nO,{label:"Status",children:(0,h.tZ)(v.G,{css:nP.buildStatus,children:(0,h.tZ)(tJ.hD,{onClick:function(){o(s)}})})}),D?(0,h.tZ)(nO,{label:"Domain",children:(0,h.tZ)(nG,{currentBuild:s})}):null]})),r){case G.r4.Gce:if(u){y=(0,h.tZ)(nO,{label:"Type",fullWidth:!d,children:(0,h.tZ)(nU,{name:nE[r],sku:null==i?void 0:i.configurationLabel,canManage:m,onManageClick:a})});break}if(!c)break;y=(0,h.tZ)(nO,{label:"Type",fullWidth:!d,children:(0,h.tZ)(nU,{name:nE[r],sku:(null==i?void 0:i.configurationLabel)||(0,nS.$)(c.sku),canManage:m,onManageClick:a})});break;case G.r4.CloudRun:y=(0,h.tZ)(nO,{label:"Type",fullWidth:!d,children:(0,h.tZ)(nU,{name:nE[r],sku:i?"".concat(i.configurationLabel," / ").concat(i.maxInstances," Max"):"Beta",canManage:m,usageLink:!0,onManageClick:a})});break;case G.r4.Static:y=(0,h.tZ)(nO,{label:"Type",fullWidth:!d,children:(0,h.tZ)(nU,{name:nE[r],sku:void 0,canManage:m&&d,onManageClick:a})});break;case G.r4.Cron:y=(0,h.tZ)(nO,{label:"Type",fullWidth:!d,children:(0,h.tZ)(nU,{name:nE[r],sku:"".concat(null==s?void 0:null===(t=s.machineJob)||void 0===t?void 0:t.timezone," ").concat(null==s?void 0:null===(n=s.machineJob)||void 0===n?void 0:n.crontab),canManage:!1,onManageClick:a})});case G.r4.Goval:}return(p&&(x=(0,h.tZ)(v.G,{children:(0,h.tZ)(S.E,{icon:(0,h.tZ)(I.Z,{}),colorway:"warning",text:"To upgrade, please redeploy."})})),f&&(C=(0,h.tZ)(B.zx,{onClick:function(){a()},text:"Select hosting tier"})),g||y||x||C)?(0,h.BX)(P.Tg,{elevated:!0,css:T&&R?nP.deploymentInfoAnimate:nP.deploymentInfo,style:{paddingTop:s?12:16},children:[s?(0,h.tZ)(ee.xv,{variant:"subheadDefault",multiline:!1,children:"Production"}):null,(0,h.BX)(v.G,{css:nP.deploymentInfoContent,children:[g,y,x,C]})]}):null},nM=n(2038),nX=n(40664),nF=n(33580),nW=n(96503),nH=n(65143),nV=(0,E.X)({styles0:[y.l0.height(128),y.l0.width(128),y.l0.borderRadius(2),A.gU.nofill],styles1:[y.l0.position.absolute]}),nz=(0,E.X)({container:[y.l0.align.center,y.l0.colWithGap(4)],qrContainer:[y.l0.align.center,y.l0.justify.center]});function nj(e){var t=e.color;return(0,h.BX)(v.G,{css:nz.container,children:[(0,h.BX)(v.G,{css:nz.qrContainer,children:[(0,h.tZ)("svg",{viewBox:"0 0 128 128",css:nV.styles0,target:"_blank",onClick:function(){window.open("/mobile")},children:(0,h.tZ)("path",{fill:null!=t?t:y.TV.foregroundDefault,d:"m0,13.58v13.58h27.15V0H0v13.58ZM34.91,1.94v1.94h-3.88v3.88h3.88v-3.88h7.76v3.88h3.88v-3.88h-3.88V0h-7.76v1.94Zm31.03,0v1.94h-15.52v7.76h-15.52v3.88h7.76v7.76h-3.88v-3.88h-7.76v11.64h-15.52v7.76h-3.88v3.88h-3.88v-3.88H0v3.88h7.76v3.88H0v7.76h3.88v3.88H0v3.88h3.88v3.88H0v3.88h3.88v3.88H0v3.88h3.88v3.88H0v3.88h15.52v3.88h-3.88v7.76h3.88v-3.88h3.88v-3.88h7.76v-3.88h-7.76v-7.76h3.88v3.88h3.88v-3.88h3.88v-3.88h3.88v-19.39h7.76v-3.88h-3.88v-3.88h-3.88v-3.88h3.88v-3.88h3.88v3.88h3.88v-3.88h3.88v-3.88h3.88v-7.76h3.88v3.88h3.88v7.76h-3.88v3.88h11.64v-3.88h3.88v3.88h15.52v3.88h-3.88v3.88h3.88v11.64h11.64v3.88h-11.64v3.88h-3.88v3.88h15.52v7.76h-3.88v-3.88h-3.88v3.88h-3.88v-3.88h-3.88v3.88h3.88v15.52h3.88v15.52h7.76v3.88h-3.88v3.88h-3.88v-3.88h-3.88v3.88h-7.76v-3.88h-3.88v3.88h3.88v3.88h-11.64v-3.88h3.88v-7.76h7.76v-3.88h7.76v-3.88h-3.88v-3.88h-3.88v-3.88h3.88v-11.64h-11.64v3.88h3.88v3.88h-7.76v-3.88h-7.76v-3.88h-7.76v3.88h7.76v7.76h-7.76v-3.88h-15.52v7.76h3.88v-3.88h7.76v3.88h3.88v3.88h-3.88v3.88h-11.64v-3.88h-3.88v-7.76h-3.88v15.52h3.88v3.88h3.88v-3.88h3.88v3.88h3.88v3.88h3.88v3.88h7.76v-3.88h-7.76v-3.88h15.52v-3.88h-3.88v-3.88h7.76v-7.76h11.64v7.76h-7.76v3.88h-3.88v7.76h-3.88v3.88h3.88v3.88h27.15v-7.76h3.88v7.76h7.76v-3.88h3.88v3.88h3.88v-3.88h-3.88v-7.76h3.88v3.88h3.88v-3.88h3.88v-3.88h-3.88v3.88h-3.88v-3.88h-3.88v-11.64h3.88v3.88h3.88v3.88h7.76v-3.88h-3.88v-3.88h-7.76v-7.76h-3.88v-7.76h7.76v7.76h7.76v-3.88h-3.88v-7.76h-7.76v-3.88h-7.76v3.88h-3.88v-11.64h3.88v3.88h7.76v-3.88h-7.76v-3.88h3.88v-7.76h3.88v-3.88h3.88v3.88h3.88v3.88h-3.88v15.52h3.88v-11.64h3.88v-7.76h-3.88v-7.76h3.88v-7.76h-3.88v-11.64h-3.88v11.64h3.88v3.88h-3.88v3.88h-7.76v-3.88h3.88v-3.88h-3.88v-3.88h3.88v-3.88h-3.88v3.88h-3.88v-7.76h-7.76v3.88h3.88v3.88h-11.64v-3.88h3.88v-11.64h-3.88v7.76h-3.88v-11.64h3.88v-3.88h-3.88v3.88h-3.88v-3.88h-3.88v-3.88h7.76V3.88h3.88v3.88h3.88V0h-7.76v3.88h-3.88V0h-3.88v3.88h-7.76V0h-7.76v1.94Zm34.91,11.64v13.58h27.15V0h-27.15v13.58Zm-31.03-5.82v3.88h-7.76v3.88h-3.88v7.76h3.88v3.88h-3.88v-3.88h-3.88v3.88h-3.88v3.88h-3.88v7.76h-3.88v-7.76h-3.88v7.76h-3.88v3.88h-3.88v-3.88h-11.64v-3.88h11.64v-3.88h3.88v-7.76h3.88v3.88h3.88v-3.88h3.88v3.88h3.88v-3.88h3.88v-3.88h-7.76v-3.88h3.88v-3.88h3.88v3.88h3.88v-7.76h7.76v-3.88h3.88v3.88Zm-46.8,5.82v9.45H4.13V4.13h18.89v9.45Zm100.85,0v9.45h-18.89V4.13h18.89v9.45Zm-116.11,0v5.82h11.64V7.76H7.76v5.82Zm73.7-3.88v1.94h-3.88v7.76h-3.88v3.88h3.88v3.88h3.88v-7.76h3.88v7.76h-3.88v3.88h-3.88v-3.88h-3.88v3.88h-3.88v3.88h-3.88v-3.88h3.88v-3.88h-3.88v-11.64h3.88v3.88h3.88V7.76h7.76v1.94Zm27.15,3.88v5.82h11.64V7.76h-11.64v5.82Zm-38.79,11.64v1.94h3.88v-3.88h-3.88v1.94Zm-27.15,3.88v1.94h3.88v-3.88h-3.88v1.94Zm46.55,7.76v1.94h-11.64v-3.88h11.64v1.94Zm-62.06,7.76v1.94h-3.88v3.88h11.64v3.88h-11.64v3.88h3.88v3.88h3.88v11.64h-3.88v3.88h-3.88v-3.88h-3.88v3.88h-3.88v3.88h-3.88v-3.88h-3.88v-7.76h3.88v-11.64h3.88v3.88h3.88v-7.76h-7.76v-3.88h-3.88v-3.88h3.88v-3.88h15.52v1.94Zm81.45,1.94v3.88h3.88v7.76h-3.88v7.76h-3.88v3.88h-3.88v-3.88h3.88v-11.64h-3.88v-3.88h-3.88v-3.88h-3.88v-3.88h15.52v3.88Zm-96.97,1.94v1.94h3.88v-3.88h-3.88v1.94Zm89.21,0v1.94h3.88v3.88h3.88v-3.88h-3.88v-3.88h-3.88v1.94Zm-81.45,3.88v1.94h3.88v-3.88h-3.88v1.94Zm77.58,3.88v1.94h-3.88v-3.88h3.88v1.94Zm-77.58,9.7v3.88h-7.76v7.76h3.88v-3.88h3.88v-3.88h3.88v3.88h3.88v-3.88h-3.88v-3.88h3.88v-3.88h-7.76v3.88Zm19.39-1.94v1.94h3.88v-3.88h-3.88v1.94Zm0,11.64v1.94h-3.88v7.76h-3.88v3.88h3.88v-3.88h3.88v3.88h3.88v-7.76h-3.88v-3.88h3.88v-3.88h-3.88v1.94Zm58.18,7.76v1.94h3.88v-3.88h3.88v11.64h-7.76v-3.88h-3.88v-7.76h3.88v1.94Zm15.52,0v1.94h-3.88v-3.88h3.88v1.94ZM0,95.03v1.94h7.76v-3.88H0v1.94Zm23.27,0v1.94h3.88v-3.88h-3.88v1.94Zm46.55,0v1.94h-3.88v-3.88h3.88v1.94Zm38.79,7.76v5.82h-11.64v-11.64h11.64v5.82ZM0,114.42v13.58h27.15v-27.15H0v13.58Zm65.94-11.64v1.94h-3.88v-3.88h3.88v1.94Zm34.91,0v1.94h3.88v-3.88h-3.88v1.94Zm-42.67,3.88v1.94h-3.88v3.88h-3.88v-3.88h3.88v-3.88h3.88v1.94Zm-35.16,7.76v9.45H4.13v-18.89h18.89v9.45Zm-15.26,0v5.82h11.64v-11.64H7.76v5.82Zm100.85,3.88v1.94h-3.88v-3.88h3.88v1.94Zm-69.82,3.88v1.94h-3.88v3.88h3.88v-3.88h3.88v3.88h3.88v-3.88h-3.88v-3.88h-3.88v1.94Zm54.3,0v1.94h-3.88v-3.88h3.88v1.94Zm31.03,3.88v1.94h3.88v-3.88h-3.88v1.94Z"})}),(0,h.tZ)(nH.Z,{size:32,css:nV.styles1,color:t})]}),(0,h.tZ)(ee.xv,{variant:"small",color:"dimmer",children:"Scan to install"})]})}var nq=n(49344),nY=n(58719),n$=n(31661),nJ=n(67795),nK=(0,E.X)({row:[y.l0.pb(12),y.l0.rowWithGap(2),y.l0.justify.center],buttonLeft:[y.l0.borderRadius(8,0,0,8),y.l0.flex.growAndShrink(1)],buttonRight:[y.l0.borderRadius(0,8,8,0)]});function nQ(e){var t=e.shouldShow,n=e.onDismissTour,r=(0,f._)((0,b.useState)(!1),2),i=r[0],o=r[1];return(0,h.BX)(h.HY,{children:[t?(0,h.BX)(v.G,{css:nK.row,children:[(0,h.tZ)(B.zx,{iconLeft:(0,h.tZ)(n$.Z,{}),onClick:function(){(0,e1.j)(nJ.U3.DEPLOYMENT_MOBILE_DOWNLOAD_QR_VIEWED),o(!0)},text:"Deploy with the Replit App!",css:nK.buttonLeft}),(0,h.tZ)(B.zx,{css:nK.buttonRight,text:"",iconLeft:(0,h.tZ)(nY.Z,{}),onClick:n})]}):null,(0,h.tZ)(nq.u,{isOpen:i,onRequestClose:function(){o(!1),n()},children:(0,h.tZ)(nj,{})})]})}var n0=n(99656),n1=n(52489);function n2(e){var t=e.secrets,n=e.otherSecrets,r=new Map,i=!0,o=!1,a=void 0;try{for(var l,c=n[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var s=(0,f._)(l.value,2),u=s[0],d=s[1];t.has(u)||r.set(u,d)}}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}return{missing:r}}var n8=(0,E.X)({root:[y.l0.borderRadius(8),{border:"1px solid "+y.TV.outlineDimmer}],button:[y.l0.reset.button,A.gU.nofill,y.l0.rowWithGap(8),y.l0.align.center,y.l0.height(32),y.l0.px(8),{border:"0 none",borderBottomLeftRadius:0,borderBottomRightRadius:0}],buttonText:[y.l0.flex.growAndShrink(1),y.l0.rowWithGap(8),y.l0.align.center],expanded:[y.l0.px(8),y.l0.pb(8)],missingItems:[y.l0.colWithGap(8)],missingItem:[y.l0.rowWithGap(8)],missingSecret:[y.l0.rowWithGap(8),y.l0.flex.growAndShrink(1)],subtitle:[{borderTop:"1px solid "+y.TV.outlineDimmest,top:-1},y.l0.py(8),y.l0.position.relative]});function n4(e){var t=e.secrets,n=e.otherSecrets,r=e.otherEnvName,i=e.onAddSecret,o=e.initialExpanded,a=n2({secrets:t,otherSecrets:n}).missing,l=(0,f._)((0,b.useState)(o),2),c=l[0],s=l[1],u=0===a.size;if((0,b.useEffect)(function(){u&&s(!1)},[u]),u)return null;var d="".concat(a.size," ").concat((0,tK.Z)("secret",a.size)," out of sync"),p=1===a.size?"A ".concat(r," secret is missing from this environment"):"".concat(a.size," ").concat(r," secrets are missing from this environment");return(0,h.BX)(v.G,{css:n8.root,children:[(0,h.BX)(v.G,{css:n8.button,tag:"button",onClick:function(){return s(function(e){return!e})},children:[(0,h.BX)(v.G,{css:n8.buttonText,children:[(0,h.tZ)(I.Z,{color:y.TV.orangeDefault}),(0,h.tZ)(ee.xv,{multiline:!1,children:d})]}),c?(0,h.tZ)(tr.Z,{}):(0,h.tZ)(eK.Z,{})]}),c?(0,h.BX)(v.G,{css:n8.expanded,children:[(0,h.tZ)(ee.xv,{css:n8.subtitle,color:"dimmer",children:p}),(0,h.tZ)(v.G,{css:n8.missingItems,children:(0,eS._)(a.entries()).map(function(e){var t=(0,f._)(e,2),n=t[0],r=t[1];return(0,h.BX)(v.G,{css:n8.missingItem,children:[(0,h.BX)(v.G,{css:n8.missingSecret,children:[(0,h.tZ)(n1.u_,{value:n}),(0,h.tZ)(n1.BH,{value:r})]}),r?(0,h.tZ)(B.zx,{iconLeft:(0,h.tZ)(n0.Z,{}),variant:"outlined",text:"Add secret",onClick:function(){return i({key:n,value:r})}}):null]},n)})})]}):null]})}var n3=n(28268);function n5(e){var t=e.fs,n=(0,f._)((0,b.useState)(null),2),r=n[0],i=n[1],o=(0,f._)((0,b.useState)(null),2),a=o[0],l=o[1];return(0,b.useEffect)(function(){return t.watchFile(".env",{onChange:function(e){var t=n3.Z.parse(e.toString());i(new Map(Object.entries(t).map(function(e){var t=(0,f._)(e,2);return[t[0],t[1]]})))},onMoveOrDelete:function(){return i(null)},onError:l})},[t]),{devSecrets:r,error:a}}var n6=n(14207),n9=n(92741),n7=n(16643),re=n(75246),rt=n(87659),rn=n(35375),rr=n(72903),ri=n(1854),ro=(0,E.X)({self:[y.l0.colWithGap(8),y.l0.mt(8)],accordion:[y.l0.mb(0)],accordionItem:[y.l0.rowWithGap(4),y.l0.align.center]});function ra(e){var t=e.hasPortsConfigured,n=e.hasPort80Configured;return t?n?(0,h.tZ)(S.E,{text:"Deployments forward External Port :80.",colorway:"primary"}):(0,h.tZ)(S.E,{text:"Potential port issue. Deployments require one Internal Port configured to External Port :80.",colorway:"warning"}):(0,h.tZ)(S.E,{text:"No ports configured. Deployments will automatically forward the first Internal Port that opens.",colorway:"warning"})}function rl(e){var t=e.ports,n=e.openDotReplit,r=(0,n7.Z)(t.portsState),i=!!(r&&r.length>0),o=!!(i&&(null==r?void 0:r.find(function(e){return"externalPort"in e.configuration&&80===e.configuration.externalPort}))),a=(0,f._)((0,b.useState)(!1),2),l=a[0],c=a[1],s=function(e){if(e.type===rr.Zp.REMOVE){var n=e.payload.portState.configuration.localPort,r=(0,rn.OD)(e.payload.portState.configuration);t.removeDotReplitPortsMapping(n,r)}};return(0,h.tZ)(re.Q,{headerContent:(0,h.BX)(v.G,{css:ro.accordionItem,children:[(0,h.tZ)(nc,{id:"deploymentPortConfiguration",title:"Port configuration",information:"Configure your app based on whether it needs to serve traffic from the web."}),o?null:(0,h.tZ)(I.Z,{size:16,color:rt.Br.warning.strongest})]}),expanded:l,onClick:function(){return c(!l)},css:ro.accordion,children:(0,h.BX)(v.G,{css:ro.self,children:[(0,h.tZ)(ra,{hasPortsConfigured:i,hasPort80Configured:o}),(0,h.BX)(ri.iA,{children:[(0,h.BX)(ri.X2,{children:[(0,h.tZ)(ri.sg,{header:!0,width:rr.mH,children:"Internal Port"}),(0,h.tZ)(ri.sg,{header:!0,width:rr.Dq,children:"External Port"}),(0,h.tZ)(ri.sg,{header:!0,width:rr.rl})]}),i?null==r?void 0:r.map(function(e){return(0,h.BX)(ri.X2,{children:[(0,h.tZ)(rr.BM,{portState:e,width:rr.mH}),(0,h.tZ)(rr.GZ,{portState:e,width:rr.Dq}),(0,h.tZ)(rr.Wz,{portState:e,onAction:s,allowedActions:[rr.Zp.REMOVE]})]},e.configuration.localPort)}):null,(0,h.tZ)(rr.aP,{openDotReplit:n})]})]})})}var rc=JSON.parse('[{"title":"ACDT"},{"title":"ACT"},{"title":"ACWST"},{"title":"ADT"},{"title":"AEDT"},{"title":"AEST"},{"title":"AET"},{"title":"AFT"},{"title":"AKDT"},{"title":"AKST"},{"title":"ALMT"},{"title":"AMST"},{"title":"AMT"},{"title":"ANAST"},{"title":"ANAT"},{"title":"AQTT"},{"title":"ART"},{"title":"AST"},{"title":"AT"},{"title":"AWDT"},{"title":"AWST"},{"title":"AZOST"},{"title":"AZOT"},{"title":"AZST"},{"title":"AZT"},{"title":"AoE"},{"title":"BNT"},{"title":"BOT"},{"title":"BRST"},{"title":"BRT"},{"title":"BST"},{"title":"BTT"},{"title":"CAST"},{"title":"CAT"},{"title":"CCT"},{"title":"CDT"},{"title":"CEST"},{"title":"CET"},{"title":"CHADT"},{"title":"CHAST"},{"title":"CHOST"},{"title":"CHOT"},{"title":"CHUT"},{"title":"CIDST"},{"title":"CIST"},{"title":"CKT"},{"title":"CLST"},{"title":"CLT"},{"title":"COT"},{"title":"CST"},{"title":"CT"},{"title":"CVT"},{"title":"CXT"},{"title":"ChST"},{"title":"DAVT"},{"title":"DDUT"},{"title":"EASST"},{"title":"EAST"},{"title":"EAT"},{"title":"ECT"},{"title":"EDT"},{"title":"EEST"},{"title":"EET"},{"title":"EGST"},{"title":"EGT"},{"title":"EST"},{"title":"ET"},{"title":"FET"},{"title":"FJST"},{"title":"FJT"},{"title":"FKST"},{"title":"FKT"},{"title":"FNT"},{"title":"GALT"},{"title":"GAMT"},{"title":"GET"},{"title":"GFT"},{"title":"GILT"},{"title":"GMT"},{"title":"GST"},{"title":"GYT"},{"title":"HDT"},{"title":"HKT"},{"title":"HOVST"},{"title":"HOVT"},{"title":"HST"},{"title":"ICT"},{"title":"IDT"},{"title":"IOT"},{"title":"IRDT"},{"title":"IRKST"},{"title":"IRKT"},{"title":"IRST"},{"title":"IST"},{"title":"JST"},{"title":"KGT"},{"title":"KOST"},{"title":"KRAST"},{"title":"KRAT"},{"title":"KST"},{"title":"KUYT"},{"title":"LHDT"},{"title":"LHST"},{"title":"LINT"},{"title":"MAGST"},{"title":"MAGT"},{"title":"MART"},{"title":"MAWT"},{"title":"MDT"},{"title":"MHT"},{"title":"MMT"},{"title":"MSD"},{"title":"MSK"},{"title":"MST"},{"title":"MT"},{"title":"MUT"},{"title":"MVT"},{"title":"MYT"},{"title":"NCT"},{"title":"NDT"},{"title":"NFT"},{"title":"NOVST"},{"title":"NOVT"},{"title":"NPT"},{"title":"NRT"},{"title":"NST"},{"title":"NUT"},{"title":"NZDT"},{"title":"NZST"},{"title":"OMSST"},{"title":"OMST"},{"title":"ORAT"},{"title":"PDT"},{"title":"PET"},{"title":"PETST"},{"title":"PETT"},{"title":"PGT"},{"title":"PHOT"},{"title":"PHT"},{"title":"PKT"},{"title":"PMDT"},{"title":"PMST"},{"title":"PONT"},{"title":"PST"},{"title":"PT"},{"title":"PWT"},{"title":"PYST"},{"title":"PYT"},{"title":"QYZT"},{"title":"RET"},{"title":"ROTT"},{"title":"SAKT"},{"title":"SAMT"},{"title":"SAST"},{"title":"SBT"},{"title":"SCT"},{"title":"SGT"},{"title":"SRET"},{"title":"SRT"},{"title":"SST"},{"title":"SYOT"},{"title":"TAHT"},{"title":"TFT"},{"title":"TJT"},{"title":"TKT"},{"title":"TLT"},{"title":"TMT"},{"title":"TOST"},{"title":"TOT"},{"title":"TRT"},{"title":"TVT"},{"title":"ULAST"},{"title":"ULAT"},{"title":"UTC"},{"title":"UYST"},{"title":"UYT"},{"title":"UZT"},{"title":"VET"},{"title":"VLAST"},{"title":"VLAT"},{"title":"VOST"},{"title":"VUT"},{"title":"WAKT"},{"title":"WARST"},{"title":"WAST"},{"title":"WAT"},{"title":"WEST"},{"title":"WET"},{"title":"WFT"},{"title":"WGST"},{"title":"WGT"},{"title":"WIB"},{"title":"WIT"},{"title":"WITA"},{"title":"WST"},{"title":"WT"},{"title":"YAKST"},{"title":"YAKT"},{"title":"YAPT"},{"title":"YEKST"},{"title":"YEKT"}]'),rs=(0,E.X)({self:{ul:{maxHeight:"300px"}}});function ru(e){var t=e.onChange,n=e.error,r=(0,f._)((0,b.useState)(),2),i=r[0],o=r[1],a=(0,b.useId)();return((0,b.useEffect)(function(){if(!i){var e=Intl.DateTimeFormat().resolvedOptions().timeZone,n=(0,nx.p8)(new Date,e),r=rc.find(function(e){return e.title===n});if(r){t(r.title),o(r);return}var a=rc.find(function(e){return"PST"===e.title});a&&(t(a.title),o(a))}},[t,i]),i)?(0,h.BX)(v.G,{css:rs.self,children:[(0,h.tZ)(nb.P,{placeholder:"Select timezone",initialSelectedItem:i,items:rc,onChange:function(e){return t(e.title)}}),n?(0,h.tZ)(v.G,{css:[y.l0.color.accentNegativeStronger],"aria-live":"polite","aria-atomic":"true",id:a,children:(0,h.tZ)("span",{children:n})}):null]}):null}var rd=n(7444),rf=n(55534),rh=n(64461),rp=n(8668),rm=n(30084),rv=n(22487),rg=n(59639),ry=n(10981);function rb(){var e=(0,en._)(["\n  query CheckReplitAppSubdomainAvailability(\n    $subdomain: String!\n    $deploymentId: String\n  ) {\n    replitAppSubdomainAvailability(\n      subdomain: $subdomain\n      deploymentId: $deploymentId\n    ) {\n      __typename\n      ... on ReplitAppSubdomainAvailabilityResult {\n        available\n        message\n      }\n      ... on UserError {\n        errorMessage: message\n      }\n    }\n  }\n"]);return rb=function(){return e},e}var rZ={},rw=(0,er.Ps)(rb()),rx=function(e){var t=e.id,n=e.value,r=e.loading,i=e.disabled,o=e.onChange,a=e.error,l=(0,rp.Ar)(n),c=(0,b.useId)();return(0,h.BX)(v.G,{css:[y.l0.colWithGap(4)],children:[(0,h.tZ)(ni.II,{id:t,value:l?n:"",onChange:function(e){return o(e.target.value)},css:[y.l0.color.greyStrongest],disabled:r||i,"aria-describedby":c}),a?(0,h.tZ)(v.G,{css:[y.l0.color.accentNegativeStronger],"aria-live":"polite","aria-atomic":"true",id:c,children:(0,h.tZ)("span",{children:a})}):null]})},rC=(0,E.X)({root:[y.l0.rowWithGap(8),y.l0.align.center],iconButton:[y.l0.height("100%"),y.l0.borderRadius(8),{"& button":y.l0.height(32)}],keyInput:[y.l0.width("40%")],valueInput:[y.l0.flex.growAndShrink(1)]}),r_=function(e){var t=e.index,n=e.name,r=e.value,i=e.disabled,o=e.updateEnvVarName,a=e.updateEnvVarValue,l=e.removeEnvVar,c=e.otherKeys,s=(0,ry.U)(),u=(0,f._)((0,b.useState)(""===n||""===r),2),d=u[0],p=u[1],m=!!(n&&r),g=(0,rd.Z)(m),Z=(0,rv.Z)(function(){Z.current&&g.current&&p(!1)},[g]);return d?(0,h.BX)(h.HY,{children:[(0,h.BX)(v.G,{css:rC.root,innerRef:Z,children:[(0,h.tZ)(v.G,{css:rC.keyInput,children:(0,h.tZ)(ni.II,{placeholder:"Name",id:"".concat(s,"-name-").concat(t),value:n,onChange:function(e){return o(e.currentTarget.value)},onKeyDown:function(e){"Enter"===e.key&&m&&p(!1)},disabled:i})}),(0,h.tZ)(v.G,{css:rC.valueInput,children:(0,h.tZ)(ni.II,{placeholder:"Value",name:"".concat(s,"-value-").concat(t),value:r,onChange:function(e){return a(e.currentTarget.value)},onKeyDown:function(e){"Enter"===e.key&&m&&p(!1)},disabled:i})}),i?null:(0,h.tZ)(P.Tg,{elevated:!0,css:rC.iconButton,children:(0,h.tZ)(eP.hU,{alt:"Add",tooltipHidden:!0,onClick:function(){m?p(!1):l()},children:m?(0,h.tZ)(ts.Z,{}):(0,h.tZ)(nY.Z,{})})})]}),c.includes(n)?(0,h.BX)(ee.xv,{variant:"small",css:{color:y.TV.accentNegativeDefault},children:['Secret "',n,'" already exists']}):null]}):(0,h.BX)(v.G,{css:rC.root,children:[(0,h.tZ)(n1.u_,{value:n}),(0,h.tZ)(n1.BH,{value:r}),(0,h.tZ)(n1.$M,{onEdit:function(){return p(!0)},onDelete:function(){return l()}})]})},rS=function(e){var t,n,r,i,o,a=e.id,l=e.subdomain,c=e.deploymentId,s=e.onChange,u=e.updateValidity,d=(t={variables:{subdomain:l,deploymentId:c},skip:0===l.length},n=(0,M._)({},rZ,t),ei.a(rw,n)),f=d.data,p=d.loading,m=d.error,Z=(null==f?void 0:f.replitAppSubdomainAvailability.__typename)==="ReplitAppSubdomainAvailabilityResult"&&f.replitAppSubdomainAvailability.available,w=(null==f?void 0:f.replitAppSubdomainAvailability.__typename)==="ReplitAppSubdomainAvailabilityResult"?f.replitAppSubdomainAvailability.message:null==f?void 0:null===(r=f.replitAppSubdomainAvailability)||void 0===r?void 0:r.errorMessage;return((0,b.useEffect)(function(){u(Z)},[Z]),m)?(0,h.tZ)(S.E,{colorway:"negative",text:"Something went wrong, please try refreshing the page."}):(0,h.BX)(v.G,{children:[(0,h.BX)(v.G,{css:[y.l0.rowWithGap(4),y.l0.align.center],children:[(0,h.tZ)(ni.II,{id:a,placeholder:"subdomain",value:l,onChange:function(e){return s(e.target.value)}}),(0,h.BX)(ee.xv,{multiline:!1,children:[(null===(o=window)||void 0===o?void 0:null===(i=o.location)||void 0===i?void 0:i.hostname)!=="replit.com"?".staging":"",".replit.app"]})]}),(0,h.BX)(v.G,{css:[y.l0.rowWithGap(4),y.l0.align.center,y.l0.pt(4)],children:[p?(0,h.BX)(h.HY,{children:[(0,h.tZ)(g.Z,{}),(0,h.tZ)(ee.xv,{multiline:!1,children:"Checking availability"})]}):null,Z?(0,h.BX)(h.HY,{children:[(0,h.tZ)(ts.Z,{color:"green"}),(0,h.tZ)(ee.xv,{css:[y.l0.color.greenDefault],multiline:!1,children:"Available"})]}):null,Z||p?null:(0,h.BX)(h.HY,{children:[(0,h.tZ)(I.Z,{color:"red"}),(0,h.tZ)(ee.xv,{css:[y.l0.color.redDefault],multiline:!1,children:w})]})]})]})},rE=function(e){var t=e.appType,n=e.onChange,r=(0,ry.U)();return(0,h.tZ)(rg.hE,{name:"deploymentTargetSelector",value:t,onChange:n,row:!0,css:[y.l0.width("100%"),y.l0.flex.row],children:[{value:G.Vp.Server,name:"Web Server",description:"ex. an API or website"},{value:G.Vp.Worker,name:"Background Worker",description:"ex. a Discord or Slack bot"}].map(function(e,t){return(0,h.tZ)(v.G,{css:[y.l0.flex.grow(1)],children:(0,h.tZ)(no.u,{tooltip:e.description,children:(0,h.tZ)(rg.rK,{id:r(e.value),value:e.value,text:e.name})})},t)})})};function rk(){var e=(0,en._)(["\n  fragment DeploymentsDeployOptionsDeployment on HostingDeployment {\n    id\n    replitAppSubdomain\n    currentBuild {\n      id\n      provider\n      envVars {\n        name\n        value\n      }\n      machineJob {\n        timezone\n        crontab\n      }\n    }\n  }\n"]);return rk=function(){return e},e}function rT(){var e=(0,en._)(["\n  query DeploymentsDeployOptions($id: String!) {\n    hostingDeployment(id: $id) {\n      ... on HostingDeployment {\n        id\n        ...DeploymentsDeployOptionsDeployment\n      }\n    }\n  }\n  ","\n"]);return rT=function(){return e},e}var rR={},rD=(0,er.Ps)(rk()),rI=(0,er.Ps)(rT(),rD);function rG(){return(rG=(0,x._)(function(e){var t,n,r,i,o,a,l,c,s,u,d,f,h,p,m,v,g;return(0,C.Jh)(this,function(y){switch(y.label){case 0:t=["webpack.config.js","vite.config.js","webpack.config.ts","vite.config.ts"],n=!0,r=!1,i=void 0,y.label=1;case 1:y.trys.push([1,6,7,8]),o=t[Symbol.iterator](),y.label=2;case 2:if(n=(a=o.next()).done)return[3,5];return l=a.value,[4,e.stat(l)];case 3:if(!((c=y.sent()).exists&&c.type===rm.Tv.File))return[3,4];return[2,"dist"];case 4:return n=!0,[3,2];case 5:return[3,8];case 6:return s=y.sent(),r=!0,i=s,[3,8];case 7:try{n||null==o.return||o.return()}finally{if(r)throw i}return[7];case 8:u=["dist","build","public"],d=!0,f=!1,h=void 0,y.label=9;case 9:y.trys.push([9,14,15,16]),p=u[Symbol.iterator](),y.label=10;case 10:if(d=(m=p.next()).done)return[3,13];return v=m.value,[4,e.stat(v)];case 11:if(!((g=y.sent()).exists&&g.type===rm.Tv.Directory))return[3,12];return[2,v];case 12:return d=!0,[3,10];case 13:return[3,16];case 14:return s=y.sent(),f=!0,h=s,[3,16];case 15:try{d||null==p.return||p.return()}finally{if(f)throw h}return[7];case 16:return[2]}})})).apply(this,arguments)}var rB=function(e){var t,n,r,i,o,a,l,c,s,u,d,p,m,_,S,E,k,R=e.deploymentId,D=e.initialSubdomain,I=e.provider,A=e.machine,P=e.fs,N=e.ports,U=e.dotReplit,O=e.onDeploy,L=e.onCancel,X=e.onError,F=e.initialSecretsSyncExpanded,W=e.openDotReplit,H=(0,Z.kW)(),V=(0,Z.XA)(),z=(t=(0,M._)({},rR,{skip:!R,variables:{id:null!=R?R:""},fetchPolicy:"cache-and-network",ssr:!1,onCompleted:function(e){var t,n=(null===(t=e.hostingDeployment)||void 0===t?void 0:t.__typename)==="HostingDeployment"?e.hostingDeployment:null;n&&(n.replitAppSubdomain&&(eo(n.replitAppSubdomain),ec(!0)),n.currentBuild.machineJob&&(eZ(n.currentBuild.machineJob.timezone),eE(n.currentBuild.machineJob.crontab)),eG(n.currentBuild.envVars.map(function(e){return{name:e.name,value:e.value}})))}}),ei.a(rI,t)),j=z.data,q=z.loading,Y=(r=(n={provider:I,fs:P,dotReplit:U,isNewDeployment:!R,onError:X,onOptions:function(e){e.appType&&et(e.appType),e.envVars&&eG(e.envVars),e.ignorePorts&&eN(e.ignorePorts),e.buildCommand&&ed(e.buildCommand),e.runCommand&&ep(e.runCommand),e.publicDir&&eL(e.publicDir)}}).isNewDeployment,i=n.provider,o=n.fs,a=n.onOptions,l=n.onError,c=n.dotReplit,u=(s=(0,f._)((0,b.useState)(!0),2))[0],d=s[1],p=(0,rd.Z)(l),m=(0,rd.Z)(a),(0,b.useEffect)(function(){var e=!1;function t(){return(t=(0,x._)(function(){var t,n,a,l,s,u,h,p,v;return(0,C.Jh)(this,function(g){switch(g.label){case 0:return t=G.Vp.Server,n=null,a=null,l=null,s=null,[4,Promise.all([r?(0,n6.xk)(o):Promise.resolve(null),(0,n6.$f)(c)])];case 1:if(h=(u=f._.apply(void 0,[g.sent(),2]))[0],p=u[1],e)return[2];if(r)switch(i){case G.r4.Gce:t=p.ignorePorts?G.Vp.Worker:G.Vp.Server;break;case G.r4.CloudRun:t=G.Vp.CloudRun;break;case G.r4.Static:t=G.Vp.Static;break;case G.r4.Cron:t=G.Vp.Cron}else p.appType&&(t=p.appType);if(a=p.buildCommand,!(t!==G.Vp.Static))return[3,2];return n=p.runCommand,[3,5];case 2:if(!p.publicDir)return[3,3];return l=p.publicDir,[3,5];case 3:return[4,function(e){return rG.apply(this,arguments)}(o)];case 4:(v=g.sent())&&(l=v),g.label=5;case 5:return i===G.r4.Gce&&(s=p.ignorePorts),m.current({appType:t,envVars:h,buildCommand:a,runCommand:n,publicDir:l,ignorePorts:s}),d(!1),[2]}})})).apply(this,arguments)}try{!function(){t.apply(this,arguments)}()}catch(e){p.current(e.message),d(!1)}return function(){e=!0}},[i,o,c,p,m,r]),{loading:u}).loading,$=(null==j?void 0:null===(E=j.hostingDeployment)||void 0===E?void 0:E.__typename)==="HostingDeployment"?j.hostingDeployment:null,J=null==$?void 0:$.currentBuild,K=(0,f._)((0,b.useState)(G.Vp.Server),2),Q=K[0],et=K[1],en=(0,f._)((0,b.useState)(D),2),er=en[0],eo=en[1],ea=(0,f._)((0,b.useState)(!1),2),el=ea[0],ec=ea[1],es=(0,f._)((0,b.useState)(null),2),eu=es[0],ed=es[1],ef=(0,f._)((0,b.useState)(null),2),eh=ef[0],ep=ef[1],em=(0,f._)((0,b.useState)(void 0),2),ev=em[0],eg=em[1],ey=(0,f._)((0,b.useState)(null),2),eb=ey[0],eZ=ey[1],ew=(0,f._)((0,b.useState)(void 0),2),ex=ew[0],eC=ew[1],e_=(0,f._)((0,b.useState)(null),2),eS=e_[0],eE=e_[1],ek=(0,f._)((0,b.useState)(void 0),2),eT=ek[0],eR=ek[1],eD=(0,f._)((0,b.useState)(null!==(k=null==J?void 0:J.envVars.map(function(e){return{name:e.name,value:e.value}}))&&void 0!==k?k:[]),2),eI=eD[0],eG=eD[1],eB=(0,f._)((0,b.useState)(!1),2),eA=eB[0],eN=eB[1],eU=(0,f._)((0,b.useState)(null),2),eO=eU[0],eL=eU[1],eM=(0,f._)((0,b.useState)(void 0),2),eX=eM[0],eF=eM[1],eW=n5({fs:P}).devSecrets;(0,b.useEffect)(function(){e2({context:"deploy_options"})},[]);var eH=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.name,n=e.value;eG(function(e){return(0,rh.Uy)(e,function(e){e.push({name:null!=t?t:"",value:null!=n?n:""})})})},eV=function(e,t){eG(function(n){return(0,rh.Uy)(n,function(n){n[e].name=t})})},ez=function(e,t){eG(function(n){return(0,rh.Uy)(n,function(n){n[e].value=t})})},ej=function(e){eG(function(t){return(0,rh.Uy)(t,function(t){t.splice(e,1)})})},eq=Q!==G.Vp.Static,eY=I===G.r4.Gce,e$=Q===G.Vp.Static,eJ=I!==G.r4.Cron&&!(null==$?void 0:$.replitAppSubdomain),eK=I===G.r4.Cron,eQ=Q===G.Vp.Server||Q===G.Vp.CloudRun,e0=(_=(0,x._)(function(){var e,t;return(0,C.Jh)(this,function(n){switch(n.label){case 0:if(!(e=(!eJ||el)&&er.length?er:void 0))return[2];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,V({envVars:eI.filter(function(e){return(0,rp.GV)(e)}),subdomain:e,machineConfigurationId:(null==A?void 0:A.configurationId)||void 0,maxMachineInstances:(null==A?void 0:A.maxInstances)||void 0,machineJob:eb&&eS?{timezone:eb,crontab:eS}:void 0,config:{buildCommand:eu,runCommand:eh,appType:Q,ignorePorts:eA,publicDir:eO}})];case 2:return n.sent(),O(),[3,4];case 3:if((t=n.sent())instanceof n9.ZG)return eg("Run command cannot be empty."),[2];if(t instanceof n9.SF)return eF("Public directory cannot be empty."),[2];if(t instanceof n9.Iy)return eC(t.message||"Invalid timezone."),[2];if(t instanceof n9.Bz)return eR(t.message||"Invalid crontab."),[2];return X(t.message),[3,4];case 4:return[2]}})}),function(){return _.apply(this,arguments)}),e1=(0,f._)((0,b.useState)(!1),2),e8=e1[0],e4=e1[1],e3=(0,f._)((0,b.useState)(!1),2),e5=e3[0],e6=e3[1],e9=q||Y||H===w.z.Preparing,e7=e9||eJ&&!el,te=eI.map(function(e){return e.name}),tt=(0,rf.Z)(),tn=(S=(0,x._)(function(){var e,t,n,r,i,o;return(0,C.Jh)(this,function(a){switch(a.label){case 0:return e4(!0),e=eI.reduce(function(e,t){return e[t.name]=t.value,e},{}),[4,P.readFile(".env")];case 1:if(t=a.sent(),n="",t.error&&t.error!==rm.Df.NotFound)return tt.showError("Failed to overwrite secrets"),e4(!1),[2];return t.error||(n=t.content.toString()),r=n3.Z.parse(n),i=(0,M._)({},r,e),o=n3.Z.serialize(i),[4,P.writeFile(".env",o)];case 2:return a.sent().error&&tt.showError("Failed to overwrite secrets"),e4(!1),e6(!1),[2]}})}),function(){return S.apply(this,arguments)}),tr=Y?(0,h.BX)(h.HY,{children:[(0,h.tZ)(ns,{}),(0,h.tZ)(ns,{}),(0,h.tZ)(ns,{})]}):(0,h.BX)(h.HY,{children:[eK?(0,h.BX)(v.G,{css:[y.l0.rowWithGap(12),y.l0.flex.growAndShrink(1),y.l0.width("100%")],children:[(0,h.tZ)(nc,{id:"timezone",title:"Timezone",information:"The selected timezone for your scheduled deployment",children:(0,h.tZ)(ru,{onChange:eZ,error:ex})}),(0,h.tZ)(nc,{id:"schedule",title:"Schedule",information:"Specify a valid cron expression for scheduling your deployment",grow:!0,children:(0,h.tZ)(rx,{id:"Schedule",value:eS,loading:!1,disabled:!1,onChange:eE,error:eT})})]}):null,eJ?(0,h.tZ)(nc,{id:"primaryDomain",title:"Primary domain",information:"You can add more custom domains after deploying",children:(0,h.tZ)(rS,{id:"primaryDomain",subdomain:er,deploymentId:R||void 0,onChange:eo,updateValidity:ec})}):null,e$?(0,h.tZ)(nc,{id:"publicDir",title:"Public directory",information:"The public directory is the folder where the browser should start when serving your static site",children:(0,h.tZ)(rx,{id:"publicDir",value:eO,onChange:eL,loading:Y,disabled:e9,error:eX})}):null,(0,h.tZ)(nc,{id:"buildCommand",title:"Build command",information:"The build command is the command-line statement that compiles your app at build time.",optional:!0,children:(0,h.tZ)(rx,{id:"buildCommand",value:eu,onChange:ed,loading:Y,disabled:e9})}),eq?(0,h.tZ)(nc,{id:"runCommand",title:"Run command",information:"The run command is the command-line statement that launches your app after it has been built.",children:(0,h.tZ)(rx,{id:"runCommand",value:eh,onChange:ep,loading:Y,disabled:e9,error:ev})}):null,(0,h.tZ)(nc,{id:"envVars",title:"Deployment secrets",information:"Secrets, or environment variables, are private keys you can use to access APIs and services",actions:R&&eI.length>0?(0,h.tZ)(eP.hU,{alt:"Copy all secrets from Deployment to Development.",disabled:e8,onClick:function(){e6(!0)},children:(0,h.tZ)(tz.Z,{})}):null,children:(0,h.BX)(v.G,{css:[y.l0.colWithGap(12)],children:[eI.length>0?eI.map(function(e,t){var n=e.name,r=e.value;return(0,h.tZ)(r_,{index:t,name:n,value:r,updateEnvVarName:function(e){return eV(t,e)},updateEnvVarValue:function(e){return ez(t,e)},removeEnvVar:function(){return ej(t)},disabled:e9,otherKeys:te.filter(function(e,n){return n!==t})},t)}):null,eW?(0,h.tZ)(n4,{secrets:new Map(eI.map(function(e){return[e.name,e.value]})),otherSecrets:eW,otherEnvName:"workspace",onAddSecret:function(e){return eH({name:e.key,value:e.value})},initialExpanded:F}):null,(0,h.tZ)(B.zx,{onClick:function(){return eH()},text:"Add deployment secret",iconLeft:(0,h.tZ)(n0.Z,{}),disabled:q})]})}),eY?(0,h.tZ)(nc,{id:"deploymentAppType",title:"App type",information:"Configure your app based on whether it needs to serve traffic from the web.",children:(0,h.tZ)(rE,{appType:Q,onChange:function(e){et(e),eN((e===G.Vp.Server||e===G.Vp.Worker)&&e===G.Vp.Worker)}})}):null,eQ?(0,h.tZ)(rl,{ports:N,openDotReplit:W}):null]});return(0,h.BX)(h.HY,{children:[(0,h.BX)(v.G,{css:[y.l0.colWithGap(16)],children:[tr,(0,h.BX)(v.G,{css:[y.l0.rowWithGap(8),y.l0.pt(12)],children:[J?(0,h.tZ)(B.zx,{text:"Cancel",onClick:L}):null,(0,h.tZ)(v.G,{css:y.l0.flex.grow(1),children:(0,h.tZ)(B.zx,{colorway:"primary",onClick:e0,text:H===w.z.Preparing&&"Preparing..."||Y&&"Fetching options..."||"Deploy",iconLeft:Y||H===w.z.Preparing?(0,h.tZ)(g.Z,{}):(0,h.tZ)(T.Z,{}),disabled:e7})})]})]}),(0,h.tZ)(nq.u,{isOpen:e5,onRequestClose:function(){e8||e6(!1)},children:(0,h.BX)(v.G,{css:[y.l0.colWithGap(8)],children:[(0,h.tZ)(ee.xv,{variant:"subheadBig",children:"Copy secrets from Deployment to Development?"}),(0,h.tZ)(ee.xv,{children:"Are you sure you want to copy all of your secrets from Deployment to Development? Secrets already present in Development will be overwritten and lost permanently."}),(0,h.BX)(v.G,{css:[y.l0.rowWithGap(8),y.l0.justify.end,y.l0.pt(8)],children:[(0,h.tZ)(B.zx,{text:"Cancel",disabled:e8,onClick:function(){e6(!1)}}),(0,h.tZ)(B.zx,{text:"Yes, copy secrets",colorway:"negative",disabled:e8,loading:e8,onClick:tn})]})]})})]})};function rA(){var e=(0,en._)(["\n  query HostingDeploymentConfigRedeploy($id: String!) {\n    hostingDeployment(id: $id) {\n      ... on HostingDeployment {\n        id\n        replitAppSubdomain\n        activityLogs(count: 20) {\n          items {\n            id\n            ...HostingActivityLogLine2\n          }\n          pageInfo {\n            hasNextPage\n            nextCursor\n          }\n        }\n        currentBuild {\n          id\n          envVars {\n            name\n            value\n          }\n        }\n        ...DeploymentsDeployOptionsDeployment\n      }\n    }\n  }\n  ","\n  ","\n"]);return rA=function(){return e},e}var rP={},rN=(0,er.Ps)(rA(),tW,rD),rU=(0,E.X)({root:{flexDirection:"row",gap:8,flexWrap:"wrap"},loading:tx,deployOptions:[y.l0.p(16),y.l0.pt(12),y.l0.borderRadius(8),y.l0.border({color:y.TV.outlineDimmest})]}),rO=function(e){var t=e.deploymentId,n=e.dotReplit,r=e.fs,i=e.ports,o=e.onError,a=e.expanded,l=e.setExpanded,c=e.shouldShowMobileTour,s=e.onDismissMobileTour,u=e.openDotReplit,d=(0,Z.XA)(),p=(D=(E={deploymentId:t,dotReplit:n}).deploymentId,G=E.dotReplit,P=(A=(0,f._)((0,b.useState)(null),2))[0],N=A[1],(0,b.useEffect)(function(){var e=!1;function t(){return(t=(0,x._)(function(){var t;return(0,C.Jh)(this,function(n){switch(n.label){case 0:return[4,(0,n6.$f)(G)];case 1:if(t=n.sent(),e)return[2];return N(t),[2]}})})).apply(this,arguments)}return function(){t.apply(this,arguments)}(),function(){e=!0}},[G]),L=(U=(0,M._)({},rP,{variables:{id:D},ssr:!1,fetchPolicy:"cache-and-network"}),O=ei.a(rN,U)).data,X=O.loading,F=O.error,W=(null==L?void 0:null===(k=L.hostingDeployment)||void 0===k?void 0:k.__typename)==="HostingDeployment"?L.hostingDeployment:null,(null==L?void 0:null===(R=L.hostingDeployment)||void 0===R?void 0:R.__typename)==="NotFoundError"?{deployment:null,config:null,error:"Deployment not found",loading:!1}:null===P||!W&&X?{data:null,erorr:null,loading:!0}:F||!W?{deployment:null,config:null,error:"Something went wrong",loading:!1}:{deployment:W,config:P,error:null,loading:!1}),m=n5({fs:r}).devSecrets,g=null===(H=p.deployment)||void 0===H?void 0:H.currentBuild.envVars,y=(0,b.useMemo)(function(){return m?n2({secrets:new Map(null==g?void 0:g.map(function(e){return[e.name,e.value]})),otherSecrets:m}).missing.size:0},[m,g]),_=(0,Z.kW)();if(_===w.z.Preparing||_===w.z.Deploying)return(0,h.tZ)(v.G,{css:rU.loading,children:(0,h.tZ)(t_,{})});if(p.error)return(0,h.tZ)(nf,{text:p.error});if(a){var E,k,R,D,G,A,P,N,U,O,L,X,F,W,H,V,z=null===(V=p.deployment)||void 0===V?void 0:V.currentBuild;return z?(0,h.tZ)(v.G,{css:rU.deployOptions,children:(0,h.tZ)(rB,{initialSubdomain:"",provider:z.provider,deploymentId:t,fs:r,dotReplit:n,ports:i,onCancel:function(){return l(!1)},onDeploy:function(){return l(!1)},onError:o,initialSecretsSyncExpanded:y>0,openDotReplit:u})}):(0,h.tZ)(S.E,{colorway:"warning",icon:(0,h.tZ)(I.Z,{}),text:"Provider not found"})}var j=p.loading||!(_===w.z.Ready||_===w.z.Suspended);return(0,h.BX)(v.G,{css:rU.root,children:[(0,h.tZ)(B.zx,{disabled:j,onClick:(0,x._)(function(){var e;return(0,C.Jh)(this,function(t){switch(t.label){case 0:if(p.loading)return[2];return[4,d({subdomain:null!==(e=p.deployment.replitAppSubdomain)&&void 0!==e?e:void 0})];case 1:return t.sent(),[2]}})}),text:_===w.z.Suspended?"Resume":"Redeploy",iconLeft:(0,h.tZ)(T.Z,{})}),(0,h.tZ)(B.zx,{disabled:j,text:y>0?"".concat(y," ").concat((0,tK.Z)("secrets",y)," out of sync"):"Edit commands and secrets",iconLeft:y>0?(0,h.tZ)(I.Z,{}):void 0,onClick:function(){return l(!0)}}),(0,h.tZ)(nQ,{shouldShow:c,onDismissTour:s})]})},rL=n(53937),rM=n(74440),rX=n(90234),rF=[1,2,3,4,5,6,7,8,9,10],rW=rF.length-1,rH=1/(2*rW),rV=(0,rX.cn)(2),rz=(0,rX.cn)(function(e){return rF[e(rV)]}),rj=(0,rX.cn)(function(e){return(e(rM.Qc)*e(rz)).toFixed(6)}),rq=(0,rX.cn)(function(e){return e(rM.Ig)*e(rz)}),rY=(0,rX.cn)(0),r$=(0,rX.cn)(function(e){var t=0/rW,n=rF.length-1/rW,r=0,i=0;return e(rY)<t&&(r=(t-e(rY))/rH,i=t-rH),e(rY)>n&&(r=(e(rY)-n)/rH,i=n+rH),{overage:r,point:i}});(r=l||(l={})).None="0ms",r.Normal="120ms";var rJ=["ArrowLeft","ArrowRight","Home","End"],rK=(0,Y.iv)({position:"relative",height:"16px",width:"100%",touchAction:"none"}),rQ=(0,Y.iv)({position:"absolute",zIndex:2,top:"0",width:"16px",height:"16px",backgroundColor:y.TV.white,borderRadius:"100%",outline:"none",cursor:"pointer",willChange:"left, transition",boxShadow:"0 0 8px rgba(0,0,0,0.15)",":focus":{outline:"2px solid ".concat(y.TV.accentPrimaryDefault),":not(:focus-visible)":{outlineColor:"transparent"}}}),r0=n(71999),r1=(0,b.forwardRef)(function(e,t){var n=(0,f._)((0,r0.KO)(rz),1)[0],r=(0,b.useRef)(null);return(0,b.useImperativeHandle)(t,function(){return r.current}),n&&r.current&&(r.current.setAttribute("aria-valuemin",String(rF[0])),r.current.setAttribute("aria-valuemax",String(rF[rF.length-1])),r.current.setAttribute("aria-valuenow",String(n))),(0,b.useMemo)(function(){return(0,h.tZ)("div",{ref:r,role:"slider",tabIndex:0,css:[rQ,{left:"calc((100% - 16px) * var(--max-instances-progress, 0))",transition:"left var(--max-instances-transition-time, 100ms) ease-out"}]})},[])}),r2=n(57330),r8=n(44166),r4="min(var(--point), var(--position))",r3="max(var(--point), var(--position))",r5=(0,b.forwardRef)(function(e,t){var n=(0,r0.Dv)(r$),r=n.overage,i=n.point,o=(0,r0.Dv)(rY),a=(0,b.useRef)(null);return(0,b.useEffect)(function(){(0,r8.A)(a,"--opacity",String(r))},[r]),(0,b.useEffect)(function(){(0,r8.A)(a,"--point",String(100*i)+"%")},[i]),(0,b.useEffect)(function(){(0,r8.A)(a,"--position",String(100*o)+"%")},[o]),(0,b.useMemo)(function(){return(0,h.BX)(h.HY,{children:[(0,h.tZ)("div",{ref:t,"aria-hidden":!0,css:{position:"relative",top:"0",width:"100%",height:"16px",margin:"0",cursor:"pointer"}}),(0,h.tZ)("div",{"aria-hidden":!0,css:{position:"absolute",top:"5px",left:"0",width:"100%",height:"6px",margin:"0",overflow:"hidden",pointerEvents:"none",backgroundColor:A.vb.interactiveBorder,borderRadius:"2px"},children:(0,h.tZ)("div",{ref:a,"aria-hidden":!0,css:{"--opacity":0,"--point":0,"--position":0,backgroundImage:"\n                linear-gradient(\n                  to right, transparent ".concat(r4,", \n                  ").concat(A.vb.interactiveBorderHover," ").concat(r4,", \n                  ").concat(A.vb.interactiveBorderHover," ").concat(r3,", \n                  transparent ").concat(r3," \n                )"),opacity:"var(--opacity)",width:"100%",height:"100%"}})})]})},[t])});function r6(e){var t=e.setAttrs,n=(0,f._)((0,r0.KO)(rV),2),r=n[0],i=n[1],o=(0,f._)((0,b.useState)(!1),2),a=o[0],c=o[1],s=(0,b.useRef)(null),u=(0,b.useRef)(null),d=(0,b.useRef)(null),p=(0,b.useCallback)(function(e){t.setTransitionTime(e)},[t]),m=(0,b.useCallback)(function(e){t.setProgress(e)},[t]);return void 0===r||a||(m(r/rW),p(l.Normal)),(0,b.useEffect)(function(){if(void 0!==r&&u.current&&d.current&&!a){var e=u.current,t=d.current,n=function(n){if(0===n.button){c(!0),t.focus();var r=e.getBoundingClientRect(),o=t.getBoundingClientRect(),a=r.width,s=o.width,u=n.target===e?s/2:n.clientX-o.left,d=null,f=function(e){var t=Math.max(0,Math.min(1,(e-r.left-u)/(a-s)));t!==d&&(d=t,m(t),i(Math.round(t*rW)))};f(n.clientX);var h=function(e){p(l.None),f(e.clientX),e.preventDefault(),e.stopPropagation()},v=function(){window.removeEventListener("pointermove",h),window.removeEventListener("pointerup",v),window.removeEventListener("pointercancel",v),p(l.Normal),c(!1)};window.addEventListener("pointermove",h),window.addEventListener("pointerup",v),window.addEventListener("pointercancel",v),n.preventDefault(),n.stopPropagation()}};return e.addEventListener("pointerdown",n),t.addEventListener("pointerdown",n),function(){e.removeEventListener("pointerdown",n),t.removeEventListener("pointerdown",n)}}},[r,a,i,m,p]),(0,b.useEffect)(function(){if(void 0!==r&&d.current&&!a){var e=d.current,t=function(e){if(void 0!==r&&rJ.includes(e.key)){var t=Math.max(0,r-1),n=Math.min(rW,r+1),o=null;switch(e.key){case"ArrowLeft":o=t;break;case"ArrowRight":o=n;break;case"Home":o=0;break;case"End":o=rW}null!==o&&(i(o),e.preventDefault(),e.stopPropagation())}};return e.addEventListener("keydown",t),function(){e.removeEventListener("keydown",t)}}},[a,r,i]),(0,b.useMemo)(function(){return(0,h.tZ)(v.G,{css:y.l0.colWithGap(8),children:(0,h.BX)(v.G,{innerRef:s,css:rK,children:[(0,h.tZ)(r5,{ref:u}),(0,h.tZ)(r1,{ref:d})]})})},[])}var r9=(0,E.X)({costInfo:[y.l0.rowWithGap(4),y.l0.flex.shrink(1),y.l0.align.center]});function r7(e){var t=e.setAttrs,n=(0,f._)((0,r0.KO)(rz),1)[0],r=(0,f._)((0,r0.KO)(rj),1)[0],i=(0,f._)((0,r0.KO)(rq),1)[0];return(0,h.BX)(v.G,{css:r2.B.container,children:[(0,h.BX)(v.G,{css:r2.B.label,children:[(0,h.BX)(ee.xv,{css:r2.B.resource,multiline:!1,children:[n," ",(0,tK.Z)("machine",n)]}),(0,h.BX)(v.G,{css:r9.costInfo,children:[(0,h.BX)(v.G,{css:r2.B.cost,children:[(0,h.BX)(ee.xv,{multiline:!1,children:[i," compute units"]}),(0,h.tZ)(ee.xv,{color:"dimmer",variant:"small",multiline:!1,children:"/s at max traffic"})]}),(0,h.tZ)(no.u,{tooltip:(0,h.BX)(v.G,{css:r2.B.cost,children:[(0,h.BX)(ee.xv,{multiline:!1,children:["$",r]}),(0,h.tZ)(ee.xv,{variant:"small",color:"dimmest",multiline:!1,children:"/s"})]}),children:(0,h.tZ)(na.Z,{color:y.TV.foregroundDimmest})})]})]}),(0,h.tZ)(r6,{setAttrs:t})]})}var ie=n(10454),it=[y.l0.colWithGap(12),y.l0.borderRadius(12),y.l0.p(16)],ir=(0,E.X)({container:[it],disabled:[it,{opacity:.5,pointerEvents:"none"}],text:[y.l0.colWithGap(4)],title:[y.l0.rowWithGap(4),y.l0.align.center],cost:[y.l0.flex.row,y.l0.align.baseline,y.l0.fontWeight.medium,{gap:3}],builder:[y.l0.colWithGap(8),y.l0.position.relative,{"--max-instances-transition-time":l.Normal,"--max-instances":1," *":{transitionTimingFunction:"ease"}}]});function ii(e){var t=e.maxMachineInstances,n=e.disabled,r=e.onError,i=(0,b.useRef)(null),o=(0,r0.b9)(rY),a=(0,r0.b9)(rV);return(0,b.useEffect)(function(){if(t){var e=rF.indexOf(t);if(-1===e){r("An error occurred while setting selected max machine instances.");return}a(e)}},[t,a,r]),(0,h.BX)(P.Tg,{elevated:!0,css:n?ir.disabled:ir.container,children:[(0,h.BX)(v.G,{css:ir.text,children:[(0,h.BX)(v.G,{css:ir.title,children:[(0,h.tZ)(ie.Z,{}),(0,h.tZ)(ee.xv,{variant:"subheadDefault",multiline:!1,children:"Max number of machines"})]}),(0,h.tZ)(ee.xv,{multiline:!0,variant:"small",color:"dimmer",children:"The most machines that should ever spin up to handle your highest traffic. More machines means a faster experience for your users."})]}),(0,h.tZ)(v.G,{css:ir.builder,innerRef:i,children:(0,h.tZ)(r7,{setAttrs:{setTransitionTime:function(e){(0,r8.A)(i,"--max-instances-transition-time",e)},setProgress:function(e){(0,r8.A)(i,"--max-instances-progress",e.toString()),o(e)}}})})]})}function io(){var e=(0,en._)(["\n  query AutoscaleMachineConfigurations {\n    hostingMachineConfigurations(input: { provider: cloud_run }) {\n      __typename\n      ... on HostingMachineConfigurationsResults {\n        results {\n          ...MachineConfiguration\n        }\n      }\n      ... on UnauthorizedError {\n        message\n      }\n    }\n  }\n  ","\n"]);return io=function(){return e},e}var ia={},il=(0,er.Ps)(io(),nm.bN),ic=function(e){var t,n,r=(0,Z.kW)(),i=(0,Z.hn)(),o=(0,Z.$y)(),a=void 0!==(0,Z.pn)(),l=!a&&"string"!=typeof i,c=(0,r0.Dv)(rM.aH),s=(0,r0.Dv)(rM.sA),u=(0,r0.Dv)(rz),d=(t=(0,M._)({},ia,{onCompleted:function(t){"HostingMachineConfigurationsResults"!==t.hostingMachineConfigurations.__typename&&e.onError("Something went wrong")},onError:function(t){return e.onError(t.message)}}),ei.a(il,t)),f=d.data,p=d.loading,m=(null==f?void 0:f.hostingMachineConfigurations.__typename)==="HostingMachineConfigurationsResults"?f.hostingMachineConfigurations.results:null;(0,b.useEffect)(function(){e2({context:U.k.AutoscaleMachineConfiguration})},[]);var g=(n=(0,x._)(function(){var t,n,r,i;return(0,C.Jh)(this,function(o){return(t=null==m?void 0:m.find(function(e){var t=e.vcpu,n=e.memory;return c.toString()===t&&s.toString()===n}))?(n=t.id,r=t.label,i=t.slug,e.onConfirm({configurationId:n,configurationLabel:r,configurationSlug:i,maxInstances:u})):e.onError("An error occurred trying to validate selected machine configuration"),[2]})}),function(){return n.apply(this,arguments)}),_=p||e.fetching||a||r!==w.z.Ready;return(0,h.BX)(h.HY,{children:[(0,h.tZ)(z,{maxWidth:!0,children:(0,h.tZ)(np,{onBack:e.onBack})}),(0,h.tZ)(z,{maxWidth:!0,children:(0,h.BX)(v.G,{css:y.l0.colWithGap(16),children:[(0,h.BX)(v.G,{css:y.l0.colWithGap(4),children:[(0,h.tZ)(ee.xv,{variant:"subheadBig",children:"Autoscale machine configuration"}),(0,h.tZ)(ee.xv,{variant:"small",color:"dimmer",children:"Autoscale apps spin up enough machines to meet demand at any point in time. You are billed for the total number of compute units across all machines."})]}),(0,h.BX)(v.G,{css:y.l0.colWithGap(16),children:[(0,h.tZ)(rL.Z,{machineConfiguration:null==o?void 0:o.machineConfiguration,disabled:_}),(0,h.tZ)(ii,{maxMachineInstances:null==o?void 0:o.maxMachineInstances,disabled:_,onError:e.onError})]}),(0,h.BX)(v.G,{css:[y.l0.colWithGap(8),y.l0.pt(8)],children:[(0,h.tZ)(B.zx,{colorway:"primary",text:l?"Approve and configure build settings":"Approve and update",iconRight:(0,h.tZ)(nZ.Z,{}),onClick:g,loading:p}),(0,h.BX)(ee.xv,{color:"dimmest",children:["Your deployed app will utilize any available monthly free allotment before charging for additional resource usage."," ",(0,h.tZ)("a",{href:nw.TT.ABOUT_USAGE_BASED_BILLING,target:"_blank",rel:"noopener",children:"Learn more"})]})]})]})})]})},is=n(68866),iu=n(71411),id=n(14819),ih=n(56335),ip=n(27187),im=n(70315),iv=n(52682),ig=(0,E.X)({container:y.l0.colWithGap(24),pauseAndResumeButtons:y.l0.colWithGap(8),sectionContainer:y.l0.colWithGap(8),sectionButton:[y.l0.color.accentNegativeStrongest,y.l0.transition.snappy,(0,j._)({backgroundColor:A.vb.interactiveBackground,borderColor:"transparent"},y.wl.hover,{borderColor:"transparent"})]}),iy=function(e){var t=e.hideResume,n=e.hideSuspend,r=e.onLifecycleCommand,i=(0,Z.kW)(),o=(0,Z.$y)(),a=(0,f._)((0,b.useState)(!1),2),l=a[0],c=a[1],s=(0,_.Z)(),u=(0,Z.FN)(s),d=(null==o?void 0:o.status)===G.Fe.Resuming,p=(null==o?void 0:o.status)===G.Fe.Suspending,m=(null==o?void 0:o.status)===G.Fe.Suspended,y=d||p||i===w.z.ProcessingLifecycleCommand||i===w.z.Deploying,x=!(void 0!==t&&t)&&u&&(m||d)&&(null==o?void 0:o.hasImageTag),C=!(void 0!==n&&n)&&!m&&!d&&(p||i===w.z.Deploying||i===w.z.Ready)&&(null==o?void 0:o.hasImageTag);return(0,h.tZ)(h.HY,{children:(0,h.BX)(v.G,{css:ig.container,children:[x||C?(0,h.BX)(v.G,{css:ig.pauseAndResumeButtons,children:[x?(0,h.BX)(h.HY,{children:[(0,h.tZ)(B.zx,{text:d?"Resuming":"Resume",onClick:function(){return r({command:G.Qc.Resume})},loading:d,disabled:y,iconLeft:d?(0,h.tZ)(g.Z,{}):(0,h.tZ)(ip.Z,{})}),(0,h.tZ)(ee.xv,{color:"dimmer",children:"Your app will become accessible to users again"})]}):null,C?(0,h.BX)(h.HY,{children:[(0,h.tZ)(B.zx,{text:"Pause",onClick:function(){return r({command:G.Qc.Suspend})},loading:p,disabled:y,iconLeft:p?(0,h.tZ)(g.Z,{}):(0,h.tZ)(ih.Z,{})}),(0,h.tZ)(ee.xv,{color:"dimmer",children:"Your deployment billing will continue, but all users will lose access to your app"})]}):null]}):null,(0,h.tZ)(ib,{setIsDestroying:c,onLifecycleCommand:r}),(0,h.tZ)(iZ,{isDestroying:l,setIsDestroying:c,onLifecycleCommand:r})]})})};function ib(e){var t=e.setIsDestroying,n=e.onLifecycleCommand,r=(0,f._)((0,b.useState)(!1),2),i=r[0],o=r[1];return(0,h.BX)(h.HY,{children:[(0,h.BX)(v.G,{css:ig.sectionContainer,children:[(0,h.tZ)(B.zx,{text:"Change deployment type",onClick:function(){return o(!0)},iconLeft:(0,h.tZ)(im.Z,{})}),(0,h.tZ)(ee.xv,{color:"dimmer",children:"To change your deployment type, you will need to shut down and create a new deployment."})]}),(0,h.tZ)(nq.u,{isOpen:i,onRequestClose:function(){return o(!1)},children:(0,h.tZ)(id.Z,{confirmLabel:"Yes, delete my deployment",title:"Change Deployment Type",isDestructive:!0,onConfirm:function(){t(!0),o(!1),n({command:G.Qc.Destroy})},onCancel:function(){return o(!1)},children:"To change your deployment type, you will need to shut down and create a new deployment. This will destroy your deployment and any associated deployment tiers, saved replit.app domain and deployment history. You can always come back and redeploy your repl again."})})]})}function iZ(e){var t=e.isDestroying,n=e.setIsDestroying,r=e.onLifecycleCommand,i=(0,f._)((0,b.useState)(!1),2),o=i[0],a=i[1];return(0,h.BX)(h.HY,{children:[(0,h.BX)(v.G,{css:ig.sectionContainer,children:[(0,h.tZ)(B.zx,{text:"Shut down",colorway:"negative",variant:"outlined",css:ig.sectionButton,onClick:function(){return a(!0)},disabled:t,iconLeft:(0,h.tZ)(iv.Z,{})}),(0,h.tZ)(ee.xv,{color:"dimmer",children:"Your deployment billing will be canceled, and your deployed app will cease to exist"})]}),(0,h.tZ)(nq.u,{isOpen:o,onRequestClose:function(){return a(!1)},children:(0,h.tZ)(id.Z,{confirmLabel:"Yes, delete my deployment",title:"Delete Deployment",isDestructive:!0,onConfirm:function(){n(!0),a(!1),r({command:G.Qc.Destroy})},onCancel:function(){return a(!1)},children:"This will destroy your deployment and any associated deployment tiers, saved replit.app domain and deployment history. You can always come back and redeploy your repl again."})})]})}var iw=function(e){var t=e.onBack,n=e.onCheckout,r=e.onLifecycleCommand,i=(0,Z.hn)(),o=!(void 0!==(0,Z.pn)())&&"string"!=typeof i,a=(0,_.Z)(),l=(0,Z.FN)(a),c=(0,f._)((0,b.useState)(!1),2),s=c[0],u=c[1],d=(0,iu.P)({step:"not_shown"});return((0,b.useEffect)(function(){e2({context:"tier_selection"})},[]),(0,b.useEffect)(function(){if("checkout_success"===d.currentStep.step){u(!0);return}"not_shown"===d.currentStep.step&&d.goTo({step:"power_up_details",powerUpCategory:"hosting_tier"})},[d]),"not_shown"===d.currentStep.step)?(0,h.tZ)(h.HY,{}):(0,h.tZ)(z,{children:(0,h.BX)(v.G,{css:[y.l0.colWithGap(16),W.Qw.maxWidth],children:[l&&o?null:(0,h.tZ)(is.s,(0,X._)((0,M._)({},d),{analyticsContext:"workspace_hosting_pane",goBack:function(){if("checkout_success"===d.currentStep.step){n();return}if("power_up_details"!==d.currentStep.step){d.goBack();return}t()}})),s?(0,h.tZ)(B.zx,{colorway:o?"primary":void 0,onClick:n,text:o?"Deploy your project":"Back to deployment"}):null,l&&o?(0,h.BX)(h.HY,{children:[(0,h.BX)(v.G,{css:[y.l0.rowWithGap(8),y.l0.align.center],children:[(0,h.tZ)(eP.hU,{alt:"Back",onClick:t,children:(0,h.tZ)(tz.Z,{})}),(0,h.tZ)(S.E,{colorway:"warning",icon:(0,h.tZ)(I.Z,{}),text:"To upgrade hosting tier, please deploy your repl first."})]}),(0,h.tZ)(iy,{hideResume:!0,hideSuspend:!0,onLifecycleCommand:r})]}):null]})})},ix=(0,E.X)({deployOptionsWithCurrentBuild:[y.l0.p(16),y.l0.pt(12),y.l0.borderRadius(8),y.l0.border({color:y.TV.outlineDimmest})],back:[y.l0.pb(8),y.l0.flex.growAndShrink(1)],subViewOuter:[y.l0.rowWithGap(12)],subView:[y.l0.pb(12),y.l0.flex.growAndShrink(1),y.l0.colWithGap(12)],deploymentInfoWrapper:[y.l0.rowWithGap(12),{':has( + [data-history-timeline-items="1"])':{"[data-timeline-line]":{display:"none"}}}],deploymentInfo:[y.l0.pb(16),y.l0.flex.growAndShrink(1),y.l0.colWithGap(12)]}),iC=function(e){var t=e.view,n=e.onViewAction,r=e.onError,i=e.openFile,o=e.onLifecycleCommand,a=e.refetch,l=(0,Z.kW)(),c=(0,Z.hn)(),s=(0,Z.$y)(),u=(0,Z.pn)(),d=(0,Z.XZ)(),p=(0,nM.rv)(),m=(0,nk.P5)({controlName:nx.dD,logFlagToAnalytics:!1}),g=void 0!==s,y=(0,_.Z)(),x=(0,Z.FN)(y),C=(0,Z.l9)(y),E=null==s?void 0:s.provider,k=g&&s.machineConfiguration?{configurationId:s.machineConfiguration.id,configurationLabel:s.machineConfiguration.label,configurationSlug:s.machineConfiguration.slug,maxInstances:null==s?void 0:s.maxMachineInstances}:void 0,T=(0,nX.Z)("deployments-pane","deployments-mobile-download"),R=T.shouldDisplay,D=T.dismiss,I=T.register,B=(0,nW.q)(),A=B.loading,P=(0,F._)(B,["loading"]);(0,b.useEffect)(function(){I()},[I]);var N=(null==s?void 0:s.status)&&s.status===G.Fe.Success&&R&&!p,O=(0,f._)((0,b.useState)(!1),2),L=O[0],M=O[1],X=E===G.r4.Gce&&g&&!m&&!x,W=l===w.z.Ready||l===w.z.Suspended,H=(0,f._)((0,b.useState)(null),2),V=H[0],j=H[1],q=(0,f._)((0,b.useState)(null),2),Y=q[0],$=q[1];(0,b.useEffect)(function(){e2({context:U.k.Deployment})},[]),(0,b.useEffect)(function(){(l===w.z.Preparing||l===w.z.Deploying)&&(t===U.k.DeploymentInProgress||V||n({type:U.a.ChangeView,payload:{view:U.k.DeploymentInProgress}}))},[l,t,n,V]);var J=(0,b.useRef)(void 0);(0,b.useEffect)(function(){J.current=null==u?void 0:u.id},[null==u?void 0:u.id]);var K=(null==s?void 0:s.status)===G.Fe.Success,Q=(null==s?void 0:s.id)===J.current;(0,b.useEffect)(function(){K&&Q&&n({type:U.a.ChangeView,payload:{view:U.k.Deployment}})},[K,Q,n]);var ee=null==u?void 0:u.status,et=(0,b.useRef)(ee);(0,b.useEffect)(function(){ee&&(et.current=ee)},[ee]);var en=(0,Z.v5)(),er=(0,Z.t7)();if(V)return(0,h.tZ)(t4,{build:V,fs:d,openFile:i,onBack:function(){j(null)},onViewAppLogs:function(){n({type:U.a.ChangeView,payload:{view:U.k.Logs}})}});if(Y===G.r4.CloudRun)return(0,h.tZ)(ic,{onError:r,onConfirm:function(e){n({type:U.a.SendDeploymentLifecycleCommand,payload:{command:G.Qc.UpdateMachineConfiguration,machineConfigurationId:e.configurationId,maxMachineInstances:e.maxInstances}})},onBack:function(){return $(null)}});if(Y===G.r4.Gce)return m?(0,h.tZ)(n_,{isTeamRepl:C,initialMachineConfiguration:k,onConfirm:function(e){n({type:U.a.SendDeploymentLifecycleCommand,payload:{command:G.Qc.UpdateMachineConfiguration,machineConfigurationId:e.configurationId,maxMachineInstances:e.maxInstances}})},onBack:function(){return $(null)},onError:r}):(0,h.tZ)(iw,{onLifecycleCommand:o,onCheckout:function(){a(),$(null)},onBack:function(){$(null)}});var ei=X||!g||!c;return(0,h.BX)(h.HY,{children:[m&&!A&&P.hasReservedVMs?(0,h.tZ)(z,{children:(0,h.tZ)(nF.Z,{})}):null,(0,h.tZ)(z,{children:(0,h.BX)(v.G,{children:[(0,h.BX)(v.G,{css:ix.subViewOuter,children:[g?(0,h.tZ)(tt,{type:"future"}):null,(0,h.BX)(v.G,{css:ix.subView,children:[!ei&&W?(0,h.tZ)(rO,{dotReplit:en,fs:d,ports:er,deploymentId:c,onError:r,expanded:L,setExpanded:M,shouldShowMobileTour:null!=N&&N,onDismissMobileTour:D,openDotReplit:function(){n({type:U.a.OpenDotReplit})}}):null,t===U.k.DeploymentInProgress?(0,h.tZ)(tS,{openFile:i,viewBuildLogsOnLoad:!g,onViewLogs:function(){n({type:U.a.ChangeView,payload:{view:U.k.Logs}})},onCanceled:function(){n({type:U.a.ChangeView,payload:{view:U.k.Deployment}}),r("Build cancelled")},onError:r}):null]})]}),g?(0,h.BX)(h.HY,{children:[(0,h.tZ)(tQ,{type:"failureQueue",onViewBuildLogs:j}),(0,h.BX)(v.G,{css:ix.deploymentInfoWrapper,children:[(0,h.tZ)(tt,{type:"present"}),(0,h.BX)(v.G,{css:ix.deploymentInfo,children:[(0,h.tZ)(nL,{provider:E,machine:k,onViewBuildLogs:j,onManageClick:function(){if(E===G.r4.CloudRun||E===G.r4.Gce){$(E);return}E===G.r4.Static&&n({type:U.a.ChangeView,payload:{view:U.k.Settings}})}}),X?(0,h.tZ)(S.E,{colorway:"warning",icon:(0,h.tZ)(na.Z,{}),text:"Your deployment requires a tier in order to re-deploy"}):null]})]}),(0,h.tZ)(tQ,{onViewBuildLogs:j})]}):null]})})]})},i_=n(66587),iS=n(55330),iE=n(52932),ik=n(93302);function iT(){var e=(0,en._)(["\n  query IntroAutoscaleAllotmentUsage {\n    currentUser {\n      id\n      usageInterval {\n        __typename\n        ... on UsageInterval {\n          resources {\n            autoscaleComputeUnits {\n              allotment\n              usage\n            }\n          }\n        }\n        ... on ServiceUnavailable {\n          message\n        }\n        ... on UnauthorizedError {\n          message\n        }\n        ... on UserError {\n          message\n        }\n      }\n    }\n  }\n"]);return iT=function(){return e},e}var iR={},iD=(0,er.Ps)(iT());function iI(){var e,t,n,r=(e=(0,M._)({},iR,void 0),ei.a(iD,e)),i=r.data,o=r.loading,a=(0,b.useMemo)(function(){var e,t=null==i?void 0:null===(e=i.currentUser)||void 0===e?void 0:e.usageInterval;if(t&&"UsageInterval"===t.__typename){var n=Math.max(0,t.resources.autoscaleComputeUnits.allotment-t.resources.autoscaleComputeUnits.usage);if(void 0===n||0===n)return"You you will be charged by usage of compute units";var r=(0,ik.fZ)(n,{resourceUsageType:"ComputeUnits"});return"You have ".concat(r," left this month")}},[i]);return o?(0,h.tZ)(ee.xv,{color:"dimmest",children:"Loading data on your Autoscale usage..."}):(null==i?void 0:null===(n=i.currentUser)||void 0===n?void 0:null===(t=n.usageInterval)||void 0===t?void 0:t.__typename)!=="UsageInterval"?null:(0,h.tZ)(ee.xv,{color:"dimmer",children:a})}var iG=n(4513),iB=n(81340),iA=n(97764),iP=n(76566),iN=n(59811),iU=n(50946),iO=n(96239),iL=n(4773),iM=n(40028),iX=n(70078),iF=n(87001),iW=n(16560),iH=function(){var e=(0,Z.gg)(),t=e.isDeployableRepl,n=e.reason;return t?null:(0,h.tZ)(S.E,{colorway:"warning",text:n})};function iV(){var e=(0,en._)(["\n  fragment DeploymentsNewDeploymentRepl on Repl {\n    id\n    slug\n    owner {\n      ... on User {\n        id\n        username\n      }\n      ... on Team {\n        id\n        username\n      }\n    }\n    powerUps {\n      ... on ReplPowerUpTypes {\n        hostingTier {\n          sku\n        }\n      }\n    }\n  }\n"]);return iV=function(){return e},e}function iz(){var e=(0,en._)(["\n  query DeploymentsNewDeployment($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        ...DeploymentsNewDeploymentRepl\n      }\n    }\n  }\n  ","\n"]);return iz=function(){return e},e}var ij={},iq=(0,er.Ps)(iV()),iY=(0,er.Ps)(iz(),iq);function i$(){var e=(0,en._)(["\n  query DeploymentsPaneIntro($id: String!) {\n    repl(id: $id) {\n      ... on Repl {\n        id\n        owner {\n          __typename\n          ... on Team {\n            id\n          }\n        }\n        hostingDeploymentPermissions {\n          canDeployReservedVm {\n            isDeployable\n            explanation\n          }\n          canDeployAutoscale {\n            isDeployable\n            explanation\n          }\n          canDeployStatic {\n            isDeployable\n            deploymentCount\n            limit\n            explanation\n          }\n        }\n        ...DeploymentsNewDeploymentRepl\n      }\n    }\n    currentUser {\n      id\n      userSubscriptionType\n      usageBasedBilling(input: { capabilitiesOnly: true }) {\n        __typename\n        ... on UserUsageBasedBillingSummary {\n          capabilities {\n            canUseUsageBasedBilling\n            explanation\n            hasPaymentMethod\n          }\n        }\n        ... on ServiceUnavailable {\n          message\n        }\n        ... on UnauthorizedError {\n          message\n        }\n        ... on UserError {\n          message\n        }\n      }\n    }\n  }\n  ","\n"]);return i$=function(){return e},e}var iJ={},iK=(0,er.Ps)(i$(),iq),iQ=(0,E.X)({type:[y.l0.borderRadius(8),y.l0.p(8)],hostingTierFlow:y.l0.colWithGap(8),manageReserved:y.l0.colWithGap(16),manageReservedHeader:[y.l0.rowWithGap(8),y.l0.align.center]});function i0(e){var t,n,r,i=e.replId,o=e.initialState,a=e.fs,l=e.dotReplit,c=e.ports,s=e.onBack,u=e.onDeploy,d=e.onError,p=e.onLifecycleCommand,m=e.openDotReplit,g=(0,f._)((0,b.useState)(o),2),y=g[0],Z=g[1],w=(t=(0,M._)({},ij,{variables:{replId:i},onError:function(e){return d(e.message)}}),ei.a(iY,t)),x=w.data,C=w.loading,_=w.refetch,E=(null==x?void 0:x.repl.__typename)==="Repl"?x.repl:null,k=E?(0,rp.Jw)({replSlug:E.slug,username:null===(n=E.owner)||void 0===n?void 0:n.username}):"",T=(null==E?void 0:E.powerUps.__typename)==="ReplPowerUpTypes"?E.powerUps.hostingTier:null,R=(0,nk.P5)({controlName:nx.dD,logFlagToAnalytics:!1}),D=(0,nk.P5)({controlName:nx.dA,logFlagToAnalytics:!1});if(C)return(0,h.tZ)(nu,{loading:!0});if(!E)return null;var B=(null==E?void 0:null===(r=E.owner)||void 0===r?void 0:r.__typename)==="Team";return y.type===G.r4.Static?(0,h.BX)(h.HY,{children:[(0,h.tZ)(z,{maxWidth:!0,children:(0,h.tZ)(eP.hU,{alt:"Back",tooltipHidden:!0,onClick:function(){return s()},children:(0,h.tZ)(tz.Z,{})})}),(0,h.tZ)(z,{maxWidth:!0,children:(0,h.tZ)(P.Tg,{css:iQ.type,elevated:!0,children:(0,h.tZ)(nO,{label:"Type",fullWidth:!0,children:(0,h.tZ)(nU,{name:nE[y.type]})})})}),(0,h.tZ)(z,{maxWidth:!0,children:(0,h.tZ)(rB,{initialSubdomain:k,deploymentId:null,provider:y.type,onError:d,onCancel:function(){return s()},onDeploy:u,fs:a,dotReplit:l,ports:c,openDotReplit:m})})]}):y.type===G.r4.Gce?T&&y.didCheckout?y.manage?(0,h.tZ)(z,{maxWidth:!0,children:(0,h.BX)(v.G,{css:iQ.manageReserved,children:[(0,h.BX)(v.G,{css:iQ.manageReservedHeader,children:[(0,h.tZ)(eP.hU,{alt:"Back",onClick:function(){return Z({type:y.type,didCheckout:y.didCheckout,manage:!1})},children:(0,h.tZ)(tz.Z,{})}),(0,h.tZ)(S.E,{colorway:"warning",icon:(0,h.tZ)(I.Z,{}),text:"To upgrade hosting tier, please deploy your repl first."})]}),(0,h.tZ)(iy,{hideResume:!0,hideSuspend:!0,onLifecycleCommand:p})]})}):(0,h.BX)(h.HY,{children:[(0,h.tZ)(z,{maxWidth:!0,children:(0,h.tZ)(P.Tg,{css:iQ.type,elevated:!0,children:(0,h.tZ)(nO,{label:"Type",fullWidth:!0,children:(0,h.tZ)(nU,{name:nE[y.type],sku:(0,nS.$)(T.sku),canManage:!0,onManageClick:function(){Z({type:y.type,didCheckout:y.didCheckout,manage:!0})}})})})}),(0,h.tZ)(z,{maxWidth:!0,children:(0,h.tZ)(rB,{initialSubdomain:k,deploymentId:null,provider:y.type,onError:d,onCancel:function(){return s()},onDeploy:u,fs:a,dotReplit:l,ports:c,openDotReplit:m})})]}):!T&&R?(0,h.BX)(h.HY,{children:[(0,h.tZ)(n_,{isTeamRepl:B,onBack:s,onError:d,onChange:function(e){Z({type:G.r4.Gce,machine:e})}}),(0,h.tZ)(z,{maxWidth:!0,children:(0,h.tZ)(rB,{initialSubdomain:k,deploymentId:null,provider:y.type,machine:y.machine,onError:d,onCancel:s,onDeploy:u,fs:a,dotReplit:l,ports:c,openDotReplit:m})}),(0,h.tZ)(z,{maxWidth:!0,children:(0,h.BX)(ee.xv,{color:"dimmest",children:["Your deployed app will incur charges for any resource usage."," ",(0,h.tZ)("a",{href:nw.TT.ABOUT_USAGE_BASED_BILLING,target:"_blank",rel:"noopener",children:"Learn more"})]})})]}):(0,h.tZ)(z,{maxWidth:!0,children:(0,h.tZ)(i1,{onBack:s,onCheckout:function(){Z({type:y.type,didCheckout:!0,manage:!1}),_()}})}):y.type===G.r4.Cron?D?(0,h.BX)(h.HY,{children:[(0,h.tZ)(z,{maxWidth:!0,children:(0,h.tZ)(eP.hU,{alt:"Back",tooltipHidden:!0,onClick:function(){return s()},children:(0,h.tZ)(tz.Z,{})})}),(0,h.tZ)(z,{maxWidth:!0,children:(0,h.tZ)(P.Tg,{css:iQ.type,elevated:!0,children:(0,h.tZ)(nO,{label:"Type",fullWidth:!0,children:(0,h.tZ)(nU,{name:nE[y.type]})})})}),(0,h.tZ)(z,{maxWidth:!0,children:(0,h.tZ)(rB,{initialSubdomain:k,deploymentId:null,provider:y.type,onError:d,onCancel:function(){return s()},onDeploy:u,fs:a,dotReplit:l,ports:c,openDotReplit:m})})]}):null:y.machine?(0,h.BX)(h.HY,{children:[(0,h.tZ)(z,{maxWidth:!0,children:(0,h.tZ)(eP.hU,{alt:"Back",tooltipHidden:!0,onClick:function(){return Z({type:G.r4.CloudRun,machine:null})},children:(0,h.tZ)(tz.Z,{})})}),(0,h.tZ)(z,{maxWidth:!0,children:(0,h.tZ)(P.Tg,{css:iQ.type,elevated:!0,children:(0,h.tZ)(nO,{label:"Type",fullWidth:!0,children:(0,h.tZ)(nU,{name:nE[y.type],sku:"".concat(y.machine.configurationLabel," / ").concat(y.machine.maxInstances," Max"),canManage:!0,onManageClick:function(){Z({type:G.r4.CloudRun,machine:null})}})})})}),(0,h.tZ)(z,{maxWidth:!0,children:(0,h.tZ)(rB,{initialSubdomain:k,deploymentId:null,provider:y.type,machine:y.machine,onError:d,onCancel:function(){return Z({type:G.r4.CloudRun})},onDeploy:u,fs:a,dotReplit:l,ports:c,openDotReplit:m})})]}):(0,h.tZ)(z,{maxWidth:!0,children:(0,h.tZ)(ic,{onBack:s,onError:d,onConfirm:function(e){Z({type:G.r4.CloudRun,machine:e})}})})}var i1=function(e){var t=e.onBack,n=e.onCheckout,r=(0,_.Z)(),i=(0,Z.Sl)(r),o=i.hostingTier,a=i.refetch,l=(0,iu.P)({step:"power_up_details",powerUpCategory:"hosting_tier"}),c=l.currentStep.step;return(0,b.useEffect)(function(){"checkout_success"===c&&a()},[c,a]),(0,h.BX)(v.G,{css:iQ.hostingTierFlow,children:[(0,h.tZ)(is.s,{currentStep:l.currentStep,canGoBack:l.canGoBack||"power_up_details"===c,goTo:l.goTo,analyticsContext:"workspace_hosting_pane",goBack:function(){if("checkout_success"===l.currentStep.step){n();return}if("power_up_details"!==l.currentStep.step){l.goBack();return}t()}}),o?(0,h.tZ)(B.zx,{colorway:"primary",onClick:n,text:"Deploy your project"}):null]})},i2=y.nC.min(600),i8={order:"--provider-order"},i4={order:"var(".concat(i8.order,")")},i3=(0,Y.iv)([y.l0.reset.button,y.l0.overflow("hidden"),y.l0.position.relative,y.l0.focusRing,y.l0.borderRadius(8),y.l0.width("100%"),y.l0.maxWidth(340)]),i5=(0,E.X)({loading:[i3,Q.p.foregroundPulse(),y.l0.border({color:y.TV.backgroundHighest})],self:[i3,A.gU.filledAndOutlined,y.l0.border({color:y.TV.outlineDimmer}),(c={},(0,j._)(c,i2,{order:i4.order}),(0,j._)(c,"&::after",{content:"none"}),c)],selfActive:[i3,y.l0.cursor.pointer,y.l0.backgroundColor.accentPrimaryDimmest,y.l0.border({color:y.TV.accentPrimaryStronger}),(s={},(0,j._)(s,i2,{order:i4.order}),(0,j._)(s,"&::after",{content:"none"}),s)],content:[y.l0.p(8),y.l0.colWithGap(4),(0,j._)({},i2,y.l0.py(12))],contentRecommended:[y.l0.p(8),y.l0.colWithGap(4),(0,j._)({},i2,{paddingTop:12,paddingBottom:20})],recommended:[y.l0.py(4),y.l0.backgroundColor.backgroundHighest],recommendedActive:[y.l0.py(4),y.l0.backgroundColor.accentPrimaryDimmer],icon:[y.l0.display.none,y.l0.color.foregroundDimmer,y.l0.center,(0,j._)({},i2,y.l0.display.flex)],iconActive:[y.l0.display.none,y.l0.color.accentPrimaryStrongest,y.l0.center,(0,j._)({},i2,y.l0.display.flex)],tiersTitle:[y.l0.rowWithGap(8),y.l0.align.center]});function i6(e){var t,n,r,i,o=e.loading,a=e.active,l=e.provider,c=e.onClick,s=e.title,u=e.description,d=e.recommended,f=e.index,p=(i={},(0,j._)(i,G.r4.CloudRun,(0,h.tZ)(iN.Z,{size:32})),(0,j._)(i,G.r4.Gce,(0,h.tZ)(ie.Z,{size:32})),(0,j._)(i,G.r4.Static,(0,h.tZ)(iO.Z,{size:32})),(0,j._)(i,G.r4.Cron,(0,h.tZ)(tu.Z,{size:32})),i)[l];return(0,h.BX)("button",{css:(n=(t={loading:o,active:a}).loading,r=t.active,n?i5.loading:r?i5.selfActive:i5.self),onClick:function(){return c(l)},disabled:o,style:(0,j._)({},i8.order,f),children:[d?(0,h.tZ)(v.G,{css:a?i5.recommendedActive:i5.recommended,children:(0,h.tZ)(ee.xv,{variant:"small",children:"Recommended"})}):null,(0,h.BX)(v.G,{css:d?i5.contentRecommended:i5.content,children:[(0,h.tZ)(v.G,{css:a?i5.iconActive:i5.icon,children:p}),(0,h.BX)(v.G,{children:[(0,h.tZ)(v.G,{css:[y.l0.rowWithGap(4),y.l0.center],children:(0,h.tZ)(ee.xv,{variant:"subheadDefault",multiline:!1,children:s})}),(0,h.tZ)(ee.xv,{multiline:!1,variant:"small",children:u})]})]})]})}var i9=(0,E.X)({container:[y.l0.colWithGap(12),y.l0.maxWidth(400),{marginLeft:"auto",marginRight:"auto"}],item:[y.l0.align.center,{display:"grid",gridTemplateColumns:"56px auto",gap:20}],text:[y.l0.flex.growAndShrink(1),y.l0.textAlign.left],autoscaleHours:{}});function i7(e){var t=e.header,n=e.info;return(0,h.BX)(v.G,{css:i9.container,children:[(0,h.tZ)(ee.xv,{variant:"subheadDefault",children:t}),n.map(function(e,t){return(0,h.BX)(v.G,{css:i9.item,children:[e.icon,(0,h.tZ)(ee.xv,{css:i9.text,children:e.text})]},t)})]})}var oe=[G.r4.Gce,G.r4.CloudRun,G.r4.Static,G.r4.Cron],ot=(0,E.X)({container:[y.l0.colWithGap(32),y.l0.py(32),y.l0.textAlign.center,W.Qw.maxWidth],title:[y.l0.colWithGap(4),y.l0.width("100%"),y.l0.maxWidth(288),{marginLeft:"auto",marginRight:"auto"}],providers:[y.l0.flex.column,y.l0.align.center,(0,j._)({gap:8},i2,[y.l0.flex.row,y.l0.align.center,{gap:12}])],cta:[y.l0.width("100%"),y.l0.maxWidth(320),{marginLeft:"auto",marginRight:"auto"}],secondaryCta:[y.l0.width("100%"),y.l0.maxWidth(320)],ctaContainer:[y.l0.colWithGap(8),y.l0.align.center],ctaStatusBanner:[y.l0.textAlign.left],oldCta:[y.l0.px(8),y.l0.colWithGap(16)],payment:[y.l0.p(16),y.l0.borderRadius(12),y.l0.textAlign.left,y.l0.shadow(2)],budgetContainer:[y.l0.colWithGap(8),y.l0.border(),y.l0.borderRadius(8),y.l0.p(8)],disabledBanner:[y.l0.py(6),{alignSelf:"center"}]}),on=function(e){var t,n,r,i,o,a,l,c=e.replId,s=e.onError,u=e.onDeploy,d=e.onLifecycleCommand,p=e.onViewAction,m=e.initialSelectedProvider,g=(0,Z.FN)(c),w=(0,Z.gg)().isDeployableRepl,_=(0,Z.XZ)(),S=(0,Z.v5)(),E=(0,Z.t7)(),k=(0,f._)((0,b.useState)(void 0),2),T=k[0],R=k[1],D=(0,f._)((0,b.useState)(void 0),2),I=D[0],B=D[1],A=(0,f._)((0,b.useState)(!1),2),N=A[0],O=A[1],L=(0,f._)((0,b.useState)(!1),2),X=L[0],F=L[1],W=(0,f._)((0,b.useState)(null!=m?m:null),2),H=W[0],V=W[1];(0,b.useEffect)(function(){e2({context:"intro"})},[]);var q=(t=(0,M._)({},iJ,{variables:{id:c},onError:function(e){return s(e.message)}}),ei.a(iK,t)),Y=q.loading,$=q.data,J=q.refetch,K=(0,f._)((0,b.useState)(!1),2),Q=K[0],et=K[1],en=(null==$?void 0:$.repl.__typename)==="Repl"&&(null===(n=$.repl.owner)||void 0===n?void 0:n.__typename)==="Team",er=(null==$?void 0:$.repl.__typename)==="Repl"&&(null==$?void 0:null===(r=$.repl.owner)||void 0===r?void 0:r.id)&&(0,iX.xm)(null==$?void 0:null===(i=$.repl.owner)||void 0===i?void 0:i.id),eo=(0,nk.P5)({controlName:nx.dD,logFlagToAnalytics:!1}),ea=(0,nk.P5)({controlName:nx.dA,logFlagToAnalytics:!1});(0,b.useEffect)(function(){(0,x._)(function(){var e,t;return(0,C.Jh)(this,function(n){switch(n.label){case 0:if(Y)return[2];if(en&&!er)return R(G.r4.Gce),B(G.r4.Gce),[2];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,(0,n6.$f)(S)];case 2:if(null===(e=n.sent()).appType)return R(G.r4.CloudRun),B(G.r4.CloudRun),[2];if((t=(0,iE.oU)(e.appType))===G.r4.Goval||t===G.r4.Extension)return s("Did not recognize template deployment provider"),[2];return R(t),B(t),[3,4];case 3:return n.sent(),s("Something went wrong"),[3,4];case 4:return[2]}})})()},[s,S,Y,en,er]);var el=(0,b.useCallback)((0,x._)(function(){return(0,C.Jh)(this,function(e){switch(e.label){case 0:return et(!0),[4,J()];case 1:return e.sent(),et(!1),[2]}})}),[J,et]);if(H||g)return(0,h.tZ)(i0,{replId:c,initialState:g||!H?{type:G.r4.Gce,didCheckout:!0}:{type:H},fs:_,dotReplit:S,ports:E,onDeploy:u,onBack:function(){return V(null)},onError:s,onLifecycleCommand:d,openDotReplit:function(){p({type:U.a.OpenDotReplit})}});var ec=function(){if(!$||(null==$?void 0:$.repl.__typename)!=="Repl"||!T)return{isDeployable:!1,explanation:"Loading"};if(T===G.r4.Static){var e=$.repl.hostingDeploymentPermissions.canDeployStatic;return{isDeployable:e.isDeployable,explanation:e.explanation}}if(T===G.r4.CloudRun){var t=$.repl.hostingDeploymentPermissions.canDeployAutoscale;return{isDeployable:t.isDeployable,explanation:t.explanation}}if(T===G.r4.Gce){var n=$.repl.hostingDeploymentPermissions.canDeployReservedVm;return{isDeployable:n.isDeployable,explanation:n.explanation}}if(T===G.r4.Cron){var r=$.repl.hostingDeploymentPermissions.canDeployAutoscale;return{isDeployable:r.isDeployable,explanation:r.explanation}}(0,iM.Z)(T)}(),es=ec.isDeployable,eu=ec.explanation,ed=Y||Q||void 0===T,ef=null==$?void 0:null===(o=$.currentUser)||void 0===o?void 0:o.userSubscriptionType,eh=ef===G.HP.Hacker,ep=ef===G.HP.HackerPro,em=(null==$?void 0:null===(a=$.currentUser)||void 0===a?void 0:a.usageBasedBilling.__typename)==="UserUsageBasedBillingSummary"?$.currentUser.usageBasedBilling.capabilities:null,ev=function(){return eh?(0,h.tZ)(iG.GN,{}):ep?(0,h.tZ)(iG.T3,{}):(0,h.tZ)(iG.fG,{})},eg=(l={title:"Deploy to production",subtitle:"Deploy a stable, public version of your project, unaffected by the changes you make in the workspace."},(0,j._)(l,G.r4.Gce,{display:!0,title:"Reserved VM",subtitle:"Servers that stay on",header:"Reserved VM is for apps that don't tolerate restarts",info:[{text:"Reserved VM apps have 99.9% uptime, preventing restarts that interrupt apps that rely on information between client sessions",icon:(0,h.tZ)(iG.lV,{})},{text:function(){if(eo){var e=(0,f._)((0,nx.gr)("e2-micro"),1)[0];return"Reserved VMs are billed in compute hours starting at $".concat(e,"/hour.")}return"Flat monthly price based on your custom power level, starting at $7/month"}(),icon:(0,h.tZ)(iG.G8,{})},{text:"Perfect for Discord bots, Slack bots, stateful APIs, and long-running jobs",icon:(0,h.tZ)(iG.KU,{})}]}),(0,j._)(l,G.r4.CloudRun,{display:!0,title:"Autoscale",subtitle:"Meet demand exactly",header:"Autoscale is the best choice for most projects",info:[{text:"Automatically scales from zero to any level of demand, making it inexpensive for most apps and effortless for when you go viral",icon:(0,h.tZ)(iG.Qm,{})},{text:eh||ep?"".concat(ep?"6 million":"3 million"," compute units per month are included in Replit ").concat(ep?iF.we:iF.ZK," plan. Additional usage is billed at $").concat(iW.m0," per compute unit"):"Compute units are included in Replit plans, then billed at $".concat(iW.m0," per compute unit"),icon:(0,h.tZ)(ev,{})},{text:"Perfect for web apps, and stateless APIs",icon:(0,h.tZ)(iG.KU,{})}]}),(0,j._)(l,G.r4.Static,{display:!0,title:"Static",subtitle:"Easy client-side apps",header:"Static lets you share client-side apps fast",info:[{text:"No server compute means free usage  you are only responsible for outbound data transfer (included in Replit plans)",icon:(0,h.tZ)(iG.Lv,{})},{text:"Extremely fast deploy times allow you to move quickly on your production sites",icon:(0,h.tZ)(iG.lt,{})},{text:"Perfect for HTML sites and Static content",icon:(0,h.tZ)(iG.KU,{})}]}),(0,j._)(l,G.r4.Cron,{display:ea,title:"Scheduled",subtitle:"Easy scheduled runs",header:"Scheduled deployments let you run your app at specific times",info:[{text:"Schedule for your scripts to run at fixed time intervals",icon:(0,h.tZ)(iG.lt,{})},{text:"Usage-based pricing. Allotment included in Replit ".concat(iF.we," membership"),icon:(0,h.tZ)(ev,{})},{text:"Good choice for internal tools and one-off jobs",icon:(0,h.tZ)(iG.KU,{})}]}),l);return(0,h.BX)(z,{children:[(0,h.tZ)(nq.u,{isOpen:X,onRequestClose:function(){return F(!1)},children:(0,h.tZ)(iS.Z,{onRequestClose:function(){return F(!1)}})}),(0,h.BX)(v.G,{css:ot.container,children:[(0,h.BX)(v.G,{css:ot.title,children:[(0,h.tZ)(ee.xv,{variant:"subheadBig",children:eg.title}),(0,h.tZ)(ee.xv,{color:"dimmer",children:eg.subtitle}),(0,h.tZ)(ee.xv,{css:y.l0.textAlign.center,children:(0,h.tZ)("a",{href:"https://docs.replit.com/category/deployments",target:"_blank",rel:"noopener",children:"Learn more"})})]}),(0,h.BX)(v.G,{css:y.l0.colWithGap(16),children:[(0,h.tZ)(v.G,{css:ot.providers,children:oe.map(function(e,t){if(!eg[e].display)return null;var n=eg[e],r=n.title,i=n.subtitle;return(0,h.tZ)(i6,{provider:e,loading:ed,active:T===e,onClick:function(e){R(e),O(!1)},title:r,description:i,recommended:I===e,index:e===I&&0===t?1.5:e===I&&2===t?.5:t},e)})}),(0,h.BX)(v.G,{css:y.l0.colWithGap(8),children:[(0,h.tZ)(or,{activeProvider:T,isDeployable:es,isDeployableExplanation:eu,isTeamRepl:en,loading:ed,ubbExplanation:null==em?void 0:em.explanation,hasPaymentMethod:null==em?void 0:em.hasPaymentMethod,isDeployableRepl:w,handleOnProviderContinue:function(){T&&V(T)},refetchUbbCapabilitiesQueryData:el,setShowPaymentMethodForm:function(){return O(!0)},showPaymentMethodForm:N,setShowSupportForm:function(){return F(!0)},hasUBBReservedVMs:eo}),T===G.r4.CloudRun?(0,h.tZ)(iI,{}):null,N?(0,h.tZ)(P.Tg,{elevated:!0,css:ot.payment,children:(0,h.tZ)(iA.q,{onSuccess:(0,x._)(function(){return(0,C.Jh)(this,function(e){switch(e.label){case 0:return O(!1),[4,el()];case 1:return e.sent(),[2]}})}),context:"workspace_hosting_pane"})}):null]}),(0,h.tZ)(iH,{})]}),(0,h.tZ)(v.G,{css:y.l0.colWithGap(16),children:T?(0,h.tZ)(i7,{header:eg[T].header,info:eg[T].info}):null})]})]})};function or(e){var t=e.activeProvider,n=e.isDeployable,r=e.isDeployableExplanation,i=e.isTeamRepl,o=e.loading,a=e.ubbExplanation,l=e.hasPaymentMethod,c=e.isDeployableRepl,s=e.handleOnProviderContinue,u=e.refetchUbbCapabilitiesQueryData,d=e.setShowPaymentMethodForm,f=e.showPaymentMethodForm,p=e.setShowSupportForm,m=e.hasUBBReservedVMs,g=(0,nM.rv)();return n?i&&t===G.r4.Gce?(0,h.BX)(h.HY,{children:[(0,h.tZ)(B.zx,{colorway:"primary",onClick:s,text:"Included in your subscription",disabled:!c,loading:o,css:ot.cta}),(0,h.tZ)(ee.xv,{color:"dimmer",children:r})]}):t!==G.r4.Gce||m?a===G.Fp.NeedsSubscription||a===G.Fp.NeedsSubscriptionOrPaymentMethod?g?(0,h.tZ)(S.E,{text:"You need a subscription to deploy. Navigate to Account > Billing to upgrade.",colorway:"warning",icon:(0,h.tZ)(I.Z,{}),css:ot.ctaStatusBanner}):(0,h.BX)(v.G,{css:ot.ctaContainer,children:[(0,h.tZ)(iL.Z,{context:"workspace_hosting_pane",text:"Upgrade your plan to deploy",css:ot.cta,colorway:"primary",variant:"default",disabled:f,onPlanCheckoutComplete:u}),(0,h.tZ)(B.zx,{variant:"nofill",colorway:"primary",text:"or add a payment method",css:ot.cta,disabled:f,loading:o,iconLeft:(0,h.tZ)(iU.Z,{}),onClick:function(){return d()}})]}):a===G.Fp.NeedsSmsVerification?(0,h.tZ)(i_.Z,{context:G.jv.Deployments,onSuccess:u}):a===G.Fp.NeedsPaymentMethod?g?(0,h.tZ)(S.E,{text:"You have used all free usage for this month. Check your email for more information or contact support.",colorway:"warning",icon:(0,h.tZ)(I.Z,{}),css:ot.ctaStatusBanner}):(0,h.tZ)(B.zx,{colorway:"primary",text:"Add a payment method",css:ot.cta,disabled:f,loading:o,iconLeft:(0,h.tZ)(iU.Z,{}),onClick:function(){return d()}}):a===G.Fp.NeedsUnbanning?(0,h.tZ)(iP.u,{text:"Your account currently has restrictions on deploying. We're here to help! Please reach out to our support team for assistance.",colorway:"warning",icon:(0,h.tZ)(I.Z,{}),css:ot.ctaStatusBanner,onClick:function(){return p()}}):a===G.Fp.InsufficientBudget?(0,h.BX)(h.HY,{children:[(0,h.tZ)(S.E,{text:"You've reached your monthly usage budget. Increase your budget to continue deploying.",colorway:"warning",icon:(0,h.tZ)(I.Z,{}),css:ot.ctaStatusBanner}),(0,h.tZ)(v.G,{css:ot.budgetContainer,children:(0,h.tZ)(iB.L,{onUpdateSuccess:u})})]}):(0,h.BX)(h.HY,{children:[(0,h.tZ)(B.zx,{colorway:"primary",onClick:s,text:"Set up your deployment",disabled:!c,loading:o,css:ot.cta}),!1===l?(0,h.tZ)(iP.u,{text:"Add a payment method to avoid downtime",colorway:"warning",icon:(0,h.tZ)(I.Z,{}),css:ot.ctaStatusBanner,onClick:function(){return g?null:d()}}):null]}):(0,h.tZ)(B.zx,{colorway:"primary",onClick:s,text:"Set up your deployment",disabled:!c,loading:o,css:ot.cta}):(0,h.tZ)(h.HY,{children:(0,h.tZ)(S.E,{text:r,colorway:"grey",css:ot.disabledBanner})})}var oi=n(47357);function oo(){var e=(0,en._)(["\n  fragment ReplLogLine2 on ReplLog {\n    __typename\n    timestamp\n    line\n  }\n"]);return oo=function(){return e},e}function oa(){var e=(0,en._)(["\n  query HostingDeploymentLogs2($replId: String!, $deploymentId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        __typename\n        hostingDeploymentLogs(deploymentId: $deploymentId) {\n          ... on ReplLogs {\n            result {\n              ...ReplLogLine2\n            }\n          }\n        }\n      }\n    }\n  }\n  ","\n"]);return oa=function(){return e},e}function ol(){var e=(0,en._)(["\n  subscription HostingDeploymentLogUpdates(\n    $input: HostingDeploymentLogUpdatesInput!\n  ) {\n    hostingDeploymentLogUpdates(input: $input) {\n      ... on ReplLog {\n        line\n        timestamp\n      }\n    }\n  }\n"]);return ol=function(){return e},e}var oc={},os=(0,er.Ps)(oo()),ou=(0,er.Ps)(oa(),os),od=(0,er.Ps)(ol()),of=(0,E.X)({root:[{overflow:"auto"},y.l0.coverContainer],rows:{width:"100%",position:"relative"},timestamp:[y.l0.p(6),{color:y.TV.foregroundDimmer,cursor:"pointer"}],logContainer:[y.l0.pl(6),y.l0.py(6),y.l0.pr(4),y.l0.flex.growAndShrink(1),y.l0.position.relative,y.l0.minHeight(26),{cursor:"pointer"}],logTruncated:[y.l0.flex.growAndShrink(1),y.l0.truncate],row:[y.l0.flex.row,y.l0.align.start,y.l0.font.code,y.l0.fontSize(12),{position:"absolute",top:0,left:0,width:"100%"}],noLogsContainer:[y.l0.colWithGap(8),y.l0.pt(4)],noLogsText:[y.l0.textAlign.center]}),oh=function(e){var t=e.deploymentId,n=e.replId;return t?(0,h.tZ)(om,{replId:n,deploymentId:t}):(0,h.tZ)(z,{children:(0,h.tZ)(S.E,{colorway:"warning",icon:(0,h.tZ)(I.Z,{}),text:"Deployment not found"})})};function op(e){var t=e.log,n=e.y,r=e.height,i=e.resizeRef,o=e.index,a=(0,f._)((0,b.useState)(!1),2),l=a[0],c=a[1],s=(0,b.useRef)({x:0,y:0});function u(e){var t=s.current;e.clientY===t.y&&e.clientX===t.x&&c(function(e){return!e})}function d(e){s.current={x:e.clientX,y:e.clientY}}var p=o%2==0?"color-mix(in srgb, ".concat(y.TV.backgroundHigher,", transparent)"):void 0;return(0,h.BX)(v.G,{title:t.line,css:of.row,style:{height:r,backgroundColor:p,transform:"translateY(".concat(n,"px)")},children:[(0,h.BX)(v.G,{css:of.timestamp,onClick:u,onMouseDown:d,children:[new Date(t.timestamp).toLocaleString("en-US",{month:"2-digit",day:"2-digit",year:"2-digit"})," ",new Date(t.timestamp).toLocaleString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit"})]}),(0,h.tZ)(v.G,{css:of.logContainer,onClick:u,onMouseDown:d,innerRef:i,"data-index":o,children:(0,h.tZ)(v.G,{css:!l&&of.logTruncated,children:t.line})}),l?(0,h.tZ)(n1.qi,{value:t.line}):null]})}function om(e){var t,n,r,i=e.deploymentId,o=(t={variables:{replId:e.replId,deploymentId:i},fetchPolicy:"cache-and-network",ssr:!1},n=(0,M._)({},oc,t),ei.a(ou,n)),a=o.data,l=o.loading,c=o.error,s=o.subscribeToMore;(0,b.useEffect)(function(){return s({document:od,variables:{input:{deploymentId:i}},updateQuery:function(e,t){var n=t.subscriptionData;return(0,rh.Uy)(e,function(e){var t=(null==e?void 0:e.repl.__typename)==="Repl"?e.repl.hostingDeploymentLogs.result:null;t&&t.unshift(n.data.hostingDeploymentLogUpdates)})}})},[s,i]);var u=(0,b.useRef)(null),d=(null==a?void 0:a.repl.__typename)==="Repl"?a.repl.hostingDeploymentLogs.result:null,f=(0,oi.MG)({count:d?d.length:0,getScrollElement:function(){return u.current},estimateSize:function(){return 28},overscan:10});return((0,b.useEffect)(function(){e2({context:U.k.Logs})},[]),l)?(0,h.tZ)(nu,{loading:!0}):c?(0,h.tZ)(z,{children:(0,h.tZ)(S.E,{colorway:"warning",icon:(0,h.tZ)(I.Z,{}),text:null!==(r=c.message)&&void 0!==r?r:"Something went wrong"})}):d&&(null==d?void 0:d.length)!==0?(0,h.tZ)(v.G,{innerRef:u,css:of.root,children:(0,h.tZ)(v.G,{style:{height:f.getTotalSize()},css:of.rows,children:f.getVirtualItems().map(function(e){var t=d[e.index];return t?(0,h.tZ)(op,{log:t,height:e.size,y:e.start,resizeRef:f.measureElement,index:e.index},e.key):null})})}):(0,h.tZ)(z,{children:(0,h.tZ)(ov,{message:(null==d?void 0:d.length)===0?"No logs yet":"No logs are available because the most recent build failed before it was promoted."})})}var ov=function(e){var t=e.message;return(0,h.BX)(v.G,{css:of.noLogsContainer,children:[(0,h.tZ)(ee.xv,{css:of.noLogsText,children:t}),(0,h.BX)(ee.xv,{color:"dimmer",css:of.noLogsText,children:["Having trouble?"," ",(0,h.tZ)("a",{href:"https://docs.replit.com/hosting/deployments/troubleshooting",onClick:function(){return e2({context:"troubleshooting_doc"})},target:"_blank",children:"Troubleshooting tips"})]})]})},og=(0,E.X)({sectionContainer:[y.l0.colWithGap(8)]});function oy(e){var t=e.shouldShowDownloadQR,n=(0,f._)((0,b.useState)(t),2),r=n[0],i=n[1];return(0,h.tZ)(v.G,{children:(0,h.BX)(v.G,{css:og.sectionContainer,children:[(0,h.tZ)(B.zx,{iconLeft:(0,h.tZ)(n$.Z,{}),text:"Install the Replit App",onClick:function(){return i(function(e){var t=!e;return t&&(0,e1.j)(e1.U3.DEPLOYMENT_MOBILE_DOWNLOAD_QR_VIEWED),t})}}),r?(0,h.tZ)(nj,{color:y.TV.foregroundDefault}):null]})})}function ob(){var e=(0,en._)(["\n  query AutoscaleUsageSectionCurrentUser {\n    currentUser {\n      id\n      usageInterval {\n        ... on UsageInterval {\n          startDate\n          endDate\n          resources {\n            autoscaleComputeUnits {\n              usage\n            }\n          }\n        }\n      }\n    }\n  }\n"]);return ob=function(){return e},e}var oZ={},ow=(0,er.Ps)(ob()),ox=n(52924),oC=(0,E.X)({root:[y.l0.colWithGap(4),y.l0.p(8),y.l0.pt(12),y.l0.borderRadius(8),{outline:"1px solid transparent"}],outerRow:[y.l0.rowWithGap(12),y.l0.align.center],typeCol:[y.l0.colWithGap(4),y.l0.flex.growAndShrink(1)],configAndUsageRow:[y.l0.rowWithGap(12),y.l0.align.center,y.l0.flex.growAndShrink(1)],usageRow:[y.l0.rowWithGap(8)]}),o_=function(e){var t,n=e.machineConfiguration,r=(t=(0,M._)({},oZ,void 0),ei.a(ow,t)).data,i=(0,b.useMemo)(function(){return function(e){var t,n,r=e.data;if((null==r?void 0:null===(t=r.currentUser)||void 0===t?void 0:t.__typename)==="CurrentUser"){var i=null==r?void 0:null===(n=r.currentUser)||void 0===n?void 0:n.usageInterval;if(i&&"UsageInterval"===i.__typename){var o=i.resources.autoscaleComputeUnits.usage,a=(0,ik.fZ)(o,{resourceUsageType:"ComputeUnits"}),l=new Date(i.endDate).toLocaleString("default",{month:"short",day:"numeric"});return{description:"".concat(a," used this billing period"),renewalInfo:"Renews ".concat(l," ")}}}}({data:r})},[r]),o=(0,b.useMemo)(function(){if(null!=n)return"Autoscale (".concat(n.label,")")},[n]);return o&&i?(0,h.BX)(P.Tg,{elevated:!0,css:oC.root,children:[(0,h.BX)(v.G,{css:oC.outerRow,children:[(0,h.tZ)(v.G,{css:oC.typeCol,children:o?(0,h.tZ)(ee.xv,{multiline:!1,children:o}):null}),(0,h.tZ)(eP.hU,{alt:"Edit",onClick:e.onEditAutoscaleMachineConfiguration,children:(0,h.tZ)(ox.Z,{})})]}),i?(0,h.BX)(h.HY,{children:[(0,h.BX)(v.G,{css:oC.outerRow,children:[(0,h.tZ)(ee.xv,{multiline:!1,children:i.description}),(0,h.tZ)(ee.xv,{color:"dimmer",multiline:!1,children:i.renewalInfo})]}),(0,h.tZ)(v.G,{css:oC.outerRow,children:(0,h.tZ)(nR(),{legacyBehavior:!0,passHref:!0,href:"/usage",prefetch:!1,children:(0,h.tZ)("a",{role:"button",children:"View account resource limits"})})})]}):null]}):(0,h.tZ)(v.G,{css:[y.l0.justify.center,y.l0.flex.row],children:(0,h.tZ)(g.Z,{})})},oS=n(10041),oE=n(41859),ok=n(73722),oT=(0,n(91608).$)(["paddingRight"]),oR=oT.cssVars,oD=oT.styleTokens,oI=(0,E.X)({inputWrapper:[y.l0.position.relative,y.l0.flex.growAndShrink(1),{input:[{paddingRight:oD.paddingRight}]}],copyButton:[y.l0.position.absolute,y.l0.top("50%"),y.l0.right(4),{transform:"translateY(-50%)"}]});function oG(e){return(0,h.BX)(v.G,{css:oI.inputWrapper,style:(0,j._)({},oR.paddingRight,e.value?"36px":"8px"),children:[(0,h.tZ)(ni.II,(0,X._)((0,M._)({},e),{onClick:function(e){return e.currentTarget.select()}})),e.value?(0,h.tZ)(eP.hU,{css:oI.copyButton,alt:"Copy",tooltipHidden:!0,onClick:function(){return e.value&&(0,oS.Z)(e.value)},children:(0,h.tZ)(oE.Z,{})}):null]})}var oB=(0,E.X)({root:[y.l0.flex.column,(u={gap:8},(0,j._)(u,y.nC.min("mobileMax"),[y.l0.flex.row,{"& > div:nth-of-type(1)":{width:"30%"},"& > div:nth-of-type(2)":{maxWidth:50}}]),(0,j._)(u,"label",[y.l0.color.foregroundDimmer,{fontSize:y.TV.fontSizeSmall}]),u)],col:[y.l0.colWithGap(4),y.l0.flex.growAndShrink(1)],records:[y.l0.px(12),y.l0.pt(8),y.l0.pb(16),y.l0.colWithGap(16),y.l0.borderRadius(12),(0,j._)({},y.nC.min("mobileMax"),y.l0.colWithGap(12))],divider:(0,j._)({display:"flex",height:1,backgroundColor:y.TV.outlineDimmest},y.nC.min("mobileMax"),y.l0.display.none)});function oA(e){return(0,h.BX)(v.G,{css:oB.root,children:[(0,h.BX)(v.G,{css:oB.col,children:[(0,h.tZ)(v.G,{tag:"label",children:"Hostname"}),(0,h.tZ)(ni.II,{value:e.hostname,readOnly:!0})]}),(0,h.BX)(v.G,{css:oB.col,children:[(0,h.tZ)(v.G,{tag:"label",children:"Type"}),(0,h.tZ)(ni.II,{value:e.type,readOnly:!0})]}),(0,h.BX)(v.G,{css:oB.col,children:[(0,h.tZ)(v.G,{tag:"label",children:"Record"}),(0,h.tZ)(oG,{value:e.record,readOnly:!0})]})]})}function oP(e){var t="replit-verify=".concat(e.deploymentId);return(0,h.BX)(P.Tg,{background:"default",css:oB.records,children:[(0,h.tZ)(oA,{hostname:e.hostname,type:"A",record:e.apexProxy}),(0,h.tZ)(v.G,{css:oB.divider}),(0,h.tZ)(oA,{hostname:e.hostname,type:"TXT",record:t})]})}var oN=n(99165);function oU(){var e=(0,en._)(["\n  mutation HostingDeploymentsUnlinkDomain(\n    $input: UnlinkHostingDeploymentDomainInput!\n  ) {\n    unlinkHostingDeploymentDomain(input: $input) {\n      ... on HostingDeployment {\n        id\n        domains {\n          id\n        }\n      }\n    }\n  }\n"]);return oU=function(){return e},e}function oO(){var e=(0,en._)(["\n  mutation HostingDeploymentsVerifyDomain(\n    $input: VerifyHostingDeploymentDomainInput!\n  ) {\n    verifyHostingDeploymentDomain(input: $input) {\n      ... on HostingDeploymentDomain {\n        id\n        state\n      }\n    }\n  }\n"]);return oO=function(){return e},e}var oL={},oM=(0,er.Ps)(oU()),oX=(0,er.Ps)(oO()),oF=n(78711);function oW(){var e=(0,en._)(["\n  fragment HostingDeploymentDomainsDomain on HostingDeploymentDomain {\n    id\n    state\n    domain\n  }\n"]);return oW=function(){return e},e}function oH(){var e=(0,en._)(["\n  fragment HostingDeploymentDomainsHostingDeployment on HostingDeployment {\n    id\n    currentBuild {\n      id\n      status\n    }\n    repl {\n      id\n      apexProxy\n    }\n    domains {\n      id\n      ...HostingDeploymentDomainsDomain\n    }\n    legacyReplDomains {\n      id\n      ...HostingDeploymentDomainsDomain\n    }\n  }\n  ","\n"]);return oH=function(){return e},e}function oV(){var e=(0,en._)(["\n  query HostingDeploymentDomains($id: String!) {\n    hostingDeployment(id: $id) {\n      ... on HostingDeployment {\n        id\n        ...HostingDeploymentDomainsHostingDeployment\n      }\n    }\n  }\n  ","\n"]);return oV=function(){return e},e}function oz(){var e=(0,en._)(["\n  mutation LinkHostingDeploymentDomain(\n    $input: LinkHostingDeploymentDomainInput!\n  ) {\n    linkHostingDeploymentDomain(input: $input) {\n      ... on HostingDeployment {\n        id\n        domains {\n          ...HostingDeploymentDomainsDomain\n        }\n      }\n    }\n  }\n  ","\n"]);return oz=function(){return e},e}var oj={},oq=(0,er.Ps)(oW()),oY=(0,er.Ps)(oH(),oq),o$=(0,er.Ps)(oV(),oY),oJ=(0,er.Ps)(oz(),oq),oK="https://docs.replit.com/hosting/deployments/custom-domains",oQ=(0,E.X)({root:[y.l0.colWithGap(8),y.l0.borderRadius(8),y.l0.pl(8),y.l0.pr(4),y.l0.height(32),y.l0.justify.center]}),o0=(0,E.X)({root:oQ.root,rootExpanded:[oQ.root,y.l0.height("auto"),y.l0.pt(4),y.l0.pb(12),y.l0.justify.start],domainRow:[y.l0.reset.button,y.l0.rowWithGap(8),y.l0.align.center,y.l0.justify.spaceBetween],iconButtons:[y.l0.flex.row],expanded:[y.l0.colWithGap(12),y.l0.pl(4),y.l0.pr(8)],domainWrapper:[y.l0.rowWithGap(8),y.l0.align.center,y.l0.flex.shrink(1),y.l0.color.accentPrimaryStronger,{a:y.l0.hover(y.l0.color.accentPrimaryStrongest)}],statusDot:[y.l0.borderRadius("full"),y.l0.width(6),y.l0.height(6)],status:[y.l0.rowWithGap(4),y.l0.align.center],dnsRecords:[y.l0.colWithGap(6)],buttons:[y.l0.flex.column,y.l0.justify.spaceBetween,(d={gap:8},(0,j._)(d,y.nC.min("mobileMax"),y.l0.flex.row),(0,j._)(d,"button",[y.l0.flex.growAndShrink(1)]),d)],warning:[y.l0.rowWithGap(6),y.l0.align.center]}),o1={verified:{color:y.TV.accentPositiveDefault,text:"Verified"},verifying:{color:y.TV.orangeDefault,text:"Verifying"},failed:{color:y.TV.accentNegativeDefault,text:"Failed"}};function o2(e){var t,n,r,i=e.domain,o=e.deploymentId,a=e.apexProxy,l=(0,f._)((0,b.useState)(!1),2),c=l[0],s=l[1],u=(0,f._)((0,b.useState)(!1),2),d=u[0],p=u[1],m=(0,f._)((t=(0,M._)({},oj,{variables:{id:o},fetchPolicy:"network-only",ssr:!1}),oF.t(o$,t)),2),Z=m[0],w=m[1].loading,x=(0,f._)((n=(0,M._)({},oL,void 0),oN.D(oM,n)),2),C=x[0],_=x[1].loading,S=(0,f._)((r=(0,M._)({},oL,void 0),oN.D(oX,r)),2),E=S[0],k=S[1].loading,T=i.state===G.zt.Failed,R=(0,f._)((0,b.useState)(!1),2),D=R[0],A=R[1];return(0,h.BX)(P.Tg,{elevated:!0,css:c?o0.rootExpanded:o0.root,children:[(0,h.BX)(v.G,{css:o0.domainRow,style:{borderBottomLeftRadius:c?0:void 0,borderBottomRightRadius:c?0:void 0},children:[(0,h.BX)(v.G,{css:o0.domainWrapper,children:[(0,h.tZ)(ee.xv,{multiline:!1,children:(0,h.tZ)("a",{target:"_blank",href:"https://"+i.domain,children:i.domain})}),(0,h.BX)(v.G,{css:o0.status,children:[(0,h.tZ)(v.G,{css:o0.statusDot,style:{backgroundColor:o1[i.state].color}}),(0,h.tZ)(ee.xv,{color:"dimmer",variant:"small",children:o1[i.state].text})]})]}),(0,h.BX)(v.G,{css:o0.iconButtons,children:[(0,h.tZ)(eP.hU,{alt:D?"Copied":"Copy link",onClick:function(){(0,oS.Z)(i.domain),A(!0),setTimeout(function(){return A(!1)},1e3)},children:D?(0,h.tZ)(ts.Z,{color:y.TV.accentPositiveStronger}):(0,h.tZ)(oE.Z,{color:y.TV.foregroundDimmer})}),(0,h.tZ)(eP.hU,{alt:"Edit",tooltipHidden:!0,onClick:function(){p(!1),s(function(e){return!e})},css:y.l0.color.foregroundDimmer,children:c?(0,h.tZ)(tr.Z,{}):(0,h.tZ)(ox.Z,{})})]})]}),c?(0,h.tZ)(v.G,{css:o0.expanded,children:d?(0,h.BX)(h.HY,{children:[(0,h.tZ)(ee.xv,{children:"Are you sure you want to unlink this domain?"}),(0,h.BX)(v.G,{css:o0.buttons,children:[(0,h.tZ)(B.zx,{size:"small",variant:"outlined",text:"Cancel",onClick:function(){p(!1)}}),(0,h.tZ)(B.zx,{size:"small",disabled:_,text:"Yes, unlink "+i.domain,colorway:"negative",onClick:function(){C({variables:{input:{hostingDeploymentDomainId:i.id}}})}})]})]}):(0,h.BX)(h.HY,{children:[(0,h.BX)(v.G,{css:o0.dnsRecords,children:[T?(0,h.BX)(h.HY,{children:[(0,h.BX)(v.G,{css:o0.warning,children:[(0,h.tZ)(I.Z,{}),(0,h.tZ)(ee.xv,{children:"DNS Error"})]}),(0,h.BX)(ee.xv,{children:["Failed to link domain. Make sure your domain's DNS settings have these records."," ",(0,h.tZ)("a",{target:"_blank",href:oK,children:"Learn more"})]})]}):(0,h.BX)(ee.xv,{color:"dimmer",children:["Add these records to your domain's"," ",(0,h.tZ)("strong",{css:y.l0.color.foregroundDefault,children:"DNS settings"}),". This take up to 48 hours to fully apply."," ",(0,h.tZ)("a",{target:"_blank",href:oK,children:"Learn more"})]}),(0,h.tZ)(oP,{hostname:i.domain,apexProxy:a,deploymentId:o})]}),(0,h.BX)(v.G,{css:o0.buttons,children:[(0,h.tZ)(B.zx,{iconLeft:w||k?(0,h.tZ)(g.Z,{}):(0,h.tZ)(ok.Z,{}),size:"small",text:T?"Retry linking":"Check status",onClick:function(){T?E({variables:{input:{hostingDeploymentDomainId:i.id}}}):Z()}}),(0,h.tZ)(B.zx,{iconLeft:(0,h.tZ)(iv.Z,{}),size:"small",disabled:_,text:T?"Remove domain":"Unlink domain",colorway:"negative",onClick:function(){p(!0)}})]})]})}):null]})}var o8=n(8017);function o4(){var e=(0,en._)(["\n  mutation HostingDeploymentsUnlinkLegacyReplDomain(\n    $input: UnlinkLegacyReplDomainInput!\n  ) {\n    unlinkLegacyReplDomain(input: $input) {\n      ... on Repl {\n        id\n        hostingDeployment {\n          ... on HostingDeployment {\n            id\n            legacyReplDomains {\n              id\n              ...HostingDeploymentDomainsDomain\n            }\n            domains {\n              id\n              ...HostingDeploymentDomainsDomain\n            }\n          }\n        }\n      }\n    }\n  }\n  ","\n"]);return o4=function(){return e},e}var o3={},o5=(0,er.Ps)(o4(),oq),o6=n(22699),o9=n(32508),o7=n.n(o9),ae=(0,E.X)({root:[y.l0.colWithGap(16),y.l0.p(8),y.l0.borderRadius(8),y.l0.border({color:y.TV.outlineDimmer})],labelRow:[y.l0.rowWithGap(8),y.l0.align.center],labelText:[y.l0.flex.growAndShrink(1)],controls:[y.l0.rowWithGap(8),y.l0.justify.spaceBetween,{"& > button":[y.l0.flex.growAndShrink(1)]}],domainSection:[y.l0.colWithGap(8)],error:[y.l0.rowWithGap(4),y.l0.align.center],recordsSection:[y.l0.colWithGap(8)],valueRow:[y.l0.borderRadius(8),y.l0.pl(8),y.l0.pr(4),y.l0.height(32),y.l0.rowWithGap(8),y.l0.align.center,y.l0.justify.spaceBetween,{a:y.l0.hover(y.l0.color.accentPrimaryStrongest)}]});function at(e){var t,n=(0,f._)((0,b.useState)(!0),2),r=n[0],i=n[1],o=(0,f._)((0,b.useState)(""),2),a=o[0],l=o[1],c=(0,f._)((0,b.useState)(!1),2),s=c[0],u=c[1],d=(0,f._)((t=(0,M._)({},oj,{onCompleted:function(){e.onAdd()}}),oN.D(oJ,t)),2),p=d[0],m=d[1].loading,Z=(0,b.useRef)(null),w=(0,b.useId)(),x=o7()(a,{require_valid_protocol:!1})&&a.split(".").length>=2,C=!x||m,_=x?null:"Enter a valid domain",S=m?(0,h.tZ)(g.Z,{}):(0,h.tZ)(nZ.Z,{});return r||m||(S=(0,h.tZ)(o8.Z,{})),(0,h.BX)(v.G,{tag:"form",css:ae.root,onSubmit:function(t){if(t.preventDefault(),r){var n;i(!1),null===(n=Z.current)||void 0===n||n.focus();return}p({variables:{input:{hostingDeploymentId:e.deploymentId,domain:a}}})},children:[(0,h.BX)(v.G,{css:ae.domainSection,children:[(0,h.BX)(v.G,{tag:"label",htmlFor:w,css:ae.labelRow,children:[x&&!r?(0,h.tZ)(ts.Z,{color:y.TV.accentPositiveDefault}):null,(0,h.tZ)(ee.xv,{color:"dimmer",children:"First, enter your domain"})]}),r?(0,h.tZ)(ni.II,{id:w,autoFocus:!0,placeholder:"example.com",value:a,disabled:m,onChange:function(e){return l(e.currentTarget.value)},onBlur:function(e){return u(!!e.currentTarget.value)}}):(0,h.BX)(P.Tg,{elevated:!0,css:ae.valueRow,children:[(0,h.tZ)(v.G,{href:"https://"+a,tag:"a",target:"_blank",children:a}),(0,h.tZ)(eP.hU,{alt:"Edit",onClick:function(){return i(!0)},children:(0,h.tZ)(ox.Z,{color:y.TV.foregroundDimmer})})]}),_&&s?(0,h.BX)(v.G,{css:ae.error,children:[(0,h.tZ)(I.Z,{size:12,color:y.TV.orangeDefault}),(0,h.tZ)(ee.xv,{variant:"small",children:_})]}):null]}),!r&&x?(0,h.tZ)(an,{apexProxy:e.apexProxy,domain:a,deploymentId:e.deploymentId}):null,(0,h.BX)(v.G,{css:ae.controls,children:[(0,h.tZ)(B.zx,{type:"button",text:"Cancel",onClick:e.onCancel}),(0,h.tZ)(B.zx,{ref:Z,iconRight:S,colorway:"primary",type:"submit",disabled:C,text:r?"Next":"Link domain"})]})]})}function an(e){return(0,h.BX)(v.G,{css:ae.recordsSection,children:[(0,h.BX)(v.G,{css:ae.labelRow,children:[(0,h.tZ)(o6.Z,{color:y.TV.foregroundDimmest}),(0,h.BX)(ee.xv,{multiline:!0,css:ae.labelText,children:["Next, add the following records your domain's DNS settings."," ",(0,h.tZ)("a",{target:"_blank",href:oK,children:"Learn more"})]})]}),(0,h.tZ)(oP,{apexProxy:e.apexProxy,hostname:e.domain,deploymentId:e.deploymentId})]})}var ar=(0,E.X)({root:[y.l0.py(12),y.l0.flex.column,(0,j._)({gap:6},y.nC.min("mobileMax"),[y.l0.py(4),y.l0.flex.row,y.l0.align.center,{gap:2,button:{border:"none"}}])],domainLink:[y.l0.flex.growAndShrink(1),y.l0.flex.row,y.l0.fontWeight.medium,{a:[y.l0.truncate,y.l0.flex.shrink(1)]}],confirm:[y.l0.p(8),y.l0.borderRadius(8),y.l0.colWithGap(8),y.l0.justify.spaceBetween],confirmButtons:[y.l0.rowWithGap(8),{button:[y.l0.flex.growAndShrink(1)]}],unlinkButton:[y.l0.color.foregroundDimmer,y.l0.hover(y.l0.backgroundColor.backgroundHighest)]}),ai=function(e){var t=e.domain;return(0,h.tZ)("a",{target:"_bank",href:"https://"+t,children:t})};function ao(e){var t,n=e.deploymentId,r=e.domain,i=e.apexProxy,o=(0,f._)((t=(0,M._)({},o3,void 0),oN.D(o5,t)),2),a=o[0],l=o[1].loading,c=(0,f._)((0,b.useState)(!1),2),s=c[0],u=c[1],d=(0,f._)((0,b.useState)(!1),2),p=d[0],m=d[1];return s?(0,h.BX)(P.Tg,{elevated:!0,css:ar.confirm,children:[(0,h.BX)(ee.xv,{children:["Are you sure you want to remove ",(0,h.tZ)(ai,{domain:r.domain}),"?"]}),(0,h.BX)(v.G,{css:ar.confirmButtons,children:[(0,h.tZ)(B.zx,{text:"Cancel",onClick:function(){return u(!1)},size:"small"}),(0,h.tZ)(B.zx,{size:"small",disabled:l,colorway:"negative",iconLeft:l?(0,h.tZ)(g.Z,{}):(0,h.tZ)(iv.Z,{}),text:"Unlink domain",onClick:function(){return a({variables:{input:{replDomainId:r.id}}})}})]})]}):p?(0,h.BX)(P.Tg,{elevated:!0,css:ar.confirm,children:[(0,h.BX)(v.G,{children:[(0,h.tZ)(ee.xv,{variant:"small",color:"dimmer",children:"Transfering"}),(0,h.tZ)(v.G,{css:ar.domainLink,children:(0,h.tZ)(ai,{domain:r.domain})})]}),(0,h.tZ)(an,{deploymentId:n,domain:r.domain,apexProxy:i}),(0,h.BX)(v.G,{css:ar.confirmButtons,children:[(0,h.tZ)(B.zx,{text:"Cancel",onClick:function(){return m(!1)},size:"small"}),(0,h.tZ)(B.zx,{size:"small",disabled:l,colorway:"primary",iconLeft:l?(0,h.tZ)(g.Z,{}):(0,h.tZ)(o8.Z,{}),text:"Complete transfer",onClick:function(){return a({variables:{input:{replDomainId:r.id,transferToHostingDeploymentId:n}}})}})]})]}):(0,h.BX)(v.G,{css:ar.root,children:[(0,h.tZ)(v.G,{css:ar.domainLink,children:(0,h.tZ)(ai,{domain:r.domain})}),(0,h.tZ)(B.zx,{size:"small",variant:"outlined",text:"Unlink",onClick:function(){return u(!0)},iconLeft:(0,h.tZ)(iv.Z,{}),css:ar.unlinkButton}),(0,h.tZ)(B.zx,{size:"small",variant:"outlined",disabled:l,iconRight:(0,h.tZ)(nZ.Z,{}),colorway:"primary",text:"Transfer to deployment",onClick:function(){return m(!0)}})]})}var aa=(0,E.X)({root:[y.l0.colWithGap(4),y.l0.p(12),y.l0.pb(6),y.l0.borderRadius(12),y.l0.backgroundColor.backgroundHigher,y.l0.border({color:y.TV.outlineDimmer})],header:[y.l0.align.center,y.l0.rowWithGap(8)],list:[{"& > div:not(:first-of-type)":y.l0.border({color:y.TV.outlineDimmer,direction:"top"})}]});function al(e){var t=e.domains,n=e.deploymentId,r=e.apexProxy,i=1===t.length?"domain":"domains";return(0,h.BX)(P.Tg,{css:aa.root,children:[(0,h.BX)(v.G,{css:y.l0.colWithGap(4),children:[(0,h.BX)(v.G,{css:aa.header,children:[(0,h.tZ)(I.Z,{color:y.TV.yellowStronger}),(0,h.BX)(ee.xv,{variant:"subheadDefault",children:["Transfer ",i]})]}),(0,h.BX)(ee.xv,{color:"dimmer",children:["You have attached ",t.length," custom ",i," to your development Repl. Please transfer ","domain"===i?"it":"them"," to your deployment for the best user experience."]})]}),(0,h.tZ)(v.G,{css:aa.list,children:t.map(function(e){return(0,h.tZ)(ao,{domain:e,deploymentId:n,apexProxy:r},e.id)})})]})}var ac=(0,E.X)({root:[y.l0.colWithGap(8)],error:[y.l0.center,y.l0.rowWithGap(8)],loading:[y.l0.center],empty:[y.l0.px(16),y.l0.py(32),y.l0.borderRadius(8),y.l0.center,y.l0.colWithGap(8),{border:"1px dashed",borderColor:y.TV.outlineDimmer}],primaryDomain:[y.l0.rowWithGap(4),y.l0.height(32),y.l0.justify.spaceBetween,y.l0.align.center,y.l0.pl(8),y.l0.pr(4),y.l0.borderRadius(8)],primaryDomainLink:[y.l0.flex.shrink(1),y.l0.color.accentPrimaryStronger,{a:y.l0.hover(y.l0.color.accentPrimaryStrongest)}],icons:[y.l0.flex.row,y.l0.align.center],footer:[y.l0.flex.row]});function as(e){var t,n,r,i,o=e.deployment,a=(0,f._)((0,b.useState)(!1),2),l=a[0],c=a[1],s=(0,f._)((0,b.useState)(void 0),2),u=s[0],d=s[1];t={variables:{id:o.id},fetchPolicy:"cache-and-network",ssr:!1,pollInterval:u,onCompleted:function(e){var t,n;d((null===(t=e.hostingDeployment)||void 0===t?void 0:t.__typename)==="HostingDeployment"&&(null===(n=e.hostingDeployment.domains)||void 0===n?void 0:n.some(function(e){return e.state===tj.zt.Verifying}))?3e4:void 0)}},n=(0,M._)({},oj,t),ei.a(o$,n);var p=(null==o?void 0:null===(r=o.domains)||void 0===r?void 0:r.length)?o.domains:null,m=(null==o?void 0:o.currentBuild.status)===G.Fe.Success,g=null==o?void 0:o.repl.apexProxy,w=(0,Z.$y)(),x=function(){var e,t,n,r,i,o=(null==w?void 0:null===(e=w.repl.hostingDeployment)||void 0===e?void 0:e.__typename)==="HostingDeployment"?null===(t=w.repl.hostingDeployment)||void 0===t?void 0:t.replitAppSubdomain:void 0;if(!o&&(null==w?void 0:null===(n=w.repl.owner)||void 0===n?void 0:n.username)&&(o="".concat(w.repl.slug,"-").concat(w.repl.owner.username)),o)return"https://".concat(o).concat((null===(i=window)||void 0===i?void 0:null===(r=i.location)||void 0===r?void 0:r.hostname)!=="replit.com"?".staging":"",".replit.app")}(),C=(0,f._)((0,b.useState)(!1),2),_=C[0],E=C[1];return(0,h.BX)(v.G,{css:ac.root,children:[!l&&(null==o?void 0:null===(i=o.legacyReplDomains)||void 0===i?void 0:i.length)&&g?(0,h.tZ)(al,{domains:o.legacyReplDomains,deploymentId:o.id,apexProxy:g}):null,(0,h.BX)(P.Tg,{elevated:!0,css:ac.primaryDomain,children:[(0,h.tZ)(ee.xv,{multiline:!1,css:ac.primaryDomainLink,children:(0,h.tZ)("a",{href:x,target:"_blank",rel:"noreferrer noopener",children:x})}),(0,h.BX)(v.G,{css:ac.icons,children:[(0,h.tZ)(eP.hU,{alt:_?"Copied":"Copy link",onClick:function(){x&&((0,oS.Z)(x),E(!0),setTimeout(function(){return E(!1)},1e3))},children:_?(0,h.tZ)(ts.Z,{color:y.TV.accentPositiveStronger}):(0,h.tZ)(oE.Z,{color:y.TV.foregroundDimmer})}),(0,h.tZ)(no.u,{tooltip:au,children:(0,h.tZ)(nI.Z,{"aria-label":au,color:y.TV.foregroundDimmer,css:y.l0.m(4)})})]})]}),p&&o?(0,h.tZ)(v.G,{css:y.l0.colWithGap(8),children:p.map(function(e){return(0,h.tZ)(v.G,{children:(0,h.tZ)(o2,{apexProxy:o.repl.apexProxy,deploymentId:o.id,domain:e})},e.domain)})}):null,l&&g?(0,h.tZ)(at,{apexProxy:g,deploymentId:o.id,onAdd:function(){return c(!1)},onCancel:function(){return c(!1)}}):null,m?null:(0,h.tZ)(S.E,{colorway:"warning",icon:(0,h.tZ)(I.Z,{}),text:"You must successfully deploy your project before linking a domain"}),!1===l?(0,h.tZ)(v.G,{css:ac.footer,children:(0,h.tZ)(B.zx,{disabled:!m,iconLeft:(0,h.tZ)(n0.Z,{}),text:"Link a domain",onClick:function(){return c(!0)},variant:"outlined",size:"small"})}):null]})}var au="Your primary domain cannot be changed";function ad(){var e=(0,en._)(["\n  query HostingDeploymentSettings($id: String!) {\n    hostingDeployment(id: $id) {\n      ... on HostingDeployment {\n        id\n        ...HostingDeploymentDomainsHostingDeployment\n        currentBuild {\n          id\n          provider\n          machineConfiguration {\n            ...MachineConfiguration\n          }\n          envVars {\n            name\n            value\n          }\n        }\n      }\n    }\n  }\n  ","\n  ","\n"]);return ad=function(){return e},e}var af={},ah=(0,er.Ps)(ad(),oY,nm.bN),ap=function(e){var t=e.deploymentId,n=e.onLifecycleCommand,r=e.onError;return t?(0,h.tZ)(am,{deploymentId:t,onLifecycleCommand:n,onError:r}):(0,h.tZ)(z,{children:(0,h.tZ)(S.E,{colorway:"warning",icon:(0,h.tZ)(I.Z,{}),text:"Deployment not found"})})};function am(e){var t,n,r,i,o,a,l,c,s,u,d=(0,nM.rv)(),p=(0,f._)((0,b.useState)(!1),2),m=p[0],g=p[1];(0,b.useEffect)(function(){e2({context:U.k.Settings})},[]);var Z=(a=(r={variables:{id:({deploymentId:e.deploymentId}).deploymentId},ssr:!1,fetchPolicy:"cache-and-network"},i=(0,M._)({},af,r),o=ei.a(ah,i)).data,l=o.loading,c=o.error,s=(null==a?void 0:null===(t=a.hostingDeployment)||void 0===t?void 0:t.__typename)==="HostingDeployment"?a.hostingDeployment:null,(null==a?void 0:null===(n=a.hostingDeployment)||void 0===n?void 0:n.__typename)==="NotFoundError"?{data:null,error:"Deployment not found",loading:!1}:!s&&l?{deployment:null,erorr:null,loading:!0}:c||!s?{deployment:null,error:"Something went wrong",loading:!1}:{deployment:s,error:null,loading:!1});if(m)return(0,h.tZ)(ic,{onError:e.onError,onConfirm:function(t){e.onLifecycleCommand({command:G.Qc.UpdateMachineConfiguration,machineConfigurationId:t.configurationId,maxMachineInstances:t.maxInstances})},onBack:function(){return g(!1)}});if(Z.loading)return(0,h.tZ)(z,{children:(0,h.tZ)(nu,{loading:!0})});if(Z.error)return(0,h.tZ)(nf,{text:Z.error});var w=Z.deployment,x=w.currentBuild,C=null!==(u=null==x?void 0:x.machineConfiguration)&&void 0!==u?u:void 0;return(0,h.tZ)(z,{children:(0,h.BX)(v.G,{css:[y.l0.colWithGap(32),W.Qw.maxWidth],children:[x.provider===G.r4.CloudRun?(0,h.BX)(v.G,{children:[(0,h.tZ)(ee.xv,{variant:"subheadDefault",css:[y.l0.pb(8)],children:"Resource usage"}),(0,h.tZ)(v.G,{css:[y.l0.colWithGap(16)],children:(0,h.tZ)(o_,{machineConfiguration:C,onEditAutoscaleMachineConfiguration:function(){return g(!0)}})})]}):null,(0,h.BX)(v.G,{children:[(0,h.tZ)(ee.xv,{variant:"subheadDefault",css:[y.l0.pb(8)],children:"Domains"}),(0,h.tZ)(as,{deployment:w})]}),(0,h.BX)(v.G,{children:[(0,h.tZ)(ee.xv,{variant:"subheadDefault",css:[y.l0.pb(12)],children:"Manage deployment"}),(0,h.tZ)(iy,{onLifecycleCommand:e.onLifecycleCommand})]}),d?null:(0,h.BX)(v.G,{children:[(0,h.tZ)(ee.xv,{variant:"subheadDefault",css:[y.l0.pb(12)],children:"Deploy on the go"}),(0,h.tZ)(oy,{shouldShowDownloadQR:!1})]})]})})}var av=(0,E.X)({root:[{height:"100%"},y.l0.overflow("hidden"),y.l0.position.relative],content:[y.l0.overflow("auto"),y.l0.flex.growAndShrink(1),y.l0.position.relative,y.l0.pb(16)]}),ag=function(e){var t,n,r,i=e.onViewUpdate,o=e.onError,a=e.refetch,l=e.openFile,c=e.openPane,s=e.initialView,u=e.error,d=function(e){M({type:U.a.SendDeploymentLifecycleCommand,payload:e})},p=(0,_.Z)(),m=(0,Z.hn)(),g=(0,Z.pn)(),y=(0,Z.$y)(),w=(0,Z.XZ)(),E="string"==typeof m,B=!(void 0!==g)&&!E,A=(0,f._)((0,b.useState)(function(){return g?U.k.DeploymentInProgress:B?U.k.Intro:U.k.Deployment}),2),P=A[0],N=A[1],O=(0,Z.mF)(),M=(t=(0,x._)(function(e){return(0,C.Jh)(this,function(t){switch(t.label){case 0:switch(i(),e.type){case U.a.SendDeploymentLifecycleCommand:return[3,1];case U.a.ChangeView:return[3,3];case U.a.OpenDotReplit:return[3,4]}return[3,6];case 1:return[4,O(e.payload)];case 2:if(t.sent(),e.payload.command===G.Qc.Destroy)return N(U.k.Intro),a(),[2];return e.payload.command===G.Qc.UpdateMachineConfiguration&&a(),N(U.k.Deployment),[3,7];case 3:return N(e.payload.view),[3,7];case 4:return[4,w.stat(".replit")];case 5:if(!t.sent().exists)return o("Could not find .replit configuration file."),[2];return c({type:"codeEditor",data:{path:".replit"}}),[3,7];case 6:return[3,7];case 7:return[2]}})}),function(e){return t.apply(this,arguments)});if(P===U.k.Intro)return(0,h.tZ)(v.G,{css:av.content,children:(0,h.tZ)(on,{initialSelectedProvider:s===U.k.ReservedVMTierSelection?G.r4.Gce:void 0,onLifecycleCommand:d,onViewAction:M,onError:o,onDeploy:function(){M({type:U.a.ChangeView,payload:{view:U.k.DeploymentInProgress}})},replId:p})});var X=y?(n=y.provider,r=[{view:U.k.Deployment,label:"Overview",icon:(0,h.tZ)(T.Z,{})},{view:U.k.Analytics,label:"Analytics",icon:(0,h.tZ)(k.Z,{})},{view:U.k.Settings,label:"Settings",icon:(0,h.tZ)(D.Z,{})}],n!==G.r4.Static&&r.splice(1,0,{view:U.k.Logs,label:"Logs",icon:(0,h.tZ)(R.Z,{})}),r):null;return(0,h.BX)(v.G,{css:av.root,children:[X?(0,h.tZ)(L,{onClick:function(e){M({type:U.a.ChangeView,payload:{view:e.view}})},tabs:X,activeView:P===U.k.DeploymentInProgress?U.k.Deployment:P}):null,(0,h.BX)(v.G,{css:av.content,children:[u?(0,h.tZ)(z,{children:(0,h.tZ)(S.E,{colorway:"warning",icon:(0,h.tZ)(I.Z,{}),text:u})}):null,P===U.k.Analytics?(0,h.tZ)(e9,{replId:p}):null,P===U.k.Logs?(0,h.tZ)(oh,{replId:p,deploymentId:m}):null,P===U.k.Settings?(0,h.tZ)(ap,{onError:o,deploymentId:m,onLifecycleCommand:d}):null,P===U.k.Deployment||P===U.k.DeploymentInProgress?(0,h.tZ)(iC,{view:P,refetch:a,onViewAction:M,onError:o,openFile:l,onLifecycleCommand:d}):null]})]})};function ay(e){var t=e.initialView,n=e.onViewUpdate,r=e.openFile,i=e.openPane,o=e.tabsNavRef,a=(0,Z.m8)(),l=(0,Z.kW)(),c=(0,Z.ev)(),s=(0,f._)((0,b.useState)(null),2),u=s[0],d=s[1];return l===w.z.Loading?(0,h.tZ)(v.G,{css:[y.l0.center,y.l0.my(32)],children:(0,h.tZ)(g.Z,{size:16})}):(0,h.tZ)(ag,{tabsNavRef:o,initialView:t,onViewUpdate:function(){u&&d(null),n()},onError:d,refetch:a,openFile:r,openPane:i,error:u||c})}var ab=n(3947),aZ=n(76568),aw=p.Dy.Object({type:p.Dy.Literal("deployments"),data:p.Dy.Optional(p.Dy.Object({view:p.Dy.Enum(U.k)}))}),ax={Content:function(e){var t=e.pane.data,n=e.options.performPaneOperation,r=(0,b.useRef)(function(e){if(e&&"object"==typeof e&&"view"in e&&e.view===U.k.ReservedVMTierSelection)return U.k.ReservedVMTierSelection}(t)),i=(0,b.useCallback)(function(e){return n({operation:"open",secondary:!0,pane:{type:(0,ab.Dp)(e),data:e}})},[n]),o=(0,f._)((0,b.useState)(null),2),a=o[0],l=o[1];return(0,aZ.L5)(function(){if(a)return{type:"deployments",getTabs:a.getTabs,setTab:a.setTab}},[a]),(0,h.tZ)(ay,{tabsNavRef:l,initialView:r.current,onViewUpdate:function(){r.current&&(r.current=void 0,n({operation:"replace",pane:{type:"deployments"}}))},openFile:i,openPane:function(e){n({operation:"open",pane:e})}})},Icon:function(e){var t=e.size;return(0,h.tZ)(T.Z,{size:t})},getTitle:function(){return"Deployments"},decode:function(e){return m.B4.Decode(aw,e)}}},22111:function(e,t,n){n.d(t,{J:function(){return c}});var r=n(74044),i=n(99149),o=n(73524),a=r.Dy.Union(Object.values(o.TT).map(function(e){return r.Dy.Literal(e)})),l=r.Dy.Object({type:r.Dy.Literal("docs"),data:r.Dy.Optional(r.Dy.Object({url:r.Dy.Optional(r.Dy.Union([a,r.Dy.Null()]))}))}),c=function(e){return i.B4.Decode(l,e)}},15001:function(e,t,n){n.d(t,{J:function(){return a}});var r=n(74044),i=n(99149),o=r.Dy.Object({type:r.Dy.Literal("preferences")}),a=function(e){return i.B4.Decode(o,e)}},11052:function(e,t,n){n.d(t,{G:function(){return x},s:function(){return b}});var r=n(74985),i=n(74044),o=n(99149),a=n(74833),l=n(56596),c=n(93918),s=n(47030),u=n(52682),d=n(29287),f=n(54916),h=n(74652),p=n(76568),m=n(50959),v=n(83898),g=n(59716),y=i.Dy.Object({type:i.Dy.Literal("runnerOutput")}),b={id:"outputs.clear",name:"Clear console history",default:void 0};function Z(e){var t=e.runner,n=e.options,i=(0,f.Z)(),o=i.fs,a=i.toolchain,l=i.ports,c=(0,m.useMemo)(function(){return[{type:"action",label:"Clear history",icon:(0,r.tZ)(u.Z,{}),run:function(){return t.clearBlockHistory()}}]},[t]);(0,p.L5)(function(){return{actions:c,type:"runnerOutput",startBlock:t.startBlock,endBlock:t.endBlock,writeOutputToBlock:t.writeOutputToBlock,writeErrorToBlock:t.writeErrorToBlock}},[t,c]),(0,h.Il)(function(){return[b.id,t.clearBlockHistory]},[t]);var s=(0,m.useCallback)(function(e){l.updateDotReplitPortsMapping(e,void 0)},[l]),d=(0,m.useCallback)(function(e){l.tryExposingPortAutomatically(e)},[l]),y=(0,v.ql)();return(0,r.tZ)(g.y,{runner:t,toolchain:a,ports:l,listFiles:o.listFiles,isActive:n.isActive,performPaneOperation:n.performPaneOperation,sendGhostwriterChatMessage:y,onDontExposePort:s,onDoExposePort:d})}var w=(0,c.X)({unavailable:[d.l0.p(8)]}),x={Content:function(e){var t=e.options,n=(0,f.Z)().runner;return"outputs"!==n.mode?(0,r.tZ)(l.G,{css:w.unavailable,children:(0,r.tZ)(a.xv,{children:"Console is not available."})}):(0,r.tZ)(Z,{options:t,runner:n})},Icon:function(e){var t=e.size;return(0,r.tZ)(s.Z,{size:t})},getTitle:function(){return"Console"},decode:function(e){return o.B4.Decode(y,e)}}},19403:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(74985),i=n(56596),o=n(20573),a=n(63461),l={Content:function(){return(0,r.tZ)(i.G,{style:{padding:32},children:(0,r.tZ)(a.Z,{children:"Sorry, this feature is not supported."})})},Icon:function(){return(0,r.tZ)(o.Z,{})},getTitle:function(){return"Unsupported"},decode:function(){return{type:"commands",data:{autoFocus:!1}}}}},62393:function(e,t,n){n.d(t,{Jx:function(){return m},Rm:function(){return g},Sp:function(){return v}});var r=n(66626),i=n(74985),o=n(74044),a=n(99149),l=n(96239),c=n(37463),s=n(54916),u=n(51533),d=n(86793),f=n(45495),h=n(50959),p=o.Dy.Object({type:o.Dy.Literal("webview"),data:o.Dy.Optional(o.Dy.Union([o.Dy.Object({portType:o.Dy.Literal("local"),port:o.Dy.Number(),path:o.Dy.Optional(o.Dy.String())}),o.Dy.Object({portType:o.Dy.Literal("external"),port:o.Dy.Number(),path:o.Dy.Optional(o.Dy.String())})]))}),m=function(e){return a.B4.Decode(p,e)};function v(e,t){var n=void 0;if((null==e?void 0:e.portType)==="external")n=null==e?void 0:e.port;else if((null==e?void 0:e.portType)==="local"){var r=t.find(function(t){return t.configuration.localPort===e.port});n=null==r?void 0:r.configuration.externalPort}return n}var g={Content:function(e){var t=e.pane.data,n=e.options.performPaneOperation,o=(0,s.Z)(),a=o.container,l=o.runner,p=(0,r._)((0,h.useState)(function(){return function(){}}),2),m=p[0],g=p[1],y=(0,c.bg)();return(0,d.Z)({container:a,runner:l,refreshWebView:m}),(0,f.Z)({runner:l,refreshWebView:m}),(0,i.tZ)(u.Z,{initialPort:v(t,y),initialPath:null==t?void 0:t.path,openPane:function(e){n({operation:"open",pane:e})},openNetworkingTool:function(){n({operation:"open",secondary:!0,pane:{type:"networking"}})},setRefreshCb:g})},Icon:function(e){var t=e.size;return(0,i.tZ)(l.Z,{size:t})},getTitle:function(){return"Webview"},decode:m}},761:function(e,t,n){n.d(t,{U:function(){return yF}});var r,i,o,a=n(66626),l=n(63257),c=n(74985),s=n(74044),u=n(99149),d=n(15146),f=n(57468),h=n(74833),p=n(93918),m=n(42463),v=n(88936),g=n(29287),y=n(54916),b=n(12506),Z=n(76568),w=n(50959),x=n(19659),C=(0,p.X)({text:{width:"100%",textAlign:"center"}}),_=s.Dy.Object({type:s.Dy.Literal("binary"),data:s.Dy.Object({path:s.Dy.String()})}),S={Content:function(e){var t=e.pane,n=e.options;return(0,c.tZ)(E,{path:t.data.path,performPaneOperation:n.performPaneOperation})},Icon:function(e){var t=e.pane,n=e.size;return(0,c.tZ)(f.Z,{path:t.data.path,size:n})},getTitle:function(e){return(0,x.UO)(e.data.path)},decode:function(e){return u.B4.Decode(_,e)}};function E(e){var t=e.path,n=e.performPaneOperation,r=(0,y.Z)().fs,i=(0,b.Mp)({path:t,performPaneOperation:n});(0,Z.L5)(function(){if(i)return{commands:i?(0,l._)(i):[]}},[i]);var o=(0,a._)((0,w.useState)(null),2),s=o[0],u=o[1],f=(0,a._)((0,w.useState)(!0),2),p=f[0],_=f[1];return((0,w.useEffect)(function(){var e=r.watchFile(t,{onChange:function(e){u(e.toString("base64")),_(!1)},onError:function(){u(null),_(!1)},onMoveOrDelete:function(){u(null),_(!1)}});return function(){e(),_(!0),u(null)}},[r,t]),p)?(0,c.tZ)(v.Z,{}):null===s?(0,c.tZ)(h.xv,{multiline:!1,children:"Failed to load binary file"}):(0,c.BX)(c.HY,{children:[(0,c.tZ)(b.HK,{path:t,performPaneOperation:n}),(0,c.BX)(b.VY,{centered:!0,children:[(0,c.tZ)(h.xv,{css:C.text,children:"The file is not displayed in the text editor because it is either binary or uses an unsupported text encoding."}),(0,c.tZ)(d.hU,{alt:"Download",css:[g.l0.position.absolute,g.l0.bottom(8),g.l0.right(8),g.l0.p(16)],children:(0,c.tZ)("a",{href:"data:text/plain;base64,".concat(s),download:(0,x.UO)(t),css:[g.l0.color.foregroundDimmer],children:(0,c.tZ)(m.Z,{})})})]})]})}var k=n(21533),T=n(10454),R=n(56596),D=n(3947),I=n(58091),G=n(73524),B=n(50199),A=n(41733),P=n(30509),N=n(78950),U=n(18836),O=n(10041),L=n(1498),M=n(38080),X=n(12874),F=n(41859),W=n(88883),H=(0,p.X)({button:{width:"fit-content"}});function V(e){var t=e.code,n=e.activeFile,r=(0,W.Z)(n),i=r?{text:"Insert",iconRight:(0,c.tZ)(X.Z,{}),onClick:function(){return r({code:t,insertAt:"end"})}}:{text:"Copy",iconLeft:(0,c.tZ)(F.Z,{}),onClick:function(){return(0,O.Z)(t)}};return(0,c.tZ)(M.Tg,{background:"default",children:(0,c.tZ)(L.zx,(0,A._)({size:"small",variant:"outlined",css:H.button},i))})}var z=(0,p.X)({self:g.l0.colWithGap(4),content:[g.l0.rowWithGap(4),g.l0.backgroundColor.backgroundRoot,g.l0.borderRadius(4),g.l0.p(4),g.l0.align.center,{width:"fit-content"}]});function j(e){var t=e.method,n=e.content,r=e.activeFile,i=(0,a._)((0,w.useState)(n),2),o=i[0],l=i[1];return(0,c.BX)(R.G,{css:z.self,children:[(0,c.tZ)(Q,{title:t}),(0,c.tZ)(R.G,{css:z.content,children:o.map(function(e,n){var r="".concat(t,"-").concat(n);return"input"===e.type?(0,c.tZ)(Y,{i:n,value:e.value,placeholder:e.placeholder,setContent:l},r):(0,c.tZ)(J,{value:e.value},r)})}),(0,c.tZ)(V,{code:o.reduce(function(e,t){return e+(t.value||("input"===t.type?t.placeholder:""))},""),activeFile:r})]})}var q=(0,p.X)({self:[g.l0.width(64),g.l0.height(24),g.l0.zIndex(1)]});function Y(e){var t=e.i,n=e.value,r=e.placeholder,i=e.setContent;return(0,c.tZ)(U.II,{onChange:function(e){i(function(n){return n.map(function(n,r){return t===r?(0,P._)((0,A._)({},n),{value:e.target.value}):n})})},placeholder:r,value:n||"",css:q.self})}var $=(0,p.X)({self:[g.l0.borderRadius(0),g.l0.backgroundColor.backgroundRoot],code:[g.l0.font.code,g.l0.color.greyStronger,g.l0.p(4)]});function J(e){var t=e.value;return(0,c.tZ)(R.G,{css:$.self,children:(0,c.tZ)(h.xv,{css:$.code,multiline:!1,children:t})})}var K=(0,p.X)({self:g.l0.rowWithGap(4),bold:{fontWeight:g.TV.fontWeightMedium}});function Q(e){var t=e.title,n=(0,a._)((0,B.Z)(function(){var e=(0,N._)(t.split(" "));return[e[0],e.slice(1).join(" ")]},[t]),2),r=n[0],i=n[1];return(0,c.BX)(R.G,{css:K.self,children:[(0,c.tZ)(h.xv,{css:K.bold,multiline:!1,children:r}),(0,c.tZ)(h.xv,{color:"dimmer",multiline:!1,children:i})]})}(vi=vg||(vg={})).IMPORT="Import the database",vi.CREATE="Create a new database",vi.SET="Set a key to a value",vi.GET="Get a key's value",vi.DELETE="Delete a key",vi.LIST="List all keys",vi.LIST_PREFIX="List keys with a prefix";var ee={language:"Bash",methods:[ei("Set a key to a value","curl $REPLIT_DB_URL -d '{{key}} = {{value}}'"),ei("Get a key's value","curl $REPLIT_DB_URL/{{key}}"),ei("Delete a key","curl -XDELETE $REPLIT_DB_URL/{{key}}"),ei("List all keys",'curl "$REPLIT_DB_URL?prefix={{key}}"')]},et={language:"Node",methods:[ei("Import the database",'const Database = require("@replit/database")'),ei("Create a new database","const db = new Database()"),ei("Set a key to a value",'db.set("{{key}}", "{{value}}").then(() => {})'),ei("Get a key's value",'db.get("{{key}}").then(value => {})'),ei("Delete a key",'db.delete("{{key}}").then(() => {})'),ei("List all keys","db.list().then(keys => {})"),ei("List keys with a prefix",'db.list("{{prefix}}").then(matches => {})')]},en={language:"Go",methods:[ei("Import the database",'import "github.com/replit/database-go"'),ei("Set a key to a value",'db.Set("{{key}}", "{{value}}")'),ei("Get a key's value",'value, _ := database.Get("{{key}}")'),ei("Delete a key",'database.Delete("{{key}}")'),ei("List all keys",'keys, _ := database.ListKeys("")'),ei("List keys with a prefix",'matches, _ := database.ListKeys("{{prefix}}")')]},er={language:"Python",methods:[ei("Import the database","from replit import db"),ei("Set a key to a value",'db["{{key}}"] = "{{value}}"'),ei("Get a key's value",'db["{{key}}"]'),ei("Delete a key",'del db["{{key}}"]'),ei("List all keys","keys = db.keys()"),ei("List keys with a prefix",'matches = db.prefix("{{prefix}}")')]};function ei(e,t){return{method:e,content:function(e){for(var t=[],n=0;n<e.length;){var r=e.indexOf("{{",n),i=e.indexOf("}}",n);if(-1===r||-1===i){t.push({type:"code",value:e.substring(n)});break}t.push({type:"code",value:e.substring(n,r)}),t.push({type:"input",placeholder:e.substring(r+2,i)}),n=i+2}return t}(t)}}var eo=(0,p.X)({self:g.l0.colWithGap(24),code:[g.l0.font.code,g.l0.color.greyStronger,g.l0.backgroundColor.backgroundRoot,g.l0.p(4),g.l0.borderRadius(4)]});function ea(e){var t=e.activeFile,n=(0,B.Z)(function(){return function(e){switch(e?(0,x.r6)(e):"bash"){case"js":case"ts":case"tsx":case"jsx":case"mjs":return et;case"go":return en;case"py":return er;default:return ee}}(t)},[t]);return(0,c.BX)(R.G,{css:eo.self,children:[(0,c.BX)(h.xv,{color:"dimmer",children:["You can use the Database from any Repl by making HTTP requests or a client library as outlined below. Weve set an environment variable called ",(0,c.tZ)("code",{css:eo.code,children:"REPLIT_DB_URL"})," in your Repl if you'd like to interact with the database directly."]}),n.methods.map(function(e){return(0,c.tZ)(j,{method:e.method,content:e.content,activeFile:t},"".concat(n.language).concat(e.method))})]})}var el=n(75246),ec=(0,p.X)({children:[g.l0.p(12),g.l0.colWithGap(8)]});function es(e){var t=e.title,n=e.defaultExpanded,r=e.children;return(0,c.tZ)(el.Q,{defaultExpanded:n,headerContent:(0,c.tZ)(h.xv,{variant:"subheadDefault",multiline:!1,children:t}),children:(0,c.tZ)(R.G,{css:ec.children,children:r})})}var eu=n(43312),ed=n(73157),ef=n(8279),eh=n(3630),ep=(0,eu.F4)("from{opacity:0}to{opacity:1}"),em=(0,p.X)({self:[g.l0.colWithGap(8),{animation:"".concat(ep," 100ms forwards ease-in-out alternate")}],selfLoadingText:[g.l0.height(16),g.l0.width(48),g.l0.borderRadius(4),ef.p.backgroundPulse()],selfLoading:[g.l0.height(12),g.l0.borderRadius(16),ef.p.backgroundPulse()],text:[g.l0.rowWithGap(4)],textSpan:[g.l0.width("fit-content"),g.l0.display.inlineFlex]});function ev(e){var t,n,r=e.database,i=e.loading,o=(null==r?void 0:r.sizeMB)||0,a=(t=1e6*(t=o)/1048576,"".concat(t.toFixed(),"/50 MiB")),l=i||!r;return(0,c.tZ)(R.G,{css:em.self,children:l?(0,c.BX)(c.HY,{children:[(0,c.tZ)(R.G,{css:em.selfLoadingText}),(0,c.tZ)(R.G,{css:em.selfLoading})]}):(0,c.BX)(c.HY,{children:[(0,c.BX)(h.xv,{color:"dimmer",css:em.text,multiline:!1,children:[(0,c.tZ)(R.K.span,{css:em.textSpan,children:a}),(0,c.tZ)(R.K.span,{css:em.textSpan,children:"|"}),(0,c.tZ)(R.K.span,{css:em.textSpan,children:(n=(n=null==r?void 0:r.keysCount)||0,"".concat(n," ").concat((0,ed.Z)("key",n)))})]}),(0,c.tZ)(eh.J,{current:o,total:50,tooltip:a})]})},l?"databaseLoadingStats":"databaseLoadedStats")}var eg=n(50782),ey=n(21262),eb=n(71440),eZ=n(58995);function ew(){var e=(0,ey._)(["\n  fragment DatabaseUsage on Database {\n    id\n    keysCount\n    sizeMB\n  }\n"]);return ew=function(){return e},e}function ex(){var e=(0,ey._)(["\n  query Database($replID: String!) {\n    repl(id: $replID) {\n      ... on Repl {\n        id\n        database {\n          id\n          ...DatabaseUsage\n        }\n      }\n    }\n    currentUser {\n      id\n      isLoggedIn\n    }\n  }\n  ","\n"]);return ex=function(){return e},e}var eC={},e_=(0,eb.Ps)(ew()),eS=(0,eb.Ps)(ex(),e_),eE=(0,p.X)({self:[g.l0.colWithGap(16),g.l0.p(8),g.l0.backgroundColor.backgroundDefault,D.F3],link:[g.l0.color.accentPrimaryStronger,g.l0.pr(4)],sectionWrapper:[g.l0.colWithGap(16),g.l0.overflowY("auto"),g.l0.width("100%"),{flex:"1"}]});function ek(e){var t,n,r,i,o,a,l,s,u,d=e.performPaneOperation,f=(l=(i={variables:{replID:(0,eg.Z)()},pollInterval:1e4},o=(0,A._)({},eC,i),a=eZ.a(eS,o)).data,s=a.error,u=a.loading,l&&("Repl"===l.repl.__typename?n=null==l?void 0:null===(r=l.repl)||void 0===r?void 0:r.database:t="Could not fetch Database info"),s&&("GraphQL error: You don't have access to this database"===s.message?n=null:t=s.message),{db:n,loading:u,error:t}),p=f.db,m=f.error,v=f.loading,y=(0,I.R3)();return(0,c.BX)(R.G,{css:eE.self,children:[(0,c.tZ)(h.h4,{level:2,variant:"subheadBig",children:"Database"}),(0,c.BX)(R.G,{css:eE.sectionWrapper,children:[(0,c.BX)(R.G,{children:[(0,c.BX)(h.xv,{children:[(0,c.tZ)("a",{href:G.TT.REPL_DATABASE,target:"_blank",rel:"noopener",onClick:function(e){e.preventDefault(),d({operation:"open",pane:{type:"docs",data:{url:G.TT.REPL_DATABASE}}})},children:"Replit Database"})," ","is a free, easy to use key-value store. No configuration is necessary, so you can start using it right away."]}),m?(0,c.tZ)(h.xv,{css:[g.l0.color.accentNegativeStronger],children:m}):null]}),(0,c.tZ)(es,{title:"Database Info",defaultExpanded:!0,children:(0,c.tZ)(ev,{database:p,loading:v})}),(0,c.tZ)(es,{title:"Using the database",defaultExpanded:!0,children:(0,c.tZ)(ea,{activeFile:y})})]})]})}var eT=s.Dy.Object({type:s.Dy.Literal("database")}),eR={Content:function(e){var t=e.options.performPaneOperation;return(0,c.tZ)(ek,{performPaneOperation:t})},Icon:function(e){var t=e.size;return(0,c.tZ)(T.Z,{size:t})},getTitle:function(){return"Database"},decode:function(e){return u.B4.Decode(eT,e)}},eD=n(42516),eI=n(51051),eG=n(10814),eB=n(98924),eA=n(47899),eP=n(80979),eN=n(49932),eU="rgba(180, 0, 0, 0.125)",eO="rgba(0, 180, 0, 0.125)",eL=eP.tk.theme({"&.cm-merge-b .cm-changedLine":{background:"rgba(0, 180, 0, 0.075)"},"&.cm-merge-a .cm-changedLine":{background:"rgba(180, 0, 0, 0.075)"},"&.cm-merge-b .cm-changedLineGutter":{background:eO},"&.cm-merge-a .cm-changedLineGutter":{background:eU},"&.cm-merge-b .cm-changedText":{background:eO,outline:"solid 1px ".concat(eO),borderRadius:"2px"},"&.cm-merge-a .cm-changedText":{background:eU,outline:"solid 1px ".concat(eU),borderRadius:"2px"},".cm-collapsedLines":{color:eN.TV.accentPrimaryStrongest,background:eN.TV.accentPrimaryDimmest,transition:"background 250ms ease","&:hover":{background:eN.TV.accentPrimaryDimmer}}}),eM=[eP.tk.baseTheme({".cm-scroller":{height:"100% !important",overflowY:"auto !important"}}),eP.tk.theme({".cm-scroller":{height:"auto !important",overflowY:"visible !important"}})],eX=[eI.Wl.highest(eM),eL],eF=n(17542),eW=n(20142),eH=n(84054),eV=n(7444);function ez(e){var t,n,r,i=e.a,o=e.b,s=e.style,u=e.className,d=(0,eB._)(e,["a","b","style","className"]),f=(0,a._)((0,w.useState)(null),2),h=f[0],p=f[1],m=(0,a._)((0,w.useState)(null),2),v=m[0],g=m[1],y=(0,w.useRef)(!1),b=(0,eV.Z)(d),Z=(0,eV.Z)(i.doc),x=(0,eV.Z)(o.doc),C=(0,eW.Xl)((0,P._)((0,A._)({},i),{readOnly:!0})),_=(0,eW.Xl)((0,P._)((0,A._)({},o),{readOnly:!0})),S=(t=(0,a._)((0,w.useState)(),2)[1],(0,w.useCallback)(function(e){t(function(){throw e})},[])),E=d.orientation,k=d.revertControls,T=d.renderRevertControl,R=d.collapseUnchanged,D=d.gutter,I=d.highlightChanges,G=void 0!==R,B=null==R?void 0:R.margin,N=null==R?void 0:R.minSize,U=null!==(n=null==v?void 0:v.a)&&void 0!==n?n:null,O=null!==(r=null==v?void 0:v.b)&&void 0!==r?r:null;return(0,eW.uF)(),(0,w.useEffect)(function(){var e=function(e){S(e)};if(h){var t=null;try{t=new eA.QK((0,P._)((0,A._)({},b.current),{parent:h,a:{doc:Z.current,extensions:[eP.tk.exceptionSink.of(e),eX].concat((0,l._)(C))},b:{doc:x.current,extensions:[eP.tk.exceptionSink.of(e),eX].concat((0,l._)(_))}}))}catch(t){e(t)}return t&&(g(t),y.current=!0),function(){if(t){g(null);try{t.destroy()}catch(t){e(t)}}}}},[h]),(0,w.useEffect)(function(){U&&!y.current&&U.dispatch({changes:{from:0,to:U.state.doc.length,insert:i.doc}})},[U,i.doc]),(0,w.useEffect)(function(){O&&!y.current&&O.dispatch({changes:{from:0,to:O.state.doc.length,insert:o.doc}})},[O,o.doc]),(0,w.useEffect)(function(){v&&!y.current&&ej(v,b.current.collapseUnchanged)},[v,b,i.doc,o.doc]),(0,w.useEffect)(function(){if(v&&!y.current){var e=G?{margin:B,minSize:N}:void 0;v.reconfigure({orientation:E,revertControls:k,renderRevertControl:T,collapseUnchanged:e,gutter:D,highlightChanges:I}),e&&ej(v,e)}},[v,E,k,T,G,B,N,D,I]),(0,eF.H)(U),(0,eF.H)(O),(0,w.useEffect)(function(){y.current=!1}),(0,c.BX)(c.HY,{children:[(0,c.tZ)("div",{ref:p,className:u,style:s}),(0,c.tZ)(eH.N1,{view:U}),(0,c.tZ)(eH.N1,{view:O})]})}function ej(e,t){e&&t&&(e.reconfigure({collapseUnchanged:void 0}),e.reconfigure({collapseUnchanged:(0,A._)({},t)}))}var eq=n(48528),eY=n(59639),e$=n(99741),eJ=n(67313),eK=n(55103),eQ=(0,p.X)({container:[g.l0.width(60),g.l0.height(24),g.l0.display.flex,g.l0.center,g.l0.borderRadius(4),g.l0.fontSize(g.TV.fontSizeSmall)]});function e0(e){var t,n,r;switch(e.type){case eK.h.ADDED:case eK.h.UNTRACKED:t="Added",n=g.TV.greenDimmest,r=g.TV.greenStrongest;break;case eK.h.MODIFIED:t="Modified",n=g.TV.yellowDimmest,r=g.TV.yellowStrongest;break;case eK.h.DELETED:t="Deleted",n=g.TV.redDimmest,r=g.TV.redStrongest;break;case eK.h.RENAMED:t="Renamed",n=g.TV.tealDimmest,r=g.TV.tealStrongest;break;case eK.h.COPIED:t="Copy",n=g.TV.limeDimmest,r=g.TV.limeStrongest;break;default:return null}return(0,c.tZ)(R.G,{style:{backgroundColor:n,color:r},css:eQ.container,children:(0,c.tZ)("span",{children:t})})}function e1(e){var t,n,r;switch(e.type){case"ADDED":t="Added",n=g.TV.greenDimmest,r=g.TV.greenStrongest;break;case"MODIFIED":t="Modified",n=g.TV.yellowDimmest,r=g.TV.yellowStrongest;break;case"DELETED":t="Deleted",n=g.TV.redDimmest,r=g.TV.redStrongest;break;case"RENAMED":t="Renamed",n=g.TV.tealDimmest,r=g.TV.tealStrongest;break;case"COPIED":t="Copy",n=g.TV.limeDimmest,r=g.TV.limeStrongest;break;default:return null}return(0,c.tZ)(R.G,{style:{backgroundColor:n,color:r},css:eQ.container,children:(0,c.tZ)("span",{children:t})})}var e2=n(61601),e8=[{"& > span:first-child-of-type":[g.l0.flex.grow(1),g.l0.textAlign.left]},{"& > span":[g.l0.flex.shrink(1)]},g.l0.height("auto"),g.l0.p(8),g.l0.fontWeight.medium,g.l0.backgroundColor.backgroundHigher,g.l0.flex.row,g.l0.align.center,g.l0.justify.spaceBetween,g.l0.overflow("hidden"),g.l0.cursor.pointer],e4=(0,p.X)({buttonFolded:[e8,g.l0.borderRadius(8)],buttonUnfolded:[e8,g.l0.borderRadius(8,8,0,0)],rowContainer:[g.l0.align.center,g.l0.rowWithGap(8),g.l0.position.relative,g.l0.zIndex(1),g.l0.overflow("hidden")],diffContainer:[g.l0.flex.grow(1),g.l0.borderRadius(8)],bodyContainer:[g.l0.borderRadius(0,0,8,8),g.l0.p(8),g.l0.display.flex,g.l0.flex.row,g.l0.flex.wrap,g.l0.align.center,g.l0.justify.center,g.l0.backgroundColor.backgroundDefault,g.l0.border({color:g.TV.outlineDimmer,direction:"bottom"}),g.l0.border({color:g.TV.outlineDimmer,direction:"left"}),g.l0.border({color:g.TV.outlineDimmer,direction:"right"})],noChangesContainer:[g.l0.py(8),g.l0.px(8),g.l0.center,g.l0.width("100%")],innerContainer:[g.l0.display.flex,g.l0.align.center],splitContainer:[g.l0.p(8),g.l0.display.flex,g.l0.flex.row,g.l0.justify.spaceBetween,g.l0.maxWidth("100%"),g.l0.align.center],splitChild:[g.l0.align.center,g.l0.justify.center,{flexBasis:"50%"}],buttonGroupItem:[g.l0.width(64),g.l0.height(32)]}),e3=function(e){var t=e.value,n=e.onChange;return(0,c.BX)(eY.hE,{name:"SplitOrUnifiedDiff",value:t,onChange:n,row:!0,children:[(0,c.tZ)(R.G,{css:e4.buttonGroupItem,children:(0,c.tZ)(eY.rK,{value:"Unified",text:"Unified",id:"SplitOrUnifiedDiffUnified"})}),(0,c.tZ)(R.G,{css:e4.buttonGroupItem,children:(0,c.tZ)(eY.rK,{value:"Split",text:"Split",id:"SplitOrUnifiedDiffSplit"})})]})},e5=function(e){var t=e.folded,n=void 0!==t&&t,r=e.setFolded,i=e.diff,o="".concat(i.initial.path,"/").concat(i.initial.filename),a="".concat(i.final.path,"/").concat(i.final.filename);return(0,c.BX)(R.G,{css:n?e4.buttonFolded:e4.buttonUnfolded,onClick:function(){return r(!n)},children:[(0,c.BX)(R.G,{css:[e4.rowContainer,g.l0.flex.shrink(1)],children:["RENAMED"===i.status||"COPIED"===i.status?(0,c.BX)(c.HY,{children:[(0,c.tZ)(f.Z,{path:o}),(0,c.tZ)(h.xv,{multiline:!1,children:i.initial.filename}),""===i.initial.path?null:(0,c.tZ)(h.xv,{multiline:!1,color:"dimmest",css:[g.l0.fontWeight.normal],maxLines:1,children:i.initial.path}),(0,c.tZ)(X.Z,{}),(0,c.tZ)(f.Z,{path:a}),(0,c.tZ)(h.xv,{multiline:!1,children:i.final.filename}),""===i.final.path?null:(0,c.tZ)(h.xv,{multiline:!1,color:"dimmest",css:[g.l0.fontWeight.normal],children:i.final.path})]}):(0,c.BX)(c.HY,{children:[(0,c.tZ)(f.Z,{path:a}),(0,c.tZ)(h.xv,{multiline:!1,children:i.final.filename}),""===i.final.path?null:(0,c.tZ)(h.xv,{multiline:!1,color:"dimmest",css:[g.l0.fontWeight.normal],children:i.final.path})]}),(0,c.tZ)(eq.j,{textToCopy:a,alt:"Copy Full Path",tooltip:"Copied!",tooltipPlacement:"bottom-end",timeout:2e3,children:(0,c.tZ)(F.Z,{})})]}),(0,c.BX)(R.G,{css:e4.rowContainer,children:[(0,c.tZ)(e1,{type:i.status}),(0,c.tZ)(d.hU,{alt:n?"Collapse diff":"Expand diff",onClick:function(){return r(!n)},children:n?(0,c.tZ)(e$.Z,{}):(0,c.tZ)(eJ.Z,{})})]})]})},e6=function(e){var t=e.diff;return"Split"===e.splitOrUnified?(0,c.tZ)(ez,{a:{filePath:t.initial.filename,doc:t.initial.content},b:{filePath:t.final.filename,doc:t.final.content},collapseUnchanged:{},style:{width:"100%"}}):(0,c.tZ)(eW.ZP,{filePath:t.final.filename,initialDoc:t.final.content,extensions:[eG.p.of(eI.xv.of(t.initial.content.split("\n")))],readOnly:!0,style:{width:"100%"}})},e9=function(e){return(0,x.T3)(e)?"media":(0,x.Mb)(e)?"ot":"binary"},e7=function(e){var t=e.content,n=e.type,r=e.filename;switch(n){case"media":return(0,c.tZ)(R.G,{css:[{display:"flex",height:"100%"}],children:(0,c.tZ)(e2.A,{content:t,mime:(0,x.yC)(r)})});case"ot":return(0,c.tZ)(eW.ZP,{filePath:r,initialDoc:t,readOnly:!0,style:{width:"100%"}});default:return(0,c.tZ)(h.xv,{color:"dimmest",multiline:!1,children:"This binary file has changed."})}},te=function(e){var t=e.diff,n=e.splitOrUnified;if(t.loading)return(0,c.tZ)(R.G,{css:e4.noChangesContainer,children:(0,c.tZ)(v.Z,{size:20})});if(t.initial.content===t.final.content)return(0,c.tZ)(R.G,{css:e4.noChangesContainer,children:(0,c.tZ)(h.xv,{color:"dimmest",multiline:!1,children:"There are no changes to show."})});if("DELETED"===t.status)return(0,c.tZ)(R.G,{css:e4.noChangesContainer,children:(0,c.tZ)(h.xv,{color:"dimmest",multiline:!1,children:"This file has been deleted."})});var r=e9(t.initial.filename),i=e9(t.final.filename);if("ADDED"===t.status)switch(i){case"media":return(0,c.tZ)(R.G,{css:e4.noChangesContainer,children:(0,c.tZ)(R.G,{css:e4.innerContainer,children:(0,c.tZ)(e2.A,{content:t.final.content,mime:(0,x.yC)(t.final.filename)})})});case"ot":return(0,c.tZ)(R.G,{css:e4.noChangesContainer,children:(0,c.tZ)(eW.ZP,{filePath:t.final.filename,initialDoc:t.final.content,readOnly:!0,style:{width:"100%"}})});default:return(0,c.tZ)(R.G,{css:e4.noChangesContainer,children:(0,c.tZ)(h.xv,{color:"dimmest",multiline:!1,children:"This binary file has been added."})})}return"binary"===r&&"binary"===i?(0,c.tZ)(R.G,{css:e4.noChangesContainer,children:(0,c.tZ)(h.xv,{color:"dimmest",multiline:!1,children:"This binary file has changed."})}):"ot"===r&&"ot"===i?(0,c.tZ)(e6,{diff:t,splitOrUnified:n}):(0,c.BX)(R.G,{css:e4.splitContainer,children:[(0,c.tZ)(R.G,{css:e4.splitChild,children:(0,c.tZ)(e7,{content:t.initial.content,type:r,filename:t.initial.filename})}),(0,c.tZ)(R.G,{css:e4.splitChild,children:(0,c.tZ)(e7,{content:t.final.content,type:i,filename:t.final.filename})})]})},tt=function(e){var t=e.diff,n=e.folded,r=e.setFolded,i=e.splitOrUnified;return(0,c.BX)(R.G,{css:e4.diffContainer,children:[(0,c.tZ)(e5,{folded:n,setFolded:r,diff:t}),n?null:(0,c.tZ)(M.Tg,{css:e4.bodyContainer,elevated:!0,children:(0,c.tZ)(te,{diff:t,splitOrUnified:i})})]},t.id)},tn=n(30983),tr=n(86309),ti=n(65307),to=n(27387),ta=n(96583),tl=n(19858),tc=n(43182),ts=function(e){var t=e.context,n=e.gitService,r=e.result,i=e.data;tc.$e(function(e){e.setTag("service","git"),e.setTag("context",t),e.setExtra("env",n.getEnv()),i&&tc.sU("data",i),tc.Tb(r.error)})},tu=(vo=(0,to._)(function(e,t,n,r){var i,o,a;return(0,ta.Jh)(this,function(l){switch(l.label){case 0:if("git"!==r.type)return[3,2];return i=r.revision,[4,e.getFileContents({path:n,revision:i})];case 1:if((o=l.sent()).error)throw ts({context:"use-file-at-revision-fetch-content",gitService:e,result:o,data:{path:n,revision:i}}),o.error;return[2,o.content||""];case 2:return[4,t.readFile(n,{fromDisk:!0})];case 3:if((a=l.sent()).error)throw a.error;return[2,a.content.toString("utf8")]}})}),function(e,t,n,r){return vo.apply(this,arguments)}),td=function(e,t){var n,r=(0,a._)((0,w.useState)(null),2),i=r[0],o=r[1],l=(0,a._)((0,w.useState)(!0),2),c=l[0],s=l[1],u=(0,y.Z)().fs,d=(0,tl.Z)((n=(0,to._)(function(n){var r,i;return(0,ta.Jh)(this,function(o){switch(o.label){case 0:s(!0),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,tu(n,u,e,t)];case 2:return r=o.sent(),s(!1),[2,{content:r,error:null}];case 3:return i=o.sent(),s(!1),[2,{content:null,error:i}];case 4:return[2]}})}),function(e){return n.apply(this,arguments)}),[e,t,u]);return(0,w.useEffect)(function(){d&&(d.error?o(null):o(d.content))},[d]),{fileContent:i,loading:c}},tf=s.Dy.Object({type:s.Dy.Literal("git"),revision:s.Dy.String()}),th=s.Dy.Object({type:s.Dy.Literal("fs")}),tp=s.Dy.Object({type:s.Dy.Literal("diff"),data:s.Dy.Object({left:s.Dy.Object({path:s.Dy.String(),data:s.Dy.Union([tf,th])}),right:s.Dy.Object({path:s.Dy.String(),data:s.Dy.Union([tf,th])})})}),tm=(0,p.X)({container:[g.l0.colWithGap(16),g.l0.p(8)],header:[g.l0.mt(0),g.l0.mb(8)],emphasizedText:[g.l0.fontWeight.bold],bodyContainer:[g.l0.borderRadius(8),g.l0.p(8),g.l0.display.flex,g.l0.flex.row,g.l0.flex.wrap,g.l0.align.center,g.l0.justify.center,g.l0.backgroundColor.backgroundDefault,g.l0.border({color:g.TV.outlineDimmest,direction:"full"})],tooltipContainer:[g.l0.display.inlineBlock]}),tv=function(e){var t=e.filename,n=e.onFileClick;return(0,c.tZ)("span",{css:tm.tooltipContainer,children:(0,c.tZ)(tn.u,{tooltip:"View file",children:(0,c.tZ)("button",{css:[g.l0.reset.button,g.l0.linkStyle,g.l0.fontWeight.medium],onClick:n,children:t})})})},tg=function(e){return"git"===e.type?e.revision:"working directory"},ty=function(e){var t,n,r=e.left,i=e.right,o=e.onFileClick,a=r.path===i.path,l=(t=r.data,n=i.data,t.type===n.type&&("git"!==t.type||t.revision===n.revision));return a?l?(0,c.BX)(h.h4,{level:1,variant:"text",css:tm.header,children:["Comparing"," ",(0,c.BX)("span",{css:tm.emphasizedText,children:[(0,c.tZ)(tv,{filename:r.path,onFileClick:o})," ",tg(r.data)]})," ","to itself"]}):(0,c.BX)(h.h4,{level:1,variant:"text",css:tm.header,children:["Comparing"," ",(0,c.BX)("span",{css:tm.emphasizedText,children:[(0,c.tZ)(tv,{filename:r.path,onFileClick:o})," ",tg(r.data)]})," ","to ",(0,c.tZ)("span",{css:tm.emphasizedText,children:tg(i.data)})]}):l?(0,c.BX)(h.h4,{level:1,variant:"text",css:tm.header,children:["Comparing ",(0,c.tZ)("span",{css:tm.emphasizedText,children:r.path})," to"," ",(0,c.BX)("span",{css:tm.emphasizedText,children:[(0,c.tZ)(tv,{filename:i.path,onFileClick:o})," ",tg(r.data)]})]}):(0,c.BX)(h.h4,{level:1,variant:"text",css:tm.header,children:["Comparing"," ",(0,c.BX)("span",{css:tm.emphasizedText,children:[r.path," ",tg(r.data)]})," ","to"," ",(0,c.BX)("span",{css:tm.emphasizedText,children:[(0,c.tZ)(tv,{filename:i.path,onFileClick:o})," ",tg(i.data)]})]})},tb=(vy={},(0,eD._)(vy,"Content",function(e){var t=e.pane.data,n=t.left,r=t.right,i=e.options.performPaneOperation,o=(0,a._)((0,w.useState)("Split"),2),l=o[0],s=o[1],u=td(n.path,n.data),d=u.fileContent,f=u.loading,h=td(r.path,r.data),p=h.fileContent,m=h.loading,v=(0,w.useMemo)(function(){return null===d&&null!==p?ti.y.ADDED:null!==d&&null===p?ti.y.DELETED:ti.y.MODIFIED},[d,p]);return(0,c.BX)(R.G,{css:tm.container,children:[(0,c.tZ)(ty,{left:n,right:r,onFileClick:function(){i({operation:"open",pane:{type:(0,D.Dp)({path:r.path}),data:{path:r.path}}})}}),(0,c.tZ)(e3,{value:l,onChange:s}),(0,c.tZ)(M.Tg,{css:tm.bodyContainer,children:(0,c.tZ)(te,{diff:{id:"".concat(n.path,"-").concat(r.path),status:v,loading:f||m,initial:{filename:(0,x.UO)(n.path),path:(0,x.Il)(n.path),content:null!=d?d:""},final:{filename:(0,x.UO)(r.path),path:(0,x.Il)(r.path),content:null!=p?p:""}},splitOrUnified:l})})]})}),(0,eD._)(vy,"Icon",function(){return(0,c.tZ)(tr.Z,{})}),(0,eD._)(vy,"getTitle",function(){return"Diff"}),(0,eD._)(vy,"decode",function(e){return u.B4.Decode(tp,e)}),vy),tZ=n(97168),tw=n(98655),tx=n(56337),tC=n(73660),t_=n(70671),tS=n(61405),tE=n(86763),tk=n.n(tE),tT=n(41500),tR=n(92674),tD=n.n(tR);function tI(){var e=(0,ey._)(["\n  query WorkspaceDrawCurrentUser {\n    currentUser {\n      id\n      username\n    }\n  }\n"]);return tI=function(){return e},e}var tG={},tB=(0,eb.Ps)(tI()),tA=function(e){return e.reduce(function(e,t){return e[t.id]=t,e},{})},tP=function(e,t,n){if(!e)return[];var r,i=t(e.getSceneElementsIncludingDeleted()),o=e.getAppState();return(r=n.reduce(function(e,t){var n,r,a;return t.id===(null===(n=o.editingElement)||void 0===n?void 0:n.id)||t.id===(null===(r=o.resizingElement)||void 0===r?void 0:r.id)||t.id===(null===(a=o.draggingElement)||void 0===a?void 0:a.id)||(i[t.id]&&i[t.id].version>t.version?e.push(i[t.id]):i[t.id]&&i[t.id].version===t.version&&i[t.id].versionNonce!==t.versionNonce&&i[t.id].versionNonce<t.versionNonce?e.push(i[t.id]):e.push(t),delete i[t.id]),e},[])).concat.apply(r,(0,l._)(Object.values(i)))},tN=function(){var e,t,n=new Promise(function(n,r){e=n,t=r});return n.resolve=e,n.reject=t,n},tU=(0,eu.iv)(".excalidraw.excalidraw-modal-container.excalidraw--mobile{margin-top:",tw.Mz-1,"px;}");function tO(e){var t,r,i,o,s=e.fs,u=e.broadcast,d=e.filePath,f=(0,a._)((0,w.useState)(void 0),2),h=f[0],p=f[1],m=(0,tx.Z)(),v=(0,w.useRef)(function(e){return(0,l._)(e)}),y=(0,w.useRef)(function(e){return -1}),b=(0,w.useRef)({readyPromise:tN()}),Z=(0,w.useRef)({promise:null});(0,w.useEffect)(function(){Promise.all([n.e(6655),n.e(3668)]).then(n.t.bind(n,63668,23)).then(function(e){v.current=function(t){return t.filter(function(t){return t.isDeleted||!e.isInvisiblySmallElement(t)})},y.current=e.getSceneVersion,p(e.Excalidraw)})},[]);var x=function(){return b.current},C=(t=(0,A._)({},tG,{ssr:!1}),eZ.a(tB,t)),_=C.data,S=C.loading,E=(null==_?void 0:null===(o=_.currentUser)||void 0===o?void 0:o.username)||"",k=(0,t_.F)().isDarkColorScheme,T=(0,tS.aG)(),D=(0,tC.Z)(),I=null==D?void 0:D.color,G=(0,a._)((0,w.useState)(new Map),2),B=G[0],N=G[1],U=(0,a._)((0,w.useState)(-1),2),O=U[0],L=U[1],M=(0,w.useRef)(tD()()).current;(0,w.useEffect)(function(){function e(){return(e=(0,to._)(function(){var e,t;return(0,ta.Jh)(this,function(n){switch(n.label){case 0:if(!_||!_.currentUser)return[2];return[4,b.current.readyPromise];case 1:return n.sent(),e=x().getAppState().collaborators,t=new Map,T.forEach(function(n){if(n.username!==(null==_?void 0:null===(r=_.currentUser)||void 0===r?void 0:r.username)){var r,i=e.get(n.username)||{};t.set(n.username,(0,P._)((0,A._)({},i),{username:n.username,color:{background:n.color,foreground:n.color}}))}}),x().updateScene({collaborators:t}),[2]}})})).apply(this,arguments)}!function(){e.apply(this,arguments)}()},[_,T]);var X=(r=(0,to._)(function(e,t){var n,r,i,o,a,l;return(0,ta.Jh)(this,function(c){t||(e=e.filter(function(e){return!B.has(e.id)||e.version>B.get(e.id)})),n=!0,r=!1,i=void 0;try{for(o=e[Symbol.iterator]();!(n=(a=o.next()).done);n=!0)l=a.value,B.set(l.id,l.version),N(new Map(B))}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return u.broadcastMessage(M,{text:JSON.stringify({elements:e,path:d})}),[2]})}),function(e,t){return r.apply(this,arguments)});(0,w.useEffect)(function(){if(u)return u.onBroadcastReceived(M,function(e){var t=e.username,n=JSON.parse(e.text);if(n.path===d){if(n.collaborator&&b.current){var r=x().getAppState().collaborators;r.set(t,(0,P._)((0,A._)({},r.get(t),n.collaborator),{username:t})),x().updateScene({collaborators:r})}else if(n.elements){var i=tP(x(),tA,n.elements);L(y.current(i)),x().updateScene({elements:i})}else if(n.removePresence){var o=x().getAppState().collaborators;o.delete(n.removePresence),x().updateScene({collaborators:o})}}})},[u,d,M]),(0,w.useEffect)(function(){function e(){return(e=(0,to._)(function(){return(0,ta.Jh)(this,function(e){var t;return d&&s&&(Z.current.promise=new Promise((t=(0,to._)(function(e){var t,n,r;return(0,ta.Jh)(this,function(i){switch(i.label){case 0:return[4,Promise.all([s.readFile(d),b.current.readyPromise])];case 1:return"content"in(t=a._.apply(void 0,[i.sent(),1])[0])&&(n=JSON.parse(t.content.toString()||"{}"),r=x().getAppState(),n.appState=(0,A._)({},r),n.scrollToContent=!0,e(n)),[2]}})}),function(e){return t.apply(this,arguments)}))),[2]})})).apply(this,arguments)}!function(){e.apply(this,arguments)}()},[d,s]);var F=(0,w.useCallback)(tk()((i=(0,to._)(function(e,t){var n;return(0,ta.Jh)(this,function(r){switch(r.label){case 0:if(n=e.filter(function(e){return!e.isDeleted}),!d)return[3,2];return[4,s.writeFile(d,tT.Z.from(JSON.stringify({elements:n,files:t})))];case 1:r.sent(),r.label=2;case 2:return[2]}})}),function(e,t){return i.apply(this,arguments)}),350),[d]),W=function(e){y.current(e)>O&&(O>-1&&X(v.current(e),!1),L(y.current(e)))};return(0,c.BX)(R.G,{css:{position:"relative",height:"100%",width:"100%",flex:1,boxShadow:I?"0 3px 0 3px ".concat(I):"none",backgroundColor:g.TV.backgroundDefault,"& .excalidraw [title~=Library]":{display:"none"}},onMouseLeave:function(){u.broadcastMessage(M,{text:JSON.stringify({removePresence:E,path:d})})},children:[h&&!S?(0,c.tZ)(h,{ref:b,UIOptions:{canvasActions:{loadScene:!1}},isCollaborating:!0,theme:k?"dark":"light",initialData:Z.current.promise,onPointerUpdate:function(e){var t=e.pointer,n=x().getAppState().selectedElementIds||{};u.broadcastMessage(M,{text:JSON.stringify({collaborator:{pointer:t,selectedElementIds:n},path:d})})},onChange:function(e,t,n){W(e),L(y.current(e)),y.current(e)>O&&F(e,n)},name:E}):null,m?(0,c.tZ)(eu.xB,{styles:[tU]}):null]})}function tL(e){var t=e.fs,n=e.broadcast,r=e.filePath;return(0,c.tZ)(tO,{fs:t,broadcast:n,filePath:r},r)}var tM=s.Dy.Object({type:s.Dy.Literal("draw"),data:s.Dy.Object({path:s.Dy.String()})}),tX={Content:function(e){var t=e.pane,n=e.options.performPaneOperation;return(0,c.tZ)(tF,{path:t.data.path,performPaneOperation:n})},Icon:function(e){var t=e.size;return(0,c.tZ)(tZ.Z,{size:t})},getTitle:function(e){return(0,x.UO)(e.data.path)},decode:function(e){return u.B4.Decode(tM,e)}};function tF(e){var t=e.path,n=e.performPaneOperation,r=(0,y.Z)(),i=r.fs,o=r.broadcast,a=(0,b.Mp)({path:t,performPaneOperation:n});return(0,Z.L5)(function(){if(a)return{commands:a}},[a]),(0,c.BX)(c.HY,{children:[(0,c.tZ)(b.HK,{path:t,performPaneOperation:n}),(0,c.tZ)(b.VY,{children:(0,c.tZ)(tL,{fs:i,broadcast:o,filePath:t})})]})}var tW=n(97411),tH=n(52489),tV=s.Dy.Object({type:s.Dy.Literal("envEditor")}),tz={Content:function(){return(0,c.tZ)(tj,{})},Icon:function(e){var t=e.size;return(0,c.tZ)(tW.Z,{size:t})},getTitle:function(){return"Secrets"},decode:function(e){return u.B4.Decode(tV,e)}};function tj(){var e=(0,y.Z)().fs,t=(0,y.Z)().runner;return(0,c.tZ)(tH.ZP,{readRawEnv:function(){return e.readFile(".env")},writeRawEnv:function(t){return e.writeFile(".env",t)},getRunState:t.getRunState})}var tq=n(8271),tY=n(25425),t$=n(57369),tJ=n(75647),tK=n(71999),tQ=n(90234),t0=(0,w.createContext)(null);function t1(){var e=(0,w.useContext)(t0);if(!e)throw Error("Expected store in context");return e}var t2=(0,tQ.cn)([]),t8=(0,tQ.cn)(function(e){return e(t2)},function(e,t,n){var r=e(t2),i=Math.random().toString(36).substring(7);t(t2,[{id:i,type:n,dismiss:function(){var n=e(t2).filter(function(e){return e.id!==i});t(t2,n)}}].concat((0,l._)(r)))});function t4(){return(0,tK.b9)(t8,{store:t1()})}var t3=n(40028),t5=n(47357),t6=n(68514),t9=n(93496),t7=n(40227),ne=n(54843),nt=n(57624),nn=n(99656),nr=n(21076),ni=n(16405),no=n(79378),na=n(13051),nl=n(63043),nc=n(78711);function ns(){var e=(0,ey._)(["\n  query GitUserImageByUsername($username: String!) {\n    userByUsername(username: $username) {\n      id\n      image\n    }\n  }\n"]);return ns=function(){return e},e}var nu={},nd=(0,eb.Ps)(ns()),nf=n(79032),nh=(0,p.X)({gitUserContainer:[g.l0.flex.row],gitUserText:[g.l0.fontWeight.medium],gitUserInnerContainer:[g.l0.align.center,g.l0.flex.row,{"& > :not(:first-child)":{marginLeft:g.TV.space4}}],gitUserInnerContainerFlipped:[g.l0.align.center,g.l0.flex.rowReverse,{"& > :not(:last-child)":{marginLeft:g.TV.space4}}],alignCenter:[g.l0.align.center]});function np(e){var t=e.name,n=e.email,r=e.allowPlaceholderAvatar,i=void 0!==r&&r,o=e.color,a=void 0===o?"default":o,l=e.small,s=void 0!==l&&l,u=e.flip,d=void 0!==u&&u,f=e.placement,p=e.showTooltip;return void 0===p||p?(0,c.tZ)(R.G,{css:nh.gitUserContainer,children:(0,c.tZ)(tn.u,{placement:void 0===f?"bottom":f,tooltip:(0,c.tZ)(h.xv,{children:n}),children:(0,c.BX)(R.G,{css:d?nh.gitUserInnerContainerFlipped:nh.gitUserInnerContainer,children:[(0,c.tZ)(nm,{email:n,name:t,enablePlaceholder:i,small:s}),(0,c.tZ)(h.xv,{multiline:!1,css:nh.gitUserText,color:a,variant:s?"small":"text",children:t})]})})}):(0,c.tZ)(R.G,{css:nh.gitUserContainer,children:(0,c.BX)(R.G,{css:d?nh.gitUserInnerContainerFlipped:nh.gitUserInnerContainer,children:[(0,c.tZ)(nm,{email:n,name:t,enablePlaceholder:i,small:s}),(0,c.tZ)(h.xv,{multiline:!1,css:nh.gitUserText,color:a,variant:s?"small":"text",children:t})]})})}function nm(e){var t,n=e.name,r=e.email,i=e.enablePlaceholder,o=void 0!==i&&i,l=e.small,s=void 0!==l&&l,u=(0,a._)((t=(0,A._)({},nu,{initialFetchPolicy:"cache-and-network",nextFetchPolicy:"cache-first",ssr:!1}),nc.t(nd,t)),1)[0],d=(0,a._)((0,w.useState)(null),2),f=d[0],h=d[1];return(0,w.useEffect)(function(){var e;(e=(0,to._)(function(){var e,t,n,i,o,l,c,s,d,f;return(0,ta.Jh)(this,function(p){switch(p.label){case 0:if(!r.endsWith("@".concat(nl.O)))return[3,1];return e=r.split("@")[0],(t=(0,a._)(e.split("+"),2))[0],n=t[1],h((0,ni.vt)("https://github.com/".concat(n,".png"))),[3,4];case 1:if(!r.endsWith("@".concat(nl.J)))return[3,3];return l=r.split("@")[0],(c=(0,a._)(l.split("-"),2))[0],[4,u({variables:{username:c[1]}})];case 2:return(s=null===(o=p.sent().data)||void 0===o?void 0:null===(i=o.userByUsername)||void 0===i?void 0:i.image)&&h(s),[3,4];case 3:d=(0,nf.FB)(r),(f=new URL("https://gravatar.com/avatar/".concat(d))).searchParams.append("d","404"),h(f.toString()),p.label=4;case 4:return[2]}})}),function(){return e.apply(this,arguments)})()},[r,u]),(0,w.useMemo)(function(){var e=s?12:16;return null===f?o?(0,c.tZ)(na.Z,{css:nh.alignCenter,size:e}):null:(0,c.tZ)(no.q,{css:nh.alignCenter,username:n,src:f,onError:function(){return h(null)},size:e})},[f,o,s,n])}var nv=n(59868),ng=n(67795);function ny(e,t){(0,nv.j)(ng.U3.GIT_FEATURE_USED,(0,A._)({action:e,source:"git-pane"},t))}var nb=n(68333),nZ=n(87959);(va=vb||(vb={})).SUCCESS="SUCCESS",va.WARNING="WARNING",va.FAILED="FAILED",va.OFF="OFF";var nw=(0,p.X)({root:[g.l0.rowWithGap(8),g.l0.align.center,g.l0.py(4)],circle:[g.l0.width(8),g.l0.height(8),g.l0.borderRadius("full")]}),nx=function(e){var t,n,r,i=e.display,o=void 0===i?"inline":i,a=(0,eB._)(e,["display"]);switch(a.status){case"SUCCESS":t=g.TV.accentPositiveStronger,n=g.TV.accentPositiveStronger;break;case"WARNING":t=g.TV.yellowStronger,n=g.TV.yellowStronger;break;case"FAILED":t=g.TV.accentNegativeStronger,n=g.TV.accentNegativeStronger;break;case"OFF":t=g.TV.greyStronger,n=g.TV.greyStronger}var l=(0,c.BX)(R.G,{onClick:null!==(r=a.onClick)&&void 0!==r?r:function(){},css:[nw.root,a.onClick?{cursor:"pointer"}:{}],children:[(0,c.tZ)("div",{css:nw.circle,style:{backgroundColor:t,boxShadow:"0px 0px 6px ".concat(n)}}),"inline"===o?(0,c.tZ)(h.xv,{color:"dimmer",multiline:!1,children:a.content}):null]});return"tooltip"===o&&(l=(0,c.tZ)(tn.u,{tooltip:a.content,children:l})),l},nC=(0,p.X)({revertText:[g.l0.color.orangeStronger,g.l0.fontWeight.medium],mergeText:[g.l0.color.purpleStronger,g.l0.fontWeight.medium],pullRequestId:[g.l0.fontWeight.medium],hash:[g.l0.fontWeight.medium],filePathPrefix:[g.l0.color.foregroundDimmest],commitBody:[g.l0.font.code,{whiteSpace:"pre-wrap"},{fontSize:g.TV.fontSizeSmall}],clickableName:[g.l0.cursor.pointer,{"&:hover":{textDecoration:"underline"}}],tooltip:[g.l0.display.inlineFlex,g.l0.rowWithGap(4),g.l0.align.center],path:[{fontSize:g.TV.fontSizeSmall},g.l0.font.code],fixTooltipDisplay:{"& > span":{display:"inline-block"}},headingWrapper:[g.l0.display.inlineFlex,g.l0.rowWithGap(4),g.l0.align.center,g.l0.flex.shrink(1),g.l0.overflow("hidden")],headingRemote:[{verticalAlign:"text-bottom"},g.l0.mr(4),g.l0.color.foregroundDimmest],headingCurrent:[g.l0.px(4)],text:[g.l0.fontWeight.medium],remote:[{verticalAlign:"center"},{fontSize:g.TV.fontSizeSmall},g.l0.mr(4),g.l0.color.foregroundDimmest],current:[g.l0.position.relative,g.l0.top("-1px"),g.l0.display.inlineFlex,g.l0.pl(2),g.l0.pr(8)],icon:[{verticalAlign:"baseline !important"},g.l0.mr(4)],bodyContainer:[g.l0.border({color:g.TV.outlineDimmest,direction:"full"}),g.l0.borderRadius(8),g.l0.p(16)]});function n_(e){var t=e.text,n=e.className;return(0,c.tZ)("span",{className:n,css:nC.revertText,children:t})}function nS(e){var t=e.text,n=e.className;return(0,c.tZ)("span",{className:n,css:nC.mergeText,children:t})}function nE(e){var t,n=e.id,r=e.hash,i=e.className;return t=void 0===r||r?"string"==typeof n&&n.startsWith("#")?n:"#".concat(n):"string"==typeof n&&n.startsWith("#")?n.slice(1):"".concat(n),(0,c.tZ)("span",{className:i,css:nC.pullRequestId,children:t})}function nk(e){var t=e.hash,n=e.length,r=e.className;return(0,c.tZ)("span",{className:r,css:nC.hash,children:t.slice(0,(void 0===n?8:n)+1)})}function nT(e){var t=e.subject,n=e.quoted,r=e.className;return(0,c.tZ)("span",{className:r,children:void 0!==n&&n?'"'.concat(t,'"'):t})}function nR(e){var t=e.body,n=e.view,r=e.className;return"Source"===(void 0===n?"Source":n)?(0,c.tZ)(R.G,{css:nC.bodyContainer,children:(0,c.tZ)("pre",{className:r,css:nC.commitBody,children:t})}):(0,c.tZ)(R.G,{css:nC.bodyContainer,children:(0,c.tZ)(nb.ZP,{className:r,background:!1,mentionsLink:!0,lineBreaks:!0,themed:!0,useRemarkGfm:!0,children:t})})}function nD(e){var t=e.name,n=e.remote,r=e.current,i=void 0!==r&&r,o=e.heading,a=void 0!==o&&o,l=e.icon,s=void 0!==l&&l,u=e.onClick,d=e.className,f=null;return(!0===s||!s&&i?f=i?(0,c.tZ)("span",{css:a?nC.headingCurrent:nC.current,children:(0,c.tZ)(nx,{display:"tooltip",content:"This is your current branch.",status:vb.SUCCESS})}):a?(0,c.tZ)(nZ.Z,{size:16}):(0,c.tZ)(nZ.Z,{css:nC.icon,size:12}):s&&(f=s),a)?(0,c.BX)("div",{css:nC.headingWrapper,children:[f,(0,c.BX)(h.xv,{variant:"subheadDefault",multiline:!1,children:[n?(0,c.BX)(c.HY,{children:[(0,c.tZ)("span",{css:nC.headingRemote,children:n}),(0,c.tZ)("span",{css:nC.headingRemote,children:"/"})]}):null,u?(0,c.tZ)(nB,{label:"View branch",onClick:u,children:t}):(0,c.tZ)("span",{children:t})]})]}):(0,c.BX)("span",{className:d,css:nC.text,children:[f,n?(0,c.tZ)("span",{css:nC.remote,children:n}):null,u?(0,c.tZ)(nB,{label:"View branch",onClick:u,children:t}):(0,c.tZ)("span",{children:t})]})}function nI(e){var t=e.path,n=e.prefix,r=e.onClick,i=e.className,o=(0,x.UO)(t),a=!r&&(o===t||null!==n&&n+o===t);return(0,c.tZ)("span",{css:nC.fixTooltipDisplay,children:(0,c.tZ)(tn.u,{maxWidth:"auto",tooltip:(0,c.tZ)(nG,{path:t,openable:!!r}),isDisabled:a,children:r?(0,c.BX)(nB,{label:"Open ".concat(o),onClick:r,className:i,children:[n?(0,c.tZ)("span",{css:nC.filePathPrefix,children:n}):null,(0,c.tZ)("span",{children:o})]}):(0,c.BX)("span",{className:i,children:[n?(0,c.tZ)("span",{css:nC.filePathPrefix,children:n}):null,(0,c.tZ)("span",{children:o})]})})})}function nG(e){var t=e.path,n=e.openable;return(0,c.BX)("span",{css:nC.tooltip,children:[void 0===n||n?(0,c.tZ)("span",{children:"Open"}):null,(0,c.tZ)("span",{css:nC.path,children:t})]})}function nB(e){var t=e.label,n=e.onClick,r=e.className,i=e.children;return(0,c.tZ)("span",{className:r,css:nC.clickableName,role:"button",tabIndex:-1,"aria-label":t,onClick:n,onKeyDown:function(e){("Enter"===e.key||" "===e.key)&&(null==n||n())},children:i})}(vl=vZ||(vZ={})).DASHBOARD="DASHBOARD",vl.BRANCH="BRANCH",vl.CURRENT_BRANCH="CURRENT_BRANCH",vl.SETTINGS="SETTINGS",vl.COMMIT="COMMIT";var nA=n(1169),nP=R.K.button,nN=(0,p.X)({container:[g.l0.display.flex,g.l0.flex.growAndShrink(1),g.l0.overflow("hidden")],cursorOverlay:{cursor:"pointer"},fullWidth:[g.l0.width("100%")],searchContainer:[g.l0.p(8)],paddedX:[g.l0.px(8)],loadingContainer:[g.l0.display.flex,g.l0.align.center,g.l0.justify.center,g.l0.py(48)],menu:[g.l0.maxWidth(390),g.l0.width(280),g.l0.display.flex,g.l0.maxHeight(300),g.l0.borderRadius(8),g.l0.overflow("hidden")],form:[g.l0.display.flex,g.l0.flex.growAndShrink(1),g.l0.flex.column,g.l0.overflow("hidden")],body:[g.l0.py(8),g.l0.colWithGap(8),g.l0.flex.growAndShrink(1),g.l0.overflow("auto")],branchMetadata:[g.l0.rowWithGap(8),g.l0.align.center,g.l0.flex.shrink(1)],section:[g.l0.rowWithGap(8),g.l0.align.center,g.l0.justify.spaceBetween],selector:[g.l0.display.flex,g.l0.align.center,g.l0.rowWithGap(4)],header:[g.l0.colWithGap(2),g.l0.width("100%")],menuItem:[{backgroundColor:"inherit"},t9.gU.listItem,g.l0.px(8),g.l0.py(6),g.l0.borderRadius(0),g.l0.colWithGap(8),g.l0.align.start],inputDisabled:[{opacity:.75}],padded:[g.l0.p(8)],virtualItem:[g.l0.position.absolute,g.l0.top(0),g.l0.left(0),g.l0.width("100%"),g.l0.overflow("hidden")],virtualList:[g.l0.position.relative],divider:[g.l0.mt(8),g.l0.mb(8),g.l0.ml(0),g.l0.mr(0)],errorText:[g.l0.color.accentNegativeStronger,g.l0.mt(4)],createBranchButton:[g.l0.height(32),g.l0.overflow("hidden"),{whiteSpace:"nowrap",textOverflow:"ellipsis"}]}),nU=function(e,t){var n,r,i,o=t4(),l=(0,y.Z)().git,c=(0,a._)((0,w.useState)(!0),2),s=c[0],u=c[1],d=(0,tl.Z)((n=(0,to._)(function(e){var t,n,r,i,a,l,c,s,d,f,h,p,m,v,g,y,b,Z,w,x,C;return(0,ta.Jh)(this,function(_){switch(_.label){case 0:return u(!0),[4,e.isInitialized()];case 1:if((t=_.sent()).error)return o(t.error),u(!1),[2,t];if(!t.initialized)return u(!1),[2,{active:[],stale:[],important:[],error:null}];return[4,e.listBranches()];case 2:if((n=_.sent()).error)return o(n.error),u(!1),[2,n];return[4,e.findDefaultBranches()];case 3:if((r=_.sent()).error)return o(r.error),u(!1),[2,r];i=n.branches,a=new Set,l=!0,c=!1,s=void 0;try{for(d=function(){var e=h.value,t=i.find(function(t){return(0,nr.Pi)(t,e)});t&&a.add(t)},f=r.refs[Symbol.iterator]();!(l=(h=f.next()).done);l=!0)d()}catch(e){c=!0,s=e}finally{try{l||null==f.return||f.return()}finally{if(c)throw s}}p=Date.now()-72e6,m=[],v=[],g=!0,y=!1,b=void 0;try{for(Z=i[Symbol.iterator]();!(g=(w=Z.next()).done);g=!0)x=w.value,a.has(x)||(x.commit.author.date>p?m.push(x):v.push(x))}catch(e){y=!0,b=e}finally{try{g||null==Z.return||Z.return()}finally{if(y)throw b}}return C=Array.from(a),u(!1),[2,{active:m,stale:v,important:C,error:null}]}})}),function(e){return n.apply(this,arguments)}),[o]),f=(r=(0,to._)(function(t){var n;return(0,ta.Jh)(this,function(r){switch(r.label){case 0:if(s||(0,nr.Pi)(e,t))return[2];return u(!0),[4,l.switchBranch(t)];case 1:return(n=r.sent()).error?(o(n.error),u(!1)):(l.forceRefresh(),ny("branch-switched")),[2]}})}),function(e){return r.apply(this,arguments)}),h=(i=(0,to._)(function(e){var t;return(0,ta.Jh)(this,function(n){switch(n.label){case 0:if(s||""===e)return[2];return u(!0),[4,l.createBranch({name:e,checkout:!0})];case 1:return(t=n.sent()).error?(o(t.error),u(!1)):(l.forceRefresh(),ny("branch-created")),[2]}})}),function(e){return i.apply(this,arguments)});if((0,w.useEffect)(function(){null!==e&&(u(!1),t({mode:vZ.CURRENT_BRANCH}))},[e,t]),null===d||s)return{loading:s,active:[],stale:[],important:[],handleSwitchBranch:f,handleCreateBranch:h,error:null};if(d.error)return{loading:s,active:[],stale:[],important:[],handleSwitchBranch:f,handleCreateBranch:h,error:d.error};var p=d.active,m=d.stale,v=d.important;return{loading:s,active:null!=p?p:[],stale:null!=m?m:[],important:null!=v?v:[],handleSwitchBranch:f,handleCreateBranch:h,error:null}},nO=function(e){var t=e.branch,n=nU(t,e.switchMode),r=n.loading,i=n.active,o=n.important,l=n.stale,s=n.handleSwitchBranch,u=n.handleCreateBranch,d=(0,a._)((0,w.useState)(!1),2),f=d[0],h=d[1],p=(0,a._)((0,w.useState)(""),2),m=p[0],v=p[1],g=(0,a._)((0,w.useState)(!1),2),y=g[0],b=g[1];return(0,c.tZ)(nj,{isOpen:f,setIsOpen:h,important:o,active:i,stale:l,current:t,query:m,setQuery:v,onSwitchBranch:s,createBranchLoading:y,createBranch:(0,to._)(function(){return(0,ta.Jh)(this,function(e){switch(e.label){case 0:return b(!0),[4,u(m)];case 1:return e.sent(),v(""),b(!1),[2]}})}),loading:r})},nL=function(e){var t=e.onClick,n=e.children,r=(0,w.useRef)(null),i=(0,a._)((0,nA.XZ)(r,!1),4),o=i[0],l=i[1],s=i[2],u=i[3];return(0,nA.Ym)(l,r),(0,c.tZ)(nP,{ref:r,role:"menuitem",css:nN.menuItem,onClick:function(e){u(),t(e)},onKeyDown:s,tabIndex:o,children:n})},nM=function(e){var t=e.branch;return(0,c.BX)(R.G,{css:nN.branchMetadata,children:[(0,c.tZ)(np,{name:t.commit.author.name,email:t.commit.author.email,color:"dimmest",allowPlaceholderAvatar:!0,placement:"top",showTooltip:!1}),(0,c.tZ)(h.xv,{color:"dimmer",variant:"small",children:(0,nt.lb)(t.commit.author.date)})]})},nX=function(e){var t=e.branch,n=e.current,r=e.onSwitchBranch,i=(0,w.useMemo)(function(){return(0,tJ.p3)(t,n)},[t,n]);return(0,c.BX)(nL,{onClick:function(){return r(t)},children:[(0,c.tZ)(h.xv,{multiline:!1,variant:"small",children:(0,c.tZ)(nD,{name:t.name,remote:t.type===tJ.HO.REMOTE?t.remote:null,current:i,icon:!0})}),(0,c.tZ)(nM,{branch:t})]})},nF=function(e,t){return t.filter(function(t){return(0,nr.Qj)(t).toLowerCase().includes(e.toLowerCase())})},nW=function(e,t,n){var r=0,i=[];if(e.length+t.length+n.length===0)return i;if(e.length>0){i.push({key:"heading-important-".concat(r++),type:"heading",title:"Important"});for(var o=0;o<e.length;++o)i.push({key:"branch-important-".concat(r++),type:"branch",branch:e[o]});t.length+n.length>0&&i.push({key:"divider-important-".concat(r++),type:"divider"})}if(t.length>0){i.push({key:"heading-active-".concat(r++),type:"heading",title:"Active"});for(var a=0;a<t.length;++a)i.push({key:"branch-active-".concat(r++),type:"branch",branch:t[a]});n.length>0&&i.push({key:"divider-active-".concat(r++),type:"divider"})}if(n.length>0){i.push({key:"heading-stale-".concat(r++),type:"heading",title:"Stale"});for(var l=0;l<n.length;++l)i.push({key:"branch-stale-".concat(r++),type:"branch",branch:n[l]})}return i},nH=function(e){var t=e.item,n=e.current,r=e.onSwitchBranch;return"heading"===t.type?(0,c.tZ)(R.G,{css:nN.paddedX,children:(0,c.tZ)(h.xv,{multiline:!1,children:t.title})}):"divider"===t.type?(0,c.tZ)(R.G,{css:nN.divider,children:(0,c.tZ)(t6.R,{})}):(0,c.tZ)(R.G,{children:(0,c.tZ)(nX,{branch:t.branch,current:n,onSwitchBranch:r})})},nV=function(e){var t=e.items,n=e.current,r=e.onSwitchBranch,i=(0,w.useRef)(null),o=(0,t5.MG)({overscan:10,count:t.length,getScrollElement:function(){return i.current},estimateSize:function(e){var n,r;return null!==(n=void 0===(r=t[e])?0:"heading"===r.type?30:"branch"===r.type?65:"divider"===r.type?20:void 0)&&void 0!==n?n:0}});return(0,c.tZ)(nA.uP,{options:{direction:"vertical"},children:(0,c.tZ)("div",{css:nN.body,ref:i,children:(0,c.tZ)("ul",{css:nN.virtualList,style:{height:"".concat(o.getTotalSize(),"px")},children:o.getVirtualItems().map(function(e){return(0,c.tZ)("div",{css:nN.virtualItem,style:{transform:"translateY(".concat(e.start,"px)")},"data-index":e.index,ref:o.measureElement,children:(0,c.tZ)(nH,{item:t[e.index],current:n,onSwitchBranch:r})},e.key)})})})})},nz=function(e){var t=e.query,n=e.setQuery,r=e.filteredImportant,i=e.filteredActive,o=e.filteredStale,a=e.current,s=e.onSwitchBranch,u=e.createBranchLoading,d=e.createBranch,f=e.loading,p=(0,w.useMemo)(function(){return nW(r,i,o)},[r,i,o]),m='Create Branch "'.concat(t,'"'),g=(0,w.useMemo)(function(){return(0,l._)(r).concat((0,l._)(i),(0,l._)(o)).some(function(e){return e.name===t})},[t,r,i,o]);return(0,c.tZ)(R.G,{css:nN.menu,children:(0,c.tZ)("form",{onSubmit:function(e){e.preventDefault(),d()},css:nN.form,children:f?(0,c.tZ)(R.G,{css:nN.loadingContainer,children:(0,c.tZ)(v.Z,{})}):(0,c.BX)(c.HY,{children:[(0,c.tZ)(R.G,{css:nN.searchContainer,children:(0,c.tZ)(ne.E,{value:t,onChange:function(e){n(e.target.value)},onClear:function(){n("")},loading:!1,placeholder:"Find or create a branch..."})}),(0,c.tZ)(R.G,{css:nN.paddedX,children:(0,c.tZ)(t6.R,{})}),p.length>0?(0,c.tZ)(nV,{items:p,current:a,onSwitchBranch:s}):null,g||""===t?null:(0,c.BX)(R.G,{css:nN.padded,children:[(0,c.tZ)(L.zx,{text:m,size:"small",iconLeft:u?(0,c.tZ)(v.Z,{}):(0,c.tZ)(nn.Z,{}),stretch:!0,css:nN.createBranchButton,disabled:u||!(0,nr.Dc)(t),type:"submit"}),(0,nr.Dc)(t)?null:(0,c.tZ)(h.xv,{variant:"small",css:nN.errorText,multiline:!1,children:"Invalid branch name"})]})]})})})},nj=function(e){var t=e.isOpen,n=e.setIsOpen,r=e.important,i=e.active,o=e.stale,a=e.current,l=e.query,s=e.setQuery,u=e.onSwitchBranch,d=e.createBranchLoading,f=e.createBranch,p=e.loading,m=(0,w.useMemo)(function(){return nF(l,r)},[l,r]),v=(0,w.useMemo)(function(){return nF(l,i)},[l,i]),g=(0,w.useMemo)(function(){return nF(l,o)},[l,o]);return(0,c.BX)(t7.xo,{label:"View Branches",placement:"bottom",isOpen:t,onOpenChange:function(e){n(e)},offset:16,children:[function(e){var n=e.onClick,r=(0,eB._)(e,["onClick"]);return(0,c.tZ)(L.zx,{variant:"nofill",text:(0,c.BX)(h.xv,(0,P._)((0,A._)({multiline:!1,variant:"small",css:nN.selector},r),{children:[(0,c.tZ)(nD,{name:a.name,remote:a.type===tJ.HO.REMOTE?a.remote:null,current:!0,icon:!0}),t?(0,c.tZ)(eJ.Z,{}):(0,c.tZ)(e$.Z,{})]})),size:"small",stretch:!0,alignment:"start",css:nN.fullWidth,onClick:n})},(0,c.tZ)(nz,{query:l,setQuery:s,filteredImportant:m,filteredActive:v,filteredStale:g,current:a,onSwitchBranch:u,createBranchLoading:d,createBranch:f,loading:p})]})},nq=n(4995),nY=n(66663),n$=n(58003),nJ=n(73722);function nK(){var e,t,n,r,i,o=(0,a._)((0,w.useState)(!1),2),l=o[0],s=o[1],u=(0,y.Z)().git,f=(t=(e=(0,a._)((0,w.useState)(!1),2))[0],n=e[1],r=(0,y.Z)().git,(0,w.useEffect)(function(){return r.onBusyChange(n)},[r]),t),h=t4(),p=(0,tl.Z)((i=(0,to._)(function(e){var t,n;return(0,ta.Jh)(this,function(r){switch(r.label){case 0:return[4,e.isInitialized()];case 1:if((t=r.sent()).error)return h(t.error),[2,t];if(!t.initialized)return[2,{hasRemotes:!1,error:null}];return[4,e.getRemotes()];case 2:if((n=r.sent()).error)return h(n.error),[2,n];return[2,{hasRemotes:n.remotes.size>0,error:null}]}})}),function(e){return i.apply(this,arguments)}),[h]);if(null==p?void 0:p.error)return null;var m=!!p&&p.hasRemotes,g=f||l||null===p;function b(){return(b=(0,to._)(function(){var e;return(0,ta.Jh)(this,function(t){switch(t.label){case 0:if(u.isBusy()||g)return[2];if(s(!0),!m)return[3,2];return[4,u.fetch()];case 1:(e=t.sent()).error?h(e.error):ny("remote-fetched"),t.label=2;case 2:return[4,u.refreshProfiles()];case 3:return t.sent(),u.forceRefresh(),setTimeout(function(){return s(!1)},500),[2]}})})).apply(this,arguments)}return(0,c.tZ)(d.hU,{alt:m?"Refresh and Fetch":"Refresh",size:24,onClick:function(){return b.apply(this,arguments)},disabled:g,children:g?(0,c.tZ)(v.Z,{}):(0,c.tZ)(nJ.Z,{})})}var nQ=(0,p.X)({container:[g.l0.height(36),g.l0.px(8),g.l0.py(4),g.l0.rowWithGap(8),g.l0.backgroundColor.backgroundDefault,g.l0.align.center,g.l0.justify.spaceBetween,g.l0.zIndex(1),{borderBottom:"1px solid ".concat(g.TV.outlineDimmer)}],left:[g.l0.rowWithGap(4),g.l0.align.center,g.l0.flex.growAndShrink(1)],right:[g.l0.rowWithGap(8),g.l0.align.center],back:{marginLeft:-4}}),n0=function(e){var t=e.openSettings;return(0,c.BX)(R.G,{css:nQ.container,children:[(0,c.BX)(R.G,{css:nQ.left,children:[(0,c.tZ)(nY.Z,{size:16}),(0,c.tZ)(h.xv,{variant:"subheadDefault",multiline:!1,children:"Repository"})]}),(0,c.BX)(R.G,{css:nQ.right,children:[(0,c.tZ)(n6,{openSettings:t}),(0,c.tZ)(nK,{})]})]})},n1=function(e){var t=e.branch,n=e.switchMode,r=e.openSettings;return(0,c.BX)(R.G,{css:nQ.container,children:[(0,c.tZ)(R.G,{css:nQ.left,children:(0,c.tZ)(nO,{branch:t,switchMode:n})}),(0,c.BX)(R.G,{css:nQ.right,children:[(0,c.tZ)(n6,{openSettings:r}),(0,c.tZ)(nK,{})]})]})},n2=function(e){var t=e.onBack;return(0,c.BX)(R.G,{css:nQ.container,children:[(0,c.BX)(R.G,{css:nQ.left,children:[(0,c.tZ)(n3,{onBack:t,alt:"Back"}),(0,c.tZ)(h.xv,{variant:"subheadDefault",multiline:!1,children:"Settings"})]}),(0,c.tZ)(R.G,{css:nQ.right})]})},n8=function(e){var t=e.switchMode,n=e.openSettings;return(0,c.BX)(R.G,{css:nQ.container,children:[(0,c.BX)(R.G,{css:nQ.left,children:[(0,c.tZ)(n5,{switchMode:t}),(0,c.tZ)(h.xv,{variant:"subheadDefault",multiline:!1,children:"Commit"})]}),(0,c.BX)(R.G,{css:nQ.right,children:[(0,c.tZ)(n6,{openSettings:n}),(0,c.tZ)(nK,{})]})]})};function n4(e){var t=e.mode,n=e.branch,r=e.switchMode,i=e.onBack,o=function(){return r({mode:vZ.SETTINGS})};switch(t){case vZ.DASHBOARD:return(0,c.tZ)(n0,{openSettings:o});case vZ.BRANCH:case vZ.CURRENT_BRANCH:if(null===n)throw Error("Tried to show branch in header, but branch is null");return(0,c.tZ)(n1,{branch:n,switchMode:r,openSettings:o});case vZ.SETTINGS:return(0,c.tZ)(n2,{onBack:i});case vZ.COMMIT:return(0,c.tZ)(n8,{switchMode:r,openSettings:o});default:return(0,c.BX)(R.G,{css:nQ.container,children:[(0,c.tZ)(R.G,{css:nQ.left}),(0,c.tZ)(R.G,{css:nQ.right})]})}}function n3(e){var t=e.onBack,n=e.alt;return(0,c.tZ)(d.hU,{css:nQ.back,alt:n,size:28,onClick:t,children:(0,c.tZ)(nq.Z,{})})}function n5(e){var t=e.switchMode;return(0,c.tZ)(n3,{css:nQ.back,onBack:function(){return t({mode:vZ.CURRENT_BRANCH})},alt:"Back to current branch"})}function n6(e){var t=e.openSettings;return(0,c.tZ)(d.hU,{alt:"Settings",size:24,onClick:t,children:(0,c.tZ)(n$.Z,{})})}var n9=n(20573),n7=n(58719),re=n(75813),rt=n(89106),rn=n(85340),rr=n(32377),ri=n(4391);function ro(){var e,t=(0,tl.Z)((e=(0,to._)(function(e){return(0,ta.Jh)(this,function(t){return[2,{connectedToGithub:ra(e),error:null}]})}),function(t){return e.apply(this,arguments)}));return null==t||t.error?null:t.connectedToGithub}function ra(e){return e.hasProfile(re.rG.GITHUB)}function rl(e){var t=e.label,n=e.allowReconnect,r=e.callback,i=(0,a._)((0,w.useState)(!1),2),o=i[0],l=i[1],s=(0,y.Z)().git,u=ro(),d=(0,tx.Z)(),f=(0,rn.v)({onAuth:function(){ny("github-user-connected"),l(!1),s.refreshProfiles({preferredProvider:re.rG.GITHUB}),null==r||r()},onClose:function(){return l(!1)}});return u&&!(void 0!==n&&n)?(0,c.tZ)(L.zx,{text:"Connected to GitHub",colorway:"primary",iconLeft:(0,c.tZ)(rr.Z,{}),disabled:!0}):(0,c.tZ)(L.zx,{text:o||null===u?"Connecting...":d?"Visit account page to connect to GitHub":void 0===t?"Connect to GitHub":t,colorway:"primary",iconLeft:o?(0,c.tZ)(v.Z,{}):(0,c.tZ)(ri.Z,{}),loading:o,onClick:function(){if(d){rt.X.openExternalUrl("/account#connected-services");return}l(!0),f()}})}var rc=n(50431),rs=n(95597);function ru(e){return!!e&&("string"==typeof e?e.includes(rs.Kd):e.fetch.includes(rs.Kd))}function rd(e){return e.endsWith(".git")?e.slice(0,-4):e}function rf(e){if(!e)return null;var t="string"==typeof e?e:e.fetch;return ru(t)?rd(t):null}var rh=(0,p.X)({body:[g.l0.p(4),g.l0.colWithGap(8),g.l0.borderRadius(0,0,8,8)],remedies:[g.l0.rowWithGap(8),g.l0.align.center,g.l0.justify.end]});function rp(e){var t=e.description,n=e.remedies,r=e.error;return(0,c.BX)(M.Tg,{css:rh.body,elevated:!0,children:[(0,c.tZ)(h.xv,{children:t}),(0,c.BX)(R.G,{css:rh.remedies,children:[n,(0,c.tZ)(L.zx,{text:"Dismiss",iconLeft:(0,c.tZ)(n7.Z,{}),onClick:r.dismiss})]})]})}function rm(e){var t,n=e.error,r=(0,tl.Z)((t=(0,to._)(function(e){var t,r,i,o,a,l,s,u,d,f;return(0,ta.Jh)(this,function(h){switch(h.label){case 0:switch(n.type){case re.aq.UNKNOWN_NOT_GIT:return[3,1];case re.aq.UNKNOWN:return[3,2];case re.aq.CHANNEL_CLOSED:return[3,3];case re.aq.NOT_INITIALIZED:return[3,4];case re.aq.UNAUTHENTICATED:return[3,5];case re.aq.INDEX_FILE_CORRUPT:return[3,7];case re.aq.UNKNOWN_REMOTE:return[3,8];case re.aq.INDEX_LOCKED:return[3,9];case re.aq.NO_COMMITS:return[3,10];case re.aq.PATH_MATCHED_NO_FILES:return[3,11];case re.aq.USER_NOT_CONFIGURED:return[3,12];case re.aq.INVALID_REFERENCE:return[3,13];case re.aq.BRANCH_ALREADY_EXISTS:return[3,14];case re.aq.MERGE_CONFLICT:return[3,15];case re.aq.UPSTREAM_NOT_SET:return[3,16];case re.aq.HEAD_DETACHED:return[3,17];case re.aq.DIRTY_WORKTREE:return[3,18];case re.aq.PROTECTED_BRANCH:return[3,19];case re.aq.PUSH_REJECTED:return[3,20];case re.aq.REMOTE_ALREADY_EXISTS:return[3,21];case re.aq.TIMEOUT:return[3,22];case re.aq.ALREADY_INITIALIZED:return[3,23]}return[3,24];case 1:return t="Unknown error from the Git service. This is probably a bug in the app.",r=null,[3,25];case 2:return t="There was an unrecognized fatal error with Git. This is probably a bug in the app.",r=null,[3,25];case 3:return t="The command was interrupted. Please try again.",r=null,[3,25];case 4:return t="There isn't a Git repository in the Repl's root directory.",r=null,[3,25];case 5:return[4,e.getRemotes()];case 6:if((i=h.sent()).error)return[2,i];if(0!==i.remotes.size){o=!1,a=!0,l=!1,s=void 0;try{for(u=i.remotes.values()[Symbol.iterator]();!(a=(d=u.next()).done);a=!0)if(f=d.value,ru(f)){o=!0;break}}catch(e){l=!0,s=e}finally{try{a||null==u.return||u.return()}finally{if(l)throw s}}if(o){if(ra(e))return t="Failed to authenticate with the remote. Please ensure that Replit has access to this repository on GitHub.",r=(0,c.tZ)(rl,{label:"Update GitHub Repository Access",callback:n.dismiss,allowReconnect:!0}),[3,25];return t="Failed to authenticate with the remote. You have not connected your Replit account to GitHub, so Replit may not have access to the remote repository. Please connect your account to GitHub and try again.",r=(0,c.tZ)(rl,{label:"Connect to GitHub",callback:n.dismiss,allowReconnect:!0}),[3,25]}}return t="Failed to authenticate with the remote.",r=null,[3,25];case 7:return t="The Git index file is corrupt. This can happen if the index file is manually edited, or if the Git repository is corrupted.",r=null,[3,25];case 8:return t="The remote specified isn't configured.",r=null,[3,25];case 9:return t="Git tried to perform an action but the index lockfile still exists. This means Git either crashed previously or is still running an action.",r=null,[3,25];case 10:return t="There are no commits in the repository.",r=null,[3,25];case 11:return t="The path specified didn't match any files.",r=null,[3,25];case 12:return t="There isn't any user information configured for Git.",r=null,[3,25];case 13:return t="An unknown/invalid reference was specified. This is usually a branch, but it could be something else, such as a tag.",r=null,[3,25];case 14:return t="The branch specified already exists.",r=null,[3,25];case 15:return t="There was an unexpected merge conflict.",r=null,[3,25];case 16:return t="The upstream branch isn't set.",r=null,[3,25];case 17:return t="The HEAD is detached. You have a commit checked out, not a branch.",r=null,[3,25];case 18:return t="There are uncommitted changes.",r=null,[3,25];case 19:return t="This operation cannot be performed on a protected branch.",r=null,[3,25];case 20:return t="The push was rejected by the remote. This is usually because the remote has commits that aren't in the local repository.",r=null,[3,25];case 21:return t="The remote specified already exists.",r=null,[3,25];case 22:return t="The remote operation timed out.",r=null,[3,25];case 23:return t="There is already a Git repository in the Repl's root directory.",r=null,[3,25];case 24:return t="We ran into an unknown error that we don't have a description for. This is probably a bug with the app.",r=null,[3,25];case 25:return[2,{description:t,remedies:r,error:null}]}})}),function(e){return t.apply(this,arguments)}),[n],{refresh:!1});if(!r)return(0,c.tZ)(rp,{description:null,remedies:null,error:n});if(r.error)return(0,c.tZ)(rp,{description:"Unknown error from the Git service. This is probably a bug in the app.",remedies:null,error:n});var i=r.description,o=r.remedies;return(0,c.tZ)(rp,{description:i,remedies:o,error:n})}var rv=(0,p.X)({errorNotification:[{pointerEvents:"all"},g.l0.p(1),g.l0.backgroundColor.accentNegativeDimmer,g.l0.borderRadius(8),g.l0.shadow(3)],header:[g.l0.py(4),g.l0.px(8),g.l0.display.flex,g.l0.flex.row,g.l0.align.center,g.l0.justify.spaceBetween,g.l0.color.accentNegativeStrongest],headerText:[g.l0.rowWithGap(4),g.l0.align.center],errorType:[g.l0.font.code,{opacity:.75}],body:[g.l0.pt(4),g.l0.pb(8),g.l0.px(8),g.l0.colWithGap(8),g.l0.backgroundColor.backgroundHigher,g.l0.borderRadius(0,0,8,8)]});function rg(e){var t=e.error;return(0,c.BX)(R.G,{css:rv.errorNotification,children:[(0,c.BX)(R.G,{css:rv.header,children:[(0,c.BX)(R.G,{css:rv.headerText,children:[(0,c.tZ)(n9.Z,{}),(0,c.tZ)(h.xv,{variant:"subheadDefault",multiline:!1,children:function(e){switch(e.type){case re.aq.UNKNOWN_NOT_GIT:return"Unknown Error";case re.aq.UNKNOWN:return"Unknown Git Error";case re.aq.NOT_INITIALIZED:case re.aq.UNAUTHENTICATED:case re.aq.INDEX_FILE_CORRUPT:case re.aq.UNKNOWN_REMOTE:case re.aq.INDEX_LOCKED:case re.aq.NO_COMMITS:case re.aq.PATH_MATCHED_NO_FILES:case re.aq.USER_NOT_CONFIGURED:case re.aq.INVALID_REFERENCE:case re.aq.BRANCH_ALREADY_EXISTS:case re.aq.MERGE_CONFLICT:case re.aq.HEAD_DETACHED:case re.aq.DIRTY_WORKTREE:case re.aq.PUSH_REJECTED:case re.aq.PROTECTED_BRANCH:case re.aq.REMOTE_ALREADY_EXISTS:case re.aq.ALREADY_INITIALIZED:case re.aq.TIMEOUT:return"Git Error";default:return"Unknown Error"}}(t)})]}),(0,c.tZ)(h.xv,{css:rv.errorType,multiline:!1,children:t.type})]}),(0,c.tZ)(R.G,{css:rv.body,children:(0,c.tZ)(rm,{error:t})})]})}var ry=(0,p.X)({errorList:[{pointerEvents:"none"},{transition:"background-color 100ms"},g.l0.position.absolute,g.l0.top(0),g.l0.bottom(0),g.l0.left(0),g.l0.right(0),g.l0.p(8),g.l0.colWithGap(16),g.l0.zIndex(10)]});function rb(){var e=(0,tK.Dv)(t8,{store:t1()});return(0,c.tZ)(R.G,{style:{backgroundColor:e.length>0?"rgba(0, 0, 0, 0.25)":"transparent"},css:ry.errorList,children:e.map(function(e){return(0,c.tZ)(rg,{error:e},e.id)})})}function rZ(){return(0,c.BX)(R.G,{children:[(0,c.tZ)(h.xv,{multiline:!1,children:"Unsupported state: you are applying a mailbox patch."}),(0,c.tZ)(h.xv,{multiline:!1,children:"Please finish the patch manually."})]})}function rw(){return(0,c.BX)(R.G,{children:[(0,c.tZ)(h.xv,{multiline:!1,children:"Unsupported state: you are in the middle of a bisect."}),(0,c.tZ)(h.xv,{multiline:!1,children:"Please finish the bisect manually."})]})}var rx=n(49344),rC=n(37951),r_=n(59811),rS=(0,p.X)({modalContainer:[g.l0.colWithGap(24)],statusText:[g.l0.display.flex,g.l0.flex.row,g.l0.textAlign.left],settingsButton:[g.l0.reset.button,g.l0.linkStyle,g.l0.fontWeight.medium,g.l0.textAlign.left,g.l0.ml(4)]}),rE=function(e){var t=e.onViewSettingsClick;return(0,c.tZ)("button",{css:rS.settingsButton,onClick:t,children:"Settings view."})};function rk(e){var t,n,r=e.branch,i=e.onViewSettingsClick,o=(0,a._)((0,w.useState)(!1),2),l=o[0],s=o[1],u=(0,a._)((0,w.useState)(!1),2),d=u[0],f=u[1],p=(0,a._)((0,w.useState)(null),2),m=p[0],g=p[1],b=(0,a._)((0,w.useState)(!1),2),Z=b[0],x=b[1],C=t4(),_=(0,y.Z)().git,S=(0,tl.Z)((t=(0,to._)(function(e){var t,n,r,i,o,a,l,c;return(0,ta.Jh)(this,function(s){switch(s.label){case 0:return[4,e.isInitialized()];case 1:if((t=s.sent()).error)return C(t.error),ts({context:"publish-branch-button-initialized",gitService:e,result:t}),[2,{remote:null,error:t.error}];if(!t.initialized)return[2,{remote:null,error:null}];return[4,e.getRemotes()];case 2:if((n=s.sent()).error)return ts({context:"publish-branch-button-get-remotes",gitService:e,result:n}),C(n.error),[2,n];return r=n.remotes,i="",(null==r?void 0:r.size)&&(i=r.has("origin")?"origin":r.keys().next().value),[4,e.status()];case 3:if((o=s.sent()).error)return C(o.error),ts({context:"publish-branch-button-status",gitService:e,result:o}),[2,o];if(!(o.branch&&i))return[3,5];return a=(0,rc.C)(o.branch),l="refs/remotes/".concat(i,"/").concat(a),[4,e.branchExists(l)];case 4:(c=s.sent()).error?(ts({context:"publish-branch-button-branch-exists",gitService:e,result:c,data:{upstream:a,fullRemoteRef:l}}),C(c.error)):c.exists&&g("".concat(i,"/").concat(a)),s.label=5;case 5:return[2,{remote:i,error:null}]}})}),function(e){return t.apply(this,arguments)}),[C],{keepStaleResult:!1});if((0,w.useEffect)(function(){function e(){return(e=(0,to._)(function(){var e;return(0,ta.Jh)(this,function(t){switch(t.label){case 0:if(!(Z&&m))return[3,2];return[4,_.setBranchUpstream({upstream:m})];case 1:(e=t.sent()).error&&(ts({context:"publish-branch-button-set-branch-upstream",gitService:_,result:e,data:{upstream:m}}),C(e.error)),x(!1),g(null),t.label=2;case 2:return[2]}})})).apply(this,arguments)}!function(){e.apply(this,arguments)}()},[_,C,Z,m]),null==S?void 0:S.error)return null;var E=S?S.remote:null,k=null===E,T=r.type!==tJ.HO.LOCAL||!E||Z;function D(){return(D=(0,to._)(function(){var e;return(0,ta.Jh)(this,function(t){switch(t.label){case 0:if(!E||l)return[2];if(m)return f(!0),[2];return s(!0),[4,_.push({publish:{remote:E}})];case 1:return(e=t.sent()).error?(s(!1),C(e.error),ts({context:"publish-branch-button-push",gitService:_,result:e,data:{remote:E}})):(_.forceRefresh(),ny("branch-published-to-remote")),[2]}})})).apply(this,arguments)}var I="".concat(E,"/").concat(r.name);return n=l?"Pushing to '".concat(I,"'..."):r.type!==tJ.HO.LOCAL?"Branch has already been pushed to '".concat(I,"'"):k?"Checking if branch ".concat(r.name," can be pushed..."):E?"Push branch as '".concat(I,"'"):"No remotes to push to",(0,c.BX)(c.HY,{children:[m?(0,c.tZ)(rx.u,{isOpen:d,onRequestClose:function(){return f(!1)},children:(0,c.BX)(R.G,{css:rS.modalContainer,children:[(0,c.tZ)(h.xv,{variant:"headerDefault",children:"Branch already exists"}),(0,c.tZ)(h.xv,{children:"Upstream branch '".concat(m,"' already exists.\n          To push the branch, please confirm you would like to set upstream branch to it.")}),(0,c.tZ)(L.zx,{text:"Set upstream to '".concat(m,"'"),onClick:function(){m&&(x(!0),f(!1))}})]})}):null,k||E?null:(0,c.tZ)(rC.E,{text:(0,c.tZ)(R.G,{css:rS.statusText,children:(0,c.BX)("span",{children:["No remote repositories configured. To push your changes, add a remote repository in the",(0,c.tZ)(rE,{onViewSettingsClick:i})]})}),colorway:"warning",closable:!1}),(0,c.tZ)(L.zx,{text:n,iconLeft:k||l?(0,c.tZ)(v.Z,{}):(0,c.tZ)(r_.Z,{}),onClick:function(){return D.apply(this,arguments)},loading:k||l,disabled:T})]})}var rT=n(70002),rR=n(44620),rD=(0,p.X)({remoteUrl:[{border:"none"},g.l0.height("auto"),g.l0.py(4),g.l0.px(8)]});function rI(e){var t=e.branch,n=e.remotes,r=(0,a._)((0,w.useMemo)(function(){if(t.type===tJ.HO.LOCAL)return[null,null,null];var e=n.get(t.remote);if(!e)return[null,null,null];var r=rf(e),i=function(e){var t="string"==typeof e?e:e.fetch;if(ru(t)){var n=(t=rd(t)).split("/");if(n.length<2)return null;var r=n[n.length-2],i=n[n.length-1];return"".concat(r,"/").concat(i)}return null}(e),o=ru(r);return[r,i,o]},[t,n]),3),i=r[0],o=r[1],l=r[2];return i&&o?(0,c.tZ)(rT.Z,{css:rD.remoteUrl,text:o,href:i,target:"_blank",iconLeft:l?(0,c.tZ)(ri.Z,{}):void 0,iconRight:(0,c.tZ)(rR.Z,{}),variant:"outlined",size:"small"}):null}var rG=n(65260),rB=n(6620),rA=(0,p.X)({warning:[g.l0.align.start],header:[g.l0.fontWeight.bold]});function rP(){return(0,c.BX)(c.HY,{children:[(0,c.tZ)(rC.E,{css:rA.warning,icon:(0,c.tZ)(n9.Z,{}),colorway:"warning",text:(0,c.BX)(c.HY,{children:[(0,c.tZ)("span",{css:rA.header,children:"Can't push or pull from GitHub"}),(0,c.tZ)("br",{}),(0,c.tZ)("span",{children:"This Repl has a GitHub repository as a remote, but you are not connected to GitHub."})]})}),(0,c.tZ)(rl,{})]})}var rN=n(2447),rU=(0,p.X)({text:[g.l0.flex.shrink(1)]});function rO(e){var t=e.date,n=(0,a._)((0,w.useState)(null),2),r=n[0],i=n[1];return((0,w.useEffect)(function(){if(t){var e=function(){var e=new Date,n="just now";e.getTime()-t.getTime()>6e4&&(n=(0,rN.Z)(t,e,{addSuffix:!0})),i(n=n.replace(/minutes?/,"min"))};e();var n=setInterval(e,6e4);return function(){clearInterval(n),i(null)}}},[t]),r)?(0,c.BX)(h.xv,{css:rU.text,color:"dimmest",variant:"small",multiline:!1,children:["last fetched ",r]}):null}var rL=n(91075);function rM(e){var t=e.hasRemoteMergeConflict,n=e.hasUnpulledCommits,r=e.hasUnpushedCommits,i=e.workTreeDirty,o=[];return i&&n&&o.push("Can't pull: you have uncommitted changes"),t&&(n||r)&&(n&&r?(i||o.push("Warning: pulling will start a merge with conflicts"),o.push("Can't push: unpulled changes must be merged first")):n?i||o.push("Warning: pulling will start a merge with conflicts"):r&&o.push("Can't push: merge conflict with remote")),(0,c.tZ)(c.HY,{children:o.map(function(e){return(0,c.tZ)(rC.E,{text:e,colorway:"warning",icon:(0,c.tZ)(n9.Z,{})},e)})})}var rX=(0,p.X)({divider:[g.l0.mx(8)]});function rF(e){var t=e.ahead,n=e.behind;if(!t&&!n)return(0,c.tZ)(h.xv,{color:"dimmest",multiline:!1,children:"Nothing to pull or push"});var r=null,i=null;if(n){var o=(0,ed.Z)("commit",n);r="".concat(n," ").concat(o," to pull")}if(t){var a=(0,ed.Z)("commit",t);i="".concat(t," ").concat(a," to push")}return(0,c.BX)(h.xv,{color:"dimmer",variant:"small",multiline:!1,children:[r?(0,c.tZ)("span",{children:r}):null,r&&i?(0,c.tZ)("span",{css:rX.divider,children:""}):null,i?(0,c.tZ)("span",{children:i}):null]})}var rW=(0,p.X)({container:[g.l0.flex.grow(1)],branch:[g.l0.mr(4),g.l0.color.foregroundDefault,g.l0.fontWeight.medium,{"&:hover":{textDecoration:"underline"}}],divider:[g.l0.color.foregroundDimmest],text:[g.l0.ml(4),g.l0.color.foregroundDimmest]});function rH(e){var t=e.upstream,n=e.remotes,r=(0,w.useMemo)(function(){return function(e,t){var n=null,r=null;if(e instanceof Map){var i=(0,rc.Tg)(t),o=i[0];if(n=i[1],!o||!n)return null;var a=e.get(o);if(!a)return null;r=rf(a)}else n=t,r=rf(e);return r&&ru(r)?"".concat(r,"/tree/").concat(n):null}(n,t)},[t,n]);return(0,c.BX)(h.xv,{css:rW.container,variant:"small",multiline:!1,children:[r?(0,c.tZ)("a",{css:rW.branch,href:r,target:"_blank",children:t}):(0,c.tZ)("span",{css:rW.branch,children:t}),(0,c.tZ)("span",{css:rW.divider,children:""}),(0,c.tZ)("span",{css:rW.text,children:"upstream"})]})}var rV=(0,p.X)({container:[g.l0.borderRadius(8)],loading:[g.l0.height(64),ef.p.backgroundPulse(),g.l0.borderRadius(8)],header:[g.l0.py(4),g.l0.px(8),g.l0.rowWithGap(8),g.l0.align.center,g.l0.flex.shrink(1),g.l0.border({color:g.TV.outlineDimmer,direction:"bottom"})],fetch:{border:"none"},body:[g.l0.px(8),g.l0.pt(8),g.l0.pb(12),g.l0.colWithGap(8)],buttons:[g.l0.rowWithGap(8),g.l0.flex.grow(1)],sync:[g.l0.flex.grow(1)],pullPush:[g.l0.flex.row],pull:[g.l0.pr(12),g.l0.borderRadius(8,0,0,8),g.l0.border({color:g.TV.outlineDefault,direction:"right"})],push:[g.l0.borderRadius(0,8,8,0)]});function rz(e){return rj.apply(this,arguments)}function rj(){return(rj=(0,to._)(function(e){var t,n;return(0,ta.Jh)(this,function(r){switch(r.label){case 0:return t=null,[4,Promise.race([e,new Promise(function(e){return t=setTimeout(function(){tc.$e(function(e){e.setTag("gitPane",!0),tc.Tb(Error("Remote update operation timed out"))}),e({error:re.aq.TIMEOUT})},9e4)})])];case 1:return n=r.sent(),t&&clearTimeout(t),[2,n]}})})).apply(this,arguments)}function rq(e){var t,n=e.remotes,r=e.gotoPendingState,i=(0,a._)((0,w.useState)(!1),2),o=i[0],l=i[1],s=(0,a._)((0,w.useState)(!1),2),u=s[0],d=s[1],f=(0,a._)((0,w.useState)(!1),2),h=f[0],p=f[1],g=(0,a._)((0,w.useState)(!1),2),b=g[0],Z=g[1],x=(0,y.Z)().git,C=(0,tl.Z)((t=(0,to._)(function(e){var t,n,r,i,o,a,l,c,s,u,d,f,h,p,m,v,g,y;return(0,ta.Jh)(this,function(b){switch(b.label){case 0:return i={upstream:null,hasUnpulledCommits:!1,hasUnpushedCommits:!1,hasRemoteMergeConflict:!1,pullMode:rL.T.FF_ONLY,canPull:!1,canPush:!1,workTreeDirty:!1,needGitHubConnection:!1,ahead:0,behind:0,lastFetched:null},[4,e.getRepositoryState()];case 1:if((o=b.sent()).error)return[2,o];if(a=o.state,o.type!==t$.y5.NORMAL)return[2,{error:re.aq.INVALID_STATE}];return(a===t$.yG.DIRTY_WORKTREE||a===t$.yG.DIRTY_INDEX)&&(i.workTreeDirty=!0),[4,e.status()];case 2:if((l=b.sent()).error)return[2,l];if(c=l.branch,s=null===(t=l.upstream)||void 0===t?void 0:t.branch,d=null!==(u=null===(n=l.upstream)||void 0===n?void 0:n.ahead)&&void 0!==u?u:0,h=null!==(f=null===(r=l.upstream)||void 0===r?void 0:r.behind)&&void 0!==f?f:0,!c)return[2,{error:re.aq.HEAD_DETACHED}];if(i.ahead=d,i.behind=h,!s)return[3,7];return i.upstream=s,i.hasUnpulledCommits=h>0,i.hasUnpushedCommits=d>0,[4,e.lastFetched()];case 3:if((p=b.sent()).error)return[2,p];return i.lastFetched=p.lastFetched,[4,e.canMergeBranches(c,s)];case 4:if((m=b.sent()).error)return[2,m];if(m.canMerge||(i.hasRemoteMergeConflict=!0),e.hasProfile(re.rG.GITHUB))return[3,6];if(!(v=(0,nr.CH)(s)))return[2,{error:re.aq.INVALID_REFERENCE}];return[4,e.getRemotes()];case 5:if((g=b.sent()).error)return[2,g];if(!(y=g.remotes.get(v)))return[2,{error:re.aq.INVALID_REFERENCE}];ru(y)&&(i.needGitHubConnection=!0),b.label=6;case 6:i.workTreeDirty||i.needGitHubConnection||(i.canPull=!0),!i.hasUnpushedCommits||i.hasUnpulledCommits||i.needGitHubConnection||(i.canPush=!0),d>0&&(i.pullMode=i.hasRemoteMergeConflict?rL.T.MERGE:rL.T.REBASE),b.label=7;case 7:return[2,(0,P._)((0,A._)({},i),{error:null})]}})}),function(e){return t.apply(this,arguments)})),_=t4();if((0,w.useEffect)(function(){(null==C?void 0:C.error)&&_(C.error)},[null==C?void 0:C.error,_]),!C)return(0,c.tZ)(M.Tg,{css:rV.loading,elevated:!0});if(C.error||!C.upstream)return null;var S=C.upstream,E=C.hasUnpulledCommits,k=C.hasUnpushedCommits,T=C.hasRemoteMergeConflict,D=C.pullMode,I=C.canPull,G=C.canPush,B=C.workTreeDirty,N=C.needGitHubConnection,U=C.ahead,O=C.behind,X=C.lastFetched;if(N)return(0,c.BX)(M.Tg,{css:rV.container,elevated:!0,children:[(0,c.BX)(R.G,{css:rV.header,children:[(0,c.tZ)(rH,{upstream:S,remotes:n}),(0,c.tZ)(L.zx,{css:rV.fetch,text:"Fetch",iconLeft:(0,c.tZ)(nJ.Z,{}),disabled:!0,variant:"outlined",size:"small"})]}),(0,c.tZ)(R.G,{css:rV.body,children:(0,c.tZ)(rP,{})})]});var F=o||u||h||b,W=!S||N||F,H=!I||F,V=!G||F,z=!I&&!G||T||F;function j(){return(j=(0,to._)(function(){var e;return(0,ta.Jh)(this,function(t){switch(t.label){case 0:if(W)return[2];return l(!0),[4,rz(x.fetch())];case 1:return e=t.sent(),x.forceRefresh(),l(!1),e.error?_(e.error):ny("remote-fetched"),[2]}})})).apply(this,arguments)}function q(){return(q=(0,to._)(function(){var e;return(0,ta.Jh)(this,function(t){switch(t.label){case 0:if(H)return[2];return d(!0),[4,rz(x.pull({mode:D,allowConflicts:!0}))];case 1:return e=t.sent(),d(!1),e.error?_(e.error):(e.hasConflicts&&r(),x.forceRefresh(),ny("upstream-pulled")),[2]}})})).apply(this,arguments)}function Y(){return(Y=(0,to._)(function(){var e;return(0,ta.Jh)(this,function(t){switch(t.label){case 0:if(V)return[2];return p(!0),[4,rz(x.push())];case 1:return e=t.sent(),x.forceRefresh(),p(!1),e.error?_(e.error):ny("upstream-pushed"),[2]}})})).apply(this,arguments)}function $(){return($=(0,to._)(function(){var e,t;return(0,ta.Jh)(this,function(n){switch(n.label){case 0:if(z)return[2];if(Z(!0),!I)return[3,2];return[4,rz(x.pull({mode:D}))];case 1:if((e=n.sent()).error)return _(e.error),Z(!1),[2];ny("upstream-pulled"),n.label=2;case 2:if(!G)return[3,4];return[4,x.push()];case 3:if((t=n.sent()).error)return _(t.error),Z(!1),[2];ny("upstream-pushed"),n.label=4;case 4:return x.forceRefresh(),Z(!1),[2]}})})).apply(this,arguments)}return(0,c.BX)(M.Tg,{css:rV.container,elevated:!0,children:[(0,c.BX)(R.G,{css:rV.header,children:[(0,c.tZ)(rH,{upstream:S,remotes:n}),(0,c.tZ)(rO,{date:X}),(0,c.tZ)(L.zx,{css:rV.fetch,text:"Fetch",iconLeft:o?(0,c.tZ)(v.Z,{}):(0,c.tZ)(nJ.Z,{}),onClick:function(){return j.apply(this,arguments)},loading:o,disabled:W,variant:"outlined",size:"small"})]}),(0,c.BX)(R.G,{css:rV.body,children:[(0,c.tZ)(rM,{hasRemoteMergeConflict:T,hasUnpulledCommits:E,hasUnpushedCommits:k,workTreeDirty:B}),(0,c.tZ)(rF,{ahead:U,behind:O}),(0,c.BX)(R.G,{css:rV.buttons,children:[(0,c.tZ)("div",{css:rV.sync,children:(0,c.tZ)(tn.u,{tooltip:"Pull & push the latest changes",children:(0,c.tZ)(L.zx,{css:rV.sync,text:"Sync with Remote",iconLeft:b?(0,c.tZ)(v.Z,{}):(0,c.tZ)(rG.Z,{rotate:90}),onClick:function(){return $.apply(this,arguments)},loading:b,disabled:z,size:"small"})})}),(0,c.BX)(R.G,{css:rV.pullPush,children:[(0,c.tZ)(L.zx,{css:rV.pull,text:"Pull",iconLeft:u?(0,c.tZ)(v.Z,{}):(0,c.tZ)(m.Z,{}),onClick:function(){return q.apply(this,arguments)},loading:u,disabled:H,size:"small"}),(0,c.tZ)(L.zx,{css:rV.push,text:"Push",iconLeft:h?(0,c.tZ)(v.Z,{}):(0,c.tZ)(rB.Z,{}),onClick:function(){return Y.apply(this,arguments)},loading:h,disabled:V,size:"small"})]})]})]})]})}var rY=n(24890),r$=n(64992),rJ=(0,p.X)({path:[g.l0.rowWithGap(8),g.l0.flex.growAndShrink(1),g.l0.align.center],source:[g.l0.color.foregroundDimmest],sourceArrow:[g.l0.mx(8)]});function rK(e){var t=e.path,n=e.prefix,r=e.source,i=e.onClick;return(0,c.BX)(R.G,{css:rJ.path,children:[(0,c.tZ)(f.Z,{path:t}),(0,c.BX)(h.xv,{multiline:!1,children:[(0,c.tZ)(nI,{path:t,prefix:n,onClick:i}),r?(0,c.BX)("span",{css:rJ.source,children:[(0,c.tZ)("span",{css:rJ.sourceArrow,children:""}),(0,c.tZ)(nI,{path:r})]}):null]})]})}var rQ=(0,p.X)({container:[g.l0.colWithGap(8)],buttons:[g.l0.rowWithGap(8),g.l0.justify.end],restoringBoth:[g.l0.colWithGap(12)],listContainer:[g.l0.colWithGap(4)],list:[g.l0.px(4),g.l0.colWithGap(2)]});function r0(e){var t=e.show,n=e.files,r=e.pathMap,i=e.callback,o=(0,eV.Z)(i),a=(0,w.useCallback)(function(){var e;null===(e=o.current)||void 0===e||e.call(o,!0)},[o]),l=(0,w.useCallback)(function(){var e;null===(e=o.current)||void 0===e||e.call(o,!1)},[o]);return(0,c.tZ)(rx.u,{isOpen:t,onRequestClose:l,children:t?(0,c.BX)(R.G,{css:rQ.container,children:[(0,c.BX)(h.h4,{level:2,children:["Discard ",(0,ed.Z)("Change",n.length)]}),(0,c.tZ)(r1,{files:n,pathMap:r}),(0,c.BX)(R.G,{css:rQ.buttons,children:[(0,c.tZ)(L.zx,{text:"Cancel",iconLeft:(0,c.tZ)(rY.Z,{}),onClick:l}),(0,c.tZ)(L.zx,{text:"Discard ".concat((0,ed.Z)("Change",n.length)),iconLeft:(0,c.tZ)(r$.Z,{}),colorway:"negative",onClick:a})]})]}):null})}function r1(e){var t=e.files,n=e.pathMap,r=[],i=[],o=!0,a=!1,l=void 0;try{for(var s,u=t[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var d=s.value;d.type.worktree===eK.h.UNTRACKED?i.push(d):r.push(d)}}catch(e){a=!0,l=e}finally{try{o||null==u.return||u.return()}finally{if(a)throw l}}return!r.length&&i.length?(0,c.BX)(R.G,{css:rQ.listContainer,children:[(0,c.tZ)(h.xv,{children:1===i.length?"Do you want to permanently delete this file?":"Do you want to permanently delete these files?"}),(0,c.tZ)(r2,{files:i,pathMap:n})]}):r.length&&!i.length?(0,c.BX)(R.G,{css:rQ.listContainer,children:[(0,c.tZ)(h.xv,{children:1===r.length?"Do you want to undo the changes to this file?":"Do you want to undo the changes to these files?"}),(0,c.tZ)(r2,{files:r,pathMap:n})]}):(0,c.BX)(R.G,{css:rQ.restoringBoth,children:[r.length?(0,c.BX)(R.G,{css:rQ.listContainer,children:[(0,c.BX)(h.h4,{level:3,children:["Tracked ",(0,ed.Z)("File",r.length)]}),(0,c.tZ)(h.xv,{multiline:!1,children:1===r.length?"This file will have its changes undone.":"These files will have their changes undone."}),(0,c.tZ)(r2,{files:r,pathMap:n})]}):null,i.length?(0,c.BX)(R.G,{css:rQ.listContainer,children:[(0,c.BX)(h.h4,{level:3,children:["Untracked ",(0,ed.Z)("File",i.length)]}),(0,c.tZ)(h.xv,{multiline:!1,children:1===i.length?"This file will be permanently deleted.":"These files will be permanently deleted."}),(0,c.tZ)(r2,{files:i,pathMap:n})]}):null]})}function r2(e){var t=e.files,n=e.pathMap,r=(0,w.useMemo)(function(){return t.length>20?t.slice(0,20):t},[t]);return(0,c.tZ)(R.G,{children:(0,c.BX)("ul",{css:rQ.list,children:[r.map(function(e){var t;return(0,c.tZ)("li",{children:(0,c.tZ)(rK,{path:e.path,prefix:n.get(e.path),source:null===(t=e.source)||void 0===t?void 0:t.path})},e.path)}),t.length<=20?null:(0,c.tZ)("li",{children:(0,c.BX)(h.xv,{color:"dimmer",children:["... ",t.length-20," more"," ",(0,ed.Z)("file",t.length-20)]})})]})})}function r8(e){var t=(0,a._)((0,w.useState)(function(){return{show:!1,files:[]}}),2),n=t[0],r=t[1];return{openRestoreConfirmationModal:(0,w.useCallback)(function(e){return new Promise(function(t){0===e.length&&t(!1),r({show:!0,files:e,callback:function(e){r({show:!1,files:[],callback:void 0}),t(e)}})})},[]),restoreConfirmationModal:(0,w.useMemo)(function(){return(0,c.tZ)(r0,(0,P._)((0,A._)({},n),{pathMap:e}))},[n,e])}}var r4=n(31498),r3=(0,p.X)({actionsIndex:[g.l0.height(24),g.l0.align.center,g.l0.borderRadius(4)],actionsWorktree:[g.l0.height(24),g.l0.flex.row,g.l0.align.center,g.l0.borderRadius(4)],unstage:[g.l0.height(24),g.l0.width(24),g.l0.borderRadius(2)],stage:[g.l0.px(12),g.l0.height(24),g.l0.width(24),g.l0.borderRadius(2)],discard:[g.l0.pl(16),g.l0.pr(12),g.l0.height(24),g.l0.width(24),g.l0.borderRadius(2)],discardIcon:{transform:"scale(0.85)"},divider:[g.l0.height("75%"),g.l0.width(1),g.l0.backgroundColor.outlineStronger]});function r5(e){var t=e.file,n=e.list,r=e.stageFiles,i=e.restoreFiles,o=e.disabled,l=void 0!==o&&o,s=(0,a._)((0,w.useState)(!1),2),u=s[0],f=s[1],h=(0,a._)((0,w.useState)(!1),2),p=h[0],m=h[1];function g(){return(g=(0,to._)(function(){return(0,ta.Jh)(this,function(e){switch(e.label){case 0:if(l)return[2];return f(!0),[4,r({reset:[t.path]})];case 1:return e.sent(),f(!1),[2]}})})).apply(this,arguments)}function y(){return(y=(0,to._)(function(){return(0,ta.Jh)(this,function(e){switch(e.label){case 0:if(l)return[2];return f(!0),[4,r({add:[t.path]})];case 1:return e.sent(),f(!1),[2]}})})).apply(this,arguments)}function b(){return(b=(0,to._)(function(){return(0,ta.Jh)(this,function(e){switch(e.label){case 0:if(l||"worktree"!==n)return[2];return m(!0),[4,i(t.path)];case 1:return e.sent(),m(!1),[2]}})})).apply(this,arguments)}return l=l||p||u,"index"===n?(0,c.tZ)(M.Tg,{elevated:!0,css:r3.actionsIndex,children:(0,c.tZ)(d.hU,{css:r3.unstage,alt:"Unstage changes",size:18,tooltipDelay:"long",onClick:function(){return g.apply(this,arguments)},disabled:l,children:u?(0,c.tZ)(v.Z,{}):(0,c.tZ)(r4.Z,{})})}):(0,c.BX)(M.Tg,{elevated:!0,css:r3.actionsWorktree,children:[(0,c.tZ)(d.hU,{css:r3.discard,alt:"Discard changes",size:18,tooltipDelay:"long",onClick:function(){return b.apply(this,arguments)},disabled:l,children:p?(0,c.tZ)(v.Z,{}):(0,c.tZ)(r$.Z,{css:r3.discardIcon})}),(0,c.tZ)("div",{css:r3.divider}),(0,c.tZ)(d.hU,{css:r3.stage,alt:"Stage changes",size:18,tooltipDelay:"long",onClick:function(){return y.apply(this,arguments)},disabled:l,children:u?(0,c.tZ)(v.Z,{}):(0,c.tZ)(nn.Z,{})})]})}var r6=(0,p.X)({modifiedFile:[g.l0.py(2),g.l0.rowWithGap(4),g.l0.align.center]});function r9(e){var t,n=e.file,r=e.list,i=e.stageFiles,o=e.restoreFiles,a=e.pathMap,l=e.disabled,s=e.onFilePathClick,u=null==a?void 0:a.get(n.path),d=null===(t=n.source)||void 0===t?void 0:t.path,f="index"===r?n.type.index:n.type.worktree,h=(0,B.Z)(function(){if(f!==eK.h.DELETED)return function(){return s(n.path)}},[n.path,s,f]);return(0,c.BX)(R.G,{css:r6.modifiedFile,children:[(0,c.tZ)(rK,{path:n.path,prefix:u,source:d,onClick:h}),(0,c.tZ)(e0,{type:f}),(0,c.tZ)(r5,{file:n,list:r,stageFiles:i,restoreFiles:o,disabled:void 0!==l&&l})]})}var r7=(0,p.X)({actions:[g.l0.rowWithGap(2),g.l0.backgroundColor.backgroundHighest,g.l0.borderRadius(8)],buttonDiscard:[g.l0.borderRadius(8,0,0,8)],buttonStage:[g.l0.borderRadius(0,8,8,0)],divider:[g.l0.my(8),g.l0.width(1),g.l0.backgroundColor.outlineStronger]});function ie(e){var t=e.type,n=e.stageFiles,r=e.restoreFiles,i=e.disabled,o=void 0!==i&&i,l=(0,a._)((0,w.useState)(!1),2),s=l[0],u=l[1],d=(0,a._)((0,w.useState)(!1),2),f=d[0],h=d[1];function p(){return m.apply(this,arguments)}function m(){return(m=(0,to._)(function(){return(0,ta.Jh)(this,function(e){switch(e.label){case 0:if(o)return[2];return u(!0),[4,n({all:"index"!==t})];case 1:return e.sent(),u(!1),[2]}})})).apply(this,arguments)}function g(){return(g=(0,to._)(function(){return(0,ta.Jh)(this,function(e){switch(e.label){case 0:if(o||"worktree"!==t)return[2];return h(!0),[4,r(!0)];case 1:return e.sent(),h(!1),[2]}})})).apply(this,arguments)}return o=o||f||s,"index"===t?(0,c.tZ)(L.zx,{text:"Unstage All",iconLeft:s?(0,c.tZ)(v.Z,{}):(0,c.tZ)(r4.Z,{}),onClick:p,disabled:o,loading:s,size:"small"}):(0,c.BX)(R.G,{css:r7.actions,children:[(0,c.tZ)(L.zx,{css:r7.buttonDiscard,text:"Discard All",iconLeft:f?(0,c.tZ)(v.Z,{}):(0,c.tZ)(r$.Z,{}),onClick:function(){return g.apply(this,arguments)},disabled:o,loading:f,size:"small"}),(0,c.tZ)("div",{css:r7.divider}),(0,c.tZ)(L.zx,{css:r7.buttonStage,text:"Stage All",iconLeft:s?(0,c.tZ)(v.Z,{}):(0,c.tZ)(nn.Z,{}),onClick:p,disabled:o,loading:s,size:"small"})]})}var it=(0,p.X)({list:[g.l0.pt(4),g.l0.pb(8),g.l0.colWithGap(4)],listFolded:[g.l0.py(4)],header:[g.l0.px(8),g.l0.rowWithGap(4),g.l0.align.center],headerFoldable:[g.l0.py(4),g.l0.pl(4),g.l0.pr(8),g.l0.rowWithGap(4),g.l0.align.center],headerText:[g.l0.flex.grow(1)],body:[g.l0.px(8),g.l0.maxHeight("25vh"),g.l0.overflowY("auto")]});function ir(e){var t,n=e.files,r=e.type,i=e.stageFiles,o=e.restoreFiles,l=e.onFilePathClick,s=e.pathMap,u=e.foldable,d=void 0!==u&&u,f=e.disabled,h=void 0!==f&&f,p=(0,a._)((0,w.useState)(!1),2),m=p[0],v=p[1],g=(0,w.useRef)(null),y=(0,w.useRef)(null),b=(0,t5.MG)({count:n.length,getScrollElement:function(){return y.current},getItemKey:function(e){return n[e].path},estimateSize:function(){return 28},overscan:20}),Z=b.getVirtualItems();return d&&m?(0,c.tZ)(R.G,{css:it.listFolded,children:(0,c.BX)(R.G,{css:d?it.headerFoldable:it.header,children:[(0,c.tZ)(ii,{files:n,type:r,setFolded:v,foldable:!0,folded:!0}),(0,c.tZ)(ie,{type:r,stageFiles:i,restoreFiles:o,disabled:h})]})}):(0,c.BX)(R.G,{innerRef:g,css:it.list,children:[(0,c.BX)(R.G,{css:d?it.headerFoldable:it.header,children:[(0,c.tZ)(ii,{files:n,type:r,setFolded:v,foldable:d}),(0,c.tZ)(ie,{type:r,stageFiles:i,restoreFiles:o,disabled:h})]}),(0,c.tZ)(R.K.div,{ref:y,css:it.body,children:(0,c.tZ)("div",{style:{minHeight:b.getTotalSize()},children:(0,c.tZ)("div",{style:{transform:"translateY(".concat(null===(t=Z[0])||void 0===t?void 0:t.start,"px)"),willChange:"transform"},children:Z.map(function(e){var t=n[e.index];return(0,c.tZ)("div",{"data-index":e.index,children:(0,c.tZ)(r9,{file:t,list:r,stageFiles:i,restoreFiles:o,onFilePathClick:l,pathMap:s,disabled:h},t.path)},e.key)})})})})]})}function ii(e){var t=e.files,n=e.type,r=e.setFolded,i=e.foldable,o=void 0!==i&&i,a=e.folded,l=(0,ed.Z)("file",t.length),s="".concat(t.length," ").concat("index"===n?"staged":"changed"," ").concat(l);return o&&void 0!==a&&a?(0,c.BX)(c.HY,{children:[(0,c.tZ)(d.hU,{alt:"Show list",onClick:function(){return r(!1)},children:(0,c.tZ)(e$.Z,{})}),(0,c.tZ)(h.xv,{css:it.headerText,multiline:!1,children:s})]}):(0,c.BX)(c.HY,{children:[o?(0,c.tZ)(d.hU,{alt:"Hide list",onClick:function(){return r(!0)},children:(0,c.tZ)(eJ.Z,{color:g.TV.foregroundDimmest})}):null,(0,c.tZ)(h.xv,{css:it.headerText,color:"dimmest",multiline:!1,children:s})]})}var io=n(15592),ia=[{"& > span:first-child":[g.l0.flex.grow(1),g.l0.textAlign.left]},{"& > span":[g.l0.flex.shrink(1)]}],il=(0,p.X)({buttonFolded:[ia,g.l0.height("auto"),g.l0.py(8),g.l0.fontWeight.medium],buttonUnfolded:[ia,g.l0.height("auto"),g.l0.py(8),g.l0.fontWeight.medium,g.l0.border({color:g.TV.outlineDimmer,direction:"bottom"}),g.l0.borderRadius(8,8,0,0)],container:[g.l0.flex.grow(1),g.l0.borderRadius(8)],lists:[g.l0.borderRadius(0,0,8,8)],divider:[g.l0.height(1),g.l0.minHeight(1),g.l0.width("100%"),g.l0.backgroundColor.outlineDimmer],autoStageMessage:[g.l0.pt(4),g.l0.pb(8),g.l0.px(4),g.l0.center],noChangesMessage:[g.l0.py(16),g.l0.px(4),g.l0.center],buttonText:[g.l0.flex.grow(1)],details:[g.l0.rowWithGap(4),g.l0.fontWeight.normal,g.l0.color.foregroundDimmest]});function ic(e){var t,n,r=e.status,i=e.stageFiles,o=e.restoreFiles,l=e.onStagedFileClick,s=e.disabled,u=void 0!==s&&s,d=(0,a._)((0,w.useState)(!1),2),f=d[0],p=d[1],m=(0,a._)((0,w.useState)(!1),2),v=m[0],g=m[1],y=(0,a._)((0,w.useState)(!1),2),b=y[0],Z=y[1],x=(0,w.useMemo)(function(){return(0,io.w)(r.changes.map(function(e){return e.path}))},[r]),C=(0,a._)((0,w.useMemo)(function(){var e=[],t=[],n=!0,i=!1,o=void 0;try{for(var a,l=r.changes[Symbol.iterator]();!(n=(a=l.next()).done);n=!0){var c=a.value;c.staged&&e.push(c),c.type.worktree!==eK.h.UNMODIFIED&&t.push(c)}}catch(e){i=!0,o=e}finally{try{n||null==l.return||l.return()}finally{if(i)throw o}}return[e,t]},[r.changes]),2),_=C[0],S=C[1],E=_.length>0&&S.length>0,k=r8(x),T=k.openRestoreConfirmationModal,D=k.restoreConfirmationModal,I=(0,w.useCallback)((t=(0,to._)(function(e){return(0,ta.Jh)(this,function(t){switch(t.label){case 0:if(!("all"in e))return[3,2];return g(!0),[4,i(e)];case 1:return t.sent(),g(!1),[3,4];case 2:return[4,i(e)];case 3:t.sent(),t.label=4;case 4:return[2]}})}),function(e){return t.apply(this,arguments)}),[i]),G=(0,w.useCallback)((n=(0,to._)(function(e){var t,n;return(0,ta.Jh)(this,function(r){switch(r.label){case 0:if(!0!==e)return[3,4];return Z(!0),[4,T(S)];case 1:if(!r.sent())return[3,3];return[4,o(e)];case 2:r.sent(),r.label=3;case 3:return Z(!1),[3,8];case 4:if("string"==typeof e){if(!(n=S.find(function(t){return t.path===e})))throw Z(!1),Error("Could not find file in worktree list");t=[n]}else t=S.filter(function(t){return e.includes(t.path)});return[4,T(t)];case 5:if(!r.sent())return[3,7];return[4,o(e)];case 6:r.sent(),r.label=7;case 7:Z(!1),r.label=8;case 8:return[2]}})}),function(e){return n.apply(this,arguments)}),[T,o,S]);return f?(0,c.tZ)(is,{setFolded:p,changeCount:S.length,stagedCount:_.length,disabled:u,folded:!0}):0===_.length&&0===S.length?(0,c.BX)(R.G,{style:{opacity:u?.725:void 0},css:il.container,children:[(0,c.tZ)(is,{setFolded:p,changeCount:S.length,stagedCount:_.length,disabled:u}),(0,c.tZ)(M.Tg,{css:il.lists,elevated:!0,children:(0,c.tZ)(R.G,{css:il.noChangesMessage,children:(0,c.tZ)(h.xv,{color:"dimmest",multiline:!1,children:"No changed or staged files."})})})]}):(0,c.BX)(c.HY,{children:[(0,c.BX)(R.G,{style:{opacity:u?.725:void 0},css:il.container,children:[(0,c.tZ)(is,{setFolded:p,changeCount:S.length,stagedCount:_.length,disabled:u}),(0,c.BX)(M.Tg,{css:il.lists,elevated:!0,children:[0===_.length?null:(0,c.tZ)(ir,{type:"index",files:_,stageFiles:I,restoreFiles:G,onFilePathClick:l,pathMap:x,foldable:E,disabled:u||v||b}),E?(0,c.tZ)("div",{css:il.divider}):null,0===S.length?null:(0,c.BX)(c.HY,{children:[(0,c.tZ)(ir,{type:"worktree",files:S,stageFiles:I,restoreFiles:G,onFilePathClick:l,pathMap:x,foldable:E,disabled:u||v||b}),E?null:(0,c.tZ)(R.G,{css:il.autoStageMessage,children:(0,c.tZ)(h.xv,{variant:"small",color:"dimmest",multiline:!1,children:"Committing will automatically stage your changes."})})]})]})]}),D]})}function is(e){var t=e.folded,n=void 0!==t&&t,r=e.setFolded,i=e.changeCount,o=e.stagedCount,a=e.disabled;return(0,c.tZ)(L.zx,{css:n?il.buttonFolded:il.buttonUnfolded,text:"Review Changes",secondaryText:(0,c.tZ)(iu,{folded:n,changeCount:i,stagedCount:o}),onClick:function(){return r(!n)},iconRight:n?(0,c.tZ)(e$.Z,{}):(0,c.tZ)(eJ.Z,{}),disabled:void 0!==a&&a,size:"small"})}function iu(e){var t=e.folded,n=e.changeCount,r=e.stagedCount;if(!t)return null;var i=n>0,o=r>0;return i||o?(0,c.BX)("span",{css:il.details,children:[i?(0,c.BX)("span",{children:[n," ",(0,ed.Z)("change",n)]}):null,i&&o?(0,c.tZ)("span",{children:"/"}):null,o?(0,c.BX)("span",{children:[r," staged"]}):null]}):(0,c.tZ)("span",{css:il.details,children:(0,c.tZ)("span",{children:"no changes"})})}var id=n(43704),ih=n(62340),ip=n(93049),im=n(46868),iv=n(74652),ig=n(96003),iy={height:32,width:"100%",resize:"none",border:"none"},ib={width:"100%",resize:"none",border:"none"},iZ=(0,p.X)({surface:[g.l0.p(8),g.l0.colWithGap(12),g.l0.borderRadius(0,0,8,8)],button:[g.l0.height("auto"),g.l0.py(8),g.l0.fontWeight.medium,g.l0.borderRadius(8,8,0,0),g.l0.justify.start,g.l0.border({color:g.TV.outlineDimmer,direction:"bottom"}),{"> span:first-child":{flexGrow:1,textAlign:"start"}}],requiredText:[g.l0.display.inlineFlex,g.l0.rowWithGap(4)],subjectField:[g.l0.colWithGap(8)],bodyField:[g.l0.colWithGap(8)],subjectInput:iy,bodyInput:ib,subjectInputDisabled:[iy,{opacity:.5}],bodyInputDisabled:[ib,{opacity:.5}],required:[g.l0.color.accentNegativeStronger],keyCombo:[g.l0.display.inlineFlex,g.l0.rowWithGap(4),g.l0.flex.grow(1),g.l0.align.center],keyComboText:[g.l0.fontWeight.normal,g.l0.color.foregroundDimmest]});function iw(e){var t=e.message,n=e.disabled,r=void 0!==n&&n,i=e.onMessageChange,o=e.onCommitShortcut,l=(0,a._)((0,w.useState)(!0),2),s=l[0],u=l[1],d=(0,a._)((0,w.useState)(!1),2),f=d[0],h=d[1],p=(0,a._)((0,w.useState)(!1),2),m=p[0],v=p[1],g=(0,w.useRef)(null),y=(0,w.useRef)(null),b=(0,N._)(t.split("\n\n")),Z=b[0],x=void 0===Z?"":Z,C=b.slice(1).join("\n\n"),_=(0,ih.d)();function S(e,t){i((e=e.replaceAll("\n"," "))+(t?"\n\n"+t:""))}var E=(0,iv.gf)(im.CN.gitCommit.id);return(0,ig.ow)(im.CT,m),(0,iv.Il)(function(){return[im.CN.gitCommit.id,{run:function(){null==o||o()},scope:im.CT,bubble:!1}]},[o]),(0,c.BX)(R.G,{children:[(0,c.tZ)(L.zx,{css:iZ.button,text:(0,c.BX)("span",{css:iZ.requiredText,children:[(0,c.tZ)("span",{children:"Message"}),s?(0,c.tZ)(i_,{}):null]}),secondaryText:_||!E?void 0:(0,c.BX)("span",{css:iZ.keyCombo,children:[(0,c.tZ)("span",{css:iZ.keyComboText,children:"Commit:"}),(0,c.tZ)(iv.bM,{keyCombo:E,small:!0})]}),iconRight:s?(0,c.tZ)(e$.Z,{}):(0,c.tZ)(eJ.Z,{}),onClick:function(){return u(function(e){return!e})},size:"small"}),(0,c.BX)(M.Tg,{css:iZ.surface,elevated:!0,children:[(0,c.tZ)(ix,{ref:g,value:x,compact:s,disabled:r,onChange:function(e){S(e,C)},onNewline:function(){if(s)u(!1),h(!0);else{if(!y.current)return;y.current.focus(),y.current.setSelectionRange(0,0)}},onFocus:function(){v(!0)},onBlur:function(){v(!1)}}),s&&!C?null:(0,c.tZ)(iC,{ref:y,value:C,compact:s,disabled:r,onChange:function(e){if(S(x,e),s&&!e){var t;null===(t=g.current)||void 0===t||t.focus()}else s&&u(!1)},onBackspaceWhenEmpty:function(){g.current&&g.current.focus()},onFocus:function(){f&&h(!1),v(!0)},onBlur:function(){v(!1)},autoFocus:f})]})]})}var ix=(0,w.forwardRef)(function(e,t){var n=e.value,r=e.compact,i=e.disabled,o=void 0!==i&&i,a=e.onChange,l=e.onNewline,s=e.onFocus,u=e.onBlur;return(0,c.BX)(R.G,{css:iZ.subjectField,children:[void 0!==r&&r?null:(0,c.tZ)(h.xv,{variant:"small",color:"dimmer",multiline:!1,children:(0,c.BX)("span",{css:iZ.requiredText,children:[(0,c.tZ)("span",{children:"Summary"}),(0,c.tZ)(i_,{})]})}),(0,c.tZ)(U.B,{ref:t,css:o?iZ.subjectInputDisabled:iZ.subjectInput,placeholder:"Summary of your commit...",value:n,disabled:o,onChange:function(e){return null==a?void 0:a(e.currentTarget.value)},onKeyDown:function(e){"Enter"!==e.key||e.defaultPrevented||(e.preventDefault(),e.stopPropagation(),null==l||l())},onFocus:s,onBlur:u})]})}),iC=(0,w.forwardRef)(function(e,t){var n=e.value,r=e.compact,i=void 0!==r&&r,o=e.disabled,a=void 0!==o&&o,l=e.autoFocus,s=e.onChange,u=e.onBackspaceWhenEmpty,d=e.onFocus,f=e.onBlur,p=(0,id.Z)().ref;return(0,c.BX)(R.G,{css:iZ.bodyField,children:[i?null:(0,c.tZ)(h.xv,{variant:"small",color:"dimmer",multiline:!1,children:"Description"}),(0,c.tZ)(U.B,{ref:i?t:(0,ip.l)(t,p),css:a?iZ.bodyInputDisabled:iZ.bodyInput,placeholder:"Description of your commit...",value:n,disabled:a,onChange:function(e){return null==s?void 0:s(e.currentTarget.value)},onKeyDown:function(e){"Backspace"===e.key&&""===n&&(e.preventDefault(),e.stopPropagation(),null==u||u())},onFocus:d,onBlur:f,autoFocus:void 0!==l&&l})]})});function i_(){return(0,c.tZ)(tn.u,{tooltip:"This field is required.",placement:"top",children:(0,c.tZ)("span",{css:iZ.required,children:"*"})})}var iS=(0,p.X)({commitArea:[g.l0.colWithGap(8)]});function iE(e){var t=e.status,n=e.onStagedFileClick,r=e.defaultMessage,i=(0,a._)((0,w.useState)(t),2),o=i[0],l=i[1],s=(0,a._)((0,w.useState)(null!=r?r:""),2),u=s[0],d=s[1],f=(0,a._)((0,w.useState)(0),2),p=f[0],m=f[1],v=(0,a._)((0,w.useState)(!1),2),g=v[0],b=v[1],Z=t4();(0,w.useEffect)(function(){return l(t)},[t]);var x=(0,y.Z)().git;if(!o||!o.changes.length)return(0,c.tZ)(R.G,{css:iS.commitArea,children:(0,c.tZ)(h.xv,{color:"dimmest",multiline:!1,children:"There are no changes to commit."})});var C=o.changes.length,_=o.changes.filter(function(e){return e.staged}).length;function S(){return(S=(0,to._)(function(e){var t,n;return(0,ta.Jh)(this,function(r){switch(r.label){case 0:if(g)return[2];return m(function(e){return e+1}),[4,x.stageFiles(e)];case 1:if((t=r.sent()).error)return[3,3];return[4,x.status()];case 2:return(n=r.sent()).error?(ts({context:"commit-area-status",gitService:x,result:n,data:{opts:e}}),Z(n.error)):l(n),x.forceRefresh(),[3,4];case 3:Z(t.error),ts({context:"commit-area-stage-files",gitService:x,result:t,data:{opts:e}}),r.label=4;case 4:return m(function(e){return e-1}),[2]}})})).apply(this,arguments)}function E(){return(E=(0,to._)(function(e){var t,n;return(0,ta.Jh)(this,function(r){switch(r.label){case 0:if(g)return[2];return m(function(e){return e+1}),[4,x.restoreFiles(e)];case 1:if((t=r.sent()).error)return[3,3];return[4,x.status()];case 2:return(n=r.sent()).error?(ts({context:"commit-area-status",gitService:x,result:n,data:{files:e}}),Z(n.error)):l(n),x.forceRefresh(),[3,4];case 3:ts({context:"commit-area-restore-files",gitService:x,result:t,data:{files:e}}),Z(t.error),r.label=4;case 4:return m(function(e){return e-1}),[2]}})})).apply(this,arguments)}function k(){return T.apply(this,arguments)}function T(){return(T=(0,to._)(function(){var e,t;return(0,ta.Jh)(this,function(n){switch(n.label){case 0:if(""===u||g||0===C||p>0)return[2];if(b(!0),0!==_)return[3,2];return[4,x.stageFiles({all:!0})];case 1:n.sent(),n.label=2;case 2:return[4,x.commit({message:u})];case 3:if(!(e=n.sent()).error)return[3,4];return b(!1),Z(e.error),ts({context:"commit-area-commit",gitService:x,result:e,data:{message:u}}),[3,6];case 4:return ny("commit-created",{hasDescription:-1!==u.trim().indexOf("\n\n")}),[4,x.status()];case 5:t=n.sent(),b(!1),t.error?(Z(t.error),ts({context:"commit-area-status",gitService:x,result:t,data:{message:u}})):(d(""),l(t)),x.forceRefresh(),n.label=6;case 6:return[2]}})})).apply(this,arguments)}var D="Nothing to commit";if(g)D="Committing...";else if(_>0&&_<C){var I=(0,ed.Z)("change",_);D="Commit ".concat(_," staged ").concat(I)}else C>0&&(D="Stage and commit all changes");var G=!u||0===C||p>0||g;return(0,c.BX)(R.G,{css:iS.commitArea,children:[(0,c.tZ)(iw,{message:u,disabled:g,onMessageChange:d,onCommitShortcut:k}),(0,c.tZ)(ic,{status:o,stageFiles:function(e){return S.apply(this,arguments)},restoreFiles:function(e){return E.apply(this,arguments)},onStagedFileClick:n,disabled:g}),G?(0,c.tZ)(tn.u,{tooltip:p>0?"Changes in progress":0===C?"There are no changes to commit.":"You must enter a commit message before you can commit.",children:(0,c.tZ)(L.zx,{text:D,onClick:k,disabled:G,loading:g,colorway:"primary",iconLeft:(0,c.tZ)(rr.Z,{}),stretch:!0})}):(0,c.tZ)(L.zx,{text:D,onClick:k,disabled:G,loading:g,colorway:"primary",iconLeft:(0,c.tZ)(rr.Z,{}),stretch:!0})]})}var ik=/\s\(#(\d+)\)$/,iT=/^Revert "(.+)"/,iR=/^This reverts commit ([a-f0-9]+)(?:, reversing changes made to ([a-f0-9]+))?\./;function iD(e){var t=iT.exec(e.subject),n=iR.exec(e.body);if(t&&n){var r,i=n[1],o=t[1],a=ik.exec(o);return a&&(r=parseInt(a[1],10)),{hash:i,subject:o,pr:r}}return null}var iI=/\B#\d+\b/g,iG=/^Merged? pull request (#\d+\b)/,iB=/^Merge branch '(.+)'/,iA=/into (.+)$/;function iP(e){if("GitHub"===e.committer.name&&"noreply@github.com"===e.committer.email){var t=e.subject.match(iI);if(t){var n,r=parseInt(t[t.length-1].slice(1),10);if(r)return ik.test(e.subject)&&(n=e.subject.replace(ik,"").trim()),!n&&iG.test(e.subject)&&e.body&&-1===e.body.indexOf("\n")&&(n=e.body),{type:"pull-request",id:r,subject:n,reverts:iD(e)}}}if(iG.test(e.subject)){var i,o=iG.exec(e.subject);if(o)return e.body&&-1===e.body.indexOf("\n")&&(i=e.body),{type:"pull-request",id:parseInt(o[1].slice(1),10),subject:i,reverts:iD(e)}}if(iB.test(e.subject)){var a=iB.exec(e.subject);if(a){var l=iA.exec(e.subject);return{type:"branch",source:a[1],target:l?l[1]:null}}}return e.parents&&e.parents.length>2?{type:"octopus",parents:e.parents}:e.parents&&e.parents.length>1?{type:"simple",a:e.parents[0],b:e.parents[1]}:null}var iN=n(77615),iU={position:"absolute",top:0,height:9,width:9,border:"1px solid ".concat(g.TV.purpleStrongest),borderRadius:"50%"},iO=(0,p.X)({markerContainer:[g.l0.display.flex,g.l0.align.center,g.l0.justify.center,g.l0.minHeight(20),g.l0.minWidth(20)],commitMarker:[g.l0.height(4),g.l0.width(4),g.l0.backgroundColor.foregroundDefault,g.l0.borderRadius("full")],collapsedMarkerIconDot:[g.l0.height(3),g.l0.width(3),g.l0.backgroundColor.foregroundDimmer,g.l0.borderRadius("full")],collapsedMarkerIconContainer:[g.l0.display.flex,g.l0.align.center,g.l0.justify.center,{"div + div":{marginLeft:1}}],collapsedMarker:[g.l0.display.flex,g.l0.align.center,g.l0.justify.center,g.l0.height(20),g.l0.width(20),g.l0.backgroundColor.backgroundHighest,g.l0.borderRadius("full")],revertMarker:[g.l0.display.flex,g.l0.height(20),g.l0.width(20),g.l0.backgroundColor.orangeDimmest,g.l0.borderRadius("full"),g.l0.align.center,g.l0.justify.center],mergeMarker:[g.l0.display.flex,g.l0.height(20),g.l0.width(20),g.l0.backgroundColor.purpleDimmest,g.l0.borderRadius("full"),g.l0.align.center,g.l0.justify.center],mergeMarkerIconContainer:[g.l0.position.relative,g.l0.height(9),g.l0.width(13)],mergeMarkerIconLeft:[(0,A._)({},iU),g.l0.left(0)],mergeMarkerIconRight:[(0,A._)({},iU),g.l0.right(0)],boundaryMarker:[g.l0.height(6),g.l0.width(6),g.l0.backgroundColor.backgroundDefault,g.l0.borderRadius("full"),{border:"1px solid ".concat(g.TV.backgroundHighest)}]});function iL(e){var t=function(e){switch(e){case"none":default:return null;case"commit":return(0,c.tZ)(iM,{});case"revert":return(0,c.tZ)(iX,{});case"merge":return(0,c.tZ)(iF,{});case"boundary":return(0,c.tZ)(iW,{});case"collapsed":return(0,c.tZ)(iH,{})}}(e.type);return t?(0,c.tZ)("div",{css:iO.markerContainer,children:t}):null}function iM(){return(0,c.tZ)("div",{css:iO.commitMarker})}function iX(){return(0,c.tZ)("div",{css:iO.revertMarker,children:(0,c.tZ)(r$.Z,{size:12,color:g.TV.orangeStrongest})})}function iF(){return(0,c.tZ)("div",{css:iO.mergeMarker,children:(0,c.BX)("div",{css:iO.mergeMarkerIconContainer,children:[(0,c.tZ)("div",{css:iO.mergeMarkerIconLeft}),(0,c.tZ)("div",{css:iO.mergeMarkerIconRight})]})})}function iW(){return(0,c.tZ)("div",{css:iO.boundaryMarker})}function iH(){return(0,c.tZ)("div",{css:iO.collapsedMarker,children:(0,c.BX)("div",{css:iO.collapsedMarkerIconContainer,children:[(0,c.tZ)("div",{css:iO.collapsedMarkerIconDot}),(0,c.tZ)("div",{css:iO.collapsedMarkerIconDot}),(0,c.tZ)("div",{css:iO.collapsedMarkerIconDot})]})})}var iV=[g.l0.position.absolute,g.l0.left(0),g.l0.width(18)],iz=(0,p.X)({connectorSegmentBorderSolid:[iV,{borderRight:"1px solid ".concat(g.TV.outlineDimmest)}],connectorSegmentBorderDashed:[iV,{borderRight:"1px dashed ".concat(g.TV.outlineDimmest)}]});function ij(e){var t=e.boundaryTop,n=void 0!==t&&t,r=e.boundaryBottom,i=void 0!==r&&r,o=e.joint,a=void 0===o?"top":o,l=e.hideTop,s=void 0!==l&&l,u=e.hideBottom,d=void 0!==u&&u;if(s&&d)return null;if(n===i&&!s&&!d)return(0,c.tZ)(iY,{top:0,bottom:0,dashed:n&&i});var f=s?null:(0,c.tZ)(iq,{start:"top",joint:a,dashed:n}),h=d?null:(0,c.tZ)(iq,{start:"bottom",joint:a,dashed:i});return(0,c.BX)(c.HY,{children:[f,h]})}function iq(e){var t,n,r=e.start,i=e.joint,o=e.dashed,a="center"===i?(t={},(0,eD._)(t,r,0),(0,eD._)(t,"height","50%"),t):(n={},(0,eD._)(n,r,0),(0,eD._)(n,r===i?"height":i,8),n);return(0,c.tZ)(iY,(0,P._)((0,A._)({},a),{dashed:void 0!==o&&o}))}function iY(e){var t=e.top,n=e.bottom,r=e.height,i=e.dashed;return(0,c.tZ)("div",{css:void 0!==i&&i?iz.connectorSegmentBorderDashed:iz.connectorSegmentBorderSolid,style:{top:t,bottom:n,height:r}})}var i$=(0,p.X)({container:{position:"relative",marginLeft:30,marginRight:4,paddingLeft:6,userSelect:"none"},containerInteractive:[t9.gU.nofill,{position:"relative",marginLeft:30,marginRight:4,paddingLeft:6,userSelect:"none"}],nodeFoldedIconContainer:{position:"absolute",top:"50%",transform:"translateY(-50%)",right:8,zIndex:1,opacity:0,"div:hover > &":{transition:"opacity 120ms ease-out",opacity:1}},nodeUnFoldedIconContainer:{position:"absolute",top:"50%",transform:"translateY(-50%)",right:8,zIndex:1},nodeContentContainer:[g.l0.colWithGap(4),{position:"relative",paddingTop:8,paddingBottom:8,paddingRight:8}],nodeHeader:{display:"block",height:20},nodeUnfoldedContentSurface:[g.l0.mt(4),g.l0.mb(8),g.l0.p(8),g.l0.borderRadius(8),{marginLeft:36,marginRight:8,overflowX:"hidden"}],unfoldedContentContainer:[g.l0.position.relative]});function iJ(e){var t=e.boundaryTop,n=e.boundaryBottom,r=void 0!==n&&n,i=e.hideConnectorTop,o=e.hideConnectorBottom,l=void 0!==o&&o,s=e.joint,u=void 0===s?"top":s,d=e.marker,f=e.header,h=e.unfoldedContent,p=e.children,m=e.className,v=(0,a._)((0,w.useState)(!0),2),y=v[0],b=v[1];return(0,c.BX)(R.G,{className:m,css:g.l0.position.relative,children:[(0,c.tZ)(ij,{boundaryTop:void 0!==t&&t,boundaryBottom:r,joint:u,hideTop:void 0!==i&&i,hideBottom:l}),d?(0,c.tZ)(iQ,{joint:u,children:d}):null,h?(0,c.BX)(R.G,{css:i$.containerInteractive,role:"button",tabIndex:0,onClick:function(){b(!y)},onKeyDown:function(e){("Enter"===e.key||" "===e.key)&&b(!y)},children:[y?(0,c.tZ)("div",{css:i$.nodeFoldedIconContainer,children:(0,c.tZ)(e$.Z,{})}):(0,c.tZ)("div",{css:i$.nodeUnFoldedIconContainer,children:(0,c.tZ)(eJ.Z,{})}),(0,c.BX)(R.G,{css:i$.nodeContentContainer,children:[f?(0,c.tZ)(R.G,{css:i$.nodeHeader,children:f}):null,p?(0,c.tZ)(R.G,{children:p}):null]})]}):(0,c.tZ)(R.G,{css:i$.container,children:(0,c.BX)(R.G,{css:i$.nodeContentContainer,children:[f?(0,c.tZ)(R.G,{css:i$.nodeHeader,children:f}):null,p?(0,c.tZ)(R.G,{children:p}):null]})}),!h||y?null:(0,c.BX)(R.G,{css:i$.unfoldedContentContainer,children:[l?null:(0,c.tZ)(iY,{top:0,bottom:0,dashed:r}),(0,c.tZ)(M.Tg,{css:i$.nodeUnfoldedContentSurface,elevated:!0,children:h})]})]})}var iK=(0,p.X)({top:{position:"absolute",top:8,left:18,transform:"translateX(-50%)"},bottom:{position:"absolute",bottom:8,left:18,transform:"translateX(-50%)"},center:{position:"absolute",top:"50%",left:18,transform:"translateX(-50%) translateY(-50%)"}});function iQ(e){var t=e.joint,n=e.children;return(0,c.tZ)("div",{css:iK[void 0===t?"top":t],children:n})}var i0=(0,p.X)({container:[g.l0.rowWithGap(8),g.l0.align.center,g.l0.justify.spaceBetween,g.l0.height("100%")],textContainer:[g.l0.rowWithGap(4),g.l0.center],text:[g.l0.flex.shrink(0)]});function i1(e){var t=e.text,n=(0,eB._)(e,["text"]);return(0,c.tZ)(iJ,(0,A._)({marker:(0,c.tZ)(iL,{type:"boundary"}),joint:"center",header:(0,c.BX)(R.G,{css:i0.container,children:[(0,c.tZ)(t6.R,{}),(0,c.BX)(R.G,{css:i0.textContainer,children:[(0,c.tZ)(iN.Z,{size:12,color:g.TV.foregroundDimmest}),(0,c.tZ)(h.xv,{css:i0.text,variant:"small",color:"dimmest",multiline:!1,children:t})]}),(0,c.tZ)(t6.R,{})]})},n))}var i2=(0,p.X)({definitionList:{display:"grid",gridTemplateColumns:"auto 1fr",paddingLeft:g.TV.space4,"> dt":{display:"flex",alignItems:"center",paddingBottom:g.TV.space2},"> dd":{marginLeft:g.TV.space12,paddingBottom:g.TV.space2}},listHeader:[g.l0.fontWeight.medium],content:[g.l0.colWithGap(8)],description:[g.l0.colWithGap(8)],commitList:[g.l0.colWithGap(2),g.l0.pl(4)]}),i8=function(e,t){var n=!e.body,r=null,i=null;return t&&"type"in t?(r=t,"pull-request"===t.type&&(t.reverts&&(i=t.reverts),t.subject&&(n=!0))):t&&(i=t),{hideBody:n,merge:r,revert:i}},i4=function(e){var t=e.hash;return(0,c.tZ)(eq.m,{size:"small",iconLeft:(0,c.tZ)(F.Z,{}),textToCopy:t,text:t.slice(0,7),tooltip:"Hash copied!"})},i3=function(e){var t=e.onClick,n=e.text,r=e.loading;return(0,c.tZ)(tn.u,{tooltip:"Discard current changes and restore files to time of commit",children:(0,c.tZ)(L.zx,{text:n,onClick:t,size:"small",iconLeft:void 0!==r&&r?(0,c.tZ)(v.Z,{}):(0,c.tZ)(r$.Z,{})})})},i5=function(e,t){return!(e.name===t.name&&e.email===t.email)},i6=function(e,t){return!(6e4>Math.abs(e-t))};function i9(e){var t=e.commit,n=e.info,r=i5(t.committer,t.author),i=i6(t.author.date,t.committer.date),o=i8(t,void 0===n?null:n),a=o.hideBody,l=o.merge,s=o.revert;return(0,c.BX)(R.G,{css:i2.content,children:[a?null:(0,c.BX)(R.G,{css:i2.description,children:[(0,c.tZ)(h.xv,{children:(0,c.tZ)(nR,{body:t.body})}),(0,c.tZ)(t6.R,{css:g.l0.backgroundColor.outlineDimmer})]}),(0,c.BX)(R.G,{children:[(0,c.tZ)(h.xv,{css:i2.listHeader,multiline:!1,children:"Author"}),(0,c.BX)("dl",{css:i2.definitionList,children:[(0,c.tZ)("dt",{children:"Name:"}),(0,c.tZ)("dd",{children:t.author.name}),(0,c.tZ)("dt",{children:"Email:"}),(0,c.tZ)("dd",{children:t.author.email})]})]}),r?(0,c.BX)(R.G,{children:[(0,c.tZ)(h.xv,{css:i2.listHeader,multiline:!1,children:"Committer"}),(0,c.BX)("dl",{css:i2.definitionList,children:[(0,c.tZ)("dt",{children:"Name:"}),(0,c.tZ)("dd",{children:t.committer.name}),(0,c.tZ)("dt",{children:"Email:"}),(0,c.tZ)("dd",{children:t.committer.email})]})]}):null,(0,c.BX)(R.G,{children:[(0,c.tZ)(h.xv,{css:i2.listHeader,multiline:!1,children:"Commit"}),(0,c.BX)("dl",{css:i2.definitionList,children:[i?(0,c.BX)(c.HY,{children:[(0,c.tZ)("dt",{children:"Authored:"}),(0,c.tZ)("dd",{children:(0,c.tZ)(nt.EK,{date:t.author.date,dateFormat:"absolute"})}),(0,c.tZ)("dt",{children:"Committed:"}),(0,c.tZ)("dd",{children:(0,c.tZ)(nt.EK,{date:t.committer.date,dateFormat:"absolute"})})]}):(0,c.BX)(c.HY,{children:[(0,c.tZ)("dt",{children:"Date:"}),(0,c.tZ)("dd",{children:(0,c.tZ)(nt.EK,{date:t.author.date,dateFormat:"absolute"})})]}),(0,c.tZ)("dt",{children:"Hash:"}),(0,c.tZ)("dd",{children:(0,c.tZ)(i4,{hash:t.hash})}),l&&"pull-request"===l.type?(0,c.BX)(c.HY,{children:[(0,c.tZ)("dt",{children:"PR:"}),(0,c.BX)("dd",{children:["#",l.id]})]}):null,l&&"branch"===l.type?(0,c.BX)(c.HY,{children:[(0,c.tZ)("dt",{children:"Merged:"}),(0,c.tZ)("dd",{children:l.source}),l.target?(0,c.BX)(c.HY,{children:[(0,c.tZ)("dt",{children:"Into:"}),(0,c.tZ)("dd",{children:l.target})]}):null]}):null,s?(0,c.BX)(c.HY,{children:[(0,c.tZ)("dt",{children:"Reverted:"}),(0,c.tZ)("dd",{children:s.hash})]}):null]})]}),l&&"simple"===l.type?(0,c.BX)(R.G,{children:[(0,c.tZ)(h.xv,{css:i2.listHeader,multiline:!1,children:"Merged"}),(0,c.BX)(R.G,{css:i2.commitList,children:[(0,c.tZ)(h.xv,{multiline:!1,children:l.a}),(0,c.tZ)(h.xv,{multiline:!1,children:l.b})]})]}):null,l&&"octopus"===l.type?(0,c.BX)(R.G,{children:[(0,c.tZ)(h.xv,{css:i2.listHeader,multiline:!1,children:"Merged"}),(0,c.tZ)(R.G,{css:i2.commitList,children:l.parents.map(function(e,t){return(0,c.tZ)(h.xv,{multiline:!1,children:e},t)})})]}):null]})}var i7=(0,p.X)({authorContainer:[g.l0.rowWithGap(8),g.l0.align.center],headerText:[g.l0.rowWithGap(4),g.l0.align.center,g.l0.fontWeight.medium],headerContainer:[g.l0.colWithGap(4),g.l0.align.start,g.l0.justify.start],button:[g.l0.reset.button,g.l0.linkStyle,g.l0.color.foregroundDefault,g.l0.fontWeight.medium,{display:"block",width:"100%",textAlign:"left"}]}),oe=function(e){var t=e.author;return(0,c.BX)(R.G,{css:i7.authorContainer,children:[(0,c.tZ)(np,{name:t.name,email:t.email,color:"dimmer",allowPlaceholderAvatar:!0,small:!0}),(0,c.tZ)(nt.EK,{date:t.date,textColor:"dimmest",textVariant:"small"})]})},ot=function(e){var t=e.children;return(0,c.tZ)(h.xv,{css:i7.headerText,multiline:!1,maxLines:1,children:t})},on=function(e){var t=e.commit,n=e.onViewCommitClick,r=e.children;return(0,c.tZ)(R.G,{css:i7.headerContainer,children:(0,c.tZ)(tn.u,{tooltip:"View ".concat(t.hash.slice(0,7)),children:(0,c.tZ)("button",{css:i7.button,onClick:function(){return n(t.hash)},children:r})})})};function or(e){var t=e.commit,n=(0,eB._)(e,["commit"]);return(0,c.tZ)(iJ,(0,P._)((0,A._)({marker:(0,c.tZ)(iL,{type:"commit"}),header:(0,c.tZ)(ot,{children:(0,c.tZ)(nT,{subject:t.subject})}),unfoldedContent:(0,c.tZ)(i9,{commit:t})},n),{children:(0,c.tZ)(oe,{author:t.author})}))}var oi=function(e){var t=e.commit,n=e.onViewCommitClick,r=(0,eB._)(e,["commit","onViewCommitClick"]);return(0,c.tZ)(iJ,(0,P._)((0,A._)({marker:(0,c.tZ)(iL,{type:"commit"}),header:(0,c.tZ)(on,{commit:t,onViewCommitClick:function(){return n(t.hash)},children:(0,c.tZ)(ot,{children:(0,c.tZ)(nT,{subject:t.subject})})})},r),{children:(0,c.tZ)(oe,{author:t.author})}))};function oo(e){var t,n=e.commit,r=e.info,i=(0,eB._)(e,["commit","info"]);return"branch"!==r.type&&(t="pull-request"===r.type&&r.subject?r.subject:n.subject),(0,c.tZ)(iJ,(0,P._)((0,A._)({marker:(0,c.tZ)(iL,{type:"merge"}),header:(0,c.BX)(ot,{children:[(0,c.tZ)(nS,{text:"merged"}),(0,c.tZ)(ol,{info:r,hash:n.hash,subject:n.subject})]}),unfoldedContent:(0,c.tZ)(i9,{commit:n,info:r})},i),{children:(0,c.BX)(R.G,{css:[g.l0.colWithGap(8)],children:[t?(0,c.tZ)(h.xv,{color:"dimmer",variant:"small",multiline:!1,children:(0,c.tZ)(nT,{subject:t})}):null,(0,c.tZ)(oe,{author:n.author})]})}))}var oa=function(e){var t,n=e.commit,r=e.info,i=e.onViewCommitClick,o=(0,eB._)(e,["commit","info","onViewCommitClick"]);return"branch"!==r.type&&(t="pull-request"===r.type&&r.subject?r.subject:n.subject),(0,c.tZ)(iJ,(0,P._)((0,A._)({marker:(0,c.tZ)(iL,{type:"merge"}),header:(0,c.tZ)(on,{commit:n,onViewCommitClick:function(){return i(n.hash)},children:(0,c.BX)(ot,{children:[(0,c.tZ)(nS,{text:"merged"}),(0,c.tZ)(ol,{info:r,hash:n.hash,subject:n.subject})]})})},o),{children:(0,c.BX)(R.G,{css:[g.l0.colWithGap(8)],children:[t?(0,c.tZ)(h.xv,{color:"dimmer",variant:"small",multiline:!1,children:(0,c.tZ)(nT,{subject:t})}):null,(0,c.tZ)(oe,{author:n.author})]})}))};function ol(e){var t=e.info,n=e.hash,r=e.subject,i=(0,c.tZ)("span",{css:g.l0.fontWeight.medium,children:r});switch(t.type){case"pull-request":return(0,c.BX)(c.HY,{children:[(0,c.tZ)("span",{children:"pull request"}),(0,c.tZ)(nE,{id:t.id}),t.reverts&&t.reverts.pr?(0,c.BX)(c.HY,{children:[(0,c.tZ)("span",{children:"-"}),(0,c.tZ)(n_,{text:"reverts"}),(0,c.tZ)(nE,{id:t.reverts.pr})]}):null]});case"branch":if(!t.target)return(0,c.BX)(c.HY,{children:[(0,c.tZ)("span",{children:"branch"}),(0,c.tZ)(nD,{name:t.source})]});return(0,c.BX)(c.HY,{children:[(0,c.tZ)(nD,{name:t.source}),(0,c.tZ)("span",{children:"into"}),(0,c.tZ)(nD,{name:t.target})]});case"simple":return(0,c.BX)(c.HY,{children:[(0,c.tZ)(nk,{hash:t.a}),(0,c.tZ)(rG.Z,{css:{alignSelf:"center"},size:12}),(0,c.tZ)(nk,{hash:t.b})]});case"octopus":return(0,c.BX)(c.HY,{children:[(0,c.tZ)("span",{children:"commit"}),(0,c.tZ)(nk,{hash:n}),(0,c.BX)("span",{children:["(",t.parents.length," parents)"]})]});default:return i}}function oc(e){var t=e.commit,n=e.info,r=(0,eB._)(e,["commit","info"]);return(0,c.tZ)(iJ,(0,P._)((0,A._)({marker:(0,c.tZ)(iL,{type:"revert"}),header:(0,c.BX)(ot,{children:[(0,c.tZ)(n_,{text:"reverted"}),(0,c.tZ)(nk,{hash:n.hash}),(0,c.tZ)(nT,{subject:n.subject,quoted:!0})]}),unfoldedContent:(0,c.tZ)(i9,{commit:t,info:n})},r),{children:(0,c.tZ)(oe,{author:t.author})}))}var os=function(e){var t=e.commit,n=e.info,r=e.onViewCommitClick,i=(0,eB._)(e,["commit","info","onViewCommitClick"]);return(0,c.tZ)(iJ,(0,P._)((0,A._)({marker:(0,c.tZ)(iL,{type:"revert"}),header:(0,c.tZ)(on,{commit:t,onViewCommitClick:function(){return r(t.hash)},children:(0,c.BX)(ot,{children:[(0,c.tZ)(n_,{text:"reverted"}),(0,c.tZ)(nk,{hash:n.hash}),(0,c.tZ)(nT,{subject:n.subject,quoted:!0})]})})},i),{children:(0,c.tZ)(oe,{author:t.author})}))},ou=(0,p.X)({body:[g.l0.flex.growAndShrink(1)],virtualItem:[g.l0.position.absolute,g.l0.top(0),g.l0.left(0),g.l0.width("100%"),g.l0.overflow("hidden")],virtualList:[g.l0.position.relative]}),od=function(){return 60};function of(e){var t=e.items,n=(0,w.useRef)(null),r=(0,t5.MG)({overscan:10,count:t.length,getScrollElement:function(){return n.current},estimateSize:od});return(0,c.tZ)("div",{ref:n,css:ou.body,children:(0,c.tZ)("div",{css:ou.virtualList,style:{height:"".concat(r.getTotalSize(),"px")},children:r.getVirtualItems().map(function(e){return(0,c.tZ)("div",{css:ou.virtualItem,style:{transform:"translateY(".concat(e.start,"px)")},"data-index":e.index,ref:r.measureElement,children:(0,c.tZ)(oh,{items:t,index:e.index})},e.key)})})})}function oh(e){var t=e.items,n=e.index,r=t[n],i=0===n,o=n===t.length-1;if("boundary"===r.type)return(0,c.tZ)(i1,{text:r.text,hideConnectorTop:i,hideConnectorBottom:o,boundaryTop:!0,boundaryBottom:!0},r.text);var a=t[n-1]?t[n-1].type:null,l=t[n+1]?t[n+1].type:null;return(0,c.tZ)(op,{commit:r.commit,hideConnectorTop:i,hideConnectorBottom:o,boundaryTop:"commit"!==a,boundaryBottom:"commit"!==l,onViewCommitClick:r.onViewCommitClick},r.commit.hash)}function op(e){var t=e.commit,n=e.onViewCommitClick,r=(0,eB._)(e,["commit","onViewCommitClick"]),i=iP(t);if(i)return n?(0,c.tZ)(oa,(0,A._)({info:i,commit:t,onViewCommitClick:n},r)):(0,c.tZ)(oo,(0,A._)({info:i,commit:t},r));var o=iD(t);return o?n?(0,c.tZ)(os,(0,A._)({info:o,commit:t,onViewCommitClick:n},r)):(0,c.tZ)(oc,(0,A._)({info:o,commit:t},r)):n?(0,c.tZ)(oi,(0,A._)({commit:t,onViewCommitClick:n},r)):(0,c.tZ)(or,(0,A._)({commit:t},r))}var om=(0,eu.F4)({from:{opacity:0},to:{opacity:1}}),ov=(0,p.X)({loadingView:[{animation:"".concat(om," 0.125s 0.25s linear backwards")},g.l0.flex.grow(1),g.l0.display.flex,g.l0.center]});function og(){return(0,c.tZ)(R.G,{css:ov.loadingView,children:(0,c.tZ)(v.Z,{size:48})})}var oy=(0,p.X)({view:[g.l0.pt(4),g.l0.pb(8),g.l0.px(4),g.l0.colWithGap(8),g.l0.flex.grow(1)],sectionContainer:[g.l0.colWithGap(8)],section:[g.l0.pt(8),g.l0.pb(16),g.l0.px(8),g.l0.colWithGap(8),g.l0.border({color:g.TV.outlineDimmest,direction:"bottom"})],remoteUpdatesHeader:[g.l0.rowWithGap(8),g.l0.align.center,g.l0.justify.spaceBetween],reviewChangesHeader:[g.l0.rowWithGap(8),g.l0.align.center],headerText:[g.l0.fontWeight.medium],switchToBranch:[g.l0.p(4),g.l0.flex.row,g.l0.align.center,g.l0.justify.spaceBetween,g.l0.mt(0),g.l0.mb(0)]});function ob(e){var t,n,r,i,o,s=e.status,u=e.remotes,d=e.branch,f=e.onStagedFileClick,p=e.onViewCommitClick,m=e.onViewSettingsClick,v=e.gotoPendingState,g=e.current,y=void 0!==g&&g,b=y?null==s?void 0:null===(i=s.upstream)||void 0===i?void 0:i.behind:void 0,Z=y?null==s?void 0:null===(o=s.upstream)||void 0===o?void 0:o.ahead:void 0,x=(t=t4(),r=(0,tl.Z)((n=(0,to._)(function(e){var t,n,r,i,o,l,c,s,u;return(0,ta.Jh)(this,function(f){switch(f.label){case 0:return[4,e.isInitialized()];case 1:if((t=f.sent()).error)return ts({context:"use-branch-commits",gitService:e,result:t}),[2,{error:t.error}];if(!t.initialized)return[2,{log:[],onlyRemote:[],onlyLocal:[],error:null}];if(!d)return[2,{error:null}];if(!(!d.tracking||0===b&&0===Z))return[3,3];return n=(0,nr.bF)(d,!0),[4,e.log({max:100,revRange:n})];case 2:if((r=f.sent()).error)return ts({context:"use-branch-commits",gitService:e,result:r,data:{branch:d,behind:b,ahead:Z,revision:n}}),[2,r];return[2,{log:r.commits,error:null}];case 3:return i=(0,nr.bF)(d),[4,Promise.all([e.log({max:100,revRange:d.name}),e.log({max:100,revRange:"".concat(d.name,"..").concat(i)}),e.log({max:100,revRange:"".concat(i,"..").concat(d.name)})])];case 4:if(o=f.sent(),c=(l=(0,a._)(o,3))[0],s=l[1],u=l[2],c.error)return ts({context:"use-branch-commits-log",gitService:e,result:c,data:{branch:d,behind:b,ahead:Z,remoteBranch:i}}),[2,{error:c.error}];if(s.error)return ts({context:"use-branch-commits-only-remote",gitService:e,result:s,data:{branch:d,behind:b,ahead:Z,remoteBranch:i}}),[2,{error:s.error}];if(u.error)return ts({context:"use-branch-commits-only-local",gitService:e,result:u,data:{branch:d,behind:b,ahead:Z,remoteBranch:i}}),[2,{error:u.error}];return[2,{log:c.commits,onlyRemote:s.commits,onlyLocal:u.commits,error:null}]}})}),function(e){return n.apply(this,arguments)}),[d,b,Z]),(0,w.useMemo)(function(){if(!r)return null;if(r.error)return t(r.error),{error:r.error};var e=r.log,n=r.onlyRemote,i=r.onlyLocal;if(!n&&!i)return{log:e,error:null};if(e){var o=new Set;if(n){var a=!0,l=!1,c=void 0;try{for(var s,u=n[Symbol.iterator]();!(a=(s=u.next()).done);a=!0){var d=s.value;o.add(d.hash)}}catch(e){l=!0,c=e}finally{try{a||null==u.return||u.return()}finally{if(l)throw c}}}if(i){var f=!0,h=!1,p=void 0;try{for(var m,v=i[Symbol.iterator]();!(f=(m=v.next()).done);f=!0){var g=m.value;o.add(g.hash)}}catch(e){h=!0,p=e}finally{try{f||null==v.return||v.return()}finally{if(h)throw p}}}e=e.filter(function(e){return!o.has(e.hash)})}return{log:e,onlyRemote:n,onlyLocal:i,error:null}},[t,r])),C=!!u&&u.size>0,_=(null==d?void 0:d.type)===tJ.HO.LOCAL,S=(0,w.useMemo)(function(){if(!x||x.error)return[];var e=[],t=x.log,n=void 0===t?[]:t,r=x.onlyRemote,i=void 0===r?[]:r,o=x.onlyLocal,a=void 0===o?[]:o,c=n.length>0,s=i.length>0,u=a.length>0;return s&&(e.push({type:"boundary",text:"Not pulled from remote"}),e.push.apply(e,(0,l._)(oZ(i,p)))),u&&(e.push({type:"boundary",text:"Not pushed to remote"}),e.push.apply(e,(0,l._)(oZ(a,p)))),c&&((s||u)&&e.push({type:"boundary",text:"Up to date with remote"}),e.push.apply(e,(0,l._)(oZ(n,p)))),e},[x,p]);return d?(0,c.BX)(R.G,{css:oy.view,children:[(0,c.BX)(R.G,{css:oy.sectionContainer,children:[_?(0,c.tZ)(R.G,{css:oy.section,children:(0,c.tZ)(rk,{branch:d,onViewSettingsClick:m})}):null,y&&!_&&u&&C?(0,c.BX)(R.G,{css:oy.section,children:[(0,c.BX)(R.G,{css:oy.remoteUpdatesHeader,children:[(0,c.tZ)(h.xv,{css:oy.headerText,multiline:!1,children:"Remote Updates"}),(0,c.tZ)(rI,{branch:d,remotes:u})]}),(0,c.tZ)(rq,{remotes:u,gotoPendingState:v})]}):null,y&&s?(0,c.BX)(R.G,{css:oy.section,children:[(0,c.tZ)(R.G,{css:oy.reviewChangesHeader,children:(0,c.tZ)(h.xv,{css:oy.headerText,multiline:!1,children:"Commit"})}),(0,c.tZ)(iE,{status:s,onStagedFileClick:f})]}):null]}),x?(0,c.tZ)(of,{items:S}):(0,c.tZ)(og,{})]}):(0,c.tZ)("div",{children:"No branch"})}function oZ(e,t){return e.map(function(e){return{type:"commit",commit:e,onViewCommitClick:t}})}function ow(){return(0,c.BX)(R.G,{children:[(0,c.tZ)(h.xv,{multiline:!1,children:"Unsupported state: you are in the middle of a cherry-pick."}),(0,c.tZ)(h.xv,{multiline:!1,children:"Please finish the cherry-pick manually."})]})}var ox=(0,p.X)({branch:[t9.gU.nofill,g.l0.py(12),g.l0.px(8),g.l0.colWithGap(2),g.l0.justify.center,g.l0.borderRadius(8),g.l0.flex.shrink(1)],branchMetadata:[g.l0.rowWithGap(8),g.l0.align.center,g.l0.flex.shrink(1)]});function oC(e){var t=e.branch,n=e.current,r=e.onClick;return(0,c.BX)(R.G,{css:ox.branch,tabIndex:0,role:"button","aria-label":"Switch to branch ".concat((0,nr.bF)(t,!0)),onClick:r,onKeyDown:function(e){("Enter"===e.key||" "===e.key)&&(null==r||r())},children:[(0,c.tZ)(h.xv,{multiline:!1,children:(0,c.tZ)(nD,{name:t.name,remote:t.type===tJ.HO.REMOTE?t.remote:null,current:void 0!==n&&n,onClick:r,icon:!0})}),(0,c.tZ)(o_,{branch:t})]})}function o_(e){var t=e.branch;return(0,c.BX)(R.G,{css:ox.branchMetadata,children:[(0,c.tZ)(np,{name:t.commit.author.name,email:t.commit.author.email,color:"dimmest",allowPlaceholderAvatar:!0}),(0,c.tZ)(nt.EK,{date:t.commit.author.date,textColor:"dimmest",textVariant:"small"})]})}var oS=(0,p.X)({expandButton:[{verticalAlign:"middle"},g.l0.justify.spaceBetween],branchListContainer:[g.l0.display.flex],topRow:[g.l0.p(4),g.l0.flex.row,g.l0.align.center,g.l0.justify.spaceBetween],topRowInteractive:[{verticalAlign:"middle"},g.l0.justify.spaceBetween,g.l0.borderRadius(8,8,0,0)],branchList:[g.l0.borderRadius(8)],branchListFoldable:[g.l0.borderRadius(0,0,8,8)]});function oE(e){var t=e.name,n=e.branches,r=e.current,i=void 0===r?null:r,o=e.foldable,l=void 0!==o&&o,s=e.folded,u=e.switchBranch,d=(0,a._)((0,w.useState)(!!l&&void 0!==s&&s),2),f=d[0],p=d[1],m=(0,w.useMemo)(function(){return n.map(function(e){return(0,c.tZ)(oC,{branch:e,current:(0,tJ.p3)(e,i),onClick:function(){return u(e)}},(0,nr.Qj)(e))})},[n,i,u]);return f?(0,c.tZ)(L.zx,{css:oS.expandButton,text:t,iconRight:(0,c.tZ)(e$.Z,{}),onClick:function(){return p(!1)},size:"big"}):l?(0,c.BX)(R.G,{css:oS.branchListContainer,children:[(0,c.tZ)(L.zx,{css:oS.topRowInteractive,text:t,iconRight:(0,c.tZ)(eJ.Z,{}),onClick:function(){return p(!0)},size:"big"}),(0,c.tZ)(M.Tg,{css:oS.branchListFoldable,elevated:!0,children:m})]}):(0,c.BX)(R.G,{css:oS.branchListContainer,children:[(0,c.tZ)(R.G,{css:oS.topRow,children:(0,c.tZ)(h.xv,{variant:"subheadDefault",multiline:!1,children:t})}),(0,c.tZ)(M.Tg,{css:oS.branchList,elevated:!0,children:m})]})}var ok=(0,p.X)({container:[g.l0.p(8),g.l0.colWithGap(8),g.l0.borderRadius(8)],buttonContainer:[g.l0.rowWithGap(4)],button:[g.l0.flex.grow(1)],inputDisabled:[{opacity:.75}]});function oT(){var e=(0,a._)((0,w.useState)(!0),2),t=e[0],n=e[1],r=(0,a._)((0,w.useState)(""),2),i=r[0],o=r[1],l=(0,a._)((0,w.useState)(!1),2),s=l[0],u=l[1],d=t4(),f=(0,y.Z)().git;function h(){n(!0),o("")}function p(){return m.apply(this,arguments)}function m(){return(m=(0,to._)(function(){var e;return(0,ta.Jh)(this,function(r){switch(r.label){case 0:if(t||!i||s)return[2];return u(!0),[4,f.createBranch({name:i,checkout:!0})];case 1:return(e=r.sent()).error?(d(e.error),u(!1)):(f.forceRefresh(),u(!1),o(""),n(!0),ny("branch-created")),[2]}})})).apply(this,arguments)}if(t)return(0,c.tZ)(L.zx,{text:"Create Branch",iconLeft:(0,c.tZ)(nn.Z,{}),onClick:function(){return n(!1)}});var v=!i||!(0,nr.Dc)(i);return(0,c.BX)(M.Tg,{css:ok.container,elevated:!0,children:[(0,c.tZ)(oR,{value:i,onChange:o,onSubmit:p,onCancel:h,disabled:s}),(0,c.BX)(R.G,{css:ok.buttonContainer,children:[(0,c.tZ)(L.zx,{css:ok.button,text:"Cancel",onClick:h,disabled:s}),(0,c.tZ)(L.zx,{css:ok.button,text:"Create Branch",colorway:"primary",iconLeft:(0,c.tZ)(nn.Z,{}),onClick:p,loading:s,disabled:v})]})]})}function oR(e){var t=e.value,n=e.disabled,r=e.onChange,i=e.onSubmit,o=e.onCancel;function a(e){(0,nr.dC)(e)&&(null==r||r(e))}return(0,c.tZ)(U.II,{value:t,css:n?ok.inputDisabled:void 0,disabled:n,placeholder:"Enter a name for your new branch",onChange:function(e){return a(e.currentTarget.value)},onKeyDown:function(e){return function(e,n){switch(e){case"Enter":null==i||i(),n();break;case"Escape":null==o||o(),n();break;case" ":if(""===t){n();break}a(t+"-"),n()}}(e.key,function(){return e.preventDefault()})},onBlur:function(){""===t&&(null==o||o())},autoFocus:!0})}function oD(e){var t,n,r=e.currentBranch,i=e.switchMode,o=t4(),l=(0,y.Z)().git,s=(0,a._)((0,w.useState)(null),2),u=s[0],d=s[1],f=(0,tl.Z)((t=(0,to._)(function(e){var t,n,r,i,a,l,c,s,u,d,f,h,p,m,v,g,y,b,Z;return(0,ta.Jh)(this,function(w){switch(w.label){case 0:return[4,e.listBranches()];case 1:if((t=w.sent()).error)return o(t.error),ts({context:"dashboard-view",gitService:e,result:t}),[2,t];return[4,e.findDefaultBranches()];case 2:if((n=w.sent()).error)return o(n.error),[2,n];r=t.branches,i=new Set,a=!0,l=!1,c=void 0;try{for(s=function(){var e=d.value,t=r.find(function(t){return(0,nr.Pi)(t,e)});t&&i.add(t)},u=n.refs[Symbol.iterator]();!(a=(d=u.next()).done);a=!0)s()}catch(e){l=!0,c=e}finally{try{a||null==u.return||u.return()}finally{if(l)throw c}}f=Date.now()-5184e6,h=[],p=[],m=!0,v=!1,g=void 0;try{for(y=r[Symbol.iterator]();!(m=(b=y.next()).done);m=!0)Z=b.value,i.has(Z)||(Z.commit.author.date>f?h.push(Z):p.push(Z))}catch(e){v=!0,g=e}finally{try{m||null==y.return||y.return()}finally{if(v)throw g}}return[2,{active:h,stale:p,important:Array.from(i),error:null}]}})}),function(e){return t.apply(this,arguments)}),[o]),p=(n=(0,to._)(function(e){var t;return(0,ta.Jh)(this,function(n){switch(n.label){case 0:if(null!==u)return[2];return(0,nr.Pi)(r,e)&&i({mode:vZ.CURRENT_BRANCH}),d(e),[4,l.switchBranch(e)];case 1:return(t=n.sent()).error?(o(t.error),ts({context:"dashboard-view",gitService:l,result:t,data:{branch:e.name}}),d(null)):(l.forceRefresh(),ny("branch-switched")),[2]}})}),function(e){return n.apply(this,arguments)});if((0,w.useEffect)(function(){null!==u&&(0,nr.Pi)(r,u)&&(d(null),i({mode:vZ.CURRENT_BRANCH}))},[r,u,i]),!f||null!==u)return(0,c.tZ)(og,{});if(f.error)return(0,c.tZ)("div",{children:f.error});var m=f.active,v=f.stale,b=f.important;return(0,c.tZ)(R.G,{css:[g.l0.colWithGap(8)],children:(0,c.BX)(R.G,{css:[g.l0.pb(8),g.l0.px(8),g.l0.colWithGap(16)],children:[r?(0,c.BX)(R.G,{css:g.l0.colWithGap(8),children:[(0,c.tZ)(oE,{branches:[r],current:r,name:"Current Branch",switchBranch:p}),(0,c.tZ)(oT,{})]}):null,(0,c.tZ)(h.xv,{variant:"subheadDefault",multiline:!1,css:oy.switchToBranch,children:"Switch Branch"}),0===b.length?null:(0,c.tZ)(oE,{branches:b,current:r,name:"Important",switchBranch:p,foldable:!0}),0===m.length?null:(0,c.tZ)(oE,{branches:m,current:r,name:"Active",switchBranch:p,foldable:!0}),0===v.length?null:(0,c.tZ)(oE,{branches:v,current:r,name:"Stale",switchBranch:p,foldable:!0,folded:!0})]})})}function oI(){return(0,c.BX)(R.G,{children:[(0,c.tZ)(h.xv,{multiline:!1,children:"Unsupported state: your HEAD is currently detached."}),(0,c.tZ)(h.xv,{multiline:!1,children:"Please checkout a branch."})]})}var oG=n(76588),oB=n(60769),oA=(0,p.X)({checkboxLabel:g.l0.rowWithGap(8)});function oP(){var e=(0,w.useId)(),t=(0,a._)((0,w.useState)(!0),2),n=t[0],r=t[1],i=(0,a._)((0,w.useState)(!1),2),o=i[0],l=i[1],s=t4(),u=(0,y.Z)().git;function d(){return(d=(0,to._)(function(){var e;return(0,ta.Jh)(this,function(t){switch(t.label){case 0:if(o)return[2];return l(!0),[4,u.init({initialCommit:n,includeAllInitialFiles:!0})];case 1:return(e=t.sent()).error?(l(!1),s(e.error)):(u.forceRefresh(),ny("repository-initialized")),[2]}})})).apply(this,arguments)}return(0,c.BX)(c.HY,{children:[(0,c.BX)(R.G,{css:oA.checkboxLabel,tag:"label",children:[(0,c.tZ)(oB.X,{id:e,checked:n,onChange:function(e){return r(e.target.checked)}}),(0,c.tZ)(h.xv,{multiline:!1,children:"Create initial commit with all changes"})]}),(0,c.tZ)(L.zx,{text:o?"Initializing...":"Initialize Git Repository",iconLeft:o?(0,c.tZ)(v.Z,{}):(0,c.tZ)(tq.Z,{}),colorway:"primary",loading:o,onClick:function(){return d.apply(this,arguments)}})]})}var oN=(0,p.X)({container:[g.l0.height("100%"),g.l0.p(16),g.l0.colWithGap(16),g.l0.center],imageTagline:[g.l0.colWithGap(16),g.l0.center,g.l0.flex.shrink(1)]});function oU(){return(0,c.BX)(R.G,{css:oN.container,children:[(0,c.BX)(R.G,{css:oN.imageTagline,children:[(0,c.tZ)(oG.Z,{alt:"A potted plant morphing into a branching graph like structure",src:"/public/images/git/git_uninitialized_art.svg",height:300,width:280,objectFit:"contain",priority:!0}),(0,c.tZ)(h.xv,{variant:"subheadDefault",multiline:!1,children:"Version control for your Repl."})]}),(0,c.tZ)(oP,{})]})}function oO(){return(0,c.BX)(R.G,{children:[(0,c.tZ)(h.xv,{multiline:!1,children:"Unsupported state: you are in the middle of a rebase."}),(0,c.tZ)(h.xv,{multiline:!1,children:"Please finish the rebase manually."})]})}function oL(){return(0,c.BX)(R.G,{children:[(0,c.tZ)(h.xv,{multiline:!1,children:"Unsupported state: you are in the middle of a revert."}),(0,c.tZ)(h.xv,{multiline:!1,children:"Please finish the revert manually."})]})}var oM=(0,p.X)({container:[g.l0.colWithGap(16),g.l0.p(8),g.l0.pt(16)],fakePaneHeader:[g.l0.px(8),g.l0.py(4),g.l0.rowWithGap(8),g.l0.backgroundColor.backgroundDefault,g.l0.align.center,{borderBottom:"1px solid ".concat(g.TV.outlineDimmer)}]});function oX(e){var t=e.onFileClick,n=e.status;return(0,c.BX)(R.G,{children:[(0,c.tZ)(oF,{}),(0,c.BX)(R.G,{css:oM.container,children:[(0,c.tZ)(rC.E,{colorway:"orange",icon:(0,c.tZ)(n9.Z,{}),text:"Your current branch doesn't have any commits. You need to make an initial commit before continuing."}),(0,c.BX)(R.G,{css:oy.section,children:[(0,c.tZ)(R.G,{css:oy.reviewChangesHeader,children:(0,c.tZ)(h.xv,{css:oy.headerText,multiline:!1,children:"Commit"})}),(0,c.tZ)(iE,{status:n,onStagedFileClick:t,defaultMessage:"Initial commit"})]})]})]})}function oF(){var e,t=t4(),n=(0,tl.Z)((e=(0,to._)(function(e){var n;return(0,ta.Jh)(this,function(r){switch(r.label){case 0:return[4,e.status()];case 1:return(n=r.sent()).error&&(ts({context:"unborn-branch-view-status",gitService:e,result:n}),t(n.error)),[2,n]}})}),function(t){return e.apply(this,arguments)}),[t]);return(null==n?void 0:n.error)?null:(0,c.tZ)(R.G,{css:oM.fakePaneHeader,children:(null==n?void 0:n.branch)?(0,c.tZ)(nD,{name:n.branch,current:!0,heading:!0}):null})}function oW(e){var t=e.error;return(0,c.BX)(R.G,{children:[(0,c.tZ)(h.xv,{multiline:!1,children:"Failed to start the Git pane."}),(0,c.BX)(h.xv,{multiline:!1,children:["Error: ",t]})]})}var oH=function(e){var t,n=(0,tl.Z)((t=(0,to._)(function(t){var n,r,i;return(0,ta.Jh)(this,function(o){switch(o.label){case 0:return[4,t.isInitialized()];case 1:if((n=o.sent()).error)return[2,{error:n.error}];if(!n.initialized)return[2,{error:re.aq.NOT_INITIALIZED}];return[4,t.log({max:1,revRange:e})];case 2:if((r=o.sent()).error)return[2,{error:r.error}];if(0===r.commits.length)return[2,{error:re.aq.NO_COMMITS}];return[2,{commit:null!==(i=r.commits[0])&&void 0!==i?i:null,error:null}]}})}),function(e){return t.apply(this,arguments)}),[e]);return(0,w.useMemo)(function(){return n?n.error?{error:n.error}:n:null},[n])},oV=n(2158),oz=n(80339),oj=[{"& > span:first-child":[g.l0.flex.grow(1),g.l0.textAlign.left]},{"& > span":[g.l0.flex.shrink(1)]}],oq=(0,p.X)({container:[g.l0.colWithGap(16)],splitOrUnisonContainer:[g.l0.colWithGap(8),g.l0.display.flex,g.l0.flex.row,g.l0.flex.wrap,g.l0.align.center,g.l0.justify.spaceBetween],emphasizedText:[g.l0.fontWeight.medium],buttonFolded:[oj,g.l0.height("auto"),g.l0.py(8),g.l0.fontWeight.medium],buttonUnfolded:[oj,g.l0.height("auto"),g.l0.py(8),g.l0.fontWeight.medium,g.l0.borderRadius(8,8,0,0)],buttonGroupItem:[g.l0.width(64),g.l0.height(32)],textContainer:[g.l0.mt(8),g.l0.overflow("break-all")]}),oY=function(e){var t=e.children;return(0,c.tZ)(R.G,{css:oq.splitOrUnisonContainer,children:t})},o$=function(e){var t=e.value,n=e.onChange;return(0,c.BX)(eY.hE,{name:"SplitOrUnifiedDiff",value:t,onChange:n,row:!0,children:[(0,c.tZ)(R.G,{css:oq.buttonGroupItem,children:(0,c.tZ)(eY.rK,{value:"Unified",text:"Unified",id:"SplitOrUnifiedDiffUnified"})}),(0,c.tZ)(R.G,{css:oq.buttonGroupItem,children:(0,c.tZ)(eY.rK,{value:"Split",text:"Split",id:"SplitOrUnifiedDiffSplit"})})]})},oJ=function(e){var t=e.value,n=e.onChange;return(0,c.tZ)(d.hU,{alt:"Markdown"===t?"View Source":"View Markdown",onClick:function(){return n("Markdown"===t?"Source":"Markdown")},children:"Markdown"===t?(0,c.tZ)(oV.Z,{}):(0,c.tZ)(oz.Z,{})})},oK=function(e){var t=e.files,n=e.totalFiles;return t===n?(0,c.BX)(h.xv,{css:oq.textContainer,children:["Showing"," ",(0,c.BX)("span",{css:oq.emphasizedText,children:[n," changed ",(0,ed.Z)("file",n),"."]})]}):(0,c.BX)(h.xv,{css:oq.textContainer,children:["Showing"," ",(0,c.BX)("span",{css:oq.emphasizedText,children:[t," of ",n," changed ",(0,ed.Z)("file",n),"."]})]})},oQ=function(e){var t=e.query,n=e.setQuery,r=e.totalDiffs,i=e.diffs,o=e.splitOrUnified,a=e.setSplitOrUnified,l=e.folded,s=e.setFolded,u=(0,w.useMemo)(function(){return i.filter(function(e){var n="".concat(e.final.path,"/").concat(e.final.filename),r="".concat(e.initial.path,"/").concat(e.initial.filename);return n.toLowerCase().includes(t.toLowerCase())||r.toLowerCase().includes(t.toLowerCase())})},[t,i]);return(0,c.BX)(R.G,{css:oq.container,children:[(0,c.tZ)(ne.E,{value:t,onChange:function(e){n(e.target.value)},onClear:function(){n("")},loading:!1,placeholder:"Filter changed files"}),(0,c.BX)(oY,{children:[(0,c.tZ)(oK,{files:u.length,totalFiles:r}),i.length>0?(0,c.tZ)(o$,{value:o,onChange:function(e){return a(e)}}):null]}),u.map(function(e){var t;return(0,c.tZ)(tt,{folded:null===(t=l[e.id])||void 0===t||t,setFolded:function(t){return s(e.id,t)},diff:e,splitOrUnified:o},e.id)})]})},o0=(0,p.X)({metaContainer:[g.l0.rowWithGap(4),g.l0.align.center,g.l0.flex.wrap]}),o1=function(e){var t=e.author,n=e.committer,r=i5(n,t),i=i6(n.date,t.date);return(0,c.BX)(R.G,{css:o0.metaContainer,children:[r&&i?(0,c.BX)(c.HY,{children:[(0,c.tZ)(np,{name:t.name,email:t.email,color:"dimmer",allowPlaceholderAvatar:!0,small:!0}),(0,c.tZ)(h.xv,{variant:"small",children:"authored"}),(0,c.tZ)(nt.EK,{date:t.date,textColor:"dimmest",textVariant:"small"}),(0,c.tZ)(h.xv,{variant:"small",children:"and"})]}):null,r&&!i?(0,c.BX)(c.HY,{children:[(0,c.tZ)(np,{name:t.name,email:t.email,color:"dimmer",allowPlaceholderAvatar:!0,small:!0}),(0,c.tZ)(h.xv,{variant:"small",children:"authored"}),(0,c.tZ)(h.xv,{variant:"small",children:"and"})]}):null,(0,c.tZ)(np,{name:n.name,email:n.email,color:"dimmer",allowPlaceholderAvatar:!0,small:!0}),!r&&i?(0,c.BX)(c.HY,{children:[(0,c.tZ)(h.xv,{variant:"small",children:"authored "}),(0,c.tZ)(nt.EK,{date:t.date,textColor:"dimmest",textVariant:"small"}),(0,c.tZ)(h.xv,{variant:"small",children:"and "})]}):null,(0,c.tZ)(h.xv,{variant:"small",children:"committed"}),(0,c.tZ)(nt.EK,{date:n.date,textColor:"dimmest",textVariant:"small"})]})},o2=(0,p.X)({dullText:[g.l0.color.foregroundDimmest],tooltipContainer:[g.l0.display.inlineBlock]}),o8=function(e){var t=e.onViewCommitClick,n=e.hash;return(0,c.tZ)("span",{css:o2.tooltipContainer,children:(0,c.tZ)(tn.u,{tooltip:"View commit",children:(0,c.tZ)("button",{css:[g.l0.reset.button,g.l0.linkStyle,g.l0.fontWeight.medium],onClick:function(){return t(n)},children:n.slice(0,7)})})})},o4=function(e){var t=e.parents,n=e.grafted,r=e.onViewCommitClick;return(0,c.BX)(h.xv,{variant:"small",children:[(0,c.BX)("span",{css:o2.dullText,children:[n?"Grafted with ":null,t.length," ",(0,ed.Z)("parent",t.length)," "]}),0===t.length?null:t.map(function(e,n){return(0,c.BX)(w.Fragment,{children:[(0,c.tZ)(o8,{hash:e,onViewCommitClick:r}),n===t.length-1?"":(0,c.tZ)("span",{css:o2.dullText,children:", "})]},e)})]})},o3=function(e){var t=e.source,n=e.target;return(0,c.tZ)("span",{children:n?(0,c.BX)(c.HY,{children:["Branch ",(0,c.tZ)(nD,{name:t})," into ",(0,c.tZ)(nD,{name:n})," "]}):(0,c.BX)(c.HY,{children:["Branch ",(0,c.tZ)(nD,{name:t})]})})},o5=(0,p.X)({markerContainer:[g.l0.display.inlineFlex,g.l0.mr(4)]}),o6=function(e){var t=e.merge,n=e.revert,r=e.subject,i=e.onViewCommitClick;return(0,c.BX)(h.h4,{level:2,variant:"subheadDefault",multiline:!0,children:[t?(0,c.BX)(c.HY,{children:[(0,c.tZ)("span",{css:o5.markerContainer,children:(0,c.tZ)(iL,{type:"merge"})}),(0,c.tZ)(nS,{text:"merged"})," "]}):null,(null==t?void 0:t.type)==="pull-request"?(0,c.BX)(c.HY,{children:["PR ",(0,c.tZ)(nE,{id:t.id,hash:!0})," ",(null==n?void 0:n.pr)?(0,c.BX)(c.HY,{children:[(0,c.tZ)(n_,{text:"reverts"})," ",(0,c.tZ)(nE,{id:n.pr,hash:!0})]}):null," - "]}):null,(null==t?void 0:t.type)==="branch"?(0,c.BX)(c.HY,{children:[(0,c.tZ)(o3,{source:t.source,target:t.target})," -"," "]}):null,n&&!t?(0,c.BX)(c.HY,{children:[(0,c.tZ)("span",{css:o5.markerContainer,children:(0,c.tZ)(iL,{type:"revert"})}),(0,c.tZ)(n_,{text:"reverted"})," ",(0,c.tZ)("button",{css:[g.l0.reset.button,g.l0.linkStyle,g.l0.fontWeight.medium],onClick:function(){(null==n?void 0:n.hash)!==void 0&&i(n.hash)},children:n.hash.slice(0,7)})," - "]}):null,(0,c.tZ)(nT,{subject:r})]})},o9=n(55534),o7=function(e){var t,n=t4(),r=(0,tl.Z)((t=(0,to._)(function(t){var n,r,i,o,a,c;return(0,ta.Jh)(this,function(s){switch(s.label){case 0:return i=e.hash,[4,t.getFilesForCommit(i)];case 1:if(null==(o=s.sent())?void 0:o.error)return ts({context:"use-commit-diffs",gitService:t,result:o,data:{commit:e}}),[2,{error:o.error,diffs:[]}];return a=(null==o?void 0:null===(n=o.files)||void 0===n?void 0:n.filter(function(e){return["ADDED","MODIFIED","COPIED","RENAMED","TYPE_CHANGED"].includes(e.type)}))||[],c=(null==o?void 0:null===(r=o.files)||void 0===r?void 0:r.filter(function(e){return["DELETED","MODIFIED","COPIED","RENAMED","TYPE_CHANGED"].includes(e.type)}))||[],[2,{error:null,diffs:Array.from(new Set((0,l._)(a).concat((0,l._)(c)))).map(function(e){var t,n;return{id:(0,tR.v4)(),status:e.type,loading:!1,initial:{filename:(0,x.UO)(null!==(t=e.originalPath)&&void 0!==t?t:e.path),path:(0,x.Il)(null!==(n=e.originalPath)&&void 0!==n?n:e.path),content:""},final:{filename:(0,x.UO)(e.path),path:(0,x.Il)(e.path),content:""}}})}]}})}),function(e){return t.apply(this,arguments)}),[e]);return(0,w.useMemo)(function(){return r?r.error?(n(r.error),null):r:null},[n,r])},ae=(vc=(0,to._)(function(e,t,n,r){var i,o,a;return(0,ta.Jh)(this,function(l){switch(l.label){case 0:return i=""===t?n:"".concat(t,"/").concat(n),[4,e.getFileContents({path:i,revision:r})];case 1:if((o=l.sent()).error)throw o.error;return[2,null!==(a=null==o?void 0:o.content)&&void 0!==a?a:""]}})}),function(e,t,n,r){return vc.apply(this,arguments)}),at=(vs=(0,to._)(function(e,t,n){var r,i,o,a;return(0,ta.Jh)(this,function(l){switch(l.label){case 0:return i=t.hash,[4,ae(e,n.final.path,n.final.filename,i)];case 1:if(o=l.sent(),a="",!(!t.grafted&&(null===(r=t.parents)||void 0===r?void 0:r.length)))return[3,3];return[4,ae(e,n.initial.path,n.initial.filename,"".concat(i,"^"))];case 2:a=l.sent(),l.label=3;case 3:return[2,(0,P._)((0,A._)({},n),{loading:!1,initial:(0,P._)((0,A._)({},n.initial),{content:a}),final:(0,P._)((0,A._)({},n.final),{content:o})})]}})}),function(e,t,n){return vs.apply(this,arguments)}),an=(0,p.X)({content:[g.l0.colWithGap(16),g.l0.p(16)],splitContainer:[g.l0.display.flex,g.l0.flex.row,g.l0.flex.shrink(1),g.l0.flex.wrap,g.l0.justify.spaceBetween,g.l0.maxWidth("100%"),g.l0.border({color:g.TV.outlineDimmest,direction:"bottom"}),g.l0.pb(16)]}),ar=function(e){var t,n,r=e.git,i=e.commit,o=e.info,s=e.onViewCommitClick,u=void 0===s?function(){}:s,d=e.status,f=(0,w.useMemo)(function(){return(0,io.w)(d?d.changes.map(function(e){return e.path}):[])},[d]),p=(0,w.useMemo)(function(){if(!d)return[];var e=[],t=!0,n=!1,r=void 0;try{for(var i,o=d.changes[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;a.type.worktree!==eK.h.UNMODIFIED&&e.push(a)}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}return e},[d]),m=(0,o9.Z)().showConfirm,v=t4(),y=(0,a._)((0,w.useState)(!1),2),b=y[0],Z=y[1],x=(0,a._)((0,w.useState)(""),2),C=x[0],_=x[1],S=(0,a._)((0,w.useState)("Split"),2),E=S[0],k=S[1],T=(0,a._)((0,w.useState)("Markdown"),2),D=T[0],I=T[1],G=(0,a._)((0,w.useState)({}),2),B=G[0],N=G[1],U=(0,a._)((0,w.useState)([]),2),O=U[0],L=U[1],M=i8(i,o),X=M.hideBody,F=M.merge,W=M.revert,H=i.hash,V=i.subject,z=i.body,j=i.committer,q=i.author,Y=i.grafted,$=null!==(n=i.parents)&&void 0!==n?n:[],J=o7(i),K=(0,w.useCallback)((0,to._)(function(){var e,t,n,o=arguments;return(0,ta.Jh)(this,function(a){switch(a.label){case 0:return e=!(o.length>0)||void 0===o[0]||o[0],[4,r.restoreFiles(e,i.hash)];case 1:if((t=a.sent()).error)return[3,3];return[4,r.status()];case 2:return(n=a.sent()).error?(v(n.error),ts({context:"commit-view",gitService:r,result:n,data:{files:e,commit:i.hash}})):m("Restored commit!"),r.forceRefresh(),[3,4];case 3:v(t.error),ts({context:"commit-view",gitService:r,result:t,data:{files:e,commit:i.hash}}),a.label=4;case 4:return[2]}})}),[i.hash,r,v,m]),Q=r8(f),ee=Q.openRestoreConfirmationModal,et=Q.restoreConfirmationModal,en=(0,w.useCallback)((0,to._)(function(){var e,t,n,r=arguments;return(0,ta.Jh)(this,function(i){switch(i.label){case 0:if(!0!==(e=!(r.length>0)||void 0===r[0]||r[0]))return[3,6];if(Z(!0),0!==p.length)return[3,2];return[4,K()];case 1:return i.sent(),Z(!1),[2];case 2:return[4,ee(p)];case 3:if(!i.sent())return[3,5];return[4,K()];case 4:i.sent(),i.label=5;case 5:return Z(!1),[3,10];case 6:if("string"==typeof e){if(!(n=p.find(function(t){return t.path===e})))throw Z(!1),Error("Could not find file in worktree list");t=[n]}else t=p.filter(function(t){return e.includes(t.path)});return[4,ee(t)];case 7:if(!i.sent())return[3,9];return[4,K(e)];case 8:i.sent(),i.label=9;case 9:Z(!1),i.label=10;case 10:return[2]}})}),[ee,K,p]);(0,w.useEffect)(function(){var e;L(null!==(e=null==J?void 0:J.diffs.map(function(e){return(0,P._)((0,A._)({},e),{loading:!0})}))&&void 0!==e?e:[])},[J]),(0,w.useEffect)(function(){null!==J&&J.error&&v(J.error)},[J,v]);var er=(t=(0,to._)(function(e,t){var n,o,a;return(0,ta.Jh)(this,function(c){switch(c.label){case 0:if(N(function(n){var r=(0,A._)({},n);return r[e]=t,r}),!(n=O.find(function(t){return t.id===e})))return v(re.aq.INVALID_STATE),ts({context:"commit-view",gitService:r,result:{error:re.aq.INVALID_STATE},data:{diffId:e}}),[2];if(!(!t&&n.loading))return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),[4,at(r,i,n)];case 2:return o=c.sent(),L(function(t){var n=(0,l._)(t),r=n.findIndex(function(t){return t.id===e});return n[r]=o,n}),[3,4];case 3:return ts({context:"commit-view",gitService:r,result:a=c.sent(),data:{diffId:e}}),v(a),[2];case 4:return[2]}})}),function(e,n){return t.apply(this,arguments)});return(0,c.BX)(R.G,{css:an.content,children:[(0,c.tZ)(o6,{merge:F,revert:W,subject:V,onViewCommitClick:u}),(0,c.BX)(oY,{children:[(0,c.BX)(R.G,{css:[g.l0.rowWithGap(8),g.l0.align.start,g.l0.flex.shrink(1)],children:[(0,c.tZ)(i4,{hash:H}),(0,c.tZ)(i3,{onClick:function(){return en()},text:"Restore All",loading:b})]}),X?null:(0,c.tZ)(oJ,{value:D,onChange:function(e){I(e)}})]}),X?null:(0,c.tZ)(nR,{body:z,view:D}),(0,c.BX)(R.G,{css:an.splitContainer,children:[(0,c.tZ)(o1,{author:q,committer:j}),(0,c.tZ)(o4,{parents:$,grafted:Y,onViewCommitClick:u})]}),null!==F?(0,c.tZ)(h.xv,{variant:"small",color:"dimmest",children:"There is more than one parent, diffing against the first parent."}):null,null===J?(0,c.tZ)(og,{}):(0,c.tZ)(oQ,{query:C,setQuery:_,totalDiffs:J.diffs.length,diffs:O,splitOrUnified:E,setSplitOrUnified:k,folded:B,setFolded:er}),et]})};function ai(e){var t=e.hash,n=e.onViewCommitClick,r=e.switchMode,i=e.status,o=(0,y.Z)().git,a=t4(),l=oH(null!=t?t:"");if(null===l)return(0,c.tZ)(og,{});if(l.error)return l.error===re.aq.NOT_INITIALIZED?r({mode:vZ.CURRENT_BRANCH}):(a(l.error),(l.error===re.aq.UNKNOWN||l.error===re.aq.UNKNOWN_NOT_GIT)&&ts({context:"commit-view",gitService:o,result:l,data:{hash:t}})),null;if(null===l.commit)return a(re.aq.UNKNOWN),null;var s=l.commit,u=iP(s)||iD(s);return(0,c.tZ)(ar,{git:o,commit:s,info:u,onViewCommitClick:n,status:i})}var ao=n(42960),aa=(0,p.X)({container:[g.l0.colWithGap(4)],file:[g.l0.rowWithGap(8),g.l0.align.center],fileLeft:[g.l0.rowWithGap(8),g.l0.flex.grow(1),g.l0.align.center],filePrefix:[g.l0.color.foregroundDimmest]});function al(e){var t=e.files,n=e.uniquePathMap,r=e.onFileClick,i=[];if(t instanceof Map){var o=!0,l=!1,s=void 0;try{for(var u,d=t[Symbol.iterator]();!(o=(u=d.next()).done);o=!0){var p=(0,a._)(u.value,2),m=p[0],v=p[1],y=n.get(m);i.push({path:m,prefix:y,resolved:v})}}catch(e){l=!0,s=e}finally{try{o||null==d.return||d.return()}finally{if(l)throw s}}}else{var b=!0,Z=!1,w=void 0;try{for(var x,C=t[Symbol.iterator]();!(b=(x=C.next()).done);b=!0){var _=x.value,S=n.get(_);i.push({path:_,prefix:S,resolved:!0})}}catch(e){Z=!0,w=e}finally{try{b||null==C.return||C.return()}finally{if(Z)throw w}}}return(0,c.tZ)(R.G,{css:aa.container,children:i.map(function(e){var t=e.path,n=e.prefix,i=e.resolved;return(0,c.BX)(R.G,{css:aa.file,children:[(0,c.BX)(R.G,{css:aa.fileLeft,children:[(0,c.tZ)(f.Z,{path:t}),(0,c.tZ)(h.xv,{multiline:!1,children:(0,c.tZ)(nI,{path:t,prefix:n,onClick:function(){return r(t)}})})]}),i?(0,c.tZ)(rr.Z,{color:g.TV.greenStronger}):(0,c.tZ)(n9.Z,{color:g.TV.orangeStronger})]},t)})})}function ac(e){var t=e.hasConflicts?(0,c.BX)(c.HY,{children:[(0,c.tZ)("span",{css:g.l0.fontWeight.medium,children:"Resolve all conflicts to complete merge."}),(0,c.tZ)("br",{}),(0,c.tZ)("span",{children:"You can't do anything else until the merge has been completed or aborted."})]}):(0,c.BX)(c.HY,{children:[(0,c.tZ)("span",{css:g.l0.fontWeight.medium,children:"You are in the middle of a merge."}),(0,c.tZ)("br",{}),(0,c.tZ)("span",{children:"You can't do anything else until the merge has been completed or aborted. You have no conflicts to resolve, so the merge can be completed without any further action."})]});return(0,c.tZ)(rC.E,{colorway:"warning",icon:(0,c.tZ)(n9.Z,{}),text:t})}var as=(0,p.X)({container:[g.l0.rowWithGap(4),g.l0.align.center,g.l0.justify.spaceBetween],left:[{flexBasis:0,flexGrow:1},g.l0.colWithGap(8)],right:{flexBasis:0,flexGrow:1},branch:[g.l0.p(8),g.l0.rowWithGap(4),g.l0.flex.grow(1),g.l0.center,g.l0.borderRadius(8)]});function au(e){var t,n=e.branch,r=e.refs,i=e.refsAreBranches,o=e.isUpstreamPull;if(!r.length)return null;if(o){var l=(0,a._)((0,rc.Tg)(r[0]),2),s=l[0],u=l[1];s&&u&&(t=(0,c.tZ)(M.Tg,{css:as.branch,elevated:!0,children:(0,c.tZ)(nD,{remote:s,name:u,icon:!0,heading:!0})}))}return t||(t=r.map(function(e){return(0,c.tZ)(M.Tg,{css:as.branch,elevated:!0,children:(0,c.tZ)(nD,{name:e,icon:!!i||(0,c.tZ)(tr.Z,{size:16}),heading:!0})},e)})),(0,c.BX)(R.G,{css:as.container,children:[(0,c.tZ)(R.G,{css:as.left,children:t}),(0,c.tZ)(X.Z,{size:24,color:g.TV.foregroundDimmest}),(0,c.tZ)(R.G,{css:as.right,children:(0,c.tZ)(M.Tg,{css:as.branch,elevated:!0,children:(0,c.tZ)(nD,{name:n,icon:!0,current:!0,heading:!0})})})]})}var ad=(0,p.X)({container:[g.l0.colWithGap(12),g.l0.pt(16),g.l0.pb(8),g.l0.px(8)],fakePaneHeader:[g.l0.p(8),g.l0.rowWithGap(8),g.l0.backgroundColor.backgroundDefault,g.l0.align.center,{borderBottom:"1px solid ".concat(g.TV.outlineDimmer)}],conflictResolution:[g.l0.colWithGap(16)],listContainer:[g.l0.p(8),g.l0.colWithGap(8),g.l0.borderRadius(8)],list:[g.l0.pb(8),g.l0.colWithGap(8)],listDisabled:[{opacity:.5},g.l0.pb(8),g.l0.colWithGap(8)],listHeader:[g.l0.pb(4),g.l0.flex.grow(1),g.l0.border({color:g.TV.outlineDimmer,direction:"bottom"})],listFiles:[g.l0.px(8)],includeOtherFiles:[{cursor:"pointer",maxWidth:"max-content",userSelect:"none"},g.l0.rowWithGap(8)],buttons:[g.l0.colWithGap(8)]});function af(e){var t,n=e.onFileClick,r=e.gotoPendingState,i=(0,a._)((0,w.useState)(!0),2),o=i[0],s=i[1],u=(0,a._)((0,w.useState)(!1),2),d=u[0],f=u[1],p=(0,a._)((0,w.useState)(!1),2),m=p[0],b=p[1],Z=d||m,x=t4(),C=(0,y.Z)().git,_=(0,w.useId)(),S=(0,tl.Z)((t=(0,to._)(function(e){var t,n,r,i,o,l,c,s,u,d,f,h,p,m,v,g,y,b,Z,w;return(0,ta.Jh)(this,function(x){switch(x.label){case 0:return[4,e.status()];case 1:if((t=x.sent()).error)return ts({context:"use-merging-view-state-status",gitService:e,result:t}),[2,t];if(!(n=t.branch))return[2,{error:re.aq.HEAD_DETACHED}];return[4,e.getConflictingFiles()];case 2:if((r=x.sent()).error)return[2,r];return i=r.files,[4,e.getMergingRefs()];case 3:if((o=x.sent()).error)return ts({context:"use-merging-view-state-merging-refs",gitService:e,result:o,data:{status:t,conflictingFiles:i}}),[2,o];l=o.commits,u=(s=(c=o.branches).length>0)?c:l,d=t.changes.filter(function(e){return!e.unmerged}).map(function(e){return e.path}),f=!0,h=!0,p=!1,m=void 0;try{for(v=i[Symbol.iterator]();!(h=(g=v.next()).done);h=!0)if(!(0,a._)(g.value,2)[1]){f=!1;break}}catch(e){p=!0,m=e}finally{try{h||null==v.return||v.return()}finally{if(p)throw m}}return y=(0,io.w)(t.changes.map(function(e){return e.path})),b=i.size>0,Z=d.length>0,w=null!==t.upstream&&1===c.length&&c[0]===t.upstream.branch,[2,{refs:u,branch:n,conflictingFiles:i,otherChangedFiles:d,refsAreBranches:s,allIsResolved:f,uniquePathMap:y,hasConflicts:b,hasOtherChanges:Z,isUpstreamPull:w,error:null}]}})}),function(e){return t.apply(this,arguments)}));if((0,w.useEffect)(function(){(null==S?void 0:S.error)&&x(S.error)},[null==S?void 0:S.error,x]),!S)return(0,c.tZ)(og,{});if(S.error)return null;var E=S.refs,k=S.branch,T=S.conflictingFiles,D=S.otherChangedFiles,I=S.refsAreBranches,G=S.allIsResolved,B=S.uniquePathMap,A=S.hasConflicts,P=S.hasOtherChanges,N=S.isUpstreamPull;function U(){return(U=(0,to._)(function(){var e,t,n,i,a,c,s,u,d,h,p;return(0,ta.Jh)(this,function(m){switch(m.label){case 0:if(!G||Z)return[2];f(!0),e=[],t=!0,n=!1,i=void 0;try{for(a=T.keys()[Symbol.iterator]();!(t=(c=a.next()).done);t=!0)s=c.value,e.push(s)}catch(e){n=!0,i=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw i}}return o&&(u=e).push.apply(u,(0,l._)(D)),[4,C.stageFiles({all:!1})];case 1:if((d=m.sent()).error)return x(d.error),f(!1),[2];return[4,C.stageFiles({add:e})];case 2:if((h=m.sent()).error)return x(h.error),f(!1),[2];return[4,C.mergeContinue()];case 3:if(!(p=m.sent()).error)return[3,5];return[4,C.stageFiles({all:!1})];case 4:return m.sent(),x(p.error),f(!1),[3,6];case 5:r(),C.forceRefresh(),m.label=6;case 6:return[2]}})})).apply(this,arguments)}function O(){return(O=(0,to._)(function(){var e;return(0,ta.Jh)(this,function(t){switch(t.label){case 0:if(Z)return[2];return b(!0),[4,C.mergeAbort()];case 1:return(e=t.sent()).error?(x(e.error),b(!1),ts({context:"merging-view-abort",gitService:C,result:e,data:{branch:k}})):(r(),C.forceRefresh()),[2]}})})).apply(this,arguments)}var X=N?"Complete in-progress pull":"Complete in-progress merge";return A&&(X=N?"Resolve pull conflicts":"Resolve merge conflicts"),(0,c.BX)(R.G,{children:[(0,c.BX)(R.G,{css:ad.fakePaneHeader,children:[(0,c.tZ)(ao.Z,{}),(0,c.tZ)(h.xv,{variant:"subheadDefault",multiline:!1,children:X})]}),(0,c.BX)(R.G,{css:ad.container,children:[(0,c.tZ)(au,{branch:k,refs:E,refsAreBranches:I,isUpstreamPull:N}),(0,c.tZ)(ac,{hasConflicts:A}),(0,c.BX)(M.Tg,{css:ad.listContainer,elevated:!0,children:[(0,c.BX)(R.G,{css:ad.list,children:[(0,c.tZ)(R.G,{css:ad.listHeader,children:(0,c.tZ)(h.xv,{css:g.l0.fontWeight.medium,multiline:!1,children:"Conflicting Files"})}),(0,c.tZ)(R.G,{css:ad.listFiles,children:A?(0,c.tZ)(al,{files:T,uniquePathMap:B,onFileClick:n}):(0,c.tZ)(h.xv,{variant:"small",color:"dimmest",multiline:!1,children:"There are no conflicting files in this merge."})})]}),P?(0,c.BX)(R.G,{css:o?ad.list:ad.listDisabled,children:[(0,c.tZ)(R.G,{css:ad.listHeader,children:(0,c.tZ)(h.xv,{css:g.l0.fontWeight.medium,multiline:!1,children:"Other Changed Files"})}),(0,c.tZ)(R.G,{css:ad.listFiles,children:(0,c.tZ)(al,{files:D,uniquePathMap:B,onFileClick:n})})]}):null]}),(0,c.BX)(R.G,{css:ad.includeOtherFiles,tag:"label",children:[(0,c.tZ)(oB.X,{id:_,checked:o,onChange:function(e){return s(e.target.checked)}}),(0,c.tZ)(h.xv,{multiline:!1,children:"Include other changed files in commit"})]}),(0,c.BX)(R.G,{css:ad.buttons,children:[(0,c.tZ)(L.zx,{text:N?"Complete pull":"Complete merge and commit",colorway:"primary",iconLeft:d?(0,c.tZ)(v.Z,{}):(0,c.tZ)(ao.Z,{}),disabled:!G||Z,loading:d,onClick:function(){return U.apply(this,arguments)}}),(0,c.tZ)(L.zx,{text:N?"Abort pull":"Abort merge",colorway:"negative",iconLeft:m?(0,c.tZ)(v.Z,{}):(0,c.tZ)(rY.Z,{}),disabled:Z,loading:m,onClick:function(){return O.apply(this,arguments)}})]})]})]})}var ah=n(56050),ap=n(2038),am=n(85195),av=n(47611),ag=(0,p.X)({gitProfileTitle:[g.l0.rowWithGap(8),g.l0.align.center]});function ay(e){var t=e.username,n=e.avatar;return(0,c.BX)(R.G,{css:ag.gitProfileTitle,children:[(0,c.tZ)(no.q,{src:null!=n?n:"/images/evalbot/evalbot_24",username:t}),(0,c.tZ)(h.xv,{variant:"subheadDefault",multiline:!1,children:t})]})}var ab=(0,p.X)({list:{"> div:first-child":g.l0.borderRadius(8,8,0,0),"> div:last-child":[g.l0.borderRadius(0,0,8,8),{border:"none"}]},profile:[t9.gU.filled,g.l0.flex.row,g.l0.justify.spaceBetween,g.l0.p(12),g.l0.borderRadius(0),g.l0.border({color:g.TV.outlineDefault,direction:"bottom"})],information:[g.l0.colWithGap(4),g.l0.flex.shrink(1)],informationRow:[g.l0.rowWithGap(8),g.l0.align.center],email:[g.l0.flex.shrink(1)],connectToGithubContainer:[g.l0.colWithGap(4),g.l0.p(12),g.l0.backgroundColor.backgroundHigher],divider:[g.l0.backgroundColor.outlineDefault],connectToGitHubTitle:[g.l0.rowWithGap(4),g.l0.align.center],notConnectedText:[g.l0.pb(4)],settingsButton:{background:"transparent",border:"none","&:hover":{textDecoration:"underline"}},radio:{pointerEvents:"none"}});function aZ(e){var t=e.profiles,n=e.current,r=e.showConnectToGithub,i=e.onSelectProvider,o=(0,av.useRouter)(),a=(0,ap.Vg)(o),l=(0,w.useId)();return(0,c.BX)(am.E,{name:l,css:ab.list,value:null!=n?n:"",children:[t.map(function(e){t=e.provider===re.rG.GITHUB?"GitHub":"Default Profile";var t,r=void 0;return e.provider===re.rG.GITHUB&&(r=a?"/mobile/auth/github/app_permissions":"/auth/github/app_permissions?close=1"),(0,c.tZ)(aw,{profile:e,providerName:t,current:e.provider===n,onSelectProvider:i,settingsURL:r},e.provider)}),r?(0,c.BX)(R.G,{css:ab.connectToGithubContainer,children:[(0,c.tZ)(R.G,{css:ab.connectToGitHubTitle,children:(0,c.tZ)(ay,{username:"GitHub Account"})}),(0,c.tZ)(h.xv,{color:"dimmest",css:ab.notConnectedText,multiline:!1,children:"Your GitHub account is not connected."}),(0,c.tZ)(rl,{})]}):null]})}function aw(e){var t=e.profile,n=e.current,r=e.providerName,i=e.settingsURL,o=e.onSelectProvider,a=t.provider,l=t.username,s=t.email,u=t.avatar,d=(0,w.useId)();return(0,c.BX)(R.G,{onClick:function(){return o(a)},css:ab.profile,children:[(0,c.BX)(R.G,{css:ab.information,children:[(0,c.BX)(R.G,{css:ab.informationRow,children:[(0,c.tZ)(ay,{username:l,avatar:u}),i?(0,c.tZ)(rT.Z,{css:ab.settingsButton,text:"".concat(r," Settings"),iconRight:(0,c.tZ)(rR.Z,{}),href:i,target:"_blank",variant:"outlined",size:"small"}):(0,c.tZ)(h.xv,{color:"dimmest",variant:"small",multiline:!1,children:r})]}),(0,c.tZ)(h.xv,{color:"dimmest",css:ab.email,multiline:!1,children:s})]}),(0,c.tZ)(am.Y,{css:ab.radio,id:d,checked:n,value:a})]})}var ax=(0,p.X)({profileContainer:[g.l0.flex.column]});function aC(){var e,t=(0,y.Z)().git,n=(0,tl.Z)((e=(0,to._)(function(e){var t,n;return(0,ta.Jh)(this,function(r){return t=e.getCurrentProfile(),[2,{profiles:e.getProfiles(),current:null!==(n=null==t?void 0:t.provider)&&void 0!==n?n:null,hasGitHub:!e.hasProfile(re.rG.GITHUB),error:null}]})}),function(t){return e.apply(this,arguments)}));if(!n)return null;if(null!==n.error)return ts({context:"git-profiles",gitService:t,result:{error:n.error}}),null;var r=n.profiles,i=n.current,o=n.hasGitHub;return(0,c.tZ)(R.G,{css:ax.profileContainer,children:(0,c.tZ)(aZ,{profiles:r,current:i,showConnectToGithub:o,onSelectProvider:function(e){t.setCurrentProfile(e),e===re.rG.REPLIT_DEFAULT?ny("profile-changed",{profile:"replit"}):e===re.rG.GITHUB&&ny("profile-changed",{profile:"github"})}})})}var a_=n(39390),aS=n(10981),aE=n(75582),ak=n(99165);function aT(){var e=(0,ey._)(["\n  query GithubRemoteConfigRepl($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        description\n        isPrivate\n        slug\n        url\n      }\n    }\n  }\n"]);return aT=function(){return e},e}function aR(){var e=(0,ey._)(['\n  query GithubRemoteConfigUser {\n    currentUser {\n      ... on CurrentUser {\n        id\n        gitHubInfo {\n          accessToken\n        }\n        repositories(count: 1, after: "0") {\n          ... on RepositoryConnection {\n            items {\n              id\n            }\n          }\n        }\n      }\n    }\n  }\n']);return aR=function(){return e},e}function aD(){var e=(0,ey._)(["\n  mutation GithubRemoteConfigCreateGithubRepo($input: CreateGithubRepoInput!) {\n    createGithubRepo(input: $input) {\n      ... on CreateGithubRepoResult {\n        remoteUrl\n      }\n      ... on UnauthorizedError {\n        message\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n"]);return aD=function(){return e},e}var aI={},aG=(0,eb.Ps)(aT());aR();var aB=(0,eb.Ps)(aD()),aA=(0,p.X)({errorText:[g.l0.color.accentNegativeStronger,g.l0.pl(4)]});function aP(e){var t,n,r,i,o=e.remoteName,l=e.updateRemote,s=(0,o9.Z)().showConfirm,u=(0,y.Z)().git,d=(0,tx.Z)(),f=ro(),p=(0,aS.U)(),m=(0,eg.Z)(),v=(0,w.useRef)(null),b=(0,w.useRef)(null),Z=(0,a._)((0,w.useState)(),2),x=Z[0],C=Z[1],_=(t=(0,A._)({},aI,{variables:{replId:m}}),eZ.a(aG,t)).data,S=(null==_?void 0:_.repl.__typename)==="Repl"?_.repl:{slug:void 0,description:void 0,isPrivate:void 0,url:void 0},E=S.slug,k=S.description,T=S.isPrivate,D=S.url,I=(0,a._)((n=(0,A._)({},aI,void 0),ak.D(aB,n)),2),G=I[0],B=I[1].loading,P=(0,rn.v)({onAuth:function(){ny("github-user-connected")}}),N=(0,a._)((0,w.useState)(null==T||T),2),O=N[0],M=N[1],X=(0,a._)((0,w.useState)(E),2),F=X[0],W=X[1],H=(0,a._)((0,w.useState)(),2),V=H[0],z=H[1],j=(0,a._)((0,w.useState)(null!=k?k:D&&"Repository for https://replit.com".concat(D)),2),q=j[0],Y=j[1],$=(0,a._)((0,w.useState)(),2),J=$[0],K=$[1],Q=function(){z(void 0),K(void 0),C(void 0)},ee=(r=(0,to._)(function(e){var t,n,r;return(0,ta.Jh)(this,function(i){switch(i.label){case 0:return[4,u.getRemotes()];case 1:if((t=i.sent()).error)return C("Error finding current remotes, ".concat(t.error)),[2];if(!t.remotes.has(o))return[3,3];return[4,u.setRemoteURL({remote:o,url:e})];case 2:if((n=i.sent()).error)return C("Error (".concat(n.error,") setting ").concat(o," to use ").concat(e," as a remote.")),[2];return l(e),ny("remote-edited"),[2];case 3:return[4,u.addRemote({name:o,url:e})];case 4:if((r=i.sent()).error)return C("Error (".concat(r.error,") adding ").concat(o," ").concat(e," as a remote.")),[2];return l(e),ny("remote-added"),[2]}})}),function(e){return r.apply(this,arguments)}),et=(i=(0,to._)(function(){var e,t,n,r;return(0,ta.Jh)(this,function(i){switch(i.label){case 0:if(Q(),!F)return[2];if(!(0,nr.GE)(F))return z("Invalid remote name."),[2];return[4,G({variables:{input:{name:F,description:null!=k?k:null,homepage:"replit.com".concat(D),isPrivate:O,ownerType:aE.xJ.User}}})];case 1:if((null===(e=(r=i.sent()).data)||void 0===e?void 0:e.createGithubRepo.__typename)==="UnauthorizedError"||(null===(t=r.data)||void 0===t?void 0:t.createGithubRepo.__typename)==="UserError")return C(r.data.createGithubRepo.message),[2];return(null===(n=r.data)||void 0===n?void 0:n.createGithubRepo.__typename)==="CreateGithubRepoResult"&&(ee(r.data.createGithubRepo.remoteUrl),ny("github-repository-published"),s("Created repository on Github")),[2]}})}),function(){return i.apply(this,arguments)});return f?(0,c.BX)(R.G,{children:[(0,c.tZ)(h.xv,{color:"dimmest",multiline:!1,children:"Repository name"}),(0,c.tZ)(U.II,{ref:v,placeholder:"Enter repository name",value:F,onChange:function(e){z(void 0),W(e.target.value)},onKeyDown:function(e){if("Enter"===e.key){var t;e.preventDefault(),null===(t=b.current)||void 0===t||t.focus()}}}),(0,c.tZ)(h.xv,{css:aA.errorText,multiline:!1,children:V}),(0,c.tZ)(ah.Z,{height:1}),(0,c.tZ)(h.xv,{color:"dimmest",multiline:!1,children:"Repository description"}),(0,c.tZ)(U.B,{ref:b,maxLength:350,name:"Repository description",placeholder:"Enter repository description",value:null!=q?q:void 0,onChange:function(e){K(void 0),Y(e.target.value)}}),(0,c.tZ)(h.xv,{css:aA.errorText,multiline:!1,children:J}),(0,c.tZ)(ah.Z,{height:1}),(0,c.tZ)(h.xv,{color:"dimmest",multiline:!1,children:"Privacy"}),(0,c.BX)(eY.hE,{tag:"fieldset",id:p("privacy"),name:p("privacy"),value:O,onChange:function(e){return M(e)},row:!0,css:[g.l0.width("100%")],children:[(0,c.tZ)(eY.rK,{id:p("false"),value:!1,text:"Public",icon:(0,c.tZ)(a_.Z,{})}),(0,c.tZ)(eY.rK,{id:p("true"),value:!0,text:"Private",icon:(0,c.tZ)(tW.Z,{})})]}),(0,c.tZ)(ah.Z,{height:2}),(0,c.tZ)(L.zx,{text:B?"Creating Repository on GitHub":"Create Repository on GitHub",colorway:"primary",iconLeft:(0,c.tZ)(ri.Z,{}),onClick:et,loading:B}),x?(0,c.tZ)(h.xv,{css:aA.errorText,maxLines:2,multiline:!1,children:x}):null]}):d?(0,c.tZ)(R.G,{children:(0,c.tZ)(L.zx,{colorway:"primary",iconLeft:(0,c.tZ)(ri.Z,{}),text:"Open Account page to connect to GitHub",onClick:function(){rt.X.openExternalUrl("/account#connected-services")}})}):(0,c.tZ)(R.G,{children:(0,c.tZ)(L.zx,{colorway:"primary",iconLeft:(0,c.tZ)(ri.Z,{}),text:"Connect to GitHub",onClick:P})})}var aN=(0,eu.iv)(g.l0.border({width:1,color:g.TV.outlineDimmer}),g.l0.borderRadius(8)),aU=(0,eu.iv)(t9.gU.filled,g.l0.flex.row,g.l0.justify.spaceBetween,g.l0.align.center,g.l0.px(8),g.l0.py(4),g.l0.borderRadius(8,8,0,0)),aO=(0,eu.iv)(g.l0.borderRadius(8,8,0,0)),aL=(0,eu.iv)(g.l0.borderRadius(8)),aM=(0,eu.iv)(g.l0.p(8)),aX=(0,eu.iv)(g.l0.flex.growAndShrink(1));function aF(e){var t=e.title,n=e.expanded,r=e.content,i=e.onClick;return(0,c.BX)(R.G,{css:aN,children:[(0,c.BX)(R.G,{css:[aU,n?aO:aL],onClick:i,children:[(0,c.tZ)(R.G,{css:aX,children:(0,c.tZ)(h.xv,{variant:"subheadDefault",multiline:!1,children:t})}),n?(0,c.tZ)(eJ.Z,{size:20}):(0,c.tZ)(e$.Z,{size:20})]}),n?(0,c.tZ)(R.G,{css:aM,children:r}):null]})}var aW=(0,eu.iv)(g.l0.rowWithGap(4)),aH=(0,eu.iv)(g.l0.flex.growAndShrink(1)),aV=(0,eu.iv)(g.l0.color.accentNegativeStronger,g.l0.pl(4));function az(e){var t,n=e.initialRemoteUrl,r=e.remoteName,i=e.updateRemote,o=(0,y.Z)().git,l=(0,a._)((0,w.useState)(),2),s=l[0],u=l[1];(0,w.useEffect)(function(){u(void 0)},[n]);var d=(0,a._)((0,w.useState)(),2),f=d[0],p=d[1],m=(0,a._)((0,w.useState)(!1),2),v=m[0],g=m[1],b=(t=(0,to._)(function(){var e,t,n;return(0,ta.Jh)(this,function(a){switch(a.label){case 0:if(a.trys.push([0,5,6,7]),!s)return[2];if(g(!0),!(0,nr.LY)(s))throw Error("Invalid remote url.");return[4,o.getRemotes()];case 1:if((e=a.sent()).error)throw Error("Error finding current remotes, ".concat(e.error));if(!e.remotes.has(r))return[3,3];return[4,o.setRemoteURL({remote:r,url:s})];case 2:if((t=a.sent()).error)throw ts({context:"remote-input",gitService:o,result:t,data:{remote:r,url:s}}),Error("Error (".concat(t.error,") setting ").concat(r," to use ").concat(s," as a remote."));return ny("remote-edited"),i(s),[2];case 3:return[4,o.addRemote({name:r,url:s})];case 4:if((n=a.sent()).error)throw ts({context:"remote-input",gitService:o,result:n,data:{remote:r,url:s}}),Error("Error (".concat(n.error,") adding ").concat(r," ").concat(s," as a remote."));return ny("remote-added"),[3,7];case 5:return p(a.sent().message),[3,7];case 6:return g(!1),[7];case 7:return[2]}})}),function(){return t.apply(this,arguments)});return(0,c.BX)(R.G,{children:[(0,c.tZ)(U.II,{name:"Remote URL",placeholder:"Enter Remote URL",value:null!=s?s:n,autoComplete:"off",autoCorrect:"off",onChange:function(e){p(void 0),u(e.target.value)},inputMode:"url","aria-label":"Remote URL",onKeyDown:function(e){"Enter"===e.key&&b()}}),f?(0,c.tZ)(h.xv,{variant:"small",css:aV,multiline:!1,children:f}):null,s&&s!==n?(0,c.BX)(c.HY,{children:[(0,c.tZ)(ah.Z,{height:1}),(0,c.BX)(R.G,{css:aW,children:[(0,c.tZ)(L.zx,{css:aH,text:"Cancel",iconLeft:(0,c.tZ)(n7.Z,{}),onClick:function(){return u(void 0)}}),(0,c.tZ)(L.zx,{css:aH,text:v?"Saving":"Save",loading:v,colorway:"primary",iconLeft:(0,c.tZ)(rr.Z,{}),onClick:b})]})]}):null]})}var aj="origin";function aq(){var e,t=(0,tl.Z)((e=(0,to._)(function(e){var t,n,r,i;return(0,ta.Jh)(this,function(o){switch(o.label){case 0:return[4,e.getRemotes()];case 1:if((t=o.sent()).error)return ts({context:"remote-config",gitService:e,result:t}),[2,{url:void 0,name:aj,error:t.error}];if(!(r=(0,a._)(null!==(n=t.remotes.values())&&void 0!==n?n:void 0,1)[0]))return[2,{url:void 0,name:aj,error:null}];return[2,{url:r.push||r.fetch,name:null!==(i=r.name)&&void 0!==i?i:aj,error:null}]}})}),function(t){return e.apply(this,arguments)}));return null==t?(0,c.BX)(R.G,{css:g.l0.center,children:[(0,c.tZ)(h.xv,{color:"dimmest",multiline:!1,children:"Loading remote information."}),(0,c.tZ)(og,{})]}):(null==t?void 0:t.error)?null:(0,c.tZ)(aY,{initialRemoteUrl:null==t?void 0:t.url,remoteName:null==t?void 0:t.name})}function aY(e){var t=e.initialRemoteUrl,n=e.remoteName,r=(0,a._)((0,w.useState)(t),2),i=r[0],o=r[1],l=(0,a._)((0,w.useState)(""===t||void 0===t?0:void 0),2),s=l[0],u=l[1],d=function(e){o(e)};return(0,c.BX)(R.G,{children:[(0,c.tZ)(h.xv,{variant:"subheadDefault",multiline:!1,children:"Remote"}),(0,c.tZ)(ah.Z,{height:1}),(0,c.tZ)(az,{remoteName:n,initialRemoteUrl:i,updateRemote:d}),(0,c.tZ)(ah.Z,{height:2}),(0,c.tZ)(aF,{title:"GitHub",expanded:0===s,onClick:function(){return u(function(e){return 0===e?void 0:0})},content:(0,c.tZ)(aP,{remoteName:n,updateRemote:d})})]})}(vu=vw||(vw={}))[vu.GitHub=0]="GitHub";var a$=(0,eu.iv)(g.l0.px(16));function aJ(){return(0,c.BX)(R.G,{css:a$,children:[(0,c.tZ)(ah.Z,{height:2}),(0,c.tZ)(aq,{}),(0,c.tZ)(ah.Z,{height:2}),(0,c.tZ)(aK,{})]})}function aK(){return(0,c.BX)(R.G,{children:[(0,c.tZ)(h.xv,{variant:"subheadDefault",multiline:!1,children:"Commit author"}),(0,c.tZ)(ah.Z,{height:1}),(0,c.tZ)(aC,{})]})}var aQ=(0,p.X)({gitPane:[g.l0.position.relative,g.l0.display.flex,g.l0.minHeight("100%")],gitPaneContent:[g.l0.flex.growAndShrink(1),g.l0.overflow("auto")]});function a0(e){var t,n,r,i=e.isActive,o=e.performPaneOperation,l=(0,tY.P5)({controlName:"flag-git-commit-view",logFlagToAnalytics:!1}),s=(0,w.useRef)(),u=(0,a._)((0,w.useState)(vZ.CURRENT_BRANCH),2),d=u[0],f=u[1],h=(0,a._)((0,w.useState)(null),2),p=h[0],m=h[1],v=(0,a._)((0,w.useState)(null),2),g=v[0],b=v[1],Z=(0,a._)((0,w.useState)(!1),2),x=Z[0],C=Z[1];t=void 0!==i&&i,n=(0,y.Z)().git,(0,w.useEffect)(function(){t&&n.forceRefresh()},[t,n]);var _=(0,tl.Z)((r=(0,to._)(function(e){var t,n,r,i,o,a,l,c,s,u;return(0,ta.Jh)(this,function(d){switch(d.label){case 0:return[4,e.getRepositoryState()];case 1:if((t=d.sent()).error)return[2,t];if(n=t.state,r=t.type,i=null,o=null,a=null,!(r!==t$.y5.INITIALIZING))return[3,6];return[4,e.status()];case 2:if((l=d.sent()).error)return ts({context:"git-pane-status",gitService:e,result:l,data:{state:n,type:r}}),[2,l];return i=l,[4,e.getRemotes()];case 3:if((c=d.sent()).error)return ts({context:"git-pane-remotes",gitService:e,result:c,data:{state:n,type:r}}),[2,c];if(o=c.remotes,!i.branch)return[3,5];return[4,e.getBranch(i.branch)];case 4:if((s=d.sent()).error)return ts({context:"git-pane-branch",gitService:e,result:s,data:{state:n,type:r}}),[2,s];a=s.branch,d.label=5;case 5:return[3,8];case 6:return[4,e.status()];case 7:if((u=d.sent()).error)return ts({context:"git-pane-status-initializing",gitService:e,result:u,data:{state:n,type:r}}),[2,{state:n,type:r,status:i,remotes:o,currentBranch:a,error:null}];i=u,d.label=8;case 8:return[2,{state:n,type:r,status:i,remotes:o,currentBranch:a,error:null}]}})}),function(e){return r.apply(this,arguments)})),S=!_||_.error?null:_.currentBranch,E=(0,w.useCallback)(function(e){switch(f(e),e){case vZ.DASHBOARD:ny("pane-mode-changed",{mode:"dashboard"});break;case vZ.BRANCH:ny("pane-mode-changed",{mode:"branch"});break;case vZ.CURRENT_BRANCH:ny("pane-mode-changed",{mode:"current-branch"});break;case vZ.SETTINGS:ny("pane-mode-changed",{mode:"settings"})}},[]),k=(0,w.useCallback)(function(){s.current?(E(s.current),s.current=void 0):E(vZ.CURRENT_BRANCH)},[E]),T=(0,w.useCallback)(function(e){var t=function(e){s.current=d,E(e)};switch(e.mode){case vZ.DASHBOARD:t(vZ.DASHBOARD);break;case vZ.BRANCH:if((0,tJ.p3)(e.branch,S)){t(vZ.CURRENT_BRANCH);break}b(e.branch),t(vZ.BRANCH);break;case vZ.CURRENT_BRANCH:t(vZ.CURRENT_BRANCH);break;case vZ.SETTINGS:t(vZ.SETTINGS);break;case vZ.COMMIT:m(e.hash),t(vZ.COMMIT)}},[E,d,S]),R=(0,w.useCallback)(function(e){var t=(0,D.Dp)({path:e});"codeEditor"===t?o({operation:"open",pane:{type:"diff",data:{left:{path:e,data:{type:"git",revision:"HEAD"}},right:{path:e,data:{type:"fs"}}}}}):o({operation:"open",pane:{type:t,data:{path:e}}})},[o]),I=(0,w.useCallback)(function(e){T({mode:vZ.COMMIT,hash:e})},[T]),G=(0,w.useCallback)(function(){C(!0)},[]);if(d===vZ.BRANCH&&(0,tJ.p3)(g,S)&&E(vZ.CURRENT_BRANCH),(0,w.useEffect)(function(){return C(!1)},[_]),x||!_||_.error)return(0,c.tZ)(a1,{children:(null==_?void 0:_.error)?(0,c.tZ)(oW,{error:_.error}):(0,c.tZ)(og,{})});switch(_.type){case t$.y5.INITIALIZING:case t$.y5.INTERMEDIATE:case t$.y5.DETACHED_HEAD:return(0,c.tZ)(a1,{children:(0,c.tZ)(a2,{state:_.state,status:_.status,onFileClick:R,gotoPendingState:G})});case t$.y5.NORMAL:if(d===vZ.BRANCH&&!g||d===vZ.CURRENT_BRANCH&&!S)return(0,c.tZ)(a1,{header:(0,c.tZ)(n4,{mode:vZ.DASHBOARD,branch:null,switchMode:T,onBack:k}),children:(0,c.tZ)(oD,{currentBranch:null,switchMode:T})});return(0,c.tZ)(a1,{header:(0,c.tZ)(n4,{mode:d,branch:d===vZ.CURRENT_BRANCH?S:g,switchMode:T,onBack:k}),children:(0,c.tZ)(a8,{mode:d,status:_.status,remotes:_.remotes,previewBranch:g,previewCommit:p,currentBranch:S,switchMode:T,onStagedFileClick:R,onViewCommitClick:l?I:void 0,onViewSettingsClick:function(){return T({mode:vZ.SETTINGS})},gotoPendingState:G})})}}function a1(e){var t=e.header,n=e.children,r=(0,a._)((0,w.useState)(function(){return(0,tQ.MT)()}),1)[0];return(0,c.tZ)(t0.Provider,{value:r,children:(0,c.BX)(R.G,{css:aQ.gitPane,children:[(0,c.tZ)(rb,{}),t,(0,c.tZ)(R.G,{css:aQ.gitPaneContent,children:n})]})})}function a2(e){var t=e.state,n=e.status,r=e.onFileClick,i=e.gotoPendingState;switch(t){case t$.yG.NOT_INITIALIZED:return(0,c.tZ)(oU,{});case t$.yG.ON_UNBORN_BRANCH:return(0,c.tZ)(oX,{onFileClick:r,status:n});case t$.yG.MERGING:return(0,c.tZ)(af,{onFileClick:r,gotoPendingState:i});case t$.yG.REBASING:return(0,c.tZ)(oO,{});case t$.yG.REVERTING:return(0,c.tZ)(oL,{});case t$.yG.CHERRY_PICKING:return(0,c.tZ)(ow,{});case t$.yG.APPLYING_MAILBOX:return(0,c.tZ)(rZ,{});case t$.yG.BISECTING:return(0,c.tZ)(rw,{});case t$.yG.DETACHED_HEAD:return(0,c.tZ)(oI,{});default:return null}}function a8(e){var t=e.mode,n=e.status,r=e.remotes,i=e.previewBranch,o=e.previewCommit,a=e.currentBranch,l=e.switchMode,s=e.onStagedFileClick,u=e.onViewCommitClick,d=e.onViewSettingsClick,f=e.gotoPendingState;switch(t){case vZ.DASHBOARD:return(0,c.tZ)(oD,{currentBranch:a,switchMode:l});case vZ.BRANCH:return(0,c.tZ)(ob,{status:n,branch:i,remotes:r,onStagedFileClick:s,onViewCommitClick:u,onViewSettingsClick:d,gotoPendingState:f});case vZ.CURRENT_BRANCH:return(0,c.tZ)(ob,{status:n,remotes:r,branch:a,onStagedFileClick:s,onViewCommitClick:u,onViewSettingsClick:d,gotoPendingState:f,current:!0});case vZ.SETTINGS:return(0,c.tZ)(aJ,{});case vZ.COMMIT:return(0,c.tZ)(ai,{status:n,onViewCommitClick:u,hash:o,switchMode:l});default:(0,t3.Z)(t)}}var a4=s.Dy.Object({type:s.Dy.Literal("git")}),a3={Content:function(e){var t=e.options,n=t.isActive,r=t.performPaneOperation;return(0,c.tZ)(a0,{isActive:n,performPaneOperation:r})},Icon:function(e){var t=e.size;return(0,c.tZ)(tq.Z,{size:t})},getTitle:function(){return"Git"},decode:function(e){return u.B4.Decode(a4,e)}},a5=n(80711),a6=n(99418);function a9(e){var t=e.onClose;return(0,c.tZ)(L.zx,{text:"Cancel",onClick:function(){(0,a6.p)("historyExplicitlyClosed"),t()}})}var a7=n(10099),le=n(31171),lt=(0,eu.iv)({filter:"grayscale(100%) opacity(0.5)",pointerEvents:"none"});function ln(){var e,t="/replEnvironmentMobile"===(0,av.useRouter)().pathname,n=(0,le.bA)(),r=(0,le._Z)(),i=(0,aS.U)(),o=!n||0===n.count;return(0,c.BX)(R.G,{css:[g.l0.rowWithGap(8),g.l0.align.center,o?lt:null],children:[(0,c.tZ)(a7.Z,{id:i("diffButton"),isOn:null!==(e=null==n?void 0:n.comparing)&&void 0!==e&&e,onChange:function(e){o||r({comparing:e.target.checked})}}),(0,c.tZ)("label",{css:[{cursor:"pointer",userSelect:"none"},g.l0.flex.column,g.l0.align.center],htmlFor:i("diffButton"),children:(0,c.tZ)(h.xv,{multiline:!1,children:t?"Compare":"Compare Latest"})})]})}function lr(){var e=(0,le.bA)();if(!e||0===e.count)return null;var t=e.changes[e.version].timestamp;return(0,c.tZ)(nt.EK,{textColor:"dimmer",dateFormat:"switch",date:t})}var li=n(28908);function lo(e){var t=e.reversed,n=void 0!==t&&t,r=e.hideName,i=void 0!==r&&r,o=e.color,a=void 0===o?"default":o,l=(0,le.bA)(),s=(0,w.useMemo)(function(){return[n?g.l0.rowReverseWithGap(4):g.l0.rowWithGap(4),g.l0.align.center]},[n]);if(!l)return null;if(0===l.count)return(0,c.BX)(R.G,{css:s,children:[(0,c.tZ)(li.Z,{size:24}),(0,c.tZ)(h.xv,{color:a,multiline:!1,children:"Server Authored"})]});var u=l.changes[l.version];if(!l.users)return(0,c.BX)(R.G,{css:s,children:[(0,c.tZ)(no.q,{size:24,src:"/public/images/ghost.svg",username:"Unknown"}),i?null:(0,c.tZ)(h.xv,{color:a,multiline:!1,children:"Unknown"})]});var d=l.users[u.userId];return d?(0,c.BX)(R.G,{css:s,children:[(0,c.tZ)(no.q,{size:24,src:d.image,username:d.username}),i?null:(0,c.tZ)(h.xv,{color:a,multiline:!1,children:d.username})]}):u.timestamp>16546464e5?(0,c.BX)(R.G,{css:s,children:[(0,c.tZ)(li.Z,{size:24}),i?null:(0,c.tZ)(h.xv,{color:a,multiline:!1,children:"Server Authored"})]}):(0,c.BX)(R.G,{css:s,children:[(0,c.tZ)(no.q,{size:24,src:"/public/images/ghost.svg",username:"Unknown"}),i?null:(0,c.tZ)(h.xv,{color:a,multiline:!1,children:"Unknown"})]})}var la=n(97615),ll=n(12285),lc=n(4955),ls=n(14105),lu=n(9670),ld=function(e){"use strict";(0,lc._)(n,e);var t=(0,lu._)(n);function n(e){var r;return(0,ll._)(this,n),(r=t.call(this,e)).name="UserError",r}return n}((0,ls._)(Error)),lf=n(94376);function lh(){var e=(0,ey._)(["\n  query WorkspaceHistory2Users($ids: [Int!]!) {\n    currentUser {\n      id\n      username\n      image\n    }\n    usersByIds(ids: $ids) {\n      id\n      username\n      image\n    }\n  }\n"]);return lh=function(){return e},e}function lp(){var e=(0,ey._)(["\n  query WorkspaceHistory2CurrentUserDate {\n    currentUser {\n      id\n      timeCreated\n    }\n  }\n"]);return lp=function(){return e},e}var lm=(0,eb.Ps)(lh());function lv(e,t,n){return new Promise(function(r,i){try{var o,a=e.watchTextFile(t,{onReady:(o=(0,to._)(function(e){var t,o;return(0,ta.Jh)(this,function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),[4,n(e)];case 1:return t=l.sent(),r(t),[3,3];case 2:return o=l.sent(),i(o),[3,3];case 3:return a(),[2]}})}),function(e){return o.apply(this,arguments)})})}catch(e){i(e)}})}lp();var lg=lf.I;function ly(){return(ly=(0,to._)(function(e,t){var n,r,i,o,a,c,s,u,d,f,h,p,m,v,g,y,b,Z;return(0,ta.Jh)(this,function(w){switch(w.label){case 0:n=new Set,r=!0,i=!1,o=void 0;try{for(a=t[Symbol.iterator]();!(r=(c=a.next()).done);r=!0)(s=c.value).userId&&n.add(s.userId)}catch(e){i=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}if(0===n.size)return[2,{}];if(n.size>=lg)return[2,"too_many_users"];return[4,e.query({query:lm,variables:{ids:Array.from(n)}})];case 1:if(d=(u=w.sent()).data,f=u.error)throw f;h=d.currentUser?[d.currentUser].concat((0,l._)(d.usersByIds)):d.usersByIds,p={},m=!0,v=!1,g=void 0;try{for(y=h[Symbol.iterator]();!(m=(b=y.next()).done);m=!0)p[(Z=b.value).id]={id:Z.id,username:Z.username,image:Z.image}}catch(e){v=!0,g=e}finally{try{m||null==y.return||y.return()}finally{if(v)throw g}}return[2,p]}})})).apply(this,arguments)}function lb(){return(lb=(0,to._)(function(e,t,n){var r,i,o;return(0,ta.Jh)(this,function(a){switch(a.label){case 0:var l;return[4,lv(e,n,(l=(0,to._)(function(e){var t,n;return(0,ta.Jh)(this,function(r){return(t=e.fetchChanges,0===(n=e.version))?[2,{isDisposed:!1,result:[]}]:[2,t(1,n,"")]})}),function(e){return l.apply(this,arguments)}))];case 1:if((r=a.sent()).isDisposed)return[2,{data:null,handledError:"File deleted or removed."}];return[4,function(e,t){return ly.apply(this,arguments)}(t,i=r.result)];case 2:if("too_many_users"===(o=a.sent()))return[2,{data:{changes:i,users:null},handledError:null}];return[2,{data:{changes:i,users:o},handledError:null}]}})})).apply(this,arguments)}(vx||(vx={})).TooManyUsersRequestedError="too_many_users";var lZ=(0,eu.iv)({display:"grid",gridTemplateColumns:"auto 1fr",rowGap:"0.5rem",columnGap:"1rem","> dt":{display:"flex",alignItems:"center",fontWeight:"bold"}});function lw(e){var t=e.onCloseHistory,n=(0,o9.Z)().showError,r=(0,a._)((0,w.useState)(!1),2),i=r[0],o=r[1],l=(0,a._)((0,w.useState)(!1),2),s=l[0],u=l[1],d=(0,y.Z)().fs,f=(0,le.bA)(),p=(0,a6.j)(),m="Reset",v=!0;function b(){return(b=(0,to._)(function(){var e,r;return(0,ta.Jh)(this,function(i){switch(i.label){case 0:if(!f||!d||s)return[2];i.label=1;case 1:var a,l;return i.trys.push([1,3,4,5]),u(!0),(0,a6.p)("versionRestored"),e=f.filePath,[4,(a=f.version+1,lv(d,e,(l=(0,to._)(function(e){var t,n,r,i,o,l,c,s;return(0,ta.Jh)(this,function(u){switch(u.label){case 0:if(t=e.fetchChanges,n=e.writeChange,a>(r=e.version))throw Error("Cannot reset to a version that does not exist");if(a===r)return[2];i=null,u.label=1;case 1:return u.trys.push([1,3,,4]),[4,t(1,r,"")];case 2:if((o=u.sent()).isDisposed)throw new ld("File deleted or removed.");return i=o.result,[3,4];case 3:throw u.sent(),new ld("Something went wrong while resetting the file. It is possible that a bad connection is to blame. Please try again.");case 4:c=(l=(0,N._)(i.slice(a,i.length).reverse()))[0],s=l.slice(1).reduce(function(e,t){return e.compose(t.invertedChanges)},c.invertedChanges);try{n(s)}catch(e){throw tc.Tb(e),new ld("Something went wrong while resetting the file. Maybe the file changed while you were restoring it? Please try again.")}return[4,d.flush()];case 5:return u.sent(),[2]}})}),function(e){return l.apply(this,arguments)})))];case 2:return i.sent(),t(),[3,5];case 3:if((r=i.sent())instanceof ld)return n(r.message),[2];return p(r,"restore"),[3,5];case 4:return o(!1),u(!1),[7];case 5:return[2]}})})).apply(this,arguments)}return f?0===f.count?(m="No history",v=!0):s||i?(m="Resetting...",v=!0):f.playing?(m="Playing...",v=!0):f.version===f.count-1?(m="Viewing latest",v=!0):(m="Reset editor to here",v=!1):(m="Loading...",v=!0),(0,c.BX)(c.HY,{children:[(0,c.tZ)(L.zx,{text:m,disabled:v,onClick:function(){return o(!0)},colorway:"primary",iconLeft:(0,c.tZ)(a5.Z,{})}),f&&0!==f.count&&(0,c.tZ)(rx.u,{isOpen:i,onRequestClose:function(){s||o(!1)},children:(0,c.BX)(R.G,{css:g.l0.colWithGap(24),children:[(0,c.tZ)(h.h4,{variant:"headerDefault",level:2,children:"Reset file version"}),(0,c.tZ)(M.Tg,{elevated:!0,css:[g.l0.px(16),g.l0.py(12),g.l0.borderRadius(8)],children:(0,c.BX)("dl",{css:lZ,children:[(0,c.tZ)("dt",{children:"File"}),(0,c.tZ)("dd",{children:f.filePath}),(0,c.tZ)("dt",{children:"Version"}),(0,c.BX)("dd",{children:[f.version+1,(0,c.BX)("span",{css:[g.l0.color.foregroundDimmest],children:[(0,c.tZ)("span",{css:g.l0.mx(8),children:"/"}),f.count]})]}),(0,c.tZ)("dt",{children:"Date"}),(0,c.tZ)("dd",{children:(0,c.tZ)(nt.EK,{date:f.changes[f.version].timestamp,dateFormat:"absolute"})}),(0,c.tZ)("dt",{children:"Author"}),(0,c.tZ)("dd",{children:(0,c.tZ)(lo,{})})]})}),(0,c.tZ)(rC.E,{icon:(0,c.tZ)(la.Z,{}),colorway:"positive",text:"Resetting is non-destructive. The reset content will become a new version at the end of history. You can always go back to the version you just had."}),(0,c.BX)(R.G,{css:[g.l0.rowWithGap(8),g.l0.justify.end],children:[(0,c.tZ)(L.zx,{text:"Cancel",disabled:s,onClick:function(){return o(!1)}}),(0,c.tZ)(L.zx,{text:s?"Resetting Version...":"Reset Version",disabled:s,colorway:"primary",onClick:function(){return b.apply(this,arguments)},iconLeft:(0,c.tZ)(a5.Z,{})})]})]})})]})}var lx=n(44166),lC=(0,w.forwardRef)(function(e,t){var n=(0,le.bA)(),r=(0,w.useRef)(null);(0,w.useImperativeHandle)(t,function(){return r.current}),n&&r.current&&(r.current.setAttribute("aria-valuemin","1"),r.current.setAttribute("aria-valuemax",String(n.count)),r.current.setAttribute("aria-valuenow",String(n.version+1)));var i=(0,w.useMemo)(function(){return(0,c.tZ)("div",{ref:r,role:"slider",tabIndex:0,css:{position:"absolute",top:"0",left:"calc((100% - 16px) * var(--scrubber-progress, 0))",width:"16px",height:"16px",backgroundColor:g.TV.accentPrimaryDefault,borderRadius:"100%",outline:"none",cursor:"pointer",transition:"left var(--scrubber-transition-time, 100ms) ease-out",willChange:"left, transition",":focus":{boxShadow:"0 0 0 1px ".concat(g.TV.foregroundDefault," inset")}}})},[]);return n&&n.count>1?i:null}),l_=(0,w.forwardRef)(function(e,t){var n=(0,le.bA)(),r=(0,w.useMemo)(function(){return(0,c.BX)(c.HY,{children:[(0,c.tZ)("div",{ref:t,"aria-hidden":!0,css:{position:"relative",top:"0",width:"100%",height:"16px",margin:"0",cursor:"pointer"}}),(0,c.tZ)("div",{"aria-hidden":!0,css:{position:"absolute",top:"6px",left:"0",width:"100%",height:"4px",margin:"0",overflow:"hidden",pointerEvents:"none",backgroundColor:g.TV.backgroundHighest,borderRadius:"2px"},children:(0,c.tZ)("div",{"aria-hidden":!0,css:{position:"absolute",top:"0",left:"0",width:"100%",height:"4px",margin:"0",pointerEvents:"none",backgroundColor:g.TV.accentPrimaryDefault,transformOrigin:"left",transform:"scaleX(var(--scrubber-progress, 0))",transition:"transform var(--scrubber-transition-time, 100ms) ease-out",willChange:"transform, transition"}})})]})},[t]),i=(0,w.useMemo)(function(){return(0,c.tZ)("div",{ref:t,"aria-hidden":!0,css:{width:"100%",height:"16px",pointerEvents:"none"},children:(0,c.tZ)("div",{css:{position:"absolute",width:"100%",height:"4px",top:"6px",left:"0",backgroundColor:g.TV.backgroundHighest,borderRadius:"2px"}})})},[t]);return n&&n.count>1?r:i}),lS=["ArrowLeft","ArrowRight","Home","End"];function lE(){var e=(0,le.bA)(),t=(0,le._Z)(),n=(0,a._)((0,w.useState)(!1),2),r=n[0],i=n[1],o=(0,w.useRef)(null),l=(0,w.useRef)(null),s=(0,w.useRef)(null),u=function(e){(0,lx.A)(o,"--scrubber-transition-time",e)},d=function(e){(0,lx.A)(o,"--scrubber-progress",e.toString())};return e&&!r&&(d(e.version/(e.count-1)),e.playing?u("50ms"):u("100ms")),(0,w.useEffect)(function(){if(e&&l.current&&s.current&&!r){var n=l.current,o=s.current,a=function(r){if(0===r.button){i(!0),o.focus();var a=n.getBoundingClientRect(),l=o.getBoundingClientRect(),c=a.width,s=l.width,f=r.target===n?s/2:r.clientX-l.left,h=null,p=function(n){var r=Math.max(0,Math.min(1,(n-a.left-f)/(c-s)));r!==h&&(h=r,d(r),t({version:Math.round(r*(e.count-1)),playing:!1}))};p(r.clientX);var m=function(e){u("0ms"),p(e.clientX),e.preventDefault(),e.stopPropagation()},v=function(){window.removeEventListener("pointermove",m),window.removeEventListener("pointerup",v),window.removeEventListener("pointercancel",v),u("100ms"),i(!1)};window.addEventListener("pointermove",m),window.addEventListener("pointerup",v),window.addEventListener("pointercancel",v),r.preventDefault(),r.stopPropagation()}};return n.addEventListener("pointerdown",a),o.addEventListener("pointerdown",a),function(){n.removeEventListener("pointerdown",a),o.removeEventListener("pointerdown",a)}}},[e,t,r]),(0,w.useEffect)(function(){if(e&&s.current&&!r){var n=s.current,i=function(n){if(e&&lS.includes(n.key)){var r=n.shiftKey?10:1,i=e.version,o=e.count-1,a=null;switch(n.key){case"ArrowLeft":a=Math.max(0,i-r);break;case"ArrowRight":a=Math.min(o,i+r);break;case"Home":a=0;break;case"End":a=o}null!==a&&(t({version:a,playing:!1}),n.preventDefault(),n.stopPropagation())}};return n.addEventListener("keydown",i),function(){n.removeEventListener("keydown",i)}}},[e,t,r]),(0,w.useMemo)(function(){return(0,c.BX)(R.G,{innerRef:o,css:{position:"relative",height:"16px",width:"100%",touchAction:"none","--scrubber-progress":1,"--scrubber-transition-time":"100ms",":hover, :focus-within":{filter:"brightness(1.1)"},":hover:focus-within":{filter:"brightness(1.2)"}},children:[(0,c.tZ)(l_,{ref:l}),(0,c.tZ)(lC,{ref:s})]})},[])}var lk=n(9331);function lT(){var e=(0,le.bA)(),t=0,n=0;return e&&0!==e.count&&(t=e.version+1,n=e.count),(0,c.BX)(R.G,{css:[g.l0.rowWithGap(4),g.l0.justify.spaceBetween],children:[(0,c.tZ)(h.xv,{css:{minWidth:"2ch",textAlign:"right"},color:e?"default":"dimmer",multiline:!1,children:t}),(0,c.tZ)(h.xv,{css:{width:"1ch",textAlign:"center"},color:"dimmer",multiline:!1,children:"/"}),(0,c.tZ)(h.xv,{css:{minWidth:"2ch",textAlign:"left"},color:"dimmer",multiline:!1,children:n})]})}var lR=n(56335),lD=n(27187);function lI(e){if(e<0)throw Error('Require at least zero ops to compute pace, got "'+e+'"');return 1/Math.log(e+2)*100}function lG(){var e,t,n,r,i=(0,le.bA)(),o=(0,le._Z)(),l=(null!==(t=null==i?void 0:null===(e=i.changes)||void 0===e?void 0:e.length)&&void 0!==t?t:1)-1,s=null!==(n=null==i?void 0:i.version)&&void 0!==n?n:0,u=null!==(r=null==i?void 0:i.playing)&&void 0!==r&&r,f=!i||0===i.count,h=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:lI,i=(0,a._)((0,w.useState)(!1),2),o=i[0],l=i[1],c=(0,w.useCallback)(function(){t(1)},[t]),s=(0,w.useCallback)(function(){if(e+1>n){l(!1);return}t(e+1)},[t,e,n]);return(0,w.useEffect)(function(){if(o){var e=setTimeout(function(){s()},r(n));return function(){return clearTimeout(e)}}},[o,s,r,n]),{isPlaying:o,start:function(){l(!0)},stop:function(){l(!1)},reset:c}}(s,function(e){return o({version:e})},l),p=h.isPlaying,m=h.start,v=h.stop;(0,w.useEffect)(function(){p&&!u?v():!p&&u&&m()},[u,p,m,v]);var g="Loading...";return i&&(p?g="Pause":i.version===i.count-1?g="Play file history from beginning":0===i.version?g="Play file history":i.version>0&&(g="Play file history from here")),(0,c.tZ)(d.hU,{alt:g,size:24,disabled:f,onClick:function(){s===l?o({version:0,playing:!0}):o({playing:!u})},children:p?(0,c.tZ)(lR.Z,{}):(0,c.tZ)(lD.Z,{})})}function lB(){return(0,c.BX)(R.G,{css:[g.l0.rowWithGap(4),g.l0.align.center],children:[(0,c.tZ)(lG,{}),(0,c.tZ)(lA,{}),(0,c.tZ)(lT,{}),(0,c.tZ)(lP,{})]})}function lA(){var e=(0,le.bA)(),t=(0,le._Z)(),n=!e||0===e.version||0===e.count;return(0,c.tZ)(d.hU,{alt:"Move backwards one version",size:24,disabled:n,onClick:function(){e&&e.version>0&&t({version:e.version-1})},children:(0,c.tZ)(nq.Z,{})})}function lP(){var e=(0,le.bA)(),t=(0,le._Z)(),n=!e||e.version===e.count-1||0===e.count;return(0,c.tZ)(d.hU,{alt:"Move forwards one version",size:24,disabled:n,onClick:function(){e&&e.version<e.count-1&&t({version:e.version+1})},children:(0,c.tZ)(lk.Z,{})})}var lN=n(907);function lU(e){var t,n,r,i,o,l=e.filePath,s=e.onCloseHistory,u="/replEnvironmentMobile"===(0,av.useRouter)().pathname,d=u?g.l0.borderRadius(0):g.l0.borderRadius(0,0,8,8),f=(0,le.bA)(),p=(0,le._Z)(),m=(0,le.Ai)(),v=(0,a6.j)(),b=(n=(t=(0,a._)((0,w.useState)({data:null,loading:!0,error:null,handledError:null}),2))[0],r=t[1],i=(0,y.Z)().fs,o=(0,lN.x)(),(0,w.useEffect)(function(){if(!l){r({data:null,loading:!1,error:null,handledError:null});return}r({data:null,loading:!0,error:null,handledError:null});var e=!1;return(function(e,t,n){return lb.apply(this,arguments)})(i,o,l).then(function(t){var n=t.data,i=t.handledError;if(!e){if(i){r({data:null,loading:!1,error:null,handledError:i});return}r({data:n,loading:!1,error:null,handledError:null})}}).catch(function(t){e||(t instanceof Error||(t=Error(t)),r({data:null,loading:!1,error:t,handledError:null}))}),function(){e=!0}},[l,i,o]),n),Z=b.data,x=b.loading,C=b.error;return(0,w.useEffect)(function(){if(C){v(C,"history2-index",{filePath:l});return}if(Z&&!x)return p({filePath:l,changes:Z.changes,users:Z.users}),(0,a6.p)("historyLoaded"),function(){m()}},[l,Z,x,C,v,p,m]),(0,c.BX)(R.G,{css:[g.l0.colWithGap(8),g.l0.p(8),g.l0.zIndex(3),g.l0.overflow("hidden"),d,g.l0.backgroundColor.backgroundDefault,{borderTop:"2px solid ".concat(g.TV.backgroundHigher),boxShadow:"rgba(2, 2, 3, 0.125) 0px -16px 32px 0px"}],children:[(0,c.BX)(M.Tg,{css:[g.l0.position.relative,g.l0.colWithGap(4),g.l0.px(12),g.l0.pt(8),g.l0.pb(8),g.l0.align.center,g.l0.borderRadius(8),g.l0.overflow("hidden")],elevated:!0,children:[(0,c.tZ)(lE,{}),(0,c.BX)(R.G,{css:[g.l0.display.flex,g.l0.flex.row,g.l0.align.center,g.l0.justify.spaceBetween,g.l0.width("100%")],children:[(0,c.tZ)(lB,{}),f&&f.count>0?(0,c.BX)(R.G,{css:[g.l0.rowWithGap(4),g.l0.align.center],children:[(0,c.tZ)(lr,{}),x||u?null:(0,c.tZ)(h.xv,{color:"dimmer",multiline:!1,children:""}),(0,c.tZ)(lo,{color:"dimmer",hideName:u,reversed:!0})]}):null]})]}),(0,c.BX)(R.G,{css:[g.l0.display.flex,g.l0.flex.row],children:[(0,c.tZ)(lO,{justify:"flex-start",children:(0,c.tZ)(ln,{})}),(0,c.BX)(lO,{justify:"flex-end",children:[(0,c.tZ)(a9,{onClose:s}),(0,c.tZ)(lw,{onCloseHistory:s})]})]})]})}function lO(e){var t=e.children,n=e.justify;return(0,c.tZ)("div",{css:{display:"flex",flexGrow:1,flexBasis:0,alignItems:"center",justifyContent:n,columnGap:g.TV.space8,minWidth:0},children:t})}var lL=n(90367),lM=n(41691),lX=n(62609),lF=n(54340),lW=(0,lX.B)();function lH(e){if(!(e instanceof eI.YW))return{compareTo:e.field(lW.state,!1),changed:!1};var t=e.state.field(lW.state,!1),n=e.startState.field(lW.state,!1)!==t;return{compareTo:t,changed:n}}function lV(e,t){e.state.field(lW.state,!1)!==t&&e.dispatch({effects:lW.effect.of(t)})}var lz=eI.QQ.define({create:function(){return null},update:function(e,t){var n=lH(t),r=n.compareTo,i=n.changed;if(!r)return null;if(!t.docChanged&&!i)return e;var o=t.state.doc.toString();return new lF.PO(o,r)}}),lj=null!==(vC=globalThis.requestIdleCallback)&&void 0!==vC?vC:globalThis.requestAnimationFrame,lq=null!==(v_=globalThis.cancelIdleCallback)&&void 0!==v_?v_:globalThis.cancelAnimationFrame,lY=eP.p.line({class:"cm-diff-deleted"}),l$=function(e){"use strict";(0,lc._)(n,e);var t=(0,lu._)(n);function n(e,r){var i;return(0,ll._)(this,n),(i=t.call(this)).insertion=e,i.highlight=r,i}var r=n.prototype;return r.destroy=function(){this.pendingHighlight&&lq(this.pendingHighlight)},r.toDOM=function(){var e=document.createElement("div");return e.className="cm-diff-inserted cm-line",this.updateDOM(e),e},r.eq=function(e){return!e.pendingHighlight&&this.insertion===e.insertion},r.updateDOM=function(e){var t=this;return this.pendingHighlight&&(lq(this.pendingHighlight),this.pendingHighlight=null),this.insertion.length?e.textContent=this.insertion:e.innerHTML="&nbsp;",this.highlight&&this.insertion.length&&(this.pendingHighlight=lj(function(){if(t.highlight){t.pendingHighlight=null;try{var n=t.highlight();e.innerHTML="",e.append(n)}catch(e){}}})),!0},n}(eP.l9),lJ=eI.QQ.define({create:function(){return eP.p.none},update:function(e,t){var n=t.state.field(lz,!1);if(!n)return eP.p.none;var r=lH(t).changed;if(!t.docChanged&&!r)return e.map(t.changes);var i=[],o=function(e,t){i.push({from:e,to:e,value:t})},a=n.startInsertions();if(a){var l=!0,c=!1,s=void 0;try{for(var u,d=a[Symbol.iterator]();!(l=(u=d.next()).done);l=!0)!function(){var e=u.value,n=new l$(e.content,function(){return lK(t.state,e.content)});o(0,eP.p.widget({widget:n,side:-1,block:!0}))}()}catch(e){c=!0,s=e}finally{try{l||null==d.return||d.return()}finally{if(c)throw s}}}var f=!0,h=!1,p=void 0;try{for(var m,v=n.lines()[Symbol.iterator]();!(f=(m=v.next()).done);f=!0)!function(){var e=m.value;if(e.isDeleted&&o(e.from,lY),e.insertions){var n=!0,r=!1,i=void 0;try{for(var a,l=e.insertions[Symbol.iterator]();!(n=(a=l.next()).done);n=!0)!function(){var n=a.value,r=new l$(n.content,function(){return lK(t.state,n.content)});o(e.to,eP.p.widget({widget:r,side:1,block:!0}))}()}catch(e){r=!0,i=e}finally{try{n||null==l.return||l.return()}finally{if(r)throw i}}}}()}catch(e){h=!0,p=e}finally{try{f||null==v.return||v.return()}finally{if(h)throw p}}return eP.p.set(i,!0)},provide:function(e){return eP.tk.decorations.from(e)}});function lK(e,t){var n,r=document.createDocumentFragment(),i=null===(n=e.facet(lL.dK))||void 0===n?void 0:n.parser;if(!i){var o=document.createElement("span");return o.textContent=t,r.append(o),r}var a=i.parse(t),l=0;if((0,lM.bW)(a,{style:function(t){return(0,lL.QN)(e,t)}},function(e,n,i){if(e>l){var o=document.createElement("span");o.textContent=t.slice(l,e),r.append(o)}var a=document.createElement("span");a.className=i,a.textContent=t.slice(e,n),r.append(a),l=n}),l<t.length){var c=document.createElement("span");c.textContent=t.slice(l),r.append(c)}return r}var lQ=function(e){"use strict";(0,lc._)(n,e);var t=(0,lu._)(n);function n(e){var r;return(0,ll._)(this,n),(r=t.call(this)).line=e,r}var r=n.prototype;return r.eq=function(e){return this.line===e.line},r.toDOM=function(){var e=document.createElement("div");return e.className="cm-diff-gutter-element-fallback",e.innerText=this.line.toString(),e},n}(eP.SJ),l0=function(e){"use strict";(0,lc._)(n,e);var t=(0,lu._)(n);function n(e,r){var i;return(0,ll._)(this,n),(i=t.call(this)).elementClass="cm-diff-gutter-block",i.lines=e,r&&(i.preceding=r),i}var r=n.prototype;return r.eq=function(e){var t,n,r,i;if((null===(t=this.lines)||void 0===t?void 0:t.length)!==(null==e?void 0:null===(n=e.lines)||void 0===n?void 0:n.length)||(null===(r=this.preceding)||void 0===r?void 0:r.length)!==(null==e?void 0:null===(i=e.preceding)||void 0===i?void 0:i.length))return!1;if(this.preceding&&e.preceding)for(var o=0;o<this.preceding.length;o++){var a=this.preceding[o],l=e.preceding[o];if(a.height!==l.height||a.left!==l.left||a.right!==l.right)return!1}if(this.lines&&e.lines)for(var c=0;c<this.lines.length;c++){var s=this.lines[c],u=e.lines[c];if(s.height!==u.height||s.left!==u.left||s.right!==u.right)return!1}return!0},r.toDOM=function(){var e=this,t=document.createElement("div");if(this.preceding){var n=this.preceding.slice().reverse(),r=0,i=!0,o=!1,a=void 0;try{for(var c,s=n[Symbol.iterator]();!(i=(c=s.next()).done);i=!0){var u=c.value;r+=u.height;var d=this.piece(u);d.style.position="absolute",d.style.top="-".concat(r,"px"),t.prepend(d)}}catch(e){o=!0,a=e}finally{try{i||null==s.return||s.return()}finally{if(o)throw a}}}var f=this.lines.map(function(t){return e.piece(t)});return t.append.apply(t,(0,l._)(f)),t},r.piece=function(e){var t=e.height,n=e.left,r=e.right,i=document.createElement("span");i.className="cm-diff-gutter-part",null!==n&&(i.innerText=n.toString());var o=document.createElement("span");o.className="cm-diff-gutter-part",null!==r&&(o.innerText=r.toString());var a=document.createElement("div");return a.className="cm-diff-gutter-element",a.style.height="".concat(t,"px"),a.append(i,o),(null===n||null===r)&&(null===r&&a.classList.add("cm-diff-gutter-deleted"),null===n&&a.classList.add("cm-diff-gutter-inserted")),a},n}(eP.SJ),l1=(0,eP.v5)({class:"cm-lineNumbers cm-diff-gutter",markers:function(e){var t=e.viewportLineBlocks,n=[],r=lH(e.state).compareTo,i=e.state.field(lz,!1),o=function(e,t){n.push({from:e,to:e,value:t})};if(!r||!i){var a=!0,l=!1,c=void 0;try{for(var s,u=t[Symbol.iterator]();!(a=(s=u.next()).done);a=!0){var d=s.value,f=e.state.doc.lineAt(d.from).number;if(d.type===eP.kH.Text)o(d.from,new lQ(f));else if(Array.isArray(d.type)){var h=!0,p=!1,m=void 0;try{for(var v,g=d.type[Symbol.iterator]();!(h=(v=g.next()).done);h=!0){var y=v.value;if(y.type===eP.kH.Text){o(y.from,new lQ(f));break}}}catch(e){p=!0,m=e}finally{try{h||null==g.return||g.return()}finally{if(p)throw m}}}}}catch(e){l=!0,c=e}finally{try{a||null==u.return||u.return()}finally{if(l)throw c}}return eI.Xs.of(n,!0)}var b=!0,Z=!1,w=void 0;try{for(var x,C=t[Symbol.iterator]();!(b=(x=C.next()).done);b=!0){var _=x.value,S=[],E=e.state.doc.lineAt(_.from).number,k=i.line(E);if(k){var T=e.defaultLineHeight,R=k.offset,D=k.isDeleted,I=k.insertions,G=1===E?i.startInsertions():null,B=G?G.length:0,A=G?[]:null;if(!(Array.isArray(_.type)&&_.type.length>=B+(null!==(O=null==I?void 0:I.length)&&void 0!==O?O:0)+1)){if(G&&A){var P=!0,N=!1,U=void 0;try{for(var O,L,M=G[Symbol.iterator]();!(P=(L=M.next()).done);P=!0){var X=L.value;A.push({height:T,left:null,right:X.number})}}catch(e){N=!0,U=e}finally{try{P||null==M.return||M.return()}finally{if(N)throw U}}}if(S.push({height:_.height,left:E,right:D?null:E+R}),I){var F=!0,W=!1,H=void 0;try{for(var V,z=I[Symbol.iterator]();!(F=(V=z.next()).done);F=!0){var j=V.value;S.push({height:T,left:null,right:j.number})}}catch(e){W=!0,H=e}finally{try{F||null==z.return||z.return()}finally{if(W)throw H}}}o(_.from,new l0(S,A));continue}for(var q=0;q<_.type.length;q++){var Y=_.type[q];if((null==Y?void 0:Y.type)===eP.kH.Text){if(G&&A)for(var $=0;$<G.length;$++){var J,K=G[$],Q=_.type[q-$-1];A.push({height:null!==(J=null==Q?void 0:Q.height)&&void 0!==J?J:T,left:null,right:K.number})}if(S.push({height:Y.height,left:E,right:D?null:E+R}),I)for(var ee=0;ee<I.length;ee++){var et,en=I[ee],er=_.type[q+ee+1];S.push({height:null!==(et=null==er?void 0:er.height)&&void 0!==et?et:T,left:null,right:en.number})}break}}o(_.from,new l0(S,A))}}}catch(e){Z=!0,w=e}finally{try{b||null==C.return||C.return()}finally{if(Z)throw w}}return eI.Xs.of(n,!0)},lineMarkerChange:function(e){if(e.docChanged)return!0;var t=!0,n=!1,r=void 0;try{for(var i,o=e.transactions[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;if(lH(a).changed)return!0}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}return!1},initialSpacer:function(e){return new lQ(e.state.doc.lines)},updateSpacer:function(e,t){var n=t.state.doc.lines;return lH(t.state).compareTo?new l0([{height:0,left:n,right:n}]):new lQ(n)}}),l2="#0053A644",l8="#c93c3733",l4=[eP.tk.theme({".cm-diff-inserted":{backgroundColor:l2},".cm-diff-deleted":{backgroundColor:l8},".cm-diff-gutter .cm-diff-gutter-block":{position:"relative",padding:"0"},".cm-diff-gutter-element":{display:"flex",width:"100%",alignItems:"center",columnGap:"8px",padding:"0 6px",borderLeft:"4px solid transparent"},".cm-diff-gutter-part":{display:"inline-block",height:"100%",width:"50%",textAlign:"center"},".cm-diff-gutter-inserted":{backgroundColor:l2,borderLeftColor:"#0053A6"},".cm-diff-gutter-deleted":{backgroundColor:l8,borderLeftColor:"#c93c37"},".cm-diff-gutter + .cm-foldGutter":{width:"0",transform:"translateX(-12px)",overflow:"visible"},".cm-diff-gutter .cm-diff-gutter-element":{paddingRight:"16px"},".cm-diff-gutter .cm-diff-gutter-element-fallback":{paddingRight:"12px"}}),lW.state,lz,lJ,l1,(0,lL.mi)({openText:"",closedText:""})],l3=n(4384),l5=function(){"use strict";function e(t){var n=this;(0,ll._)(this,e),this.view=t,this.overlay=document.createElement("div"),this.overlay.className="cm-overlay-generic",this.overlay.style.pointerEvents="none",this.overlay.style.contain="size style",this.overlay.setAttribute("aria-hidden","true"),this.view.scrollDOM.appendChild(this.overlay),this.elements=new Map,this.measureRequest={key:this,read:function(){var e=[],t=n.view.scrollDOM.getBoundingClientRect(),r=n.view.scrollDOM.scrollTop,i=n.view.scrollDOM.scrollLeft,o=!0,a=!1,l=void 0;try{for(var c,s=n.elements.values()[Symbol.iterator]();!(o=(c=s.next()).done);o=!0){var u=c.value,d=u.dom,f=u.pos,h=u.offsetX,p=u.offsetY,m=n.view.coordsAtPos(f),v=n.view.lineBlockAt(f);if(!m){e.push({dom:d,x:null,y:null});continue}var g=v.top-r+t.top+n.view.documentPadding.top,y=Math.round((m.top-g)/n.view.defaultLineHeight)*n.view.defaultLineHeight+g,b=i+m.left-t.left+h,Z=r+y-t.top+p;e.push({dom:d,x:b,y:Z})}}catch(e){a=!0,l=e}finally{try{o||null==s.return||s.return()}finally{if(a)throw l}}return e},write:function(e){var t=!0,n=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(t=(i=o.next()).done);t=!0)!function(){var e=i.value,t=e.dom,n=e.x,r=e.y;if(null===n||null===r)return t.style.visibility="hidden",t.style.transition="none";t.style.visibility="",t.style.transform="translate(".concat(n,"px, ").concat(r,"px)"),t.style.transition.startsWith("none")&&requestAnimationFrame(function(){t.style.transition=""})}()}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}}}}var t=e.prototype;return t.destroy=function(){this.view.scrollDOM.removeChild(this.overlay)},t.map=function(e){if(e.geometryChanged||e.viewportChanged){if(e.docChanged){var t=Array.from(this.elements.values()),n=!0,r=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value,c=e.changes.mapPos(l.pos,-1,eI.gc.TrackDel);if(!c){this.removeElement(l.dom);continue}l.pos=c}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}}this.view.requestMeasure(this.measureRequest)}},t.addElement=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(!this.elements.has(e)){var i={dom:e,pos:t,offsetX:n,offsetY:r};return this.elements.set(e,i),this.overlay.appendChild(e),e.style.visibility="hidden",e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.willChange="transform",e.style.transition="none",this.view.requestMeasure(this.measureRequest),i}},t.removeElement=function(e){this.elements.has(e)&&(this.elements.delete(e),e.parentNode===this.overlay&&this.overlay.removeChild(e))},t.updateElement=function(e,t){var n=t.pos,r=t.offsetX,i=t.offsetY,o=this.elements.get(e);o&&(void 0!==n&&(o.pos=n),void 0!==r&&(o.offsetX=r),void 0!==i&&(o.offsetY=i),this.view.requestMeasure(this.measureRequest))},t.clear=function(){this.elements.clear(),this.overlay.innerHTML=""},e}();(vd=vS||(vS={}))[vd.Insertion=0]="Insertion",vd[vd.Deletion=1]="Deletion";var l6=function(){"use strict";function e(t){(0,ll._)(this,e),this.map=new Map,this.duration=t}var t=e.prototype;return t.set=function(e,t,n,r,i){var o=this.map.get(e);o||(o=new Map,this.map.set(e,o)),o.set(t,{from:e,to:t,time:n,type:r,cursor:i})},t.get=function(e,t){var n=this.map.get(e);if(n)return n.get(t)},t.update=function(t){var n=Date.now(),r=new e(this.duration),i=!0,o=!1,a=void 0;try{for(var l,c=this[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var s=l.value;if(!(n-s.time>this.duration)){var u=t.changes.mapPos(s.from,-1,eI.gc.TrackDel),d=t.changes.mapPos(s.to,-1,eI.gc.TrackDel);if(null!==u&&null!==d){var f=s.cursor;t.docChanged&&(f=!1),r.set(u,d,s.time,s.type,f)}}}}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}return t.changes.iterChangedRanges(function(e,t,i,o){r.set(i,o,n,i!==o?0:1,!0)},!0),r},t.cursors=function(){var e,t,n,r,i,o,a;return(0,ta.Jh)(this,function(l){switch(l.label){case 0:e=!0,t=!1,n=void 0,l.label=1;case 1:l.trys.push([1,6,7,8]),r=this[Symbol.iterator](),l.label=2;case 2:if(e=(i=r.next()).done)return[3,5];if(!(o=i.value).cursor)return[3,4];return[4,{type:o.type,pos:o.to}];case 3:l.sent(),l.label=4;case 4:return e=!0,[3,2];case 5:return[3,8];case 6:return a=l.sent(),t=!0,n=a,[3,8];case 7:try{e||null==r.return||r.return()}finally{if(t)throw n}return[7];case 8:return[2]}})},t[Symbol.iterator]=function(){var e=[],t=!0,n=!1,r=void 0;try{for(var i,o=this.map.values()[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value,l=!0,c=!1,s=void 0;try{for(var u,d=a.values()[Symbol.iterator]();!(l=(u=d.next()).done);l=!0){var f=u.value;e.push(f)}}catch(e){c=!0,s=e}finally{try{l||null==d.return||d.return()}finally{if(c)throw s}}}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}return e[Symbol.iterator]()},e}(),l9="cm-flash-insertion",l7="cm-flash-deletion",ce="cm-flash-element",ct=eP.tk.theme((0,eD._)({},".".concat(l9,", .").concat(l7),{display:"inline-block"})),cn=function(e){"use strict";(0,lc._)(n,e);var t=(0,lu._)(n);function n(){return(0,ll._)(this,n),t.apply(this,arguments)}var r=n.prototype;return r.isNested=function(){for(var e=this.parentElement;e&&!e.classList.contains("cm-line");){if(e instanceof n&&e.type===this.type)return!0;e=e.parentElement}return!1},r.stop=function(){var e,t;null===(t=this.animation)||void 0===t||null===(e=t.cancel)||void 0===e||e.call(t)},r.play=function(){var e=this.isPlaying;if(this.stop(),!this.isNested()){var t=Date.now()-parseInt(this.getAttribute("data-time")||"0",10);if(!(t>1e3)){var n=this.type===vS.Insertion?"rgba(100, 255, 0, 0.3)":"rgba(255, 32, 32, 0.25)";this.animate&&(this.animation=this.animate({backgroundColor:e?[n,n,"transparent"]:["transparent",n,"transparent"],offset:[0,.05,1]},{id:"cm-flash-anim",duration:1e3,easing:"ease-in-out",delay:-t}))}}},r.connectedCallback=function(){this.play()},r.attributeChangedCallback=function(e,t,n){"data-time"===e&&n&&this.play()},(0,l3._)(n,[{key:"type",get:function(){return this.classList.contains(l9)?vS.Insertion:vS.Deletion}},{key:"isPlaying",get:function(){var e;return(null===(e=this.animation)||void 0===e?void 0:e.playState)==="running"}}],[{key:"observedAttributes",get:function(){return["data-time"]}}]),n}((0,ls._)(HTMLElement));customElements.get(ce)||customElements.define(ce,cn);var cr=function(){"use strict";function e(t){(0,ll._)(this,e),this.view=t,this.prevFlashes=new l6(1e3),this.decorations=eP.p.set([]),this.hasRenderedOnce=!1,this.overlay=new l5(t)}var t=e.prototype;return t.destroy=function(){this.overlay.destroy()},t.update=function(e){if(!this.hasRenderedOnce){e.docChanged&&(this.hasRenderedOnce=!0);return}var t=this.prevFlashes.update(e),n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var c=a.value;switch(c.type){case vS.Insertion:n.push({from:c.from,to:c.to,value:(s=c.time,eP.p.mark({class:l9,tagName:ce,attributes:{"data-time":s.toString()}}))});break;case vS.Deletion:var s,u,d=e.state.wordAt(c.from);d&&n.push({from:d.from,to:c.to,value:(u=c.time,eP.p.mark({class:l7,tagName:ce,attributes:{"data-time":u.toString()}}))})}}}catch(e){i=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}this.overlay.clear();var f=this.view.defaultLineHeight.toString()+"px",h=!0,p=!1,m=void 0;try{for(var v,g=t.cursors()[Symbol.iterator]();!(h=(v=g.next()).done);h=!0){var y=v.value,b=y.type,Z=y.pos,w=function(e,t){var n=e===vS.Insertion?"rgba(0, 100, 255, 1)":"rgba(255, 32, 32, 1)",r=document.createElement("div");return r.style.width="3px",r.style.height=t,r.style.borderRadius="1px",r.style.backgroundColor=n,r.animate&&r.animate({opacity:[1,0]},{duration:500,delay:400,fill:"forwards"}),r}(b,f);this.overlay.addElement(w,Z)}}catch(e){p=!0,m=e}finally{try{h||null==g.return||g.return()}finally{if(p)throw m}}this.prevFlashes=t,this.decorations=eP.p.set(n,!0)},e}(),ci=eP.lg.fromClass(cr,{decorations:function(e){return e.decorations}}),co=eI.Wl.lowest([ct,ci]),ca=n(81013),cl=n(75023),cc=n(3574),cs=n(62808),cu=n(11398),cd=function(){"use strict";function e(t){(0,ll._)(this,e),this.changes=[],this.forward=[],this.inverted=[],this.locations=[];var n=!0,r=!1,i=void 0;try{for(var o,a=this,l=t[Symbol.iterator]();!(n=(o=l.next()).done);n=!0)!function(){var e=o.value,t=e.changes,n=e.invertedChanges,r=null,i=!1;t.iterChangedRanges(function(e,t,n,o){i||(r||(r=o),n===o||(i=!0))}),a.forward.push(t),a.inverted.push(n),a.locations.push(r)}()}catch(e){r=!0,i=e}finally{try{n||null==l.return||l.return()}finally{if(r)throw i}}}var t=e.prototype;return t.slice=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.length;if(t>this.length||n>this.length||t<0||n<0)throw Error("Invalid version range");if(t===n){if(0===this.length)return[eI.as.empty(0),null];var r=this.forward[t].newLength;return[eI.as.empty(r),null]}var i=t<n?cf(this.forward.slice(t,n)):cf(this.inverted.slice(n,t).reverse()),o=t<n?t:n-1,a=null!==(e=this.locations[o])&&void 0!==e?e:null;return null!==a&&a>i.newLength&&(a=i.newLength),[i,a]},t.get=function(e){if(e>this.length||e<0)throw Error("Invalid version");return this.changes[e]},t.documentFor=function(e){if(e>this.length||e<0)throw Error("Invalid version");if(0===this.length)return"";var t=(0,a._)(this.slice(0,e),1)[0],n=eI.xv.of([""]);return t.apply(n).sliceString(0)},(0,l3._)(e,[{key:"length",get:function(){return this.forward.length}}]),e}();function cf(e){if(0===e.length)return eI.as.empty(0);if(1===e.length)return e[0];var t=(0,N._)(e),n=t[0],r=t.slice(1),i=n,o=!0,a=!1,l=void 0;try{for(var c,s=r[Symbol.iterator]();!(o=(c=s.next()).done);o=!0){var u=c.value;i=i.compose(u)}}catch(e){a=!0,l=e}finally{try{o||null==s.return||s.return()}finally{if(a)throw l}}return i}var ch=new cl.j(function(){return(0,eP.CT)()}),cp=[co,l4];function cm(e){var t,n,r,i=e.filePath,o=(0,le.bA)(),l=(0,ca.Z)(),s=l.ref,u=l.view;(0,cc.VD)(u),(0,le._H)(u);var d=(0,a6.j)();(0,cs.Y)({view:u}),t=(0,w.useMemo)(function(){return(null==o?void 0:o.changes)?new cd(o.changes):null},[null==o?void 0:o.changes]),n=(0,w.useMemo)(function(){return t?t.documentFor(t.length):null},[t]),r=(0,w.useRef)({current:-1,next:0,pending:!1}),(0,w.useEffect)(function(){if(u)return function(){r.current.pending=!1,r.current={current:-1,next:0,pending:!1}}},[u]),(0,w.useEffect)(function(){if(u&&o&&t){o.comparing?lV(u,n):lV(u,null);var e=r.current;e.next=o.version,e.pending||e.current===e.next||(e.pending=!0,requestAnimationFrame(function(){!1!==e.pending&&(e.pending=!1,u&&t&&e.current!==e.next&&(function(e,t,n,r){var i=(0,a._)(t.slice(n+1,r+1),2),o=i[0],l=i[1];if(o.length!==e.state.doc.length){var c=(0,a._)(t.slice(0,r+1),1)[0];if(c.length!==e.state.doc.length)throw Error("Unresolvable mismatch between changes and document");e.dispatch({changes:{from:0,to:e.state.doc.length}}),e.dispatch({changes:c});return}e.dispatch({changes:o,effects:l?eP.tk.scrollIntoView(l,{yMargin:10}):void 0})}(u,t,e.current,e.next),e.current=e.next))}))}},[u,o,t,n]);var f=ch.use();return(0,c.tZ)("div",{css:cu.ev,children:(0,c.tZ)("div",{css:cu.ac,children:o&&0===o.count?(0,c.tZ)(cv,{}):(0,c.tZ)("div",{css:cu.ac,children:(0,c.tZ)(eW.ZP,{ref:s,css:cu.Mp,filePath:i,extensions:[f,cp],initializing:!o,onException:function(e){d(e,"viewer-codemirror")},readOnly:!0,noHistory:!0,hideGutter:!0})})})})}function cv(){return(0,c.tZ)("div",{css:[cu.ac,{display:"flex",alignItems:"center",justifyContent:"center"}],children:(0,c.tZ)("span",{children:"This file has no history."})})}var cg=s.Dy.Object({type:s.Dy.Literal("history"),data:s.Dy.Object({path:s.Dy.Union([s.Dy.String(),s.Dy.Null()])})}),cy={Content:function(e){var t=e.pane,n=e.options;return(0,c.tZ)(cb,(0,P._)((0,A._)({},t.data),{performPaneOperation:n.performPaneOperation}))},Icon:function(e){var t=e.size;return(0,c.tZ)(a5.Z,{size:t})},getTitle:function(e){return e.data.path?"History - ".concat((0,x.UO)(e.data.path)):"History - no file open"},decode:function(e){return u.B4.Decode(cg,e)}};function cb(e){var t=e.path,n=e.performPaneOperation,r=(0,a._)((0,w.useState)(function(){return(0,tQ.MT)()}),1)[0],i=(0,a._)((0,w.useState)(function(){return(0,tQ.MT)()}),1)[0],o=(0,b.Mp)({path:t,performPaneOperation:n});(0,Z.L5)(function(){if(o)return{commands:o}},[o]);var l=(0,B.Z)(function(){return function(){n({operation:"replace",pane:{type:"codeEditor",data:{path:t}}})}},[t,n]);return t?(0,c.tZ)(cc.Cl.Provider,{value:r,children:(0,c.tZ)(le.ox.Provider,{value:i,children:(0,c.BX)("div",{css:{position:"relative",display:"flex",flexDirection:"column",overflowY:"hidden",height:"100%",width:"100%"},children:[(0,c.tZ)(b.HK,{path:t,performPaneOperation:n}),(0,c.tZ)(cm,{filePath:t}),(0,c.tZ)(lU,{filePath:t,onCloseHistory:l})]})})}):null}var cZ=n(74928),cw=n(48796),cx=n(26508),cC=n(29479),c_=n(36102),cS=n(71914),cE=n(30826),ck=n.n(cE),cT=n(34495),cR=n(30084),cD=n(67696),cI=(0,w.memo)(c_.Z),cG=(0,p.X)({root:[g.l0.colWithGap(8),g.l0.height("100%"),g.l0.width("100%"),g.l0.overflow("auto"),g.l0.zIndex(2),g.l0.align.center,g.l0.py(16),g.l0.px(16),g.l0.borderRadius(8),(0,eD._)({margin:"0 auto"},"@media only screen and (min-width: ".concat(cC.j.tabletMin,"px)"),g.l0.px(32))],header:[g.l0.rowWithGap(4),g.l0.height(30),g.l0.width("100%"),g.l0.align.center],markdownContainer:[g.l0.width("100%"),{"& .rendered-markdown":[g.l0.flex.column,g.l0.center],"& .rendered-markdown > *":[g.l0.maxWidth(840),g.l0.width("100%")],"& .rendered-markdown > table":g.l0.maxWidth("100%")}]});function cB(e){var t,n,r=(0,y.Z)().fs,i=(0,a._)((t=(0,w.useRef)(!1),n=(0,w.useRef)(null),[(0,cx.Z)(function(){t.current=!0,n.current&&clearTimeout(n.current),n.current=setTimeout(function(){t.current=!1},150)},{type:"throttle",wait:37.5}),t]),2),o=i[0],l=i[1],s=(0,w.useRef)(null),u=(0,cw.T)(),d=e.path,f=e.performPaneOperation;(0,Z.L5)(function(){return{actions:[{label:"Open in Editor",icon:(0,c.tZ)(oV.Z,{}),type:"action",run:function(){f({operation:"replace",pane:{type:"codeEditor",data:{path:d}}})}}]}},[f,d]);var p=e.isHidden,m=(0,cD.p5)();(0,w.useEffect)(function(){if(!p){var e=ck()(function(e){(0,cT.Z)(e,{behavior:u?"auto":"smooth",scrollMode:"if-needed"})},100),t=ck()(function(t){if(d===(null==t?void 0:t.path)&&t&&!l.current){var n=s.current?function(e,t){var n=e.querySelectorAll(".rendered-markdown [data-sourcepos]");if(!(null==n?void 0:n.length))return null;var r=Array.from(n).reverse(),i=t.line,o=t.column,l=!0,c=!1,s=void 0;try{for(var u,d=r[Symbol.iterator]();!(l=(u=d.next()).done);l=!0){var f=u.value,h=f.dataset.sourcepos;if(!h)throw Error("Expected data source pos on selected element");var p=(0,a._)(h.split("-"),2),m=p[0],v=p[1],g=(0,a._)(m.split(":").map(Number),2),y=g[0],b=g[1],Z=(0,a._)(v.split(":").map(Number),2),w=Z[0],x=Z[1];if(i>=y&&o>=b&&(i<w||i===w&&o<=x))return f}}catch(e){c=!0,s=e}finally{try{l||null==d.return||d.return()}finally{if(c)throw s}}}(s.current,t.position):null;n&&e(n)}},200),n=m.subscribe(t);return function(){t.cancel(),e.cancel(),n()}}},[m,p,u,d]);var v=(0,a._)((0,w.useState)(null),2),g=v[0],b=v[1];return((0,w.useEffect)(function(){return b(null),r.watchTextFile(d,{onReady:function(e){b(e.initialContent.toString())},onChange:function(e){b(e.latestContent)},onMoveOrDelete:function(e){e.eventType===cR.kS.Delete&&f({operation:"replace",pane:{type:"commands",data:{autoFocus:!0}}})}})},[d,r,f]),null===g)?(0,c.tZ)(cS.Z,{preventHighlightBorder:!0}):(0,c.BX)(R.G,{css:cG.root,innerRef:o,children:[(0,c.BX)(R.G,{css:cG.header,children:[(0,c.tZ)(oz.Z,{}),(0,c.BX)(h.xv,{color:"dimmer",multiline:!1,children:["Preview of ",(0,c.tZ)("a",{href:"#".concat(d),children:d})]})]}),(0,c.tZ)(R.G,{innerRef:s,css:cG.markdownContainer,children:(0,c.tZ)(cI,{path:d,source:g,fs:r,sourcePos:!0})})]})}var cA=s.Dy.Object({type:s.Dy.Literal("markdown"),data:s.Dy.Object({path:s.Dy.String({minLength:1})})}),cP={Content:function(e){var t=e.pane,n=e.options;return(0,c.tZ)(cB,{path:t.data.path,isHidden:!!n.isHidden,performPaneOperation:n.performPaneOperation})},Icon:function(e){var t=e.size;return(0,c.tZ)(cZ.Z,{fill:"currentColor",size:t})},getTitle:function(e){return e.data.path?(0,x.UO)(e.data.path):"Markdown"},decode:function(e){return u.B4.Decode(cA,e)}},cN=n(80259),cU=s.Dy.Object({type:s.Dy.Literal("media"),data:s.Dy.Object({path:s.Dy.String()})}),cO={Content:function(e){var t=e.pane,n=e.options;return(0,c.tZ)(cL,{path:t.data.path,performPaneOperation:n.performPaneOperation})},Icon:function(e){var t=e.pane,n=e.size;return(0,c.tZ)(f.Z,{path:t.data.path,size:n})},getTitle:function(e){return(0,x.UO)(e.data.path)},decode:function(e){return u.B4.Decode(cU,e)}};function cL(e){var t=e.path,n=e.performPaneOperation,r=(0,y.Z)().fs,i=(0,b.Mp)({path:t,performPaneOperation:n}),o=i?(0,l._)(i):[],a={match:cN.pl,data:{label:"Open in Editor",icon:(0,c.tZ)(oV.Z,{}),type:"action",run:function(){n({operation:"replace",pane:{type:"codeEditor",data:{path:t}}})}}};return(0,x.B4)(t)&&o.push(a),(0,Z.L5)(function(){if(i)return{commands:o}},[i]),(0,c.BX)(c.HY,{children:[(0,c.tZ)(b.HK,{path:t,performPaneOperation:n}),(0,c.tZ)(b.VY,{centered:!0,children:(0,c.tZ)(e2.Z,{filePath:t,fs:r})})]})}var cM=n(26544),cX=n(48728),cF=n(28268),cW=function(e){(0,nv.j)(nv.U3.DATABASE_USED,(0,A._)({type:"PostgreSQL",provider:"neon"},e))},cH="DATABASE_URL",cV="PGDATABASE",cz="PGHOST",cj="PGPORT",cq="5432",cY="PGUSER",c$="PGPASSWORD",cJ=function(e){var t=e.envVarKey,n=e.envVarValue,r=e.isSecret,i=(0,aS.U)()("db-env-var-".concat(t)),o=(0,a._)((0,w.useState)(!1),2),l=o[0],s=o[1];return(0,c.BX)(R.G,{css:[g.l0.flex.row,g.l0.flex.wrap,g.l0.align.end,g.l0.pb(8),{gap:g.TV.space8}],children:[(0,c.BX)(R.G,{css:[g.l0.colWithGap(8),{flexBasis:250},g.l0.flex.grow(0),g.l0.flex.shrink(1)],children:[(0,c.tZ)("label",{css:g.l0.color.foregroundDimmer,htmlFor:i,children:t}),(0,c.tZ)(U.II,{id:i,type:!r||l?"text":"password",readOnly:!0,value:n})]}),(0,c.tZ)(L.zx,{text:"Copy",iconLeft:(0,c.tZ)(cX.Z,{}),onClick:function(){(0,O.Z)(n),cW({action:"envVarCopied",envVarKey:t,envVarType:"value"})}}),r?(0,c.tZ)(L.zx,{text:"View",iconLeft:(0,c.tZ)(oz.Z,{}),onClick:function(){return s(function(e){return!e})}}):null]})},cK=function(e){var t,n=e.connectionString,r=e.databaseName,i=new URL(n.replace("postgres://","https://")),o=i.host,a=i.username,l=i.password;return t={},(0,eD._)(t,cH,n),(0,eD._)(t,cV,r),(0,eD._)(t,cz,o),(0,eD._)(t,cj,cq),(0,eD._)(t,cY,a),(0,eD._)(t,c$,l),t},cQ=function(){var e=(0,y.Z)().fs;return(0,w.useCallback)(function(t){var n=cK({connectionString:t.connectionString,databaseName:t.databaseName});function r(){return(r=(0,to._)(function(){var t,r,i,o,l,c,s,u,d,f,h,p,m,v;return(0,ta.Jh)(this,function(g){switch(g.label){case 0:return[4,e.readFile(".env")];case 1:if(t=g.sent(),r="",t.error){if(t.error===cR.Df.NotFound)r="";else throw Error("Error getting .env")}else r=t.content;i=cF.Z.parse(r.toString()),o=!1,l=(0,A._)({},i),c=!0,s=!1,u=void 0;try{for(d=Object.entries(n)[Symbol.iterator]();!(c=(f=d.next()).done);c=!0)p=(h=(0,a._)(f.value,2))[0],m=h[1],l[p]!==m&&(o=!0,l[p]=m)}catch(e){s=!0,u=e}finally{try{c||null==d.return||d.return()}finally{if(s)throw u}}if(!o)return[2];return v=cF.Z.serialize(l),[4,e.writeFile(".env",tT.Z.from(v))];case 2:return g.sent(),[2]}})})).apply(this,arguments)}!function(){r.apply(this,arguments)}()},[e])},c0=function(e){var t=e.connectionString,n=e.databaseName,r=(0,B.Z)(function(){return cK({connectionString:t,databaseName:n})},[t,n]),i=r[cz],o=r[cY],a=r[c$],l=cQ();return(0,w.useEffect)(function(){l({connectionString:t,databaseName:n})},[t,n,l]),(0,c.BX)(R.G,{css:[g.l0.colWithGap(8)],children:[(0,c.tZ)(cJ,{envVarKey:cH,envVarValue:t,isSecret:!0}),(0,c.tZ)(cJ,{envVarKey:cV,envVarValue:n}),(0,c.tZ)(cJ,{envVarKey:cz,envVarValue:i}),(0,c.tZ)(cJ,{envVarKey:cj,envVarValue:cq}),(0,c.tZ)(cJ,{envVarKey:cY,envVarValue:o}),(0,c.tZ)(cJ,{envVarKey:c$,envVarValue:a,isSecret:!0})]})},c1=n(52682),c2=n(63999),c8=n(66587),c4=n(55330),c3=n(81340),c5=n(76566),c6=n(50946),c9=n(4773),c7=n(63623);function se(){var e=(0,ey._)(["\n  query DatabaseFrozen {\n    currentUser {\n      id\n      userSubscriptionType\n      ...CurrentUserUsageBasedBillingSummary\n    }\n  }\n  ","\n"]);return se=function(){return e},e}var st={},sn=(0,eb.Ps)(se(),c7.eD);function sr(){var e=(0,ey._)(["\n  mutation CreateNeonDatabase($input: CreateNeonDatabaseInput!) {\n    createNeonDatabase(input: $input) {\n      __typename\n      ... on UserError {\n        message\n      }\n      ... on UnauthorizedError {\n        message\n      }\n      ... on CreateNeonDatabaseResult {\n        databaseId\n        databaseName\n        projectId\n        connectionString\n        isFrozen\n        isBackedByCycles\n      }\n    }\n  }\n"]);return sr=function(){return e},e}function si(){var e=(0,ey._)(["\n  mutation DeleteNeonDatabase($input: DeleteNeonDatabaseInput!) {\n    deleteNeonDatabase(input: $input) {\n      __typename\n      ... on UserError {\n        message\n      }\n      ... on UnauthorizedError {\n        message\n      }\n      ... on DeleteNeonDatabaseResult {\n        success\n      }\n    }\n  }\n"]);return si=function(){return e},e}function so(){var e=(0,ey._)(["\n  query GetNeonDatabases($input: GetNeonDatabasesInput!) {\n    getNeonDatabases(input: $input) {\n      __typename\n      ... on UserError {\n        message\n      }\n      ... on UnauthorizedError {\n        message\n      }\n      ... on GetNeonDatabasesResult {\n        databases {\n          databaseId\n          databaseName\n          projectId\n          connectionString\n          isFrozen\n          isBackedByCycles\n        }\n      }\n    }\n  }\n"]);return so=function(){return e},e}function sa(){var e=(0,ey._)(["\n  mutation UnfreezeNeonDatabase($input: UnfreezeNeonDatabaseInput!) {\n    unfreezeNeonDatabase(input: $input) {\n      ... on UnfreezeNeonDatabaseResult {\n        success\n      }\n    }\n  }\n"]);return sa=function(){return e},e}var sl={},sc=(0,eb.Ps)(sr());function ss(e){var t=(0,A._)({},sl,e);return ak.D(sc,t)}var su=(0,eb.Ps)(si());function sd(e){var t=(0,A._)({},sl,e);return ak.D(su,t)}var sf=(0,eb.Ps)(so()),sh=(0,eb.Ps)(sa());function sp(e){var t=(0,A._)({},sl,e);return ak.D(sh,t)}var sm=(0,p.X)({self:[],title:[g.l0.rowWithGap(8),g.l0.align.center,g.l0.color.foregroundDimmest],status:[g.l0.width(8),g.l0.height(8),g.l0.backgroundColor.foregroundDimmer,g.l0.borderRadius("full")],main:[g.l0.colWithGap(8),g.l0.align.center],icon:g.l0.mt(32),subTitle:g.l0.my(16),cta:[g.l0.width("100%"),g.l0.maxWidth(320),{marginLeft:"auto",marginRight:"auto"}],ctaContainer:[g.l0.colWithGap(8),g.l0.align.center],ctaStatusBanner:[g.l0.textAlign.left],budgetContainer:[g.l0.colWithGap(8),g.l0.border(),g.l0.borderRadius(8),g.l0.p(8)]});function sv(e){var t=e.loading,n=e.ubbExplanation,r=e.hasPaymentMethod,i=e.handleOnUnpause,o=e.refetchUbbCapabilitiesQueryData,a=e.setShowPaymentMethodForm,l=e.showPaymentMethodForm,s=e.setShowSupportForm,u=(0,ap.rv)();return n===aE.Fp.NeedsSubscription||n===aE.Fp.NeedsSubscriptionOrPaymentMethod?u?(0,c.tZ)(rC.E,{text:"You need a subscription to use PostgreSQL databases. Navigate to Account > Billing to upgrade.",colorway:"warning",icon:(0,c.tZ)(n9.Z,{}),css:sm.ctaStatusBanner}):(0,c.BX)(R.G,{css:sm.ctaContainer,children:[(0,c.tZ)(c9.Z,{context:"workspace_hosting_pane",text:"Upgrade your plan to unpause database",css:sm.cta,colorway:"primary",variant:"outlined",disabled:l,onPlanCheckoutComplete:o}),(0,c.tZ)(L.zx,{variant:"nofill",colorway:"primary",text:"or add a payment method",css:sm.cta,disabled:l,loading:t,iconLeft:(0,c.tZ)(c6.Z,{}),onClick:function(){return a()}})]}):n===aE.Fp.NeedsSmsVerification?(0,c.tZ)(c8.Z,{context:aE.jv.Neon,onSuccess:o}):n===aE.Fp.NeedsPaymentMethod?u?(0,c.tZ)(rC.E,{text:"You have used all free usage for this month. Check your email for more information or contact support.",colorway:"warning",icon:(0,c.tZ)(n9.Z,{}),css:sm.ctaStatusBanner}):(0,c.tZ)(L.zx,{colorway:"primary",text:"Add a payment method",css:sm.cta,disabled:l,loading:t,iconLeft:(0,c.tZ)(c6.Z,{}),onClick:function(){return a()}}):n===aE.Fp.NeedsUnbanning?(0,c.tZ)(c5.u,{text:"Your account currently has restrictions on use PostgreSQL databases. We're here to help! Please reach out to our support team for assistance.",colorway:"warning",icon:(0,c.tZ)(n9.Z,{}),css:sm.ctaStatusBanner,onClick:function(){return s()}}):n===aE.Fp.InsufficientBudget?(0,c.BX)(c.HY,{children:[(0,c.tZ)(rC.E,{text:"You've reached your monthly usage budget. Increase your budget to unpause your database.",colorway:"warning",icon:(0,c.tZ)(n9.Z,{}),css:sm.ctaStatusBanner}),(0,c.tZ)(R.G,{css:sm.budgetContainer,children:(0,c.tZ)(c3.L,{onUpdateSuccess:o})})]}):(0,c.BX)(c.HY,{children:[(0,c.tZ)(L.zx,{colorway:"primary",onClick:i,text:"Unpause database",loading:t,css:sm.cta}),!1===r?(0,c.tZ)(c5.u,{text:"Add a payment method to avoid downtime",colorway:"warning",icon:(0,c.tZ)(n9.Z,{}),css:sm.ctaStatusBanner,onClick:function(){return u?null:a()}}):null]})}function sg(e){var t,n,r=e.replId,i=e.neonProjectId,o=e.onDatabaseUnfreezed,l=(0,a._)((0,w.useState)(!1),2),s=l[0],u=l[1],d=(0,a._)((0,w.useState)(!1),2),f=d[0],p=d[1],m=(0,o9.Z)().showError,v=(t=(0,A._)({},st,{notifyOnNetworkStatusChange:!0,onError:function(e){m(e.message)}}),eZ.a(sn,t)),y=v.loading,b=v.data,Z=v.refetch,x=(0,a._)(sp({onError:function(e){m("Error when unfreezing Neon database: ".concat(e.message)),cW({action:"unfreeze",success:!1})},onCompleted:function(e){if((null==e?void 0:e.unfreezeNeonDatabase.__typename)!=="UnfreezeNeonDatabaseResult"){m("Error: Unfreezes Neon Database failed."),cW({action:"unfreeze",success:!1});return}(null==e?void 0:e.unfreezeNeonDatabase.success)?(o(),cW({action:"unfreeze",success:!0})):(m("Error: Unfreezes Neon Database failed."),cW({action:"unfreeze",success:!1}))}}),2),C=x[0],_=x[1].loading,S=(null==b?void 0:null===(n=b.currentUser)||void 0===n?void 0:n.usageBasedBilling.__typename)==="UserUsageBasedBillingSummary"?b.currentUser.usageBasedBilling.capabilities:null;return(0,c.BX)(R.G,{css:sm.self,children:[(0,c.tZ)(rx.u,{isOpen:f,onRequestClose:function(){return p(!1)},children:(0,c.tZ)(c4.Z,{onRequestClose:function(){return p(!1)}})}),(0,c.BX)(R.G,{css:sm.title,children:[(0,c.tZ)(R.G,{css:sm.status}),(0,c.tZ)(h.xv,{css:[g.l0.color.foregroundDimmest],multiline:!1,children:"Database paused"})]}),(0,c.BX)(R.G,{css:sm.main,children:[(0,c.tZ)(tW.Z,{size:32,fill:eN.TV.foregroundDimmest,css:sm.icon}),(0,c.tZ)(h.xv,{variant:"subheadDefault",css:sm.subTitle,multiline:!1,children:"Your Database is paused."}),(0,c.tZ)(sv,{loading:y||_,ubbExplanation:null==S?void 0:S.explanation,hasPaymentMethod:null==S?void 0:S.hasPaymentMethod,handleOnUnpause:function(){C({variables:{input:{replId:r,neonProjectId:i}}})},refetchUbbCapabilitiesQueryData:Z,setShowPaymentMethodForm:function(){return u(!0)},showPaymentMethodForm:s,setShowSupportForm:function(){return p(!0)}})]})]})}var sy=n(60814),sb=n(22894),sZ=n(15250),sw=n(57118),sx=n(47648),sC=n(51965),s_=function(e){var t=e.title,n=e.children,r=e.isAccordion,i=e.sectionStyles;return(0,c.tZ)(R.G,{css:[g.l0.colWithGap(8),g.l0.pt(8),{borderTopWidth:1,borderTopStyle:"solid",borderTopColor:g.TV.outlineDefault},i],children:r?(0,c.tZ)(el.Q,{headerContent:(0,c.tZ)(R.G,{css:[g.l0.rowWithGap(8),g.l0.align.center],children:(0,c.tZ)(h.xv,{variant:"subheadDefault",multiline:!1,children:t})}),children:(0,c.tZ)(R.G,{css:[g.l0.p(12),g.l0.colWithGap(8),g.l0.height("100%")],children:n})}):(0,c.BX)(c.HY,{children:[(0,c.tZ)(h.xv,{multiline:!1,css:[g.l0.fontSize(g.TV.fontSizeSubheadDefault),g.l0.fontWeight.medium],children:t}),n]})})},sS=n(97764);function sE(){var e=(0,ey._)(["\n  query DatabaseMigrator {\n    currentUser {\n      id\n      userSubscriptionType\n      ...CurrentUserUsageBasedBillingSummary\n    }\n  }\n  ","\n"]);return sE=function(){return e},e}function sk(){var e=(0,ey._)(["\n  mutation MigrateNeonDatabase($input: MigrateNeonDatabaseInput!) {\n    migrateNeonDatabase(input: $input) {\n      __typename\n      ... on UserError {\n        message\n      }\n      ... on UnauthorizedError {\n        message\n      }\n      ... on NotFoundError {\n        message\n      }\n      ... on MigrateNeonDatabaseResult {\n        databaseId\n        databaseName\n        projectId\n        connectionString\n        isFrozen\n        isBackedByCycles\n      }\n    }\n  }\n"]);return sk=function(){return e},e}var sT={},sR=(0,eb.Ps)(sE(),c7.eD),sD=(0,eb.Ps)(sk()),sI=(0,p.X)({self:[g.l0.mb(12)],container:[g.l0.colWithGap(8)],message:[{"> div":[g.l0.align.start,g.l0.py(4)],span:[g.l0.colWithGap(6)]}],messageBold:[g.l0.fontWeight.bold],cta:[g.l0.width("100%"),{marginLeft:"auto",marginRight:"auto"}],ctaContainer:[g.l0.colWithGap(8),g.l0.align.center],ctaStatusBanner:[g.l0.textAlign.left],payment:[g.l0.p(16),g.l0.borderRadius(12),g.l0.textAlign.left,g.l0.shadow(2)],budgetContainer:[g.l0.colWithGap(8),g.l0.border(),g.l0.borderRadius(8),g.l0.p(8)],details:[g.l0.colWithGap(12),g.l0.maxWidth(400),{marginLeft:"auto",marginRight:"auto"}]});function sG(e){var t=e.loading,n=e.ubbExplanation,r=e.hasPaymentMethod,i=e.handleOnMigrate,o=e.refetchUbbCapabilitiesQueryData,a=e.setShowPaymentMethodForm,l=e.showPaymentMethodForm,s=e.setShowSupportForm,u=(0,ap.rv)();return n===aE.Fp.NeedsSubscription||n===aE.Fp.NeedsSubscriptionOrPaymentMethod?u?(0,c.tZ)(rC.E,{text:"You need a subscription to migrate a database. Navigate to Account > Billing to upgrade.",colorway:"warning",icon:(0,c.tZ)(n9.Z,{}),css:sI.ctaStatusBanner}):(0,c.BX)(R.G,{css:sI.ctaContainer,children:[(0,c.tZ)(c9.Z,{context:"workspace_hosting_pane",text:"Upgrade your plan to migrate your database",css:sI.cta,colorway:"primary",variant:"outlined",disabled:l,onPlanCheckoutComplete:o}),(0,c.tZ)(L.zx,{variant:"nofill",colorway:"primary",text:"or add a payment method",css:sI.cta,disabled:l,loading:t,iconLeft:(0,c.tZ)(c6.Z,{}),onClick:function(){return a()}})]}):n===aE.Fp.NeedsSmsVerification?(0,c.tZ)(c8.Z,{context:aE.jv.Neon,onSuccess:o}):n===aE.Fp.NeedsPaymentMethod?u?(0,c.tZ)(rC.E,{text:"You have used all free usage for this month. Check your email for more information or contact support.",colorway:"warning",icon:(0,c.tZ)(n9.Z,{}),css:sI.ctaStatusBanner}):(0,c.tZ)(L.zx,{colorway:"primary",text:"Add a payment method",css:sI.cta,disabled:l,loading:t,iconLeft:(0,c.tZ)(c6.Z,{}),onClick:function(){return a()}}):n===aE.Fp.NeedsUnbanning?(0,c.tZ)(c5.u,{text:"Your account currently has restrictions on migrating a database. We're here to help! Please reach out to our support team for assistance.",colorway:"primary",icon:(0,c.tZ)(la.Z,{}),css:sI.ctaStatusBanner,onClick:function(){return s()}}):n===aE.Fp.InsufficientBudget?(0,c.BX)(c.HY,{children:[(0,c.tZ)(rC.E,{text:"You've reached your monthly usage budget. Increase your budget to migrate your database.",colorway:"warning",icon:(0,c.tZ)(n9.Z,{}),css:sI.ctaStatusBanner}),(0,c.tZ)(R.G,{css:sI.budgetContainer,children:(0,c.tZ)(c3.L,{onUpdateSuccess:o})})]}):(0,c.BX)(c.HY,{children:[(0,c.tZ)(L.zx,{colorway:"primary",onClick:i,text:"Migrate database",loading:t,css:sI.cta}),!1===r?(0,c.tZ)(c5.u,{text:"Add a payment method to avoid downtime",colorway:"warning",icon:(0,c.tZ)(n9.Z,{}),css:sI.ctaStatusBanner,onClick:function(){return u?null:a()}}):null]})}var sB=function(e){var t,n,r,i=e.onDatabaseMigrated,o=(0,a._)((0,w.useState)(!1),2),l=o[0],s=o[1],u=(0,a._)((0,w.useState)(!1),2),d=u[0],f=u[1],h=(0,eg.Z)(),p=(0,o9.Z)().showError,m=(t=(0,A._)({},sT,{notifyOnNetworkStatusChange:!0,onError:function(e){p(e.message)}}),eZ.a(sR,t)),v=m.loading,g=m.data,y=m.refetch,b=(0,a._)((n=(0,A._)({},sT,{onError:function(e){p("Error when migrating Neon database: ".concat(e.message)),cW({action:"migrated",success:!1})},onCompleted:function(e){if("MigrateNeonDatabaseResult"===e.migrateNeonDatabase.__typename){var t=e.migrateNeonDatabase;i({__typename:"NeonDatabase",databaseId:t.databaseId,databaseName:t.databaseName,connectionString:t.connectionString,projectId:t.projectId,isFrozen:t.isFrozen,isBackedByCycles:t.isBackedByCycles}),cW({action:"migrated",success:!0})}else{p("Error: ".concat(e.migrateNeonDatabase.message)),cW({action:"migrated",success:!1});return}}}),ak.D(sD,n)),2),Z=b[0],x=b[1].loading,C=(null==g?void 0:null===(r=g.currentUser)||void 0===r?void 0:r.usageBasedBilling.__typename)==="UserUsageBasedBillingSummary"?g.currentUser.usageBasedBilling.capabilities:null;return(0,c.BX)(R.G,{css:sI.self,children:[(0,c.tZ)(rx.u,{isOpen:d,onRequestClose:function(){return f(!1)},children:(0,c.tZ)(c4.Z,{onRequestClose:function(){return f(!1)}})}),(0,c.BX)(R.G,{css:sI.container,children:[(0,c.tZ)(rC.E,{css:sI.message,icon:(0,c.tZ)(n9.Z,{}),text:(0,c.BX)(c.HY,{children:[(0,c.BX)("p",{children:[(0,c.tZ)("span",{css:sI.messageBold,children:"Postgres databases are now included in plans!"})," ","Instead of paying $30/mo for a single database, our plans now have a base allotment for no extra cost. The base allotment is enough resources for most use cases. Users will only be charged for the resources they use beyond their allotment. Learn more."]}),(0,c.tZ)("p",{children:(0,c.tZ)("span",{css:sI.messageBold,children:"On January 1st, 2024, all PostgreSQL databases that have not been migrated will be shut down."})}),(0,c.tZ)("p",{children:"To migrate, select one of the options below."})]}),colorway:"warning"}),(0,c.tZ)(sG,{loading:v||x,ubbExplanation:null==C?void 0:C.explanation,hasPaymentMethod:null==C?void 0:C.hasPaymentMethod,handleOnMigrate:function(){Z({variables:{input:{replId:h}}})},refetchUbbCapabilitiesQueryData:y,setShowPaymentMethodForm:function(){return s(!0)},showPaymentMethodForm:l,setShowSupportForm:function(){return f(!0)}}),l?(0,c.tZ)(M.Tg,{elevated:!0,css:sI.payment,children:(0,c.tZ)(sS.q,{onSuccess:(0,to._)(function(){return(0,ta.Jh)(this,function(e){switch(e.label){case 0:return s(!1),[4,y()];case 1:return e.sent(),[2]}})}),context:"workspace_hosting_pane"})}):null]})]})},sA=n(23211),sP=n(40699),sN=sP.z4["neon-database-preview"],sU=(0,sP.qJ)(sN),sO="".concat(sN.toLocaleString()," Cycles (").concat(sU,") / day"),sL="https://docs.replit.com/hosting/databases/postgresql-on-replit",sM="https://docs.replit.com/hosting/about-usage-based-billing#1-postgresql-usage-metrics",sX=function(e){var t=e.cyclesLow;return(0,c.BX)(c.HY,{children:[(0,c.tZ)(h.xv,{css:[g.l0.fontSize(12),g.l0.color.foregroundDimmest],children:"Youre paying ".concat(sO)}),t?(0,c.tZ)(R.G,{children:(0,c.tZ)(rC.E,{icon:(0,c.tZ)(n9.Z,{}),colorway:"warning",text:"If your database use continues, you will be out of\n Cycles in [X] days and access to your database will be paused. \n Buy more Cycles or add a recurring Cycles subscription to prevent that from happening."})}):null]})},sF=n(18561);function sW(e){var t=e.title,n=e.doWarnAtom,r=e.inactive,i=(0,tK.Dv)(n);return(0,c.BX)(R.G,{css:[g.l0.rowWithGap(4),g.l0.align.center],children:[(0,c.tZ)(h.xv,{variant:"small",css:g.l0.color.foregroundDimmer,multiline:!1,children:void 0!==r&&r?t+" last run":t}),i?(0,c.tZ)(n9.Z,{color:g.TV.orangeStronger}):null]})}function sH(e){var t=e.title,n=e.totalAtom,r=e.currentAtom,i=e.countAtom,o=e.measure,a=e.limitText,l=e.inactive,s=void 0!==l&&l,u=(0,B.Z)(function(){return(0,tQ.cn)(function(e){return sz(e(r),e(n))})},[r,n]),d=(0,B.Z)(function(){return(0,tQ.cn)(function(e){var t,l,c,s;return a||(t=e(u),l=e(r),c=e(n),s=i&&e(i),"empty"===t||void 0===l?void 0:"vCPU"===o?sj(100*Math.min(1,l/c))+"% of "+s+" vCPUs":sj(l).toLocaleString()+"/"+sj(c).toLocaleString()+" "+o)})},[a,u,r,n,i,o]),f=(0,B.Z)(function(){return(0,tQ.cn)(function(e){var t=e(u);return"At limit"===t||"Close to limit"===t})},[u]);return(0,c.BX)(R.G,{css:[g.l0.colWithGap(4),g.l0.flex.growAndShrink(2),{flexBasis:32}],children:[t?(0,c.tZ)(sW,{title:t,doWarnAtom:f,inactive:s}):null,(0,c.tZ)(sV,{currentAtom:r,totalAtom:n,inactive:s,limitTextAtom:d,mini:!0})]})}function sV(e){var t=e.currentAtom,n=e.totalAtom,r=e.limitTextAtom,i=e.inactive,o=e.mini,a=(0,tK.Dv)(n),l=(0,tK.Dv)(t),s=(0,tK.Dv)(r),u=function(e){switch(e){case"empty":case"fine":default:return;case"At limit":return g.TV.accentNegativeDefault;case"Close to limit":return g.TV.orangeDefault}}(sz(l,a));return(0,c.tZ)(eh.J,{css:o&&g.l0.height(8),total:a,current:l,color:u,disabled:i,tooltip:s})}function sz(e,t){if(void 0===e)return"empty";var n=e/t;return n>=1?"At limit":n>=.9?"Close to limit":"fine"}function sj(e){return Math.round((e+Number.EPSILON)*100)/100}var sq=n(33988),sY=n.n(sq),s$=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],sJ=["B","KB","MB","GB","TB","PB","EB","ZB","YB"];function sK(e,t){var n,r=t||{},i=r.signed,o=r.digitsNumber,a=r.isKib,l=r.isKibNotation;if(n=void 0!==i&&i?e<0?"-":"+":"",0===e)return"".concat(n,"0B");var c=void 0===a||a?1024:1e3,s=Math.floor(Math.log(Math.abs(e))/Math.log(c));return"".concat(n).concat(parseFloat(Math.abs(e/Math.pow(c,s)).toFixed(void 0===o?2:o))).concat((void 0!==l&&l?s$:sJ)[s])}var sQ=n(40102),s0=n(54277),s1=n(46053),s2=n(13729),s8=n(32665),s4={"td,th":{border:"1px solid "+g.TV.outlineDefault}},s3={"td,th":{paddingLeft:8,paddingTop:8,paddingBottom:8,paddingRight:8,whiteSpace:"nowrap"},"td:first-of-type,th:first-of-type":{paddingLeft:8}},s5={outline:"2px solid ".concat(g.TV.accentPrimaryDefault),outlineOffset:"-2px"},s6=(0,eu.iv)({":focus:focus-visible":s5}),s9=(0,eu.iv)(s5),s7=(0,eu.iv)([s3,s4,s6]),ue=(0,eu.iv)([g.l0.fontWeight.medium,s3,s4,s6]),ut=(0,eu.iv)({"tbody > tr:hover":{backgroundColor:g.TV.backgroundHigher,cursor:"pointer"}});function un(e){var t=e.type,n=e.style,r=e.children,i=(0,s0.LA)().rowGroupProps;return(0,c.tZ)(t,(0,P._)((0,A._)({},i),{style:n,children:r}))}function ur(e){var t=e.item,n=e.state,r=e.children,i=(0,w.useRef)(null),o=(0,s0.Qm)({node:t},n,i).rowProps;return(0,c.tZ)("tr",(0,P._)((0,A._)({css:ue},o),{ref:i,children:r}))}function ui(e){var t,n=e.column,r=e.state,i=(0,w.useRef)(null),o=(0,s0.WY)({node:n},r,i).columnHeaderProps,a=(0,s1.Fx)(),l=a.isFocusVisible,s=a.focusProps;return(0,c.tZ)("th",(0,P._)((0,A._)({},(0,s2.dG)(o,s)),{css:[l&&s9,s6],colSpan:n.colspan,style:{textAlign:(null!==(t=n.colspan)&&void 0!==t?t:1)>1?"center":"left"},ref:i,children:n.rendered}))}function uo(e){var t=e.item,n=e.children,r=e.state,i=(0,w.useRef)(null),o=(0,s0.U)({node:t},r,i).rowProps,a=(0,s1.Fx)(),l=a.isFocusVisible,s=a.focusProps;return(0,c.tZ)("tr",(0,P._)((0,A._)({css:[l&&s9,s7]},(0,s2.dG)(o,s)),{ref:i,children:n}))}function ua(e){var t=e.cell,n=e.state,r=(0,w.useRef)(null),i=(0,s0.fs)({node:t},n,r).gridCellProps,o=(0,s1.Fx)(),a=o.isFocusVisible,l=o.focusProps;return(0,c.tZ)("td",(0,P._)((0,A._)({},(0,s2.dG)(i,l)),{css:[a&&s9,s6],ref:r,children:t.rendered}))}function ul(e){var t=e.selectionMode,n=e.selectionBehavior,r=(0,s8.oy)((0,P._)((0,A._)({},e),{showSelectionCheckboxes:"multiple"===t&&"replace"!==n})),i=(0,w.useRef)(null),o=r.collection,a=(0,s0.x6)(e,r,i).gridProps;return(0,c.BX)("table",(0,P._)((0,A._)({},a),{ref:i,css:[(null==e?void 0:e.onRowAction)&&ut],style:{borderCollapse:"collapse"},children:[(0,c.tZ)(un,{type:"thead",children:o.headerRows.map(function(e){return(0,c.tZ)(ur,{item:e,state:r,children:(0,l._)(e.childNodes).map(function(e){return(0,c.tZ)(ui,{column:e,state:r},e.key)})},e.key)})}),(0,c.tZ)(un,{type:"tbody",children:(0,l._)(o.body.childNodes).map(function(e){return(0,c.tZ)(uo,{item:e,state:r,children:(0,l._)(e.childNodes).map(function(e){return(0,c.tZ)(ua,{cell:e,state:r},e.key)})},e.key)})})]}))}var uc=function(e){var t=e.ariaTableProps,n=e.rows,r=e.columns;return(0,c.BX)(ul,(0,P._)((0,A._)({},t),{children:[(0,c.tZ)(s8.xD,{columns:r,children:function(e){return(0,c.tZ)(s8.sg,{children:e.value})}}),(0,c.tZ)(s8.RM,{items:n,children:function(e){return(0,c.tZ)(s8.X2,{children:function(t){return(0,c.tZ)(s8.bL,{children:e[t]})}})}})]}))};function us(e){var t=e.headerColumns,n=e.bodyData,r=e.ariaLabel,i=e.scrollRef,o=e.onRowAction,a=t.map(function(e,t){return{key:"string"==typeof e?e:"".concat(t),value:e}}),l=n.map(function(e,n){for(var r={id:n},i=0;i<e.length;i++){var o=t[i];r["string"==typeof o?o:"".concat(i)]=e[i]}return r});return(0,c.tZ)(uc,{ariaTableProps:{selectionMode:"none","aria-label":void 0===r?"Database Table":r,onRowAction:o,scrollRef:i},columns:a,rows:l})}var uu=(0,tQ.cn)(["databaseManager"]),ud=(0,tQ.cn)(null,function(e,t,n){var r=e(uu);t(uu,(0,l._)(r).concat([n])),cW({action:"pageNav",databasePage:n})}),uf=(0,tQ.cn)(null,function(e,t){var n=e(uu);t(uu,n.slice(0,n.length-1))}),uh=(0,tQ.cn)(function(e){var t=e(uu);return t[t.length-1]}),up=function(){return(0,tK.Dv)(uh)},um=function(){return(0,tK.b9)(ud)},uv=function(){return(0,tK.b9)(uf)},ug=function(e,t){var n,r=(0,y.Z)().psql,i=(0,a._)((0,w.useState)(),2),o=i[0],l=i[1],c=(0,a._)((0,w.useState)(!1),2),s=c[0],u=c[1],d=(0,w.useCallback)((n=(0,to._)(function(){return(0,ta.Jh)(this,function(n){switch(n.label){case 0:if(!e)return[2];n.label=1;case 1:return n.trys.push([1,,3,4]),u(!0),[4,r.run({query:e,connectionString:t})];case 2:return l(n.sent()),[3,4];case 3:return u(!1),[7];case 4:return[2]}})}),function(){return n.apply(this,arguments)}),[t,r,e]);return(0,w.useEffect)(function(){d()},[t,r,e,d]),{data:o,loading:s,refetch:d}},uy=function(e){var t=e.rows,n=e.columns;return!Array.isArray(t)||t.length<1?null:{headerColumns:null!=n?n:[],bodyData:t.map(function(e){return Object.values(e)})}},ub=function(e){return ug("SELECT n.nspname as \"Schema\",\n  c.relname as \"Name\",\n  CASE c.relkind WHEN 'r' THEN 'table' WHEN 'v' THEN 'view' WHEN 'm' THEN 'materialized view' WHEN 'i' THEN 'index' WHEN 'S' THEN 'sequence' WHEN 's' THEN 'special' WHEN 'f' THEN 'foreign table' WHEN 'p' THEN 'partitioned table' WHEN 'I' THEN 'partitioned index' END as \"Type\",\n  pg_catalog.pg_get_userbyid(c.relowner) as \"Owner\",\n  pg_catalog.pg_size_pretty(pg_catalog.pg_total_relation_size(c.oid)) as \"Size\",\n  pg_catalog.obj_description(c.oid, 'pg_class') as \"Description\"\nFROM pg_catalog.pg_class c\n     LEFT JOIN pg_catalog.pg_namespace n ON n.oid = c.relnamespace\nWHERE c.relkind IN ('r','p','v','m','S','f','')\n      AND n.nspname <> 'pg_catalog'\n      AND n.nspname <> 'information_schema'\n      AND n.nspname !~ '^pg_toast'\n  AND pg_catalog.pg_table_is_visible(c.oid)\nORDER BY 1,2;",e.connectionString)},uZ=(0,tQ.cn)(void 0),uw=(0,tQ.cn)(function(e){var t=e(uZ);return null==t?void 0:t.rows.reduce(function(e,t){var n=t.table_name,r=t.column_name;return e[n]||(e[n]=[]),e[n].push(r),e},{})}),ux=function(e){var t=ug("SELECT table_name, column_name, data_type FROM information_schema.columns WHERE table_schema = 'public';",e.connectionString).data,n=(0,tK.b9)(uZ);(0,w.useEffect)(function(){n(t)},[t,n])},uC=function(e){var t=e.tableName,n=e.connectionString;return ug("SELECT table_name, column_name, data_type FROM information_schema.columns WHERE table_schema = 'public' AND table_name = '".concat(t.replace(/"/g,'""'),"';"),n).data},u_=function(e){var t=e.tableData,n=e.scrollRef,r=t.headerColumns,i=t.bodyData,o=um(),a=(0,w.useCallback)(function(e){var t=parseInt(String(e),10);if(!isNaN(t)){var n=i[t][r.indexOf("Name")];o("table/".concat(n))}},[o,r,i]);return(0,c.tZ)(us,{headerColumns:r,bodyData:i,onRowAction:a,scrollRef:n})},uS=function(e){var t=e.psqlQueryResult,n=e.scrollRef,r=t.data;if(t.loading)return(0,c.tZ)(R.G,{css:[g.l0.flex.row,g.l0.justify.center,g.l0.p(32)],children:(0,c.tZ)(v.Z,{})});if(null==r?void 0:r.error)return(0,c.tZ)(R.G,{css:[g.l0.flex.row,g.l0.justify.center,g.l0.p(32)],children:(0,c.tZ)(h.xv,{css:[g.l0.color.accentNegativeDefault,g.l0.maxWidth("100%")],children:null==r?void 0:r.error})});var i=r?uy(r):null;return i?(0,c.tZ)(u_,{tableData:i,scrollRef:n}):(0,c.tZ)(R.G,{css:[g.l0.flex.row,g.l0.justify.center,g.l0.p(32)],children:(0,c.tZ)(h.xv,{css:[g.l0.color.accentPositiveDefault,g.l0.maxWidth("100%")],children:"No tables found"})})},uE=function(e){var t=e.connectionString,n=uv(),r=(0,w.useRef)(null),i=ub({connectionString:t}),o=i.refetch;return(0,c.BX)(R.G,{css:[g.l0.flex.column,g.l0.height("100%")],children:[(0,c.BX)(R.G,{css:[g.l0.flex.row,g.l0.py(16),g.l0.px(8),g.l0.align.center],children:[(0,c.tZ)(d.hU,{alt:"Go back",size:28,type:"button",onClick:n,children:(0,c.tZ)(sQ.Z,{})}),(0,c.tZ)(R.G,{css:[g.l0.flex.growAndShrink(1)],children:(0,c.tZ)(h.xv,{css:[g.l0.fontSize(16),g.l0.ml(8)],multiline:!1,children:"All tables"})}),(0,c.tZ)(d.hU,{alt:"Refresh",size:24,type:"button",onClick:o,children:(0,c.tZ)(nJ.Z,{})})]}),(0,c.tZ)(R.G,{css:[g.l0.flex.growAndShrink(1),g.l0.overflow("auto"),g.l0.px(8)],innerRef:r,children:(0,c.tZ)(uS,{psqlQueryResult:i,scrollRef:r})})]})},uk="1px solid "+g.TV.outlineDefault,uT=(0,eu.iv)([g.l0.p(8),g.l0.backgroundColor.backgroundDefault,g.l0.align.center,g.l0.borderRadius(0),{borderLeft:uk,borderRight:uk,borderBottom:uk},{":not([disabled])":{":focus":{boxShadow:"none",outline:"2px solid ".concat(g.TV.accentPrimaryDefault),outlineOffset:"-2px"},":hover":{backgroundColor:g.TV.backgroundHigher}}}]),uR=function(e){var t=ub({connectionString:e.connectionString}),n=t.data,r=t.loading,i=(0,a._)((0,w.useState)(!1),2),o=i[0],l=i[1],s=(0,w.useCallback)(function(){l(!0)},[]),u=n?uy(n):null,d=(0,w.useRef)(null);if(!u||r)return null;var f=u.bodyData.length,h=u.headerColumns,p=u.bodyData;return(0,c.tZ)(c.HY,{children:(0,c.BX)(R.G,{css:[g.l0.overflow("auto"),g.l0.display.grid],innerRef:d,children:[(0,c.tZ)(u_,{tableData:{headerColumns:h,bodyData:o?p:p.slice(0,5)},scrollRef:d}),f-5>0&&!o?(0,c.tZ)(L.zx,{text:"".concat(f-5," more"),css:uT,onClick:s}):null]})})},uD=function(e){var t=e.dbSize,n=e.totalSize,r=sK(t),i=sK(n),o=(0,B.Z)(function(){return(0,tQ.cn)(t)},[t]),a=(0,B.Z)(function(){return(0,tQ.cn)(n)},[n]);return(0,c.BX)(c.HY,{children:[(0,c.BX)(h.xv,{css:g.l0.color.foregroundDimmer,multiline:!1,children:[r,"/",i]}),(0,c.tZ)(sH,{totalAtom:a,currentAtom:o,limitText:"".concat(r," / ").concat(i),inactive:!1,measure:"MB"})]})},uI=function(e){var t,n,r=e.connectionString,i=ug("SELECT sum(pg_database_size(datname)) FROM pg_database;",r),o=i.data,a=i.loading,l=ug("SELECT table_name FROM information_schema.tables WHERE table_schema = 'public' ORDER BY table_name;",r),s=l.data,u=l.loading,d=parseInt(null!==(n=null==o?void 0:null===(t=o.rows[0])||void 0===t?void 0:t.sum)&&void 0!==n?n:"0",10),f=null==s?void 0:s.rows.length;return(0,c.BX)(R.G,{css:g.l0.rowWithGap(8),children:[u?null:(0,c.BX)(h.xv,{multiline:!1,children:[f," ",1===f?"table":"tables"]}),a?null:(0,c.tZ)(uD,{dbSize:d,totalSize:10737418240})]})},uG=function(e){var t=e.connectionString,n=e.onOpenDatabaseViewerClick,r=e.showUsageLink;return(0,c.BX)(R.G,{css:[g.l0.colWithGap(8)],children:[(0,c.BX)(R.G,{children:[(0,c.tZ)(uI,{connectionString:t}),r?(0,c.tZ)(sY(),{legacyBehavior:!0,href:"/usage#postgres-storage",passHref:!0,children:(0,c.tZ)("a",{css:g.l0.hover(g.l0.color.accentPrimaryStrongest),children:(0,c.tZ)(h.xv,{children:"See all usage"})})}):null]}),(0,c.tZ)(uR,{connectionString:t}),(0,c.tZ)(L.zx,{text:"See Database Contents",iconLeft:(0,c.tZ)(sF.Z,{}),onClick:n})]})},uB=n(23291),uA=function(e){var t=e.psqlQueryResult,n=e.tableName,r=e.connectionString,i=e.scrollRef,o=t.data,a=t.loading,l=uC({tableName:n,connectionString:r});if(a)return(0,c.tZ)(R.G,{css:[g.l0.flex.row,g.l0.justify.center,g.l0.p(32)],children:(0,c.tZ)(v.Z,{})});if(null==o?void 0:o.error)return(0,c.tZ)(R.G,{css:[g.l0.flex.row,g.l0.justify.center,g.l0.p(32)],children:(0,c.tZ)(h.xv,{css:[g.l0.color.accentNegativeDefault,g.l0.maxWidth("100%")],children:null==o?void 0:o.error})});var s=o?uy(o):null;if(!s)return(0,c.tZ)(R.G,{css:[g.l0.flex.row,g.l0.justify.center,g.l0.p(32)],children:(0,c.tZ)(h.xv,{css:[g.l0.color.accentPositiveDefault,g.l0.maxWidth("100%")],children:"No rows"})});var u=s.headerColumns,d=s.bodyData;return(0,c.tZ)(us,{headerColumns:u.map(function(e,t){var n,r=null==l?void 0:null===(n=l.rows)||void 0===n?void 0:n.find(function(t){return t.column_name===e}),i=null==r?void 0:r.data_type,o=i?(0,c.tZ)(uB.D,{text:i}):null;return(0,c.BX)(R.G,{css:[g.l0.rowWithGap(8),g.l0.align.center],children:[(0,c.tZ)(h.xv,{multiline:!1,children:e}),o]},t)}),bodyData:d,scrollRef:i})},uP=function(e){var t=e.tableName,n=e.connectionString,r=uv(),i=(0,w.useRef)(null),o=ug('SELECT * FROM "'.concat(t.replace(/"/g,'""'),'" LIMIT ').concat(500),n),a=o.refetch;return(0,c.BX)(R.G,{css:[g.l0.flex.column,g.l0.height("100%")],children:[(0,c.BX)(R.G,{css:[g.l0.flex.row,g.l0.py(16),g.l0.px(8),g.l0.align.center],children:[(0,c.tZ)(d.hU,{alt:"Go back",size:28,type:"button",onClick:r,children:(0,c.tZ)(sQ.Z,{})}),(0,c.tZ)(R.G,{css:[g.l0.flex.growAndShrink(1)],children:(0,c.tZ)(h.xv,{css:[g.l0.fontSize(16),g.l0.ml(8)],multiline:!1,children:t})}),(0,c.tZ)(d.hU,{alt:"Refresh",size:24,type:"button",onClick:a,children:(0,c.tZ)(nJ.Z,{})})]}),(0,c.tZ)(R.G,{css:[g.l0.flex.growAndShrink(1),g.l0.overflow("auto"),g.l0.px(8)],innerRef:i,children:(0,c.tZ)(uA,{psqlQueryResult:o,tableName:t,connectionString:n,scrollRef:i})})]})};n(26);var uN=function(e){var t=e.size;return(0,c.BX)("svg",{viewBox:"0 0 128 36",preserveAspectRatio:"xMidYMin",height:void 0===t?16:t,fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,c.tZ)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M0 6.207A6.207 6.207 0 0 1 6.207 0h23.586A6.207 6.207 0 0 1 36 6.207v20.06c0 3.546-4.488 5.085-6.664 2.286l-6.805-8.754v10.615A5.586 5.586 0 0 1 16.945 36H6.207A6.207 6.207 0 0 1 0 29.793V6.207Zm6.207-1.241c-.686 0-1.241.555-1.241 1.24v23.587c0 .686.555 1.242 1.24 1.242h10.925c.343 0 .434-.278.434-.621V16.18c0-3.547 4.488-5.086 6.665-2.286l6.805 8.753V6.207c0-.686.064-1.241-.621-1.241H6.207Z",fill:"#12FFF7"}),(0,c.tZ)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M0 6.207A6.207 6.207 0 0 1 6.207 0h23.586A6.207 6.207 0 0 1 36 6.207v20.06c0 3.546-4.488 5.085-6.664 2.286l-6.805-8.754v10.615A5.586 5.586 0 0 1 16.945 36H6.207A6.207 6.207 0 0 1 0 29.793V6.207Zm6.207-1.241c-.686 0-1.241.555-1.241 1.24v23.587c0 .686.555 1.242 1.24 1.242h10.925c.343 0 .434-.278.434-.621V16.18c0-3.547 4.488-5.086 6.665-2.286l6.805 8.753V6.207c0-.686.064-1.241-.621-1.241H6.207Z",fill:"url(#a)"}),(0,c.tZ)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M0 6.207A6.207 6.207 0 0 1 6.207 0h23.586A6.207 6.207 0 0 1 36 6.207v20.06c0 3.546-4.488 5.085-6.664 2.286l-6.805-8.754v10.615A5.586 5.586 0 0 1 16.945 36H6.207A6.207 6.207 0 0 1 0 29.793V6.207Zm6.207-1.241c-.686 0-1.241.555-1.241 1.24v23.587c0 .686.555 1.242 1.24 1.242h10.925c.343 0 .434-.278.434-.621V16.18c0-3.547 4.488-5.086 6.665-2.286l6.805 8.753V6.207c0-.686.064-1.241-.621-1.241H6.207Z",fill:"url(#b)"}),(0,c.tZ)("path",{d:"M29.793 0A6.207 6.207 0 0 1 36 6.207v20.06c0 3.546-4.488 5.085-6.664 2.286l-6.805-8.754v10.615A5.586 5.586 0 0 1 16.945 36a.62.62 0 0 0 .62-.62v-19.2c0-3.547 4.488-5.086 6.665-2.286l6.805 8.753V1.241C31.035.556 30.479 0 29.793 0Z",fill:"#B9FFB3"}),(0,c.tZ)("path",{d:"M60.686 10.6v9.416l-9.13-9.416h-4.752V26h4.334V15.88L61.082 26h3.938V10.6h-4.334ZM73.054 22.568V19.84h9.702v-3.278h-9.702v-2.53h11.77V10.6H68.632V26h16.434v-3.432H73.054ZM96.583 26.506c6.094 0 10.054-2.992 10.054-8.206 0-5.214-3.96-8.206-10.054-8.206S86.551 13.086 86.551 18.3c0 5.214 3.938 8.206 10.032 8.206Zm0-3.652c-3.388 0-5.478-1.65-5.478-4.554 0-2.904 2.112-4.554 5.478-4.554 3.388 0 5.478 1.65 5.478 4.554 0 2.904-2.09 4.554-5.478 4.554ZM123.249 10.6v9.416l-9.13-9.416h-4.752V26h4.334V15.88L123.645 26h3.938V10.6h-4.334Z",fill:"currentColor"}),(0,c.BX)("defs",{children:[(0,c.BX)("linearGradient",{id:"a",x1:"36",y1:"36",x2:"4.345",y2:"0",gradientUnits:"userSpaceOnUse",children:[(0,c.tZ)("stop",{stopColor:"#B9FFB3"}),(0,c.tZ)("stop",{offset:"1",stopColor:"#B9FFB3",stopOpacity:"0"})]}),(0,c.BX)("linearGradient",{id:"b",x1:"36",y1:"36",x2:"14.617",y2:"27.683",gradientUnits:"userSpaceOnUse",children:[(0,c.tZ)("stop",{stopColor:"#1A1A1A",stopOpacity:".9"}),(0,c.tZ)("stop",{offset:"1",stopColor:"#1A1A1A",stopOpacity:"0"})]})]})]})},uU=(0,eu.iv)([g.l0.color.foregroundDimmest,{textDecoration:"underline"}]),uO=function(){return(0,c.tZ)(R.G,{css:[g.l0.colWithGap(8),g.l0.py(8),g.l0.width("100%")],children:(0,c.BX)(R.G,{css:[g.l0.rowWithGap(8),g.l0.align.center,g.l0.justify.spaceBetween],children:[(0,c.tZ)("a",{target:"_blank",href:sL,css:uU,children:"Docs"}),(0,c.BX)(R.G,{css:[g.l0.rowWithGap(8),g.l0.align.center],children:[(0,c.tZ)(h.xv,{css:[g.l0.fontSize(14)],multiline:!1,children:"Powered by"}),(0,c.tZ)(uN,{})]})]})})},uL=n(82701),uM=n(578),uX=n(97050),uF=n(54472),uW=n(29457),uH=n(40688),uV=n(50639),uz=n(37054),uj=n(45549),uq=n(50586),uY=n(48170),u$=function(e){var t=e.headerTitle,n=e.onGoBack,r=e.children;return(0,c.BX)(R.G,{css:[g.l0.flex.column,g.l0.height("100%")],children:[(0,c.BX)(R.G,{css:[g.l0.flex.row,g.l0.py(16),g.l0.px(8),g.l0.align.center],children:[(0,c.tZ)(d.hU,{alt:"Go back",size:28,type:"button",onClick:n,children:(0,c.tZ)(sQ.Z,{})}),(0,c.tZ)(h.xv,{css:[g.l0.fontSize(16),g.l0.ml(8)],multiline:!1,children:t})]}),(0,c.tZ)(R.G,{css:[g.l0.overflow("auto"),g.l0.height("calc(100% - 60px)")],children:r})]})},uJ=(0,tQ.cn)(""),uK=(0,tQ.cn)(null),uQ=(0,tQ.cn)(null,function(e,t,n){var r=n.query;r&&t(uJ,r);var i=e(uK);i&&i.dispatch({changes:{from:0,to:i.state.doc.length,insert:r}})}),u0=n(85234),u1=n.n(u0),u2=n(64461),u8=n(15859),u4=n(28999),u3=(0,u8.O4)("replDatabasesQueryHistory",[]),u5=function(e,t){return!e.isPinned&&t.isPinned?1:e.isPinned&&!t.isPinned?-1:"number"==typeof e.pinnedTimestamp&&"number"==typeof t.pinnedTimestamp?e.pinnedTimestamp-t.pinnedTimestamp:t.timestamp-e.timestamp},u6=function(e,t){var n=e.findIndex(function(e){return!e.isPinned&&e.data===t.data});-1!==n?e.splice(n,1,t):e.push(t),e.sort(u5);var r=e.filter(function(e){return!e.isPinned}).length;if(r>=5){var i=r-5;e.splice(e.length-i,i)}},u9=function(e){var t=e.id,n=e.data,r=e.isPinned,i=(0,u4.lV)((0,w.useCallback)(function(e,n){var r=e(u3).find(function(e){return e.id===t}),i=(null==r?void 0:r.data)||"";i&&(n(uQ,{query:i}),cW({action:"queryHistoryItemSelected"}))},[t])),o=(0,u4.lV)((0,w.useCallback)(function(e,n){var r=e(u3);n(u3,(0,u2.Uy)(r,function(e){var n=e.find(function(e){return e.id===t});n&&(n.isPinned=!n.isPinned,n.isPinned?n.pinnedTimestamp=Date.now():n.pinnedTimestamp=void 0),e.sort(u5)})),cW({action:"queryHistoryItemPinned"})},[t]));return(0,c.BX)(R.G,{css:[{borderTop:"1px solid ".concat(g.TV.outlineDefault),":hover":{background:g.TV.backgroundHigher}},g.l0.flex.row,g.l0.p(8),g.l0.color.foregroundDimmer,g.l0.align.center,g.l0.cursor.pointer],onClick:i,children:[(0,c.tZ)(h.xv,{css:[g.l0.flex.growAndShrink(1)],multiline:!1,children:n}),(0,c.tZ)(d.hU,{alt:"Pin query",onClick:o,children:r?(0,c.tZ)(uV.Z,{fill:g.TV.accentPrimaryDefault}):(0,c.tZ)(uH.Z,{})})]})},u7=function(e){var t=e.onExpand,n=(0,tK.Dv)(u3);return(0,c.tZ)(el.Q,{onClick:t,headerContent:(0,c.BX)(R.G,{css:[g.l0.rowWithGap(8),g.l0.align.center,g.l0.p(2)],children:[(0,c.tZ)(a5.Z,{}),(0,c.tZ)(h.xv,{css:[g.l0.color.foregroundDimmest],multiline:!1,children:"Query History"})]}),children:(0,c.tZ)(R.G,{css:[g.l0.colWithGap(8),g.l0.height("100%")],children:0===n.length?(0,c.tZ)(R.G,{css:[g.l0.p(8)],children:(0,c.tZ)(h.xv,{css:[g.l0.color.foregroundDimmer],multiline:!1,children:"No query history"})}):(0,c.tZ)(R.G,{children:n.map(function(e){return(0,c.tZ)(u9,(0,A._)({},e),e.id)})})})})},de=new uW.R(function(){return(0,eP.W$)((0,uF.VV)((0,c.tZ)("div",{css:[{fontFamily:g.TV.fontFamilyCode},g.l0.color.foregroundDimmest],children:"Type PostgreSQL queries here to use the database."})))}),dt=new cl.j(function(e){return eI.Wl.high((0,uL.sql)((0,A._)({dialect:uL.PostgreSQL},e)))}),dn=function(e){var t=e.queryResult,n=e.scrollRef;if(null==t?void 0:t.error)return(0,c.tZ)(R.G,{css:g.l0.px(8),children:(0,c.tZ)(h.xv,{css:[g.l0.color.accentNegativeDefault],children:null==t?void 0:t.error})});if(!(null==t?void 0:t.rows))return null;var r=uy(t);if(!r)return(0,c.tZ)(R.G,{css:g.l0.px(8),children:(0,c.tZ)(h.xv,{css:[g.l0.color.accentPositiveDefault],children:"Query successful, no rows returned"})});var i=r.headerColumns,o=r.bodyData;return(0,c.tZ)(R.G,{css:g.l0.px(8),children:(0,c.tZ)(us,{headerColumns:i,bodyData:o,scrollRef:n})})},dr=(0,eu.iv)([g.l0.height("100%"),g.l0.position.relative,g.l0.overflow("auto")]),di=(0,eu.iv)([g.l0.position.sticky,g.l0.top(0),g.l0.left(0),g.l0.zIndex(1),g.l0.backgroundColor.backgroundDefault]),da=function(e){var t=e.connectionString,n=e.performPaneOperation,r=(0,a._)((0,tK.KO)(uJ),2),i=r[0],o=r[1],l=(0,ca.Z)(),s=l.ref,u=l.view,d=(0,a._)((0,w.useState)(!1),2),f=d[0],h=d[1];(0,w.useEffect)(function(){return function(){var e;o(null!==(e=null==u?void 0:u.state.doc.toString())&&void 0!==e?e:"")}},[o,null==u?void 0:u.state.doc]);var p=(0,tK.b9)(uK);(0,w.useEffect)(function(){p(u)},[p,u]),ux({connectionString:t});var m=(0,tK.Dv)(uw),b=uY.q,Z=(0,uM.Z)({filePath:b}),x=(0,y.Z)().psql,C=(0,a._)((0,w.useState)(),2),_=C[0],S=C[1],E=(0,a._)((0,w.useState)(!1),2),k=E[0],T=E[1],D=(0,u4.lV)((0,w.useCallback)(function(e,t,n){if(n){var r={id:u1()(),data:n,timestamp:Date.now()},i=e(u3);t(u3,(0,u2.Uy)(i,function(e){u6(e,r)}))}},[])),I=(0,w.useCallback)(function(){function e(){return(e=(0,to._)(function(){var e;return(0,ta.Jh)(this,function(n){switch(n.label){case 0:if(!u)return[2];n.label=1;case 1:return n.trys.push([1,,3,4]),T(!0),D(e=null==u?void 0:u.state.doc.toString()),[4,x.run({query:e,connectionString:t})];case 2:return S(n.sent()),cW({action:"queryRan"}),[3,4];case 3:return T(!1),[7];case 4:return[2]}})})).apply(this,arguments)}!function(){e.apply(this,arguments)}()},[t,x,D,u]),G=um(),B=(0,w.useCallback)(function(){G("databaseManager")},[G]),A=(0,w.useCallback)(function(){G("tableSchemas")},[G]),P=(0,w.useRef)(null),N=dt.use({schema:m}),U=(0,tY.P5)({controlName:"flag-postgresql-pane-inline-ai"}),O=(0,ap.T3)(),M=(0,uz.Ls)({path:b}),X=(0,uz.jg)({path:b}),F=(0,uz.fD)({path:b}),W=(0,uq.W)({generateCode:M,editCode:X,explainCode:F,onMoreClick:void 0}),H=(0,w.useCallback)(function(){u&&M(u)},[u,M]),V=(0,w.useCallback)(function(){u&&X(u)},[u,X]),z=(0,w.useCallback)(function(e){return n({operation:"open",pane:e,secondary:!0})},[n]),j=(0,w.useCallback)(function(){z({type:"ghostwriterChat"})},[z]),q=(0,uX.W)({onGenerateCode:H,onEditCode:V,onReplyInChat:j}),Y=(0,uj.u)({isMobile:O,generateCode:M,filePath:b,openPane:z});return(0,c.tZ)(u$,{headerTitle:"Database Contents",onGoBack:B,children:(0,c.BX)(R.G,{css:[g.l0.colWithGap(8),dr],innerRef:P,children:[(0,c.BX)(R.G,{css:[g.l0.colWithGap(8),g.l0.px(8),g.l0.pb(8),f?null:di],children:[(0,c.BX)(R.G,{css:[{border:"1px solid ".concat(g.TV.outlineDefault)},g.l0.borderRadius(2)],children:[(0,c.tZ)(eW.ZP,{ref:s,filePath:b,css:[cu.Mp,g.l0.backgroundColor.backgroundDefault,g.l0.borderRadius(8),g.l0.overflow("auto"),g.l0.minHeight(100),g.l0.maxHeight(500),{".cm-panel":{zIndex:1}}],initialDoc:i,extensions:[U?[]:de,N,Z,U&&!O?W:[],U?q:[],U?Y:[]]}),(0,c.tZ)(u7,{expanded:f,onExpand:function(){h(function(e){return!e})}})]}),(0,c.tZ)(L.zx,{text:"Run Query",iconLeft:k?(0,c.tZ)(v.Z,{}):(0,c.tZ)(rr.Z,{}),onClick:I,disabled:k})]}),(0,c.tZ)(dn,{queryResult:_,scrollRef:P}),(0,c.tZ)(R.G,{css:[g.l0.colWithGap(8),g.l0.px(8),g.l0.py(8)],children:(0,c.tZ)(L.zx,{css:g.l0.backgroundColor.backgroundDefault,text:"Show All Contents",iconLeft:(0,c.tZ)(sF.Z,{}),onClick:A})})]})})},dl="\nPostgreSQL is a powerful open source relational database system that is widely used in web applications and other software development projects. You can easily create a production-ready PostgreSQL database directly within Replit. For more information on PostgreSQL, visit the [official documentation](https://www.postgresql.org/docs/). Repls use PostgreSQL version 15.\n\nHere is some information to help you get started:\n\n1. Replit databases are backed by [Neon](https://neon.tech/). The [Neon documentation](https://neon.tech/docs/connect/connect-from-any-app#connection-examples) provides guides on how to connect various frameworks, such as Django, to your PostgreSQL database.\n\n1. Environment Variables: We provided environment variables `DATABASE_URL`, `PGDATABASE`, `PGHOST`, `PGHOST`, `PGPORT`, `PGUSER`, `PGPASSWORD`. Provide these values to your framework of choice to connect to your database.\n\n1. Connection pooling: If you need to enable connection pooling for any reason, contact us at support@repl.it.\n\n1. Compute lifecycle: Neon databases go to sleep after 5 minutes of inactivity. You may experience disconnects or reconnects depending on your client.\n",dc=(0,tQ.cn)(null),ds=(0,tQ.cn)(null),du=function(){return(0,tK.Dv)(ds)},dd=function(){var e=(0,tK.b9)(dc),t=(0,tK.b9)(ds);return(0,w.useCallback)(function(n){if(!n){e(null),t(null);return}e({connectionString:n,databaseId:-1,databaseName:"Admin Override",isFrozen:!1,projectId:"mock-project-id-does-not-exist",__typename:"NeonDatabase",isBackedByCycles:!0}),t(n)},[t,e])},df=function(e){var t,n=e.neonDatabases,r=e.onDatabaseDeleted,i=e.onDatabaseUnfreezed,o=e.onDatabaseMigrated,l=e.performPaneOperation,s=n[0],u=(0,o9.Z)().showError,d=(0,eg.Z)(),f=function(){var e=(0,w.useContext)(sb.Z);if(!e)throw Error("Expected Repl info to be in context");return e.slug}(),p=(0,tY.P5)({controlName:sA.uZ,logFlagToAnalytics:!0}),m=up(),v=um(),y=(0,w.useCallback)(function(){v("queryEditor")},[v]),b=(0,a._)(sd(),2),Z=b[0],x=b[1].loading,C=(0,w.useCallback)(function(){G(!0)},[]),_=(0,sy.Z)({forceFetch:!1}),S=_.cycles,E=_.formattedBalanceValue,k="number"==typeof S&&S>sN,T=(0,w.useCallback)((0,to._)(function(){var e,t,n;return(0,ta.Jh)(this,function(i){switch(i.label){case 0:return[4,Z({variables:{input:{replId:d,databaseId:s.databaseId}}})];case 1:if(t=(e=i.sent()).data,n=e.errors,G(!1),n&&n.length>0)return u("Error when deleting Neon database: ".concat(null==n?void 0:n.join())),cW({action:"removed",success:!1}),[2];if((null==t?void 0:t.deleteNeonDatabase.__typename)!=="DeleteNeonDatabaseResult")return u("Error: ".concat(null==t?void 0:t.deleteNeonDatabase.message)),cW({action:"removed",success:!1}),[2];return(null==t?void 0:t.deleteNeonDatabase.success)?(r(),cW({action:"removed",success:!0})):(u("Error: Delete Neon Database failed."),cW({action:"removed",success:!1})),[2]}})}),[Z,s.databaseId,r,d,u]),D=(0,a._)((0,w.useState)(!1),2),I=D[0],G=D[1],B=(0,w.useCallback)(function(){G(!1)},[]),A=(0,a._)((0,w.useState)(!1),2),P=A[0],N=A[1],U=(0,w.useCallback)(function(){N(!0)},[]),O=(0,a._)(sp(),2),X=O[0],F=O[1].loading,W=(0,w.useCallback)((0,to._)(function(){var e,t,n;return(0,ta.Jh)(this,function(r){switch(r.label){case 0:return[4,X({variables:{input:{neonProjectId:s.projectId,replId:d}}})];case 1:if(t=(e=r.sent()).data,(n=e.errors)&&n.length>0)return u("Error when unfreezing Neon database: ".concat(null==n?void 0:n.join())),cW({action:"unfreeze",success:!1}),[2];if((null==t?void 0:t.unfreezeNeonDatabase.__typename)!=="UnfreezeNeonDatabaseResult")return u("Error: Unfreezes Neon Database failed."),cW({action:"unfreeze",success:!1}),[2];return(null==t?void 0:t.unfreezeNeonDatabase.success)?(i(),cW({action:"unfreeze",success:!0})):(u("Error: Unfreezes Neon Database failed."),cW({action:"unfreeze",success:!1})),[2]}})}),[s.projectId,i,d,u,X]),H=du(),V=cK({connectionString:s.connectionString,databaseName:s.databaseName})[cz].split(".")[0],z=H||"".concat(s.connectionString,"/").concat(s.databaseName,"?sslmode=require&options=project%3D").concat(V);if("queryEditor"===m)return(0,c.tZ)(da,{connectionString:z,performPaneOperation:l});if("tableSchemas"===m)return(0,c.tZ)(uE,{connectionString:z});if(m.startsWith("table/")){var j=m.slice(m.indexOf("/")+1);return(0,c.tZ)(uP,{tableName:j,connectionString:z})}return t=s.isFrozen?(0,c.BX)(c.HY,{children:[(0,c.BX)(R.G,{css:[g.l0.rowWithGap(8),g.l0.align.center],children:[(0,c.tZ)(R.G,{css:[g.l0.width(8),g.l0.height(8),g.l0.backgroundColor.foregroundDimmer,g.l0.borderRadius("full")]}),(0,c.tZ)(h.xv,{css:[g.l0.color.foregroundDimmest],multiline:!1,children:"Database paused"})]}),(0,c.BX)(h.xv,{css:[g.l0.fontSize(12),g.l0.color.foregroundDimmest],children:["Databases cost ",sO]}),(0,c.BX)(R.G,{css:[g.l0.colWithGap(8),g.l0.align.center],children:[(0,c.tZ)(tW.Z,{size:32,fill:g.TV.foregroundDimmest,css:g.l0.mt(32)}),(0,c.BX)(h.xv,{variant:"subheadDefault",css:[g.l0.my(16)],multiline:!1,children:["Your Database is paused. You have ",E," cycles."]}),(0,c.BX)(h.xv,{children:["Access to your databases will be paused until you"," ",k?"use cycles to resume database":"refill your Cycles balance","."]}),k?(0,c.tZ)(L.zx,{css:g.l0.pt(8),iconLeft:(0,c.tZ)(sZ.Z,{}),onClick:W,disabled:F,text:"Unpause Database",colorway:"primary"}):null,(0,c.tZ)(L.zx,{css:g.l0.pt(8),iconLeft:(0,c.tZ)(nn.Z,{}),onClick:U,text:k?"Buy more cycles":"Buy Cycles"})]}),(0,c.tZ)(sx.Z,{noPadding:!0,isOpen:P,maxWidth:sC.W,onRequestClose:function(){return N(!1)},fitContent:!0,replTitle:f,uponPurchaseGoTo:"workspace",context:"workspace_postgresql_pane",initialTab:"cycles",allowCyclesPage:!0})]}):(0,c.BX)(c.HY,{children:[(0,c.BX)(R.G,{css:[g.l0.rowWithGap(8),g.l0.align.center],children:[(0,c.tZ)(R.G,{css:[g.l0.width(8),g.l0.height(8),g.l0.backgroundColor.accentPositiveStronger,g.l0.borderRadius("full"),{filter:"drop-shadow(0 0 6px ".concat(g.TV.accentPositiveStronger,")")}]}),(0,c.tZ)(h.xv,{css:[g.l0.color.accentPositiveStronger],multiline:!1,children:"Database connected"})]}),(0,c.tZ)(sX,{}),(0,c.tZ)(s_,{title:"Database Info",children:(0,c.tZ)(uG,{connectionString:z,onOpenDatabaseViewerClick:y})}),(0,c.tZ)(s_,{title:"Using the database",isAccordion:!0,children:(0,c.tZ)(nb.ZP,{css:[c2.Z,g.l0.maxWidth("100%")],children:dl})}),(0,c.tZ)(s_,{title:"Environment variables",isAccordion:!0,children:(0,c.tZ)(c0,{connectionString:z,databaseName:s.databaseName})})]}),(0,c.BX)(R.G,{css:[g.l0.colWithGap(0),g.l0.height("100%"),g.l0.p(8)],children:[p?(0,c.BX)(R.G,{css:[g.l0.mb(16)],children:[(0,c.tZ)(sB,{onDatabaseMigrated:o}),(0,c.tZ)(sw.iz,{})]}):null,(0,c.tZ)(R.G,{css:[g.l0.colWithGap(16),g.l0.flex.grow(1),g.l0.flex.shrink(0)],children:t}),(0,c.tZ)(R.G,{css:[g.l0.pt(16)],children:I||x?(0,c.BX)(M.Tg,{css:[g.l0.p(8),g.l0.colWithGap(8)],elevated:!0,children:[(0,c.tZ)(h.xv,{children:"Removing this database will remove access to the data for this Repl, and remove the daily Cycles subscription of ".concat(sO,".")}),(0,c.tZ)(rC.E,{icon:(0,c.tZ)(n9.Z,{}),colorway:"warning",text:"This action cannot be undone."}),(0,c.tZ)(L.zx,{text:"Yes, Remove Database",colorway:"negative",disabled:x,iconLeft:(0,c.tZ)(c1.Z,{}),onClick:T}),(0,c.tZ)(L.zx,{text:"Cancel",disabled:x,onClick:B})]}):(0,c.tZ)(L.zx,{css:[g.l0.py(8)],text:"Remove Database",disabled:x,iconLeft:(0,c.tZ)(c1.Z,{}),onClick:C})}),(0,c.tZ)(uO,{})]})},dh=(0,p.X)({self:[g.l0.colWithGap(0),g.l0.height("100%"),g.l0.p(8)],main:[g.l0.colWithGap(16),g.l0.flex.grow(1),g.l0.flex.shrink(0)],header:[g.l0.rowWithGap(8),g.l0.align.center],status:[g.l0.width(8),g.l0.height(8),g.l0.backgroundColor.accentPositiveStronger,g.l0.borderRadius("full"),{filter:"drop-shadow(0 0 6px ".concat(g.TV.accentPositiveStronger,")")}],title:[g.l0.color.accentPositiveStronger],docs:[c2.Z,g.l0.maxWidth("100%")],footer:[g.l0.pt(16)],remove:[g.l0.py(8)],removeConfirm:[g.l0.p(8),g.l0.colWithGap(8)]}),dp=function(e){var t=e.neonDatabases,n=e.onDatabaseDeleted,r=e.onDatabaseUnfreezed,i=e.performPaneOperation,o=t[0],l=(0,o9.Z)().showError,s=(0,eg.Z)(),u=up(),d=um(),f=(0,w.useCallback)(function(){d("queryEditor")},[d]),p=(0,a._)(sd(),2),m=p[0],v=p[1].loading,g=(0,w.useCallback)(function(){x(!0)},[]),y=(0,w.useCallback)((0,to._)(function(){var e,t,r;return(0,ta.Jh)(this,function(i){switch(i.label){case 0:return[4,m({variables:{input:{replId:s,databaseId:o.databaseId}}})];case 1:if(t=(e=i.sent()).data,r=e.errors,x(!1),r&&r.length>0)return l("Error when deleting Neon database: ".concat(null==r?void 0:r.join())),cW({action:"removed",success:!1}),[2];if((null==t?void 0:t.deleteNeonDatabase.__typename)!=="DeleteNeonDatabaseResult")return l("Error: ".concat(null==t?void 0:t.deleteNeonDatabase.message)),cW({action:"removed",success:!1}),[2];return(null==t?void 0:t.deleteNeonDatabase.success)?(n(),cW({action:"removed",success:!0})):(l("Error: Delete Neon Database failed."),cW({action:"removed",success:!1})),[2]}})}),[m,o.databaseId,n,s,l]),b=(0,a._)((0,w.useState)(!1),2),Z=b[0],x=b[1],C=(0,w.useCallback)(function(){x(!1)},[]),_=du(),S=cK({connectionString:o.connectionString,databaseName:o.databaseName})[cz].split(".")[0],E=_||"".concat(o.connectionString,"/").concat(o.databaseName,"?sslmode=require&options=project%3D").concat(S);if("queryEditor"===u)return(0,c.tZ)(da,{connectionString:E,performPaneOperation:i});if("tableSchemas"===u)return(0,c.tZ)(uE,{connectionString:E});if(u.startsWith("table/")){var k=u.slice(u.indexOf("/")+1);return(0,c.tZ)(uP,{tableName:k,connectionString:E})}return(0,c.BX)(R.G,{css:dh.self,children:[(0,c.tZ)(R.G,{css:dh.main,children:o.isFrozen?(0,c.tZ)(sg,{replId:s,neonProjectId:o.projectId,onDatabaseUnfreezed:r}):(0,c.BX)(c.HY,{children:[(0,c.BX)(R.G,{css:dh.header,children:[(0,c.tZ)(R.G,{css:dh.status}),(0,c.tZ)(h.xv,{css:dh.title,multiline:!1,children:"Database connected"})]}),(0,c.tZ)(s_,{title:"Database Info",children:(0,c.tZ)(uG,{connectionString:E,onOpenDatabaseViewerClick:f,showUsageLink:!0})}),(0,c.tZ)(s_,{title:"Using the database",isAccordion:!0,children:(0,c.tZ)(nb.ZP,{css:dh.docs,children:dl})}),(0,c.tZ)(s_,{title:"Environment variables",isAccordion:!0,children:(0,c.tZ)(c0,{connectionString:E,databaseName:o.databaseName})})]})}),(0,c.tZ)(R.G,{css:dh.footer,children:Z||v?(0,c.BX)(M.Tg,{css:dh.removeConfirm,elevated:!0,children:[(0,c.tZ)(h.xv,{children:"Removing this database will remove access to the data for this Repl."}),(0,c.tZ)(rC.E,{icon:(0,c.tZ)(n9.Z,{}),colorway:"warning",text:"This action cannot be undone."}),(0,c.tZ)(L.zx,{text:"Yes, Remove Database",colorway:"negative",disabled:v,iconLeft:(0,c.tZ)(c1.Z,{}),onClick:y}),(0,c.tZ)(L.zx,{text:"Cancel",disabled:v,onClick:C})]}):(0,c.tZ)(L.zx,{css:dh.remove,text:"Remove Database",disabled:v,iconLeft:(0,c.tZ)(c1.Z,{}),onClick:g})}),(0,c.tZ)(uO,{})]})},dm=function(e){var t=e.neonDatabases,n=e.onDatabaseDeleted,r=e.onDatabaseUnfreezed,i=e.onDatabaseMigrated,o=e.performPaneOperation,a=t[0].isBackedByCycles;return(0,tY.P5)({controlName:sA.uZ,logFlagToAnalytics:!0})&&!a?(0,c.tZ)(dp,{neonDatabases:t,onDatabaseDeleted:n,onDatabaseUnfreezed:r,performPaneOperation:o}):(0,c.tZ)(df,{neonDatabases:t,onDatabaseDeleted:n,onDatabaseUnfreezed:r,onDatabaseMigrated:i,performPaneOperation:o})},dv=n(93302),dg=n(4513),dy=n(92977);function db(){var e=(0,ey._)(["\n  query NeonStartPage {\n    currentUser {\n      id\n      userSubscriptionType\n      usageBasedBilling(input: { capabilitiesOnly: true }) {\n        __typename\n        ... on UserUsageBasedBillingSummary {\n          capabilities {\n            canUseUsageBasedBilling\n            explanation\n            hasPaymentMethod\n          }\n        }\n      }\n      usageInterval {\n        ... on UsageInterval {\n          resources {\n            neonComputeTime {\n              allotment\n              usage\n            }\n            neonDataStorage {\n              allotment\n              usage\n            }\n          }\n        }\n      }\n    }\n  }\n"]);return db=function(){return e},e}var dZ={},dw=(0,eb.Ps)(db()),dx=n(25491),dC="Buy Cycles & Create a DB",d_="Use Cycles to create a DB",dS='Press "'.concat(dC,'" to initiate a daily Cycles subscription and activate a Neon Database. You will be redirected to our payment processor.\n'),dE='Press "'.concat(d_,'" to initiate a daily Cycles subscription and activate a Neon Database.'),dk=function(e){var t=e.onDatabaseCreated,n=(0,eg.Z)(),r=(0,o9.Z)().showError,i=(0,a._)(ss(),2),o=i[0],l=i[1].loading,s=(0,sy.Z)({forceFetch:!0}),u=s.cycles,f=s.loading,p=null!=u&&u>=sN,m=p?dE:dS,v=(0,w.useCallback)((0,to._)(function(){var e,i,a,l,c,s,u;return(0,ta.Jh)(this,function(d){switch(d.label){case 0:return[4,o({variables:{input:{replId:n}}})];case 1:if(i=(e=d.sent()).data,(a=e.errors)&&a.length>0)return r("Error when creating Neon database: ".concat(null==a?void 0:a.join())),cW({action:"created",success:!1}),[2];return(null==i?void 0:i.createNeonDatabase.__typename)==="CreateNeonDatabaseResult"?(c=(l=i.createNeonDatabase).databaseId,s=l.databaseName,u=l.connectionString,t({__typename:"NeonDatabase",databaseId:c,databaseName:s,connectionString:u,projectId:l.projectId,isFrozen:l.isFrozen,isBackedByCycles:l.isBackedByCycles}),cW({action:"created",success:!0})):(r("Error: ".concat(null==i?void 0:i.createNeonDatabase.message)),cW({action:"created",success:!1})),[2]}})}),[o,n,r,t]),y=(0,a._)((0,w.useState)(!1),2),b=y[0],Z=y[1],x=(0,w.useCallback)((0,to._)(function(){return(0,ta.Jh)(this,function(e){return Z(!0),[2]})}),[]),C=(0,w.useCallback)((0,to._)(function(){return(0,ta.Jh)(this,function(e){return Z(!1),[2]})}),[]),_=(0,w.useCallback)((0,to._)(function(){return(0,ta.Jh)(this,function(e){switch(e.label){case 0:return[4,v()];case 1:return e.sent(),Z(!1),[2]}})}),[v]);return(0,c.BX)(R.G,{css:[g.l0.colWithGap(0),g.l0.height("100%"),g.l0.align.center,g.l0.p(8)],children:[(0,c.BX)(R.G,{css:[g.l0.colWithGap(16),g.l0.flex.grow(1),g.l0.flex.shrink(0),g.l0.maxWidth(600)],children:[(0,c.BX)(R.G,{css:[g.l0.colWithGap(8),g.l0.align.center],children:[(0,c.tZ)(R.G,{css:[g.l0.p(16)],children:(0,c.tZ)(oG.Z,{src:"/public/images/db_illustration.png",width:144,height:144,alt:"FPO visual"})}),(0,c.tZ)(h.xv,{css:[g.l0.fontSize(16),g.l0.fontWeight.bold],multiline:!1,children:"Fully-managed PostgreSQL database"}),(0,c.tZ)(h.xv,{css:[g.l0.fontSize(14)],multiline:!1,children:"10GB of fast read/write storage"}),(0,c.BX)(R.G,{css:[g.l0.rowWithGap(8),g.l0.align.center],children:[(0,c.tZ)(h.xv,{css:[g.l0.fontSize(14)],multiline:!1,children:sO}),(0,c.tZ)(d.hU,{alt:m,size:24,children:(0,c.tZ)(la.Z,{})})]})]}),(0,c.BX)(M.Tg,{css:[g.l0.colWithGap(8),g.l0.mb(8)],background:"default",children:[(0,c.tZ)(L.zx,{text:f?"Loading Cycles Balance":p?d_:dC,colorway:"primary",iconLeft:(0,c.tZ)(T.Z,{}),disabled:f||l,onClick:x}),(0,c.tZ)(rT.Z,{href:sL,target:"_blank",text:"Learn More",iconRight:(0,c.tZ)(rR.Z,{}),variant:"outlined"})]}),(0,c.tZ)("hr",{css:[g.l0.my(16),{borderColor:g.TV.outlineDefault}]}),(0,c.tZ)(h.xv,{css:[g.l0.fontSize(12),g.l0.color.foregroundDimmest],children:m}),(0,c.tZ)(dx.Z,{isOpen:b,onRequestClose:C,onRequestPowerUp:_,uponPurchaseGoTo:"workspace",context:"workspace_postgresql_pane",powerUp:"neon-database-preview"})]}),(0,c.tZ)(uO,{})]})},dT=(0,p.X)({self:[g.l0.px(8),g.l0.pt(16)],container:[g.l0.colWithGap(32),g.l0.py(32),g.l0.textAlign.center,dy.Qw.maxWidth],title:[g.l0.colWithGap(4),g.l0.width("100%"),g.l0.maxWidth(320),{marginLeft:"auto",marginRight:"auto"}],usage:[g.l0.colWithGap(4),g.l0.width("100%"),g.l0.maxWidth(320),{marginLeft:"auto",marginRight:"auto"}],cta:[g.l0.width("100%"),g.l0.maxWidth(320),{marginLeft:"auto",marginRight:"auto"}],ctaContainer:[g.l0.colWithGap(8),g.l0.align.center],ctaStatusBanner:[g.l0.textAlign.left],payment:[g.l0.p(16),g.l0.borderRadius(12),g.l0.textAlign.left,g.l0.shadow(2)],budgetContainer:[g.l0.colWithGap(8),g.l0.border(),g.l0.borderRadius(8),g.l0.p(8)],disabledBanner:[g.l0.py(6),{alignSelf:"center"}],details:[g.l0.colWithGap(12),g.l0.maxWidth(400),{marginLeft:"auto",marginRight:"auto"}],detailsItem:{display:"grid",gridTemplateColumns:"56px auto",gap:20},detailsText:[g.l0.flex.growAndShrink(1),g.l0.textAlign.left]});function dR(e){var t=e.loading,n=e.ubbExplanation,r=e.hasPaymentMethod,i=e.handleOnCreate,o=e.refetchUbbCapabilitiesQueryData,a=e.setShowPaymentMethodForm,l=e.showPaymentMethodForm,s=e.setShowSupportForm,u=(0,ap.rv)();return n===aE.Fp.NeedsSubscription||n===aE.Fp.NeedsSubscriptionOrPaymentMethod?u?(0,c.tZ)(rC.E,{text:"You need a subscription to create a database. Navigate to Account > Billing to upgrade.",colorway:"warning",icon:(0,c.tZ)(n9.Z,{}),css:dT.ctaStatusBanner}):(0,c.BX)(R.G,{css:dT.ctaContainer,children:[(0,c.tZ)(c9.Z,{context:"workspace_hosting_pane",text:"Upgrade your plan to create a database",css:dT.cta,colorway:"primary",variant:"outlined",disabled:l,onPlanCheckoutComplete:o}),(0,c.tZ)(L.zx,{variant:"nofill",colorway:"primary",text:"or add a payment method",css:dT.cta,disabled:l,loading:t,iconLeft:(0,c.tZ)(c6.Z,{}),onClick:function(){return a()}})]}):n===aE.Fp.NeedsSmsVerification?(0,c.tZ)(c8.Z,{context:aE.jv.Neon,onSuccess:o}):n===aE.Fp.NeedsPaymentMethod?u?(0,c.tZ)(rC.E,{text:"You have used all free usage for this month. Check your email for more information or contact support.",colorway:"warning",icon:(0,c.tZ)(n9.Z,{}),css:dT.ctaStatusBanner}):(0,c.tZ)(L.zx,{colorway:"primary",text:"Add a payment method",css:dT.cta,disabled:l,loading:t,iconLeft:(0,c.tZ)(c6.Z,{}),onClick:function(){return a()}}):n===aE.Fp.NeedsUnbanning?(0,c.tZ)(c5.u,{text:"Your account currently has restrictions on creating a database. We're here to help! Please reach out to our support team for assistance.",colorway:"warning",icon:(0,c.tZ)(n9.Z,{}),css:dT.ctaStatusBanner,onClick:function(){return s()}}):n===aE.Fp.InsufficientBudget?(0,c.BX)(c.HY,{children:[(0,c.tZ)(rC.E,{text:"You've reached your monthly usage budget. Increase your budget to create a database.",colorway:"warning",icon:(0,c.tZ)(n9.Z,{}),css:dT.ctaStatusBanner}),(0,c.tZ)(R.G,{css:dT.budgetContainer,children:(0,c.tZ)(c3.L,{onUpdateSuccess:o})})]}):(0,c.BX)(c.HY,{children:[(0,c.tZ)(L.zx,{colorway:"primary",onClick:i,text:"Create a database",loading:t,css:dT.cta}),!1===r?(0,c.tZ)(c5.u,{text:"Add a payment method to avoid downtime",colorway:"warning",icon:(0,c.tZ)(n9.Z,{}),css:dT.ctaStatusBanner,onClick:function(){return u?null:a()}}):null]})}var dD=function(e){var t,n,r=e.onDatabaseCreated,i=(0,a._)((0,w.useState)(!1),2),o=i[0],l=i[1],s=(0,a._)((0,w.useState)(!1),2),u=s[0],d=s[1],f=(0,eg.Z)(),p=(0,o9.Z)().showError,m=(t=(0,A._)({},dZ,{notifyOnNetworkStatusChange:!0,onError:function(e){p(e.message)}}),eZ.a(dw,t)),v=m.loading,y=m.data,b=m.refetch,Z=(0,a._)(ss({onError:function(e){p("Error when creating Neon database: ".concat(e.message)),cW({action:"created",success:!1})},onCompleted:function(e){if((null==e?void 0:e.createNeonDatabase.__typename)==="CreateNeonDatabaseResult"){var t=e.createNeonDatabase;r({__typename:"NeonDatabase",databaseId:t.databaseId,databaseName:t.databaseName,connectionString:t.connectionString,projectId:t.projectId,isFrozen:t.isFrozen,isBackedByCycles:t.isBackedByCycles}),cW({action:"created",success:!0})}else{p("Error: ".concat(null==e?void 0:e.createNeonDatabase.message)),cW({action:"created",success:!1});return}}}),2),x=Z[0],C=Z[1].loading,_=(null==y?void 0:null===(n=y.currentUser)||void 0===n?void 0:n.usageBasedBilling.__typename)==="UserUsageBasedBillingSummary"?y.currentUser.usageBasedBilling.capabilities:null,S=(0,w.useMemo)(function(){return function(e){var t=e.data,n=null==t?void 0:t.usageInterval;if(n&&"UsageInterval"===n.__typename){var r=Math.max(0,n.resources.neonComputeTime.allotment-n.resources.neonComputeTime.usage),i=(0,dv.fZ)(r,{resourceUsageType:"ComputeHours"}),o=Math.max(0,n.resources.neonDataStorage.allotment-n.resources.neonDataStorage.usage);return{formattedComputeTimeAmount:i,formattedDataStorageAmount:(0,dv.fZ)(o,{precision:1,resourceUsageType:"GiB"})}}}({data:null==y?void 0:y.currentUser})},[y]);return(0,c.BX)(R.G,{css:dT.self,children:[(0,c.tZ)(rx.u,{isOpen:u,onRequestClose:function(){return d(!1)},children:(0,c.tZ)(c4.Z,{onRequestClose:function(){return d(!1)}})}),(0,c.BX)(R.G,{css:dT.container,children:[(0,c.BX)(R.G,{css:dT.title,children:[(0,c.tZ)(h.xv,{variant:"subheadBig",children:"PostgreSQL Database"}),(0,c.tZ)(h.xv,{color:"dimmer",children:"Fully-managed, usage based PostgreSQL database with 10GB of fast read/write storage."}),(0,c.tZ)(h.xv,{css:g.l0.textAlign.center,children:(0,c.tZ)("a",{href:sL,target:"_blank",rel:"noopener",children:"Learn more"})})]}),(0,c.BX)(R.G,{css:g.l0.colWithGap(16),children:[(0,c.tZ)(R.G,{css:[g.l0.rowWithGap(0),g.l0.justify.center],children:(0,c.tZ)(oG.Z,{src:"/public/images/db_illustration.png",width:120,height:120,alt:"FPO visual"})}),null!=S?(0,c.BX)(h.xv,{css:dT.usage,color:"dimmer",children:["You have ",S.formattedComputeTimeAmount," left this month and ",S.formattedDataStorageAmount," of storage left in total."]}):null,(0,c.BX)(R.G,{css:g.l0.colWithGap(8),children:[(0,c.tZ)(dR,{loading:v||C,ubbExplanation:null==_?void 0:_.explanation,hasPaymentMethod:null==_?void 0:_.hasPaymentMethod,handleOnCreate:function(){x({variables:{input:{replId:f}}})},refetchUbbCapabilitiesQueryData:b,setShowPaymentMethodForm:function(){return l(!0)},showPaymentMethodForm:o,setShowSupportForm:function(){return d(!0)}}),o?(0,c.tZ)(M.Tg,{elevated:!0,css:dT.payment,children:(0,c.tZ)(sS.q,{onSuccess:(0,to._)(function(){return(0,ta.Jh)(this,function(e){switch(e.label){case 0:return l(!1),[4,b()];case 1:return e.sent(),[2]}})}),context:"workspace_hosting_pane"})}):null]})]}),(0,c.BX)(R.G,{css:dT.details,children:[(0,c.BX)(R.G,{css:dT.detailsItem,children:[(0,c.tZ)(dg.lt,{}),(0,c.BX)(h.xv,{css:dT.detailsText,children:["Get charged for what you use across compute time, storage, written data and data transfer,"," ",(0,c.tZ)("a",{href:sM,target:"_blank",rel:"noopener",children:"see pricing"})]})]}),(0,c.BX)(R.G,{css:dT.detailsItem,children:[(0,c.tZ)(dg.fG,{}),(0,c.BX)(h.xv,{css:dT.detailsText,children:["Free usage allocations are included in Replit plans, and then billed at a per unit price,"," ",(0,c.tZ)("a",{href:sM,target:"_blank",rel:"noopener",children:"see allocations"})]})]})]})]})]})},dI=function(e){var t=e.onDatabaseCreated;return(0,tY.P5)({controlName:sA.uZ,logFlagToAnalytics:!0})?(0,c.tZ)(dD,{onDatabaseCreated:t}):(0,c.tZ)(dk,{onDatabaseCreated:t})},dG=function(e){var t,n,r=e.performPaneOperation,i=(0,eg.Z)(),o=(0,o9.Z)().showError,l=(0,y.Z)().psql,s=(0,a._)((0,w.useState)([]),2),u=s[0],d=s[1],f=(t=(0,A._)({},sl,{variables:{input:{replId:i}},fetchPolicy:"no-cache",onCompleted:function(e){if("GetNeonDatabasesResult"===e.getNeonDatabases.__typename){d(e.getNeonDatabases.databases);return}o("Error: ".concat(e.getNeonDatabases.message))}}),eZ.a(sf,t)),h=f.loading,p=f.refetch,m=cQ(),b=(0,w.useCallback)((n=(0,to._)(function(e){var t;return(0,ta.Jh)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),d([e]),[4,l.ensureNixPsqlPackageInstalled(!0)];case 1:return n.sent(),m({connectionString:e.connectionString,databaseName:e.databaseName}),[3,3];case 2:return t=n.sent(),o("Error: ".concat(t.message)),[3,3];case 3:return[2]}})}),function(e){return n.apply(this,arguments)}),[l,m,o]),Z=(0,tK.Dv)(dc);return Z?(0,c.tZ)(dm,{neonDatabases:[Z],onDatabaseDeleted:p,onDatabaseUnfreezed:p,onDatabaseMigrated:b,performPaneOperation:r}):h?(0,c.tZ)(R.G,{css:[g.l0.flex.row,g.l0.justify.center,g.l0.p(32)],children:(0,c.tZ)(v.Z,{})}):u.length?(0,c.tZ)(dm,{neonDatabases:u,onDatabaseDeleted:p,onDatabaseUnfreezed:p,onDatabaseMigrated:b,performPaneOperation:r}):(0,c.tZ)(dI,{onDatabaseCreated:b})},dB=s.Dy.Object({type:s.Dy.Literal("neon")}),dA={Content:function(e){var t=e.options;return(0,c.tZ)(dG,{performPaneOperation:t.performPaneOperation})},Icon:function(e){var t=e.size;return(0,c.tZ)(cM.Z,{size:t})},getTitle:function(){return"PostgreSQL"},decode:function(e){return u.B4.Decode(dB,e)}},dP=n(9610),dN=n(72903),dU=n(81810),dO=(0,p.X)({unavailable:[g.l0.p(8)]}),dL=s.Dy.Object({type:s.Dy.Literal("networking")}),dM={Content:function(e){var t,n=e.options.performPaneOperation,r=(0,o9.Z)().showError,i=(0,y.Z)().fs;return(0,tY.P5)({controlName:dU.wK,logFlagToAnalytics:!0})?(0,c.tZ)(dN._g,{openDotReplit:(0,to._)(function(){return(0,ta.Jh)(this,function(e){switch(e.label){case 0:return[4,i.stat(".replit")];case 1:if(!e.sent().exists)return r("Could not find .replit configuration file."),[2];return n({operation:"open",secondary:!0,pane:{type:"codeEditor",data:{path:".replit"}}}),[2]}})}),openWebview:(t=(0,to._)(function(e){return(0,ta.Jh)(this,function(t){return n({operation:"open",pane:{type:"webview",data:e?{portType:"local",port:e}:void 0},secondary:!0}),[2]})}),function(e){return t.apply(this,arguments)})}):(0,c.tZ)(R.G,{css:dO.unavailable,children:(0,c.tZ)(h.xv,{children:"Networking is not available."})})},Icon:function(e){var t=e.size;return(0,c.tZ)(dP.Z,{size:t})},getTitle:function(){return"Networking"},decode:function(e){return u.B4.Decode(dL,e)}},dX=n(35704);function dF(){return(0,c.tZ)(R.G,{children:(0,c.tZ)(h.xv,{variant:"headerDefault",children:"Object Storage"})})}var dW=s.Dy.Object({type:s.Dy.Literal("objectStorage")}),dH={Content:function(){return(0,c.tZ)(dF,{})},Icon:function(e){var t=e.size;return(0,c.tZ)(dX.Z,{size:t})},getTitle:function(){return"Object Storage"},decode:function(e){return u.B4.Decode(dW,e)}},dV=n(31270),dz=n(48272),dj=n(93646),dq=n(59072);(0,tQ.cn)({replId:"",packageManagers:{}}),(vf=vE||(vE={})).Initializing="Initializing",vf.Installing="Installing",vf.Uninstalling="Uninstalling",vf.Idle="Idle",(vh=vk||(vk={})).Install="Install",vh.Uninstall="Uninstall";var dY=(0,w.createContext)(null);function d$(){var e=(0,w.useContext)(dY);if(!e)throw Error("Expected store in context");return e}var dJ=(0,tQ.cn)(null);function dK(){return(0,tK.Dv)(dJ,{store:d$()})}(0,tQ.cn)(null);var dQ=n(46801);function d0(e){var t=dK(),n=(0,y.Z)(),r=(0,a._)((0,w.useState)(null),2),i=r[0],o=r[1];return(0,w.useEffect)(function(){if((null==t?void 0:t.id)&&e.name){var r,i=(0,dQ.C)(t.id),a=!1;return(r=(0,to._)(function(){var r;return(0,ta.Jh)(this,function(l){switch(l.label){case 0:return[4,i.getPackageInfo({id:t.id,name:e.name,services:n})];case 1:if(r=l.sent(),a)return[2];return o(null!=r?r:null),[2]}})}),function(){return r.apply(this,arguments)})(),function(){a=!0}}},[null==t?void 0:t.id,e.name]),i}var d1=n(47030),d2=n(41331),d8=n.n(d2),d4=/(.+)(?:\S+)?<([^>,]+)[>,]/,d3=R.K.span;function d5(e){var t=e.author,n=d4.exec(t);if(n){var r=n[1],i=n[2];return(0,c.BX)(c.HY,{children:["By ",r,(0,c.BX)("a",{href:"mailto:".concat(i),children:["<",i,">"]})]})}return(0,c.BX)(d3,{children:["By ",t]})}var d6=n(81764);function d9(e){var t=e.isInstalled,n=e.isInQueue;return e.isCurrentAction?(0,c.tZ)(v.Z,{}):n?(0,c.tZ)(d6.Z,{}):t?(0,c.tZ)(c1.Z,{}):(0,c.tZ)(m.Z,{})}var d7=R.K.span,fe=(0,p.X)({metadata:[g.l0.colWithGap(2)],metadataSkeleton:[g.l0.colWithGap(8),g.l0.pt(4)],metadataSkeletonVersion:[ef.p.foregroundPulse(),g.l0.height(16),g.l0.maxWidth(64),g.l0.borderRadius(4)],metadataSkeletonDescription:[ef.p.foregroundPulse(),g.l0.height(16),g.l0.borderRadius(4),g.l0.maxWidth(425)],root:[g.l0.borderRadius(8),g.l0.p(8)],header:[g.l0.flex.row,g.l0.justify.spaceBetween],headerTitle:[g.l0.display.flex,g.l0.rowWithGap(8),g.l0.flex.growAndShrink(1)],headerTitleText:[g.l0.display.inline,g.l0.flex.growAndShrink(1),g.l0.overflow("hidden"),g.l0.truncate],headerTitlePills:[g.l0.display.inlineFlex,g.l0.rowWithGap(4),g.l0.flex.shrink(0)],headerButton:[],content:[g.l0.colWithGap(4)],error:[g.l0.mt(4)],actions:[g.l0.rowWithGap(8),g.l0.mt(8)],consoleButton:[g.l0.width("calc(50% - ".concat(g.TV.space8,")"))],cancelButton:[g.l0.width("calc(50% - ".concat(g.TV.space8,")"))],actionButton:[g.l0.flex.grow(1),g.l0.flex.shrink(0)]});function ft(e){var t=e.title,n=e.content,r=e.isExpanded;return(0,c.BX)(R.G,{css:fe.metadata,children:[t?(0,c.tZ)(h.xv,{color:"dimmer",children:t}):null,n?(0,c.tZ)(h.xv,{maxLines:r?void 0:1,children:n}):null]})}function fn(e){var t=e.title,n=e.content;return(0,c.BX)(R.G,{css:fe.metadataSkeleton,children:[void 0===t||t?(0,c.tZ)(R.G,{css:fe.metadataSkeletonVersion}):null,void 0===n||n?(0,c.tZ)(R.G,{css:fe.metadataSkeletonDescription}):null]})}function fr(e){var t,n=e.name,r=e.pkg,i=e.isMetadataLoading,o=e.openConsole,l=e.pills,s=dK(),u=(0,dq.te)(null==s?void 0:s.id),f=(0,dq.pN)(null==s?void 0:s.id),p=(0,dq.B2)(),m=(0,dq.cW)(),v=(0,dq.wY)(),g=(0,w.useMemo)(function(){return r.license?d8()(r.license,{upgrade:!1})||(r.license.length<40?r.license:"Unknown License"):"Unknown License"},[r.license]),y=(0,w.useMemo)(function(){return!!(null!==p&&p.pkgs.find(function(e){return e.name===r.name}))},[p]),b=(0,w.useMemo)(function(){return m.find(function(e){return e.pkgs.find(function(e){return e.name===r.name})})},[m]),Z=!!b,x=(0,w.useMemo)(function(){return!!u.find(function(e){return e.name===r.name})},[u]),C=!!(r.homepageURL||r.license||r.author),_=(0,w.useMemo)(function(){return!!f.find(function(e){return e.name===r.name})},[f]),S=(0,a._)((0,w.useState)(!1),2),E=S[0],k=S[1],T=(0,dq.jh)(),D=(0,dq.Wx)(),I=(0,dq.zi)();return(0,c.BX)(M.Tg,{css:fe.root,elevated:!0,children:[(0,c.BX)(R.G,{css:fe.header,children:[(0,c.BX)(h.h4,{css:fe.headerTitle,level:2,variant:"subheadDefault",multiline:!1,children:[(0,c.BX)(d7,{css:fe.headerTitleText,children:[null!=n?n:r.name,r.version?(0,c.BX)(h.xv,{color:"dimmer",children:["@",r.version]}):null]}),l?(0,c.tZ)(R.G,{css:fe.headerTitlePills,children:l}):null]}),C?(0,c.tZ)(d.hU,{css:fe.headerButton,alt:"Show more info",tooltipHidden:!0,onClick:function(){return k(function(e){return!e})},children:(0,c.tZ)(lk.Z,{rotate:E?90:0})}):null]}),(0,c.tZ)(R.G,{css:fe.content,children:void 0!==i&&i?(0,c.tZ)(fn,{title:!1}):(0,c.BX)(c.HY,{children:[(0,c.tZ)(ft,{content:null!==(t=r.description)&&void 0!==t?t:"This package has no description.",isExpanded:E}),r.homepageURL&&E?(0,c.tZ)(ft,{content:(0,c.tZ)("a",{href:r.homepageURL,rel:"noreferrer noopener",target:"_blank",children:r.homepageURL}),isExpanded:E}):null,g&&E?(0,c.tZ)(ft,{content:g,isExpanded:E}):null,r.author&&E?(0,c.tZ)(ft,{content:(0,c.tZ)(d5,{author:r.author}),isExpanded:E}):null]})}),_?(0,c.tZ)(rC.E,{css:fe.error,colorway:"negative",icon:(0,c.tZ)(n9.Z,{}),text:"Couldn't ".concat(x?"uninstall":"install"," package. See Console for details, or try again.")}):null,(0,c.tZ)(R.G,{css:fe.actions,children:_?(0,c.BX)(c.HY,{children:[(0,c.tZ)(L.zx,{css:fe.consoleButton,text:"Console",onClick:function(){o()},disabled:y||Z,colorway:"primary",iconLeft:(0,c.tZ)(d1.Z,{})}),(0,c.tZ)(L.zx,{css:fe.actionButton,text:"Try Again",onClick:function(){(null==s?void 0:s.id)&&(v(s.id,[r]),x?D({id:s.id,pkg:r}):T({id:s.id,pkg:r}))},loading:y||Z,colorway:x?"red":void 0,variant:x?"outlined":void 0,iconLeft:(0,c.tZ)(d9,{isInstalled:x,isInQueue:Z,isCurrentAction:y})})]}):(0,c.BX)(c.HY,{children:[(0,c.tZ)(L.zx,{css:fe.actionButton,text:y?(null==p?void 0:p.kind)===dq.TH.Install?"Installing":"Removing":Z?(null==b?void 0:b.kind)===dq.TH.Install?"Waiting to install":"Waiting to remove":x?"Remove":"Install",onClick:function(){(null==s?void 0:s.id)&&(x?D({id:s.id,pkg:r}):T({id:s.id,pkg:r}))},loading:y||Z,colorway:x?"red":void 0,variant:x?"outlined":void 0,iconLeft:(0,c.tZ)(d9,{isInstalled:x,isInQueue:Z,isCurrentAction:y})}),Z?(0,c.tZ)(L.zx,{css:fe.cancelButton,text:"Cancel",onClick:function(){r.name&&I(r.name)},disabled:y,loading:y}):null]})})]})}function fi(e){var t,n,r=e.pkg,i=e.openConsole,o=d0(r),a=o?(0,P._)((0,A._)({},o),{version:null!==(t=r.spec)&&void 0!==t?t:o.version}):r;return(0,c.tZ)(fr,{name:null!==(n=null==o?void 0:o.prettyName)&&void 0!==n?n:void 0,pkg:a,isMetadataLoading:null===o,openConsole:i})}function fo(e){return(0,c.tZ)("a",(0,A._)({href:"https://docs.replit.com/programming-ide/installing-packages",target:"_blank",rel:"noreferrer"},e))}var fa=(0,p.X)({root:[g.l0.colWithGap(8),{"@container (min-width: 600px)":[g.l0.colWithGap(0),g.l0.align.start,{display:"grid",gridTemplate:"auto / 1fr 1fr",gap:g.TV.space8}],"@container (min-width: 1200px)":[{display:"grid",gridTemplate:"auto / 1fr 1fr 1fr",gap:g.TV.space8}]}]});function fl(e){return(0,c.tZ)(R.G,(0,P._)((0,A._)({},e),{css:fa.root}))}function fc(e){var t=e.name,n=e.openConsole,r=d0({name:t});return(0,c.tZ)(fr,{pkg:null!=r?r:{name:t},isMetadataLoading:null===r,openConsole:n,pills:[(0,c.tZ)(uB.D,{text:"Suggested",colorway:"primary"},"suggested")]})}var fs=(0,p.X)({packages:[g.l0.pt(8)],separator:[g.l0.backgroundColor.backgroundHigher,g.l0.height(1),g.l0.borderRadius(1),g.l0.mt(6),{border:"none",marginLeft:"auto",marginRight:"auto",width:"95%"}]});function fu(e){var t=e.openConsole,n=dK(),r=(0,dq.te)(null==n?void 0:n.id),i=(0,dq.B2)(),o=(0,dq.cW)(),a=[];switch(null==n?void 0:n.language){default:return null;case"nodejs":a=["express","discord.js","axios","moment","node-fetch","chalk"];break;case"python3":a=["replit","requests","pandas","discord","matplotlib","flask"]}var l=function(e){if(r.find(function(t){var n;return(null===(n=t.name)||void 0===n?void 0:n.toLowerCase())===e})||(i&&i.kind===dq.TH.Install?i.pkgs.find(function(t){var n;return(null===(n=t.name)||void 0===n?void 0:n.toLowerCase())===e}):null))return!0;var t=!0,n=!1,a=void 0;try{for(var l,c=o[Symbol.iterator]();!(t=(l=c.next()).done);t=!0){var s=l.value;if(s.kind===dq.TH.Install&&s.pkgs.find(function(t){var n;return(null===(n=t.name)||void 0===n?void 0:n.toLowerCase())===e}))return!0}}catch(e){n=!0,a=e}finally{try{t||null==c.return||c.return()}finally{if(n)throw a}}return!1},s=a.filter(function(e){return!l(e)}).map(function(e){return(0,c.tZ)(fc,{name:e,openConsole:t},e)});return s.length>0?(0,c.BX)(c.HY,{children:[(0,c.tZ)("hr",{css:fs.separator}),(0,c.tZ)(fl,{css:fs.packages,children:s})]}):null}var fd=(0,p.X)({root:[g.l0.maxWidth(800),g.l0.width("100%"),{marginLeft:"auto",marginRight:"auto","@container (min-width: 1200px)":[g.l0.maxWidth(1400)]}],header:[g.l0.flex.row,g.l0.justify.spaceBetween,g.l0.py(4)],headerLeft:[g.l0.rowWithGap(4),g.l0.align.center],headerLoadingIcon:[g.l0.px(4)],headerRight:[g.l0.rowWithGap(4)],headerTitle:[{textTransform:"capitalize"}],packages:[g.l0.pt(8)],empty:[g.l0.pt(8),g.l0.colWithGap(8),g.l0.width("100%")],packagesWrapper:[g.l0.colWithGap(8),g.l0.width("100%")]});function ff(e){var t=e.openFile,n=e.openConsole,r=dK(),i=(0,dq.te)(null==r?void 0:r.id),o=(0,dq.$z)(null==r?void 0:r.id),s=(0,dq.cW)(),u=(0,dq.B2)(),f=(0,a._)((0,w.useState)(!0),2),p=f[0],m=f[1];if(null===r)return null;if(!o||o===dq.C0.Uninitialized||o===dq.C0.Initializing)return(0,c.tZ)(R.G,{css:fd.root,children:(0,c.BX)(R.G,{css:fd.header,children:[(0,c.BX)(R.G,{css:fd.headerLeft,children:[(0,c.tZ)(tn.u,{tooltip:"Loading",children:(0,c.tZ)(R.G,{css:fd.headerLoadingIcon,children:(0,c.tZ)(v.Z,{})})}),(0,c.BX)(h.h4,{css:fd.headerTitle,variant:"subheadDefault",level:2,children:[r.language," Packages"]})]}),(0,c.tZ)(R.G,{css:fd.headerRight,children:r.packagerFiles.length>0?(0,c.tZ)(d.hU,{alt:"Open ".concat(r.packagerFiles[0]),onClick:function(){r&&t(r.packagerFiles[0])},children:(0,c.tZ)(dj.Z,{})}):null})]})});var g=u&&u.id===r.id&&u.kind===dq.TH.Install?u.pkgs:[],y=s.flatMap(function(e){return e.id===r.id&&e.kind===dq.TH.Install?e.pkgs:[]}),b=(0,l._)(g).concat((0,l._)(y),(0,l._)(i));return(0,c.BX)(R.G,{css:fd.root,children:[(0,c.BX)(R.G,{css:fd.header,children:[(0,c.BX)(R.G,{css:fd.headerLeft,children:[b.length>0?(0,c.tZ)(d.hU,{alt:"Show packages",tooltipHidden:!0,onClick:function(){return m(function(e){return!e})},children:(0,c.tZ)(lk.Z,{rotate:p?90:0})}):null,(0,c.BX)(h.h4,{css:fd.headerTitle,variant:"subheadDefault",level:2,children:[r.language," Packages"]})]}),(0,c.tZ)(R.G,{css:fd.headerRight,children:0===b.length?(0,c.tZ)(h.h4,{level:3,children:"No Packages Installed."}):(0,c.BX)(c.HY,{children:[(0,c.BX)(h.h4,{level:3,children:["Installed ",b.length," ",(0,ed.Z)("package",b.length)]}),r.packagerFiles.length>0?(0,c.tZ)(d.hU,{alt:"Open ".concat(r.packagerFiles[0]),onClick:function(){r&&t(r.packagerFiles[0])},children:(0,c.tZ)(dj.Z,{})}):null]})})]}),p?(0,c.BX)(R.G,{css:0===b.length?fd.empty:fd.packagesWrapper,children:[0===b.length?(0,c.BX)(h.xv,{children:["You don't have any packages installed."," ",r.packageSearch?(0,c.BX)(c.HY,{children:["Try searching for a package to install, or"," ",(0,c.tZ)(fo,{children:"learn more about packages here"}),"","."]}):(0,c.BX)(h.xv,{children:[(0,c.tZ)(fo,{children:"Learn more about packages here"}),"","."]})]}):null,b.length>0?(0,c.tZ)(c.HY,{children:(0,c.tZ)(fl,{css:fd.packages,children:b.sort(function(e,t){return(null==e?void 0:e.name)?(null==t?void 0:t.name)?e.name.localeCompare(t.name):-1:1}).map(function(e){return(0,c.tZ)(fi,{pkg:e,openConsole:n},e.name)})})}):null,(0,c.tZ)(fu,{openConsole:n})]}):null]})}var fh=n(13225);function fp(e){var t,n,r=e.onResults,i=e.onLoading,o=e.className,l=dK(),s=(0,a._)((0,w.useState)(""),2),u=s[0],d=s[1],f=(0,w.useRef)(0),h=function(){f.current++,null==r||r(null),null==i||i(!1)},p=(t=(0,y.Z)(),n=(0,u4.lV)((0,w.useCallback)(function(e){return e(dJ)},[dJ]),{store:d$()}),(0,w.useCallback)(function(e){var r=n();return(null==r?void 0:r.id)?(0,dQ.C)(r.id).search({id:r.id,query:e,services:t}):[]},[]));(0,fh.Z)(function(){if(""!==u.trim()){var e,t=++f.current;(e=(0,to._)(function(){var e;return(0,ta.Jh)(this,function(n){switch(n.label){case 0:return null==i||i(!0),[4,p(u)];case 1:if(e=n.sent(),t!==f.current)return[2];return null==r||r(null!=e?e:[]),null==i||i(!1),[2]}})}),function(){return e.apply(this,arguments)})()}},[u],500);var m=(0,w.useRef)(null);return(0,w.useEffect)(function(){m.current&&m.current.focus()},[]),(0,c.tZ)(R.G,{className:o,children:(0,c.tZ)(ne.E,{inputRef:m,value:u,onChange:function(e){""===e.target.value.trim()&&h(),d(e.target.value)},onClear:function(){d(""),h()},placeholder:l?"Search ".concat(l.language," packages"):void 0})})}var fm=(0,p.X)({root:[g.l0.maxWidth(800),g.l0.width("100%"),{marginLeft:"auto",marginRight:"auto","@container (min-width: 1200px)":[g.l0.maxWidth(1400)]}],skeleton:[g.l0.borderRadius(8),g.l0.p(8),ef.p.backgroundPulse(),g.l0.height(128)]});function fv(){return(0,c.tZ)(R.G,{css:fm.root,children:(0,c.tZ)(fl,{children:Array.from({length:3},function(e,t){return(0,c.tZ)(M.Tg,{css:fm.skeleton,elevated:!0},"SearchLoading-".concat(t))})})})}function fg(e){var t,n=e.pkg,r=e.openConsole,i=dK(),o=d0(n),a=o?(0,P._)((0,A._)({},o),{version:null!==(t=n.spec)&&void 0!==t?t:o.version}):n,l=(null==i?void 0:i.id)==="nix"?null==o?void 0:o.prettyName:void 0;return(0,c.tZ)(fr,{name:l,pkg:a,isMetadataLoading:null===o,openConsole:r})}function fy(e){var t=e.pkg,n=e.openConsole;return(0,c.tZ)(fr,{pkg:t,openConsole:n})}var fb=(0,p.X)({root:[g.l0.colWithGap(8),g.l0.maxWidth(800),g.l0.width("100%"),{marginLeft:"auto",marginRight:"auto","@container (min-width: 1200px)":[g.l0.maxWidth(1400)]}],results:[g.l0.colWithGap(8)],empty:[g.l0.flex.row,g.l0.justify.center]});function fZ(e){var t=e.results,n=e.openConsole,r=dK(),i=(null==r?void 0:r.id)==="nix"?fg:fy;return(0,c.tZ)(R.G,{css:fb.root,children:(0,c.tZ)(R.G,{css:fb.results,children:0===t.length?(0,c.tZ)(h.xv,{color:"dimmer",css:fb.empty,children:"No Packages Found"}):(0,c.tZ)(fl,{children:t.map(function(e){return(0,c.tZ)(i,{pkg:e,openConsole:n},e.name)})})})})}var fw=n(40664),fx=(0,p.X)({root:[g.l0.p(8),g.l0.borderRadius(8),g.l0.colWithGap(16)],header:[g.l0.flex.row,g.l0.align.center,g.l0.justify.spaceBetween],headerLeft:[g.l0.rowWithGap(4),g.l0.align.center],headerRight:[],content:[g.l0.display.block]});function fC(e){var t=e.title,n=e.onClose,r=e.children,i=(0,a._)((0,w.useState)(!0),2),o=i[0],l=i[1];return(0,c.BX)(M.Tg,{elevated:!0,css:fx.root,children:[(0,c.BX)(R.G,{css:fx.header,children:[(0,c.BX)(R.G,{css:fx.headerLeft,children:[(0,c.tZ)(h.h4,{level:2,variant:"subheadDefault",children:t}),(0,c.tZ)(d.hU,{alt:o?"Minimize tip information":"Expand tip information",tooltipHidden:!0,onClick:function(){return l(function(e){return!e})},children:(0,c.tZ)(lk.Z,{rotate:o?90:0})})]}),(0,c.tZ)(R.G,{css:fx.headerRight,children:(0,c.tZ)(d.hU,{alt:"Dismiss tip",tooltipHidden:!0,onClick:n,children:(0,c.tZ)(n7.Z,{})})})]}),o?(0,c.tZ)(R.G,{css:fx.content,children:r}):null]})}var f_=(0,p.X)({root:[g.l0.colWithGap(8),g.l0.pb(24)]});function fS(){var e=(0,fw.Z)("packager","show_packager_about_tooltip"),t=(0,fw.Z)("packager","show_packager_import_tooltip");return((0,w.useEffect)(function(){e.register()},[e]),(0,w.useEffect)(function(){t.register()},[t]),e.shouldDisplay||t.shouldDisplay)?(0,c.BX)(R.G,{css:f_.root,children:[e.shouldDisplay?(0,c.BX)(fC,{title:"What are packages?",onClose:e.dismiss,children:["Packages are collections of code that can extend the functionality of your programs. For example, you could add a package to make adding image carousels easier on websites, or a package to manage currency comparisons."," ",(0,c.tZ)(fo,{children:"Learn more about packages"}),"","."]}):null,t.shouldDisplay?(0,c.tZ)(fC,{title:"TipAuto Import",onClose:t.dismiss,children:"If you know which packages you want to use, you can just import and use them in your files as if they were already installed, and they will be installed automatically the next time you run the Repl."}):null]}):null}var fE=n(16278);function fk(e){var t=e.children,n=e.config,r=(0,tK.b9)(dJ,{store:d$()});return(0,w.useEffect)(function(){(null==n?void 0:n.id)&&r(n)},[n]),(0,c.tZ)(c.HY,{children:t})}function fT(e){var t=e.children,n=e.config,r=(0,a._)((0,w.useState)(function(){return(0,tQ.MT)()}),1)[0];return(0,c.tZ)(dY.Provider,{value:r,children:n?(0,c.tZ)(fk,{config:n,children:t}):t})}var fR=(0,p.X)({root:[g.l0.pt(16),g.l0.p(8),{containerType:"inline-size"}],center:[g.l0.width("100%"),g.l0.maxWidth(600),g.l0.colWithGap(4),{marginLeft:"auto",marginRight:"auto","@container (min-width: 400px)":[g.l0.maxWidth(800)],"@container (min-width: 1200px)":[g.l0.maxWidth(1400)]}],title:[],content:[g.l0.pt(8),g.l0.colWithGap(16)],search:[g.l0.rowWithGap(8),g.l0.width("100%")],searchInput:[g.l0.flex.grow(1)],configSelect:[],packages:[g.l0.colWithGap(16)]});function fD(e){var t,n,r,i,o,l=e.openFile,s=e.openConsole,u=(0,fE.I)(),d=(0,B.Z)(function(){return u.filter(function(e){return"nix"!==e.id})},[u]),f=(0,a._)((t=(0,fE.I)(),n=(0,B.Z)(function(){return t.filter(function(e){return"nix"!==e.id})},[t]),i=(r=(0,a._)((0,w.useState)(null),2))[0],o=r[1],(0,w.useEffect)(function(){n.length>0&&(null==i||!n.find(function(e){return e&&e.id===i.id}))&&o(n[0])},[i,n]),[i,o]),2),p=f[0],m=f[1],v=(0,a._)((0,w.useState)(null),2),g=v[0],y=v[1],b=(0,a._)((0,w.useState)(!1),2),Z=b[0],x=b[1],C=null;return C=null!==g?(0,c.tZ)(fZ,{results:g,openConsole:s}):Z?(0,c.tZ)(fv,{}):(0,c.tZ)(c.HY,{children:d.map(function(e){return e.id===(null==p?void 0:p.id)?(0,c.tZ)(ff,{openFile:l,openConsole:s},e.id):(0,c.tZ)(fT,{config:e,children:(0,c.tZ)(ff,{openFile:l,openConsole:s})},e.id)})}),(0,c.tZ)(R.G,{css:fR.root,children:(0,c.tZ)(R.G,{css:fR.center,children:0===d.length?(0,c.BX)(R.G,{children:[(0,c.tZ)(h.h4,{level:2,variant:"subheadBig",children:"Sorry, packages are not configured for this Repl."}),(0,c.tZ)(h.xv,{variant:"subheadDefault",children:"We are working on making more features configurable and packages available for more languages, check back again in the future."})]}):(0,c.BX)(c.HY,{children:[(0,c.tZ)(fS,{}),(0,c.tZ)(h.h4,{css:fR.title,level:2,variant:"subheadBig",children:"Packages"}),(0,c.tZ)(R.G,{css:fR.content,children:(0,c.BX)(fT,{config:p,children:[(0,c.BX)(R.G,{css:fR.search,children:[(null==p?void 0:p.packageSearch)?(0,c.tZ)(fp,{css:fR.searchInput,onResults:y,onLoading:x}):(0,c.tZ)(R.G,{css:fR.searchInput}),d.length>1&&(0,c.tZ)(dz.P,{css:fR.configSelect,items:d,selectedItem:p,onChange:function(e){return m(e)},"aria-label":"Select packager configuration"})]}),(0,c.tZ)(R.G,{css:fR.packages,children:C})]})})]})})})}var fI=s.Dy.Object({type:s.Dy.Literal("packager")}),fG={Content:function(e){var t=e.options;return(0,c.tZ)(fD,{openFile:function(e){return t.performPaneOperation({operation:"open",pane:(0,b.$E)(e),secondary:!0})},openConsole:function(){t.performPaneOperation({operation:"open",pane:{type:"runnerOutput"},secondary:!0})}})},Icon:function(e){var t=e.size;return(0,c.tZ)(dV.Z,{size:t})},getTitle:function(){return"Packages"},decode:function(e){return u.B4.Decode(fI,e)}},fB=n(52924),fA=n(32681),fP=n.n(fA),fN=n(45726),fU=n(11774),fO=(0,p.X)({create:[g.l0.colWithGap(8),g.l0.p(8)],pedit:{width:"100%",height:"100%"},canvas:{width:"100%",height:"100%",outline:"none",position:"absolute",top:0,left:0},upgradeButton:[g.l0.position.absolute,g.l0.top(8),g.l0.left("50%"),{transform:"translateX(-50%)"}]});function fL(e){var t=e.data,n=e.onSave,r=(0,w.useRef)(null),i=(0,w.useRef)(null),o=(0,y.Z)().fs,l=(0,o9.Z)(),s=l.showError,u=l.showConfirm,d=(0,a._)((0,w.useState)(!1),2),f=d[0],h=d[1],p=(0,cx.Z)(function(){var e=r.current;if(!e)return null;e.width=e.offsetWidth,e.height=e.offsetHeight;var t=e.getContext("2d");t&&(t.imageSmoothingEnabled=!1)},{type:"debounce",wait:100});return(0,w.useEffect)(function(){var e=r.current;if(e){e.width=e.offsetWidth,e.height=e.offsetHeight;var o=fP()({canvas:e,data:t}),a=function(){return n(o.save())};return o.on("change",a),o.on("save",a),o.on("export",function(){return h(!0)}),i.current=o,e.focus(),function(){o&&o.cleanUp(),i.current&&(i.current=null)}}},[t,n,r]),(0,c.BX)(c.HY,{children:[(0,c.tZ)("canvas",{css:fO.canvas,ref:function(e){r.current=e,p(e)},tabIndex:0}),(0,c.tZ)(rx.u,{isOpen:f,onRequestClose:function(){return h(!1)},children:(0,c.tZ)(fN.Z,{prompt:"Export",desc:"What name to give to the exported file?",placeholder:"filename",type:"text",onCancel:function(){return h(!1)},onConfirm:function(e){if(!i.current){h(!1);return}var t="".concat(e,".png"),n=i.current.curFrame().toPNG();o.writeFile(t,tT.Z.from(n)).then(function(e){if(e.error){s("Failed to write to file ".concat(t));return}u("Successfully exported to ".concat(t)),h(!1)})}})})]})}function fM(e){var t,n=e.activeFile,r=(0,y.Z)().fs,i=(0,a._)((0,w.useState)(!0),2),o=i[0],l=i[1],s=(0,a._)((0,w.useState)(null),2),u=s[0],d=s[1],f=(0,o9.Z)().showError,h=n.endsWith(".kbmsprite");(0,w.useEffect)(function(){var e=!1;function t(){return(t=(0,to._)(function(){var t,i,o;return(0,ta.Jh)(this,function(a){switch(a.label){case 0:return[4,r.readFile(n)];case 1:if(t=a.sent(),l(!1),e)return[2];if(t.error)return f("failed to read ".concat(n)),[2];return o=(i=t.content.toString())&&JSON.parse(i),d(h?(0,fU.C)(o):o),[2]}})})).apply(this,arguments)}return!function(){t.apply(this,arguments)}(),function(){e=!0}},[r,n,f,h]);var p=(0,w.useCallback)((t=(0,to._)(function(e){return(0,ta.Jh)(this,function(t){switch(t.label){case 0:if(!h)return[3,2];return[4,(0,fU.u)(e)];case 1:e=t.sent(),t.label=2;case 2:return[4,r.writeFile(n,tT.Z.from(JSON.stringify(e)))];case 3:return t.sent().error&&f("Failed to save ".concat(n,", please try again")),[2]}})}),function(e){return t.apply(this,arguments)}),[r,n,f,h]);return o?(0,c.tZ)(v.Z,{}):u?(0,c.tZ)(fL,{data:u,onSave:p}):(0,c.tZ)(fX,{onCreate:function(e){return d(e)}})}function fX(e){var t=e.onCreate,n=(0,a._)((0,w.useState)(""),2),r=n[0],i=n[1],o=(0,a._)((0,w.useState)(""),2),l=o[0],s=o[1],u=Number(r),d=Number(l);return(0,c.BX)(R.G,{css:fO.create,children:[(0,c.tZ)(h.xv,{variant:"subheadDefault",multiline:!1,children:"Create a Pedit file"}),(0,c.tZ)(U.II,{placeholder:"width",value:r,onChange:function(e){return i(e.target.value)}}),(0,c.tZ)(U.II,{placeholder:"height",value:l,onChange:function(e){return s(e.target.value)}}),(0,c.tZ)(L.zx,{text:"Create",disabled:!(u>0&&d>0),onClick:function(){t({width:Math.ceil(u),height:Math.ceil(d)})}})]})}var fF=s.Dy.Object({type:s.Dy.Literal("pedit"),data:s.Dy.Object({path:s.Dy.String()})}),fW={Content:function(e){var t=e.pane,n=e.options.performPaneOperation;return(0,c.tZ)(fH,{path:t.data.path,performPaneOperation:n})},Icon:function(e){var t=e.size;return(0,c.tZ)(fB.Z,{size:t})},getTitle:function(e){return(0,x.UO)(e.data.path)},decode:function(e){return u.B4.Decode(fF,e)}};function fH(e){var t=e.path,n=e.performPaneOperation,r=(0,b.Mp)({path:t,performPaneOperation:n});return(0,Z.L5)(function(){if(r)return{commands:r}},[r]),(0,c.BX)(c.HY,{children:[(0,c.tZ)(b.HK,{path:t,performPaneOperation:n}),(0,c.tZ)(b.VY,{children:(0,c.tZ)(fM,{activeFile:t})})]})}var fV=n(79098),fz=n(67711),fj=n(34581),fq=(0,p.X)({badge:[g.l0.backgroundColor.backgroundHighest,g.l0.borderRadius(4),{padding:"0 0.35em"}],container:[g.l0.p(8),g.l0.colWithGap(8)],header:[g.l0.py(4),g.l0.justify.spaceBetween,g.l0.flex.grow(1),g.l0.pr(16),g.l0.height(24)],result:[g.l0.borderRadius(4),g.l0.overflow("hidden")],problems:[g.l0.px(6),g.l0.py(6)],item:[t9.gU.listItem,g.l0.reset.button,g.l0.justify.spaceBetween,g.l0.px(8),g.l0.py(4),g.l0.overflow("hidden"),g.l0.cursor.pointer,g.l0.borderRadius(4),{"&:focus-visible":[g.l0.focusRing],"&:hover, &:focus-visible":[g.l0.backgroundColor.backgroundHighest]}],itemMain:[g.l0.flex.growAndShrink(1)],itemSecondary:[g.l0.color.foregroundDimmest],flex:[g.l0.rowWithGap(8),g.l0.align.center],message:[g.l0.flex.shrink(1),g.l0.overflowX("hidden"),{textOverflow:"ellipsis",whiteSpace:"nowrap"}]});function fY(e){var t=e.isActive,n=e.performPaneOperation,r=(0,a._)((0,w.useState)({}),2),i=r[0],o=r[1],l=(0,fj.nC)(),s=(0,Z.dr)(),u=(0,w.useCallback)(function(){var e=!0,t=!1,n=void 0;try{for(var r,i=l()[Symbol.iterator]();!(e=(r=i.next()).done);e=!0)!function(){var e,t=r.value;if("codeEditor"===t[1].type){var n=s(t[0]);if(n&&"codeEditor"===n.type){var i=t[1].data.path,a=null===(e=n.fetchProblems)||void 0===e?void 0:e.call(n);i&&a&&o(function(e){return(0,P._)((0,A._)({},e),(0,eD._)({},i,a))})}}}()}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}},[s,l]);return(0,w.useEffect)(function(){t&&u()},[t,u]),(0,Z.L5)(function(){return{type:"problems",updateProblems:function(e,t){o(function(n){return(0,P._)((0,A._)({},n),(0,eD._)({},e,t))})}}},[o]),(0,c.BX)(R.G,{css:fq.container,children:[Object.values(i).some(function(e){return e.length>0})?null:(0,c.tZ)(h.xv,{children:"No problems detected in this workspace"}),Object.keys(i).map(function(e){return 0===i[e].length?null:(0,c.tZ)(M.Tg,{elevated:!0,css:fq.result,children:(0,c.tZ)(el.Q,{chevron:"end",defaultExpanded:!0,headerContent:(0,c.BX)(R.G,{css:[fq.flex,fq.header],children:[(0,c.BX)(R.G,{css:fq.flex,children:[(0,c.tZ)(f.Z,{path:e}),(0,c.tZ)(h.xv,{children:e})]}),(0,c.tZ)(R.G,{css:fq.badge,children:i[e].length>99?"99+":i[e].length})]}),children:(0,c.tZ)(R.G,{css:fq.problems,children:i[e].map(function(t,r){var i=t.range.start.line+1,o=t.range.start.character;return(0,c.tZ)(fz.Z,{problem:t,onClick:function(){n({operation:"open",pane:{type:"codeEditor",data:{path:e,line:i,col:o}},secondary:!0})}},"".concat(i,"-").concat(o,"-").concat(r))})})},e)},e)})]})}var f$=s.Dy.Object({type:s.Dy.Literal("problems")}),fJ={Content:function(e){var t=e.options,n=t.isActive,r=t.performPaneOperation;return(0,c.tZ)(fY,{isActive:n,performPaneOperation:r})},Icon:function(){return(0,c.tZ)(fV.Z,{})},getTitle:function(){return"Problems"},decode:function(e){return u.B4.Decode(f$,e)}},fK=n(11052),fQ=n(41140),f0=n(95571),f1=n(71984),f2=n(82723),f8=(0,eu.iv)([g.l0.focusRing,g.l0.display.flex,g.l0.center,g.l0.borderRadius(4),g.l0.backgroundColor.backgroundRoot,g.l0.color.foregroundDefault,g.l0.cursor.pointer,g.l0.p(4),(vT={transition:"background-color 0.2s",border:"none"},(0,eD._)(vT,g.wl.hover,[g.l0.backgroundColor.backgroundHigher]),(0,eD._)(vT,":focus",{outline:"none"}),vT)]),f4=function(e){var t=e.onClick;return(0,c.tZ)(tn.u,{tooltip:"Search",placement:"bottom-start",children:(0,c.tZ)("button",{"aria-label":"Search",onClick:t,css:f8,children:(0,c.tZ)(f2.Z,{size:16})})})},f3=n(14675),f5=n(25632),f6=n(37463),f9=n(40282),f7=n(31384),he=n(19562),ht=n(71749),hn=n(92032),hr=n(83898),hi=n(14917),ho=n(49275),ha={CURSOR_SAVE:"\x1b[s",CURSOR_RESTORE:"\x1b[u",ERASE_TO_END_OF_SCREEN:"\x1b[0J",COLOR_RESET:"\x1b[0m",COLOR_BRIGHT_BLACK:"\x1b[0;90m"},hl=(0,eu.iv)([g.l0.position.absolute,g.l0.left(8),g.l0.right(0),g.l0.zIndex(5)]);function hc(e){var t=e.lineNumber,n=e.paneHeight,r=e.shell,i=e.sendToShellChannel,o=e.onClose,l=(0,w.useMemo)(function(){return null==r?void 0:r._term},[r]),s=(0,w.useMemo)(function(){var e,t=null==l?void 0:l._core;return null!==(e=null==t?void 0:t._renderService.dimensions.css.cell)&&void 0!==e?e:{width:0,height:0}},[l]),u="SYNTHETIC_SHELL_FILE_PATH",f=(0,hi.eD)(),h=(0,hr.ql)(),p=(0,hi.oQ)(u),m=(0,hn.n)(p),v=(0,ho.tz)(),g=(0,ho.WS)(p),y=(0,w.useRef)(""),b=(0,w.useRef)(!1),Z=(0,w.useRef)(null),x=(0,a._)((0,w.useState)(64),2),C=x[0],_=x[1],S=(0,w.useCallback)(function(e){return _(e.height)},[_]);(0,w.useEffect)(function(){return function(){b.current=!1,Z.current=null,f(u)}},[f]),(0,w.useEffect)(function(){if(null===m){y.current="";return}y.current!==m&&(b.current&&(r.write(ha.CURSOR_RESTORE),r.write(ha.ERASE_TO_END_OF_SCREEN)),r.write(ha.CURSOR_SAVE),r.write(ha.COLOR_BRIGHT_BLACK),r.write(m.replaceAll("\n","\r\n")),r.write(ha.COLOR_RESET),b.current=!0,y.current=m)},[m,r]);var E=(0,w.useCallback)(function(){g&&p&&v({messageId:p.id})},[v,p,g]),k=(0,w.useCallback)(function(){(0,nv.j)(nv.U3.AI_SHELL_INLINE_CLOSED),E(),b.current&&(r.write(ha.CURSOR_RESTORE),r.write(ha.ERASE_TO_END_OF_SCREEN),r.write(ha.COLOR_RESET)),o()},[r,E,o]);(0,w.useEffect)(function(){return r.onData(function(){E(),o()}).dispose},[r,E,o]);var T=(0,w.useCallback)(function(){if(!b.current||!m){k();return}r.write(ha.CURSOR_RESTORE),r.write(ha.ERASE_TO_END_OF_SCREEN),r.write(ha.COLOR_RESET),i(m),(0,nv.j)(nv.U3.AI_SHELL_INLINE_ACCEPTED),o()},[r,m,o,k,i]),D=!!((null==p?void 0:p.loading)||(null==p?void 0:p.streaming)),I=(0,ht.U1)({loading:D,onSubmit:function(){N?T():U()},onClose:k}),G=I.value,B=I.setValue,A=I.onKeyDown,P=!!((null==p?void 0:p.stopReason)||(null==p?void 0:p.aborted)),N=P&&Z.current===G,U=(0,w.useCallback)(function(){Z.current=G,h({chatMessage:{type:"generateCode",text:G+" ; return command in a single line to be executed in a shell.",codeReference:{code:"",fileContent:"#!/bin/bash\n",filePath:u,fileVersion:0,language:"bash",range:{indexFrom:0,indexTo:0,lineFrom:0,lineTo:0}}}})},[h,G]),O=s.height*(t+1)+8,M="top";return O+C>n&&(M="bottom",O=n-s.height*(t+1)+4),(0,c.tZ)(R.G,{css:hl,style:{top:"top"===M?O:void 0,bottom:"bottom"===M?O:void 0},children:(0,c.BX)(ht.If,{requestMeasure:S,type:"generateCode",isCodeMirrorPocket:!1,children:[(0,c.tZ)(ht.II,{value:G,onChange:function(e){return B(e.currentTarget.value)},placeholder:"Enter a prompt to generate a shell command",onKeyDown:A,autoFocus:!0}),(0,c.BX)(ht.$_,{children:[(0,c.BX)(c.HY,{children:[(0,c.tZ)(ht.Xs,{type:"generateCode"}),P?(0,c.tZ)(d.hU,{alt:"Rerun the same prompt",onClick:function(){return U()},size:12,colorway:"grey",children:(0,c.tZ)(nJ.Z,{})}):null]}),N?(0,c.BX)(c.HY,{children:[(0,c.tZ)(L.zx,{variant:"outlined",size:"small",text:"Reject",onClick:function(){(0,nv.j)(nv.U3.AI_SHELL_INLINE_DISCARDED),k()}}),(0,c.tZ)(L.zx,{size:"small",text:"Accept",colorway:"blurple",onClick:T,dataCy:"ghostwriter-inline-accept-suggestion"})]}):(0,c.tZ)(ht.k4,{loading:D,disabled:!G,onClick:function(){D?E():U()}})]})]})})}var hs=n(62507),hu=n(10676),hd={CURSOR_SAVE:"\x1b[s",CURSOR_RESTORE:"\x1b[u",ERASE_TO_END_OF_SCREEN:"\x1b[0J",COLOR_RESET:"\x1b[0m",COLOR_BRIGHT_BLACK:"\x1b[0;90m"},hf=(0,eu.iv)([g.l0.position.absolute,g.l0.left(8),g.l0.right(0),g.l0.zIndex(5)]);function hh(e){var t=e.lineNumber,n=e.paneHeight,r=e.shell,i=e.sendToShellChannel,o=e.onClose,l=(0,w.useMemo)(function(){return null==r?void 0:r._term},[r]),s=(0,w.useMemo)(function(){var e,t=null==l?void 0:l._core;return null!==(e=null==t?void 0:t._renderService.dimensions.css.cell)&&void 0!==e?e:{width:0,height:0}},[l]),u=(0,w.useRef)(""),f=(0,w.useRef)(!1),h=(0,w.useRef)(null),p=(0,a._)((0,w.useState)(64),2),m=p[0],v=p[1],g=(0,w.useCallback)(function(e){return v(e.height)},[v]),y=(0,hs.XW)({onCode:function(e){if(null===e){u.current="";return}u.current!==e&&(f.current&&(r.write(hd.CURSOR_RESTORE),r.write(hd.ERASE_TO_END_OF_SCREEN)),r.write(hd.CURSOR_SAVE),r.write(hd.COLOR_BRIGHT_BLACK),r.write(e.replaceAll("\n","\r\n")),r.write(hd.COLOR_RESET),f.current=!0,u.current=e)}}),b=y.sendMessage,Z=y.stopMessage,x=y.getCode,C=y.loading,_=y.completed,S=(0,w.useCallback)(function(){(0,nv.j)(nv.U3.AI_SHELL_INLINE_CLOSED),Z(),f.current&&(r.write(hd.CURSOR_RESTORE),r.write(hd.ERASE_TO_END_OF_SCREEN),r.write(hd.COLOR_RESET)),o()},[r,Z,o]);(0,w.useEffect)(function(){return r.onData(function(){Z(),o()}).dispose},[r,Z,o]);var E=(0,w.useCallback)(function(){var e,t=null===(e=x())||void 0===e?void 0:e.code;if(!f.current||!t){S();return}r.write(hd.CURSOR_RESTORE),r.write(hd.ERASE_TO_END_OF_SCREEN),r.write(hd.COLOR_RESET),i(t),(0,nv.j)(nv.U3.AI_SHELL_INLINE_ACCEPTED),o()},[r,x,o,S,i]),k=(0,ht.U1)({loading:C,onSubmit:function(){G?E():B()},onClose:S}),T=k.value,D=k.setValue,I=k.onKeyDown,G=_&&h.current===T,B=(0,w.useCallback)(function(){h.current=T,b({message:T+" ; return command in a single line to be executed in a shell.",type:hu.G_.GENERATE_CODE,codeReference:{code:"#!/bin/bash\n",fileContent:"",filePath:"SYNTHETIC_SHELL_FILE_PATH",fileVersion:0,referenceType:hu.MD.INLINE,language:"bash",range:{indexFrom:0,indexTo:0,lineFrom:0,lineTo:0}}})},[b,T]),A=s.height*(t+1)+8,P="top";return A+m>n&&(P="bottom",A=n-s.height*(t+1)+4),(0,c.tZ)(R.G,{css:hf,style:{top:"top"===P?A:void 0,bottom:"bottom"===P?A:void 0},children:(0,c.BX)(ht.If,{requestMeasure:g,type:"generateCode",isCodeMirrorPocket:!1,children:[(0,c.tZ)(ht.II,{value:T,onChange:function(e){return D(e.currentTarget.value)},placeholder:"Enter a prompt to generate a shell command",onKeyDown:I,autoFocus:!0}),(0,c.BX)(ht.$_,{children:[(0,c.BX)(c.HY,{children:[(0,c.tZ)(ht.Xs,{type:"generateCode"}),_?(0,c.tZ)(d.hU,{alt:"Rerun the same prompt",onClick:function(){return B()},size:12,colorway:"grey",children:(0,c.tZ)(nJ.Z,{})}):null]}),G?(0,c.BX)(c.HY,{children:[(0,c.tZ)(L.zx,{variant:"outlined",size:"small",text:"Reject",onClick:function(){(0,nv.j)(nv.U3.AI_SHELL_INLINE_DISCARDED),S()}}),(0,c.tZ)(L.zx,{size:"small",text:"Accept",colorway:"blurple",onClick:E,dataCy:"ghostwriter-inline-accept-suggestion"})]}):(0,c.tZ)(ht.k4,{loading:C,disabled:!T,onClick:function(){C?Z():B()}})]})]})})}var hp=n(32911);function hm(e){var t=e.portsOpenedByThisShell,n=e.performPaneOperation,r=e.onClose,i=(0,y.Z)().ports,o=(0,w.useCallback)(function(e){i.updateDotReplitPortsMapping(e,void 0)},[i]),a=(0,w.useCallback)(function(e){i.tryExposingPortAutomatically(e)},[i]);return(0,c.tZ)(hp.ms,{configurations:t.map(function(e){return e.configuration}),openWebview:function(){n({operation:"open",secondary:!0,pane:{type:"webview",data:t.length>0?{portType:"local",port:t[0].configuration.localPort}:void 0}})},openNetworkingTool:function(){n({operation:"open",secondary:!0,pane:{type:"networking"}})},onClose:function(){null==r||r()},onDontExposePort:function(){1===t.length&&o(t[0].configuration.localPort)},onDoExposePort:function(){1===t.length&&a(t[0].configuration.localPort)}})}var hv=n(56511),hg=n(29620),hy=(0,eu.iv)([g.l0.height("100%"),g.l0.overflow("hidden"),{"& .xterm":[g.l0.pl(8),g.l0.pt(8),g.l0.pb(4),g.l0.height("100%")]}]),hb=(0,p.X)({container:[g.l0.height("100%"),{"&:focus-within .controls":{opacity:1}}],xterm:hy,xtermWithBorderRadius:[hy,{"& .xterm-viewport":[g.l0.borderRadius(0,0,8,8)]}]});function hZ(e){var t,n,r=e.shell,i=e.shellMetadata,o=e.sendToShellChannel,l=e.shellRef,s=e.className,u=e.openSearchAndReplace,d=e.openAIWithMessage,f=e.performPaneOperation,h=e.isGeneratePromptVisible,p=e.currentPromptLineNumber,m=e.onOpenGeneratePrompt,v=e.onCloseGeneratePrompt,y=(0,f5.Gn)("accessibleTerminal").preferences.accessibleTerminal,b=(0,tY.P5)({controlName:"flag-ai-in-the-shell",logFlagToAnalytics:!1}),Z=(0,a._)((0,w.useState)(!1),2),x=Z[0],C=Z[1],_=(0,a._)((0,w.useState)(""),2),S=_[0],E=_[1],k=(0,f6.dF)(null!==(t=null==i?void 0:i.cgroup)&&void 0!==t?t:void 0);r&&x&&(n=(0,c.tZ)(f3.R,{searchValue:S,setSearchValue:E,findPrevious:r.findPrevious,findNext:r.findNext,exit:function(){return C(!1)}})),!r||x||b||(n=(0,c.tZ)(f4,{onClick:function(){return C(!0)}}));var T=(0,ap.T3)(),D=(0,f7.av)().onContextMenu,I=(0,he.j)({xterm:r,isOutputsTerminal:!1,openAIWithMessage:d,openShellSearch:function(e){C(!0),E(e)},openSearchAndReplace:u,openGeneratePrompt:m});(0,w.useEffect)(function(){null==r||r.fit()},[r,k]);var G=(0,a._)((0,w.useState)(0),2),B=G[0],A=G[1],P=(0,hv.l)(),N=(0,cx.Z)(function(e){A(e.height)},{type:"throttle",wait:200});return(0,c.BX)(R.G,{className:s,innerRef:N,css:hb.container,onKeyDown:function(e){"f"===e.key&&(0,f0.jh)(e)&&(C(!0),e.preventDefault())},children:[!y&&(0,c.tZ)(f9.T,{children:'Enable "Accessible Terminal" in Workspace Settings to use a screen reader with the shell.'}),(0,c.BX)(R.G,{css:[g.l0.coverContainer,g.l0.flex.column],onClick:function(){h&&(v(),null==r||r.focus())},children:[(0,c.tZ)(R.G,{css:[T?hb.xterm:hb.xtermWithBorderRadius,g.l0.flex.growAndShrink(1),b&&h?{pointerEvents:"none",filter:"opacity(0.75)"}:null],innerRef:l,onContextMenu:function(e){return D(e,{command:I})}}),(0,c.tZ)(hm,{portsOpenedByThisShell:k,performPaneOperation:f,onClose:function(){null==r||r.focus(),null==r||r.fit()}})]}),b&&r&&h&&!P?(0,c.tZ)(hc,{lineNumber:p,paneHeight:B,shell:r,sendToShellChannel:o,onClose:function(){v(),r.focus()}}):null,b&&r&&h&&P?(0,c.tZ)(hh,{lineNumber:p,paneHeight:B,shell:r,sendToShellChannel:o,onClose:function(){v(),r.focus()}}):null,r?(0,c.BX)(R.G,{className:"controls",css:[g.l0.position.absolute,g.l0.flex.row,g.l0.top(8),g.l0.right(8),g.l0.height(30),g.l0.align.center,{opacity:0,zIndex:4}],children:[n,b?null:(0,c.tZ)(f1.Z,{onClick:r.clear})]}):null,r?null:(0,c.tZ)("code",{css:[g.l0.color.foregroundDimmest,g.l0.coverContainer,g.l0.p(8),g.l0.font.code],children:"Loading..."})]})}var hw=s.Dy.Object({type:s.Dy.Literal("shell"),data:s.Dy.Optional(s.Dy.Object({initialPwd:s.Dy.Optional(s.Dy.String())}))}),hx={Content:function(e){var t,n=e.pane,r=e.options;return(0,c.tZ)(hC,{isActive:r.isActive,initialPwd:null===(t=n.data)||void 0===t?void 0:t.initialPwd,performPaneOperation:r.performPaneOperation})},Icon:function(e){var t=e.size;return(0,c.tZ)(fQ.Z,{size:t})},getTitle:function(){return"Shell"},decode:function(e){return u.B4.Decode(hw,e)}};function hC(e){var t=e.isActive,n=e.initialPwd,r=e.performPaneOperation,i=(0,y.Z)(),o=i.container,l=i.fs,s=(0,a._)((0,w.useState)(!1),2),u=s[0],d=s[1],f=(0,hr.ql)(),h=(0,a._)((0,w.useState)(void 0),2),p=h[0],m=h[1],v=(0,w.useCallback)(function(e){r({operation:"open",secondary:!0,pane:{type:(0,D.Dp)(e),data:e}})},[r]),g=(0,w.useCallback)(function(e){r({operation:"open",secondary:!0,pane:{type:"searchReplace",data:{initialQuery:e}}})},[r]),b=(0,w.useCallback)(function(e){f({chatMessage:e}),r({operation:"open",secondary:!0,pane:{type:"ghostwriterChat"}})},[r,f]),x=(0,w.useCallback)(function(e,t){r({operation:"open",secondary:!0,pane:{type:"webview",data:{portType:"local",path:e,port:t}}})},[r]),C=(0,a._)((0,w.useState)(0),2),_=C[0],S=C[1],E=(0,a._)((0,w.useState)(!1),2),k=E[0],T=E[1],R=(0,a._)((0,hg.St)({container:o,initialPwd:n,onOutput:(0,w.useCallback)(function(){d(!0)},[d]),onShellMetadata:m,openFile:v,listFiles:l.listFiles,openWebview:x,onOpenGeneratePrompt:function(){T(!0)},onUpdateCurrentPromptLineNumber:function(e){S(e)}}),3),I=R[0],G=R[1],B=R[2],A=(0,w.useMemo)(function(){return[{type:"action",label:"Clear shell",icon:(0,c.tZ)(c1.Z,{}),run:function(){return null==I?void 0:I.clear()}}]},[I]);return(0,Z.Wk)(function(){return I},[I]),(0,Z.L5)(function(){if(I&&u)return{actions:A,type:"shell",exec:function(e){B(e+"\n")}}},[I,B,u,A]),(0,ig.ow)(hg.S1,t),(0,iv.Il)(function(){return[hg.CH.id,{run:function(){T(!0)},scope:hg.S1,bubble:!1}]},[T]),(0,c.tZ)(hZ,{shell:I,shellMetadata:p,sendToShellChannel:B,shellRef:G,performPaneOperation:r,openSearchAndReplace:g,openAIWithMessage:b,currentPromptLineNumber:_,isGeneratePromptVisible:k,onOpenGeneratePrompt:function(){T(!0)},onCloseGeneratePrompt:function(){return T(!1)}})}var h_=n(33081),hS=(0,p.X)({root:[g.l0.pt(16),g.l0.p(8)],center:[g.l0.width("100%"),g.l0.maxWidth(600),g.l0.colWithGap(4),{marginLeft:"auto",marginRight:"auto","@container (min-width: 400px)":[g.l0.maxWidth(800)],"@container (min-width: 1200px)":[g.l0.maxWidth(1400)]}],title:[],content:[g.l0.pt(8),g.l0.colWithGap(16)],search:[g.l0.rowWithGap(8),g.l0.width("100%")],searchInput:[g.l0.flex.grow(1)],packages:[g.l0.colWithGap(16)]}),hE=function(){};function hk(e){var t=e.openConsole,n=(0,fE.I)(),r=(0,B.Z)(function(){return n.find(function(e){return"nix"===e.id})},[n]),i=(0,a._)((0,w.useState)(null),2),o=i[0],l=i[1],s=(0,a._)((0,w.useState)(!1),2),u=s[0],d=s[1],f=null;return f=null!==o?(0,c.tZ)(fZ,{results:o,openConsole:t}):u?(0,c.tZ)(fv,{}):(null==r?void 0:r.id)?(0,c.tZ)(ff,{openFile:hE,openConsole:t},r.id):null,(0,c.tZ)(fT,{config:r,children:(0,c.tZ)(R.G,{css:hS.root,children:(0,c.BX)(R.G,{css:hS.center,children:[(0,c.tZ)(h.h4,{css:hS.title,level:2,variant:"subheadBig",children:"System Dependencies"}),(0,c.BX)(R.G,{css:hS.content,children:[(null==r?void 0:r.packageSearch)?(0,c.tZ)(R.G,{css:hS.search,children:(0,c.tZ)(fp,{css:hS.searchInput,onResults:l,onLoading:d})}):null,(0,c.tZ)(R.G,{css:hS.packages,children:f})]})]})})})}var hT=s.Dy.Object({type:s.Dy.Literal("systemDependencies")}),hR={Content:function(e){var t=e.options;return(0,c.tZ)(hk,{openConsole:function(){t.performPaneOperation({operation:"open",pane:{type:"runnerOutput"},secondary:!0})}})},Icon:function(e){var t=e.size;return(0,c.tZ)(h_.Z,{size:t})},getTitle:function(){return"System Dependencies"},decode:function(e){return u.B4.Decode(hT,e)}},hD=n(31105),hI=s.Dy.Object({type:s.Dy.Literal("unitTests")}),hG={Content:function(e){var t=e.options,n=(0,fj.nC)(),r=(0,Z.dr)();function i(){var e=n().find(function(e){var t=(0,a._)(e,2);return"runnerOutput"===(t[0],t[1].type)});if(e)return e[0]}return(0,c.tZ)(R.G,{css:[g.l0.p(8),D.F3],children:(0,c.tZ)(hD.Z,{getRunnerOutput:function(){var e=i();if(e||t.performPaneOperation({operation:"open",secondary:!0,pane:{type:"runnerOutput"}}),e=i()){var n=r(e);if((null==n?void 0:n.type)==="runnerOutput")return n}}})})},Icon:function(e){var t=e.size;return(0,c.tZ)(rr.Z,{size:t})},getTitle:function(){return"Unit Tests"},decode:function(e){return u.B4.Decode(hI,e)}},hB=n(96239),hA=n(75834),hP=s.Dy.Object({type:s.Dy.Literal("vnc")}),hN={Content:function(){return(0,c.tZ)(hU,{})},Icon:function(e){var t=e.size;return(0,c.tZ)(hB.Z,{size:t})},getTitle:function(){return"Output"},decode:function(e){return u.B4.Decode(hP,e)}};function hU(){var e=(0,y.Z)(),t=e.fs,n=e.container;return(0,c.tZ)(R.G,{css:[g.l0.flex.growAndShrink(1)],children:(0,c.tZ)(hA.Z,{fs:t,container:n})})}var hO=n(62393),hL=n(87279),hM=n(75129),hX=n(97703),hF=n(83447),hW=n(74883),hH=n(26397),hV=n(3590),hz=n(2689),hj=n(78094),hq=n(10169),hY=(0,tQ.cn)(""),h$=(0,tQ.cn)(null);(0,tQ.cn)(null,(vp=(0,to._)(function(e,t){var n,r,i;return(0,ta.Jh)(this,function(o){return(n=e(h$))&&(r=e(hY),i=e(hq.FF),hz.kg.info("Ghostwriter Debugger error buffered",{debuggerBuffer:r,ghostwriterDebugError:n,inferredInterpreter:i})),t(hY,""),t(h$,null),[2]})}),function(e,t){return vp.apply(this,arguments)}));var hJ=function(e){var t=e.title,n=e.json,r=e.initialExpanded,i=(0,a._)((0,w.useState)(void 0===r||r),2),o=i[0],l=i[1];return(0,c.tZ)(el.Q,{expanded:o,onClick:function(){return l(function(e){return!e})},headerContent:(0,c.tZ)(R.G,{css:[g.l0.rowWithGap(8),g.l0.align.center],children:(0,c.tZ)(h.xv,{variant:"subheadDefault",multiline:!1,children:t})}),children:(0,c.tZ)(R.G,{css:[g.l0.p(12),g.l0.colWithGap(8),g.l0.height("100%")],children:(0,c.tZ)(hX.Z,{json:n})})})},hK=function(e){var t=e.title,n=e.text,r=(0,a._)((0,w.useState)(!0),2),i=r[0],o=r[1];return(0,c.tZ)(el.Q,{expanded:i,onClick:function(){return o(function(e){return!e})},headerContent:(0,c.tZ)(R.G,{css:[g.l0.rowWithGap(8),g.l0.align.center],children:(0,c.tZ)(h.xv,{variant:"subheadDefault",multiline:!1,children:t})}),children:(0,c.tZ)(R.G,{css:[g.l0.p(12),g.l0.colWithGap(8),g.l0.height("100%")],children:(0,c.tZ)(h.xv,{variant:"small",css:[g.l0.fontSize(16),{whiteSpace:"pre-wrap"}],children:n})})})},hQ=n(12621),h0=n(4498),h1=n(16643),h2=n(87659),h8=n(97631);function h4(){var e=(0,ey._)(["\n  query AdminPanelGitView {\n    currentUser {\n      id\n      gitHubInfo {\n        accessToken\n        installations {\n          id\n          type\n          avatarUrl\n          name\n        }\n        userInfo {\n          name\n          email\n          avatarUrl\n        }\n      }\n    }\n  }\n"]);return h4=function(){return e},e}var h3={},h5=(0,eb.Ps)(h4());function h6(e){var t=e.event,n=t.input,r=t.output,i=t.error,o=t.start,l=t.end,s=t.cached,u=(0,a._)((0,w.useState)(!0),2),d=u[0],f=u[1],h=(0,w.useCallback)(function(){return f(function(e){return!e})},[]),p="bash"===n[0]&&"-c"===n[1]?n.slice(2).join(" "):n.join(" "),m=r.trimEnd();return(0,c.BX)(R.G,{css:[(0,h2.ec)(i?"negative":"positive"),s?{opacity:.75}:void 0,g.l0.borderRadius(8)],children:[(0,c.BX)(R.G,{onClick:h,onKeyDown:function(e){("Enter"===e.key||" "===e.key)&&h()},tabIndex:0,css:[g.l0.rowWithGap(4),g.l0.justify.spaceBetween,g.l0.py(4),g.l0.px(8),g.l0.font.code,g.l0.cursor.pointer],children:[(0,c.BX)("span",{css:{whiteSpace:"pre-wrap",wordBreak:"break-word"},children:["$ ",p]}),(0,c.BX)("span",{css:[g.l0.color.foregroundDimmer,g.l0.flex.shrink(0)],children:[i?(0,c.tZ)("span",{css:[g.l0.mr(16)],children:i}):null,s?(0,c.tZ)("span",{children:"CACHED"}):(0,c.BX)("span",{children:[l-o," ms"]})]})]}),d?null:(0,c.tZ)(R.G,{css:[g.l0.px(2),g.l0.pb(2),g.l0.borderRadius(0,0,8,8)],children:(0,c.tZ)(M.Tg,{elevated:!0,css:[g.l0.p(8),g.l0.borderRadius(8)],children:(0,c.tZ)(h0.Z,{code:m})})})]})}var h9=n(24463),h7=n(88994),pe=n(61155);function pt(e){var t=e.t,n=e.children;return(0,c.BX)("span",{css:{display:"flex",alignItems:"flex-start",columnGap:"0.5rem"},children:[(0,c.BX)(h.xv,{css:{minWidth:"8em"},multiline:!1,children:[t,":"," "]}),(0,c.tZ)("span",{children:n})]})}var pn=n(98463),pr=n(87271),pi=w.memo(function(e){var t,n=e.log,r=e.filters,i=e.timeRef,o=e.setTimeRef,l=r.highlightOnly&&(0,pr.cF)(n,r),s=null!==(t=n.cmd.channel)&&void 0!==t?t:0,u=(0,w.useMemo)(function(){var e=(0,A._)({},n.cmd);return delete e.channel,e},[n]),d=JSON.stringify(u,null,2),f=i?n.timestamp-i:n.timestamp,p=(0,a._)((0,pe.Z)(!0),2),m=p[0],v=p[1];return(0,c.BX)(R.G,{css:[g.l0.my(4),g.l0.mx(4)],children:[(0,c.tZ)(R.G,{role:"button",onClick:v,onKeyDown:v,tabIndex:0,css:[l?g.l0.backgroundColor.accentPositiveDimmer:null,g.l0.flex.row,g.l0.rowWithGap(4),{"&:hover":{cursor:"pointer",".link":{textDecoration:"underline"}}}],children:(0,c.BX)(R.G,{css:[g.l0.flex.grow(1),g.l0.rowWithGap(4),{maxWidth:"100%"}],children:[(0,c.tZ)(h.xv,{className:"icon",multiline:!1,children:"in"===n.dir?(0,c.tZ)(R.G,{css:g.l0.color.greenStrongest,children:""}):"out"===n.dir?(0,c.tZ)(R.G,{css:g.l0.color.redStrongest,children:""}):(0,c.tZ)(R.G,{css:g.l0.color.magentaStrongest,children:""})}),(0,c.tZ)(h.xv,{className:"link",multiline:!1,children:(0,c.BX)("code",{children:["#",s," - ",n.channel.service,n.channel.name?"::".concat(n.channel.name):""]})}),(0,c.tZ)(h.xv,{css:[g.l0.flex.growAndShrink(1),{opacity:.5}],multiline:!1,children:(0,c.tZ)("code",{style:{overflow:"hidden",textOverflow:"ellipsis"},children:d})}),null!=f&&(0,c.tZ)(R.G,{onClick:function(){o(n.timestamp)},css:{opacity:.5},children:(0,c.tZ)(h.xv,{css:[g.l0.fontSize(13),{cursor:"pointer"}],multiline:!1,children:n.timestamp===i?"(reference)":(0,c.BX)(c.HY,{children:[f.toFixed(0)," ms"]})})})]})}),!m&&(0,c.tZ)(c.HY,{children:void 0!==u&&(0,c.tZ)(pn.g,{name:"cmd",src:u})})]})}),po=(0,w.memo)(function(e){var t=e.logs,n=e.filters,r=e.timeRef,i=e.setTimeRef,o=(0,w.useRef)(null),a=(0,t5.MG)({count:t.length,getScrollElement:function(){return o.current},estimateSize:function(){return 28},overscan:10});return(0,c.BX)("div",{ref:o,className:"log-list",children:[(0,c.tZ)("div",{style:{height:"".concat(a.getTotalSize(),"px"),width:"100%",position:"relative"},children:a.getVirtualItems().map(function(e){return(0,c.tZ)("div",{"data-index":e.index,ref:a.measureElement,style:{position:"absolute",top:0,left:0,width:"100%",transform:"translateY(".concat(e.start,"px)")},children:(0,c.tZ)(pi,{log:t[e.index],filters:n,timeRef:r,setTimeRef:i})},e.key)})}),(0,c.tZ)("div",{className:"bottom-anchor"})]})}),pa=function(e){var t=e.filters,n=e.updateFilters;return(0,c.BX)(R.G,{css:g.l0.colWithGap(4),children:[(0,c.tZ)(h.xv,{variant:"subheadDefault",multiline:!1,children:"Regex (regex,flags):"}),(0,c.tZ)(U.II,{id:"regex",onChange:function(e){var t=null;if(e.currentTarget.value){var r=(0,a._)(e.currentTarget.value.split(","),2),i=r[0],o=r[1];try{t=new RegExp(i,o)}catch(e){}}n({regexp:t})},placeholder:"\\w+,gi"}),(0,c.tZ)(h.xv,{variant:"subheadDefault",multiline:!1,children:"Directions:"}),(0,c.tZ)(am.E,{css:g.l0.rowWithGap(16),name:"direction",value:t.direction,onChange:function(e){var t=e.target.value;n({direction:"in"===t||"out"===t||""===t?t:""})},children:[{val:"",text:"Both"},{val:"in",text:"In"},{val:"out",text:"Out"}].map(function(e){return(0,c.BX)(R.G,{css:[g.l0.rowWithGap(8)],children:[(0,c.tZ)(am.Y,{id:e.val,value:e.val}),(0,c.tZ)("label",{htmlFor:e.val,children:e.text})]},e.val)})}),(0,c.tZ)(h.xv,{variant:"subheadDefault",multiline:!1,children:"Filter style:"}),(0,c.tZ)(am.E,{css:g.l0.rowWithGap(16),name:"filter-style",value:t.highlightOnly?"highlight":"filter",onChange:function(e){return n({highlightOnly:"highlight"===e.target.value})},children:[{val:"highlight",text:"Highlight"},{val:"filter",text:"Filter"}].map(function(e){return(0,c.BX)(R.G,{css:[g.l0.rowWithGap(8)],children:[(0,c.tZ)(am.Y,{id:e.val,value:e.val}),(0,c.tZ)("label",{htmlFor:e.val,children:e.text})]},e.val)})})]})},pl=n(76999),pc=n.n(pl),ps=n(58130),pu=n(17867),pd=n(11516),pf=n(16835),ph=n(50831),pp=n(29358),pm=n(96298);function pv(){var e=(0,ey._)(["\n  fragment AdminPanelRepl on Repl {\n    id\n    title\n    description\n    isProject\n    isPrivate\n    timeCreated\n    timeUpdated\n    slug\n    url\n    language\n    user {\n      id\n    }\n    config {\n      isServer\n      isVnc\n    }\n    isRenamed\n    isProjectFork\n    folderId\n    isOwner\n    origin {\n      id\n    }\n    source {\n      release {\n        id\n        repl {\n          id\n          url\n          templateLabel\n        }\n      }\n    }\n  }\n"]);return pv=function(){return e},e}function pg(){var e=(0,ey._)(["\n  query AdminPanelReplView($replId: String!) {\n    repl(id: $replId) {\n      ...AdminPanelRepl\n    }\n  }\n  ","\n"]);return pg=function(){return e},e}var py={},pb=(0,eb.Ps)(pv()),pZ=(0,eb.Ps)(pg(),pb),pw=n(47726);function px(e){var t=e.sessionId,n=(0,a._)((0,w.useState)(!1),2),r=n[0],i=n[1],o=(0,a._)((0,w.useState)(""),2),l=o[0],s=o[1],u=(0,a._)((0,w.useState)(!1),2),d=u[0],f=u[1],p=(0,o9.Z)().showConfirm,m=(0,aS.U)();return null==t?(0,c.tZ)(R.G,{children:(0,c.tZ)(h.xv,{multiline:!1,children:"Something went wrong... no RUM session found... Try refreshing the page"})}):(0,c.BX)(R.G,{css:[g.l0.colWithGap(8)],children:[(0,c.BX)(h.xv,{variant:"small",multiline:!1,children:["RUM Session ID: ",t]}),(0,c.tZ)(h.xv,{variant:"headerDefault",multiline:!1,children:"Submit an Issue"}),(0,c.BX)(R.G,{css:[g.l0.colWithGap(16)],children:[(0,c.tZ)(U.B,{id:m("message"),placeholder:"What can we do better?",value:l,onChange:function(e){return s(e.target.value)},disabled:r}),(0,c.BX)(R.G,{css:[g.l0.rowWithGap(8)],children:[(0,c.tZ)(oB.X,{id:m("issueInRecording"),checked:d,onChange:function(e){return f(e.target.checked)}}),(0,c.tZ)("label",{htmlFor:m("issueInRecording"),children:(0,c.tZ)(h.xv,{multiline:!1,children:"Issue is demoed in recording"})})]}),(0,c.tZ)(L.zx,{onClick:function(){var e=u1()();i(!0),(0,hz.fc)({name:"replitOnReplit:issue",context:{message:l,issueInRecording:d,customEventId:e}}),p("Issue submitted! Have a cookie \uD83C\uDF6A",5e3),setTimeout(function(){i(!1),s(""),f(!1)},5e3)},text:"Submit",disabled:r||0===l.trim().length,colorway:"primary"})]})]})}(vm=vR||(vR={})).Repl="repl",vm.Logs="logs",vm.LSP="lsp",vm.AI="ai",vm.GhostwriterChat="aiChat",vm.AST="ast",vm.Git="git",vm.History2="history2",vm.Metadata="metadata",vm.Override="override",vm.DDRum="rum";var pC=(vD={},(0,eD._)(vD,"repl",function(){var e,t,n,r,i,o,a,l,s,u=(0,eg.Z)(),d=(e=(0,A._)({},py,{variables:{replId:u}}),eZ.a(pZ,e)).data,f=(null==d?void 0:d.repl.__typename)==="Repl"?JSON.parse(JSON.stringify(d.repl)):void 0;return f&&(delete f.__typename,null===(t=f.user)||void 0===t||delete t.__typename,null===(n=f.origin)||void 0===n||delete n.__typename,delete f.config.__typename,null===(r=f.source)||void 0===r||delete r.__typename,null===(o=f.source)||void 0===o||null===(i=o.release)||void 0===i||delete i.__typename,null===(s=f.source)||void 0===s||null===(l=s.release)||void 0===l||null===(a=l.repl)||void 0===a||delete a.__typename),(0,c.BX)(R.G,{css:[g.l0.colWithGap(16),g.l0.p(4)],children:[(0,c.tZ)(pm.Z,{replId:u}),(0,c.tZ)("div",{className:"jsx-3187c500f6b377b0",children:f?(0,c.tZ)(hX.Z,{json:f}):null}),(0,c.tZ)(pc(),{id:"3187c500f6b377b0",children:"pre.jsx-3187c500f6b377b0{white-space:pre-wrap;word-wrap:break-word}"})]})}),(0,eD._)(vD,"logs",function(e){var t=e.isHidden,n=(0,a._)((0,pe.Z)(!1),2),r=n[0],i=n[1],o=(0,a._)((0,w.useState)(null),2),l=o[0],s=o[1],u=(0,tK.Dv)(pr.Sj),f=(0,a._)((0,tK.KO)(pr.a0),2),h=f[0],p=f[1],v=(0,a._)((0,tK.KO)(pr.ot),2),y=v[0],b=v[1],Z=(0,tK.b9)(pr.UB);return t?null:(0,c.BX)(R.G,{css:[g.l0.colWithGap(8)],children:[(0,c.BX)(R.G,{css:[g.l0.colWithGap(8),g.l0.position.sticky,g.l0.top(0),g.l0.px(4),g.l0.pb(8),{"z-index":3},g.l0.backgroundColor.backgroundDefault],children:[(0,c.tZ)(L.zx,{colorway:h?void 0:"positive",onClick:function(){p(function(e){return!e})},text:h?"Stop logging goval":"Start logging goval"}),(0,c.BX)(R.G,{css:[g.l0.rowWithGap(4),g.l0.justify.spaceBetween],children:[(0,c.tZ)(L.zx,{onClick:i,text:r?"Hide filters":"Show filters"}),l?(0,c.tZ)(L.zx,{onClick:function(){return s(null)},text:"Reset Time Ref"}):null,(0,c.tZ)(d.hU,{alt:"Download as JSON",onClick:function(){var e="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(u)),t=document.createElement("a");t.setAttribute("href",e);var n=new Date().toISOString();t.setAttribute("download","logs-".concat(n.slice(0,n.indexOf(".")).replaceAll("-","").replaceAll(":",""),".json")),t.click()},size:32,children:(0,c.tZ)(m.Z,{})}),(0,c.tZ)(L.zx,{colorway:"negative",onClick:function(){return Z()},text:"Clear logs"})]}),r?(0,c.tZ)(pa,{filters:y,updateFilters:function(e){b((0,A._)({},y,e))}}):null]}),(0,c.tZ)(po,{logs:u,filters:y,timeRef:l,setTimeRef:s})]})}),(0,eD._)(vD,"lsp",pn.L),(0,eD._)(vD,"ai",hQ.ho),(0,eD._)(vD,"aiChat",function(){var e=(0,hM.v)(),t=(0,eg.Z)(),n=(0,hV.ub)(),r=(0,I.R3)(),i=(0,hr.Og)(),o=(0,hr.Cd)(),l=(0,a._)((0,hj.wM)(hY),1)[0],s=(0,a._)((0,hj.wM)(h$),1)[0],u="chat-".concat(n,".json"),d=(0,a._)((0,w.useState)(".ghostwriter/".concat(u)),2),f=d[0],p=d[1],v=(0,y.Z)().fs,b=(0,o9.Z)().showError,Z=(0,a._)((0,hr.zu)(),2),x=Z[0],C=Z[1],_=(0,w.useCallback)(function(){return JSON.stringify({chatModel:e,chatSessionId:n,replId:t,messages:x},null,2)},[e,n,t,x]),S=(0,w.useCallback)((0,to._)(function(){var e,t;return(0,ta.Jh)(this,function(n){switch(n.label){case 0:e=_(),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,v.writeFile(f,tT.Z.from(e))];case 2:if((t=n.sent()).error)throw Error("fs error: ".concat(t.error));return[3,4];case 3:return b(n.sent().message),[3,4];case 4:return[2]}})}),[_,v,f,b]),E=(0,w.useCallback)((0,to._)(function(){var e,t;return(0,ta.Jh)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,v.readFile(f)];case 1:if((e=n.sent()).error)throw Error("fs error: ".concat(e.error));if(!Array.isArray((t=JSON.parse(e.content.toString())).messages))throw Error("invalid chat JSON");return C(t.messages),[3,3];case 2:return b(n.sent().message),[3,3];case 3:return[2]}})}),[f,v,C,b]);return(0,c.tZ)(R.G,{css:g.l0.height("100%"),children:(0,c.BX)(hF.mQ,{css:[{width:"100%"}],children:[(0,c.BX)(hF.td,{withDividers:!1,children:[(0,c.tZ)(hF.OK,{iconLeft:(0,c.tZ)(hH.Z,{}),children:"File Context"}),(0,c.tZ)(hF.OK,{iconLeft:(0,c.tZ)(hH.Z,{}),children:"Debugger"}),(0,c.tZ)(hF.OK,{iconLeft:(0,c.tZ)(hW.Z,{}),children:"Messages"})]}),(0,c.BX)(hF.nP,{children:[(0,c.BX)(hF.x4,{children:[(0,c.tZ)(hJ,{title:"active file",json:r}),(0,c.tZ)(hJ,{title:"last stop reason",json:o}),(0,c.tZ)(hK,{title:"last prompt",text:i?JSON.stringify(JSON.parse(i),void 0,2):""})]}),(0,c.BX)(hF.x4,{children:[(0,c.tZ)(hJ,{title:"buffered output",json:l}),(0,c.tZ)(hJ,{title:"debug error context",json:s})]}),(0,c.tZ)(hF.x4,{children:(0,c.BX)(R.G,{css:[g.l0.colWithGap(8),g.l0.m(8)],children:[(0,c.BX)(M.Tg,{background:"higher",css:[g.l0.borderRadius(8),g.l0.colWithGap(8),g.l0.p(8)],children:[(0,c.tZ)(h.xv,{multiline:!1,children:"Chat History"}),(0,c.tZ)(U.II,{type:"text",value:f,onChange:function(e){p(e.target.value)}}),(0,c.BX)(R.G,{css:[g.l0.rowWithGap(8),g.l0.flex.wrap],children:[(0,c.tZ)(L.zx,{text:"Download",colorway:"primary",iconLeft:(0,c.tZ)(m.Z,{}),onClick:function(){var e="data:text/json;charset=utf-8,"+encodeURIComponent(_()),t=document.createElement("a");t.setAttribute("href",e),t.setAttribute("download","".concat(u)),t.click()}}),(0,c.tZ)(L.zx,{text:"Save to Repl",onClick:S,iconLeft:(0,c.tZ)(m.Z,{})}),(0,c.tZ)(L.zx,{text:"Load from Repl",onClick:E,iconLeft:(0,c.tZ)(rB.Z,{})})]})]}),(0,c.BX)(R.G,{css:[g.l0.colWithGap(8)],children:[(0,c.tZ)("label",{css:g.l0.color.foregroundDimmer,htmlFor:"gw-debug-chatModel",children:"Chat Model"}),(0,c.tZ)(U.II,{id:"gw-debug-chatModel",type:"text",readOnly:!0,value:e})]}),(0,c.BX)(R.G,{css:[g.l0.colWithGap(8)],children:[(0,c.tZ)("label",{css:g.l0.color.foregroundDimmer,htmlFor:"gw-debug-replId",children:"Repl Id"}),(0,c.tZ)(U.II,{id:"gw-debug-replId",type:"text",readOnly:!0,value:t})]}),(0,c.BX)(R.G,{css:[g.l0.colWithGap(8)],children:[(0,c.tZ)("label",{css:g.l0.color.foregroundDimmer,htmlFor:"gw-debug-sessionId",children:"Session Id"}),(0,c.tZ)(U.II,{id:"gw-debug-sessionId",type:"text",readOnly:!0,value:n})]})]})})]})]})})}),(0,eD._)(vD,"ast",cs.Z),(0,eD._)(vD,"git",function(){var e,t=(0,a._)((0,w.useState)([]),2),n=t[0],r=t[1],i=(e=(0,A._)({},h3,void 0),eZ.a(h5,e)).data,o=(0,h1.Z)(h8.e);return(0,w.useEffect)(function(){o&&r(function(e){return e.length&&e[0].key===o.key?e:[o].concat((0,l._)(e)).slice(0,100)})},[o]),(0,c.BX)(R.G,{css:[g.l0.p(8)],children:[(0,c.BX)(M.Tg,{elevated:!0,css:[g.l0.borderRadius(8),g.l0.p(8),g.l0.mb(8)],children:[(0,c.tZ)("span",{children:"Git Service Connection Info"}),(0,c.tZ)("pre",{children:(null==i?void 0:i.currentUser)?JSON.stringify(i,function(e,t){return"accessToken"===e?"censored":t},2):"No gitHubInfo"})]}),(0,c.tZ)(R.G,{css:[g.l0.colWithGap(4)],children:n.length?n.map(function(e){return(0,c.tZ)(h6,{event:e},e.key)}):"No events yet..."})]})}),(0,eD._)(vD,"history2",function(){var e=(0,aS.U)()("toggleIsShowingChanges"),t=(0,h1.Z)(le.BI)(),n=(0,h1.Z)(le.Jp)(),r=(0,a._)((0,pe.Z)(!1),2),i=r[0],o=r[1];if(!t)return null;var l=t.filePath,s=t.changes,u=t.users,d=t.version,f=t.playing,h=t.count,p=s[d];if(!p)return(0,c.BX)(R.G,{children:[(0,c.BX)("div",{children:["Change at ",d," not found. Here's the state"]}),(0,c.tZ)("pre",{children:JSON.stringify(t,null,2)})]});var m=null==u?void 0:u[p.userId],v=p.timestamp,y=i&&n?function(e,t){try{return(0,h7.ed)(e,t).op}catch(e){return e}}(p.changes,n.state.doc.sliceString(0)):null;return(0,c.BX)(R.G,{css:[g.l0.colWithGap(16),g.l0.p(4)],children:[(0,c.BX)(R.G,{css:[g.l0.colWithGap(4)],children:[(0,c.tZ)(pt,{t:"File",children:(0,c.tZ)("pre",{children:l})}),(0,c.BX)(pt,{t:"Version",children:[d," / ",h-1]}),(0,c.tZ)(pt,{t:"Playing",children:(0,c.tZ)(h9.Z,{children:f?"true":"false"})}),(0,c.tZ)(pt,{t:"Date",children:(0,c.tZ)(nt.EK,{date:v})})]}),m?(0,c.BX)(R.G,{children:[(0,c.tZ)(pt,{t:"Author",children:m.username}),(0,c.BX)(R.G,{css:[g.l0.pl(8),g.l0.colWithGap(4)],children:[(0,c.tZ)(pt,{t:"ID",children:m.id}),(0,c.tZ)(pt,{t:"Name",children:m.username}),(0,c.tZ)(pt,{t:"Image",children:(0,c.tZ)("a",{href:m.image,children:m.image})})]})]}):null,(0,c.BX)(R.G,{css:[g.l0.rowWithGap(8),{alignItems:"center"}],children:[(0,c.tZ)(a7.Z,{id:e,isOn:i,onChange:o}),(0,c.tZ)("label",{htmlFor:e,children:"Changes"})]}),p?null:"No changes",i&&p?(0,c.tZ)(c.HY,{children:(0,c.BX)(R.G,{children:[(0,c.tZ)(pt,{t:"Changeset",children:(0,c.tZ)("pre",{children:JSON.stringify(p,null,2)})}),n?(0,c.tZ)(c.HY,{children:(0,c.BX)(R.G,{css:[g.l0.mt(4)],children:[(0,c.tZ)(pt,{t:"OT",children:(0,c.tZ)("pre",{children:JSON.stringify(y,null,2)})}),(0,c.tZ)("p",{children:(0,c.BX)("small",{children:["Note that the OT value is translated ",(0,c.tZ)("em",{children:"back"})," to an operational transformation from the CodeMirror changeset."]})})]})}):null]})}):null]})}),(0,eD._)(vD,"metadata",function(){var e=(0,y.Z)().container;(0,pu.Z)(e);var t=e.getConnectionMetadata();if(!t)return(0,c.tZ)("div",{children:"no token yet, wait for connection"});var n=t.token,r=new URL(t.conmanURL).host,i='./conman-repl -t "'.concat(n,'" -u ').concat(r);return(0,c.BX)("div",{className:"jsx-2e9ac5ab034fc317 token-viewer",children:[(0,c.BX)(R.G,{css:g.l0.rowWithGap(2),children:[(0,c.BX)(h.xv,{css:g.l0.flex.shrink(1),multiline:!1,children:["conman Repl command: ",(0,c.tZ)(h9.Z,{children:i})]}),(0,c.tZ)(d.hU,{alt:"Copy to clipboard",onClick:function(){return(0,O.Z)(i)},children:(0,c.tZ)(cX.Z,{})})]}),(0,c.BX)("div",{className:"jsx-2e9ac5ab034fc317",children:["metadata:",(0,c.tZ)("pre",{className:"jsx-2e9ac5ab034fc317",children:JSON.stringify(t,null,2)})]}),(0,c.tZ)("br",{className:"jsx-2e9ac5ab034fc317"}),(0,c.tZ)("br",{className:"jsx-2e9ac5ab034fc317"}),(0,c.BX)("div",{className:"jsx-2e9ac5ab034fc317",children:["parsed token:",(0,c.tZ)("pre",{className:"jsx-2e9ac5ab034fc317",children:JSON.stringify((0,ps.he)(t.token),null,2)})]}),(0,c.tZ)("br",{className:"jsx-2e9ac5ab034fc317"}),(0,c.tZ)("br",{className:"jsx-2e9ac5ab034fc317"}),(0,c.tZ)(pc(),{id:"2e9ac5ab034fc317",children:".token-viewer.jsx-2e9ac5ab034fc317{height:100%;overflow:auto;padding:10px}pre.jsx-2e9ac5ab034fc317{white-space:pre-wrap;word-wrap:break-word}"})]})}),(0,eD._)(vD,"override",function(){var e,t,n=(0,a._)((0,w.useState)(pd.Z.get("gurl","string")||""),2),r=n[0],i=n[1],o=(0,a._)((0,w.useState)(pd.Z.get("pid2Version","string")||""),2),l=o[0],s=o[1],u=(0,a._)((0,w.useState)(""),2),d=u[0],f=u[1],p=dd(),m=""===r?"null":JSON.stringify((0,pf.t)(r),null,2);return(0,c.BX)(R.G,{css:[g.l0.pt(16),g.l0.px(12),g.l0.colWithGap(12)],children:[(0,c.BX)(R.G,{css:[g.l0.colWithGap(12)],children:[(0,c.tZ)(pp.ZP,{label:"Custom pid2 version",placeholder:"pid2 hash (e.g. 76ce274246bb7a07f908076d3a74a0171c3267fb)",value:l,onChange:function(e){return s(e.currentTarget.value)}}),(0,c.BX)("p",{children:[(0,c.tZ)("code",{children:"pid2"})," version:"," ",(0,c.tZ)("code",{children:null!==(t=null!==(e=pd.Z.get("pid2Version","string"))&&void 0!==e?e:"063b5ad061e5ba00d5316dae27b1e02a12f6bc79")&&void 0!==t?t:"dev"})]}),(0,c.BX)(R.G,{css:[g.l0.rowWithGap(12)],children:[(0,c.tZ)(ph.Z,{color:"yellow",onClick:function(){pd.Z.set("pid2Version",l),window.location.reload()},children:"Set pid2Version and reload"}),(0,c.tZ)(ph.Z,{color:"orange",onClick:function(){pd.Z.remove("pid2Version"),window.location.reload()},children:"Unset pid2Version and reload"})]})]}),(0,c.tZ)("hr",{css:[g.l0.my(16),{borderColor:g.TV.outlineDefault}]}),(0,c.BX)(R.G,{css:[g.l0.colWithGap(12)],children:[(0,c.tZ)(pp.ZP,{label:"Custom gurl",placeholder:"ws://localhost:".concat(4560),value:r,onChange:function(e){return i(e.currentTarget.value)}}),(0,c.BX)("pre",{children:["metadata override preview:",m]}),(0,c.BX)(R.G,{css:[g.l0.rowWithGap(12)],children:[(0,c.tZ)(ph.Z,{color:"positive",onClick:function(){pd.Z.set("gurl",r),window.location.reload()},children:"Set gurl and reload"}),(0,c.tZ)(ph.Z,{color:"yellow",onClick:function(){pd.Z.set("gurl","wss://eval.canary.replit.com"),window.location.reload()},children:"Switch to canary & reload"}),(0,c.tZ)(ph.Z,{color:"orange",onClick:function(){pd.Z.remove("gurl"),window.location.reload()},children:"Unset gurl and reload"}),(0,c.tZ)(ph.Z,{color:"red",onClick:function(){pd.Z.set("gurl","ws://localhost:4560"),window.location.reload()},children:"Switch to localhost & reload"})]}),(0,c.tZ)("div",{children:pd.Z.get("gurl","string")?"currently in localStorage: ".concat(pd.Z.get("gurl","string")):'No gurl set in local storage, using default gurl for this user, check "Token" tab for details'}),(0,c.tZ)("p",{children:"Gurl order of precedence:"}),(0,c.BX)("ol",{style:{margin:12},children:[(0,c.tZ)("li",{children:"gurl in localStorage (set above)"}),(0,c.BX)("li",{children:["If in development webapp and a theres a response from",(0,c.tZ)("code",{children:"https://localhost:4563"})," or",(0,c.BX)("code",{children:["http://localhost:",4560]}),", then it will use that."]}),(0,c.BX)("li",{children:["default is ",(0,c.tZ)("code",{children:"wss://eval.<usercluster>.replit.com"})]})]})]}),(0,c.tZ)("hr",{css:[g.l0.my(16),{borderColor:g.TV.outlineDefault}]}),(0,c.BX)(R.G,{css:[g.l0.colWithGap(12)],children:[(0,c.tZ)(h.xv,{multiline:!1,children:"Override Database"}),(0,c.tZ)(pp.ZP,{type:"text",value:d,onChange:function(e){f(e.target.value)}}),(0,c.tZ)(R.G,{css:[g.l0.rowWithGap(8)],children:(0,c.tZ)(ph.Z,{color:"positive",onClick:function(){p(d)},children:"Override Postgres connection string"})})]})]})}),(0,eD._)(vD,"rum",function(){var e,t=null===(e=pw.v.getInternalContext())||void 0===e?void 0:e.session_id,n=pw.v.getInitConfiguration(),r=null!=n&&100===n.sampleRate,i=(0,a._)((0,w.useState)(null!=t),2),o=i[0],l=i[1];return(0,c.tZ)(R.G,{css:[g.l0.colWithGap(16),g.l0.p(4)],children:r?(0,c.BX)(c.HY,{children:[(0,c.tZ)(L.zx,{onClick:o?function(){pw.v.stopSessionReplayRecording(),document.cookie="_dd_s=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;",window.location.href=window.location.href.split("?")[0]}:function(){(0,hz.Oo)({name:"replitOnReplit"}),setTimeout(function(){l(!0)},1e3)},text:o?"\uD83D\uDD34 Recording... Click to stop and reload page":"Start Recording",colorway:o?void 0:"primary",css:(0,A._)({},o&&ef.p.backgroundPulse(g.TV.redDimmest,g.TV.redDimmer))}),o?(0,c.tZ)(px,{sessionId:t}):null]}):(0,c.tZ)(L.zx,{onClick:function(){window.location.href=window.location.href.split("?")[0].split("#")[0]+"?rum=1"},text:"Click to reload and start recording",colorway:"primary"})})}),vD),p_=Object.values(vR);function pS(e){var t=e.paneOptions,n=(0,a._)((0,w.useState)("repl"),2),r=n[0],i=n[1],o=p_.map(function(e){return(0,c.tZ)(L.zx,{colorway:e===r?"primary":void 0,onClick:function(){return i(e)},text:e},e)});return(0,c.BX)(M.Tg,{background:"default",css:[g.l0.colWithGap(8),g.l0.p(4),g.l0.height("100%")],children:[(0,c.tZ)(R.G,{css:{flexWrap:"wrap",flexDirection:"row",gap:"4px"},children:o}),(0,c.tZ)(R.G,{css:[g.l0.flex.growAndShrink(1),g.l0.overflow("auto")],children:Object.entries(pC).map(function(e){var n=(0,a._)(e,2),i=n[0],o=n[1];return(0,c.tZ)(R.G,{css:i!==r&&g.l0.display.none,children:"override"===i&&"override"!==r?null:(0,c.tZ)(o,{isHidden:t.isHidden||r!==i})},i)})})]})}var pE=s.Dy.Object({type:s.Dy.Literal("adminPanel")}),pk={Content:function(e){var t=e.options;return(0,c.tZ)(pS,{paneOptions:t})},Icon:function(e){var t=e.size;return(0,c.tZ)(hL.Z,{color:"red",size:t})},getTitle:function(){return"Debug"},decode:function(e){return u.B4.Decode(pE,e)}},pT=n(73030),pR=n(87722),pD=n(91608),pI=n(1228),pG=n(78272),pB=n(3499);function pA(e){var t=e.text,n=(0,eB._)(e,["text"]),r=(0,w.useRef)(null),i=(0,w.useRef)(t);return(0,w.useEffect)(function(){if(i.current!==t){var e=t.length;!function n(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;requestAnimationFrame(function(){var o=r.current;o&&(o.textContent=t.slice(0,i),i!==e&&n(i+1))})}()}},[t]),(0,w.useEffect)(function(){i.current=t},[t]),(0,c.tZ)(h.xv,(0,P._)((0,A._)({},n),{ref:r,children:t}))}var pP=(0,p.X)({loading:[g.l0.coverContainer,g.l0.center],header:[g.l0.rowWithGap(4),g.l0.align.center,g.l0.justify.spaceBetween,g.l0.p(8)],sessions:[g.l0.overflowY("auto"),g.l0.flex.growAndShrink(1)],session:[g.l0.p(4),g.l0.border({direction:"bottom"}),t9.gU.listItem]});function pN(e){var t=e.currentSessionId,n=(0,pB.mL)(),r=n.sessions;return n.loading&&!r.length?(0,c.tZ)(R.G,{css:pP.loading,children:(0,c.tZ)(v.Z,{})}):(0,c.BX)(c.HY,{children:[(0,c.BX)(R.G,{css:pP.header,children:[(0,c.BX)(h.xv,{color:"dimmer",variant:"small",children:[r.length," ",(0,ed.Z)("Chat",r.length)]}),(0,c.tZ)(d.hU,{alt:"New chat",onClick:function(){e.onNewSessionClick()},children:(0,c.tZ)(nn.Z,{})})]}),(0,c.BX)(R.G,{css:pP.sessions,children:[t?null:(0,c.BX)(R.G,{css:[pP.session,{backgroundColor:g.TV.accentPrimaryDimmest}],onClick:function(){return e.onNewSessionClick},children:[(0,c.tZ)(h.xv,{color:"dimmer",multiline:!1,children:"New Chat"}),(0,c.tZ)(nt.EK,{textColor:"dimmest",textVariant:"small",date:new Date})]}),r.map(function(n){return(0,c.BX)(R.G,{id:n.id,css:[pP.session,{backgroundColor:n.id===t?g.TV.accentPrimaryDimmest:void 0}],onClick:function(){return e.onSessionClick(n.id)},children:[(0,c.tZ)(pA,{multiline:!1,text:n.title||"Untitled"}),(0,c.tZ)(nt.EK,{textColor:"dimmest",textVariant:"small",date:n.created})]},n.id)})]})]})}var pU=n(90719),pO=n(82897),pL=n(45086),pM=n(29128),pX=n(39511),pF=n(475),pW=n(56557),pH=n(69119),pV=n(1415),pz=n(43151),pj=n(57),pq=n(34335),pY=n(25202),p$=n(76673),pJ=n(79217),pK=n(17225),pQ=n(98934),p0=(0,p.X)({root:[t9.gU.listItem,g.l0.p(4),g.l0.colWithGap(2)],content:[g.l0.rowWithGap(8),g.l0.align.center],left:[g.l0.flex.growAndShrink(1),g.l0.rowWithGap(4),g.l0.align.center,{fontSize:g.TV.fontSizeSmall}],warning:[{color:g.TV.accentNegativeDefault}],dir:[{opacity:.6},g.l0.flex.shrink(100)]});function p1(e){var t=e.path,n=e.highlighted,r=e.ranges,i=e.status,o=n?{backgroundColor:t9.vb.interactiveBackgroundActive}:void 0,a=i?({included:(0,c.tZ)(rr.Z,{}),overflowing:(0,c.tZ)(n9.Z,{}),truncated:(0,c.tZ)(n9.Z,{}),unsupported:(0,c.tZ)(n9.Z,{})})[i]:null,l=(0,pK.Q1)({path:t,ranges:null!=r?r:[]}),s=l.directory,u=l.filename;return(0,c.BX)(R.G,{css:p0.root,style:o,children:[(0,c.BX)(R.G,{css:p0.content,style:o,children:[(0,c.BX)(R.G,{css:p0.left,style:o,children:[(0,c.tZ)(f.Z,{path:t,size:16}),(0,c.tZ)(pH.x,{text:u.text,highlight:u.ranges,dimmed:!n}),s?(0,c.tZ)(R.G,{color:"dimmest",css:p0.dir,children:(0,c.tZ)(pH.x,{text:s.text+"/",highlight:s.ranges,dimmed:!n})}):null]}),a]}),"overflowing"===i||"truncated"===i?(0,c.tZ)(h.xv,{css:p0.warning,variant:"small",children:"Exceeds file memory"}):null,"unsupported"===i?(0,c.tZ)(h.xv,{css:p0.warning,variant:"small",children:"File not supported"}):null]})}var p2=(0,pD.$)(["iconColor","placeholderColor","itemTransform","inputBorderRadius","inputBorder"]),p8=p2.cssVars,p4=p2.styleTokens,p3=(0,p.X)({root:[g.l0.width(240),g.l0.maxHeight(200)],inputRow:[g.l0.position.relative,(vG={},(0,eD._)(vG,p8.iconColor,g.TV.foregroundDimmest),(0,eD._)(vG,p8.placeholderColor,g.TV.foregroundDimmer),(0,eD._)(vG,":focus-within, :hover",(vI={},(0,eD._)(vI,p8.iconColor,g.TV.foregroundDimmer),(0,eD._)(vI,p8.placeholderColor,g.TV.foregroundDimmest),vI)),vG)],searchIcon:[g.l0.pl(6),g.l0.coverContainer,g.l0.align.start,g.l0.justify.center,{color:p4.iconColor,pointerEvents:"none"}],input:[t9.gU.nofill,g.l0.p(4),g.l0.pl(24),{borderRadius:p4.inputBorderRadius,fontSize:g.TV.fontSizeSmall,margin:"-1px -1px 0",cursor:"text","::placeholder":{color:p4.placeholderColor},"@media (hover: hover)":{":not([disabled]):focus":{outline:"0 none"}}}],header:[g.l0.rowWithGap(2),g.l0.px(4),g.l0.height(24),g.l0.align.center],unselectButton:[g.l0.reset.button,t9.gU.nofill,g.l0.p(2),{fontSize:g.TV.fontSizeSmall}],menu:[g.l0.flex.growAndShrink(1),{overflow:"auto"}],item:[{transform:p4.itemTransform,position:"absolute",top:0,left:0,width:"100%"}]});function p5(e,t){return t.status&&!e.status?1:e.status&&!t.status?-1:"included"===t.status&&"included"!==e.status?1:"included"===e.status&&"included"!==t.status?-1:0}function p6(e){var t,n,r,i,o,l,s,u=e.fileContextInclusions,d=e.placement,f=void 0===d?"bottom":d,p=e.findFiles,m=e.overscan,y=e.onChange,b=(0,w.useRef)(null),Z=(0,a._)((0,w.useState)(""),2),x=Z[0],C=Z[1],_=(r=(n=(0,a._)((0,w.useState)({loading:!0,error:null,items:null}),2))[0],i=n[1],(o=(0,w.useRef)(null)).current||(o.current=(0,pY.Z)((t=(0,to._)(function(e){var t;return(0,ta.Jh)(this,function(n){switch(n.label){case 0:return[4,p(e)];case 1:return t=n.sent(),(0,w.startTransition)(function(){i(null!==t.error?{error:t.error,loading:!1,items:null}:{items:t.files,total:t.total,error:null,loading:!1})}),[2]}})}),function(e){return t.apply(this,arguments)}),{wait:40})),l=(0,w.useCallback)(function(e){var t;return null===(t=o.current)||void 0===t?void 0:t.call(o,e).catch(function(){})},[]),(0,w.useEffect)(function(){return l(""),function(){try{var e;null===(e=o.current)||void 0===e||e.cancel()}catch(e){}}},[l]),{files:r.items,loading:r.loading,error:r.error,total:r.total,update:l}),S=_.files,E=_.total,k=_.loading,T=_.error,D=_.update,I=(0,w.useRef)(null),G=(0,eV.Z)(x),B=(0,w.useMemo)(function(){var e=new Map(u.map(function(e){return[e.path,e.inclusionStatus]})),t=null==S?void 0:S.map(function(t){var n=t.path;return{path:n,ranges:t.ranges,status:e.get(n)}});if(!t)return null;if(I.current)return(0,p$.Z)(t,{existing:I.current,getKey:function(e){return e.path}});if(G.current)return t;var n=t.sort(p5);return I.current=n,n},[S,u,G]),N=(0,w.useMemo)(function(){var e;return null!==(e=null==B?void 0:B.filter(function(e){return e.status}))&&void 0!==e?e:[]},[B]),U=(0,pj.Kb)({inputValue:x,items:null!=B?B:[],isOpen:!0,defaultHighlightedIndex:0,stateReducer:function(e,t){var n=t.changes;switch(t.type){case pj.Kb.stateChangeTypes.InputKeyDownEnter:case pj.Kb.stateChangeTypes.ItemClick:return(0,u2.Uy)(n,function(t){t.highlightedIndex=e.highlightedIndex});default:return n}},onHighlightedIndexChange:function(e){void 0!==e.highlightedIndex&&-1!==e.highlightedIndex&&L.getVirtualItems()[e.highlightedIndex]&&L.scrollToIndex(e.highlightedIndex)},onStateChange:function(e){switch(e.type){case pj.Kb.stateChangeTypes.InputKeyDownEnter:case pj.Kb.stateChangeTypes.ItemClick:if(!e.selectedItem)break;var t,n,r,i=N.includes(e.selectedItem)?"exclude":"include";y({path:e.selectedItem.path,preference:i}),null===(r=b.current)||void 0===r||r.select();break;case pj.Kb.stateChangeTypes.InputChange:C(null!==(t=e.inputValue)&&void 0!==t?t:""),D(null!==(n=e.inputValue)&&void 0!==n?n:"")}}}),O=(0,w.useRef)(null),L=(0,t5.MG)({count:null!==(s=null==B?void 0:B.length)&&void 0!==s?s:0,getScrollElement:function(){return O.current},estimateSize:function(){return 32},getItemKey:function(e){var t,n;return null!==(n=null==B?void 0:null===(t=B[e])||void 0===t?void 0:t.path)&&void 0!==n?n:""},overscan:void 0===m?4:m}),M=(0,c.BX)(R.G,{css:p3.inputRow,children:[(0,c.tZ)(R.G,{css:p3.searchIcon,children:k?(0,c.tZ)(v.Z,{size:12}):(0,c.tZ)(f2.Z,{size:12})}),(0,c.tZ)("input",(0,A._)({autoFocus:!0,placeholder:"Search files",css:p3.input},U.getInputProps({ref:b})))]}),X="top"===f?"0 0 ".concat(g.TV.space4," ").concat(g.TV.space4):"".concat(g.TV.space4," ").concat(g.TV.space4," 0 0");return!k||(null==B?void 0:B.length)||(X=g.TV.space4),(0,c.BX)(R.G,{css:p3.root,style:(0,eD._)({},p8.inputBorderRadius,X),children:["bottom"===f?M:null,T?(0,c.tZ)(rC.E,{icon:(0,c.tZ)(n9.Z,{}),text:T}):null,void 0!==E?(0,c.BX)(R.G,{css:p3.header,style:"bottom"===f?{borderTop:"1px solid "+g.TV.outlineDimmer}:void 0,children:[(0,c.BX)(h.xv,{variant:"small",color:"dimmest",children:[u.length,"/",E]}),u.length?(0,c.tZ)(R.G,{tag:"button",css:p3.unselectButton,onClick:function(){return function(){var e=!0,t=!1,n=void 0;try{for(var r,i=u[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value.path;y({path:o,preference:"exclude"})}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}()},children:"Unselect"}):null]}):null,(0,c.tZ)("div",(0,P._)((0,A._)({style:"top"===f?{borderBottom:"1px solid "+g.TV.outlineDimmer}:void 0,css:p3.menu},U.getMenuProps({ref:O})),{children:(0,c.tZ)("div",{style:{height:"".concat(L.getTotalSize(),"px"),width:"100%",position:"relative"},children:L.getVirtualItems().map(function(e){var t=e.index,n=e.key,r=e.start,i=null==B?void 0:B[t];return i?(0,c.tZ)(R.G,(0,P._)((0,A._)({"data-index":t,css:p3.item,style:(0,eD._)({},p8.itemTransform,"translateY(".concat(r,"px)"))},U.getItemProps({item:i,index:t,refKey:"innerRef",ref:L.measureElement})),{"aria-selected":void 0!==i.status,children:(0,c.tZ)(p1,{highlighted:t===U.highlightedIndex,path:i.path,ranges:i.ranges,status:i.status})}),n):null})})})),"top"===f?M:null]})}var p9=(0,p.X)({button:[g.l0.reset.button,g.l0.align.center,g.l0.cursor.pointer,g.l0.px(4),g.l0.py(2),g.l0.rowWithGap(4),t9.gU.nofill,g.l0.color.foregroundDimmest,{"&:hover":g.l0.color.foregroundDefault}]});function p7(e){var t,n=(0,a._)((0,w.useState)(!1),2),r=n[0],i=n[1],o=(0,a._)((0,w.useState)(null),2),l=o[0],s=o[1],u=(0,a._)((0,w.useState)(null),2),d=u[0],f=u[1];(0,w.useEffect)(function(){var e=function(e){var t,n;t=e.target,n=[d,l],t instanceof Node&&n.some(function(e){return null==e?void 0:e.contains(t)})||i(!1)};return document.addEventListener("mousedown",e),function(){document.removeEventListener("mousedown",e)}},[d,l]),(0,w.useEffect)(function(){var e=function(e){"Escape"===e.key&&i(!1)};if(r)return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}},[r]);var p=(0,pq.D)(l,d,{modifiers:[{name:"offset",options:{offset:[0,4]}},{name:"preventOverflow",options:{padding:16}}],placement:"bottom-start"}),m=e.fileContextInclusions,v=e.findFiles,g="Context",y=m.filter(function(e){return"included"===e.inclusionStatus});y.length&&(g=1===y.length?(0,x.UO)(y[0].path):y.length+" files");var b=(0,w.useId)();return(0,c.BX)(c.HY,{children:[(0,c.BX)(R.G,{tag:"button",css:p9.button,innerRef:s,onClick:function(){return i(function(e){return!e})},onKeyDown:function(e){"ArrowDown"===e.key&&i(!0)},"aria-label":"Select files","aria-haspopup":!0,"aria-expanded":r,"aria-controls":b,children:[(0,c.tZ)(pz.Z,{}),(0,c.tZ)(h.xv,{variant:"small",children:g}),(0,c.tZ)(pJ.Z,{rotate:r?180:0,size:12})]}),r?(0,c.tZ)(pV.h,{children:(0,c.tZ)(s1.MT,{restoreFocus:!0,children:(0,c.tZ)(M.Tg,(0,P._)((0,A._)({id:b,elevated:!0,style:p.styles.popper,innerRef:f,css:pQ.L.popover},p.attributes.popper),{children:(0,c.tZ)(p6,{overscan:e.overscan,onChange:e.onChange,findFiles:v,fileContextInclusions:m,placement:(null===(t=p.state)||void 0===t?void 0:t.placement.startsWith("top"))?"top":"bottom"})}))})}):null]})}var me=n(19408),mt=n(12880),mn=n(83807),mr=new Map([["NONE",{title:"Ask AI",description:"Detect actions based on the prompt",icon:(0,c.tZ)(mn.Z,{})}],["GENERATE",{title:"Generate",description:"Write starter code/tests",icon:(0,c.tZ)(mt.Z,{})}],["TRANSFORM",{title:"Modify",description:"Refactor existing features",icon:(0,c.tZ)(mt.Z,{})}],["EXPLAIN",{title:"Explain",description:"Ask a question about your code",icon:(0,c.tZ)(me.Z,{})}],["REPLIT_DOCS",{title:"Ask replit.com",description:"Ask about how to do things on Replit",icon:(0,c.tZ)(me.Z,{})}]]),mi=(0,p.X)({root:[g.l0.rowWithGap(8),g.l0.px(8),g.l0.py(4),g.l0.cursor.pointer,t9.gU.listItem],header:[g.l0.rowWithGap(4),g.l0.align.center],content:[g.l0.flex.growAndShrink(1)]});function mo(e){var t=e.intent,n=e.selected,r=e.highlighted,i=mr.get(t);if(!i)throw Error("Expected data");return(0,c.BX)(R.G,{css:mi.root,style:r?{backgroundColor:t9.vb.interactiveBackground}:void 0,children:[(0,c.BX)(R.G,{css:mi.content,children:[(0,c.BX)(R.G,{css:mi.header,children:[(0,w.cloneElement)(i.icon,{size:16,color:g.TV.blurpleDefault}),(0,c.tZ)(h.xv,{variant:"small",children:i.title})]}),(0,c.tZ)(h.xv,{variant:"small",color:"dimmest",children:i.description})]}),n?(0,c.tZ)(rr.Z,{color:g.TV.foregroundDimmer}):null]})}var ma=(0,p.X)({button:[g.l0.reset.button,g.l0.p(4),g.l0.cursor.pointer,g.l0.rowWithGap(4),g.l0.align.center,t9.gU.nofill,g.l0.color.foregroundDimmest,{"&:hover":g.l0.color.foregroundDefault}],heading:[g.l0.px(8),g.l0.py(4)]});function ml(e){var t,n=(0,pj.L7)({items:e.items,selectedItem:e.selectedItem,onSelectedItemChange:function(t){var n=t.selectedItem;n&&e.onChange(n)}}),r=null!==(t=mr.get(e.selectedItem))&&void 0!==t?t:mr.get("NONE");if(!r)throw Error("Expected selectedIntent");var i=(0,pQ.w)(),o=i.setTriggerEl,a=i.setPopoverEl,l=i.attributes,s=i.styles;return(0,c.BX)(R.G,{children:[(0,c.tZ)("label",(0,P._)((0,A._)({css:g.l0.visuallyHidden},n.getLabelProps()),{children:"Select a mode for AI"})),(0,c.BX)(R.G,(0,P._)((0,A._)({tag:"button",css:ma.button},n.getToggleButtonProps({ref:o,refKey:"innerRef"})),{children:[n.selectedItem?(0,w.cloneElement)(r.icon,{size:12}):null,(0,c.tZ)(h.xv,{variant:"small",children:r.title}),(0,c.tZ)(pJ.Z,{rotate:n.isOpen?180:0,size:12})]})),(0,c.tZ)(R.G,(0,P._)((0,A._)({},n.getMenuProps({refKey:"innerRef"})),{children:n.isOpen?(0,c.tZ)(pV.h,{children:(0,c.tZ)(M.Tg,(0,P._)((0,A._)({elevated:!0,style:s,innerRef:a,css:pQ.L.popover},l),{children:(0,c.BX)(R.G,(0,P._)((0,A._)({},n.getMenuProps({refKey:"innerRef"})),{children:[(0,c.tZ)(R.G,{css:ma.heading,children:(0,c.tZ)(h.xv,{color:"dimmest",variant:"small",children:"Select a mode"})}),e.items.map(function(e,t){var r=e===n.selectedItem,i=t===n.highlightedIndex;return(0,c.tZ)(R.G,(0,P._)((0,A._)({},n.getItemProps({refKey:"innerRef",item:e,index:t})),{children:(0,c.tZ)(mo,{intent:e,selected:r,highlighted:i})}),e)})]}))}))}):null}))]})}var mc=n(77589),ms=n(9669),mu=n(92815),md=n(45434),mf=n(10700),mh=n(50455),mp=n(90841),mm=n(56412),mv=n(87001),mg=n(4736),my=(0,p.X)({surface:[g.l0.flex.growAndShrink(0),g.l0.borderRadius(8),g.l0.m(8),g.l0.position.relative,{marginTop:"auto"}],messageBoxContainer:[g.l0.p(8)],quotaLimitContainer:[g.l0.p(8),g.l0.colWithGap(8),g.l0.position.relative,{marginTop:"auto"}]});function mb(e){var t=e.text,n=e.type,r=(0,a._)((0,w.useState)(!1),2),i=r[0],o=r[1],l=(0,a._)((0,pU.Ni)(),2)[1];return(0,c.BX)(R.G,{css:my.quotaLimitContainer,children:[(0,c.tZ)(rC.E,{icon:(0,c.tZ)(n9.Z,{}),colorway:"red",text:t}),"basic"===n?(0,c.tZ)(L.zx,{onClick:function(){return o(!0)},colorway:"blurple",text:"Upgrade to Replit ".concat(mv.we)}):(0,c.tZ)(L.zx,{onClick:function(){return l("basic")},colorway:"blurple",text:"Switch back to basic model"}),(0,c.tZ)(pG.Z,{isOpen:i,onClose:function(){return o(!1)},type:"purchase",analyticsContext:{upgrade:{context:"ai_model_selector",surface:"ghostwriter_power_up_dialog"}}})]})}var mZ=n(7612),mw=eI.r$.define({combine:function(e){var t;return null!==(t=e[0])&&void 0!==t?t:0}}),mx=new cl.j(function(e){return mw.of(e)}),mC={marker:"cm-empty-state-dom"},m_=eP.tk.theme((0,eD._)({},".".concat(mC.marker),{backgroundColor:g.TV.redDefault,opacity:"0.2"})),mS=eI.QQ.define({create:function(e){return e.doc.length},update:function(e,t){return t.state.doc.length}}),mE=function(e){return Math.max(e.doc.length-e.facet(mw),0)},mk=eI.QQ.define({create:mE,update:function(e,t){return(0,mZ.a)(t,"doc",mw)?mE(t.state):e},provide:function(e){return[mS,m_,(0,eP.EY)({above:!1,update:function(t){return(0,mZ.a)(t,e)},markers:function(t){var n=t.state.field(e);if(0===n)return[];var r=t.state.doc.length;return eP.dc.forRange(t,mC.marker,eI.jT.range(r-n,r))}})]}}),mT=(0,p.X)({charLimit:[g.l0.color.redDefault]});function mR(e){var t=e.view,n=(0,pL.IK)(t,mk);return n?(0,c.tZ)(h.xv,{variant:"small",css:mT.charLimit,children:n}):null}var mD=n(59510),mI=n.n(mD),mG=eI.r$.define({combine:function(e){var t;return null!==(t=e[0])&&void 0!==t?t:[]},compare:mI()}),mB=new cl.j(function(e){return mG.of(e)}),mA={render:function(e){var t=e.file,n=t.path,r=t.match,i=(0,uF.VV)((0,c.tZ)(R.G,{css:p0.root,style:{width:"100%"},className:"option",children:(0,c.BX)(R.G,{css:p0.content,children:[(0,c.BX)(R.G,{css:p0.left,children:[(0,c.tZ)(f.Z,{path:n,size:16}),(0,c.tZ)(pH.x,{text:r.filename.text,highlight:r.filename.ranges,dimmed:!0}),r.directory?(0,c.tZ)(R.G,{color:"dimmest",css:p0.dir,children:(0,c.tZ)(pH.x,{text:r.directory.text+"/",highlight:r.directory.ranges,dimmed:!0})}):null]}),"included"===t.inclusionStatus?(0,c.tZ)(rr.Z,{}):null]})}));return i.style.display="flex",i.style.width="100%",i},position:81},mP=eP.tk.theme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:eN.TV.fontFamilyDefault,fontSize:eN.TV.fontSizeSmall},"& > ul > li":{padding:"0px",display:"flex",alignItems:"center"},"& > ul > li[aria-selected] .option":{backgroundColor:eN.TV.backgroundHighest}},".cm-completionLabel":{width:0}}),mN=new cl.j(function(e){if(!e)return[];function t(){return(t=(0,to._)(function(t){var n,r,i,o,a;return(0,ta.Jh)(this,function(l){switch(l.label){case 0:if(!e||!t.matchBefore(/@(\S*)/g)||null===(n=t.matchBefore(/\w*/)))return[2,null];return[4,e(n.text)];case 1:return i=null!==(r=l.sent().files)&&void 0!==r?r:[],o=new Map(t.state.facet(mG).map(function(e){return[e.path,e.inclusionStatus]})),a=i.map(function(e){var t=e.path,n=e.ranges;return{label:t,displayLabel:" ",file:{path:t,inclusionStatus:o.get(t),match:(0,pK.Q1)({path:t,ranges:null!=n?n:[]})}}}),[2,{from:n.from,filter:!1,options:a}]}})})).apply(this,arguments)}return[mP,(0,pW.ys)({defaultKeymap:!1,icons:!1,aboveCursor:!0,addToOptions:[mA],override:[function(e){return t.apply(this,arguments)}],maxRenderedOptions:100})]}),mU=new cl.j(function(e){return eP.tk.updateListener.of(function(t){var n=!0,r=!1,i=void 0;try{for(var o,a=t.transactions[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value.annotation(pW.Jv);l&&e(l.label)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}})}),mO=n(16689),mL=n.n(mO),mM=(0,p.X)({root:[g.l0.display.inlineFlex],button:[g.l0.reset.button,g.l0.display.inlineFlex,g.l0.px(2),t9.gU.outlined,g.l0.borderRadius(4),g.l0.rowWithGap(2),g.l0.align.center],warning:{color:g.TV.redDefault}}),mX=new uF.Jf(function(e){var t=(0,x.UO)(e.path),n=(0,x.Il)(e.path);return(0,c.tZ)(tn.u,{isDisabled:!n&&!e.warning,tooltip:(0,c.BX)(R.G,{children:[e.warning?(0,c.tZ)(h.xv,{variant:"small",css:mM.warning,children:e.warning}):null,n?(0,c.BX)(h.xv,{variant:"small",color:"dimmest",children:[n,"/"]}):null]}),children:function(n,r){return(0,c.tZ)(R.G,(0,P._)((0,A._)({css:mM.root,innerRef:r},n),{children:(0,c.BX)(R.G,{tag:"button",css:mM.button,onClick:function(){return e.onClick()},children:[(0,c.tZ)(f.Z,{size:12,path:e.path}),(0,c.tZ)(h.xv,{variant:"small",children:t}),e.warning?(0,c.tZ)(n9.Z,{size:12}):null]})}))}})}),mF=function(e){"use strict";(0,lc._)(n,e);var t=(0,lu._)(n);function n(e,r){var i;return(0,ll._)(this,n),(i=t.call(this)).file=e,i.onClick=r,i}var r=n.prototype;return r.eq=function(e){return this.file.path===e.file.path&&this.file.inclusionStatus===e.file.inclusionStatus},r.toDOM=function(){var e=this.file,t=e.path,n=e.inclusionStatus,r=null;switch(n){case"included":break;case"unsupported":r="File not supported";break;case"truncated":case"overflowing":r="Exceedes memory limit"}var i=mX.create({path:t,onClick:this.onClick,warning:r});return i.style.display="inline",i},n}(eP.l9),mW=function(e,t){return new eP.Y1({regexp:RegExp("".concat(e.map(function(e){var t=e.path;return"@".concat(mL()(t))}).join("|")),"g"),decoration:function(n,r){var i,o=n[0].substring(1,null===(i=n[0])||void 0===i?void 0:i.length),a=e.find(function(e){return e.path===o});return a?eP.p.replace({widget:new mF(a,function(){return t(o)}),inclusive:!0}):null}})},mH=new cl.j(function(e){return e?eP.lg.fromClass(function(){"use strict";function t(n){(0,ll._)(this,t);var r=n.state.facet(mG);this.match=r.length&&e?mW(r,e):null,this.placeholders=this.match?this.match.createDeco(n):eP.p.none}return t.prototype.update=function(t){var n=t.state.facet(mG);if(0===n.length){this.match=null,this.placeholders=eP.p.none;return}if((0,mZ.a)(t,mG)){this.match=mW(n,e),this.placeholders=this.match.createDeco(t.view);return}if((0,mZ.a)(t,"doc")){if(!this.match){this.match=mW(n,e),this.placeholders=this.match.createDeco(t.view);return}this.placeholders=this.match.updateDeco(t,this.placeholders)}},t}(),{decorations:function(e){return e.placeholders},provide:function(e){return eP.tk.atomicRanges.of(function(t){var n;return(null===(n=t.plugin(e))||void 0===n?void 0:n.placeholders)||eP.p.none})}}):[]}),mV=n(40497),mz={layer:"cm-placeholder-layer",dom:"cm-placeholder-dom"},mj=eP.tk.theme((vB={},(0,eD._)(vB,".".concat(mz.layer),{width:"100%",height:"100%",pointerEvents:"none"}),(0,eD._)(vB,".".concat(mz.dom),{position:"absolute",width:"100%",pointerEvents:"none",fontFamily:eN.TV.fontFamilyDefault,color:eN.TV.foregroundDimmest}),vB)),mq=function(e){return 0===e.doc.length};eI.r$.define({combine:function(){return!0}});var mY=eI.Py.define(),m$=eI.QQ.define({create:mq,update:function(e,t){return mq(t.state)}}),mJ=[m$,mj,(0,eP.EY)((vv=Date.now(),{above:!1,class:mz.layer,update:function(e){var t=!1;return(0,mV.j)(e,mY,function(){t=!0,vv=Date.now()}),t||(0,mZ.a)(e,m$)},markers:function(e){if(!e.state.field(m$))return[];var t,n,r,i,o=e.coordsAtPos(0);if(!o)return[];var a=e.dom.getBoundingClientRect(),l=o.left-a.left;return[(n=(t={top:o.top-a.top,left:l,height:o.bottom-o.top,animateTimestamp:vv}).top,r=t.left,i=t.height,{draw:function(){var e="Type message...",t=document.createElement("div");t.className=mz.dom,t.style.width="100%",t.style.paddingTop=n+"px",t.style.paddingLeft=r+"px",t.style.height=i+"px";var o=e.length;return function n(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;requestAnimationFrame(function(){t.textContent=e.slice(0,r),r<o&&n(r+1)})}(),t},animateTimestamp:t.animateTimestamp,eq:function(e){return this.animateTimestamp===e.animateTimestamp}})]}}))],mK=n(21488);function mQ(e){var t,n=(0,I.AA)(),r=(0,mK.T)();return(0,w.useCallback)((t=(0,to._)(function(t){var i,o,a,l,c;return(0,ta.Jh)(this,function(s){switch(s.label){case 0:return[4,e.listFiles()];case 1:if((i=s.sent()).error||!i.files)return[2,{error:null!==(o=i.error)&&void 0!==o?o:"Something went wrong",files:null}];if(a=i.files.filter(function(e){return!r(e)}),!t)return[3,3];return[4,(0,pK.Rz)(t,a)];case 2:return c=s.sent(),[3,4];case 3:c=(0,p$.Z)(a,{existing:n(),getKey:function(e){return e}}).map(function(e){return{path:e}}),s.label=4;case 4:return l=c,[2,{total:a.length,files:l,error:null}]}})}),function(e){return t.apply(this,arguments)}),[e,r,n])}function m0(){var e=(0,y.Z)().fs,t=(0,mf.B)(),n=(0,mp.zU)(),r=mQ(e);return(0,c.tZ)(p7,{onChange:n,findFiles:r,fileContextInclusions:t})}var m1=new cl.j(function(e){return eP.tk.domEventHandlers({keydown:function(t,n){!((0,pW.SI)(n.state).length>0)&&("Enter"!==t.key||t.shiftKey||(t.preventDefault(),e(n.state.doc.toString()),n.dispatch({changes:{from:0,to:n.state.doc.length}})))}})}),m2=eP.tk.theme((vA={"& .cm-content":{fontFamily:g.TV.fontFamilyDefault}},(0,eD._)(vA,"& .".concat(pM.ll),{display:"none"}),(0,eD._)(vA,"& .cm-indent-markers",{display:"none"}),vA)),m8=(0,p.X)({root:[g.l0.borderRadius(0,0,4,4),g.l0.border({color:g.TV.outlineDimmest,direction:"top"}),{marginTop:"auto"}],codemirror:[g.l0.maxHeight(300),g.l0.overflow("auto"),{"& .cm-content":g.l0.pt(8)}],footer:[g.l0.rowWithGap(8),g.l0.align.center,g.l0.height(32)],left:[g.l0.rowWithGap(8),g.l0.flex.growAndShrink(1),g.l0.align.center,g.l0.pl(4)],right:[g.l0.rowWithGap(4),g.l0.align.center,g.l0.pr(8)],send:[g.l0.borderRadius(8)],sendDisabled:[(0,h2.ec)("grey")],sendEnabled:[(0,h2.ec)("blurple")]});function m4(e){var t,n,r,i,o,l,s,u,f=e.setPromptEditor,h=e.openFile,p=(t=(0,pU.Lw)(),n=(0,mg.Tt)(),r=(0,a._)((0,pU.Ni)(),1)[0],n?t?"advanced"!==r?null:n.advancedModelUsage<n.advancedModelLimit?null:{type:"advanced",text:"Quota reached. Refreshes ".concat((0,mm.Z)(new Date(n.advancedModelTTLEnd),"do MMM, hh:mm a"))}:n.basicModelUsage<n.basicModelLimit?null:{type:"basic",text:"100% quota reached. Upgrade to Replit ".concat(mv.we," to get unlimited quota.")}:null),m=(0,y.Z)().fs,v=(0,hr.ql)(),g=(0,w.useCallback)(function(e){v({chatMessage:{type:"chat",text:e}})},[v]),b=(0,ap.Vg)((0,av.useRouter)()),Z=(0,w.useRef)(null),x=(0,ho.j3)(),C=(0,ho.em)(),_=(0,hM.v)(),S=(o=(i={enableBridge:b,model:(0,mh.P)(_),sendChatMessage:function(e){v({chatMessage:{type:"chat",text:e}})},abortResponse:function(){x&&k()}}).enableBridge,l=i.sendChatMessage,s=i.abortResponse,u=(0,mu.v)(),(0,w.useEffect)(function(){if(o){var e=function(e){return(0,mc.I6)(e,function(e){var t=e.type;switch(u(!1),t){case ms.cF.GHOSTWRITER_CHAT_SEND:l(e.chatMessage),(0,mc.gU)(e.id);break;case ms.cF.GHOSTWRITER_CHAT_ABORT_RESPONSE:s(),(0,mc.gU)(e.id);break;default:(0,t3.Z)(t)}})};return window.addEventListener("message",e),function(){return window.removeEventListener("message",e)}}},[s,o,l,u]),{focusNativeMobileInput:(0,w.useCallback)(function(){var e={messageType:ms.cF.GHOSTWRITER_CHAT_FOCUS_INPUT};(0,mc.bG)(e,tD()())},[])}).focusNativeMobileInput,E=(0,w.useCallback)(function(){if(b)S();else{var e;null===(e=Z.current)||void 0===e||e.focus()}},[S,b]),k=(0,w.useCallback)(function(){(0,nv.j)(nv.U3.GHOSTWRITER_CHAT_RESPONSE_STOPPED),C(),E()},[C,E]),T=m1.use(g),D=(0,ca.Z)(),I=D.ref,G=D.view;m3({view:G,setPromptEditor:function(e){Z.current=e,f(e)}});var B=(0,pL.IK)(G,m$),A=(0,md.yL)(_).messageCharacters,P=mx.use(A),N=mB.use((0,mf.B)()),U=mH.use(h),O=mQ(m),L=mN.use(O),X=(0,mp.zU)(),F=mU.use((0,w.useCallback)(function(e){return X({path:e,preference:"include"})},[X])),W=(0,a._)((0,hr.fr)(),2),H=W[0],V=W[1],z=(0,hr.J)();if((0,av.useRouter)().query.hideChatInput)return null;if(p)return(0,c.tZ)(mb,{type:p.type,text:p.text});var j=!G||!0===B;return(0,c.BX)(M.Tg,{css:m8.root,children:[(0,c.tZ)(eW.ZP,{ref:I,language:"markdown",css:m8.codemirror,hideGutter:!0,autocomplete:!1,extensions:[m2,T,mJ,mk,P,N,U,L,F]}),(0,c.BX)(R.G,{css:m8.footer,children:[(0,c.BX)(R.G,{css:m8.left,children:[(0,c.tZ)(ml,{items:["NONE","GENERATE","TRANSFORM","EXPLAIN","REPLIT_DOCS"],selectedItem:null!=H?H:"NONE",onChange:V}),(0,c.tZ)(m0,{})]}),(0,c.BX)(R.G,{css:m8.right,children:[(0,c.tZ)(mR,{view:G}),(0,c.tZ)(pU.O3,{}),(0,c.tZ)(M.Tg,{elevated:!0,css:m8.send,children:(0,c.tZ)(d.hU,{css:j&&!z?m8.sendDisabled:m8.sendEnabled,disabled:j&&!z,alt:z?"Stop":"Send",onClick:function(){if(z){k();return}if(G){var e=G.state.doc.toString();e&&(g(e),G.dispatch({changes:{from:0,to:G.state.doc.length}}))}},children:z?(0,c.tZ)(pF.Z,{}):(0,c.tZ)(pX.Z,{})})})]})]})]})}function m3(e){var t=e.view,n=e.setPromptEditor,r=(0,eV.Z)(n);(0,w.useEffect)(function(){if(t){var e=r.current;return e({setValue:function(e){t.state.doc.toString()!==e&&t.dispatch({changes:{from:0,to:t.state.doc.length,insert:e}})},focus:function(){t.focus(),t.dispatch({selection:{anchor:t.state.doc.length}})},animatePlaceholder:function(){t.dispatch({effects:mY.of(!0)})}}),function(){e(null)}}},[t,r])}var m5=eP.tk.theme((vP={"& .cm-content":{fontFamily:g.TV.fontFamilyDefault}},(0,eD._)(vP,"& .".concat(pM.ll),{display:"none"}),(0,eD._)(vP,"& .cm-indent-markers",{display:"none"}),vP)),m6=(0,p.X)({footer:[g.l0.rowWithGap(8),g.l0.align.center],left:[g.l0.rowWithGap(8),g.l0.align.center,g.l0.flex.growAndShrink(1),{cursor:"text"}],right:[g.l0.rowWithGap(8),g.l0.align.center],codemirror:[g.l0.maxHeight(300),g.l0.overflow("auto"),{"& .cm-content":g.l0.pt(8)}],send:[g.l0.borderRadius(8)],sendDisabled:[(0,h2.ec)("grey")],sendEnabled:[(0,h2.ec)("blurple")]});function m9(e){var t=(0,ca.Z)(),n=t.ref,r=t.view;m3({view:r,setPromptEditor:e.inputRef});var i=(0,pL.IK)(r,m$),o=mx.use(e.maxLength),l=(0,eV.Z)(e.onSubmit),s=m1.use((0,w.useCallback)(function(e){return l.current(e)},[l])),u=mN.use(e.findFiles),f=mH.use(e.openFile),h=mB.use(e.fileContextInclusions),p=e.updateFileContext,m=mU.use((0,w.useCallback)(function(e){return null==p?void 0:p({path:e,preference:"include"})},[p]));if(e.hideInput)return null;var v=(!r||!0===i)&&!e.loading,g=(0,a._)(e.children,3),y=g[0],b=g[1],Z=g[2];return(0,c.BX)(c.HY,{children:[(0,c.tZ)(eW.ZP,{ref:n,language:"markdown",css:m6.codemirror,hideGutter:!0,autocomplete:!1,extensions:[m5,s,mJ,mk,o,h,f,u,m]}),(0,c.BX)(R.G,{css:m6.footer,children:[(0,c.BX)(R.G,{css:m6.left,onClick:function(e){e.target===e.currentTarget&&(null==r||r.focus())},children:[y,b]}),(0,c.BX)(R.G,{css:m6.right,children:[(0,c.tZ)(mR,{view:r}),Z,(0,c.tZ)(M.Tg,{elevated:!0,css:m6.send,children:(0,c.tZ)(d.hU,{css:v?m6.sendDisabled:m6.sendEnabled,disabled:v,alt:e.loading?"Stop":"Send",onClick:function(){if(e.loading){e.onStop();return}if(r){var t=r.state.doc.toString();t&&(e.onSubmit(t),r.dispatch({changes:{from:0,to:r.state.doc.length}}))}},children:e.loading?(0,c.tZ)(pF.Z,{}):(0,c.tZ)(pX.Z,{})})})]})]})]})}var m7=new Map([["NONE",hu.$h.MESSAGE_ACTION_UNKNOWN],["GENERATE",hu.$h.GENERATE],["TRANSFORM",hu.$h.TRANSFORM],["EXPLAIN",hu.$h.EXPLAIN],["REPLIT_DOCS",hu.$h.REPLIT_DOCS]]),ve=new Map,vt=!0,vn=!1,vr=void 0;try{for(var vi,vo,va,vl,vc,vs,vu,vd,vf,vh,vp,vm,vv,vg,vy,vb,vZ,vw,vx,vC,v_,vS,vE,vk,vT,vR,vD,vI,vG,vB,vA,vP,vN,vU=m7[Symbol.iterator]();!(vt=(vN=vU.next()).done);vt=!0){var vO=(0,a._)(vN.value,2),vL=vO[0],vM=vO[1];ve.set(vM,vL)}}catch(e){vn=!0,vr=e}finally{try{vt||null==vU.return||vU.return()}finally{if(vn)throw vr}}var vX=n(19615),vF=n(22580),vW=(0,p.X)({root:[g.l0.rowWithGap(2),g.l0.align.center]}),vH=(0,w.memo)(function(e){var t=(0,pB.$q)(e.id);if(!t)return null;var n=t.eventIds,r=t.index,i=n.length;return i<2?null:(0,c.BX)(R.G,{css:vW.root,children:[(0,c.tZ)(d.hU,{onClick:function(){var t=n[r>0?r-1:i-1];e.onClick(t)},alt:"Previous",tooltipHidden:!0,children:(0,c.tZ)(sQ.Z,{})}),(0,c.BX)(h.xv,{variant:"small",color:"dimmest",children:[r+1,"/",i]}),(0,c.tZ)(d.hU,{onClick:function(){var t=n[r<i-1?r+1:0];e.onClick(t)},alt:"Next",tooltipHidden:!0,children:(0,c.tZ)(X.Z,{})})]})}),vV=n(85379);function vz(){var e=(0,ey._)(["\n  fragment AiChatMessageUser on User {\n    id\n    username\n    image\n    url\n  }\n"]);return vz=function(){return e},e}function vj(){var e=(0,ey._)(["\n  query AiChatMessageUserData($id: Int!) {\n    user(id: $id) {\n      ...AiChatMessageUser\n    }\n  }\n  ","\n"]);return vj=function(){return e},e}var vq={},vY=(0,eb.Ps)(vz()),v$=(0,eb.Ps)(vj(),vY),vJ=n(43409),vK=n(8017),vQ=(0,p.X)({root:[g.l0.borderRadius(4),g.l0.border({color:g.TV.outlineDimmest})],header:[g.l0.rowWithGap(4),g.l0.border({color:g.TV.outlineDimmest,direction:"bottom"})],button:[{borderRadius:0,borderTopLeftRadius:4}]});function v0(e){var t=e.codeReference,n=e.onClick;return(0,c.BX)(M.Tg,{css:vQ.root,children:[(0,c.tZ)(R.G,{css:vQ.header,children:(0,c.tZ)(L.zx,{css:vQ.button,size:"small",variant:"nofill",iconLeft:(0,c.tZ)(f.Z,{size:12,path:t.filePath}),iconRight:(0,c.tZ)(vK.Z,{}),text:"".concat(t.filePath," ").concat(t.range.lineFrom,":").concat(t.range.lineTo),onClick:n})}),(0,c.tZ)(h0.Z,{lineNumbers:!0,lineNumbersStart:t.range.lineFrom,language:t.language,code:t.code,filePath:t.filePath})]})}var v1=(0,p.X)({message:[g.l0.colWithGap(4)],header:[g.l0.rowWithGap(8),g.l0.align.center],footer:[g.l0.rowWithGap(8),g.l0.align.center,g.l0.justify.spaceBetween],footerRight:[g.l0.rowWithGap(8),g.l0.align.center,g.l0.justify.end,g.l0.flex.growAndShrink(1)]}),v2=(0,w.memo)(function(e){var t=(0,pB.Ti)(e.id);return t?(0,c.tZ)(vF.J,{text:t,codeComponent:vV._}):null});function v8(e){switch(e.type){case hu.G_.EXPLAIN_CODE:return(0,c.tZ)(vJ.As,{intent:"EXPLAIN"});case hu.G_.DEBUGGER:return(0,c.tZ)(vJ.As,{intent:"DEBUG"});case hu.G_.GENERATE_CODE:return(0,c.tZ)(vJ.As,{intent:"GENERATE"});case hu.G_.TRANSFORM_CODE:return(0,c.tZ)(vJ.As,{intent:"TRANSFORM"});default:return null}}function v4(e){if(!e)return null;var t=e.contents.contents,n=null;(null==t?void 0:t.$kind)==="messageEventContents"?n={value:t.messageEventContents.intent,kind:"message"}:(null==t?void 0:t.$kind)==="inlineActionEventContents"&&(n={value:t.inlineActionEventContents.messageType,kind:"inline"});var r=e.error&&e.error.type!==hu.lZ.EVENT_ERROR_TYPE_UNKNOWN?e.error:null;return{id:e.id,created:e.created,sender:{type:e.sender.type,id:e.sender.id},parentEventId:e.parentEventId,state:e.state,codeReference:function(e){switch(null==e?void 0:e.contents.contents.$kind){case"messageEventContents":return e.contents.contents.messageEventContents.codeReference;case"inlineActionEventContents":return e.contents.contents.inlineActionEventContents.codeReference;default:return null}}(e),intent:n,error:r}}var v3=(0,w.memo)(function(e){var t,n,r,i,o=(0,pB.oV)(),a=(0,pB.Mi)(e.id,v4);if(!a)return null;var l=a.sender;function s(t){var n;if(!a)throw Error("Expected event");o(a.id,t?{intent:null!==(n=m7.get(t.intent))&&void 0!==n?n:hu.$h.MESSAGE_ACTION_UNKNOWN,model:t.model}:void 0),e.setActiveChild({parentEventId:a.parentEventId,eventId:null})}return l.type===hu.FW.USER?(0,c.BX)(R.G,{css:v1.message,children:[(0,c.BX)(R.G,{css:v1.header,children:[(0,c.tZ)(v5,{id:Number(l.id)}),(0,c.tZ)(nt.EK,{textVariant:"small",textColor:"dimmest",date:a.created})]}),(0,c.tZ)(v2,{id:e.id}),(null===(r=a.codeReference)||void 0===r?void 0:r.code)?(0,c.tZ)(v0,{codeReference:a.codeReference,onClick:function(){var t,n,r=null===(t=a.codeReference)||void 0===t?void 0:t.filePath;e.openFile&&r&&e.openFile({path:r,line:null===(n=a.codeReference)||void 0===n?void 0:n.range.lineTo})}}):null]}):(0,c.BX)(R.G,{css:v1.message,children:[(0,c.BX)(R.G,{css:v1.header,children:[(0,c.tZ)(vX.R,{size:24,showUsername:!0}),(0,c.tZ)(nt.EK,{textVariant:"small",textColor:"dimmest",date:a.created}),(null===(t=a.intent)||void 0===t?void 0:t.kind)==="message"?(0,c.tZ)(ml,{items:["NONE","GENERATE","TRANSFORM","EXPLAIN","REPLIT_DOCS"],selectedItem:null!==(i=ve.get(a.intent.value))&&void 0!==i?i:"NONE",onChange:function(e){return s({intent:e,model:hu.BY.BASIC})}}):null,(null===(n=a.intent)||void 0===n?void 0:n.kind)==="inline"?(0,c.tZ)(v8,{type:a.intent.value}):null]}),(0,c.tZ)(v2,{id:e.id}),a.error?(0,c.tZ)(rC.E,{colorway:"warning",text:a.error.message||"Something went wrong"}):null,a.state===hu.he.COMPLETE?(0,c.tZ)(c.HY,{children:(0,c.tZ)(R.G,{css:v1.footer,children:(0,c.BX)(R.G,{css:v1.footerRight,children:[(0,c.tZ)(vH,{id:a.id,onClick:function(t){e.setActiveChild({parentEventId:a.parentEventId,eventId:t})}}),(0,c.tZ)(L.zx,{iconLeft:(0,c.tZ)(nJ.Z,{}),size:"small",text:"Retry",onClick:function(){return s()}})]})})}):null]})});function v5(e){var t,n,r,i,o=(t={variables:{id:e.id}},n=(0,A._)({},vq,t),eZ.a(v$,n)).data,a=null==o?void 0:o.user;return(0,c.tZ)(no.q,{size:24,username:null!==(r=null==a?void 0:a.username)&&void 0!==r?r:"",src:null!==(i=null==a?void 0:a.image)&&void 0!==i?i:""})}var v6=(0,p.X)({events:[g.l0.colWithGap(0),g.l0.overflowY("auto"),g.l0.flex.growAndShrink(1),g.l0.width("100%")],event:[g.l0.px(16),g.l0.py(8)],loading:[g.l0.center,g.l0.height("100%")]});function v9(e){var t,n=(0,pB.kP)(e.sessionId),r=(0,pB.hI)(null!==(t=null==n?void 0:n.id)&&void 0!==t?t:null,e.parentToActiveChild),i=r.events,o=r.loading,a=r.getEvents,l=i.length,s=l>0?i[l-1]:null;return(0,c.BX)(R.G,{css:v6.events,children:[o&&0===l?(0,c.tZ)(R.G,{css:v6.loading,children:(0,c.tZ)(v.Z,{size:32})}):null,i.map(function(t){return(0,c.tZ)(R.G,{css:v6.event,children:(0,c.tZ)(v3,{id:t,getEvents:a,setActiveChild:e.setActiveChild,openFile:e.openFile})},t)}),s?(0,c.tZ)(v7,{lastEventId:s}):null]})}function v7(e){var t=e.lastEventId,n=(0,w.useRef)(null),r=(0,w.useRef)(!0),i=(0,pB.SH)(t);return(0,w.useEffect)(function(){var e=function(){t&&cancelAnimationFrame(t)},t=null,o=i.subscribe(function(){r.current&&(e(),t=requestAnimationFrame(function(){n.current&&(0,cT.Z)(n.current)}))});return function(){o(),e()}},[i]),(0,c.tZ)("div",{ref:n})}var ge=n(45087),gt=n(69640),gn=n(22487),gr=(0,pD.$)(["fontSize","padding","border"]),gi=gr.cssVars,go=gr.styleTokens,ga=(0,p.X)({root:[g.l0.rowWithGap(4),g.l0.center,g.l0.flex.growAndShrink(1)],input:[{backgroundColor:"transparent",border:go.border,fontSize:go.fontSize,padding:go.padding},g.l0.flex.growAndShrink(1)]});function gl(e){var t,n,r=(0,a._)((0,w.useState)(e.initialValue),2),i=r[0],o=r[1],l=(0,eV.Z)(e.onCancel),s=(0,gn.Z)(function(){return l.current()},[]),u=(0,w.useRef)(null);(0,w.useEffect)(function(){var e;null===(e=u.current)||void 0===e||e.select()},[]);var d=e.compact?(t={},(0,eD._)(t,gi.border,"0 none"),(0,eD._)(t,gi.fontSize,g.TV.fontSizeSmall),(0,eD._)(t,gi.padding,"0 ".concat(g.TV.space2)),t):(n={},(0,eD._)(n,gi.padding,"".concat(g.TV.space8)),(0,eD._)(n,gi.fontSize,g.TV.fontSizeDefault),n);return(0,c.tZ)(R.G,{style:d,innerRef:s,css:ga.root,tag:"form",onSubmit:function(t){t.preventDefault(),i&&e.onSubmit(i)},children:(0,c.tZ)(U.II,{placeholder:"Name this chat",ref:u,css:ga.input,value:i,onChange:function(e){return o(e.currentTarget.value)},onKeyDown:function(t){"Escape"===t.key&&e.onCancel()}})})}function gc(e){var t,n=(0,a._)((0,w.useState)(!1),2),r=n[0],i=n[1];return r?(0,c.tZ)(gl,{compact:!0,initialValue:null!==(t=e.title)&&void 0!==t?t:"",onCancel:function(){return i(!1)},onSubmit:function(t){i(!1),e.onRename(t)}}):(0,c.tZ)(gd,{title:e.title,onRename:function(){return i(!0)}})}var gs=(0,p.X)({root:[g.l0.flex.growAndShrink(1),{maxWidth:"100%"}],button:[g.l0.px(4),g.l0.reset.button,g.l0.rowWithGap(4),g.l0.align.center,g.l0.flex.growAndShrink(1),t9.gU.nofill,{fontWeight:g.TV.fontWeightMedium,svg:[g.l0.color.foregroundDimmest],"&:hover svg":[g.l0.color.foregroundDimmer]}],popover:[g.l0.borderRadius(4),g.l0.shadow(1),g.l0.border()],item:[t9.gU.listItem,g.l0.minWidth(140),g.l0.px(4),g.l0.py(2)]}),gu=["Rename"];function gd(e){var t=(0,pj.L7)({items:gu,onSelectedItemChange:function(t){if("Rename"===t.selectedItem){e.onRename();return}}}),n=(0,a._)((0,w.useState)(null),2),r=n[0],i=n[1],o=(0,a._)((0,w.useState)(null),2),l=o[0],s=o[1],u=(0,pq.D)(r,l,{modifiers:[{name:"offset",options:{offset:[0,8]}},{name:"preventOverflow",options:{padding:16}}],placement:"bottom"});return(0,c.tZ)(c.HY,{children:(0,c.BX)(R.G,{css:gs.root,children:[(0,c.BX)(R.G,(0,P._)((0,A._)({tag:"button",css:gs.button},t.getToggleButtonProps({refKey:"innerRef",ref:i})),{children:[(0,c.tZ)(pA,{variant:"small",color:e.title?"default":"dimmest",multiline:!1,text:e.title||"New chat"}),(0,c.tZ)(pJ.Z,{rotate:t.isOpen?180:0,size:12})]})),(0,c.tZ)(R.G,(0,P._)((0,A._)({},t.getMenuProps({refKey:"innerRef"})),{children:t.isOpen?(0,c.tZ)(pV.h,{children:(0,c.tZ)(M.Tg,(0,P._)((0,A._)({elevated:!0,style:u.styles.popper,innerRef:s,css:gs.popover},u.attributes.popper),{children:gu.map(function(e,n){var r=t.highlightedIndex===n?{backgroundColor:t9.vb.interactiveBackground}:void 0;return(0,c.tZ)(R.G,(0,P._)((0,A._)({css:gs.item,style:r},t.getItemProps({refKey:"innerRef",item:e,index:n})),{children:(0,c.tZ)(h.xv,{variant:"small",children:e})}),e)})}))}):null}))]})})}var gf=(0,p.X)({root:[g.l0.rowWithGap(4)],items:[g.l0.border({direction:"bottom"}),g.l0.maxWidth(280)],divider:[g.l0.border({direction:"bottom",color:g.TV.outlineDimmest})]});function gh(e){var t=e.basic,n=e.advanced,r=e.isPro,i=e.onUpgrade,o="basic"===e.currentModel?t:n,l=o.usage/o.limit>.95,s=(0,a._)((0,w.useState)(!1),2),u=s[0],f=s[1];return(0,c.BX)(R.G,{css:gf.root,children:[l?(0,c.tZ)(pO.cF,{used:o.usage,total:o.limit,inline:!0}):null,(0,c.BX)(t7.xo,{label:"usage",isOpen:u,onOpenChange:f,children:[(0,c.tZ)(d.hU,{alt:"Usage",children:(0,c.tZ)(ge.Z,{})}),(0,c.BX)(R.G,{css:gf.items,children:[(0,c.tZ)(pO.Vg,{quota:{used:t.usage,total:t.limit},selected:!1,hasAccessToAdvancedModel:r}),(0,c.tZ)(R.G,{css:gf.divider}),(0,c.tZ)(pO.Wj,{hasAccessToAdvancedModel:r,selected:!1,quota:{used:n.usage,total:n.limit},onUpgrade:i})]})]})]})}var gp=(0,p.X)({root:[g.l0.height(36),g.l0.rowWithGap(4),g.l0.px(2),g.l0.justify.spaceBetween,g.l0.align.center,g.l0.border({color:g.TV.outlineDimmest,direction:"bottom"})],center:[g.l0.flex.growAndShrink(1),g.l0.align.center],right:[g.l0.rowWithGap(0)]});function gm(e){var t=(0,a._)(e.children,2),n=t[0],r=t[1];return(0,c.BX)(R.G,{css:gp.root,children:[(0,c.tZ)(d.hU,{alt:"Sidebar",onClick:function(){return e.onSidebarButtonClick()},children:(0,c.tZ)(gt.Z,{})}),(0,c.tZ)(R.G,{css:gp.center,children:n}),(0,c.BX)(R.G,{css:gp.right,children:[r,(0,c.tZ)(d.hU,{alt:"New Chat",onClick:function(){return e.onAddButtonClick()},children:(0,c.tZ)(nn.Z,{})})]})]})}var gv=n(73164),gg=function(e){return"color-mix(in srgb, ".concat(eN.TV.blurpleDefault," ").concat(100*e,"%, transparent)")},gy=g.nC.min(440),gb=(0,eu.F4)({"0%":{opacity:0},"100%":{opacity:1}}),gZ=(0,pD.$)(["animationDelay"]),gw=gZ.styleTokens,gx=gZ.cssVars,gC=(0,p.X)({root:[g.l0.reset.button,t9.gU.filled,g.l0.borderRadius(4),g.l0.align.center,g.l0.p(6),g.l0.color.blurpleDefault,g.l0.cursor.pointer,g.l0.align.start,(r={},(0,eD._)(r,gy,[g.l0.rowWithGap(4),g.l0.align.center]),(0,eD._)(r,t9.dj.interactiveBackground,gg(.1)),(0,eD._)(r,t9.dj.interactiveBackgroundActive,gg(.2)),(0,eD._)(r,"opacity",0),(0,eD._)(r,"animationName",gb),(0,eD._)(r,"animationDuration","800ms"),(0,eD._)(r,"animationFillMode","forwards"),(0,eD._)(r,"animationTimingFunction","ease-out"),(0,eD._)(r,"animationDelay",gw.animationDelay),r)],iconText:g.l0.rowWithGap(4)});function g_(e){return(0,c.BX)(R.G,{css:gC.root,onClick:e.onClick,style:(0,eD._)({},gx.animationDelay,20*e.index+"ms"),children:[(0,c.BX)(R.G,{css:gC.iconText,children:[(0,w.cloneElement)(e.icon,{size:16,color:eN.TV.blurpleDefault}),(0,c.tZ)(h.xv,{variant:"small",children:e.text})]}),(0,c.tZ)(h.xv,{variant:"small",color:"dimmer",children:e.description})]})}var gS=(0,p.X)({root:[g.l0.flex.growAndShrink(1),g.l0.position.relative,g.l0.overflow("auto"),g.l0.display.block],content:[g.l0.py(32),g.l0.px(32),g.l0.center,g.l0.colWithGap(12),g.l0.minHeight("100%")],header:[g.l0.colWithGap(8),g.l0.align.center,g.l0.maxWidth(370),g.l0.textAlign.center],buttons:[g.l0.colWithGap(8),(0,eD._)({},gy,[g.l0.align.center])]});function gE(e){var t,n,r,i,o=e.onPromptClick,l=(r=(n=(0,a._)((0,fj.AA)(),1)[0])?gv.$R.from(n):null,i=null!=n?n:"index.js",[{icon:(0,c.tZ)(mt.Z,{}),title:"Generate",description:"Create a personal assistant chatbot",action:"GENERATE"},{icon:(0,c.tZ)(hL.Z,{}),title:"Debug",description:n?"Find bugs in ".concat(n):"Fix the price updating logic",action:"DEBUG"},{icon:(0,c.tZ)(me.Z,{}),title:"Explain",description:"How does ".concat(i," work?"),action:"EXPLAIN",promptToFill:n?"How can I improve the code in "+n:"How can I improve the code in "},{icon:(0,c.tZ)(me.Z,{}),title:"Ask replit.com",description:"How do I deploy a ".concat(null!==(t=null==r?void 0:r.name)&&void 0!==t?t:"python"," project?"),action:"REPLIT_DOCS"}]);return o?(0,c.tZ)(R.G,{css:gS.root,children:(0,c.BX)(R.G,{css:gS.content,children:[(0,c.BX)(R.G,{css:gS.header,children:[(0,c.tZ)(vX.R,{advanced:!0,showUsername:!1}),(0,c.tZ)(h.xv,{variant:"subheadBig",children:"Replit AI"}),(0,c.tZ)(h.xv,{color:"dimmest",children:"Use Replit AI to set up new projects, answer questions about your code, and assist your thinking."})]}),(0,c.tZ)(R.G,{css:gS.buttons,children:l.map(function(e,t){return(0,c.tZ)(g_,{index:t,icon:e.icon,text:e.title,description:e.description,onClick:function(){var t,n=null!==(t=e.promptToFill)&&void 0!==t?t:e.description;(0,nv.j)(nv.U3.GHOSTWRITER_CHAT_EXAMPLE_CLICKED,{title:e.title}),o({intent:e.action,value:n})}},e.action)})})]})}):null}var gk=(0,pD.$)(["sidebarTransform","mainPaddingLeft"]),gT=gk.cssVars,gR=gk.styleTokens,gD=(0,p.X)({content:[g.l0.position.relative,g.l0.flex.growAndShrink(1),g.l0.height("100%"),g.l0.container("content"),g.l0.colorMixBg(g.TV.blurpleDefault,"transparent",.05)],header:[{zIndex:1}],sidebar:[g.l0.border({direction:"right",color:g.TV.outlineDimmest}),g.l0.position.absolute,g.l0.top(0),g.l0.left(0),g.l0.height("100%"),g.l0.width("100%"),g.l0.maxWidth(200),(0,eD._)({zIndex:1,transform:gR.sidebarTransform,transitionProperty:"transform",transitionDuration:cC.H.duration},g.nC.min(800,"content"),[g.l0.width(200),{transitionDuration:"0s"}])],main:[g.l0.position.relative,g.l0.flex.growAndShrink(1),g.l0.justify.end,(0,eD._)({},g.nC.min(800,"content"),{paddingLeft:gR.mainPaddingLeft})],chatInputWrapper:[g.l0.px(8),g.l0.pb(8),{justifySelf:"end"}],chatInput:[g.l0.backgroundColor.backgroundDefault,g.l0.borderRadius(4),g.l0.pb(8),g.l0.pl(4),g.l0.pr(8),{border:"1px solid ".concat(g.TV.outlineDimmest),"&:focus-within, &:hover":{border:"1px solid ".concat(g.TV.outlineDimmer)},"&:active":{border:"1px solid ".concat(g.TV.accentPrimaryDefault)}}]}),gI=["NONE","GENERATE","TRANSFORM","EXPLAIN","REPLIT_DOCS"];function gG(e){var t,n,r,i,o,s,u,d,f,h,p,m,v=(0,a._)((0,w.useState)(!1),2),y=v[0],b=v[1],Z=(0,a._)((0,w.useState)("NONE"),2),x=Z[0],C=Z[1],_=(0,a._)((0,pU.Ni)(),2),S=_[0],E=_[1],k=(0,pB.p)(),T=(0,pB.Bk)(),D=e.workspace,I=(null==D?void 0:D.getFileContext)?function(){var t,n;return D.getFileContext({model:"advanced"===S&&T()?hu.BY.ADVANCED:hu.BY.BASIC,filePreferences:k(),recentFiles:null!==(n=null===(t=e.recentFilesObservable)||void 0===t?void 0:t.current)&&void 0!==n?n:[]})}:void 0,G=(0,hs.bD)({initialSessionId:e.initialSessionId,getFileContext:I}),B=G.sendMessage,A=G.stopMessage,P=G.loading,N=G.setSessionId,U=G.sessionId,O=G.setActiveChild,L=G.parentToActiveChild,X=(0,eV.Z)(e.sessionRef);(0,w.useEffect)(function(){var e;null===(e=X.current)||void 0===e||e.call(X,{sessionId:U,setSessionId:N})},[U,X,N]);var F=(0,pB.ZR)().hasAccessToAdvancedModel,W=(0,pB.kP)(U),H=(0,pB.xe)(),V=(r=(0,f5.Gn)("chatEngine").preferences,i=(0,pR.hG)().data,o=(0,a._)((0,pU.Ni)(),1)[0],s=(0,pB.ll)(),u=null==i?void 0:null===(t=i.currentUser)||void 0===t?void 0:t.hasOverride,d=null==r?void 0:r.chatEngine,f=null==i?void 0:null===(n=i.currentUser)||void 0===n?void 0:n.defaultEngine,u&&d&&(0,md.uL)(d)?d:(0,md.uL)(f)?"advanced"===o&&s?md.hf.model:f:pI.Fp),z=(0,md.yL)(V).messageCharacters,j=(0,a._)((0,w.useState)(!1),2),q=j[0],Y=j[1],$=(0,a._)((0,w.useState)(null),2),J=$[0],K=$[1],Q=(0,w.useRef)(0),ee=(0,cx.Z)(function(e){return Q.current=e.width});function et(e){Q.current<800&&Y(!1),N(e),null==J||J.focus()}var en=(0,pB.Tt)(),er=(0,pB._i)(),ei=(0,pB.Ud)(),eo=(0,a._)((0,w.useState)([]),2),ea=eo[0],el=eo[1],ec=(0,eV.Z)(null===(h=e.workspace)||void 0===h?void 0:h.getFileContext),es=e.recentFilesObservable;(0,w.useEffect)(function(){var e=function(e){return t.apply(this,arguments)};if(es)return e(es.current),es.subscribe((0,pY.Z)(e,{wait:2e3}));function t(){return(t=(0,to._)(function(e){var t,n;return(0,ta.Jh)(this,function(r){switch(r.label){case 0:return[4,null===(t=ec.current)||void 0===t?void 0:t.call(ec,{model:"advanced"===S&&T()?hu.BY.ADVANCED:hu.BY.BASIC,filePreferences:en,recentFiles:e})];case 1:if(!(n=r.sent()))return[2];return el(function(e){var t=e.filePreferences,n=e.fileContextState,r=new Map(n.fileContext.map(function(e){return[e.filePath,"included"]})),i=!0,o=!1,c=void 0;try{for(var s,u=t[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var d=(0,a._)(s.value,2),f=d[0],h=d[1];if("exclude"===h){r.delete(f);continue}if(n.unsupportedPreferredFiles.has(f)){r.set(f,"unsupported");continue}r.set(f,"included"===r.get(f)?"included":"overflowing")}}catch(e){o=!0,c=e}finally{try{i||null==u.return||u.return()}finally{if(o)throw c}}return(0,l._)(r.entries()).map(function(e){var t=(0,a._)(e,2);return{path:t[0],inclusionStatus:t[1]}})}({fileContextState:n,filePreferences:en})),[2]}})})).apply(this,arguments)}},[es,en,S,ec,T]);var eu=(0,w.useRef)(null);function ed(){et(null),null==J||J.animatePlaceholder(),(0,lx.A)(eu,"border-color",g.TV.accentPrimaryDefault),setTimeout(function(){requestAnimationFrame(function(){var e;null===(e=eu.current)||void 0===e||e.style.removeProperty("border-color")})},60)}var ef=H?function(e,t){var n=e.basicModelLimits,r=e.advancedModelLimits;switch(t){case hu.BY.BASIC:if(n.usage<n.limit)break;return{resetTime:n.resetTime};case hu.BY.ADVANCED:if(r.usage<r.limit||0===r.limit)break;return{resetTime:r.resetTime}}return null}(H,"advanced"===S?hu.BY.ADVANCED:hu.BY.BASIC):null;return(0,c.BX)(c.HY,{children:[(0,c.BX)(R.G,{innerRef:ee,css:gD.content,style:(m={},(0,eD._)(m,gT.sidebarTransform,"translateX(".concat(q?"0":"-100%",")")),(0,eD._)(m,gT.mainPaddingLeft,(q?200:0)+"px"),m),children:[(0,c.tZ)(M.Tg,{css:gD.header,children:(0,c.BX)(gm,{onAddButtonClick:ed,onSidebarButtonClick:function(){return Y(function(e){return!e})},children:[W?(0,c.tZ)(gc,{title:null!==(p=null==W?void 0:W.title)&&void 0!==p?p:"Untitled",onRename:function(e){ei(W.id,{title:e})}}):null,H?(0,c.tZ)(gh,{basic:H.basicModelLimits,advanced:H.basicModelLimits,isPro:F,currentModel:S,onUpgrade:function(){return b(!0)}}):null]})}),(0,c.BX)(R.G,{css:gD.main,children:[(0,c.tZ)(M.Tg,{css:gD.sidebar,children:(0,c.tZ)(pN,{currentSessionId:U,onSessionClick:et,onNewSessionClick:ed})}),U?(0,c.tZ)(v9,{sessionId:U,parentToActiveChild:L,setActiveChild:O,openFile:null==D?void 0:D.openFile}):(0,c.tZ)(gE,{onPromptClick:J?function(e){var t;C(e.intent),null==J||null===(t=J.setValue)||void 0===t||t.call(J,e.value),null==J||J.focus()}:void 0}),(0,c.tZ)(R.G,{css:gD.chatInputWrapper,children:ef?(0,c.tZ)(mb,{type:S,text:"advanced"===S?"Quota reached. Refreshes ".concat((0,mm.Z)(new Date(ef.resetTime),"do MMM, hh:mm a")):"100% quota reached. Upgrade to get unlimited quota."}):(0,c.tZ)(R.G,{css:gD.chatInput,innerRef:eu,children:(0,c.BX)(m9,{inputRef:function(t){var n;K(t),null===(n=e.inputRef)||void 0===n||n.call(e,t)},findFiles:null==D?void 0:D.findFiles,fileContextInclusions:ea,updateFileContext:function(e){return er(e.path,e.preference)},openFile:null==D?void 0:D.openFile,maxLength:z,loading:P,onStop:A,onSubmit:function(e){var t;B({kind:"message",message:e,model:"advanced"===S?hu.BY.ADVANCED:hu.BY.BASIC,intent:null!==(t=m7.get(x))&&void 0!==t?t:hu.$h.MESSAGE_ACTION_UNKNOWN})},children:[(0,c.tZ)(ml,{items:gI,selectedItem:x,onChange:C}),D?(0,c.tZ)(p7,{onChange:function(e){return er(e.path,e.preference)},findFiles:D.findFiles,fileContextInclusions:ea}):null,H?(0,c.tZ)(pO.q2,{userLimits:H,selectedItem:S,hasAccessToAdvancedModel:F,onChange:function(e){if(!F&&"advanced"===e){b(!0);return}E(e)}}):null]})})})]})]}),(0,c.tZ)(pG.Z,{isOpen:y,onClose:function(){return b(!1)},type:"purchase",analyticsContext:{upgrade:{context:"ai_model_selector",surface:"ghostwriter_power_up_dialog"}}})]})}var gB=function(){return(0,c.BX)(R.G,{css:[g.l0.colWithGap(16),g.l0.align.center,g.l0.p(24),g.l0.height("100%"),g.l0.justify.center],children:[(0,c.tZ)(R.G,{css:[g.l0.maxWidth(200)],children:(0,c.tZ)(oG.Z,{src:"/public/images/ghostwriter/orb.png",css:[{userSelect:"none",mixBlendMode:"screen",filter:"brightness(110%) saturate(1.2)",maskImage:"linear-gradient(".concat(g.TV.backgroundRoot,", transparent)")}],width:200,height:200,objectFit:"contain","aria-hidden":"true",alt:"",draggable:!1})}),(0,c.tZ)(h.xv,{variant:"subheadBig",multiline:!1,children:"Chat with Replit AI"}),(0,c.BX)(R.G,{css:[g.l0.rowWithGap(8),g.l0.align.center],children:[(0,c.tZ)(v.Z,{}),(0,c.tZ)(h.xv,{color:"dimmer",multiline:!1,children:"Loading"})]})]})},gA=n(84657),gP=(0,p.X)({headerWrapper:[g.l0.rowWithGap(4),g.l0.align.center],feedbackContent:[g.l0.backgroundColor.backgroundHigher,g.l0.colWithGap(4),g.l0.borderRadius(8),g.l0.py(4),g.l0.px(8)],messageWrapper:[g.l0.px(8),g.l0.py(12),g.l0.colWithGap(8)],messagePreview:[g.l0.colWithGap(4),g.l0.borderRadius(4),g.l0.py(4),g.l0.px(8),{background:"linear-gradient(90.7deg, rgba(82, 57, 204, 0.1) 0.6%, rgba(166, 148, 255, 0.1) 137.79%)"},g.l0.border({color:g.TV.blurpleDefault,style:"solid",direction:"left",width:2})],userFeedbackWrapper:[g.l0.rowWithGap(4),g.l0.align.center,g.l0.justify.start],userFeedbackText:[g.l0.flex.growAndShrink(1),g.l0.width("100%")]}),gN=function(e){var t=e.message,n=e.currentUser,r=e.autoScroll,i=t.useAdvancedModel,o=t.text,a=t.feedbackProvidedMessage;if(!n)throw Error("Expecting a current user to render a feedback message");if(!a)throw Error("Expecting a feedback provided message to render a feedback message");var l=(0,w.useRef)(null),s=(0,gA.rM)();return(0,w.useLayoutEffect)(function(){r&&l.current&&requestAnimationFrame(function(){r&&l.current&&((0,cT.Z)(l.current,{skipOverflowHiddenElements:!0,behavior:"auto",scrollMode:"always"}),s(!0))})}),(0,c.BX)(R.G,{css:gP.messageWrapper,children:[(0,c.BX)(R.G,{css:gP.headerWrapper,children:[(0,c.tZ)(vX.R,{advanced:i}),(0,c.tZ)(h.xv,{multiline:!1,children:"recorded feedback"}),(0,c.tZ)(rr.Z,{color:g.TV.greenStronger})]}),(0,c.BX)(R.G,{css:gP.feedbackContent,children:[(0,c.tZ)(R.G,{css:gP.messagePreview,children:(0,c.tZ)(h.xv,{multiline:!1,maxLines:1,children:a.text})}),(0,c.BX)(R.G,{css:gP.userFeedbackWrapper,children:[(0,c.tZ)(no.q,{src:n.image,username:n.username}),(0,c.tZ)(h.xv,{css:gP.userFeedbackText,children:o})]})]}),(0,c.tZ)(R.G,{innerRef:l})]})},gU=n(24796),gO=n(6079),gL=n(20766),gM=n(27592),gX=n(31950),gF=n(59173),gW=(0,pD.$)(["transform","opacity"]),gH=gW.cssVars,gV=gW.styleTokens,gz=(0,p.X)({root:[g.l0.position.relative,{height:0}],container:[g.l0.position.absolute,g.l0.bottom(0),g.l0.left("50%"),{transitionProperty:["opacity","transform"],transitionTimingFunction:cC.H.timingFunction,transitionDuration:cC.H.duration,opacity:gV.opacity,transform:gV.transform}],button:[g.l0.reset.button,t9.gU.filledAndOutlined,g.l0.p(4),g.l0.rowWithGap(4),g.l0.align.center,g.l0.borderRadius(16),g.l0.shadow(1)]}),gj={hidden:(i={},(0,eD._)(i,gH.opacity,"0"),(0,eD._)(i,gH.transform,"translate(-50%, ".concat(g.TV.space4,")")),i),visible:(o={},(0,eD._)(o,gH.opacity,"1"),(0,eD._)(o,gH.transform,"translate(-50%, calc(-1 * ".concat(g.TV.space4,"))")),o)};function gq(e){var t=e.visible,n=e.onClick,r=(0,w.useRef)(null);return(0,gX.j)(r,t,function(e){return e?gj.visible:gj.hidden}),(0,c.tZ)(R.G,{innerRef:r,css:gz.root,children:(0,c.tZ)(R.G,{css:gz.container,children:(0,c.BX)(M.Tg,{css:gz.button,elevated:!0,tag:"button",onClick:n,children:[(0,c.tZ)(iN.Z,{size:12}),(0,c.tZ)(h.xv,{variant:"small",children:"Scroll to latest"})]})})})}var gY=n(15542),g$=n(54254),gJ=n(9100);function gK(){var e=(0,ey._)(["\n  query AiChatUserMessage($userId: Int!) {\n    user(id: $userId) {\n      id\n      username\n      image\n    }\n  }\n"]);return gK=function(){return e},e}var gQ={},g0=(0,eb.Ps)(gK()),g1=(0,p.X)({root:[g.l0.colWithGap(8),g.l0.px(8),g.l0.pb(8)],header:[g.l0.rowWithGap(8),g.l0.align.center]}),g2=(0,w.memo)(function(e){var t,n=e.id,r=e.openFile,i=(0,hr.qQ)(n),o=(0,gY.d)(),a=(t=(0,A._)({},gQ,{variables:{userId:o||-1},skip:!o}),eZ.a(g0,t)).data,l=null==a?void 0:a.user,s=(0,B.Z)(function(){return(0,gJ.BW)(n)},[n]);if(!i||!l)return null;var u="TRANSFORM"===i.intent?void 0:s;return(0,c.BX)(R.G,{css:g1.root,children:[(0,c.BX)(R.G,{css:g1.header,children:[(0,c.tZ)(g$.n,{username:l.username,src:l.image,small:!0}),i.timeCreated?(0,c.tZ)(nt.EK,{live:!0,date:i.timeCreated}):null]}),"EXPLAIN"===i.intent?(0,c.BX)(c.HY,{children:[(0,c.tZ)(vF.J,{text:i.text,codeComponent:u}),i.codeReference?(0,c.tZ)(v0,{codeReference:i.codeReference,onClick:function(){i.codeReference&&r({path:i.codeReference.filePath,line:i.codeReference.range.lineTo})}}):null]}):(0,c.tZ)(vF.J,{text:i.text})]})}),g8=n(99708),g4=(0,p.X)({root:[g.l0.flex.column,g.l0.maxHeight("100%"),g.l0.maxWidth("100%"),g.l0.flex.grow(1),g.l0.position.relative,g.l0.colorMixBg(g.TV.blurpleDefault,"transparent",.05)]});function g3(e){var t,n,r,i,o,l,s,u=e.paneIsActive,d=e.openFile,f=(0,ap.T3)(),h=(0,a._)((0,hr.zu)(),1)[0],p=h.filter(function(e){return"feedback"!==e.type});(0,gO.$h)();var m=(0,g8.yz)(),v=m.data,y=m.loading,b=m.error,x=null==v?void 0:v.currentUser,C=null==x?void 0:x.isStaff,_=(0,a._)((0,gL.RN)(),2),S=_[0],E=_[1],k=(0,hr.ZT)(),T=(0,B.Z)(function(){return[{type:"action",label:"Clear chat history",icon:(0,c.tZ)(c1.Z,{}),run:function(){(0,nv.j)(nv.U3.GHOSTWRITER_CHAT_CLEARED),k()}}]},[k]),D=(0,B.Z)(function(){var e=[];if(C){var t={match:cN.pl,data:{type:"action",icon:(0,c.tZ)(hL.Z,{fill:S?g.TV.accentPrimaryDefault:g.TV.foregroundDefault}),label:"Toggle debug mode",run:function(){E(function(e){return!e})}}};e.push(t)}return e},[S,E,C]),I=(0,a._)((0,w.useState)(null),2),G=I[0],A=I[1];(0,Z.Wk)(function(){return G},[G]),(0,Z.L5)(function(){return{actions:T,commands:D}},[T,D]);var P=(0,w.useRef)(null),N=(0,a._)((0,gA.Z_)(),2),U=N[0],O=N[1],L=(0,a._)((0,gA.Z9)(),2),M=L[0],X=L[1],F=(0,w.useCallback)(function(){if(M){X(!1);return}if(null!=P.current&&P.current.scrollHeight-P.current.scrollTop===P.current.clientHeight&&(u||!f)){O(!0);return}O(!1)},[M,O,X,u,f]),W=(t=(0,a._)((0,w.useState)(function(){return(0,gF.u)(!1)}),1)[0],r=(n=(0,a._)((0,w.useState)(null),2))[0],i=n[1],l=(o=(0,a._)((0,w.useState)(null),2))[0],s=o[1],(0,w.useEffect)(function(){if(r&&l)return(0,gM.j)(r,function(){return t.set(!1),function(){t.set(!0)}},{root:l,rootMargin:"100px"})},[t,r,l]),(0,w.useEffect)(function(){r&&(0,cT.Z)(r,{behavior:"instant"})},[r]),{showButton:t,anchorRef:i,scrollRef:s,onClick:function(){r&&(0,cT.Z)(r)}}),H=(0,hr.Qn)();return y?(0,c.tZ)(gB,{}):b||!x?(0,c.BX)(R.G,{children:["error: ",(null==b?void 0:b.message)||"User not found, please log in or reload"]}):(0,c.BX)(R.G,{css:g4.root,dataCy:"ghostwriter-chat",children:[h.length?(0,c.BX)(c.HY,{children:[(0,c.BX)(R.G,{innerRef:(0,ip.l)(P,W.scrollRef),css:[g.l0.colWithGap(8),g.l0.overflow("auto"),g.l0.flex.growAndShrink(1),g.l0.pt(12),g.l0.position.relative],onScroll:F,role:"log",children:[h.map(function(e,t){if("Human"===e.attribution)return(0,c.tZ)(g2,{id:e.id,openFile:d},e.id);var n=U&&t===h.length-1;return"feedback"===e.type?(0,c.tZ)(gN,{message:e,currentUser:x,autoScroll:n},e.id):(0,c.tZ)(vJ.v0,{message:e,autoScroll:n,isLastAssistantMessage:"Assistant"===e.attribution&&p[p.length-1].id===e.id},e.id)}),(0,c.tZ)(R.G,{innerRef:W.anchorRef})]}),(0,c.tZ)(gq,{visible:W.showButton,onClick:W.onClick})]}):(0,c.tZ)(gE,{onPromptClick:G?function(e){var t;H(e.intent),null==G||null===(t=G.setValue)||void 0===t||t.call(G,e.value),null==G||G.focus()}:void 0}),(0,c.tZ)(m4,{openFile:d,setPromptEditor:A})]})}var g5=function(e){var t=(0,tY.P5)({controlName:"flag-killswitch-ghostwriter-chat",logFlagToAnalytics:!1}),n=e.performPaneOperation,r=(0,w.useCallback)(function(e){n({operation:"open",pane:"string"==typeof e?(0,b.$E)(e):{type:(0,D.Dp)(e),data:e},secondary:!0})},[n]);return t?(0,c.tZ)(gU.Z,{textVariant:"headerDefault",showImage:!0}):(0,c.tZ)(g3,{openFile:r,paneIsActive:e.paneIsActive})},g6=n(82960),g9=n(39756),g7=n(95683),ye=n(10009),yt=u.B4.Create(hu.e6);function yn(e){return!(!(0,x.Mb)(e)||(0,g6.Z)(e))}function yr(){return(yr=(0,to._)(function(e){var t,n,r,i,o,c,s,u,d,f,h,p,m,v,g,y,b,Z,w,C,_,S,E,k,T,R,D,I,G,B,A,P,N,U,O,L,M,X,F,W,H,V,z,j,q,Y,$,J,K,Q,ee,et,en;return(0,ta.Jh)(this,function(er){switch(er.label){case 0:t=e.filter,n=e.filePreferences,r=e.entrypoint,i=e.model,o=e.fs,c=(0,eB._)(e,["filter","filePreferences","entrypoint","model","fs"]),s=(0,md.yL)(i).fileContextCharacters,u=[],d=[],f=new Set,h=!0,p=!1,m=void 0;try{for(v=n[Symbol.iterator]();!(h=(g=v.next()).done);h=!0){if(b=(y=(0,a._)(g.value,2))[0],Z=y[1],"exclude"===Z){u.push(b);continue}if(!yn(b)){f.add(b);continue}d.push(b)}}catch(e){p=!0,m=e}finally{try{h||null==v.return||v.return()}finally{if(p)throw m}}w=[],C=!0,_=!1,S=void 0;try{for(E=c.recentFiles[Symbol.iterator]();!(C=(k=E.next()).done)&&(T=k.value,u.includes(T)||!yn(T)||!t(T)||d.includes(T)||(w.push(T),3!==w.length));C=!0);}catch(e){_=!0,S=e}finally{try{C||null==E.return||E.return()}finally{if(_)throw S}}if(R=(0,l._)(d).concat((0,l._)(w)),!(r&&R.length<10))return[3,2];return I=""===(D=(0,x.Il)(r))?g9.Ql:D,[4,o.readDir(I)];case 1:if(!(G=er.sent()).error){B=0,A=!0,P=!1,N=void 0;try{for(U=G.children[Symbol.iterator]();!(A=(O=U.next()).done)&&(L=O.value,M=I===g9.Ql?L.filename:I+L.filename,u.includes(M)||!yn(M)||!t(M)||R.includes(M)||(R.push(M),1!=++B));A=!0);}catch(e){P=!0,N=e}finally{try{A||null==U.return||U.return()}finally{if(P)throw N}}}er.label=2;case 2:var ei;return hz.kg.info("AI got file context",{numRecentFiles:w.length,numPreferredFiles:d.length,maxFiles:10}),X=R.slice(0,10),F=R.slice(10),[4,Promise.all(X.map((ei=(0,to._)(function(e){var t;return(0,ta.Jh)(this,function(n){return t=new Promise(function(e){return setTimeout(e,5e3)}),[2,Promise.race([Promise.all([o.readFile(e),function(){try{return o.getOTVersion(e)}catch(e){}return 0}()]),t])]})}),function(e){return ei.apply(this,arguments)})))];case 3:for(j=0,W=er.sent(),H=s,V=[],z=[];j<X.length;j++){if(q=X[j],!(Y=W[j])){hz.kg.info("AI file read timeout",{filePath:q});continue}if(J=($=(0,a._)(Y,2))[0],K=$[1],J.error){hz.kg.info("AI failed to read file",{filePath:q});continue}if((0,ye.Z)(J.content.toBuffer())){hz.kg.info("GhostwriterChat filtered out binary file",{filePath:q});continue}if(H<=0){F.push(q);continue}if(ee=(Q=J.content.toString()).slice(0,H),et=Q.length>ee.length,en=(0,g7.S)(q),et){V.push(q);continue}H-=ee.length,z.push({filePath:q,fileContent:ee,fileVersion:K,language:en,referenceType:hu.MD.FILE,code:"",range:yt})}return[2,{fileContext:z,preferredFiles:d,mostRecentFile:w.length?w[0]:void 0,truncatedFiles:V,overflowingFiles:F,unsupportedPreferredFiles:f}]}})})).apply(this,arguments)}var yi=n(1574),yo=n(37685),ya=s.Dy.Object({type:s.Dy.Literal("ghostwriterChat"),data:s.Dy.Optional(s.Dy.Object({sessionId:s.Dy.Optional(s.Dy.String())}))}),yl={Content:function(e){var t,n,r,i,o,l,s,u,d,f,h,p,m,v=e.pane.data,g=e.options,x=(0,tY.P5)({controlName:"flag-killswitch-ghostwriter-chat",logFlagToAnalytics:!1}),C=g.performPaneOperation,_=(0,w.useCallback)(function(e){C({operation:"open",pane:"string"==typeof e?(0,b.$E)(e):{type:(0,D.Dp)(e),data:e},secondary:!0})},[C]),S=(0,y.Z)(),E=S.fs,k=S.dotReplit,T=mQ(E),R=(t=(0,f5.Gn)("chatEngine").preferences,r=null==(n=(0,pR.hG)().data)?void 0:n.currentUser,i=null==t?void 0:t.chatEngine,o=(0,w.useCallback)(function(e){var t=e.model,n=null==r?void 0:r.hasOverride,o=null==r?void 0:r.defaultEngine;return n&&i&&(0,md.uL)(i)?i:(0,md.uL)(o)?t===hu.BY.ADVANCED?md.hf.model:o:pI.Fp},[r,i]),(0,w.useCallback)((l=(0,to._)(function(e){var t,n,r,i,a;return(0,ta.Jh)(this,function(l){switch(l.label){case 0:return t=e.model,n=e.filePreferences,r=e.recentFiles,[4,k.getConfig()];case 1:return a=((null==(i=l.sent().config)?void 0:i.hidden)||[]).map(function(e){return(0,yi.Z)(e)}).filter(Boolean),[2,function(e){return yr.apply(this,arguments)}({model:o({model:t}),filePreferences:n,filter:function(e){return!(0,yo.lv)(e,a)},recentFiles:r,entrypoint:(null==i?void 0:i.entrypoint)||void 0,fs:E})]}})}),function(e){return l.apply(this,arguments)}),[E,k,o])),G=(0,I._3)(),B=(0,hv.l)(),A=(0,w.useMemo)(function(){return{openFile:_,findFiles:T,getFileContext:R}},[_,T,R]),P=(0,a._)((0,w.useState)(null),2),N=P[0],U=P[1],O=(0,a._)((0,w.useState)(null),2),L=O[0],M=O[1];return(u=(s={sessionId:null==L?void 0:L.sessionId,setSessionId:null==L?void 0:L.setSessionId,data:v,performPaneOperation:C}).sessionId,d=s.setSessionId,f=s.data,h=s.performPaneOperation,(0,w.useEffect)(function(){u&&h({operation:"replace",pane:{type:"ghostwriterChat",data:{sessionId:u}}})},[u,h]),p=null==f?void 0:f.sessionId,m=(0,eV.Z)(u),(0,w.useEffect)(function(){d&&p&&p!==m.current&&d(p)},[p,m,d]),(0,Z.Wk)(function(){return N},[N]),x)?(0,c.tZ)(gU.Z,{textVariant:"headerDefault",showImage:!0}):B?(0,c.tZ)(gG,{sessionRef:M,inputRef:U,initialSessionId:null==v?void 0:v.sessionId,recentFilesObservable:G,workspace:A}):(0,c.tZ)(g5,{paneIsActive:g.isActive,performPaneOperation:g.performPaneOperation})},Icon:function(e){var t=e.size;return(0,c.tZ)(pT.Z,{size:t})},getTitle:function(){return"AI"},decode:function(e){return u.B4.Decode(ya,e)}},yc=n(89788),ys=n(18059),yu=n(24801),yd=n(2454),yf=n(35034),yh=n(15006),yp=n(71064),ym=n(86612),yv=n(9617);function yg(){var e=(0,ey._)(["\n  query SshConfigurator($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        replcoSSHUrl: hostedUrl(dotty: true)\n        owner {\n          __typename\n          ... on Team {\n            id\n            isTeamsPro: subscriptionIsType(subscriptionType: PRO)\n          }\n          ... on User {\n            id\n            username\n          }\n        }\n      }\n      ... on ReplRedirect {\n        replUrl\n      }\n      ... on SubscriptionExpiredError {\n        replId\n      }\n    }\n    currentUser {\n      id\n      userSubscriptionType\n    }\n  }\n"]);return yg=function(){return e},e}var yy={},yb=(0,eb.Ps)(yg()),yZ=["ssh-dsa","ssh-ecdsa","ssh-ed25519","ssh-rsa"];function yw(e){var t=e.code,n=e.multiline;return(0,c.BX)(M.Tg,{tag:"pre",elevated:!0,css:[g.l0.borderRadius(8),g.l0.p(8),g.l0.rowWithGap(8)],children:[(0,c.tZ)(h.xv,{multiline:n,css:[g.l0.overflow("auto"),g.l0.font.code,g.l0.flex.growAndShrink(1),{"::-webkit-scrollbar":[g.l0.display.none]}],maxLines:n?void 0:1,children:t}),(0,c.tZ)(d.hU,{onClick:function(){return(0,O.Z)(t)},alt:"Copy",children:(0,c.tZ)(F.Z,{})})]})}function yx(e,t){if(!e)return"Please add a key for this secret";if(!e.trim())return"The key must include a non-space character";if(t.includes(e))return"You already have this key";var n=e.split(" ");return 3!==n.length?"This seems to be an invalid key.":yZ.includes(n[0])?null:"Key type is not valid."}function yC(e){return(0,c.BX)(R.G,{css:[g.l0.colWithGap(4)],children:[(0,c.tZ)("label",{htmlFor:e.id,children:(0,c.tZ)(h.xv,{variant:"small",color:"dimmer",multiline:!1,children:e.label})}),e.children,e.error?(0,c.BX)(R.G,{css:[g.l0.rowWithGap(2),g.l0.align.center],children:[(0,c.tZ)(yh.Z,{}),(0,c.tZ)(h.xv,{variant:"small",css:g.l0.color.accentNegativeStrongest,multiline:!1,children:e.error})]}):null]})}function y_(e){var t,n=e.authorizedKey,r=e.otherKeys,i=e.onUpdateKey,o=e.onSave,l=(0,a._)((0,w.useState)(),2),s=l[0],u=l[1],d=(0,w.useRef)(null),f=function(){var e=yx(n.key,r);if(e){u(e),d.current&&d.current.focus();return}o()};(0,w.useEffect)(function(){!s||yx(n.key,r)||u(null)},[n.key,s,r]);var p=(t=function(e){"Enter"===e.key&&(e.preventDefault(),e.stopPropagation(),f())},function(e){e.stopPropagation(),t(e)}),m=(0,ys.Cl)(),v=(0,ih.d)(),y=(0,aS.U)()("key");return(0,c.BX)(M.Tg,{elevated:!0,css:[g.l0.p(16),g.l0.borderRadius(8),g.l0.colWithGap(16)],children:[r&&0!==r.length?null:(0,c.tZ)(h.xv,{children:"Before you can SSH to your Repl, you need to add an SSH key."}),(0,c.tZ)(yC,{id:y,label:"Key (in OpenSSH Public Key format)",error:s,children:(0,c.tZ)(U.II,{id:y,ref:d,name:"key",value:n.key,spellCheck:!1,onChange:function(e){i(e.currentTarget.value)},onKeyDown:p})}),m||v?(0,c.tZ)(R.G,{css:[g.l0.colWithGap(8)],children:(0,c.BX)(h.xv,{children:["Need a hand? The"," ",(0,c.tZ)("a",{href:"https://docs.replit.com/power-ups/ssh",target:"_blank",children:"SSH documentation"})," ","provides information about generating SSH keys."]})}):(0,c.BX)(R.G,{css:[g.l0.colWithGap(8)],children:[(0,c.tZ)(h.xv,{children:"Need a hand? Generate a key:"}),(0,c.tZ)(yw,{code:'[ -s ~/.ssh/replit.pub ] || ssh-keygen -t ed25519 -f ~/.ssh/replit -q -N "" && cat ~/.ssh/replit.pub',multiline:!1}),(0,c.tZ)(h.xv,{children:"Paste the result in the form above."})]}),(0,c.tZ)(R.G,{css:[g.l0.rowWithGap(8),g.l0.justify.spaceBetween],children:(0,c.tZ)(R.G,{css:g.l0.rowWithGap(8),children:(0,c.tZ)(L.zx,{colorway:"primary",onClick:f,text:"Add SSH Key"})})})]})}function yS(e){var t=e.onAdd,n=e.otherKeys,r=(0,a._)((0,w.useState)({key:""}),2),i=r[0],o=r[1];return(0,c.tZ)(y_,{authorizedKey:i,otherKeys:n,onUpdateKey:function(e){o(function(t){return t?(0,P._)((0,A._)({},t),{key:e}):t})},onSave:function(){o({key:""}),i.key&&t(i)}})}function yE(e){var t=e.authorizedKey,n=e.onDelete;return(0,c.BX)(R.G,{css:[t9.gU.filled,g.l0.p(8),g.l0.rowWithGap(8),g.l0.align.center,g.l0.justify.spaceBetween,g.l0.borderRadius(8)],children:[(0,c.tZ)(yp.Z,{size:24}),(0,c.BX)(h.xv,{css:[g.l0.flex.growAndShrink(1)],maxLines:1,multiline:!1,children:[t.keytype," ",t.key.substring(0,8),"...",t.key.substring(t.key.length-8)," ",t.comment]}),(0,c.tZ)(d.hU,{onClick:function(){return n(t)},alt:"Delete",size:28,children:(0,c.tZ)(yf.Z,{})})]})}function yk(e){var t=e.authorizedKeys,n=e.onAdd,r=e.onDelete;return(0,c.BX)(R.G,{css:g.l0.colWithGap(16),children:[(0,c.tZ)(yv.Z,{level:4,children:"Manage SSH Keys"}),Object.values(t).map(function(e){return(0,c.tZ)(yE,{authorizedKey:e,onDelete:r},e.key)}),(0,c.tZ)(yS,{onAdd:n,otherKeys:Object.keys(t)})]})}function yT(e){if(!e.length)return null;var t=e.split(" ");return t.length<3?null:{keytype:t[0],key:t[1],comment:t[2]}}function yR(e){var t=e.sshHostname,n=e.sshUser,r=e.sshPort,i="ssh -i ~/.ssh/replit -p ".concat(r," ").concat(n,"@").concat(t);return(0,c.BX)(R.G,{css:g.l0.colWithGap(16),children:[(0,c.tZ)(yv.Z,{level:5,children:"1. Quick-Connect SSH Command"}),(0,c.tZ)(h.xv,{children:"You can connect to this Repl directly using the command below without any further configuration on your machine"}),(0,c.tZ)(yw,{code:i,multiline:!1})]})}function yD(e){var t=e.initialAlias,n=e.sshHostname,r=e.sshUser,i=e.sshPort,o=(0,ys.Cl)(),l=(0,a._)((0,w.useState)(t),2),s=l[0],u=l[1],d=s||t,f="Host ".concat(d,"\n  Hostname ").concat(n,"\n  Port ").concat(i,"\n  User ").concat(r,"\n  IdentityFile ~/.ssh/replit");return(0,c.BX)(R.G,{css:g.l0.colWithGap(16),children:[(0,c.tZ)(yv.Z,{level:5,children:"2. SSH Configuration File"}),(0,c.BX)(h.xv,{children:["By adding a host entry to your SSH configuration file (typically"," ",(0,c.BX)(h.xv,{css:[g.l0.font.code,g.l0.display.inline,g.l0.align.baseline],children:[o?"%HOMEPATH%":"~","/.ssh/config"]}),"), you can simplify the connection process and give this Repl an alias."]}),(0,c.BX)(R.G,{css:g.l0.colWithGap(4),children:[(0,c.tZ)(h.xv,{children:"Host"}),(0,c.tZ)(h.xv,{variant:"small",color:"dimmer",children:"Enter an alias for this Repl's SSH connection. This can be anything but it can only contain letters, numbers, dots, hyphens, and underscores are allowed, it also has to be unique on your machine."}),(0,c.tZ)(U.II,{css:[g.l0.flex.grow(1),0===s.length?{borderColor:"".concat(g.TV.accentNegativeDefault," !important"),borderStyle:"solid !important",borderWidth:"1px !important",outlineColor:"".concat(g.TV.accentNegativeDefault," !important")}:null],value:s,spellCheck:!1,onChange:function(e){e.currentTarget.value.match(/^[a-zA-Z0-9.\-_]*$/)&&u(e.currentTarget.value)}})]}),(0,c.BX)(R.G,{css:g.l0.colWithGap(4),children:[(0,c.tZ)(h.xv,{children:"Configuration file"}),(0,c.tZ)(yw,{code:f,multiline:!0})]}),(0,c.BX)(R.G,{css:g.l0.colWithGap(4),children:[(0,c.tZ)(h.xv,{children:"Then connect using the following command"}),(0,c.tZ)(yw,{code:"ssh ".concat(d),multiline:!1})]})]})}function yI(e){var t=e.sshHostname,n=e.sshUser,r=e.sshPort;return(0,c.BX)(R.G,{css:g.l0.colWithGap(16),children:[(0,c.tZ)(yv.Z,{level:5,children:"3. SSH Client Configuration"}),(0,c.tZ)(h.xv,{children:"There are many SSH clients available. Some even come with a graphical interface such as PuTTY (on Windows) or Termius (on Mac). You can configure your SSH key and the following values:"}),(0,c.BX)(R.G,{children:[(0,c.BX)(R.G,{css:g.l0.colWithGap(2),children:[(0,c.tZ)(h.xv,{multiline:!1,children:"Hostname"}),(0,c.tZ)(yw,{code:t,multiline:!1})]}),(0,c.BX)(R.G,{css:g.l0.colWithGap(2),children:[(0,c.tZ)(h.xv,{multiline:!1,children:"Username"}),(0,c.tZ)(yw,{code:n,multiline:!1})]}),(0,c.BX)(R.G,{css:g.l0.colWithGap(2),children:[(0,c.tZ)(h.xv,{multiline:!1,children:"Port"}),(0,c.tZ)(yw,{code:r,multiline:!1})]})]})]})}function yG(e){var t=e.sshHostname,n=e.sshUser,r=e.sshPort,i=(0,y.Z)().container,o=(0,a._)((0,w.useState)("/home/runner"),2),l=o[0],s=o[1];return(0,w.useEffect)(function(){i.exec("pwd").then(function(e){var t;e.output&&s((null===(t=e.output)||void 0===t?void 0:t.replace("\n",""))||"")})},[i]),(0,c.BX)(R.G,{css:[g.l0.colWithGap(8)],children:[(0,c.tZ)(yv.Z,{level:5,children:"VSCode"}),(0,c.tZ)(h.xv,{children:"Make sure you add the following entry to your SSH config:"}),(0,c.tZ)(yw,{code:"Host *.replit.dev \n  Port ".concat(r,"\n  IdentityFile ~/.ssh/replit"),multiline:!0}),(0,c.tZ)(rT.Z,{text:"Open in VSCode",href:function(){var e="vscode://vscode-remote/ssh-remote+".concat(n,"@").concat(t,":").concat(r).concat(l);try{return window.encodeURI(e)}catch(e){}return e}(),colorway:"primary",iconLeft:(0,c.tZ)(oV.Z,{})})]})}function yB(e){var t=e.replId,n=function(e){var t=e.replId,n=e.replcoHostname,r=(0,y.Z)().container,i=(0,ym.Z)(r);if(i){var o=new URL(i).host,a=o.indexOf(":"),l="22";return -1!==a&&(o=o.substring(0,a),l="2022"),{sshUser:t,sshHostname:o,sshPort:l}}return{sshUser:t,sshHostname:n,sshPort:"22"}}({replId:t,replcoHostname:e.replcoHostname}),r=n.sshHostname,i=n.sshUser,o=n.sshPort,a=(0,tY.P5)({controlName:"flag-vscode-ssh"});return(0,c.BX)(R.G,{css:g.l0.colWithGap(32),children:[(0,c.BX)(R.G,{css:g.l0.colWithGap(8),children:[(0,c.tZ)(yv.Z,{level:4,children:"Connecting to this Repl"}),(0,c.tZ)(h.xv,{children:"Now that you have setup an SSH key. There are three ways you can connect to this Repl."})]}),a?(0,c.tZ)(yG,{sshHostname:r,sshUser:i,sshPort:o}):null,(0,c.tZ)(yR,{sshHostname:r,sshUser:i,sshPort:o}),(0,c.tZ)(yD,{initialAlias:t,sshHostname:r,sshUser:i,sshPort:o}),(0,c.tZ)(yI,{sshHostname:r,sshUser:i,sshPort:o})]})}function yA(){return(yA=(0,to._)(function(e){return(0,ta.Jh)(this,function(t){switch(t.label){case 0:return[4,e.createDir(".config")];case 1:return t.sent(),[4,e.createDir(".config/ssh")];case 2:return t.sent(),[2]}})})).apply(this,arguments)}function yP(e){var t,n,r,i=e.replId,o=e.replcoHostname,l=(0,y.Z)().fs,s=(0,a._)((0,w.useState)(null),2),u=s[0],d=s[1];(0,w.useEffect)(function(){function e(){return(e=(0,to._)(function(){var e,t;return(0,ta.Jh)(this,function(n){switch(n.label){case 0:return[4,function(e){return yA.apply(this,arguments)}(l)];case 1:return n.sent(),[4,l.readFile(".config/ssh/.authorized_keys")];case 2:if((e=n.sent()).error===cR.Df.NotFound)return d({}),[2];if(e.error)throw Error("Error getting .authorized_keys");return t={},e.content.toString().split("\n").forEach(function(e){if(!e.startsWith("#")){var n=yT(e);null!==n&&(t[n.key]=n)}}),d(t),[2]}})})).apply(this,arguments)}!function(){e.apply(this,arguments)}()},[l,d]);var f=(t=(0,to._)(function(e){var t,n;return(0,ta.Jh)(this,function(r){switch(r.label){case 0:if(!u)throw Error("trying to write authorized keys before loading");return d(t=function(e,t){var n=(0,A._)({},e);if("add"===t.type){var r=yT(t.key);r&&(n[r.key]=r)}else delete n[t.key];return n}(u,e)),n="# generated file, use the SSH tool instead of editing\n"+Object.values(t).map(function(e){return"".concat(e.keytype," ").concat(e.key," ").concat(e.comment)}).join("\n"),[4,l.writeFile(".config/ssh/.authorized_keys",tT.Z.from(n))];case 1:return r.sent(),[2]}})}),function(e){return t.apply(this,arguments)}),p=(n=(0,to._)(function(e){return(0,ta.Jh)(this,function(t){switch(t.label){case 0:return[4,f((0,A._)({type:"add"},e))];case 1:return t.sent(),(0,nv.j)(nv.U3.SSH_CONFIGURATOR_USED,{action:"added"}),[2]}})}),function(e){return n.apply(this,arguments)}),m=(r=(0,to._)(function(e){return(0,ta.Jh)(this,function(t){switch(t.label){case 0:return[4,f({type:"delete",key:e.key})];case 1:return t.sent(),(0,nv.j)(nv.U3.SSH_CONFIGURATOR_USED,{action:"deleted"}),[2]}})}),function(e){return r.apply(this,arguments)});return u?(0,c.BX)(R.G,{css:g.l0.colWithGap(16),children:[(0,c.BX)(h.xv,{variant:"small",color:"dimmer",children:["Add authorized keys to configure SSH access to this Repl."," ",(0,c.tZ)("a",{href:"https://docs.replit.com/power-ups/ssh",target:"_blank",children:"Learn more here"}),"."]}),(0,c.BX)(R.G,{css:g.l0.colWithGap(32),children:[(0,c.tZ)(yk,{authorizedKeys:u,onAdd:p,onDelete:m}),Object.keys(u).length>0?(0,c.tZ)(yB,{replId:i,replcoHostname:o}):null]})]}):(0,c.tZ)(R.G,{css:[g.l0.center,g.l0.coverContainer],children:(0,c.tZ)(v.Z,{size:24})})}function yN(e){var t=e.onPurchaseComplete,n=(0,a._)((0,w.useState)(!1),2),r=n[0],i=n[1];return(0,c.BX)(R.G,{css:[g.l0.colWithGap(16)],children:[(0,c.BX)(h.h4,{level:3,variant:"subheadDefault",children:["SSH is only available to Replit ",mv.we," Members."]}),(0,c.BX)(h.xv,{children:["With SSH, you can access your Repl's shell remotely. SSH enables workflows like easy file transfer or using your favorite local IDE to edit your code on Replit."," ",(0,c.tZ)("a",{href:"https://docs.replit.com/power-ups/ssh",target:"_blank",children:"Learn more here"})]}),(0,c.tZ)(L.zx,{onClick:function(){return i(!0)},text:"Join Replit ".concat(mv.we),iconLeft:(0,c.tZ)(yd.Z,{}),colorway:"blurple"}),(0,c.tZ)(pG.Z,{isOpen:r,onClose:function(){return i(!1)},type:"purchase",onPurchaseComplete:t,analyticsContext:{upgrade:{context:"cycles_page"}}})]})}function yU(){var e,t,n,r=(t={variables:{replId:(0,eg.Z)()}},n=(0,A._)({},yy,t),eZ.a(yb,n)),i=r.data,o=r.loading,a=r.refetch;if(!i||o)return(0,c.tZ)(R.G,{css:[g.l0.center,g.l0.coverContainer],children:(0,c.tZ)(v.Z,{size:24})});if("ReplRedirect"===i.repl.__typename)throw Error("Got repl redirect for replId query");if("SubscriptionExpiredError"===i.repl.__typename)return(0,c.tZ)(R.G,{children:(0,c.tZ)(h.xv,{children:"This Repl is private and your subscription expried. Please reload for further action."})});if(!i.currentUser)return(0,c.tZ)(R.G,{children:(0,c.tZ)(h.xv,{children:"You must be logged in to use SSH."})});var l=(0,yu.jX)(i.currentUser.userSubscriptionType),s=(null===(e=i.repl.owner)||void 0===e?void 0:e.__typename)==="Team"&&i.repl.owner.isTeamsPro;return l||s?(0,c.tZ)(yP,{replId:i.repl.id,replcoHostname:new URL(i.repl.replcoSSHUrl).hostname}):(0,c.tZ)(yN,{onPurchaseComplete:function(){a()}})}function yO(e){var t=e.children;return(0,c.tZ)(R.G,{css:[g.l0.height("100%"),g.l0.overflowY("auto"),D.F3],children:(0,c.BX)(R.G,{css:[g.l0.p(8),g.l0.colWithGap(8),g.l0.flex.grow(1)],children:[(0,c.tZ)(R.G,{css:[g.l0.rowWithGap(8)],children:(0,c.tZ)(yv.Z,{truncate:!0,level:4,children:"SSH Configuration"})}),(0,c.tZ)(R.G,{css:[g.l0.flex.grow(1),g.l0.py(8),g.l0.position.relative],children:t})]})})}var yL=s.Dy.Object({type:s.Dy.Literal("sshConfigurator")}),yM={Content:function(){return(0,c.tZ)(yX,{})},Icon:function(e){var t=e.size;return(0,c.tZ)(yc.Z,{size:t})},getTitle:function(){return"SSH"},decode:function(e){return u.B4.Decode(yL,e)}};function yX(){return(0,c.tZ)(yO,{children:(0,c.tZ)(yU,{})})}function yF(){return{codeEditor:k.D,webview:hO.Rm,media:cO,binary:S,pedit:fW,vnc:hN,unitTests:hG,adminPanel:pk,runnerOutput:fK.G,shell:hx,packager:fG,systemDependencies:hR,envEditor:tz,draw:tX,git:a3,diff:tb,history:cy,database:eR,neon:dA,markdown:cP,sshConfigurator:yM,ghostwriterChat:yl,problems:fJ,networking:dM,objectStorage:dH}}},35614:function(e,t,n){n.d(t,{T:function(){return o},u:function(){return a}});var r=n(68956),i=(0,n(90234).cn)(null);function o(){return(0,r.$X)(i)}function a(){return(0,r.Hg)(i)}},76568:function(e,t,n){n.d(t,{L5:function(){return y},Wk:function(){return T},Xq:function(){return G},Y6:function(){return b},bS:function(){return R},c4:function(){return _},dr:function(){return Z},u1:function(){return C}});var r=n(27387),i=n(66626),o=n(63257),a=n(96583),l=n(7444),c=n(50199),s=n(2038),u=n(64461),d=n(90234),f=n(15859),h=n(50959),p=n(34581),m=n(68956),v=(0,d.cn)({}),g=(0,d.cn)(null,function(e,t,n){t(v,function(e){return(0,u.Uy)(e,function(e){null===n.actions?delete e[n.paneId]:e[n.paneId]=n.actions})})});function y(e,t){var n=I(),r=(0,m.$X)(g),i=(0,l.Z)(e);(0,h.useEffect)(function(){var e;return r({paneId:n,actions:null!==(e=i.current())&&void 0!==e?e:null}),function(){r({paneId:n,actions:null})}},[r,n,i].concat((0,o._)(t)))}function b(e){var t=(0,c.Z)(function(){return(0,f.kv)(v,function(t){return e?t[e]:{}})},[e]);return(0,m.Hg)(t)}function Z(){var e=(0,m.XD)(v);return(0,h.useCallback)(function(t){var n;return null!==(n=e()[t])&&void 0!==n?n:null},[e])}var w=(0,d.cn)(new Map),x=(0,d.cn)(null,function(e,t,n,r){t(w,function(e){var t=new Map(e);return null===r?t.delete(n):r&&t.set(n,r),t})});function C(){return(0,m.$X)(x)}function _(){var e,t,n=(e=(0,m.rF)(),(0,h.useCallback)(function(t){return e((0,f.kv)(v,function(e){return e[t]}))},[e]));return(0,h.useCallback)((t=(0,r._)(function(e){return(0,a.Jh)(this,function(t){return[2,new Promise(function(t){var r=n(e);if(r.current){t(r.current);return}var i=r.subscribe(function(e){e&&(t(e),i())})})]})}),function(e){return t.apply(this,arguments)}),[n])}var S=(0,d.cn)(new Map),E=(0,d.cn)(null,function(e,t,n){t(S,function(e){return(0,u.Uy)(e,function(e){null===n.focus?e.delete(n.paneId):e.set(n.paneId,n.focus)})})});function k(e){var t=document.activeElement;return!!e&&!!t&&e!==t&&e.contains(t)}function T(e,t){var n=(0,l.Z)(e),r=I(),a=(0,s.T3)(),c=(0,h.useRef)(!a),u=(0,m.$X)(E),d=(0,m.XD)(p.J1),f=(0,m.XD)(w),v=(0,i._)((0,h.useState)(null),2),g=v[0],y=v[1];return(0,h.useEffect)(function(){n.current&&y(n.current())},t?(0,o._)(t):[]),(0,h.useEffect)(function(){var e=function(e){d()===r&&e.target!==f().get(r)&&(c.current=!1)};return document.body.addEventListener("focus",e,!0),function(){document.body.removeEventListener("focus",e,!0)}},[d,f,r]),(0,h.useEffect)(function(){if(g){var e=function(){g.focus()};return c.current&&d()===r&&!k(f().get(r))&&e(),u({paneId:r,focus:e}),function(){u({paneId:r,focus:null})}}},[g,u,r,d,f,a]),y}function R(){var e=(0,m.XD)(S),t=(0,m.XD)(w);return(0,c.Z)(function(){return function(n){var r=e().get(n),i=t().get(n);if(!k(i)){if(r){r();return}null==i||i.focus()}}},[e,t])}var D=(0,h.createContext)(null);function I(){var e=(0,h.useContext)(D);if(!e)throw Error("Expected pane id in context");return e}var G=D.Provider},34581:function(e,t,n){n.d(t,{AA:function(){return O},J1:function(){return p},Np:function(){return I},Vu:function(){return B},WU:function(){return m},Xo:function(){return P},ex:function(){return U},fg:function(){return L},gv:function(){return A},jY:function(){return N},mz:function(){return X},nC:function(){return G}});var r=n(66626),i=n(63257),o=n(3947),a=n(59510),l=n.n(a),c=n(64461),s=n(90234),u=n(50959),d=n(50199),f=n(68956),h=n(15592),p=(0,s.cn)(null);function m(){return(0,f.XD)(p)}var v=(0,s.cn)(new Map),g=(0,s.cn)([]),y=(0,s.cn)(null,function(e,t,n){t(v,function(e){return(0,c.Uy)(e,function(e){var t=e.get(n.paneId),r=Date.now();if(!t){e.set(n.paneId,{panes:[n.pane],lastActiveAt:r});return}var i=t.panes[t.panes.length-1];t.lastActiveAt=r,l()(n.pane,i)||t.panes.push(n.pane)})}),t(p,n.paneId)}),b=(0,s.cn)(null,function(e,t,n){var r=e(p),i=e(v).get(n);i&&t(g,function(e){return(0,c.Uy)(e,function(e){e.push(i.panes)})}),t(v,function(e){return(0,c.Uy)(e,function(e){e.delete(n)})}),r===n&&t(p,null)}),Z=(0,s.cn)(null,function(e,t,n){t(v,function(e){return(0,c.Uy)(e,function(e){var t=e.get(n);t&&(t.lastActiveAt=Date.now())})}),t(p,n)}),w=(0,s.cn)(null,function(e,t){t(p,null)}),x=(0,s.cn)(function(e){return(0,i._)(e(v).values()).sort(function(e,t){return t.lastActiveAt-e.lastActiveAt}).map(function(e){return e.panes})}),C=(0,s.cn)(function(e){var t=e(v),n=[];return t.forEach(function(e,t){var r=e.panes[e.panes.length-1];r&&n.push([t,r,e.lastActiveAt])}),n.sort(function(e,t){return e[2]-t[2]})}),_=(0,s.cn)(function(e){var t=[],n=!0,i=!1,a=void 0;try{for(var l,c=e(C)[Symbol.iterator]();!(n=(l=c.next()).done);n=!0){var s=(0,r._)(l.value,2),u=(s[0],s[1]),d=(0,o.Ur)(u)?u.data.path:null;d&&t.push(d)}}catch(e){i=!0,a=e}finally{try{n||null==c.return||c.return()}finally{if(i)throw a}}return t}),S=(0,s.cn)(function(e){var t=[],n=!0,r=!1,o=void 0;try{for(var a,l=e(x)[Symbol.iterator]();!(n=(a=l.next()).done);n=!0){var c=a.value;c.length<=1||t.push.apply(t,(0,i._)(c.slice(0,-1)))}}catch(e){r=!0,o=e}finally{try{n||null==l.return||l.return()}finally{if(r)throw o}}var s=!0,u=!1,d=void 0;try{for(var f,h=e(g)[Symbol.iterator]();!(s=(f=h.next()).done);s=!0){var p=f.value;t.push.apply(t,(0,i._)(p))}}catch(e){u=!0,d=e}finally{try{s||null==h.return||h.return()}finally{if(u)throw d}}return t}),E=(0,s.cn)(null,function(e,t){var n=e(g).flat().pop();return t(g,function(e){return(0,c.Uy)(e,function(e){var t=e.pop();t&&t.pop()})}),n}),k=(0,s.cn)(function(e){var t=[],n=!0,r=!1,i=void 0;try{for(var a,l=e(S)[Symbol.iterator]();!(n=(a=l.next()).done);n=!0){var c=a.value,s=(0,o.Ur)(c)?c.data.path:null;s&&t.push(s)}}catch(e){r=!0,i=e}finally{try{n||null==l.return||l.return()}finally{if(r)throw i}}return t}),T=(0,s.cn)(function(e){return(0,i._)(e(_)).concat((0,i._)(e(k)))}),R=(0,s.cn)(function(e){var t,n=e(p);if(!n)return null;var r=e(v).get(n);return r&&null!==(t=r.panes[r.panes.length-1])&&void 0!==t?t:null}),D=(0,s.cn)(function(e){var t=e(R);return t&&(0,o.Ur)(t)&&t.data.path||null});function I(e,t){var n=(0,f.$X)(y),r=(0,f.$X)(b);(0,u.useEffect)(function(){n({paneId:e,pane:t})},[n,e,t]),(0,u.useEffect)(function(){return function(){r(e)}},[r,e])}function G(){return(0,f.XD)(C)}function B(){return(0,f.Hg)(_)}function A(){return(0,f.$X)(E)}function P(){return(0,f.$X)(Z)}function N(){return(0,f.$X)(w)}function U(){return(0,f.Hg)(D)}function O(){return(0,f.Hg)(T)}function L(){var e=(0,f.yL)(_);return(0,d.Z)(function(){return function(t){return new Promise(function(n,r){var i=e.subscribe(function(e){e.includes(t)||(i(),n())})})}},[e])}var M=(0,s.cn)(function(e){return(0,h.w)(e(_))});function X(){return(0,f.Hg)(M)}},95684:function(e,t,n){n.d(t,{mK:function(){return s},qm:function(){return l},xx:function(){return c}});var r=n(90234),i=n(50959),o=n(68956),a=(0,r.cn)(!1);function l(){return(0,o.Hg)(a)}function c(){var e=(0,o.$X)(a);return(0,i.useCallback)(function(){return e(!0)},[e])}function s(e){var t=(0,o.$X)(a),n=(0,i.useRef)(!1);(0,i.useEffect)(function(){n.current||(n.current=!0,t(e))},[t,e])}},39327:function(e,t,n){n.d(t,{a9:function(){return a},kM:function(){return l}});var r=n(90234),i=n(68956),o=(0,r.cn)(null);function a(){return(0,i.$X)(o)}function l(){return(0,i.Hg)(o)}},75452:function(e,t,n){n.d(t,{OO:function(){return r},Uw:function(){return i},vw:function(){return o}});var r="replit-repltuned-v1-5-3b",i={"replit-repltuned-v1-5-3b":{},"replit-v1-5-3b":{}},o=new Set(Object.keys(i))},15592:function(e,t,n){n.d(t,{w:function(){return o}});var r=n(66626),i=n(19659);function o(e){if(0===e.length)return new Map;if(1===e.length)return new Map([[e[0],null]]);var t=new Map,n=!0,o=!1,a=void 0;try{for(var l,c=e[Symbol.iterator]();!(n=(l=c.next()).done);n=!0){var s=l.value,u=(0,i.UO)(s),d=t.get(u);d||(d=[],t.set(u,d)),d.push(s)}}catch(e){o=!0,a=e}finally{try{n||null==c.return||c.return()}finally{if(o)throw a}}var f=new Map,h=!0,p=!1,m=void 0;try{for(var v,g=t[Symbol.iterator]();!(h=(v=g.next()).done);h=!0)!function(){var e=(0,r._)(v.value,2)[1];if(1===e.length)return f.set(e[0],null);var t=new Map,n=new Set,i=0,o=!0,a=!1,l=void 0;try{for(var c,s=e[Symbol.iterator]();!(o=(c=s.next()).done);o=!0){var u=c.value;if(-1===u.indexOf("/")){f.set(u,null),n.add(u);continue}var d=function(e){for(var t=e.split("/").slice(0,-1),n=[],r=0;r<t.length;r++){var i=t.slice(r).join("/")+"/";0!==r&&(i="/"+i),n.push(i)}return n.reverse()}(u);t.set(u,d),d.length>i&&(i=d.length)}}catch(e){a=!0,l=e}finally{try{o||null==s.return||s.return()}finally{if(a)throw l}}for(var h=0;h<=i;h++){var p=function(e){var i=[],o=new Map,a=!0,l=!1,c=void 0;try{for(var s,u=t[Symbol.iterator]();!(a=(s=u.next()).done);a=!0){var d=(0,r._)(s.value,2),h=d[0],p=d[1];if(!n.has(h)){var m=p[e];m||(m=p[p.length-1]),i.push(m),o.set(m,h)}}}catch(e){l=!0,c=e}finally{try{a||null==u.return||u.return()}finally{if(l)throw c}}if(0===i.length)return"break";var v=!0,g=!1,y=void 0;try{for(var b,Z=i[Symbol.iterator]();!(v=(b=Z.next()).done);v=!0)!function(){var e=b.value,t=o.get(e);if(void 0===t)throw Error("Unpopulated segment map");1===i.filter(function(t){return t===e}).length&&(n.add(t),f.set(t,e))}()}catch(e){g=!0,y=e}finally{try{v||null==Z.return||Z.return()}finally{if(g)throw y}}}(h);if("break"===p)break}if(n.size!==e.length){var m=!0,g=!1,y=void 0;try{for(var b,Z=e[Symbol.iterator]();!(m=(b=Z.next()).done);m=!0){var w=b.value;if(!n.has(w)){var x=w.split("/").slice(0,-1).join("/");f.set(w,x)}}}catch(e){g=!0,y=e}finally{try{m||null==Z.return||Z.return()}finally{if(g)throw y}}}}()}catch(e){p=!0,m=e}finally{try{h||null==g.return||g.return()}finally{if(p)throw m}}return f}},50682:function(e,t,n){n.d(t,{J9:function(){return v},LK:function(){return g}});var r,i,o,a,l=n(27387),c=n(96583),s=n(45005),u=n.n(s),d=n(4859),f=n.n(d),h=n(43182),p="https://api.github.com",m=(r=(0,l._)(function(e){var t,n,r;return(0,c.Jh)(this,function(i){switch(i.label){case 0:return t=e.repoNameWithOwner,n=e.accessToken,[4,u()("".concat(p,"/repos/").concat(t,"/contents"),{method:"GET",headers:n?{Authorization:"Bearer ".concat(n)}:{}})];case 1:if(404!==(r=i.sent()).status)return[3,3];return[4,r.json()];case 2:if("This repository is empty."===i.sent().message)return[2,{error:"This repository is empty."}];throw new d.AbortError(r.statusText);case 3:if(!r.ok)return[2,{error:"This repository could not be accessed, try again later"}];return[4,r.json().then(function(e){return e.map(function(e){return{path:e.path,type:e.type}})})];case 4:return[2,i.sent()]}})}),function(e){return r.apply(this,arguments)}),v=(i=(0,l._)(function(e){var t,n;return(0,c.Jh)(this,function(r){switch(r.label){case 0:return t=e.repoNameWithOwner,n=e.accessToken,[4,f()(function(){return m({repoNameWithOwner:t,accessToken:n})},{retries:5,minTimeout:500,onFailedAttempt:function(e){e.retriesLeft||h.$e(function(e){e.setTag("github-import",!0),h.Tb(Error("Could not fetch repository files."))})}})];case 1:return[2,r.sent()]}})}),function(e){return i.apply(this,arguments)}),g=(o=(0,l._)(function(e){var t,n,r,i;return(0,c.Jh)(this,function(o){switch(o.label){case 0:return t=e.repoNameWithOwner,n=e.filePath,r=e.accessToken,[4,u()("".concat(p,"/repos/").concat(t,"/contents/").concat(n),{method:"GET",headers:r?{Authorization:"Bearer ".concat(r)}:{}})];case 1:if(!(i=o.sent()).ok)return[2,{error:"This file could not be accessed, try again later"}];return[4,i.json()];case 2:return[2,o.sent()]}})}),function(e){return o.apply(this,arguments)}),y=(a=(0,l._)(function(e){var t,n,r;return(0,c.Jh)(this,function(i){switch(i.label){case 0:return t=e.repoNameWithOwner,n=e.accessToken,[4,u()("".concat(p,"/repos/").concat(t,"/languages"),{method:"GET",headers:n?{Authorization:"Bearer ".concat(n)}:{}})];case 1:if(404===(r=i.sent()).status)throw new d.AbortError(r.statusText);if(!r.ok)return[3,3];return[4,r.json()];case 2:return[2,i.sent()];case 3:return[2,{error:"Error fetching repository languages."}]}})}),function(e){return a.apply(this,arguments)});(0,l._)(function(e){var t,n;return(0,c.Jh)(this,function(r){switch(r.label){case 0:return t=e.repoNameWithOwner,n=e.accessToken,[4,f()(function(){return y({repoNameWithOwner:t,accessToken:n})},{retries:5,minTimeout:500,onFailedAttempt:function(e){e.retriesLeft||h.$e(function(e){e.setTag("github-import",!0),h.Tb(Error("Could not fetch repository language."))})}})];case 1:return[2,r.sent()]}})}),(0,l._)(function(e){var t,n,r;return(0,c.Jh)(this,function(i){switch(i.label){case 0:t=e.repoNameWithOwner,n=e.accessToken,i.label=1;case 1:return i.trys.push([1,4,,5]),[4,u()("".concat(p,"/repos/").concat(t),{method:"GET",headers:n?{Authorization:"Bearer ".concat(n)}:{}})];case 2:if(404===(r=i.sent()).status)return[2,!0];if(!r.ok)return[2,!1];return[4,r.json()];case 3:if(i.sent().private)return[2,!0];return[2,!1];case 4:return i.sent(),[2,!1];case 5:return[2]}})})},70078:function(e,t,n){function r(e){return 15113696===e}function i(e){return 777914===e||r(e)||3944703===e||29762144===e}n.d(t,{v4:function(){return r},xm:function(){return i}})},94376:function(e,t,n){n.d(t,{I:function(){return i},z:function(){return r}});var r=100,i=250},95597:function(e,t,n){n.d(t,{F5:function(){return d},Hk:function(){return s},Kd:function(){return u},N$:function(){return c},Ob:function(){return l},Vl:function(){return a},Vt:function(){return r},ig:function(){return i},lF:function(){return o}});var r=/^([A-Za-z0-9_]{1,15})\/?$/,i=/^([%A-Za-z0-9]+|-)*\/?$/,o=/^([A-Za-z\d](?:[A-Za-z\d]|-){0,38})\/?$/,a=/^https:\/\/(www\.)?youtube\.com(\/(c|channel|user|@(\w)+))*(\/([A-Za-z0-9_-]+))*(\/?)$/,l=/^(.{2,32}#[0-9]{4})$|^([a-zA-Z0-9_.]{2,32})$/,c="https://twitter.com/",s="https://www.linkedin.com/in/",u="https://github.com/",d=/\/$/},44471:function(e,t,n){n.d(t,{Eg:function(){return m},UF:function(){return u},mD:function(){return l},r0:function(){return d},v:function(){return p},xi:function(){return h}});var r=n(41733),i=n(30509),o=n(63257),a=n(39426);function l(e){return e.split(".").pop()}function c(e,t){return e.some(function(e){return e.path===t})}function s(e,t){var n=e.findIndex(function(e){return l(e.path)===l(t)});if(-1===n)return e;var a=(0,i._)((0,r._)({},e[n]),{path:t});return(0,o._)(e.slice(0,n)).concat([a],(0,o._)(e.slice(n+1)))}function u(e){var t=[];return e.forEach(function(e){var n=l(e.path),r=a.ZP.allSupportedByPopularity().find(function(e){return e.ext===n});r&&!t.includes(r.key)&&t.push(r.key)}),t}function d(e){var t=e.files,n=e.language,r=a.ZP.getMainFileName(null!=n?n:"python");if(!r)return t;var i=t;return c(t,r)||(i=s(i,r)),"html"!==n||c(t,"style.css")||(i=s(i,"style.css")),"html"!==n||c(t,"script.js")||(i=s(i,"script.js")),i}var f=["GoogleCloudPlatform","googleapis"];function h(e){return f.includes(e)}var p="b3294059-2b61-4b20-abde-f06b61a9a1b3",m="gcloud:v1-20230815-e6e4431"},1660:function(e,t,n){n.d(t,{Z:function(){return u}});var r,i,o=n(27387),a=n(98924),l=n(96583);(r=i||(i={})).CHANNEL_OPENED="CHANNEL_OPENED",r.OUTPUT_RECEIVED="OUTPUT_RECEIVED",r.STDERR_RECEIVED="STDERR_RECEIVED",r.STATE_CHANGED="STATE_CHANGED";var c=n(83493),s=n(42256);function u(e){var t,n=e.container,r=(0,c.ZP)(),u=null,d=!1;function f(){return(f=(0,o._)(function(){return(0,l.Jh)(this,function(e){if(d)throw Error("closed");return u?[2,u]:[2,new Promise(function(e){r.once(i.CHANNEL_OPENED,function(t){e(t)})})]})})).apply(this,arguments)}var h="",p="",m=n.openChannel({service:"exec"},function(e){var t=e.channel,n=!1;return t.onCommand(function(e){if(null!=e.output)h+=e.output,r.emit(i.OUTPUT_RECEIVED,e.output);else if(null!=e.stderr)p+=e.stderr,r.emit(i.STDERR_RECEIVED,e.stderr);else if(null!=e.state){if(!n){n=!0;return}r.emit(i.STATE_CHANGED,{state:e.state,outputBuffer:h,stderrBuffer:p}),e.state===s.api.State.Stopped&&(h="",p="")}}),u=t,r.emit(i.CHANNEL_OPENED,t),function(){u=null}});return{request:(t=(0,o._)(function(e){var t,n,r,i,o,c,u,d,h;return(0,l.Jh)(this,function(l){switch(l.label){case 0:return t=e.env,n=e.args,i=void 0===(r=e.lifecycle)?s.api.Exec.Lifecycle.BLOCKING:r,c=void 0!==(o=e.splitStderr)&&o,u=(0,a._)(e,["env","args","lifecycle","splitStderr"]),[4,function(){return f.apply(this,arguments)}()];case 1:return h=(d=l.sent()).request({exec:{env:t,args:n,lifecycle:i,splitStderr:c}}),i===s.api.Exec.Lifecycle.STDIN&&"stdin"in u&&(d.send({input:u.stdin}),d.send({inputClose:{}})),[2,h]}})}),function(e){return t.apply(this,arguments)}),onOutput:function(e){return r.on(i.OUTPUT_RECEIVED,e),function(){r.off(i.OUTPUT_RECEIVED,e)}},onStderr:function(e){return r.on(i.STDERR_RECEIVED,e),function(){r.off(i.STDERR_RECEIVED,e)}},onStateChanged:function(e){return r.on(i.STATE_CHANGED,e),function(){r.off(i.STATE_CHANGED,e)}},getStatus:function(){return u?u.status:"closed"},dispose:function(){d=!0,m(),u=null}}}}}]);
//# sourceMappingURL=8917-c54b87dbf3b46bbd.js.map